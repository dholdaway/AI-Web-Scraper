Title: 466906 – sys-apps/baselayout should not complain about bad shell /usr/sbin/nologin
URL: https://bugs.gentoo.org/show_bug.cgi?id=466906

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 466906
sys-apps/baselayout should not complain about bad shell /usr/sbin/nologin
Last modified: 2013-04-23 19:26:26 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 466906 
      - sys-apps/baselayout should not complain about bad shell /usr/sbin/nologin


Summary:
sys-apps/baselayout should not complain about bad shell /usr/sbin/nologin
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-04-23 15:44 UTC by Toralf Förster





      Modified:
    
2013-04-23 19:26 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Toralf Förster






          2013-04-23 15:44:31 UTC
        

Not worth a warning, or :

WARN: postinst
The following users have non-existent shells!
ldap - /usr/sbin/nologin




Comment 1


Jeroen Roovers (RETIRED)






          2013-04-23 17:19:02 UTC
        

Similarly, on a system running since the end of 2006:

# awk -F: 'system("test -e " $7) { print $1 " - " $7}' /etc/passwd
ldap - /usr/sbin/nologin
sshd - /usr/sbin/nologin
rpc - /usr/sbin/nologin
cron - /usr/sbin/nologin
messagebus - /usr/sbin/nologin
haldaemon - /usr/sbin/nologin
ntp - /usr/sbin/nologin

Also, this check has been there for ages, so it isn't 2.2 specific.




Comment 2


Toralf Förster






          2013-04-23 17:44:25 UTC
        

(In reply to comment #1)
> Also, this check has been there for ages, so it isn't 2.2 specific.
but superfluous, right ?




Comment 3


SpanKY






          2013-04-23 18:47:57 UTC
        

change them to /sbin/nologin which is a valid shell




Comment 4


Toralf Förster






          2013-04-23 19:06:31 UTC
        

(In reply to comment #3)
> change them to /sbin/nologin which is a valid shell

which makes me wonder whether all current ebuilds reflect this topic too (and /me assumes that my ldap user was created in the ancient old times ?)




Comment 5


SpanKY






          2013-04-23 19:26:26 UTC
        

(In reply to comment #4)

iirc, we used to install /usr/sbin/nologin, so the eclass would automatically use that value (or we just defaulted to that value).  certainly the latest eclasses should find /sbin/nologin and use that instead.

if you have a system that doesn't install that, then the eclass uses `false` instead.  certainly there are cases where a user was created long ago when the shell was valid but has since moved.  but i'd rather not get in the business of automatically fixing things in the odd case where the user intended to do this.  especially with /etc/passwd, i'd rather err on the side of making the user clean it up:
 sudo sed -i 's|:/usr/sbin/nologin$|:/sbin/nologin|' /etc/passwd









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

