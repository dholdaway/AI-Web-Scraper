Title: 882601 â€“ app-text/asciidoc-10.2.0: fails to install (TypeError: expected string or bytes-like object)
URL: https://bugs.gentoo.org/show_bug.cgi?id=882601

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla â€“ BugÂ 882601
app-text/asciidoc-10.2.0: fails to install (TypeError: expected string or bytes-like object)
Last modified: 2022-11-24 10:44:48 UTC node [vulture]


Home
| Newâ€“[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
NewÂ Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













BugÂ 882601 
      - app-text/asciidoc-10.2.0: fails to install (TypeError: expected string or bytes-like object)


Summary:
app-text/asciidoc-10.2.0: fails to install (TypeError: expected string or byt...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

No maintainer - Look at https://wiki.gentoo.org/wiki/Project:Proxy_Maintainers if you want to take care of it








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









Â 





      Reported:
    
2022-11-23 10:55 UTC by NoÃ© Lopez





      Modified:
    
2022-11-24 10:44 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



ionen
noelopez
python









See Also:


882415





Package list:







Runtime testing required:

---























      Attachments
    




Complete build log

              (build.log,5.63 KB,
                text/plain)

            
2022-11-23 10:55 UTC,

            NoÃ© Lopez




Details





emerge --info output

              (emerge-info.log,20.75 KB,
                text/plain)

            
2022-11-23 10:56 UTC,

            NoÃ© Lopez




Details





emerge -pqv output

              (emerge-pqv.log,136 bytes,
                text/plain)

            
2022-11-23 10:57 UTC,

            NoÃ© Lopez




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


NoÃ© Lopez





          2022-11-23 10:55:29 UTC
        

Created attachment 836013 [details]
Complete build log

When trying to emerge asciidoc as part of a system upgrade or normally, it fails with this message:

>  * ERROR: app-text/asciidoc-10.2.0::gentoo failed (compile phase):
>  *   Wheel build failed
> *
> * Call stack:
> *     ebuild.sh, line  122:  Called src_compile
> *   environment, line 3371:  Called distutils-r1_src_compile
> *   environment, line 1559:  Called _distutils-r1_run_foreach_impl 'distutils-r1_python_compile'
> *   environment, line  777:  Called distutils-r1_run_phase 'distutils-r1_python_compile'
> *   environment, line 1541:  Called distutils-r1_python_compile
> *   environment, line 1365:  Called distutils_pep517_install '/var/tmp/portage/app-text/asciidoc-10.2.0/work/asciidoc-10.2.0_python3.10/install'
> *   environment, line 1864:  Called die
> * The specific snippet of code:
> *       [[ -n ${wheel} ]] || die "No wheel name returned";
> *
> * If you need support, post the output of `emerge --info '=app-text/asciidoc-10.2.0::gentoo'`,
> * the complete build log and the output of `emerge -pqv '=app-text/asciidoc-10.2.0::gentoo'`.
> * The complete build log is located at '/var/tmp/portage/app-text/asciidoc-10.2.0/temp/build.log'.
> * The ebuild environment file is located at '/var/tmp/portage/app-text/asciidoc-10.2.0/temp/environment'.
> * Working directory: '/var/tmp/portage/app-text/asciidoc-10.2.0/work/asciidoc-10.2.0'
> * S: '/var/tmp/portage/app-text/asciidoc-10.2.0/work/asciidoc-10.2.0'




Comment 1


NoÃ© Lopez





          2022-11-23 10:56:39 UTC
        

Created attachment 836015 [details]
emerge --info output




Comment 2


NoÃ© Lopez





          2022-11-23 10:57:01 UTC
        

Created attachment 836017 [details]
emerge -pqv output




Comment 3


Ionen Wolkens






          2022-11-24 03:21:33 UTC
        

fwiw I tried same versions as:
 *   dev-python/gpep517            : 9
 *   dev-python/installer          : 0.5.1-r1
 *   dev-python/setuptools         : 65.5.0
 *   dev-python/setuptools_scm     : 7.0.5
 *   dev-python/wheel              : 0.37.1-r1
+ dev-lang/python:           3.10.6_p4::gentoo

But I can't reproduce, always emerges fine, likely something obscure. For lack of better ideas may want to update the rest of your system first and try again -- if still fails it'll at least rule out old versions being related.




Comment 4


Sam James









          2022-11-24 03:23:27 UTC
        

Know it's a generic error but given same time period, adding bug 882415 to see also.




Comment 5


NoÃ© Lopez





          2022-11-24 09:53:52 UTC
        

Following the wisdom of the bug you linked, I tried upgrading/downgrading/reinstalling setuptools, but it fails with exactly the same No wheel name returned error.
If that is useful, I have a binary package with the built version I have on my system.




Comment 6


Sam James









          2022-11-24 09:58:15 UTC
        

(In reply to NoÃ© Lopez from comment #5)
> Following the wisdom of the bug you linked, I tried
> upgrading/downgrading/reinstalling setuptools, but it fails with exactly the
> same No wheel name returned error.
> If that is useful, I have a binary package with the built version I have on
> my system.

Could you try qfile -o /usr/lib/python3.*/*/*?




Comment 7


NoÃ© Lopez





          2022-11-24 09:59:25 UTC
        

For sure :
navi /home/bloup # qfile -o /usr/lib/python3.*/*/*
/usr/lib/python3.10/site-packages/easy-install.pth
/usr/lib/python3.10/site-packages/numpy-1.23.4-py3.10-linux-x86_64.egg
/usr/lib/python3.10/site-packages/Pillow-9.2.0-py3.10-linux-x86_64.egg
/usr/lib/python3.10/site-packages/PySoundFile-0.9.0.post1-py3.10.egg
/usr/lib/python3.10/site-packages/scipy-1.9.3-py3.10-linux-x86_64.egg
/usr/lib/python3.10/site-packages/sstv-0.1-py3.10.egg
(haha egg)




Comment 8


NoÃ© Lopez





          2022-11-24 10:03:57 UTC
        

I tried updating some packages listed by Ionen, upgrading wheels worked but that's as far as it goes, the setuptools packages are not upgrading and upgrading the whole system is not really possible since it seems that everything depends on setuptools




Comment 9


Sam James









          2022-11-24 10:22:50 UTC
        

(In reply to NoÃ© Lopez from comment #7)
> For sure :
> navi /home/bloup # qfile -o /usr/lib/python3.*/*/*
> /usr/lib/python3.10/site-packages/easy-install.pth
> /usr/lib/python3.10/site-packages/numpy-1.23.4-py3.10-linux-x86_64.egg
> /usr/lib/python3.10/site-packages/Pillow-9.2.0-py3.10-linux-x86_64.egg
> /usr/lib/python3.10/site-packages/PySoundFile-0.9.0.post1-py3.10.egg
> /usr/lib/python3.10/site-packages/scipy-1.9.3-py3.10-linux-x86_64.egg
> /usr/lib/python3.10/site-packages/sstv-0.1-py3.10.egg
> (haha egg)

Pythons lay eggs!

Can you move all of these into a backup directory and try again?




Comment 10


NoÃ© Lopez





          2022-11-24 10:33:03 UTC
        

Moving all these totally worked, I can now do my package upgrade in peace.
Where did these files come from ? (i might have done some pip install --user for random scripts found on the web)




Comment 11


Sam James









          2022-11-24 10:43:36 UTC
        

(In reply to NoÃ© Lopez from comment #10)
> Moving all these totally worked, I can now do my package upgrade in peace.
> Where did these files come from ? (i might have done some pip install --user
> for random scripts found on the web)

I think that's our answer :)

It might have been from before Gentoo's pip blocked 'pip install' without --user, or some cheesy script out there.




Comment 12


NoÃ© Lopez





          2022-11-24 10:44:48 UTC
        

If I remember correctly I had to pip install --user as root once because the install script would fail overwise, I guess I should have seen that coming ðŸ’€









Format For Printing
Â -Â XML
Â -Â Clone This Bug
Â -Â Clone In The Same 
                        Product
Â -Â Top of page 







Home
| Newâ€“[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
NewÂ Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

