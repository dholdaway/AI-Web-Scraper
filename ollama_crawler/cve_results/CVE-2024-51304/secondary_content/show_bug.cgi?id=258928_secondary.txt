Title: 258928 – >=x11-drivers/ati-drivers-8.573 - screen goes black on X startup
URL: https://bugs.gentoo.org/show_bug.cgi?id=258928

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 258928
>=x11-drivers/ati-drivers-8.573 - screen goes black on X startup
Last modified: 2010-12-28 11:11:00 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 258928 
      - >=x11-drivers/ati-drivers-8.573 - screen goes black on X startup


Summary:
>=x11-drivers/ati-drivers-8.573 - screen goes black on X startup
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Luca Barbato








URL:



http://forums.gentoo.org/viewtopic-p-...
        




Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-02-14 02:02 UTC by George





      Modified:
    
2010-12-28 11:11 UTC
      (History)
    




          CC List:
        

6 
          users
          
            (show)
          



cpwp
enrico.tagliavini
je_fro
meneikis
Sasha.Medvedev
x11









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Xorg log from crash

              (Xorgfglrx91.log,29.71 KB,
                text/plain)

            
2009-02-14 02:03 UTC,

            George




Details





Xorg.conf.

              (xorg.conf.fglrxbak,2.48 KB,
                text/plain)

            
2009-02-14 02:04 UTC,

            George




Details





dmesg after startx failure.

              (dmesg.txt,113.91 KB,
                text/plain)

            
2009-02-14 21:39 UTC,

            Charles Price




Details





My xorg.conf

              (xorg.conf,2.13 KB,
                text/plain)

            
2009-02-14 21:40 UTC,

            Charles Price




Details





emerge --info

              (emerge_info.txt,3.29 KB,
                text/plain)

            
2009-02-14 21:40 UTC,

            Charles Price




Details





strace of X

              (strace_X.txt,198.33 KB,
                text/plain)

            
2009-02-14 22:26 UTC,

            Charles Price




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


George





          2009-02-14 02:02:47 UTC
        

My system works fine if I'm on the december drivers (don't have internal numbers memorized, but 'official' number was 8.12), but if I update to anything newer my Xorg fails to start. I don't see anything interesting in any error logs. 

My keyboard and mouse go completely unresponsive and the screen stays black, but the power button safely shuts down the system. I've tried it with the latest 2.6.28 Gentoo kernel, my log is on a custom kernel but I've verified it happens with default Gentoo kernel as well. 

I've also tested leaked drivers for the 9.1's before the official was released, and the 9.2's as well, all three cause this issue, but remerging back to the December release solves the issue. It works for some people, so my guess is that the new drivers require either a specific version of Xorg or one of its libs to be installed or some kernel options that I do not have enabled, but I can find no documentation to confirm this.

Reproducible: Always

Steps to Reproduce:
1. Install ati-drivers-8.573
2. Start X

Actual Results:  
Xorg freezes, black screen, mode seems to set properly to 1920x1200 (my max and desired res) but then my keyboard and mouse lock up and all I can do is shut down with the power button.

Expected Results:  
xdm to start and load up KDE like normal.




Comment 1


George





          2009-02-14 02:03:13 UTC
        

Created attachment 181940 [details]
Xorg log from crash




Comment 2


George





          2009-02-14 02:04:31 UTC
        

Created attachment 181941 [details]
Xorg.conf.

I've tried a lot of different Xorg.conf options... this is just one. Also tried clean ones created through aticonfig and some offered from people in the fglrx-9.1 bump bug from a few weeks ago.




Comment 3


Jeroen Roovers (RETIRED)






          2009-02-14 02:08:21 UTC
        

Please post your `emerge --info', `dmesg' output from after the unwanted screen blanking, and `lspci -kv'.




Comment 4


George





          2009-02-14 02:13:15 UTC
        

Ok, rebooting into Gentoo now, but will a dmesg really give you anything since I can't do it until after a full reboot? Won't the errors be gone by then? Sorry, just not sure how far back it goes. Maybe I should set a timer to run and upload dmesg 30 seconds after attempting to start X, and then shutdown the system?

To clarify, I can't do anything on my system other than shutting it down after X locks the system.




Comment 5


Jeroen Roovers (RETIRED)






          2009-02-14 02:26:46 UTC
        

Please stop tinkering with the Component and Severity fields.




Comment 6


George





          2009-02-14 03:00:20 UTC
        

Are pastebins ok? Pasting from another PC so it's more convenient...

http://rafb.net/p/xbr2Jd13.html lspci -kv
http://rafb.net/p/kf24dK86.html emerge --info

The emerge info is mostly accurate, I Xorg with paludis so my VIDEO_CARDS flag is incorrect in portage still, the rest is 100% identical but I have only the fglrx and the vmware VIDEO_CARDS flags in use. CFLAGs and LDFlAGs and such are correct.

dmesg coming, it's awaiting some updates I decided to try. (just a world update)




Comment 7


George





          2009-02-14 03:22:25 UTC
        

Well, here's a dmesg after a reboot. Doesn't seem to have much useful info though, maybe I'll try it on a timer.

http://rafb.net/p/Fw2GsO72.html

Also, I found someone on Phoronix with a similar issue... 
http://www.phoronix.com/forums/showthread.php?t=15368

Has the same card I do too, 4870 x2. Hmmm.




Comment 8


George





          2009-02-14 03:25:15 UTC
        

Hmm. I tried it with DRI off, it still didn't work, but the good news is it crashed on its own and didn't lock up my peripherals. Just kicked me back to tty1. dmesg seems to actually contain something this time too, gonna check xorglogs and see if there's anything in there this time also.

http://rafb.net/p/gBzCec59.html




Comment 9


Jeroen Roovers (RETIRED)






          2009-02-14 16:56:23 UTC
        

(In reply to comment #6)
> Are pastebins ok? Pasting from another PC so it's more convenient...
> 
> http://rafb.net/p/xbr2Jd13.html lspci -kv
> http://rafb.net/p/kf24dK86.html emerge --info

No, please attach any files to this bug report...




Comment 10


Charles Price





          2009-02-14 21:38:49 UTC
        

I'm seeing what I suspect is the same problem

- 2.6.28-gentoo-r1 #6 SMP PREEMPT Sat Feb 14 19:52:08 GMT 2009 x86_64 Intel(R) Core(TM)2 Quad CPU Q9550
- Radeon 4870
- x11-drivers/ati-drivers-8.573-r1
- x11-base/xorg-server-1.5.3-r2






Comment 11


Charles Price





          2009-02-14 21:39:44 UTC
        

Created attachment 182064 [details]
dmesg after startx failure.




Comment 12


Charles Price





          2009-02-14 21:40:06 UTC
        

Created attachment 182065 [details]
My xorg.conf




Comment 13


Charles Price





          2009-02-14 21:40:25 UTC
        

Created attachment 182066 [details]
emerge --info




Comment 14


Charles Price





          2009-02-14 22:26:56 UTC
        

Created attachment 182071 [details]
strace of X

I've noticed that X starts up (I think) correctly every second time I start it. For reference, I have attached the output of "strace X" when the X process fails.




Comment 15


Moritz Bellach





          2009-02-16 01:40:29 UTC
        

I seem to have the same problem, but with some differences.
xorg-server version is btw 1.5.3-r1
The issue is always present if I boot my laptop without power connected but only sometimes while power is connected. I hope this helps and does not confuse more than necessary. My laptop is a IBM T60 2007-63G with a radeon mobility x1400




Comment 16


Sasha Medvedev





          2009-02-22 10:37:49 UTC
        

I have the same problem with xorg-server-1.5.3*. But xorg-server-1.5.2 works for me. So may be there are some regressions in xorg-server-1.5.3?




Comment 17


Jeffrey Gardner (RETIRED)






          2009-03-02 21:48:46 UTC
        

Is this still happening for you guys with 8.582?




Comment 18


Jeffrey Gardner (RETIRED)






          2009-03-02 22:03:18 UTC
        

A few things to try here:
http://wiki.cchtml.com/index.php/Gentoo_Installation_Guide




Comment 19


George





          2009-03-03 11:23:00 UTC
        

The newer drivers still didn't fix it, I also tried downgrading the xorg-server to1.5.2 with no luck.




Comment 20


Sasha Medvedev





          2009-03-12 09:31:56 UTC
        

Ati-driver-8.582 works now, after my last upgrade. I have used x11.stable.list for package.keywords from http://bugs.gentoo.org/251832 - stabilization request for x11-base/xorg-server-1.5.3.




Comment 21


Eric N. Vander Weele





          2009-05-21 18:00:20 UTC
        

(In reply to comment #15)
> I seem to have the same problem, but with some differences.
> xorg-server version is btw 1.5.3-r1
> The issue is always present if I boot my laptop without power connected but
> only sometimes while power is connected. I hope this helps and does not confuse
> more than necessary. My laptop is a IBM T60 2007-63G with a radeon mobility
> x1400

I have an Lenovo z61M and observe the same behavior (xorg-server-1.5.3-r6)





Comment 22


Enrico Tagliavini





          2010-12-28 11:10:50 UTC
        

From Xorg log in comment #1 

(II) Loading /usr/lib64/xorg/modules/extensions//libglx.so
(II) Module glx: vendor="X.Org Foundation"

Seems you simply forgot to run eselect opengl set ati, failing do to so produce a machine freeze or at least a black screen









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

