Title: 152750 – dev-ruby/sqlite-ruby-2.2.3-r1 sandbox violation
URL: https://bugs.gentoo.org/show_bug.cgi?id=152750

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 152750
dev-ruby/sqlite-ruby-2.2.3-r1 sandbox violation
Last modified: 2007-09-01 10:09:03 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 152750 
      - dev-ruby/sqlite-ruby-2.2.3-r1 sandbox violation


Summary:
dev-ruby/sqlite-ruby-2.2.3-r1 sandbox violation
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Ruby Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-10-25 00:36 UTC by Alexander Simonov





      Modified:
    
2007-09-01 10:09 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alexander Simonov





          2006-10-25 00:36:11 UTC
        

root@izida  ~portage/dev-ruby 1
# LC_ALL=C emerge rails                                                                                                                                 0.38
Calculating dependencies                                 ... done!

>>> Emerging (1 of 13) dev-ruby/sqlite-ruby-2.2.3-r1 to /
 * sqlite-ruby-2.2.3.gem MD5 ;-) ...                                                                                                                   [ ok ]
 * sqlite-ruby-2.2.3.gem RMD160 ;-) ...                                                                                                                [ ok ]
 * sqlite-ruby-2.2.3.gem SHA1 ;-) ...                                                                                                                  [ ok ]
 * sqlite-ruby-2.2.3.gem SHA256 ;-) ...                                                                                                                [ ok ]
 * sqlite-ruby-2.2.3.gem size ;-) ...                                                                                                                  [ ok ]
 * checking ebuild checksums ;-) ...                                                                                                                   [ ok ]
 * checking auxfile checksums ;-) ...                                                                                                                  [ ok ]
 * checking miscfile checksums ;-) ...                                                                                                                 [ ok ]
 * checking sqlite-ruby-2.2.3.gem ;-) ...                                                                                                              [ ok ]
>>> Unpacking source...
>>> Source unpacked.
>>> Compiling source in /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/work ...
>>> Source compiled.
>>> Test phase [not enabled]: dev-ruby/sqlite-ruby-2.2.3-r1

>>> Install sqlite-ruby-2.2.3-r1 into /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/image/ category dev-ruby
ruby: No such file to load -- auto_gem (LoadError)
install: missing file operand
Try `install --help' for more information.
ACCESS DENIED  open_wr:   /usr/lib/ruby/gems/1.8/source_cache
ERROR:  While executing gem ... (Errno::EACCES)
    Permission denied - /usr/lib/ruby/gems/1.8/source_cache

!!! ERROR: dev-ruby/sqlite-ruby-2.2.3-r1 failed.
Call stack:
  ebuild.sh, line 1548:   Called dyn_install
  ebuild.sh, line 1022:   Called src_install
  ebuild.sh, line 1257:   Called gems_src_install
  gems.eclass, line 59:   Called die

!!! gem install /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/distdir/sqlite-ruby-2.2.3 -v 2.2.3 --no-rdoc -l -i /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/image//
!!! If you need support, post the topmost build error, and the call stack if relevant.

--------------------------- ACCESS VIOLATION SUMMARY ---------------------------
LOG FILE = "/var/log/sandbox/sandbox-dev-ruby_-_sqlite-ruby-2.2.3-r1-26136.log"

open_wr:   /usr/lib/ruby/gems/1.8/source_cache
--------------------------------------------------------------------------------




Comment 1


Alexander Simonov





          2006-10-25 00:36:39 UTC
        

emerge --info:

Portage 2.1.2_pre2-r9 (default-linux/x86/2006.1/desktop, gcc-4.1.1, glibc-2.4-r3, 2.6.17-gentoo-r8 i686)
=================================================================
System uname: 2.6.17-gentoo-r8 i686 AMD Athlon(tm) 64 Processor 3500+
Gentoo Base System version 1.12.5
Last Sync: Thu, 12 Oct 2006 23:30:01 +0000
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.28-r1
dev-lang/python:     2.3.5, 2.4.3-r3
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -mtune=athlon-xp -march=i686 -msse2 -m3dnow -mmmx"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /opt/openjms/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O2 -mtune=athlon-xp -march=i686 -msse2 -m3dnow -mmmx -fvisibility-inlines-hidden"
DISTDIR="/mnt/data/distfiles/"
FEATURES="autoconfig buildpkg candy distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://trumpetti.atm.tut.fi/gentoo/ "
LANG="ru_RU.UTF-8"
LC_ALL=""
LINGUAS="ru ua uk"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/rusxmms /usr/local/overlays/myown /usr/portage/local/layman/break-my-gentoo-main /usr/portage/local/layman/java-experimental /usr/portage/local/layman/php-experimental /usr/portage/local/layman/php-testing /usr/portage/local/layman/mysql-experimental /usr/portage/local/layman/chtekk-syscp /usr/portage/local/layman/portage-xgl"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X acpi alsa apache2 bash-completion bcmath berkdb bitmap-fonts bzip2 cairo calendar cdr cdrom cdrw cgi cli crypt ctype dbus dlloader dri dvd dvdr elibc_glibc emboss encode esd examples exif fam fastcgi firefox force-cgi-redirect fortran freetype ftp gd gd-external gdbm gif glibc-compat20 glibc-omitfp gnome gpm gstreamer gtk gtk2 hal hardenedphp iconv imlib inifile innodb input_devices_keyboard input_devices_mouse isdnlog jpeg kde kernel_linux libg++ linguas_ru linguas_ua linguas_uk mad maildir mailwrapper mcal mcve memlimit mhash mikmod ming mmx mp3 mpeg mysql ncurses nls nntp nptl nptlonly ogg opengl oss pam pcre perl php png posix postgres ppds pppd python qt qt3 qt4 quicktime readline reflection sdl session sharedext simplexml slang soap sockets solid spell spl sqlite sqlite3 sse ssl sysvipc tcpd threads tidy tools truetype truetype-fonts type1-fonts udev unicode urandom userland_GNU userlocales video_cards_fglrx vorbis win32codecs xml xmlrpc xorg xsl xv zip zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, MAKEOPTS, PORTAGE_RSYNC_EXTRA_OPTS


root@izida  ~portage/dev-ruby 0
# ruby --version                                                                                                                                        0.09
ruby 1.8.5 (2006-08-25) [i686-linux]
root@izida  ~portage/dev-ruby 0
# gem --version                                                                                                                                         0.05
0.9.0

root@izida  ~portage/dev-ruby 0
# env                                                                                                                                                   0.04
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/opt/bin:/usr/i686-pc-linux-gnu/gcc-bin/4.1.1:/usr/i386-pc-linux-gnu/gcc-bin/3.3.5-20050130:/opt/ati/bin:/opt/ati/sbin:/opt/blackdown-jdk-1.4.2.03/bin:/opt/blackdown-jdk-1.4.2.03/jre/bin:/usr/kde/3.5/sbin:/usr/kde/3.5/bin:/usr/qt/3/bin:/opt/vmware/workstation/bin
TERM=xterm
HOME=/home/devil
SHELL=/bin/zsh
LOGNAME=root
USER=root
SUDO_COMMAND=/bin/zsh
SUDO_USER=devil
SUDO_UID=1000
SUDO_GID=10
SHLVL=1
PWD=/var/tmp/portage/dev-ruby
OLDPWD=/var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1
ANT_HOME=/usr/share/ant-core
CLASSPATH=.
CONFIG_PROTECT=/opt/openjms/config /usr/share/X11/xkb /usr/kde/3.5/share/config /usr/kde/3.5/env /usr/kde/3.5/shutdown /usr/share/config
CONFIG_PROTECT_MASK=/etc/java-config/vms/ /etc/env.d/java/ /etc/gconf /etc/terminfo /etc/texmf/web2c /etc/revdep-rebuild
CVS_RSH=ssh
GCC_SPECS=
GDK_USE_XFT=1
GENERATION=2
G_BROKEN_FILENAMES=1
G_FILENAME_ENCODING=UTF-8
INFOPATH=/usr/share/info:/usr/share/binutils-data/i686-pc-linux-gnu/2.17/info:/usr/share/gcc-data/i686-pc-linux-gnu/4.1.1/info
JAVAC=/opt/blackdown-jdk-1.4.2.03/bin/javac
JAVA_HOME=/opt/blackdown-jdk-1.4.2.03
JDK_HOME=/opt/blackdown-jdk-1.4.2.03
KDEDIRS=/usr/kde/3.5:/usr:/usr/local
LANG=ru_RU.UTF-8
LC_ALL=
LESS=-R -M --shift 5
LESSOPEN=|lesspipe.sh %s
LIBGL_DRIVERS_PATH=$LIBGL_DRIVERS_PATH::/usr/lib/xorg/modules/dri
MANPATH=/usr/local/share/man:/usr/share/man:/usr/share/binutils-data/i686-pc-linux-gnu/2.17/man:/usr/share/gcc-data/i686-pc-linux-gnu/4.1.1/man:/opt/ati/man:/opt/blackdown-jdk-1.4.2.03/man:/etc/java-config/system-vm/man/:/usr/qt/3/doc/man:/opt/vmware/workstation/man
OPENGL_PROFILE=ati
PAGER=/usr/bin/less
PKG_CONFIG_PATH=/usr/qt/3/lib/pkgconfig
PRELINK_PATH_MASK=/usr/lib/gstreamer-0.10:/usr/lib/gstreamer-0.8
PYTHONPATH=/usr/lib/portage/pym
QMAKESPEC=linux-g++
QTDIR=/usr/qt/3
SANE_CONFIG_DIR=/etc/sane.d
USB_DEVFS_PATH=/dev/bus/usb
VMHANDLE=blackdown-jdk-1.4.2
UNAME_S=Linux
WINEXINSTALLDIR=/home/devil/.cedega/.winex_ver/winex-5.0
COLORFGBG=default;default
SVN_EDITOR=/usr/bin/vim
USE=-bogofilter -mono nntp tools examples fastcgi sqlite sqlite3
RUBYOPT=-rauto_gem
_=/bin/env





Comment 2


Alexander Simonov





          2006-10-25 01:29:44 UTC
        

If disable sandbox and RUBYOPT="" and trying install rails i am get:

>>> Emerging (1 of 13) dev-ruby/sqlite-ruby-2.2.3-r1 to /
 * sqlite-ruby-2.2.3.gem MD5 ;-) ...                                                                                                                   [ ok ]
 * sqlite-ruby-2.2.3.gem RMD160 ;-) ...                                                                                                                [ ok ]
 * sqlite-ruby-2.2.3.gem SHA1 ;-) ...                                                                                                                  [ ok ]
 * sqlite-ruby-2.2.3.gem SHA256 ;-) ...                                                                                                                [ ok ]
 * sqlite-ruby-2.2.3.gem size ;-) ...                                                                                                                  [ ok ]
 * checking ebuild checksums ;-) ...                                                                                                                   [ ok ]
 * checking auxfile checksums ;-) ...                                                                                                                  [ ok ]
 * checking miscfile checksums ;-) ...                                                                                                                 [ ok ]
 * checking sqlite-ruby-2.2.3.gem ;-) ...                                                                                                              [ ok ]
>>> Unpacking source...
>>> Source unpacked.
>>> Compiling source in /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/work ...
>>> Source compiled.
>>> Test phase [not enabled]: dev-ruby/sqlite-ruby-2.2.3-r1

>>> Install sqlite-ruby-2.2.3-r1 into /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/image/ category dev-ruby
ERROR:  Interrupted

and no continue

in process list i get:

evil@izida  ~ 0
% ps auxww | grep gem                                                                                                                                   0.27
root      2558  0.2  1.3  22316 11884 pts/7    Sl   11:26   0:00 /usr/bin/ruby /usr/bin/gem install /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/distdir/sqlite-ruby-2.2.3 -v 2.2.3 --no-rdoc -l -i /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/image///usr/local/lib/ruby/gems/1.8
devil     2967  0.0  0.0   2916   816 pts/5    R+   11:29   0:00 grep --color=auto gem




Comment 3


Nguyen Thai Ngoc Duy (RETIRED)






          2006-10-29 00:52:01 UTC
        

(In reply to comment #0)
> >>> Install sqlite-ruby-2.2.3-r1 into /var/tmp/portage/dev-ruby/sqlite-ruby-2.2.3-r1/image/ category dev-ruby
> ruby: No such file to load -- auto_gem (LoadError)

I wonder what was happening here. Can you check whether /usr/lib/ruby/site_ruby/auto_gem.rb exists?

> install: missing file operand
> Try `install --help' for more information.
> ACCESS DENIED  open_wr:   /usr/lib/ruby/gems/1.8/source_cache
> ERROR:  While executing gem ... (Errno::EACCES)
>     Permission denied - /usr/lib/ruby/gems/1.8/source_cache






Comment 4


Alexander Simonov





          2006-11-01 00:32:27 UTC
        

-rw-r--r-- 1 root root 159 Oct 25 09:53 /usr/lib/ruby/site_ruby/auto_gem.rb




Comment 5


Josh Nichols (RETIRED)






          2007-07-13 22:31:37 UTC
        

WORKSFORME. Are people still seeing this issue?




Comment 6


Jakub Moc (RETIRED)






          2007-09-01 10:09:03 UTC
        

(In reply to comment #5)
> WORKSFORME.

Same here.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

