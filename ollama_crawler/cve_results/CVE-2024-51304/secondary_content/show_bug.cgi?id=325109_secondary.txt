Title: 325109 – app-text/docbook-xml-dtd catalog issues (installing a newer slot breaks existing slots)
URL: https://bugs.gentoo.org/show_bug.cgi?id=325109

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 325109
app-text/docbook-xml-dtd catalog issues (installing a newer slot breaks existing slots)
Last modified: 2012-03-29 21:24:48 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 325109 
      - app-text/docbook-xml-dtd catalog issues (installing a newer slot breaks existing slots)


Summary:
app-text/docbook-xml-dtd catalog issues (installing a newer slot breaks exist...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo SGML project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-06-22 21:22 UTC by James Cloos





      Modified:
    
2012-03-29 21:24 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge-info,5.53 KB,
                text/plain)

            
2010-07-13 17:46 UTC,

            James Cloos




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


James Cloos





          2010-06-22 21:22:09 UTC
        

I got this from postgresql-docs while emerge was trying to upgrade world:

openjade  -wall -wno-unused-param -wno-empty -wfully-tagged -D . -D . -c /usr/share/sgml/stylesheets/dsssl/docbook/catalog -d stylesheet.dsl -t sgml -i output-html -V html-index postgres.sgml
openjade:postgres.sgml:3:55:W: cannot generate system identifier for public text "-//OASIS//DTD DocBook V4.2//EN"
openjade:postgres.sgml:12:0:E: reference to entity "BOOK" for which no system identifier could be generated
openjade:postgres.sgml:3:0: entity was defined here
openjade:postgres.sgml:12:0:E: DTD did not contain element declaration for document type name
openjade:postgres.sgml:14:9:E: there is no attribute "ID"
openjade:postgres.sgml:14:19:E: element "BOOK" undefined
openjade:postgres.sgml:15:7:E: element "TITLE" undefined

and it goes on with that sort of error for all of the elements in the sgml.

I tried re-installing app-text/docbook-xml-dtd:4.2 and that allowed the pg docs ebuild to complete.

It seems that the only slot of app-text/docbook-xml-dtd which works is the one most recently installed.




Comment 1


Wormo (RETIRED)






          2010-06-28 00:49:57 UTC
        

There is currently only one ebuild for docbook-sgml-dtd:4.2 available, and you said that it works ok? It sounds like once upon a time there was a bad revision of docbook-sgml-dtd:4.2, but it is not in the tree anymore...

Possibly I'm confused, but it seems like this bug already got fixed before you reported it. If that's not the case, please point out what I have overlooked or misunderstood :)




Comment 2


James Cloos





          2010-06-28 14:46:33 UTC
        

Let me try again.

After I first installed the 4.2 slot of docbook-xml-dtd, it worked.

Once I installed another slot of docbook-xml-dtd, the 4.2 slot stopped working.

Re-installing the 4.2 slot made it work again.  

The report, then, is that installing any given slot of docbook-xml-dtd, seems to break any other, already installed slot.

My /etc/sgml/catalog file does, currently, have entries for all of the .cat files in /etc/sgml, and the entries are absolute.  One would expect them to work.  But they only point at other catalog files, which in turn reference the actual files of interest, such as the dtd files, et al.

Somehow, installing another slot must have broken the referencing, preventing the app from locating either /usr/share/sgml/docbook/sgml-dtd-4.2/docbook.dtd
or /usr/share/sgml/docbook/sgml-dtd-4.2/docbookx.dtd (loaded by the first).





Comment 3


Wormo (RETIRED)






          2010-07-04 06:47:12 UTC
        

Thanks for the clear explanation, I get it now. 

Please post your 'emerge --info', and then we'll assign this bug to docbook maintainers.




Comment 4


Wormo (RETIRED)






          2010-07-12 21:08:05 UTC
        

reminder -- 'emerge --info'?




Comment 5


James Cloos





          2010-07-13 17:46:11 UTC
        

Created attachment 238631 [details]
emerge --info

Here is the emerge-info.




Comment 6


Ian Delaney (RETIRED)






          2012-03-24 08:34:02 UTC
        

archtester docbook-xml-dtd # ls  /usr/share/sgml/docbook/xml-dtd-4.2/
calstblx.dtd  dbcentx.mod  dbgenent.mod  dbhierx.mod  dbnotnx.mod  dbpoolx.mod  docbook.cat  docbookx.dtd  ent  soextblx.dtd

archtester docbook-xml-dtd # ls  /usr/share/sgml/docbook/xml-dtd-4.4/
calstblx.dtd  dbcentx.mod   dbhierx.mod  dbpoolx.mod  docbookx.dtd  htmltblx.mod
catalog.xml   dbgenent.mod  dbnotnx.mod  docbook.cat  ent           soextblx.dtd

archtester docbook-xml-dtd # find  /usr/share/sgml/docbook/ -name docbook.dtd
archtester docbook-xml-dtd # 

Possible cause?? or James is wrong citing it.
The installed files in /etc/sgml

archtester docbook-xml-dtd # ls  /etc/sgml/
catalog             sgml.conf             sgml-docbook-4.0.cat  sgml-docbook.cat  xhtml1.cat             xml-docbook-4.3.cat
openjade-1.3.2.cat  sgml-docbook-3.0.cat  sgml-docbook-4.1.cat  sgml-ent.cat      xml-docbook-4.1.2.cat  xml-docbook-4.4.cat
sgml.cenv           sgml-docbook-3.1.cat  sgml-docbook-4.5.cat  sgml.env          xml-docbook-4.2.cat    xml-docbook-4.5.cat

perhaps need to cite the ${PV} where they don't.




Comment 7


Mike Gilbert






          2012-03-27 21:54:12 UTC
        

Yeah... what version of postgresql-docs was this? Recent versions appear to install pre-generated html files.




Comment 8


James Cloos





          2012-03-27 23:42:48 UTC
        

> what version of postgresql-docs was this?
> Recent versions appear to install pre-generated html files.

The 2010-06-22 version? ☺

Even if pgsql doesn’t trip it any more, the bug (that installing one version of the docbook xml dtd prevents other, already installed version from continuing to work) still may be relevant.

I don’t have a test case, though, other than the then-current version of pgsql docs.




Comment 9


Mike Gilbert






          2012-03-28 14:57:28 UTC
        

(In reply to comment #8)

Hmm... it looks like the postgresql 9.0 pre-release versions (beta/rc) had ebuilds that generated docs from the docbook sources.

I'll try pulling a copy from the Attic.

http://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/dev-db/postgresql-docs/?hideattic=0




Comment 10


Mike Gilbert






          2012-03-29 21:24:48 UTC
        

I was not able to reproduce the problem.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

