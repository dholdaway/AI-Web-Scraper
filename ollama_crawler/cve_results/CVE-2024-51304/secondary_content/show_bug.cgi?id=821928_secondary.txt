Title: 821928 – sys-libs/libxcrypt: checking whether we are cross compiling... configure: error: in `/var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25-xcrypt_compat-abi_x86_64.amd64':
URL: https://bugs.gentoo.org/show_bug.cgi?id=821928

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 821928
sys-libs/libxcrypt: checking whether we are cross compiling... configure: error: in `/var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25-xcrypt_compat-abi_x86_64.amd64':
Last modified: 2022-02-23 13:12:45 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 821928 
      - sys-libs/libxcrypt: checking whether we are cross compiling... configure: error: in `/var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25-xcrypt_compat-abi_x86_64.amd64':


Summary:
sys-libs/libxcrypt: checking whether we are cross compiling... configure: err...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-11-05 12:14 UTC by HougeLangley





      Modified:
    
2022-02-23 13:12 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



andres.becerra
sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge --info,6.73 KB,
                text/plain)

            
2021-11-05 12:15 UTC,

            HougeLangley




Details





emerge -pqv

              (emerge -pqv,173 bytes,
                text/plain)

            
2021-11-05 12:16 UTC,

            HougeLangley




Details





build.log

              (build.log,5.24 KB,
                text/plain)

            
2022-02-22 20:53 UTC,

            Andrés Becerra Sandoval




Details





config.log

              (config.log,13.45 KB,
                text/plain)

            
2022-02-22 20:53 UTC,

            Andrés Becerra Sandoval




Details





emerge --info

              (info.txt,6.29 KB,
                text/plain)

            
2022-02-22 20:54 UTC,

            Andrés Becerra Sandoval




Details





kernel config gzipped

              (config.gz,28.58 KB,
                application/octet-stream)

            
2022-02-22 22:18 UTC,

            Andrés Becerra Sandoval




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


HougeLangley





          2021-11-05 12:14:13 UTC
        

>>> Emerging (1 of 12) sys-libs/libxcrypt-4.4.25::gentoo
 * libxcrypt-4.4.25-autotools.tar.xz BLAKE2B SHA512 size ;-) ...                                   [ ok ]
>>> Unpacking source...
>>> Unpacking libxcrypt-4.4.25-autotools.tar.xz to /var/tmp/portage/sys-libs/libxcrypt-4.4.25/work
>>> Source unpacked in /var/tmp/portage/sys-libs/libxcrypt-4.4.25/work
>>> Preparing source in /var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25 ...
>>> Source prepared.
>>> Configuring source in /var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25 ...
 * xcrypt_compat: running multilib-minimal_src_configure
 * abi_x86_64.amd64: running multilib-minimal_abi_src_configure
 * econf: updating libxcrypt-4.4.25/config.sub with /usr/share/gnuconfig/config.sub
 * econf: updating libxcrypt-4.4.25/config.guess with /usr/share/gnuconfig/config.guess
 * econf: updating libxcrypt-4.4.25/build-aux/config.sub with /usr/share/gnuconfig/config.sub
 * econf: updating libxcrypt-4.4.25/build-aux/config.guess with /usr/share/gnuconfig/config.guess
/var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25/configure --prefix=/usr --build=x86_64-pc-linux-gnu --host=x86_64-pc-linux-gnu --mandir=/usr/share/man --infodir=/usr/share/info --datadir=/usr/share --sysconfdir=/etc --localstatedir=/var/lib --disable-dependency-tracking --disable-silent-rules --docdir=/usr/share/doc/libxcrypt-4.4.25 --htmldir=/usr/share/doc/libxcrypt-4.4.25/html --with-sysroot=/ --disable-werror --libdir=/lib64/ --with-pkgconfigdir=/usr/lib64/pkgconfig --includedir=/usr/include/ --disable-static --disable-xcrypt-compat-files --enable-obsolete-api=yes
checking for a BSD-compatible install... /usr/lib/portage/python3.9/ebuild-helpers/xattr/install -c
checking whether build environment is sane... yes
checking for a race-free mkdir -p... /bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking whether make supports nested variables... yes
checking build system type... x86_64-pc-linux-gnu
checking host system type... x86_64-pc-linux-gnu
checking for x86_64-pc-linux-gnu-gcc... x86_64-pc-linux-gnu-gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... configure: error: in `/var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25-xcrypt_compat-abi_x86_64.amd64':
configure: error: cannot run C compiled programs.
If you meant to cross compile, use `--host'.
See `config.log' for more details

!!! Please attach the following file when seeking support:
!!! /var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25-xcrypt_compat-abi_x86_64.amd64/config.log
 * ERROR: sys-libs/libxcrypt-4.4.25::gentoo failed (configure phase):
 *   econf failed
 *
 * Call stack:
 *               ebuild.sh, line  127:  Called src_configure
 *             environment, line 2559:  Called multibuild_foreach_variant 'multilib-minimal_src_configure'
 *             environment, line 1460:  Called _multibuild_run 'multilib-minimal_src_configure'
 *             environment, line 1458:  Called multilib-minimal_src_configure
 *             environment, line 1530:  Called multilib_foreach_abi 'multilib-minimal_abi_src_configure'
 *             environment, line 1783:  Called multibuild_foreach_variant '_multilib_multibuild_wrapper' 'multilib-minimal_abi_src_configure'
 *             environment, line 1460:  Called _multibuild_run '_multilib_multibuild_wrapper' 'multilib-minimal_abi_src_configure'
 *             environment, line 1458:  Called _multilib_multibuild_wrapper 'multilib-minimal_abi_src_configure'
 *             environment, line  390:  Called multilib-minimal_abi_src_configure
 *             environment, line 1524:  Called multilib_src_configure
 *             environment, line 2007:  Called econf '--disable-werror' '--libdir=/lib64/' '--with-pkgconfigdir=/usr/lib64/pkgconfig' '--includedir=/usr/include/' '--disable-static' '--disable-xcrypt-compat-files' '--enable-obsolete-api=yes'
 *        phase-helpers.sh, line  711:  Called __helpers_die 'econf failed'
 *   isolated-functions.sh, line  112:  Called die
 * The specific snippet of code:
 *   		die "$@"
 *
 * If you need support, post the output of `emerge --info '=sys-libs/libxcrypt-4.4.25::gentoo'`,
 * the complete build log and the output of `emerge -pqv '=sys-libs/libxcrypt-4.4.25::gentoo'`.
 * The complete build log is located at '/var/tmp/portage/sys-libs/libxcrypt-4.4.25/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/sys-libs/libxcrypt-4.4.25/temp/environment'.
 * Working directory: '/var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25-xcrypt_compat-abi_x86_64.amd64'
 * S: '/var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25'

Reproducible: Always




Comment 1


HougeLangley





          2021-11-05 12:15:11 UTC
        

Created attachment 748731 [details]
emerge --info




Comment 2


HougeLangley





          2021-11-05 12:16:17 UTC
        

Created attachment 748734 [details]
emerge -pqv




Comment 3


Sam James









          2021-11-05 15:49:18 UTC
        

Please attach the build.log (which contains additional information) and /var/tmp/portage/sys-libs/libxcrypt-4.4.25/work/libxcrypt-4.4.25-xcrypt_compat-abi_x86_64.amd64/config.log.




Comment 4


Andrés Becerra Sandoval





          2022-02-22 11:30:19 UTC
        

I have the same problem that HougeLangley.

How I got into it?

Trying to merge firefox, that pulls sys-libs/compiler-rt-sanitizers, that pulls sys-libs/libxcrypt-4.4.27 with ABI_X86="32".

It seems that the ABI_X86="32" causes the error in configure.




Comment 5


Andrés Becerra Sandoval





          2022-02-22 11:45:45 UTC
        

Uploading attachments is failing for me.

build.log: https://pastebin.com/5CLBND98 
config.log: https://pastebin.com/JT0aef69




Comment 6


Andrés Becerra Sandoval





          2022-02-22 11:55:36 UTC
        

it seems the following piece of config.log(lines 91-104) has the cause:

configure:3914: x86_64-pc-linux-gnu-gcc -m32 -V >&5
x86_64-pc-linux-gnu-gcc: error: unrecognized command-line option '-V'
x86_64-pc-linux-gnu-gcc: fatal error: no input files
compilation terminated.
configure:3925: $? = 1
configure:3914: x86_64-pc-linux-gnu-gcc -m32 -qversion >&5
x86_64-pc-linux-gnu-gcc: error: unrecognized command-line option '-qversion'; did you mean '--version'?
x86_64-pc-linux-gnu-gcc: fatal error: no input files
compilation terminated.
configure:3925: $? = 1
configure:3914: x86_64-pc-linux-gnu-gcc -m32 -version >&5
x86_64-pc-linux-gnu-gcc: error: unrecognized command-line option '-version'
x86_64-pc-linux-gnu-gcc: fatal error: no input files
compilation terminated.




Comment 7


Sam James









          2022-02-22 15:49:57 UTC
        

(In reply to Andrés Becerra Sandoval from comment #5)
> Uploading attachments is failing for me.
> 
> build.log: https://pastebin.com/5CLBND98 
> config.log: https://pastebin.com/JT0aef69

Make sure your browser has permission to access them then try again. Move into homedir and chown for example. Also please include emerge --info.




Comment 8


Andrés Becerra Sandoval





          2022-02-22 20:53:05 UTC
        

Created attachment 765671 [details]
build.log




Comment 9


Andrés Becerra Sandoval





          2022-02-22 20:53:26 UTC
        

Created attachment 765672 [details]
config.log




Comment 10


Andrés Becerra Sandoval





          2022-02-22 20:54:07 UTC
        

Created attachment 765673 [details]
emerge --info




Comment 11


Sam James









          2022-02-22 21:01:43 UTC
        

(In reply to Andrés Becerra Sandoval from comment #9)
> Created attachment 765672 [details]
> config.log

configure:4100: $? = 0
configure:4107: ./conftest
/var/tmp/portage/sys-libs/libxcrypt-4.4.27/work/libxcrypt-4.4.27/configure: line 4109: ./conftest: cannot execute binary file: Exec format error
configure:4111: $? = 126

Does your kernel not support 32-bit binaries or similar...?




Comment 12


Andrés Becerra Sandoval





          2022-02-22 21:47:54 UTC
        

I am not sure, I've just started installing Gentoo on past friday and this is the first and only package that asks for ABI_X86="32". 


My profile is:
[8]   default/linux/amd64/17.1/desktop/plasma (stable) *


And I started installing from:
stage3-amd64-desktop-openrc-20220214T095322Z.tar.xz




Comment 13


Andrés Becerra Sandoval





          2022-02-22 21:55:48 UTC
        

A small test to discard that my box can not compile 32 Bit programs:

abecerra@EBI-ABe ~/bug $ cat conftest.c 
#include <stdio.h>

int main(int argc, char **argv){
        return 0;
}

abecerra@EBI-ABe ~/bug $ x86_64-pc-linux-gnu-gcc -m32 -o conftest -march=native -O2 -pipe  -Wl,-O1 -Wl,--as-needed conftest.c
abecerra@EBI-ABe ~/bug $ file conftest
conftest: ELF 32-bit LSB pie executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, not stripped




Comment 14


Sam James









          2022-02-22 22:10:24 UTC
        

(In reply to Andrés Becerra Sandoval from comment #12)
> I am not sure, I've just started installing Gentoo on past friday and this
> is the first and only package that asks for ABI_X86="32". 
> 
> 
> My profile is:
> [8]   default/linux/amd64/17.1/desktop/plasma (stable) *
> 
> 
> And I started installing from:
> stage3-amd64-desktop-openrc-20220214T095322Z.tar.xz

Can you upload your kernel config?




Comment 15


Andrés Becerra Sandoval





          2022-02-22 22:18:13 UTC
        

Created attachment 765687 [details]
kernel config gzipped

kernel config uploaded




Comment 16


Andrés Becerra Sandoval





          2022-02-22 22:21:38 UTC
        

I have not CONFIG_X86_X32 active in the kernel, I will test activating it




Comment 17


Sam James









          2022-02-23 02:40:46 UTC
        

(In reply to Andrés Becerra Sandoval from comment #16)
> I have not CONFIG_X86_X32 active in the kernel, I will test activating it

You *don't* need this, X32 is something weird. What you _do_ need is CONFIG_IA32_EMULATION.




Comment 18


Andrés Becerra Sandoval





          2022-02-23 09:02:37 UTC
        

Tested with CONFIG_IA32_EMULATION active and it merged.

Thank you Sam for all the patience!




Comment 19


Sam James









          2022-02-23 13:12:45 UTC
        

(In reply to Andrés Becerra Sandoval from comment #18)
> Tested with CONFIG_IA32_EMULATION active and it merged.
> 
> Thank you Sam for all the patience!

No problem at all! Glad you're sorted!









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

