Title: 738874 – media-gfx/blender-2.83.4: segmentation fault
URL: https://bugs.gentoo.org/show_bug.cgi?id=738874

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 738874
media-gfx/blender-2.83.4: segmentation fault
Last modified: 2022-02-26 02:17:11 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 738874 
      - media-gfx/blender-2.83.4: segmentation fault


Summary:
media-gfx/blender-2.83.4: segmentation fault
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Adrian








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-08-25 00:18 UTC by CaptainBlood





      Modified:
    
2022-02-26 02:17 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



darkdefende
O01eg
proxy-maint
sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




strace log file

              (strace-blender.out.txt,166.33 KB,
                text/plain)

            
2020-08-25 00:20 UTC,

            CaptainBlood




Details





build log

              (media-gfx:blender-2.83.4:20200825-022231.log.xz,161.56 KB,
                application/x-xz)

            
2020-08-25 02:53 UTC,

            CaptainBlood




Details





Working blender USE flags on my system

              (file_738874.txt,8.42 KB,
                text/plain)

            
2020-08-28 19:27 UTC,

            Adrian




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


CaptainBlood





          2020-08-25 00:18:43 UTC
        

emerge --info blender
--- Invalid atom in /var/db/repos/go-overlay/profiles/package.mask: Slot deps are not allowed in EAPI 0: 'dev-lang/go:stable'
Portage 2.3.103 (python 3.7.8-final-0, default/linux/amd64/17.1, gcc-9.3.0, glibc-2.31-r6, 5.8.3-gentoo-classic x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-5.8.3-gentoo-classic-x86_64-Intel-R-_Core-TM-_i3-6100_CPU_@_3.70GHz-with-gentoo-2.6
KiB Mem:     3939304 total,   1337608 free
KiB Swap:    8048528 total,   7113344 free
Timestamp of repository audio-overlay: Sat, 22 Aug 2020 11:05:17 +0000
Head commit of repository audio-overlay: 39303757c710a55234bcd0c80c2bf57c5e88936d

Timestamp of repository bobwya: Sun, 16 Aug 2020 18:35:35 +0000
Head commit of repository bobwya: a894ae5971064205dc5339e33475cab02cda8fec

Timestamp of repository calculate: Mon, 24 Aug 2020 13:05:23 +0000
Head commit of repository calculate: fb522b416e22128502ca3ea5bd09d8c5ab9a725f

Timestamp of repository go-overlay: Mon, 10 Aug 2020 09:13:55 +0000
Head commit of repository go-overlay: 56b684348b133aedbdb0be40bc3dd3a1fd499553

Timestamp of repository linxon: Sat, 15 Aug 2020 17:05:43 +0000
Head commit of repository linxon: 45a41bce24a71d4db09dbf2f021909b966e2667c

Timestamp of repository pentoo: Mon, 24 Aug 2020 16:35:22 +0000
Head commit of repository pentoo: f46397ed47af853323e62a822a86d339f5422c4a

Timestamp of repository raiagent: Sat, 22 Aug 2020 16:35:22 +0000
Head commit of repository raiagent: d951a267ed2cbbcda6015a5703722a5f04740742

Timestamp of repository rukruk: Mon, 10 Aug 2020 09:14:03 +0000
Head commit of repository rukruk: 1625c3550184d3f8ab6d10488b5b4829e667f2c8

Timestamp of repository seden: Mon, 17 Aug 2020 06:35:29 +0000
Head commit of repository seden: 55dc9e703d356b0c33bf2ec4f4a49b2eb791b675

Head commit of repository smoverlay: 01a4b5763a6cd79016a3230f5820b224f011a44f

Timestamp of repository thegreatmcpain: Mon, 24 Aug 2020 18:35:16 +0000
Head commit of repository thegreatmcpain: 12c32b7aae72e10ce54a9e7827d946a70c23afee

Timestamp of repository waebbl: Mon, 17 Aug 2020 22:05:52 +0000
Head commit of repository waebbl: af1bd1549b2c3e0575e934a7047e1c97603a011a

Timestamp of repository gentoo: Mon, 24 Aug 2020 20:00:01 +0000
Head commit of repository gentoo: c80fca90be7557f9422f131df9557ef08716b499
Timestamp of repository ricerlay: Sun, 23 Aug 2020 09:05:19 +0000
Head commit of repository ricerlay: 5a8ffbc3f345c11bc276a0ae0a54d3fc2176437b

sh bash 5.0_p18
ld GNU ld (Gentoo 2.33.1 p2) 2.33.1
distcc 3.3.3 x86_64-pc-linux-gnu [disabled]
app-shells/bash:          5.0_p18::gentoo
dev-java/java-config:     2.3.1::gentoo
dev-lang/perl:            5.30.3::gentoo
dev-lang/python:          2.7.18-r1::gentoo, 3.6.11-r2::gentoo, 3.7.8-r2::gentoo, 3.8.5::gentoo
dev-util/cmake:           3.16.5::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.6-r1::gentoo
sys-apps/openrc:          0.42.1::gentoo
sys-apps/sandbox:         2.18::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.16.1-r1::gentoo
sys-devel/binutils:       2.33.1-r1::gentoo
sys-devel/gcc:            9.3.0-r1::gentoo, 10.2.0-r1::gentoo
sys-devel/gcc-config:     2.3.1::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 5.7::gentoo (virtual/os-headers)
sys-libs/glibc:           2.31-r6::gentoo
Repositories:

audio-overlay
    location: /var/db/repos/audio-overlay
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/audio-overlay.git
    masters: gentoo
    priority: -10001

bobwya
    location: /var/db/repos/bobwya
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/bobwya.git
    masters: gentoo
    priority: -10001

calculate
    location: /var/db/repos/calculate
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/calculate.git
    masters: gentoo
    priority: -10001

go-overlay
    location: /var/db/repos/go-overlay
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/go-overlay.git
    masters: gentoo
    priority: -10001

linxon
    location: /var/db/repos/linxon
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/linxon.git
    masters: gentoo
    priority: -10001

pdm-bashtop
    location: /var/lib/layman/pdm-bashtop
    sync-type: laymansync
    sync-uri: https://gitlab.com/gentoo-pdm/sys-process/bashtop/pdm-bashtop.git
    masters: gentoo
    priority: -10001

pdm-screenkey
    location: /var/lib/layman/pdm-screenkey
    sync-type: laymansync
    sync-uri: https://gitlab.com/gentoo-pdm/x11-misc/screenkey/pdm-screenkey.git
    masters: gentoo
    priority: -10001

pentoo
    location: /var/db/repos/pentoo
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/pentoo.git
    masters: gentoo
    priority: -10001

raiagent
    location: /var/db/repos/raiagent
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/raiagent.git
    masters: gentoo
    priority: -10001

rukruk
    location: /var/db/repos/rukruk
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/rukruk.git
    masters: gentoo
    priority: -10001

seden
    location: /var/db/repos/seden
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/seden.git
    masters: gentoo
    priority: -10001

smoverlay
    location: /var/db/repos/smoverlay
    sync-type: git
    sync-uri: https://git.s-morozov.net/gentoo-overlays/smoverlay.git
    masters: gentoo
    priority: -10001

thegreatmcpain
    location: /var/db/repos/thegreatmcpain
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/thegreatmcpain.git
    masters: gentoo bobwya
    priority: -10001

waebbl
    location: /var/db/repos/waebbl
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/waebbl.git
    masters: gentoo raiagent
    priority: -10001

gentoo
    location: /var/db/repos/gentoo
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts: 
    sync-rsync-verify-metamanifest: no
    sync-rsync-verify-jobs: 1
    sync-rsync-verify-max-age: 24

ricerlay
    location: /var/db/repos/ricerlay
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/ricerlay.git
    masters: gentoo

das-labor
    location: /var/lib/layman/das-labor
    sync-type: laymansync
    sync-uri: https://github.com/das-labor/overlay.git
    masters: gentoo
    priority: 50

gnu-elpa
    location: /var/lib/layman/gnu-elpa
    sync-type: laymansync
    sync-uri: gs-elpa gnu-elpa
    masters: gentoo
    priority: 50

melpa
    location: /var/lib/layman/melpa
    sync-type: laymansync
    sync-uri: gs-elpa melpa
    masters: gnu-elpa gentoo
    priority: 50

vayerx
    location: /var/lib/layman/vayerx
    sync-type: laymansync
    sync-uri: https://github.com/vayerx/vayerx-gentoo.git
    masters: gentoo
    priority: 50

local-repo
    location: /var/db/repos/local-repo
    masters: gentoo
    priority: 10000

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=skylake -mtune=skylake   -O2             -pipe    "
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php7.4/ext-active/ /etc/php/cgi-php7.4/ext-active/ /etc/php/cli-php7.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=skylake -mtune=skylake   -O2             -pipe        "
DISTDIR="/var/cache/distfiles"
EMERGE_DEFAULT_OPTS="--alert y 			--alphabetical 		--ask-enter-invalid 			--autounmask y  		--autounmask-only n  			--autounmask-unrestricted-atoms y  			--autounmask-write y 			--misspell-suggestions n 			--noconfmem 		--nospinner   			--tree 			--with-bdeps y"
ENV_UNSET="DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-march=skylake -mtune=skylake   -O2             -pipe    "
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms split-elog strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-march=skylake -mtune=skylake   -O2             -pipe    "
GENTOO_MIRRORS="http://ftp.free.fr/mirrors/ftp.gentoo.org/ https://mirrors.evowise.com/gentoo/ http://mirror.dkm.cz/gentoo/ http://mirror.eu.oneandone.net/linux/distributions/gentoo/gentoo/ http://mirror.netcologne.de/gentoo/ http://mirror.leaseweb.com/gentoo/ http://mirror.bytemark.co.uk/gentoo/ http://gentoo.mirror.web4u.cz/ http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/"
LANG="fr_FR.utf8"
LDFLAGS="  -Wl,-O1       -Wl,-fuse-ld=bfd  -Wl,--enable-new-dtags  -Wl,-z,relro -Wl,-z,now -fno-plt -march=skylake -mtune=skylake   -O2             -pipe     "
LINGUAS="fr"
MAKEOPTS="-j3 -l3"
PKGDIR="/var/cache/binpkgs"
PORTAGE_COMPRESS="lzma"
PORTAGE_COMPRESS_FLAGS="-9"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="amd64 asm libglvnd minimal split-usr" ABI_X86="64" ALSA_CARDS="hda-intel" CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt sse sse2 sse3 sse4_1 sse4_2 ssse3" ELIBC="glibc" GRUB_PLATFORMS="pc" INPUT_DEVICES="libinput" KERNEL="linux" L10N="fr" PHP_TARGETS="php7-4" PYTHON_SINGLE_TARGET="python3_7" PYTHON_TARGETS="python2_7 python3_6 python3_7" QEMU_USER_TARGETS="aarch64" RUBY_TARGETS="ruby25" USERLAND="GNU" VIDEO_CARDS="intel i965 iris"
Unset:  CC, CPPFLAGS, CTARGET, CXX, INSTALL_MASK, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

media-gfx/blender-2.83.4::gentoo was built with the following:
USE="-abi6-compat -abi7-compat alembic bullet collada color-management -cuda cycles dds -debug -doc elbeem ffmpeg fftw -headless jack jemalloc -jpeg2k llvm -man -ndof -nls -openal -opencl openexr openimageio openmp -opensubdiv -openvdb osl -sdl sndfile -standalone system-numpy system-python tbb -test tiff -valgrind" ABI_X86="(64)" PYTHON_SINGLE_TARGET="python3_7"
CFLAGS="-march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize -funsigned-char"
CXXFLAGS="-march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize -funsigned-char"
FEATURES="distlocks parallel-fetch binpkg-logs unmerge-logs split-elog usersync unknown-features-warn ipc-sandbox sandbox preserve-libs config-protect-if-modified multilib-strict pid-sandbox fixlafiles strict qa-unresolved-soname-deps binpkg-docompress binpkg-dostrip protect-owned unmerge-orphans news userpriv network-sandbox userfetch assume-digests usersandbox merge-sync sfperms ebuild-locks"
LDFLAGS="-Wl,-O1 -Wl,-fuse-ld=bfd -Wl,--enable-new-dtags -Wl,-z,relro -Wl,-z,now -fno-plt -march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize"


Reproducible: Always




Comment 1


CaptainBlood





          2020-08-25 00:20:32 UTC
        

Created attachment 656536 [details]
strace log file




Comment 2


Sam James









          2020-08-25 00:24:35 UTC
        

I really need you to try again with vanilla CFLAGS/LDFLAGS, because the emerge --info for Blender claims it wasn't built with those:

>CFLAGS="-march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize -funsigned-char"
>CXXFLAGS="-march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize -funsigned-char"
>LDFLAGS="-Wl,-O1 -Wl,-fuse-ld=bfd -Wl,--enable-new-dtags -Wl,-z,relro -Wl,-z,now -fno-plt -march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize"

Also, a gdb backtrace would be enormously helpful.




Comment 3


CaptainBlood





          2020-08-25 02:53:58 UTC
        

Created attachment 656538 [details]
build log

emerge --info blender
--- Invalid atom in /var/db/repos/go-overlay/profiles/package.mask: Slot deps are not allowed in EAPI 0: 'dev-lang/go:stable'
 * Failed to change nice value to '-10'
 * [Errno 1] Operation not permitted

Portage 2.3.103 (python 3.7.8-final-0, default/linux/amd64/17.1, gcc-9.3.0, glibc-2.31-r6, 5.8.3-gentoo-classic x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-5.8.3-gentoo-classic-x86_64-Intel-R-_Core-TM-_i3-6100_CPU_@_3.70GHz-with-gentoo-2.6
KiB Mem:     3939304 total,   1581116 free
KiB Swap:    8048528 total,   7185172 free
Timestamp of repository audio-overlay: Sat, 22 Aug 2020 11:05:17 +0000
Head commit of repository audio-overlay: 39303757c710a55234bcd0c80c2bf57c5e88936d

Timestamp of repository bobwya: Sun, 16 Aug 2020 18:35:35 +0000
Head commit of repository bobwya: a894ae5971064205dc5339e33475cab02cda8fec

Timestamp of repository calculate: Mon, 24 Aug 2020 13:05:23 +0000
Head commit of repository calculate: fb522b416e22128502ca3ea5bd09d8c5ab9a725f

Timestamp of repository go-overlay: Mon, 10 Aug 2020 09:13:55 +0000
Head commit of repository go-overlay: 56b684348b133aedbdb0be40bc3dd3a1fd499553

Timestamp of repository linxon: Sat, 15 Aug 2020 17:05:43 +0000
Head commit of repository linxon: 45a41bce24a71d4db09dbf2f021909b966e2667c

Timestamp of repository pentoo: Mon, 24 Aug 2020 16:35:22 +0000
Head commit of repository pentoo: f46397ed47af853323e62a822a86d339f5422c4a

Timestamp of repository raiagent: Sat, 22 Aug 2020 16:35:22 +0000
Head commit of repository raiagent: d951a267ed2cbbcda6015a5703722a5f04740742

Timestamp of repository rukruk: Mon, 10 Aug 2020 09:14:03 +0000
Head commit of repository rukruk: 1625c3550184d3f8ab6d10488b5b4829e667f2c8

Timestamp of repository seden: Mon, 17 Aug 2020 06:35:29 +0000
Head commit of repository seden: 55dc9e703d356b0c33bf2ec4f4a49b2eb791b675

Head commit of repository smoverlay: 01a4b5763a6cd79016a3230f5820b224f011a44f

Timestamp of repository thegreatmcpain: Mon, 24 Aug 2020 18:35:16 +0000
Head commit of repository thegreatmcpain: 12c32b7aae72e10ce54a9e7827d946a70c23afee

Timestamp of repository waebbl: Mon, 17 Aug 2020 22:05:52 +0000
Head commit of repository waebbl: af1bd1549b2c3e0575e934a7047e1c97603a011a

Timestamp of repository gentoo: Mon, 24 Aug 2020 20:00:01 +0000
Head commit of repository gentoo: c80fca90be7557f9422f131df9557ef08716b499
Timestamp of repository ricerlay: Sun, 23 Aug 2020 09:05:19 +0000
Head commit of repository ricerlay: 5a8ffbc3f345c11bc276a0ae0a54d3fc2176437b

sh bash 5.0_p18
ld GNU ld (Gentoo 2.33.1 p2) 2.33.1
distcc 3.3.3 x86_64-pc-linux-gnu [disabled]
app-shells/bash:          5.0_p18::gentoo
dev-java/java-config:     2.3.1::gentoo
dev-lang/perl:            5.30.3::gentoo
dev-lang/python:          2.7.18-r1::gentoo, 3.6.11-r2::gentoo, 3.7.8-r2::gentoo, 3.8.5::gentoo
dev-util/cmake:           3.16.5::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.6-r1::gentoo
sys-apps/openrc:          0.42.1::gentoo
sys-apps/sandbox:         2.18::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.16.1-r1::gentoo
sys-devel/binutils:       2.33.1-r1::gentoo
sys-devel/gcc:            9.3.0-r1::gentoo, 10.2.0-r1::gentoo
sys-devel/gcc-config:     2.3.1::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 5.7::gentoo (virtual/os-headers)
sys-libs/glibc:           2.31-r6::gentoo
Repositories:

audio-overlay
    location: /var/db/repos/audio-overlay
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/audio-overlay.git
    masters: gentoo
    priority: -10001

bobwya
    location: /var/db/repos/bobwya
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/bobwya.git
    masters: gentoo
    priority: -10001

calculate
    location: /var/db/repos/calculate
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/calculate.git
    masters: gentoo
    priority: -10001

go-overlay
    location: /var/db/repos/go-overlay
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/go-overlay.git
    masters: gentoo
    priority: -10001

linxon
    location: /var/db/repos/linxon
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/linxon.git
    masters: gentoo
    priority: -10001

pdm-bashtop
    location: /var/lib/layman/pdm-bashtop
    sync-type: laymansync
    sync-uri: https://gitlab.com/gentoo-pdm/sys-process/bashtop/pdm-bashtop.git
    masters: gentoo
    priority: -10001

pdm-screenkey
    location: /var/lib/layman/pdm-screenkey
    sync-type: laymansync
    sync-uri: https://gitlab.com/gentoo-pdm/x11-misc/screenkey/pdm-screenkey.git
    masters: gentoo
    priority: -10001

pentoo
    location: /var/db/repos/pentoo
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/pentoo.git
    masters: gentoo
    priority: -10001

raiagent
    location: /var/db/repos/raiagent
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/raiagent.git
    masters: gentoo
    priority: -10001

rukruk
    location: /var/db/repos/rukruk
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/rukruk.git
    masters: gentoo
    priority: -10001

seden
    location: /var/db/repos/seden
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/seden.git
    masters: gentoo
    priority: -10001

smoverlay
    location: /var/db/repos/smoverlay
    sync-type: git
    sync-uri: https://git.s-morozov.net/gentoo-overlays/smoverlay.git
    masters: gentoo
    priority: -10001

thegreatmcpain
    location: /var/db/repos/thegreatmcpain
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/thegreatmcpain.git
    masters: gentoo bobwya
    priority: -10001

waebbl
    location: /var/db/repos/waebbl
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/waebbl.git
    masters: gentoo raiagent
    priority: -10001

gentoo
    location: /var/db/repos/gentoo
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-metamanifest: no
    sync-rsync-verify-jobs: 1
    sync-rsync-verify-max-age: 24
    sync-rsync-extra-opts: 

ricerlay
    location: /var/db/repos/ricerlay
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/ricerlay.git
    masters: gentoo

das-labor
    location: /var/lib/layman/das-labor
    sync-type: laymansync
    sync-uri: https://github.com/das-labor/overlay.git
    masters: gentoo
    priority: 50

gnu-elpa
    location: /var/lib/layman/gnu-elpa
    sync-type: laymansync
    sync-uri: gs-elpa gnu-elpa
    masters: gentoo
    priority: 50

melpa
    location: /var/lib/layman/melpa
    sync-type: laymansync
    sync-uri: gs-elpa melpa
    masters: gnu-elpa gentoo
    priority: 50

vayerx
    location: /var/lib/layman/vayerx
    sync-type: laymansync
    sync-uri: https://github.com/vayerx/vayerx-gentoo.git
    masters: gentoo
    priority: 50

local-repo
    location: /var/db/repos/local-repo
    masters: gentoo
    priority: 10000

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -mtune=native   -O2             -pipe    "
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php7.4/ext-active/ /etc/php/cgi-php7.4/ext-active/ /etc/php/cli-php7.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=native -mtune=native   -O2             -pipe        "
DISTDIR="/var/cache/distfiles"
EMERGE_DEFAULT_OPTS="--alert y 			--alphabetical 			--ask-enter-invalid 			--autounmask y  			--autounmask-only n  			--autounmask-unrestricted-atoms y  			--autounmask-write y 			--misspell-suggestions n 			--noconfmem 			--nospinner   			--tree 			--with-bdeps y"
ENV_UNSET="DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-march=native -mtune=native   -O2             -pipe    "
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms split-elog strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-march=native -mtune=native   -O2             -pipe    "
GENTOO_MIRRORS="http://ftp.free.fr/mirrors/ftp.gentoo.org/ https://mirrors.evowise.com/gentoo/ http://mirror.dkm.cz/gentoo/ http://mirror.eu.oneandone.net/linux/distributions/gentoo/gentoo/ http://mirror.netcologne.de/gentoo/ http://mirror.leaseweb.com/gentoo/ http://mirror.bytemark.co.uk/gentoo/ http://gentoo.mirror.web4u.cz/ http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/"
LANG="fr_FR.utf8"
LDFLAGS="  -Wl,-O1       -Wl,-fuse-ld=bfd       -march=native -mtune=native   -O2             -pipe     "
LINGUAS="fr"
MAKEOPTS="-j3 -l3"
PKGDIR="/var/cache/binpkgs"
PORTAGE_COMPRESS="lzma"
PORTAGE_COMPRESS_FLAGS="-9"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="amd64 asm libglvnd minimal split-usr" ABI_X86="64" ALSA_CARDS="hda-intel" CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt sse sse2 sse3 sse4_1 sse4_2 ssse3" ELIBC="glibc" GRUB_PLATFORMS="pc" INPUT_DEVICES="libinput" KERNEL="linux" L10N="fr" PHP_TARGETS="php7-4" PYTHON_SINGLE_TARGET="python3_7" PYTHON_TARGETS="python2_7 python3_6 python3_7" QEMU_USER_TARGETS="aarch64" RUBY_TARGETS="ruby25" USERLAND="GNU" VIDEO_CARDS="intel i965 iris"
Unset:  CC, CPPFLAGS, CTARGET, CXX, INSTALL_MASK, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

media-gfx/blender-2.83.4::gentoo was built with the following:
USE="-abi6-compat -abi7-compat alembic bullet collada color-management -cuda cycles dds -debug -doc elbeem ffmpeg fftw -headless jack jemalloc -jpeg2k llvm -man -ndof -nls -openal -opencl openexr openimageio openmp -opensubdiv -openvdb osl -sdl sndfile -standalone system-numpy system-python tbb -test tiff -valgrind" ABI_X86="(64)" PYTHON_SINGLE_TARGET="python3_7"
CFLAGS="-march=native -mtune=native -O2 -pipe -ftree-loop-vectorize -funsigned-char"
CXXFLAGS="-march=native -mtune=native -O2 -pipe -ftree-loop-vectorize -funsigned-char"
FEATURES="unmerge-logs sfperms parallel-fetch unmerge-orphans ipc-sandbox multilib-strict unknown-features-warn split-elog fixlafiles preserve-libs ebuild-locks news userpriv usersync pid-sandbox distlocks sandbox qa-unresolved-soname-deps network-sandbox binpkg-logs strict config-protect-if-modified assume-digests binpkg-docompress userfetch protect-owned usersandbox merge-sync binpkg-dostrip"
LDFLAGS="-Wl,-O1 -Wl,-fuse-ld=bfd -march=native -mtune=native -O2 -pipe -ftree-loop-vectorize"




Comment 4


CaptainBlood





          2020-08-28 16:47:09 UTC
        

     Installed versions:  2.83.4^t(00:09:31 26/08/2020)(alembic bullet collada color-management cycles dds elbeem ffmpeg fftw jack jemalloc jpeg2k llvm openexr openimageio openmp opensubdiv sndfile standalone system-numpy system-python tbb tiff -abi6-compat -abi7-compat -cuda -debug -doc -headless -man -ndof -nls -openal -opencl -openvdb -osl -sdl -test -valgrind PYTHON_SINGLE_TARGET="python3_7")

openvdb [with no nvidia] & osl are segfault showstopper here.
Didn't test man ndof nls opencl sdl valgrind, not expecting major issue but from opencl possibly due to environment integration.

Thks 4 ur attention, interest & support.




Comment 5


Adrian





          2020-08-28 19:26:30 UTC
        

I am not able to replicate this here.

I have tried enabling the use flags in your report: USE="alembic bullet collada color-management cycles dds elbeem ffmpeg fftw jack jemalloc jpeg2k llvm openexr openimageio openmp opensubdiv sndfile standalone system-numpy system-python tbb tiff -abi6-compat -abi7-compat -cuda -debug -doc -headless -man -ndof -nls -openal -opencl -openvdb -osl -sdl -test -valgrind" ABI_X86="(64)" PYTHON_SINGLE_TARGET="python3_7" and blender compiles and runs. From what I understand, you were able to build this version and it works for you.

I have also tried enabling openvdb and osl but not cuda giving USE="abi7-compat alembic bullet collada color-management cycles dds elbeem ffmpeg fftw jack jemalloc jpeg2k llvm openexr openimageio openmp opensubdiv openvdb osl sndfile standalone system-numpy system-python tbb tiff -abi6-compat -cuda -debug -doc -headless -man -ndof -nls -openal -opencl -sdl -test -valgrind" ABI_X86="(64)" PYTHON_SINGLE_TARGET="python3_7" and blender compiles and runs. I provide my emerge --info blender for comparison.

I am able to open blender and render the default cube with both eevee and cycles.

As Sam mentioned, a backtrace would be useful.




Comment 6


Adrian





          2020-08-28 19:27:33 UTC
        

Created attachment 657338 [details]
Working blender USE flags on my system




Comment 7


CaptainBlood





          2020-08-29 00:21:33 UTC
        

Trying my best...
By no nvidia I meant USE=-cuda along with no Nvidia hardware aboard nor configured at OS level.
Plz note both clang:9 & clang:10 installed here, as far as USE=osl is concerned.
In this respect, I'll try to force :9 via /etc/portage/package.env.

But first, currently testing openvdb with:
dev-libs/c-blosc
Installed versions:  1.19.0(0/1)^t(03:11:52 29/08/2020)(-lz4 -snappy -test -zlib -zstd)

dev-libs/log4cplus
Installed versions:  1.2.0(0/1.2-5)(03:11:39 29/08/2020)(-iconv -qt5 -threads -working-c-locale -working-locale).

Will strace segfault cases.

Thks 4 ur attention, interest & support.




Comment 8


Sam James









          2020-08-29 00:24:18 UTC
        

(In reply to CaptainBlood from comment #3)
> =================================================================
>                         Package Settings
> =================================================================
> 
> media-gfx/blender-2.83.4::gentoo was built with the following:
> USE="-abi6-compat -abi7-compat alembic bullet collada color-management -cuda
> cycles dds -debug -doc elbeem ffmpeg fftw -headless jack jemalloc -jpeg2k
> llvm -man -ndof -nls -openal -opencl openexr openimageio openmp -opensubdiv
> -openvdb osl -sdl sndfile -standalone system-numpy system-python tbb -test
> tiff -valgrind" ABI_X86="(64)" PYTHON_SINGLE_TARGET="python3_7"
> CFLAGS="-march=native -mtune=native -O2 -pipe -ftree-loop-vectorize
> -funsigned-char"
> CXXFLAGS="-march=native -mtune=native -O2 -pipe -ftree-loop-vectorize
> -funsigned-char"
> FEATURES="unmerge-logs sfperms parallel-fetch unmerge-orphans ipc-sandbox
> multilib-strict unknown-features-warn split-elog fixlafiles preserve-libs
> ebuild-locks news userpriv usersync pid-sandbox distlocks sandbox
> qa-unresolved-soname-deps network-sandbox binpkg-logs strict
> config-protect-if-modified assume-digests binpkg-docompress userfetch
> protect-owned usersandbox merge-sync binpkg-dostrip"
> LDFLAGS="-Wl,-O1 -Wl,-fuse-ld=bfd -march=native -mtune=native -O2 -pipe
> -ftree-loop-vectorize"

I still really need you to rebuild this with vanilla CFLAGS, CXXFLAGS, and LDFLAGS.




Comment 9


CaptainBlood





          2020-08-29 01:21:53 UTC
        

Truly confused about openvdb as it seems to have been build here only once & that is now!!!

Beside that, blender runs fine here with
Installed versions:  2.83.4^t(03:52:13 29/08/2020)(abi7-compat alembic bullet collada color-management cycles dds elbeem ffmpeg fftw jack jemalloc jpeg2k llvm openexr openimageio openmp opensubdiv openvdb sndfile standalone system-numpy system-python tbb tiff -abi6-compat -cuda -debug -doc -headless -man -ndof -nls -openal -opencl -osl -sdl -test -valgrind PYTHON_SINGLE_TARGET="python3_7")

emerge --info:
CFLAGS="-march=skylake -mtune=skylake -O2 -pipe"
CXXFLAGS="-march=skylake -mtune=skylake -O2 -pipe"
LDFLAGS="-Wl,-O1 -Wl,-fuse-ld=bfd -march=skylake -mtune=skylake -O2 -pipe"

emerge --info blender:
media-gfx/blender-2.83.4::gentoo was built with the following:
USE="-abi6-compat abi7-compat alembic bullet collada color-management -cuda cycles dds -debug -doc elbeem ffmpeg fftw -headless jack jemalloc jpeg2k llvm -man -ndof -nls -openal -opencl openexr openimageio openmp opensubdiv openvdb -osl -sdl sndfile standalone system-numpy system-python tbb -test tiff -valgrind" ABI_X86="(64)" PYTHON_SINGLE_TARGET="python3_7"
CFLAGS="-march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize -funsigned-char"
CXXFLAGS="-march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize -funsigned-char"
FEATURES="pid-sandbox sandbox binpkg-logs news preserve-libs merge-sync sfperms config-protect-if-modified usersync distlocks assume-digests qa-unresolved-soname-deps multilib-strict fixlafiles ebuild-locks strict unmerge-logs binpkg-dostrip protect-owned network-sandbox unknown-features-warn binpkg-docompress unmerge-orphans userpriv ipc-sandbox usersandbox userfetch parallel-fetch split-elog"
LDFLAGS="-Wl,-O1 -Wl,-fuse-ld=bfd -march=skylake -mtune=skylake -O2 -pipe -ftree-loop-vectorize"

So I guess your request for vanilla would be to remove CPU & link optimisation, since it appears all -fxyz are coming from blender itself.

Again, I'm truly sorry for what seems a stupid mistake on my part.

The remaining bit, e.g. osl has been definively built here, let's see if I can fix something about it, forcing clang:9 as I suspect package to call for unversioned clang.




Comment 10


Sam James









          2022-02-26 02:17:11 UTC
        

I think we're all good now?

Additionally, I think we've mostly sorted out the scary issues with OpenVDB.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

