Title: 131965 – emerge glibc-2.3.6-r* causes system to segfault
URL: https://bugs.gentoo.org/show_bug.cgi?id=131965

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 131965
emerge glibc-2.3.6-r* causes system to segfault
Last modified: 2007-03-13 06:37:36 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 131965 
      - emerge glibc-2.3.6-r* causes system to segfault


Summary:
emerge glibc-2.3.6-r* causes system to segfault
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-05-01 15:09 UTC by Adam Pyschny





      Modified:
    
2007-03-13 06:37 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



temp









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




the complete log of emerge glibc

              (glibc-2.3.6-r3.log.bz2,168.37 KB,
                text/bzip2)

            
2006-05-09 14:42 UTC,

            Adam Pyschny




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Adam Pyschny





          2006-05-01 15:09:07 UTC
        

I did a emerge sync a few days ago, emerge -au world showed that glibc will be updated from 2.3.5-r3 to 2.3.6-r3, i thought ok, do it, and ran the update.

Downloading and compiling of glibc-2.3.6-r3 was fine, then portage copies the new files from the sandbox to the system. While copying a segmentation fault appears after the line

>>> /sbin/ldconfig

(Well, i did that several times now, sometimes it happens before the line, sometimes after)

Then, almost every command I type exits with a segmantation fault and weird Ascii-output, rebooting isnt possible anymore because the boot-scripts segfault, too.

I booted with the gentoo-livecd, but chrooting into my system fails again with a segfault.

So I built bin-packages of glibc 2.3.6-r3 and glibc 2.3.5-r3 on another pc, when untaring 2.3.6-r3 to my system chroot still isnt possible, when untaring 2.3.5-r3 i can chroot.

After chroot, emerge the 2.3.6-r3 version still doesnt work(it still fails with a segfault, system is unusable then, but I can exit and copy glibc-2.3.5-r3 over), downgrading glibc by emerge =glibc-2.3.5-r3 doesent work too(segfaults again..), but when I first umerge glibc completely and then run emerge =glibc-2.3.5-r3 everything works fine. (Unmerging glibc and emerge glibc-2.3.6-r3 still fails)

Well, I can reboot my system and everything seems ok, but I don't want to be forced to glibc-2.3-5-r3, 2.3.6-r3 is marked as stable, so whats the problem with my config?

Here is my emerge --info output
fieserschleppi fieserkiller # emerge --info
Portage 2203-svn (default-linux/x86/2006.0, gcc-3.4.5, glibc-2.3.5-r3, 2.6.15-suspend2-r8 i686)
=================================================================
System uname: 2.6.15-suspend2-r8 i686 Mobile Intel(R) Pentium(R) 4 - M CPU 1.80GHz
Gentoo Base System version 1.6.14
dev-lang/python:     2.4.2
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-Os -march=pentium4 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/lib/X11/xkb /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/eselect/compiler /etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-Os -march=pentium4 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/ "
LANG="de_DE@euro"
LC_ALL="de_DE@euro"
LINGUAS="de en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="X acpi alsa apache2 audiofile avi bash-completion berkdb bitmap-fonts bzip2 cdr cli crypt cups curl dri dv dvd eds emboss encode esd exif expat fam foomaticdb fortran ftp gd gdbm gif gimpprint glut gstreamer gtk gtk2 icq imagemagick imlib isdnlog java jpeg lcms libg++ libwww lirc mad madwifi mikmod mmx mmxext mng motif mp3 mpeg ncurses nls nptl nptlonly nsplugin offensive ogg opengl oscar pam pcre pdf pdflib perl png pppd python quicktime readline reflection samba sdl session spell spl sqlite sse sse2 ssl svg tcpd tiff truetype truetype-fonts type1-fonts udev unicode usb vcd vorbis wifi win32codecs x86 xine xinerama xml xml2 xmms xorg xv xvid zlib linguas_de linguas_en userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, INSTALL_MASK, LDFLAGS, PORTDIR_OVERLAY




Comment 1


SpanKY






          2006-05-02 20:09:51 UTC
        

try building without -Os




Comment 2


Adam Pyschny





          2006-05-03 01:07:35 UTC
        

(In reply to comment #1)
> try building without -Os

I did already, no difference.

Btw, I think the ebuid filters -Os and replaces it automatically by -O2






Comment 3


Michael Crawford (ali3nx)





          2006-05-03 19:53:12 UTC
        

I'm also experiencing some build errors in the linuxthreads build of 2.3.6-r3 on a bunch of headless hardened amd64's I admin in production for an hlds gameserver host. I found this bug and thought it might be a good place to add to it.considering the version is identical. Below is the section that fails. It's not related to clock skew as I have ntp updated the system clocks before trying a second rebuild. Kernel versions on all eight servers this build fails on in the same spot range from 2.6.14-hardened-r3 to 2.6.16-hardened. emerge info included below for one of the servers.

make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/csu'
/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a(strlen.o): In function `strlen':
../sysdeps/x86_64/strlen.S:(.text+0x145): undefined reference to `_rtld_global_ro'
/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a(memset.o): In function `memset':
../sysdeps/x86_64/memset.S:(.text+0xd3): undefined reference to `_rtld_global_ro'
../sysdeps/x86_64/memset.S:(.text+0x103): undefined reference to `_rtld_global_ro'
/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a(mempcpy.o): In function `mempcpy':
../sysdeps/x86_64/mempcpy.S:(.text+0x123): undefined reference to `_rtld_global_ro'
../sysdeps/x86_64/mempcpy.S:(.text+0x173): undefined reference to `_rtld_global_ro'
/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a(mempcpy.o):../sysdeps/x86_64/mempcpy.S:(.text+0x293): more undefined references to `_rtld_global_ro' follow
collect2: ld returned 1 exit status
make[2]: *** [/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/sln] Error 1
make[2]: *** Waiting for unfinished jobs....
make -C ../gmon objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-profil.os rtld-prof-freq.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/gmon'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/gmon'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/csu'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/csu'
make -C ../io objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-xstat.os rtld-fxstat.os rtld-open.os rtld-close.os rtld-read.os rtld-write.os rtld-access.os rtld-fcntl.os rtld-getcwd.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/gmon'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/gmon'
make -C ../linuxthreads objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-forward.os rtld-libc-cancellation.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/io'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/io'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/linuxthreads'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/io'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/io'
make -C ../misc objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-getpagesize.os rtld-mmap.os rtld-munmap.os rtld-mprotect.os rtld-madvise.os rtld-init-misc.os rtld-llseek.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/misc'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/misc'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/linuxthreads'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/misc'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/misc'
make -C ../posix objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-uname.os rtld-_exit.os rtld-getpid.os rtld-environ.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/posix'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/posix'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/linuxthreads'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/linuxthreads'
make -C ../setjmp objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-bsd-_setjmp.os rtld-__longjmp.os rtld-setjmp.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/setjmp'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/setjmp'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/posix'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/posix'
make -C ../signal objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-sigaction.os rtld-sigprocmask.os rtld-kill.os rtld-sigfillset.os rtld-sigdelset.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/setjmp'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/setjmp'
make -C ../stdlib objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-exit.os rtld-cxa_atexit.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/signal'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/signal'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/stdlib'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/stdlib'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/signal'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/signal'
make -C ../string objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-strchr.os rtld-strcmp.os rtld-strlen.os rtld-strnlen.os rtld-memchr.os rtld-memmove.os rtld-memset.os rtld-mempcpy.os rtld-stpcpy.os rtld-memcpy.os rtld-wordcopy.os rtld-strrchr.os rtld-rawmemchr.os'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/string'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/stdlib'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/stdlib'
make -C ../time objdir=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -f Makefile -f ../elf/rtld-Rules rtld-all rtld-modules='rtld-gettimeofday.os rtld-setitimer.os'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/string'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/time'
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/time'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/time'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/time'
make[4]: Entering directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/string'
make[4]: Nothing to be done for `rtld-all'.
make[4]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/string'
make[3]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/elf'
make[2]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/elf'
make[1]: *** [elf/others] Error 2
make[1]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6'
make: *** [all] Error 2

!!! ERROR: sys-libs/glibc-2.3.6-r3 failed.
!!! Function toolchain-glibc_src_compile, Line 251, Exitcode 2
!!! make for amd64 failed
!!! If you need support, post the topmost build error, NOT this status message.


emerge info
Portage 2.0.54 (default-linux/amd64/2006.0, gcc-3.4.5, glibc-2.3.5-r2, 2.6.16-hardened x86_64)
=================================================================
System uname: 2.6.16-hardened x86_64 Intel(R) Xeon(TM) CPU 3.20GHz
Gentoo Base System version 1.6.14
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
dev-lang/python:     2.4.2
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=nocona -Os -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/eselect/compiler /etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=nocona -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig candy ccache distlocks sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.du.se/pub/os/gentoo ftp://ftp.linux.ee/pub/gentoo/distfiles/ ftp://trumpetti.atm.tut.fi/gentoo/ http://ftp.du.se/pub/os/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /usr/local/gentoo-webapps-overlay/experimental /usr/local/gentoo-webapps-overlay/production-ready"
SYNC="rsync://rsync1.excellent-servers.se/gentoo-portage"
USE="amd64 acl acpi apache2 authdaemond avi bash-completion berkdb bitmap-fonts bzip2 bzlib ccache chroot cli cluster crypt ctype cups curl curlwrappers dba dio dri eds emboss encode erandom exif expat extensions fam foomaticdb fortran freetds ftp gd gdbm gif gmp gpm hardened icu idn imagemagick imap imlib innodb ipv6 ipv6arpa isdnlog ithreads java javamail jpeg kde ldap libg++ libwww lzw lzw-tiff maildir memlimit mhash mmext mp3 mpeg mpi mysql nagios-dns nagios-ntp nagios-ping nagios-ssh ncurses neural nis nls nptl nptlonly objc odbc offensive pam pcntl pcre pdflib perl pg-hier pg-intdatetime pg-vacuumdelay php pic png posix postgres pppd procmail python pyzor razor readline reflection ruby sasl sendfile session sftplogging shaper shared sharedext sharedmem simplexml snmp sockets softquota spl ssl sysvipc szip tcpd threads tiff truetype truetype-fonts type1-fonts udev unicode urandom usb utf8 vda virtual-users virus-scan wddx wmf xinetd xml xml2 xmlrpc xorg xsl xv yaz zlib userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS





Comment 4


Michael Crawford (ali3nx)





          2006-05-03 19:55:39 UTC
        

appended note. nptlonly is force excluded in package.use because 64bit hlds binaries framerates seem to drop considerably with nptlonly and 250mhz kernel frequency. Ignore the nptlonly in emerge info




Comment 5


SpanKY






          2006-05-03 20:23:26 UTC
        

completely unrelated, see Bug 124682




Comment 6


Brenden Matthews





          2006-05-03 21:08:05 UTC
        

Same issue here.  Had no problems emerging 2.3.5-r3.  Heres my resulting error:

.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linuxuxthreads/dlfcn/libdl.so.2  -Wl,-rpath-link=/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreadr/tmp/c-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/math:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/dlfcn:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/nss:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/nis:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/rt:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/resolv:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/crypt:/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/linuxthreads /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.so.6 /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc_nonshared.a -lgcc -Wl,--as-needed -lgcc_s  -Wl,--no-as-needed `x86_64-pc-linux-gnu-gcc --print-file-name=crtend.o` /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/csu/crtn.o
LC_ALL=C sed -e 's%@RTLD@%/lib64/ld-linux-x86-64.so.2%g' -e 's%@VERSION@%2.3.6%g' -e 's%@BASH@%/bin/sh%g' -e 's%@TEXTDOMAINDIR@%/usr/share/locale%g' < ldd.bash.in | LC_ALL=C sed -f ../sysdeps/unix/sysv/linux/x86_64/ldd-rewrite.sed > /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/ldd.new
chmod 555 /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/ldd.new
mv -f /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/ldd.new /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/ldd
x86_64-pc-linux-gnu-gcc sln.c -c -std=gnu99 -O2 -Wall -Winline -Wstrict-prototypes -Wwrite-strings -march=athlon64 -pipe      -I../include -I. -I/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf -I.. -I../libio  -I/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads -I../sysdeps/x86_64/elf -I../linuxthreads/sysdeps/unix/sysv/linux/x86_64 -I../linuxthreads/sysdeps/unix/sysv/linux -I../linuxthreads/sysdeps/pthread -I../sysdeps/pthread -I../linuxthreads/sysdeps/unix/sysv -I../linuxthreads/sysdeps/unix -I../linuxthreads/sysdeps/x86_64 -I../libidn/sysdeps/unix -I../sysdeps/unix/sysv/linux/x86_64 -I../sysdeps/unix/sysv/linux/wordsize-64 -I../sysdeps/unix/sysv/linux -I../sysdeps/gnu -I../sysdeps/unix/common -I../sysdeps/unix/mman -I../sysdeps/unix/inet -I../sysdeps/unix/sysv -I../sysdeps/unix/x86_64 -I../sysdeps/unix -I../sysdeps/posix -I../sysdeps/x86_64/fpu -I../sysdeps/x86_64 -I../sysdeps/wordsize-64 -I../sysdeps/ieee754/ldbl-96 -I../sysdeps/ieee754/dbl-64 -I../sysdeps/ieee754/flt-32 -I../sysdeps/ieee754 -I../sysdeps/generic/elf -I../sysdeps/generic -nostdinc -isystem /usr/lib/gcc/x86_64-pc-linux-gnu/3.4.5/include -isystem /usr/include -D_LIBC_REENTRANT -include ../include/libc-symbols.h  -DPIC -DNOT_IN_libc=1    -o /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/sln.o -MD -MP -MF /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/sln.o.dt -MT /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/sln.o
x86_64-pc-linux-gnu-gcc -nostdlib -nostartfiles -static -o /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/sln   /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/csu/crt1.o /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/csu/crti.o `x86_64-pc-linux-gnu-gcc --print-file-name=crtbegin.o` /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/sln.o  /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a -lgcc -lgcc_eh  /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a `x86_64-pc-linux-gnu-gcc --print-file-name=crtend.o` /var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/csu/crtn.o
/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a(strlen.o): In function `strlen':
../sysdeps/x86_64/strlen.S:(.text+0x145): undefined reference to `_rtld_global_ro'
/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a(memset.o): In function `memset':
../sysdeps/x86_64/memset.S:(.text+0xd3): undefined reference to `_rtld_global_ro'
../sysdeps/x86_64/memset.S:(.text+0x103): undefined reference to `_rtld_global_ro'
/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a(mempcpy.o): In function `mempcpy':
../sysdeps/x86_64/mempcpy.S:(.text+0x123): undefined reference to `_rtld_global_ro'
../sysdeps/x86_64/mempcpy.S:(.text+0x173): undefined reference to `_rtld_global_ro'
/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/libc.a(mempcpy.o):../sysdeps/x86_64/mempcpy.S:(.text+0x293): more undefined references to `_rtld_global_ro' follow
collect2: ld returned 1 exit status
make[2]: *** [/var/tmp/portage/glibc-2.3.6-r3/work/build-amd64-x86_64-pc-linux-gnu-linuxthreads/elf/sln] Error 1
make[2]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6/elf'
make[1]: *** [elf/others] Error 2
make[1]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r3/work/glibc-2.3.6'
make: *** [all] Error 2

!!! ERROR: sys-libs/glibc-2.3.6-r3 failed.
!!! Function toolchain-glibc_src_compile, Line 251, Exitcode 2
!!! make for amd64 failed
!!! If you need support, post the topmost build error, NOT this status message.





Comment 7


SpanKY






          2006-05-03 21:10:16 UTC
        

jesus, cant you read comment #5 ?  stop polluting this bug with unrelated info




Comment 8


Brenden Matthews





          2006-05-03 21:12:10 UTC
        

(In reply to comment #7)
> jesus, cant you read comment #5 ?  stop polluting this bug with unrelated info
> 

My bad, I fail.




Comment 9


SpanKY






          2006-05-05 23:19:22 UTC
        

can you post the full log as an attachment please ?

MAKEOPTS=-j1 emerge glibc >& log




Comment 10


Adam Pyschny





          2006-05-09 14:42:03 UTC
        

Created attachment 86509 [details]
the complete log of emerge glibc

here is the logfile - its compressed with bzip2...

emerge again stopped working after the end of the file with a segmentation fault... 
I already tried a 
emerge --newuse --deep world

but it still doesn't work. Maybe my LC_ALL, locales or userlocales are the problem?




Comment 11


Adam Pyschny





          2006-06-21 15:30:21 UTC
        

Well, glibc-2.3.6-r4 became stable recently, i did an emerge -u world, but this time I quickpkged my old glibc-2.35-r3 first. 
The results were exactly the same, the ebuild compiled fine, after copying the files to it's destinatins portage died with a segfault, than segfalts occured after almost any command.
Booting from cd and copyin glib-2.3.5 mady the system live again, but I have to mask another glibc-version.

Please devs, look into the problem, I'm afraid i won't be able to install any future release of glibc on the system.  

I'll try to build glibc without nptlonly useflag, but I'm almost sure that won't help.... 




Comment 12


Adam Pyschny





          2006-06-21 22:12:51 UTC
        

that didn't help

What can I do?




Comment 13


Adam Pyschny





          2006-06-27 13:12:03 UTC
        

Now, everything segfaults right after the execution of env-update!!

Well, env-update is executed after every emerge by portage, so the system stops working and i have to boot with the livecd and copy glibc 2.3.5-r3 over to be able to chroot in or boot the system.

I already tried a emerge -e system with a selfmade script which automatically copied glibc over when emerge stopped after every package, but that didn't help. I also build the toolchain again - no help. Then I tried env-update.sh and fix_libtool_files.sh but that didn't help too.
Also, I unmerged glibc 2.3.6-r4 and put it to package.mask and reemerged 2.3.5-r3 again, no help.





Comment 14


Peter Weller (RETIRED)






          2007-02-10 11:20:34 UTC
        

Since when does portage execute etc-update after every emerge?




Comment 15


Peter Weller (RETIRED)






          2007-02-10 11:25:07 UTC
        

Ooops, thought you wrote etc-update, not env-update. My mistake :)




Comment 16


SpanKY






          2007-03-13 06:37:36 UTC
        

these versions of glibc are no longer supported ... if glibc-2.5 shows issues, open a new bug report









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

