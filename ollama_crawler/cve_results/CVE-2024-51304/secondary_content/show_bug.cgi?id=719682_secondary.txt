Title: 719682 – dev-perl/Term-ReadLine-Gnu-1.360.0 fails tests ( 'undef isa 'MainWindow' at t/callback.t line 76 )
URL: https://bugs.gentoo.org/show_bug.cgi?id=719682

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 719682
dev-perl/Term-ReadLine-Gnu-1.360.0 fails tests ( 'undef isa 'MainWindow' at t/callback.t line 76 )
Last modified: 2021-05-09 15:13:24 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 719682 
      - dev-perl/Term-ReadLine-Gnu-1.360.0 fails tests ( 'undef isa 'MainWindow' at t/callback.t line 76 )


Summary:
dev-perl/Term-ReadLine-Gnu-1.360.0 fails tests ( 'undef isa 'MainWindow' at t...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Perl team








URL:







Whiteboard:




Keywords:

TESTFAILURE







Depends on:







Blocks:









 





      Reported:
    
2020-04-26 17:18 UTC by Kent Fredric (IRC: kent\n) (RETIRED)





      Modified:
    
2021-05-09 15:13 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



sam









See Also:


690274

595346





Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Kent Fredric (IRC: kent\n) (RETIRED)






          2020-04-26 17:18:29 UTC
        

* Test::Harness Jobs=3
make -j3 --load-average=4 test TEST_VERBOSE=0 
"/usr/bin/perl" -MExtUtils::Command::MM -e 'cp_nonempty' -- Gnu.bs blib/arch/auto/Term/ReadLine/Gnu/Gnu.bs 644
PERL_DL_NONLAZY=1 "/usr/bin/perl" "-MExtUtils::Command::MM" "-MTest::Harness" "-e" "undef *Test::Harness::Switches; test_harness(0, 'blib/lib', 'blib/arch')" t/*.t
t/01test_use.t ... ok                                                   
t/00checkver.t ... ok                                                   
t/02test_use.t ... ok                                                   
t/history.t ...... ok                                                   
===(     100;1  3/8    1/147  0/? )=====================================# Try `/usr/bin/perl -Mblib t/readline.t verbose', if you will.
t/readline.t ..... ok                                                   
t/utf8_binary.t .. ok                                                   
t/utf8_text.t .... ok                                                   
t/callback.t ..... 4/8 No protocol specified

#   Failed test 'undef isa 'MainWindow''
#   at t/callback.t line 76.
#     undef isn't defined
Cannot continue...
# Looks like your test exited with 11 just after 5.
t/callback.t ..... Dubious, test returned 11 (wstat 2816, 0xb00)
Failed 4/8 subtests 

Test Summary Report
-------------------
t/callback.t   (Wstat: 2816 Tests: 5 Failed: 1)
  Failed test:  5
  Non-zero exit status: 11
  Parse errors: Bad plan.  You planned 8 tests but ran 5.
Files=8, Tests=275,  2 wallclock secs ( 0.14 usr  0.06 sys +  1.64 cusr  0.63 csys =  2.47 CPU)
Result: FAIL

Please ignore the execution hint, that's an interactive test and doesn't help the problem with callback.t :)




Comment 1


Kent Fredric (IRC: kent\n) (RETIRED)






          2020-04-26 17:21:39 UTC
        

Also, the test does work just fine, and this doesn't appear to be related to the other T-RL-Gnu bug #690274 or bug #595346




Comment 2


Kent Fredric (IRC: kent\n) (RETIRED)






          2020-04-26 17:26:22 UTC
        

Ooh, I remember where I saw this last. Maybe Tk is trying to load ... and if it is, then this test requires X11. Yay.

grep  -E "(use|require)\s*Tk" -nr .
./t/callback.t:47:    if (eval "use Tk; 1" && $ENV{DISPLAY} && $ENV{DISPLAY} ne '') {
./t/callback.t:48:	ok(1, 'use Tk');
./eg/perlsh:454:	    use Tk;
./eg/ptksh+:12:#	use Tk;
./eg/ptksh+:19:use Tk;
./eg/ptksh+:29:use Tk;
./blib/man1/perlsh.1:156:\&            use Tk;
./blib/script/perlsh:454:	    use Tk;


Uhuh. Yep. Omg.




Comment 3


Kent Fredric (IRC: kent\n) (RETIRED)






          2020-04-26 17:30:02 UTC
        

Reproducing a similar failure:

env DISPLAY="doesntexist" perl -Mblib t/callback.t 
1..8
ok 1 - load done
ok 2 - An object of class 'Term::ReadLine' isa 'Term::ReadLine'
ok 3 - 'Attribs' isa 'Term::ReadLine'
ok 4 - use Tk
not ok 5 - undef isa 'MainWindow'
#   Failed test 'undef isa 'MainWindow''
#   at t/callback.t line 76.
#     undef isn't defined
Cannot continue...
# Looks like your test exited with 25 just after 5.




Comment 4


Andreas K. Hüttel







          2021-05-09 15:13:24 UTC
        

Works fine here.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

