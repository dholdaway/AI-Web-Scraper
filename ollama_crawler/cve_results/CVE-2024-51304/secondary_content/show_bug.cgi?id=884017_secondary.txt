Title: 884017 – net-misc/rclone-1.60.1 - /.../environment:line <snip>: <snip> Segmentation fault ./rclone genautocomplete bash ${PN}.bash
URL: https://bugs.gentoo.org/show_bug.cgi?id=884017

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 884017
net-misc/rclone-1.60.1 - /.../environment:line <snip>: <snip> Segmentation fault ./rclone genautocomplete bash ${PN}.bash
Last modified: 2023-03-05 11:06:18 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 884017 
      - net-misc/rclone-1.60.1 - /.../environment:line <snip>: <snip> Segmentation fault ./rclone genautocomplete bash ${PN}.bash


Summary:
net-misc/rclone-1.60.1 - /.../environment:line <snip>: <snip> Segmentation fa...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Jason Zaman








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2022-12-02 10:49 UTC by Toralf Förster





      Modified:
    
2023-03-05 11:06 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



slashbeast









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge-info.txt

              (emerge-info.txt,17.53 KB,
                text/plain)

            
2022-12-02 10:49 UTC,

            Toralf Förster




Details





emerge-history.txt

              (emerge-history.txt,40.44 KB,
                text/plain)

            
2022-12-02 10:49 UTC,

            Toralf Förster




Details





environment

              (environment,66.22 KB,
                text/plain)

            
2022-12-02 10:49 UTC,

            Toralf Förster




Details





etc.portage.tar.bz2

              (etc.portage.tar.bz2,12.94 KB,
                application/x-bzip)

            
2022-12-02 10:49 UTC,

            Toralf Förster




Details





logs.tar.bz2

              (logs.tar.bz2,5.62 KB,
                application/x-bzip)

            
2022-12-02 10:49 UTC,

            Toralf Förster




Details





net-misc:rclone-1.60.1:20221202-102145.log.bz2

              (net-misc:rclone-1.60.1:20221202-102145.log.bz2,121.65 KB,
                application/x-bzip)

            
2022-12-02 10:49 UTC,

            Toralf Förster




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Toralf Förster






          2022-12-02 10:49:14 UTC
        

>>> Source compiled.
>>> Test phase [not enabled]: net-misc/rclone-1.60.1

>>> Install net-misc/rclone-1.60.1 into /var/tmp/portage/net-misc/rclone-1.60.1/image
/var/tmp/portage/net-misc/rclone-1.60.1/temp/environment: line 1478:    37 Segmentation fault      ./rclone genautocomplete bash ${PN}.bash
 * ERROR: net-misc/rclone-1.60.1::gentoo failed (install phase):
 *   (no error message)

  -------------------------------------------------------------------

  This is an unstable amd64 chroot image at a tinderbox (==build bot)
  name: 17.1_systemd-j4-20221202-050005

  -------------------------------------------------------------------

GNUMAKEFLAGS="$GNUMAKEFLAGS --shuffle"
gcc-config -l:
 [1] x86_64-pc-linux-gnu-12 *
clang/llvm (if any):
Python 3.10.8
Available Rust versions:
  [1]   rust-bin-1.65.0 *
The Glorious Glasgow Haskell Compilation System, version 9.0.2
php cli (if any):
  [1]   php8.1 *

  HEAD of ::gentoo
commit 422e0a78cc4b137d86b076b860d13237524029fd
Author: Repository mirror & CI <repomirrorci@gentoo.org>
Date:   Fri Dec 2 09:46:48 2022 +0000

    2022-12-02 09:46:47 UTC

emerge -qpvO net-misc/rclone
[ebuild  N    ] net-misc/rclone-1.60.1




Comment 1


Toralf Förster






          2022-12-02 10:49:15 UTC
        

Created attachment 839013 [details]
emerge-info.txt




Comment 2


Toralf Förster






          2022-12-02 10:49:16 UTC
        

Created attachment 839015 [details]
emerge-history.txt




Comment 3


Toralf Förster






          2022-12-02 10:49:17 UTC
        

Created attachment 839017 [details]
environment




Comment 4


Toralf Förster






          2022-12-02 10:49:18 UTC
        

Created attachment 839019 [details]
etc.portage.tar.bz2




Comment 5


Toralf Förster






          2022-12-02 10:49:19 UTC
        

Created attachment 839021 [details]
logs.tar.bz2




Comment 6


Toralf Förster






          2022-12-02 10:49:21 UTC
        

Created attachment 839023 [details]
net-misc:rclone-1.60.1:20221202-102145.log.bz2




Comment 7


Toralf Förster






          2022-12-02 10:49:22 UTC
        

The file size of ./files/temp.tar.bz2 is too big (68M) for an upload. For about 8 weeks the link http://tinderbox.zwiebeltoralf.de:31560/17.1_systemd-j4-20221202-050005/var/tmp/tb/issues/20221202-102233-net-misc_rclone-1.60.1/files/temp.tar.bz2 is valid.




Comment 8


Toralf Förster






          2022-12-02 10:49:39 UTC
        

or is this the reproducer for bug 879313 ?




Comment 9


Piotr Karbowski (RETIRED)






          2022-12-02 10:57:26 UTC
        

Looks like bug 879313, can you reproduce it? I wonder what are the conditions to get hit this bug.




Comment 10


Toralf Förster






          2022-12-03 10:05:17 UTC
        

(In reply to Piotr Karbowski from comment #9)
> Looks like bug 879313, can you reproduce it? I wonder what are the
> conditions to get hit this bug.

Seems it is a reproducer.
The condition should be given in  etc.portage.tar.bz2 but honestly - no idea which USE flag combo it is.




Comment 11


Piotr Karbowski (RETIRED)






          2022-12-03 12:31:19 UTC
        

Though the rclone has no USE flags at all, and it's just a golang project that hardly has any dependency on other things beside golang itself. It does not use any system library.

Can you get me the particular binary that crash on you? Like keep the build dir and mail me the binary itself.




Comment 12


Toralf Förster






          2022-12-03 17:47:29 UTC
        

GNUMAKEFLAGS="$GNUMAKEFLAGS --shuffle" is IMO the answer




Comment 13


Toralf Förster






          2022-12-03 17:52:04 UTC
        

b/c even at that image it is not reproduceable




Comment 14


Piotr Karbowski (RETIRED)






          2022-12-03 20:34:46 UTC
        

I would highly doubt that since go build do not use GNU Make, I am most interested if it is runtime thing. If you could grab the actual binary that failed for you, and re-execute it manually, that would give us something, answer whatever the binary is broken, or if it's random failure during runtime and this very binary works sometimes.




Comment 15


Piotr Karbowski (RETIRED)






          2022-12-09 21:35:22 UTC
        

Toralf ping! Can you please check the previous comment? I continue to be unable to reproduce it.




Comment 16


Toralf Förster






          2022-12-09 22:24:00 UTC
        

The problem is that /var/tmp/portage/ is a tmpfs here at the tinderboxes and therefore the failing exe is gone asap.

I could change the tinderbox for this special purpose but would need to know what exactly you'd like to achieve.

So shall I in case of an future failure archive the whole emerge dir and make that archive available for you?




Comment 17


Piotr Karbowski (RETIRED)






          2022-12-10 09:52:54 UTC
        

What I am after is to determinate whatever we get a broken binary that fails every single time, or we do have a binary that might fail depending on some external factors. For 2nd one it will be worth to investigate how it is built, and for 2nd one, only following it up with upstream would make sense.

For me this is a phantom bug that you seems started to hit recently but is not 100% reproducible. I have no idea how to move forward with it otherwise. Open for suggestions.

FWIW the golang binary will be static regardless so perhaps a hook in your scripts to copy the particular build directory out of portage TMPDIR on failure if PN == rclone would be enough? I do not want to inconvenience you, looking for simplest way to get the binary in question.




Comment 18


Toralf Förster






          2022-12-10 11:13:12 UTC
        

not a big deal (https://github.com/toralf/tinderbox/commit/e4e0cf635b2c77fffb0e78923f2c3ab7c1c522df) - will see, what happened




Comment 19


Piotr Karbowski (RETIRED)






          2023-01-06 19:24:58 UTC
        

Hey, let me know if you have the affected binary around that you could share with me, or just confirm yourself if the binary that failed during portage run, fails when you re-run it manually




Comment 20


Piotr Karbowski (RETIRED)






          2023-03-05 10:56:16 UTC
        

Friendly reminder, let me know if you can supply me with the failing binary. I continue to be unable to reproduce this.




Comment 21


Toralf Förster






          2023-03-05 11:03:30 UTC
        

(In reply to Piotr Karbowski from comment #20)
> Friendly reminder, let me know if you can supply me with the failing binary.
> I continue to be unable to reproduce this.

Hi Piotr - I do have the logic to keep those files still in place - but cannot reproduce that issue with current images :-/




Comment 22


Piotr Karbowski (RETIRED)






          2023-03-05 11:06:18 UTC
        

In this case lets do the following. I will close this one as cannot reproduce and in case you will hit it again in future please reopen this bug and share the saved artifact. Thanks for adding the logic to keep the artifacts regardless.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

