Title: 341967 – gnome-base/gvfs-1.6.4-r1 constantly filling RAM
URL: https://bugs.gentoo.org/show_bug.cgi?id=341967

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 341967
gnome-base/gvfs-1.6.4-r1 constantly filling RAM
Last modified: 2011-05-08 14:01:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 341967 
      - gnome-base/gvfs-1.6.4-r1 constantly filling RAM


Summary:
gnome-base/gvfs-1.6.4-r1 constantly filling RAM
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:



https://bugzilla.gnome.org/show_bug.c...
        




Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-10-21 08:05 UTC by Justin Lecher (RETIRED)





      Modified:
    
2011-05-08 14:01 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



sascha









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




/home/jlec/.xsession-errors

              (.xsession-errors,1.73 KB,
                text/plain)

            
2010-10-21 17:18 UTC,

            Justin Lecher (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Justin Lecher (RETIRED)






          2010-10-21 08:05:39 UTC
        

In my desktop session the gvfsd is filling the RAM until the system hangs ~5MB/s. Until now I haven't found out whether I can speed it up with something.
Please tell me which informations you need to find the Problem.


$ einfo =gnome-base/gvfs-1.6.4-r1
Portage 2.2_rc98 (default/linux/amd64/10.0, gcc-4.5.1-asneeded, glibc-2.12.1-r1, 2.6.35-gentoo-r11 x86_64)
=================================================================
                        System Settings
=================================================================
System uname: Linux-2.6.35-gentoo-r11-x86_64-Intel-R-_Core-TM-_i7_CPU_860_@_2.80GHz-with-gentoo-2.0.1
Timestamp of tree: Thu, 21 Oct 2010 04:15:02 +0000
distcc 3.1 x86_64-pc-linux-gnu [disabled]
ccache version 2.4 [enabled]
app-shells/bash:     4.1_p7
dev-java/java-config: 2.1.11
dev-lang/python:     2.6.6-r1, 3.1.2-r4
dev-util/ccache:     2.4-r8
dev-util/cmake:      2.8.1-r2
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.3
sys-apps/sandbox:    2.3-r1
sys-devel/autoconf:  2.13, 2.68
sys-devel/automake:  1.6.3-r1, 1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.5.1
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.10
sys-devel/make:      3.81-r2
virtual/os-headers:  2.6.35 (sys-kernel/linux-headers)
Repositories: gentoo science sunrise dummy last-hope
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=core2 -frecord-gcc-switches -mssse3 -mcx16 -mmmx -msse4 -g -Wall -Wimplicit-function-declaration -Wmissing-include-dirs"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/nano/ /var/lib/hsqldb /var/spool/torque"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe -march=core2 -frecord-gcc-switches -mssse3 -mcx16 -mmmx -msse4 -g -Wall -Wmissing-include-dirs -Wenum-compare"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="-t --jobs=12 --load-average=12 --keep-going"
FEATURES="assume-digests binpkg-logs buildsyspkg ccache collision-protect distlocks fixlafiles fixpackages news noinfo parallel-fetch preserve-libs protect-owned sandbox sfperms sign split-log splitdebug strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-O2 -pipe -march=core2 -frecord-gcc-switches -mssse3 -mcx16 -mmmx -msse4 -g -Wall"
GENTOO_MIRRORS=" 	http://gentoo.j-schmitz.net/mirror/ 	ftp://ftp.gentoo.mesh-solutions.com/gentoo/ 	ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo 	ftp://ftp.tu-clausthal.de/pub/linux/gentoo/"
LANG="en_GB.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed -Wl,-O1,--hash-style=gnu,--sort-common"
LINGUAS="en"
MAKEOPTS="-j12 -l12"
PKGDIR="/usr/portage/packages"
PORTAGE_COMPRESS="lzma"
PORTAGE_COMPRESS_FLAGS="-z -9 -f -S .lzma -v"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/science /data/local/sunrise/reviewed /data/local/dummy /data/local/last-hope"
SYNC="rsync://rsync.j-schmitz.net/gentoo-portage"
USE="64bit 7zip X acpi additions alsa amd64 arpwarp bash-completion berkdb branding bzip2 c++ cairo cblas ccache cleartype command-args corefonts cracklib cups cupsddk custom-optimization cxx dbus dri dts exif fbcondecor fortran gdbm gif glibc-omitfp gmp gnome gnome-keyring gpm graphics gstreamer gtk hddtemp iconv icu java javascript jpeg kqemu lapack lcms ldap libnotify libsexy lm_sensors mailtrain md5sum mmx modules mp3 mudflap multilib multiuser nagios-dns nagios-ntp nagios-ping nagios-ssh nano-syntax ncurses network-cron nis nls nptl nptlonly nsplugin objc objc++ opengl openmp openntpd pam pdf perl png pppd pymol python qt-static qt3support readline rrdcgi rrdtool science sensord smp sqlite sqlite3 sse sse2 ssl startup-notification svg sysfs system-sqlite tcpd threads tiff truetype type1 unicode x264 xcb xcomposite xinerama xorg xulrunner zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en" PHP_TARGETS="php-5.2" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

gnome-base/gvfs-1.6.4-r1 was built with the following:
USE="archive bash-completion bluetooth cdda gdu gnome gnome-keyring http (multilib) udev -avahi -doc -fuse -gphoto2 -hal -iphone -samba"




Comment 1


Gilles Dartiguelongue (RETIRED)






          2010-10-21 08:45:40 UTC
        

what backend are you using for transfering files ? A number of these seem to put whole files in memory to accomplish the transfer (seen with webdav/ftp iirc). These are upstream bugs however.

If it's something else, please be a bit more descriptive.




Comment 2


Justin Lecher (RETIRED)






          2010-10-21 11:02:08 UTC
        

so I haven't setup anything for gvfs. It is just there a dep of gnome. this is what is mounted currently.

rootfs on / type rootfs (rw)
/dev/root on / type ext3 (rw,noatime,commit=0)
proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)
rc-svcdir on /lib64/rc/init.d type tmpfs (rw,nosuid,nodev,noexec,relatime,size=1024k,mode=755)
sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)
debugfs on /sys/kernel/debug type debugfs (rw,nosuid,nodev,noexec,relatime)
udev on /dev type tmpfs (rw,nosuid,relatime,size=10240k,mode=755)
devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000)
shm on /dev/shm type tmpfs (rw,nosuid,nodev,noexec,relatime)
/dev/sda1 on /boot type ext2 (rw,noatime)
/dev/sda7 on /home type ext3 (rw,noatime,commit=0)
/dev/sda6 on /mnt/portage type ext2 (rw,noatime)
/mnt/portage/tmp on /var/tmp/portage type none (rw,bind)
tmpfs on /mnt/tmpfs type tmpfs (rw,size=3072M)
/dev/loop0 on /home/justin/tree type reiserfs (rw)
/dev/loop1 on /var/cache/fscache type ext2 (rw,user_xattr)
usbfs on /proc/bus/usb type usbfs (rw,noexec,nosuid,devmode=0664,devgid=85)
rpc_pipefs on /var/lib/nfs/rpc_pipefs type rpc_pipefs (rw)
nfsd on /proc/fs/nfsd type nfsd (rw,noexec,nosuid,nodev)
bes.ibi.kfa-juelich.de:/raid_2/data on /usr2/bes type nfs (rw,fsc,soft,rsize=8192,wsize=8192,addr=134.94.85.173)
bes.ibi.kfa-juelich.de:/opt/scisoft64 on /opt/scisoft64 type nfs (rw,fsc,soft,rsize=8192,wsize=8192,addr=134.94.85.173)
/dev/loop2 on /usr/portage type squashfs (ro,noexec,nodev)
aufs on /usr/portage type aufs (rw,nodev,noexec,relatime,si=7d9643de86981c64)
/mnt/portage/distfiles on /usr/portage/distfiles type none (rw,bind)

And a music cd is in the tray, bur not touched.




Comment 3


Gilles Dartiguelongue (RETIRED)






          2010-10-21 11:54:25 UTC
        

I meant "are you using say nautilus to transfer files to a "remote" destination ?" (like ftp server, ...). If gvfs memory usage is growing while you are doing nothing on the desktop, there is something really fishy :)




Comment 4


Justin Lecher (RETIRED)






          2010-10-21 12:50:55 UTC
        

(In reply to comment #3)
> I meant "are you using say nautilus to transfer files to a "remote" destination
> ?" (like ftp server, ...). If gvfs memory usage is growing while you are doing
> nothing on the desktop, there is something really fishy :)
> 

I am not doing anything with gvfs/nautilus or any other gnome-fs related programms. Just logging into a gnome session it starts.

But adding cdda to the USE solves the problem. Probably a problem with the cd in the tray.




Comment 5


Pacho Ramos






          2010-10-21 16:17:22 UTC
        

Do you experience the same problem on a new created user account?




Comment 6


Justin Lecher (RETIRED)






          2010-10-21 16:45:58 UTC
        

(In reply to comment #5)
> Do you experience the same problem on a new created user account?
> 

Yes it does. USE=cdda is the solver.




Comment 7


Pacho Ramos






          2010-10-21 16:50:58 UTC
        

Don't you see any errors on ~/.xsession-errors file while it's eating RAM?




Comment 8


Pacho Ramos






          2010-10-21 16:53:00 UTC
        

Maybe this is related:
https://bugzilla.gnome.org/show_bug.cgi?id=622455




Comment 9


Gilles Dartiguelongue (RETIRED)






          2010-10-21 17:08:56 UTC
        

Looks indeed very similar.




Comment 10


Justin Lecher (RETIRED)






          2010-10-21 17:18:58 UTC
        

Created attachment 251463 [details]
/home/jlec/.xsession-errors

xsession-errors




Comment 11


Justin Lecher (RETIRED)






          2010-10-21 17:20:10 UTC
        

(In reply to comment #10)
> Created an attachment (id=251463) [details]
> /home/jlec/.xsession-errors
> 
> xsession-errors
> 

exactly what I see here.




Comment 12


Justin Lecher (RETIRED)






          2010-10-22 11:31:52 UTC
        

So further testing shows, that cdda doesn't fix for ever. But I found this:

These processes produce constantly load, while cd is in the tray

/usr/bin/dbus-daemon --fork --print-pid 5 --print-address 8 --session
/usr/libexec/gvfs-gdu-volume-monitor





Comment 13


Justin Lecher (RETIRED)






          2010-10-22 11:34:41 UTC
        

(In reply to comment #12)
> So further testing shows, that cdda doesn't fix for ever. But I found this:
> 
> These processes produce constantly load, while cd is in the tray
> 
> /usr/bin/dbus-daemon --fork --print-pid 5 --print-address 8 --session
> /usr/libexec/gvfs-gdu-volume-monitor
> 

Okay this only happens if the gnome-system-monitor is started. And only then the ram fills up when USE=cdda is enabled.




Comment 14


Pacho Ramos






          2010-10-23 13:53:06 UTC
        

You should probably tell it to upstream directly, as I think they can help you much more than us on this :-/




Comment 15


Pacho Ramos






          2010-10-24 12:47:17 UTC
        

Is this a regression?




Comment 16


Justin Lecher (RETIRED)






          2010-10-24 14:21:46 UTC
        

(In reply to comment #15)
> Is this a regression?
> 

I am not sure. I noticed the huge RAM usage some time ago, but didn't assign it to gvfs. Although it might was the same issue.




Comment 17


Pacho Ramos






          2011-02-24 18:00:11 UTC
        

Maybe now with Gnome 2.32 (that went stable a few hours ago on amd64) could help... :-/ Good luck! (please retry on a fully updated system, not only gnome stuff)




Comment 18


Justin Lecher (RETIRED)






          2011-02-24 18:08:40 UTC
        

it seems to be fix for a while now. Soryy, but I cannot say whether I changed something, or it was fixed in some packages.




Comment 19


Sascha Biedermann





          2011-02-27 22:07:29 UTC
        

gvfsd still fills RAM but ONLY when a disk is in the cd-drive. When I remove the disk it stops filling the RAM. Then I kill gfsvd and everything is fine. When I put the disk in the drive again, it continues filling ram.

I've only tested it with an audio disk.




Comment 20


Pacho Ramos






          2011-04-03 11:48:15 UTC
        

Maybe this could be caused by some kernel setting of hardware problem :-/. Isn't there anything interesting in "dmesg" output and /var/log/messages?




Comment 21


Pacho Ramos






          2011-05-08 11:30:37 UTC
        

(In reply to comment #20)
> Maybe this could be caused by some kernel setting of hardware problem :-/.
> Isn't there anything interesting in "dmesg" output and /var/log/messages?

Any news here?




Comment 22


Justin Lecher (RETIRED)






          2011-05-08 11:56:59 UTC
        

Never seen again.




Comment 23


Gilles Dartiguelongue (RETIRED)






          2011-05-08 14:01:38 UTC
        

Ok, let's call it a day. Feel free to reopen if the problem re-emerges. Thanks for reporting.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

