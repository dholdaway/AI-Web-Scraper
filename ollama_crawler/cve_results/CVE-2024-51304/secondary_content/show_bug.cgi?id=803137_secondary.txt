Title: 803137 – dev-libs/glib-2.68.3-r1: QA Notice: Unresolved soname dependencies libffi.so.7
URL: https://bugs.gentoo.org/show_bug.cgi?id=803137

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 803137
dev-libs/glib-2.68.3-r1: QA Notice: Unresolved soname dependencies libffi.so.7
Last modified: 2021-07-21 14:33:00 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 803137 
      - dev-libs/glib-2.68.3-r1: QA Notice: Unresolved soname dependencies libffi.so.7


Summary:
dev-libs/glib-2.68.3-r1: QA Notice: Unresolved soname dependencies libffi.so.7
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-07-20 23:53 UTC by Pacho Ramos





      Modified:
    
2021-07-21 14:33 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



sam
toolchain









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Pacho Ramos






          2021-07-20 23:53:59 UTC
        

I don't know why after updating one of my machines I am completely unable to start gdm due to errors like:


For now I have seen that, when building glib, I get:
>>> Completed installing dev-libs/glib-2.68.3-r1 into /var/tmp/portage/dev-libs/glib-2.68.3-r1/image

 * Final size of build directory: 100184 KiB (97.8 MiB)
 * Final size of installed tree:   21584 KiB (21.0 MiB)

strip: x86_64-pc-linux-gnu-strip --strip-unneeded -N __gentoo_check_ldflags__ -R .comment -R .GCC.command.line -R .note.gnu.gold-version
   /usr/lib/libgobject-2.0.so.0.6800.3
   /usr/lib/libgmodule-2.0.so.0.6800.3
   /usr/lib/libglib-2.0.so.0.6800.3
   /usr/bin/i686-pc-linux-gnu-gio-querymodules
   /usr/lib/libgthread-2.0.so.0.6800.3
   /usr/lib/libgio-2.0.so.0.6800.3
   /usr/bin/gtester
   /usr/lib64/libglib-2.0.so.0.6800.3
   /usr/lib64/libgobject-2.0.so.0.6800.3
   /usr/lib64/libgthread-2.0.so.0.6800.3
   /usr/bin/gobject-query
   /usr/lib64/libgmodule-2.0.so.0.6800.3
   /usr/bin/gio
   /usr/bin/gresource
   /usr/bin/x86_64-pc-linux-gnu-gio-querymodules
   /usr/lib64/libgio-2.0.so.0.6800.3
   /usr/bin/glib-compile-schemas
   /usr/bin/glib-compile-resources
   /usr/bin/gdbus
   /usr/bin/gsettings
   /usr/bin/gapplication
 * QA Notice: Unresolved soname dependencies:
 * 
 * 	/usr/lib/libgobject-2.0.so.0.6800.3: libffi.so.7
 * 	/usr/lib64/libgobject-2.0.so.0.6800.3: libffi.so.7
 * 


Even if the file is present:
# ls -l /usr/lib64/libffi.so.7*
lrwxrwxrwx 1 root root    15 jul 20 01:45 /usr/lib64/libffi.so.7 -> libffi.so.7.1.0
-rwxr-xr-x 1 root root 50944 jul 20 01:45 /usr/lib64/libffi.so.7.1.0




Comment 1


Pacho Ramos






          2021-07-20 23:54:33 UTC
        

The errors in dmesg are like:
[  243.958661] traps: gnome-session-b[11092] trap int3 ip:7f62490be4e3 sp:7ffe5e62dd20 error:0 in libglib-2.0.so.0.6800.2[7f6249080000+8d000]

ortage 3.0.20 (python 3.9.5-final-0, default/linux/amd64/17.1/desktop/gnome/systemd, gcc-10.3.0, glibc-2.33-r1, 5.10.2-gentoo x86_64)
=================================================================
System uname: Linux-5.10.2-gentoo-x86_64-Intel-R-_Core-TM-_i7-6700HQ_CPU_@_2.60GHz-with-glibc2.33
KiB Mem:     8047844 total,   6802488 free
KiB Swap:    7916540 total,   7916540 free
Timestamp of repository gentoo: Tue, 20 Jul 2021 19:30:01 +0000
Head commit of repository gentoo: 3e69e4a0b5aa5b9e40103e1751cb7f3f875222ad
sh bash 5.1_p8
ld GNU ld (Gentoo 2.35.2 p1) 2.35.2
ccache version 4.3 [enabled]
app-shells/bash:          5.1_p8::gentoo
dev-java/java-config:     2.3.1::gentoo
dev-lang/perl:            5.34.0::gentoo
dev-lang/python:          3.9.5_p2::gentoo
dev-lang/rust-bin:        1.52.1::gentoo
dev-util/ccache:          4.3::gentoo
dev-util/cmake:           3.18.5::gentoo
sys-apps/baselayout:      2.7::gentoo
sys-apps/sandbox:         2.24::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r5::gentoo
sys-devel/automake:       1.16.3-r1::gentoo
sys-devel/binutils:       2.35.2::gentoo
sys-devel/gcc:            10.3.0-r2::gentoo
sys-devel/gcc-config:     2.4::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.3::gentoo
sys-kernel/linux-headers: 5.10::gentoo (virtual/os-headers)
sys-libs/glibc:           2.33-r1::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-jobs: 1
    sync-rsync-extra-opts: 
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-metamanifest: no

steam-overlay
    location: /var/lib/layman/steam-overlay
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=native"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe -march=native"
DISTDIR="/usr/distfiles"
EMERGE_DEFAULT_OPTS="--keep-going --autounmask-write --autounmask --autounmask-keep-masks"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe -march=native"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs ccache config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe -march=native"
GENTOO_MIRRORS="ftp://ftp.free.fr/mirrors/ftp.gentoo.org/"
INSTALL_MASK="/usr/share/locale -/usr/share/locale/es -/usr/share/locale/es_ES -/usr/share/locale/en -/usr/share/locale/en_US"
LANG="es_ES.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="es es_ES en_US"
MAKEOPTS="-j9"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="7z 7zip X a52 aac acl acpi alsa amd64 archive avx avx256 bash-completion bluetooth bluray branding bzip2 cache cairo ccache cdda cddb cdr chrome chromecast chromium cli colord context crypt cups dbus djvu dot dri dts dvd dvdr eds emboss enchant encode epspdf equalizer ethernet evince evo excel exif extra fat ffmpeg firefox flac flash fortran freesound fuse gamepad games gdbm gdk-pixbuf gdm gedit gif gimp gnome gnome-keyring gnome-online-accounts gnome-shell gnumeric google googledrive gphoto2 gpm grammar graphics gstreamer gtk gtkstyle gui heif hfs html http humanities hwaccel ico icons iconv icu inkscape inotify introspection ios ipod ipv6 iso joystick jpeg kate kpathsea latex lcms libass libdrm libglvnd libnotify librtmp libsecret libtirpc libv4l lm_sensors luatex lyx lz4 lzma lzo mad math matroska media mediaplayer metapost mms mmx mmxext mng modemmanager monolithic-build mp3 mp4 mpeg mtp multilib music musicbrainz nautilus ncurses network network-cron networkmanager nls nptl ntfs ntp numa nvme offensive ogg opengl openmp opus pam pango pch pdf pdfannotextractor pdfimport pipelight png policykit postscript ppapi ppds pptx projectm proprietary-codecs pstricks publishers pulseaudio qt5 rar raw rdp readline reiserfs rtf scanner science sdl seccomp smp sna spell split-usr squashfs sse sse2 sse3 sse4 sse4_1 ssl ssse3 startup-notification subtitles svg sysprof systemd tcpd theora thesaurus threads tiff totem tracker truetype udev udisks uefi unicode update_drivedb upnp upnp-av upower usb user-session v4l vaapi vcd vdpau vimeo visio vlc vnc vorbis vpx wayland webp wifi wma wmf wpg wxwidgets x264 x265 xattr xcb xetex xfs xml xmp xpm xps xv xvid xz youtube zeroconf zlib zstd" ABI_X86="64" ADA_TARGET="gnat_2018" ALSA_CARDS="hda-intel" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt rdrand sse sse2 sse3 sse4_1 sse4_2 ssse3" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput" KERNEL="linux" L10N="es es-ES en en-US" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-3 php7-4" POSTGRES_TARGETS="postgres10 postgres11" PYTHON_SINGLE_TARGET="python3_9" PYTHON_TARGETS="python3_9" RUBY_TARGETS="ruby26" USERLAND="GNU" VIDEO_CARDS="fbdev vesa intel i965 nouveau nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq proto steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, RUSTFLAGS




Comment 2


Pacho Ramos






          2021-07-21 00:00:47 UTC
        

In journalctl I see errors like:
jul 21 01:59:08 asus-2017 gnome-session[775]: gnome-session-binary[775]: WARNING: Falling back to non-systemd startup procedure due to error: GDBus.Error:org.freedesktop.DBus.Error.NameHasNoOwner: Name "org.fre>
jul 21 01:59:08 asus-2017 gnome-session[775]: gnome-session-binary[775]: GLib-GIO-ERROR: Settings schema 'org.gnome.SessionManager' is not installed
jul 21 01:59:08 asus-2017 gnome-session[775]: aborting...
jul 21 01:59:08 asus-2017 gnome-session-binary[775]: GLib-GIO-ERROR: Settings schema 'org.gnome.SessionManager' is not installed
                                                     aborting...
jul 21 01:59:08 asus-2017 kernel: traps: gnome-session-b[775] trap int3 ip:7fa0ece2b4e3 sp:7ffc31f7cf20 error:0 in libglib-2.0.so.0.6800.3[7fa0ecded000+8d000]
jul 21 01:59:08 asus-2017 systemd[1]: Started Process Core Dump (PID 800/UID 0).


But the schemas are present, I have also tried to reinstall gsettings-desktop-schemas but keep failing :/




Comment 3


Pacho Ramos






          2021-07-21 00:06:56 UTC
        

I also see:
jul 21 02:04:41 asus-2017 /usr/libexec/gdm-x-session[1587]: dbus-daemon[1587]: [session uid=990 pid=1587] Activating service name='org.a11y.Bus' requested by ':1.0' (uid=990 pid=1592 comm="/usr/libexec/gnome-session-check-accelerated ")
jul 21 02:04:41 asus-2017 /usr/libexec/gdm-x-session[1587]: dbus-daemon[1587]: [session uid=990 pid=1587] Successfully activated service 'org.a11y.Bus'
jul 21 02:04:41 asus-2017 gnome-session[1588]: gnome-session-binary[1588]: WARNING: Failed to upload environment to systemd: GDBus.Error:org.freedesktop.DBus.Error.NameHasNoOwner: Name "org.freedesktop.systemd1" does not exist
jul 21 02:04:41 asus-2017 gnome-session-binary[1588]: WARNING: Failed to upload environment to systemd: GDBus.Error:org.freedesktop.DBus.Error.NameHasNoOwner: Name "org.freedesktop.systemd1" does not exist
jul 21 02:04:41 asus-2017 gnome-session[1588]: gnome-session-binary[1588]: WARNING: Failed to reset failed state of units: GDBus.Error:org.freedesktop.DBus.Error.NameHasNoOwner: Name "org.freedesktop.systemd1" does not exist
jul 21 02:04:41 asus-2017 gnome-session-binary[1588]: WARNING: Failed to reset failed state of units: GDBus.Error:org.freedesktop.DBus.Error.NameHasNoOwner: Name "org.freedesktop.systemd1" does not exist
jul 21 02:04:41 asus-2017 gnome-session-binary[1588]: WARNING: Falling back to non-systemd startup procedure due to error: GDBus.Error:org.freedesktop.DBus.Error.NameHasNoOwner: Name "org.freedesktop.systemd1" does not exist
jul 21 02:04:41 asus-2017 gnome-session[1588]: gnome-session-binary[1588]: WARNING: Falling back to non-systemd startup procedure due to error: GDBus.Error:org.freedesktop.DBus.Error.NameHasNoOwner: Name "org.freedesktop.systemd1" does not exist
jul 21 02:04:41 asus-2017 gnome-session[1588]: gnome-session-binary[1588]: GLib-GIO-ERROR: Settings schema 'org.gnome.SessionManager' is not installed
jul 21 02:04:41 asus-2017 gnome-session[1588]: aborting...
jul 21 02:04:41 asus-2017 gnome-session-binary[1588]: GLib-GIO-ERROR: Settings schema 'org.gnome.SessionManager' is not installed
                                                      aborting...
jul 21 02:04:41 asus-2017 kernel: traps: gnome-session-b[1588] trap int3 ip:7f4c782a94e3 sp:7fffb68c6a60 error:0 in libglib-2.0.so.0.6800.3[7f4c7826b000+8d000]
jul 21 02:04:41 asus-2017 systemd[1]: Started Process Core Dump (PID 1613/UID 0).

But I have it present:
# ls -l /usr/share/dbus-1/services/org.freedesktop.systemd1.service
lrwxrwxrwx 1 root root 51 jul 20 21:59 /usr/share/dbus-1/services/org.freedesktop.systemd1.service -> ../system-services/org.freedesktop.systemd1.service
# ls -l /usr/share/dbus-1/system-services/org.freedesktop.systemd1.service
-rw-r--r-- 1 root root 412 jul 20 14:45 /usr/share/dbus-1/system-services/org.freedesktop.systemd1.service
# ls -l /usr/share/dbus-1/system.d/org.freedesktop.systemd1.conf
-rw-r--r-- 1 root root 19779 jul 20 14:45 /usr/share/dbus-1/system.d/org.freedesktop.systemd1.conf

[ebuild   R    ] sys-apps/systemd-248.5:0/2::gentoo  USE="acl gcrypt http hwdb kmod lz4 lzma pam policykit resolvconf seccomp (split-usr) sysv-utils zstd -apparmor -audit -build -cgroup-hybrid -cryptsetup -curl -dns-over-tls -elfutils -gnuefi -homed -idn -importd -nat -pcre -pkcs11 -pwquality -qrcode -repart (-selinux) -static-libs -test -tpm -vanilla -xkb" ABI_X86="32 (64) (-x32)" 0 KiB




Comment 4


Pacho Ramos






          2021-07-21 00:15:49 UTC
        

With lightdm I can start X, but Gnome fails to start with similar errors:
jul 21 02:14:56 asus-2017 systemd[833]: Starting GNOME Session Manager (session: gnome)...
jul 21 02:14:56 asus-2017 gnome-session[34099]: gnome-session-binary[34099]: GLib-GIO-ERROR: Settings schema 'org.gnome.SessionManager' is not installed
jul 21 02:14:56 asus-2017 gnome-session[34099]: aborting...
jul 21 02:14:56 asus-2017 kernel: traps: gnome-session-b[34099] trap int3 ip:7f6ee018f4e3 sp:7ffc7bf57860 error:0 in libglib-2.0.so.0.6800.3[7f6ee0151000+8d000]
jul 21 02:14:56 asus-2017 gnome-session-binary[34099]: GLib-GIO-ERROR: Settings schema 'org.gnome.SessionManager' is not installed
                                                       aborting...
jul 21 02:14:56 asus-2017 systemd[1]: Started Process Core Dump (PID 34103/UID 0).




Comment 5


Pacho Ramos






          2021-07-21 00:21:34 UTC
        

It looks similar to bug 786573, but I have all the packages at their -40 versions (even if this system is older and got updated from Gnome 3.36 instead of Gnome 3.38 to Gnome 40)




Comment 6


Sergei Trofimovich (RETIRED)






          2021-07-21 06:39:04 UTC
        

(In reply to Pacho Ramos from comment #0)
> I don't know why after updating one of my machines I am completely unable to
> start gdm due to errors like:
> 
> 
> For now I have seen that, when building glib, I get:
> >>> Completed installing dev-libs/glib-2.68.3-r1 into /var/tmp/portage/dev-libs/glib-2.68.3-r1/image
> 
>  * Final size of build directory: 100184 KiB (97.8 MiB)
>  * Final size of installed tree:   21584 KiB (21.0 MiB)
> 
> strip: x86_64-pc-linux-gnu-strip --strip-unneeded -N
> __gentoo_check_ldflags__ -R .comment -R .GCC.command.line -R
> .note.gnu.gold-version
>    /usr/lib/libgobject-2.0.so.0.6800.3
>    /usr/lib/libgmodule-2.0.so.0.6800.3
>    /usr/lib/libglib-2.0.so.0.6800.3
>    /usr/bin/i686-pc-linux-gnu-gio-querymodules
>    /usr/lib/libgthread-2.0.so.0.6800.3
>    /usr/lib/libgio-2.0.so.0.6800.3
>    /usr/bin/gtester
>    /usr/lib64/libglib-2.0.so.0.6800.3
>    /usr/lib64/libgobject-2.0.so.0.6800.3
>    /usr/lib64/libgthread-2.0.so.0.6800.3
>    /usr/bin/gobject-query
>    /usr/lib64/libgmodule-2.0.so.0.6800.3
>    /usr/bin/gio
>    /usr/bin/gresource
>    /usr/bin/x86_64-pc-linux-gnu-gio-querymodules
>    /usr/lib64/libgio-2.0.so.0.6800.3
>    /usr/bin/glib-compile-schemas
>    /usr/bin/glib-compile-resources
>    /usr/bin/gdbus
>    /usr/bin/gsettings
>    /usr/bin/gapplication
>  * QA Notice: Unresolved soname dependencies:
>  * 
>  * 	/usr/lib/libgobject-2.0.so.0.6800.3: libffi.so.7
>  * 	/usr/lib64/libgobject-2.0.so.0.6800.3: libffi.so.7
>  * 
> 
> 
> Even if the file is present:
> # ls -l /usr/lib64/libffi.so.7*
> lrwxrwxrwx 1 root root    15 jul 20 01:45 /usr/lib64/libffi.so.7 ->
> libffi.so.7.1.0
> -rwxr-xr-x 1 root root 50944 jul 20 01:45 /usr/lib64/libffi.so.7.1.0

This shows that portage does not know what gentoo package provides libffi.so.7.

What does
    $ cat /var/db/pkg/dev-libs/libffi-*/PROVIDES
print on your system? What version of libffi you have installed?




Comment 7


Pacho Ramos






          2021-07-21 07:01:15 UTC
        

I see no PROVIDES file:
# ls -l /var/db/pkg/dev-libs/libffi-3.3-r2/
total 128
-rw-r--r-- 1 root root    11 jul 20 01:45 BUILD_TIME
-rw-r--r-- 1 root root     9 jul 20 01:45 CATEGORY
-rw-r--r-- 1 root root    20 jul 20 01:45 CBUILD
-rw-r--r-- 1 root root    24 jul 20 01:45 CFLAGS
-rw-r--r-- 1 root root    20 jul 20 01:45 CHOST
-rw-r--r-- 1 root root  1863 jul 20 01:45 CONTENTS
-rw-r--r-- 1 root root     4 jul 20 01:45 COUNTER
-rw-r--r-- 1 root root    24 jul 20 01:45 CXXFLAGS
-rw-r--r-- 1 root root    39 jul 20 01:45 DEFINED_PHASES
-rw-r--r-- 1 root root    76 jul 20 01:45 DESCRIPTION
-rw-r--r-- 1 root root     2 jul 20 01:45 EAPI
-rw-r--r-- 1 root root 15980 jul 20 01:45 environment.bz2
-rw-r--r-- 1 root root   389 jul 20 01:45 FEATURES
-rw-r--r-- 1 root root    31 jul 20 01:45 HOMEPAGE
-rw-r--r-- 1 root root    68 jul 20 01:45 INHERITED
-rw-r--r-- 1 root root   112 jul 20 01:45 INSTALL_MASK
-rw-r--r-- 1 root root   142 jul 20 01:45 IUSE
-rw-r--r-- 1 root root   798 jul 20 01:45 IUSE_EFFECTIVE
-rw-r--r-- 1 root root   195 jul 20 01:45 KEYWORDS
-rw-r--r-- 1 root root    24 jul 20 01:45 LDFLAGS
-rw-r--r-- 1 root root  2531 jul 20 01:45 libffi-3.3-r2.ebuild
-rw-r--r-- 1 root root     4 jul 20 01:45 LICENSE
-rw-r--r-- 1 root root    14 jul 20 01:45 PF
-rw-r--r-- 1 root root    11 jul 20 01:45 PKGUSE
-rw-r--r-- 1 root root     7 jul 20 01:45 repository
-rw-r--r-- 1 root root     5 jul 20 01:45 RESTRICT
-rw-r--r-- 1 root root     7 jul 20 01:45 SIZE
-rw-r--r-- 1 root root     4 jul 20 01:45 SLOT
-rw-r--r-- 1 root root    66 jul 20 01:45 USE

[ebuild   R    ] dev-libs/libffi-3.3-r2:0/7::gentoo  USE="-debug -pax-kernel -pax_kernel -static-libs -test" ABI_X86="32 (64) (-x32)" 0 KiB

Thanks




Comment 8


Sergei Trofimovich (RETIRED)






          2021-07-21 08:27:39 UTC
        

(In reply to Pacho Ramos from comment #7)
> I see no PROVIDES file:
> # ls -l /var/db/pkg/dev-libs/libffi-3.3-r2/

I think that's unexpected. If you rebuild libffi does it come back?




Comment 9


Pacho Ramos






          2021-07-21 08:49:44 UTC
        

After rebuilding I have it

# cat /var/db/pkg/dev-libs/libffi-3.3-r2/PROVIDES
x86_32: libffi.so.7 x86_64: libffi.so.7

QA warning is removed but, sadly, gdm and gnome keep failing to start with the glib error :(
[    9.287457] traps: gnome-session-b[776] trap int3 ip:7f5bcb1864e3 sp:7ffc9bffc0b0 error:0 in libglib-2.0.so.0.6800.3[7f5bcb148000+8d000]




Comment 10


Sergei Trofimovich (RETIRED)






          2021-07-21 09:18:59 UTC
        

That's probably a different error. Can you get a symbolized backtrace?

int3 might be an explicit assertion failure somewhere in glib.




Comment 11


Pacho Ramos






          2021-07-21 09:24:16 UTC
        

Rebuilding gnome-session I get a bit more far: now I get the "Oh no, something was wrong" gnome-shell screen and kernel trap affects other:
[    7.015485] traps: gsettings-helpe[749] trap int3 ip:7f2afc43ce57 sp:7ffc017ef9c0 error:0 in libglib-2.0.so.0.6800.3[7f2afc3ff000+8d000]


I will try too keep rebuilding and so and see what happens

Thanks a lot for your help!




Comment 12


Pacho Ramos






          2021-07-21 09:34:31 UTC
        

For now I also needed to rebuild pulseaudio, after that, no more kernel traps but:
jul 21 11:28:20 asus-2017 gnome-shell[1203]: Settings schema 'org.gnome.GWeather' is not installed
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: == Stack trace for context 0x562a0297d1c0 ==
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #0   562a02be3ac0 i   resource:///org/gnome/shell/misc/weather.js:75 (1102acbac380 @ 483)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #1   562a02be39f8 i   resource:///org/gnome/shell/ui/dateMenu.js:478 (1102acbaa1f0 @ 83)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #2   562a02be3918 i   resource:///org/gnome/shell/ui/dateMenu.js:872 (1102acb9f920 @ 1384)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #3   562a02be3868 i   resource:///org/gnome/shell/ui/panel.js:1018 (1102acb8c7e0 @ 103)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #4   562a02be3798 i   resource:///org/gnome/shell/ui/panel.js:1029 (1102acb8c790 @ 109)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #5   562a02be36f0 i   resource:///org/gnome/shell/ui/panel.js:974 (1102acb8c880 @ 109)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #6   562a02be3640 i   resource:///org/gnome/shell/ui/panel.js:784 (1102acb8cd80 @ 845)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #7   562a02be35a8 i   resource:///org/gnome/shell/ui/main.js:225 (248a21cd9bf0 @ 620)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #8   562a02be34f8 i   resource:///org/gnome/shell/ui/main.js:166 (248a21cd9d30 @ 324)
jul 21 11:28:20 asus-2017 org.gnome.Shell.desktop[1203]: #9   562a02be3470 i   <main>:1 (248a21c8cdd0 @ 48)

Due to missing /usr/share/glib-2.0/schemas/org.gnome.GWeather.enums.xml even if libgweather is installed.. after rebuilding libgweather, file is properly installed and gdm starts fine. 

Also gnome starts... but I see more errors in the logs related with missing schemas :/

I have no idea about why some schemas are missing even if emerge reported no errors and supposedly everything was properly installed. Maybe it is something related with the upgrade from 3.36 to 40 :/




Comment 13


Pacho Ramos






          2021-07-21 09:39:20 UTC
        

It happens I think with most schemas, for example:
# equery files nautilus|grep schemas
/usr/share/glib-2.0/schemas
/usr/share/glib-2.0/schemas/org.gnome.nautilus.gschema.xml

But:
# ls -l /usr/share/glib-2.0/schemas/org.gnome.nautilus.gschema.xml
ls: cannot access '/usr/share/glib-2.0/schemas/org.gnome.nautilus.gschema.xml': No such file or directory

I will try then to rebuild all the packages installing under /usr/share/glib-2.0/schemas/ ... but no idea about what happened :| If I discover something, I will tell for the case someone else hits this




Comment 14


Sam James









          2021-07-21 11:00:23 UTC
        

This sounds a lot like possible disk corruption or hardware failure.




Comment 15


Pacho Ramos






          2021-07-21 14:33:00 UTC
        

Yep, after re-emerging them it works. I have reviewed the logs but I couldn't see anything clear... we will see

Thanks a lot!









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

