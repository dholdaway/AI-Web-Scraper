Title: 124217 – imagemagick compile error with -k6 optimizations
URL: https://bugs.gentoo.org/show_bug.cgi?id=124217

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 124217
imagemagick compile error with -k6 optimizations
Last modified: 2006-04-02 13:32:33 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 124217 
      - imagemagick compile error with -k6 optimizations


Summary:
imagemagick compile error with -k6 optimizations
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Graphics Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-02-26 16:54 UTC by Steve Egbert





      Modified:
    
2006-04-02 13:32 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jakub









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Steve Egbert





          2006-02-26 16:54:51 UTC
        

media-gfx/imagemagick-6.2.5.5 has a compile error during emerge:

if /bin/sh ./libtool --silent --tag=CC --mode=compile i586-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I. -I./magick -I./wand   -I/usr/include/freetype2 -I/usr/include/libxml2  -O2 -mcpu=k6-2 -fomit-frame-pointer -Wall -pthread -MT coders/coders_preview_la-preview.lo -MD -MP -MF "coders/.deps/coders_preview_la-preview.Tpo" -c -o coders/coders_preview_la-preview.lo `test -f 'coders/preview.c' || echo './'`coders/preview.c; \
then mv -f "coders/.deps/coders_preview_la-preview.Tpo" "coders/.deps/coders_preview_la-preview.Plo"; else rm -f "coders/.deps/coders_preview_la-preview.Tpo"; exit 1; fi
/var/tmp/portage/imagemagick-6.2.5.5/temp/cc6dKO00.s: Assembler messages:
/var/tmp/portage/imagemagick-6.2.5.5/temp/cc6dKO00.s:1924: Error: value of ffffffffffffff7d too large for field of 1 bytes at 0000000000001a24
make: *** [coders/coders_pnm_la-pnm.lo] Error 1
make: *** Waiting for unfinished jobs....

Other output snippets are:

  Not using X11.

Options used to compile and link:
  PREFIX      = /usr
  EXEC-PREFIX = /usr
  VERSION     = 6.2.5
  CC          = i586-pc-linux-gnu-gcc
  CFLAGS      = -O2 -mcpu=k6-2 -fomit-frame-pointer -Wall -pthread
  CPPFLAGS    = -I/usr/include
  PCFLAGS     =
  DEFS        = -DHAVE_CONFIG_H
  LDFLAGS     = -L/usr/lib -lfreetype -lz -L/usr/lib
  LIBS        = -lMagick -lfreetype -ljpeg -lbz2 -lz -lpthread -lm -lpthread
  CXX         = i586-pc-linux-gnu-g++
  CXXFLAGS    = -O2 -mcpu=k6-2 -fomit-frame-pointer -pthread

and emerge --info is:

Portage 2.0.54 (default-linux/x86/2005.1, gcc-3.3.6, glibc-2.3.5-r2, 2.6.13-gentoo-r5dev-cd i586)
=================================================================
System uname: 2.6.13-gentoo-r5dev-cd i586 AMD-K6(tm) 3D processor
Gentoo Base System version 1.6.14
dev-lang/python:     2.3.5-r2, 2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i586-pc-linux-gnu"
CFLAGS="-O2 -mcpu=k6-2 -fomit-frame-pointer"
CHOST="i586-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/lib/X11/xkb /usr/share/config /var/bind /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -mcpu=k6-2 -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://gentoo.osuosl.org/ http://adelie.polymtl.ca/ ftp://cs.ubishops.ca/pub/gentoo ftp://sunsite.ualberta.ca/pub/unix/Linux/gentoo/ ftp://gentoo.risq.qc.ca/ ftp://ftp.gtlib.cc.gatech.edu/pub/gentoo http://csociety-ftp.ecn.purdue.edu/pub/gentoo/ ftp://csociety-ftp.ecn.purdue.edu/pub/gentoo/ ftp://ftp.ussg.iu.edu/pub/linux/gentoo ftp://ftp.ucsb.edu/pub/mirrors/linux/gentoo/ http://gentoo.seren.com/gentoo http://gentoo.chem.wisc.edu/gentoo/ ftp://gentoo.chem.wisc.edu/gentoo/ http://cudlug.cudenver.edu/gentoo/ ftp://cudlug.cudenver.edu/pub/mirrors/distributions/gentoo/ http://gentoo.mirrors.pair.com/ ftp://gentoo.mirrors.pair.com/ http://gentoo.ccccom.com ftp://gentoo.ccccom.com http://mirrors.tds.net/gentoo ftp://mirrors.tds.net/gentoo http://gentoo.netnitco.net ftp://gentoo.netnitco.net/pub/mirrors/gentoo/source/ http://mirror.tucdemonic.org/gentoo/ http://mirror.clarkson.edu/pub/distributions/gentoo/ http://mirrors.acm.cs.rpi.edu/gentoo/ ftp://ftp.ndlug.nd.edu/pub/gentoo/ ftp://gentoo.agsn.ca/ http://open-systems.ufl.edu/mirrors/gentoo http://gentoo.llarian.net/ ftp://gentoo.llarian.net/pub/gentoo http://gentoo.binarycompass.org http://gentoo.mirrored.ca/ ftp://gentoo.mirrored.ca/ http://mirror.datapipe.net/gentoo http://mirror.datapipe.net/gentoo http://gentoo.eliteitminds.com http://chod.cwru.edu/gentoo ftp://chod.cwru.edu/gentoo http://gentoo.cs.lewisu.edu/gentoo/ ftp://linux.cs.lewisu.edu/gentoo/ http://prometheus.cs.wmich.edu/gentoo http://modzer0.cs.uaf.edu/public/gentoo/ http://mirror.usu.edu/mirrors/gentoo/"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow alsa apache2 apm audiofile berkdb bitmap-fonts bzip2 bzlib c++ cdr crypt curl dba devmap eds emboss encode expat ffmpeg fortran gd gdbm geoip gif gmp gnutls gpm gstreamer gtk gtk2 idn imap imlib innodb ipv6 jpeg ldap libg++ libwww mad mailwrapper mhash mikmod milter mime mmx mp3 mpeg mysql ncurses nls nocardbus ogg oggvorbis pam pcap pcre perl php png posix pthreads python readline sasl sdl sendmail skey smime smtp snmp sockets spell ssh ssl svg tcltk tcpd thread truetype truetype-fonts type1-fonts udev userlocales vorbis xml xml2 zlib userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


Steve Egbert





          2006-02-26 16:56:36 UTC
        

Updated subject title to be a bit more concise:

This is a headless webserver system without any X support.




Comment 2


Jakub Moc (RETIRED)






          2006-02-26 23:31:22 UTC
        

So don't use -mcpu=k6-2.

*** This bug has been marked as a duplicate of 122946 ***




Comment 3


Steve Egbert





          2006-03-03 12:11:21 UTC
        

Changed -mcpu to -mtune=k6-2

CHanged gcc from 3.3.x to 3.4.5

It is still a problem




Comment 4


Jakub Moc (RETIRED)






          2006-03-03 12:32:59 UTC
        

No, you should change it to -i586. Don't use those k6-2 optimizations.




Comment 5


Steve Egbert





          2006-03-04 17:12:30 UTC
        

Bug fixed as indicated in:

http://bugs.gentoo.org/show_bug.cgi?id=124217

and

http://gcc.gnu.org/bugzilla/show_bug.cgi?id=20653

The correct solution is NOT to use '-mtune=k6-2' until the gcc is upgraded to 4.1.0!!!

For now, use, instead, '-mtune=i586' from gcc 4.3.0 to 4.4.0.




Comment 6


Steve Egbert





          2006-03-04 20:44:55 UTC
        

Errata...

For those that use compiler option -mcpu=k6-2 or -mtune=k6-2 (also with k6-3),


For now, use '-mtune=i586' for gcc 3.3.4 through 4.0.1.


We should be able to revert to and again re-use '-mtune-k6-2' at gcc 4.1.0.




Comment 7


Jakub Moc (RETIRED)






          2006-03-05 02:26:00 UTC
        

We should filter this...




Comment 8


SpanKY






          2006-04-02 13:32:33 UTC
        

k6 flags are notorious for being unstable









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

