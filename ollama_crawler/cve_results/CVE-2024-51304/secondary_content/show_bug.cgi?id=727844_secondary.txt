Title: 727844 – kde-plasma/libksysguard-5.19.0 - 'processtest' test crashes and hangs
URL: https://bugs.gentoo.org/show_bug.cgi?id=727844

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 727844
kde-plasma/libksysguard-5.19.0 - 'processtest' test crashes and hangs
Last modified: 2024-06-24 18:12:26 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 727844 
      - kde-plasma/libksysguard-5.19.0 - 'processtest' test crashes and hangs


Summary:
kde-plasma/libksysguard-5.19.0 - 'processtest' test crashes and hangs
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:

TESTFAILURE







Depends on:







Blocks:









 





      Reported:
    
2020-06-10 13:49 UTC by Paolo Pedroni





      Modified:
    
2024-06-24 18:12 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




libksysguard-5.19.0:20200610-133132.log.gz

              (libksysguard-5.19.0:20200610-133132.log.gz,17.16 KB,
                application/gzip)

            
2020-06-10 13:49 UTC,

            Paolo Pedroni




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Paolo Pedroni





          2020-06-10 13:49:20 UTC
        

Created attachment 644292 [details]
libksysguard-5.19.0:20200610-133132.log.gz

>>> Test phase: kde-plasma/libksysguard-5.19.0
 * Scanning for an open DISPLAY to start Xvfb ...
 * Starting Xvfb on $DISPLAY=3 ...
 * Working in BUILD_DIR: "/var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build"
ctest -j 7 --test-load 6
Test project /var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build
    Start 1: processtest
    Start 2: chronotest
    Start 3: formattertest
1/6 Test #2: chronotest .......................   Passed    0.01 sec
    Start 4: sensortreemodeltest
    Start 5: sensordatamodeltest
    Start 6: processdatamodeltest
2/6 Test #3: formattertest ....................   Passed    0.01 sec
3/6 Test #4: sensortreemodeltest ..............   Passed    0.02 sec
4/6 Test #6: processdatamodeltest .............   Passed    0.12 sec
5/6 Test #5: sensordatamodeltest ..............   Passed    3.02 sec

...and it stays there "forever". Meanwhile:

$ ps aux | grep ^portage
portage  1642500  0.0  0.0   2320  1588 pts/2    S+   15:31   0:00 [kde-plasma/libksysguard-5.19.0] sandbox /usr/lib/portage/python3.7/ebuild.sh test
portage  1642501  0.0  0.0  16024  6928 pts/2    S+   15:31   0:00 /bin/bash /usr/lib/portage/python3.7/ebuild.sh test
portage  1642517  0.0  0.0  16164  6404 pts/2    S+   15:31   0:00 /bin/bash /usr/lib/portage/python3.7/ebuild.sh test
portage  1642539  0.0  0.3 977656 49092 pts/2    Sl+  15:31   0:00 /usr/bin/Xvfb :3 -screen 0 1280x1024x24 +extension RANDR
portage  1642575  0.0  0.0  27464 13272 pts/2    S+   15:31   0:00 ctest -j 7 --test-load 6
portage  1642576  0.6  0.6 1391372 111856 pts/2  T+   15:31   0:01 /var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build/bin/processtest
portage  1642593  0.0  0.0   7256  2580 pts/2    S+   15:31   0:00 dbus-launch --autolaunch 04f1b74c21a9d4f77cf93cdd5c1f8c63 --binary-syntax --close-stderr
portage  1642597  0.0  0.0   6112  3164 ?        Ss   15:31   0:00 /usr/bin/dbus-daemon --syslog-only --fork --print-pid 5 --print-address 7 --session
portage  1642619  0.0  0.1 229688 23188 ?        Sl   15:31   0:00 /usr/bin/kglobalaccel5
portage  1642648  0.0  0.5 1207580 81432 pts/2   Sl+  15:31   0:00 /usr/lib64/libexec/drkonqi --appname processtest --apppath /var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build/bin --signal 11 --pid 80 --startupid 0

If I 'kill -9' (just killing them is not enough) the 'processtest' and 'drkonqi' processes I get:
6/6 Test #1: processtest ......................Child killed***Exception: 443.82 sec

83% tests passed, 1 tests failed out of 6

Total Test time (real) = 443.83 sec

The following tests FAILED:
          1 - processtest (Child killed)
Errors while running CTest
 * ERROR: kde-plasma/libksysguard-5.19.0::gentoo failed (test phase):
 *   Tests failed. When you file a bug, please attach the following file: 
 *      /var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build/Testing/Temporary/LastTest.log

Relevant part of LastTest.log then says:
1/6 Testing: processtest
1/6 Test: processtest
Command: "/var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build/bin/processtest"
Directory: /var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build/autotests
"processtest" start time: Jun 10 15:31 CEST
Output:
----------------------------------------------------------
********* Start testing of testProcess *********
Config: Using QtTest library 5.14.2, Qt 5.14.2 (x86_64-little_endian-lp64 shared (dynamic) release build; by GCC 9.3.0)
PASS   : testProcess::initTestCase()
PASS   : testProcess::testTimeToUpdateAllProcesses()
RESULT : testProcess::testTimeToUpdateAllProcesses():
     3.12 msecs per iteration (total: 100, iterations: 32)
QWARN  : testProcess::testTimeToUpdateModel() kf5.kservice.services: The desktop entry file "/usr/share/applications/org.gnupg.pinentry-qt.desktop" has Type= "Application" but no Exec line
QWARN  : testProcess::testTimeToUpdateModel() kf5.kservice.sycoca: Invalid Service :  "/usr/share/applications/org.gnupg.pinentry-qt.desktop"
QWARN  : testProcess::testTimeToUpdateModel() QDBusConnection: name 'org.kde.kglobalaccel' had owner '' but we thought it was ':1.2'
QWARN  : testProcess::testTimeToUpdateModel() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
QWARN  : testProcess::testTimeToUpdateModel() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
QWARN  : testProcess::testTimeToUpdateModel() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
QWARN  : testProcess::testTimeToUpdateModel() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
QWARN  : testProcess::testTimeToUpdateModel() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
QWARN  : testProcess::testTimeToUpdateModel() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
QWARN  : testProcess::testTimeToUpdateModel() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
QWARN  : testProcess::testTimeToUpdateModel() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testTimeToUpdateModel() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
PASS   : testProcess::testTimeToUpdateModel()
RESULT : testProcess::testTimeToUpdateModel():
     7.1 msecs per iteration (total: 57, iterations: 8)
PASS   : testProcess::testProcesses()
PASS   : testProcess::testProcessesTreeStructure()
PASS   : testProcess::testProcessesModification()
QWARN  : testProcess::testHistories() History was not available
QWARN  : testProcess::testHistories() History was not available
PASS   : testProcess::testHistories()
RESULT : testProcess::testHistories():
     0 msecs per iteration (total: 0, iterations: 1)
QWARN  : testProcess::testHistoriesWithWidget() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testHistoriesWithWidget() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testHistoriesWithWidget() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
PASS   : testProcess::testHistoriesWithWidget()
PASS   : testProcess::testUpdateOrAddProcess()
QWARN  : testProcess::testCPUGraphHistory() QProcess: Destroyed while process ("/usr/lib64/libexec/ksysguard/ksgrd_network_helper") is still running.
QWARN  : testProcess::testCPUGraphHistory() org.kde.ksysguard.plugin.network: Helper process terminated abnormally!
QWARN  : testProcess::testCPUGraphHistory() org.kde.ksysguard.plugin.network: "ERROR: ld.so: object 'libsandbox.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.\n"
PASS   : testProcess::testCPUGraphHistory()
PASS   : testProcess::cleanupTestCase()
Totals: 11 passed, 0 failed, 0 skipped, 0 blacklisted, 2405ms
********* Finished testing of testProcess *********
KCrash: crashing... crashRecursionCounter = 2
KCrash: Application Name = processtest path = /var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build/bin pid = 80
KCrash: Arguments: /var/tmp/portage/kde-plasma/libksysguard-5.19.0/work/libksysguard-5.19.0_build/bin/processtest 
KCrash: Attempting to start /usr/lib64/libexec/drkonqi
<end of output>
Test time = 443.82 sec
----------------------------------------------------------
Test Failed.
"processtest" end time: Jun 10 15:39 CEST
"processtest" time elapsed: 00:07:23
----------------------------------------------------------

End testing: Jun 10 15:39 CEST

If I emerge the package with FEATURES=-test and then again with tests, it works...




Comment 1


Paolo Pedroni





          2020-06-10 13:50:56 UTC
        

# emerge --info =kde-plasma/libksysguard-5.19.0
Portage 2.3.99 (python 3.7.7-final-0, default/linux/amd64/17.1/desktop/plasma/systemd, gcc-9.3.0, glibc-2.30-r8, 5.6.16-gentoo x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-5.6.16-gentoo-x86_64-Intel-R-_Core-TM-_i5-8400_CPU_@_2.80GHz-with-gentoo-2.6
KiB Mem:    16123268 total,    281524 free
KiB Swap:   16777212 total,  16742396 free
Timestamp of repository gentoo: Wed, 10 Jun 2020 07:30:02 +0000
Head commit of repository gentoo: a082d725dfc5bf26fa94a0513efcdfd7cab0c324
sh dash 0.5.10.2-r1
ld GNU gold (Gentoo 2.33.1 p2 2.33.1) 1.16
ccache version 3.7.9 [disabled]
app-shells/bash:          5.0_p17::gentoo
dev-java/java-config:     2.2.0-r4::gentoo
dev-lang/perl:            5.30.3::gentoo
dev-lang/python:          2.7.18::gentoo, 3.7.7-r2::gentoo, 3.8.2-r2::gentoo
dev-util/ccache:          3.7.9::gentoo
dev-util/cmake:           3.16.5::gentoo
sys-apps/baselayout:      2.6-r1::gentoo
sys-apps/sandbox:         2.18::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.16.1-r1::gentoo
sys-devel/binutils:       2.33.1-r1::gentoo
sys-devel/gcc:            9.3.0::gentoo
sys-devel/gcc-config:     2.2.1::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 5.4-r1::gentoo (virtual/os-headers)
sys-libs/glibc:           2.30-r8::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-metamanifest: yes
    sync-rsync-verify-max-age: 24
    sync-rsync-extra-opts: 
    sync-rsync-verify-jobs: 1

x-portage
    location: /usr/local/portage
    masters: gentoo
    priority: 0

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -frecord-gcc-switches -march=skylake -mabm -flto=6"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe -frecord-gcc-switches -march=skylake -mabm -flto=6"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--keep-going y --with-bdeps y"
ENV_UNSET="DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe -frecord-gcc-switches -march=skylake -mabm -flto=6"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs cgroup compress-build-logs config-protect-if-modified distlocks ebuild-locks ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms sign split-elog split-log strict strict-keepdir test unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe -frecord-gcc-switches -march=skylake -mabm -flto=6"
GENTOO_MIRRORS="http://mirrors.evowise.com/gentoo/ https://mirrors.evowise.com/gentoo/ http://mirror.eu.oneandone.net/linux/distributions/gentoo/gentoo/ http://mirror.netcologne.de/gentoo/"
LANG="it_IT.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed -Wl,--hash-style=gnu -Wl,--sort-common -flto=6"
LINGUAS="it it_IT"
MAKEOPTS="-j7 -l6"
PKGDIR="/var/cache/binpkgs"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="X a52 aac aalib acl acpi activities adns alsa amd64 ao audiofile bash-completion bluetooth branding brotli bzip2 cairo caps cdda cddb cdparanoia cdr cli crypt css cups curl dbus declarative dga djvu dri dts dvd dvdr emboss encode exif expat fbcon ffmpeg fftw flac fontconfig foomaticdb fortran ftp gd gdbm geoip gif gimp gmp gnutls gphoto2 gpm graphviz gtk handbook iconv icu idn imagemagick imlib introspection ipv6 java javascript jbig jemalloc jpeg jpeg2k kde kipi kwallet lame lcms libass libnotify libsamplerate libtirpc lm_sensors lua lzma lzo mad mmap mng mp3 mp4 mpeg mplayer multilib musicbrainz ncurses nls nptl nsplugin offensive ogg openal opengl openmp pam pango pcre pdf phonon plasma png policykit postscript ppds pulseaudio qml qt5 rdesktop readline recode samba sctp sdl seccomp sndfile sockets speex spell split-usr sqlite ssl startup-notification svg symlink syslog systemd sysvipc taglib telemetry test theora threads tidy tiff truetype udev udisks unicode upower usb vaapi vala vim-syntax vnc vorbis wavpack wayland widgets win32codecs wmf wxwidgets x264 xattr xcb xine xml xpm xscreensaver xv xvid yahoo zlib zstd" ABI_X86="64" ADA_TARGET="gnat_2018" ALSA_CARDS="hda-intel virmidi" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" CAMERAS="kodak ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt sse sse2 sse3 sse4_1 sse4_2 ssse3" CURL_SSL="gnutls" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput" KERNEL="linux" L10N="it en" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="nlpsolver wiki-publisher" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-2" POSTGRES_TARGETS="postgres10 postgres11" PYTHON_SINGLE_TARGET="python3_7" PYTHON_TARGETS="python3_7" RUBY_TARGETS="ruby25" USERLAND="GNU" VIDEO_CARDS="intel i965" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, INSTALL_MASK, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

# emerge -1pqv =kde-plasma/libksysguard-5.19.0
[ebuild     U ] kde-plasma/libksysguard-5.19.0 [5.18.5] USE="X test webengine -debug -minimal"




Comment 2


Andreas Sturmlechner






          2024-06-24 18:10:18 UTC
        

(works for me with 24.05.1).




Comment 3


Andreas Sturmlechner






          2024-06-24 18:12:26 UTC
        

(should have meant 6.1.0)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

