Title: 223457 – x11-terms/xterm (229, 232, 234, 235) fails to compile
URL: https://bugs.gentoo.org/show_bug.cgi?id=223457

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 223457
x11-terms/xterm (229, 232, 234, 235) fails to compile
Last modified: 2008-09-08 16:57:04 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 223457 
      - x11-terms/xterm (229, 232, 234, 235) fails to compile


Summary:
x11-terms/xterm (229, 232, 234, 235) fails to compile
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-05-24 15:16 UTC by Thomas Pasch





      Modified:
    
2008-09-08 16:57 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



dickey









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Thomas Pasch





          2008-05-24 15:16:34 UTC
        

same for other xterm version...:

x86_64-pc-linux-gnu-gcc -I. -I. -DHAVE_CONFIG_H  -I/usr/include/freetype2  -DFUNCPROTO=15 -DOSMAJORVERSION=2 -DOSMINORVERSION=6  -D_GNU_SOURCE -DXTSTRINGDEFINES  -O3 -fomit-frame-pointer -pipe -fprefetch-loop-arrays -funroll-loops -mfpmath=sse -W -Wall -Wbad-function-cast -Wcast-align -Wcast-qual -Winline -Wmissing-declarations -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wundef -Wdeclaration-after-statement -Wextra -Wno-unknown-pragmas -Wswitch-enum -c ./input.c
x86_64-pc-linux-gnu-gcc -I. -I. -DHAVE_CONFIG_H  -I/usr/include/freetype2  -DFUNCPROTO=15 -DOSMAJORVERSION=2 -DOSMINORVERSION=6  -D_GNU_SOURCE -DXTSTRINGDEFINES  -O3 -fomit-frame-pointer -pipe -fprefetch-loop-arrays -funroll-loops -mfpmath=sse -W -Wall -Wbad-function-cast -Wcast-align -Wcast-qual -Winline -Wmissing-declarations -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wundef -Wdeclaration-after-statement -Wextra -Wno-unknown-pragmas -Wswitch-enum -c ./main.c
In file included from ./xtermcap.h:57,
                 from ./input.c:85:
/usr/include/curses.h:1315: error: expected ';', ',' or ')' before '*' token
make: *** [input.o] Error 1
make: *** Waiting for unfinished jobs....
In file included from ./xtermcap.h:57,
                 from ./main.c:121:
/usr/include/curses.h:1315: error: expected ';', ',' or ')' before '*' token
make: *** [main.o] Error 1
 *
 * ERROR: x11-terms/xterm-235 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 2438:  Called die
 * The specific snippet of code:
 *       emake || die "emake failed."
 *  The die message:
 *   emake failed.




Comment 1


Thomas Pasch





          2008-05-24 15:17:21 UTC
        

$ emerge --info
Portage 2.1.5.2 (default/linux/amd64/2008.0, gcc-4.2.3, glibc-2.7-r2, 2.6.24-gentoo-r3 x86_64)
=================================================================
System uname: 2.6.24-gentoo-r3 x86_64 AMD Athlon(tm) 64 Processor 3200+
Timestamp of tree: Sat, 24 May 2008 13:35:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p39
dev-java/java-config: 1.3.7, 2.1.6
dev-lang/python:     2.3.6-r3, 2.4.4-r6, 2.5.2-r4
dev-python/pycrypto: 2.0.1-r6
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 2.0.0
sys-apps/openrc:     0.2.4-r1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.62
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.1-r1
sys-devel/binutils:  2.15.92.0.2-r9, 2.16-r1, 2.16.1, 2.16.1-r2, 2.17-r1, 2.17.50.0.18, 2.18-r1, 2.18.50.0.3, 2.18.50.0.4
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.25-r3
ACCEPT_KEYWORDS="amd64 ~amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O3 -fomit-frame-pointer -pipe -fprefetch-loop-arrays -funroll-loops -mfpmath=sse"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /opt/openjms/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/kde/4.0/env /usr/kde/4.0/share/config /usr/kde/4.0/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O3 -fomit-frame-pointer -pipe -fprefetch-loop-arrays -funroll-loops -mfpmath=sse"
DISTDIR="/usr/portage/distfiles"
FEATURES="ccache distlocks metadata-transfer parallel-fetch sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://ftp-stud.fht-esslingen.de/pub/Mirrors/gentoo/ http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/ ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror/"
LANG="de_DE.UTF-8"
LC_ALL="de_DE.UTF-8"
LDFLAGS=""
LINGUAS="de en fr"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/tmp/gentoo"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/sunrise /usr/portage/local/layman/haskell"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X Xaw3d a52 aac accessibility acl acpi adns aio akode allegro alsa amd64 amr ansi ao aotuv apache2 arts asf auctex audiofile autoipd automount avahi avi badval bash-completion beagle berkdb bitmap-fonts bjam bl blas bluetooth bonjour bonobo boo bookmarks boost branding browserplugin bzip2 cairo caps cdda cddb cdio cdparanoia cdr cegui chm cli console corba cracklib crypt cscope css cups curl custom-cflags custreloc daap dbjftt dbus devhelp device-mapper devil dga directfb disk-partition divx4linux djbfft djvu dlloader dlopen dmi doc dri dts dv dvb dvd dvdr dvdread dxr3 dynagraph ecc edl emovix encode erandom esd exif exscalibar f77 faac faad fam fame fax fbcon ffmpeg fftw firefox flac fontconfig foomaticdb fortran fping fpx freetds freetype gb gcj gd gda gdbm gdl ggi ghcbootstrap gif gimpprint glade glibc-omitfp glitz glut gmedia gnome gnomedb gnutls gphoto2 gpm graphviz gs gsl gstreamer gtk gtk2 gtkhtml guile hal hardened haskell hdf howl howl-compat hyphenation i8x0 ical iconv icu id3 idea idl idn ieee1394 ilbc imagemagick imap imlib imlib2 inherit-graph innodb inotify ipod iproute2 ipv6 irda irmc isdnlog ithreads jabber jack jai java javamail javascript jce jimi jms jmx jpeg jpeg2k junit jython kde kdehiddenvisibility kdepim kig-scripting kipi ladcca ladspa lame lapack latex lcd lcms ldap libburn libnotify libsamplerate libvisual lirc live lm_sensors logitech-mouse logrotate lua lzo mad mailwrapper matroska md5sum mdnsresponder-compat midi mikmod mjpeg mmap mmx mmx2 mmxext mng mod modplug monkey mono mozcalendar mozsvg mp3 mp4 mp4live mpeg mpeg2 mplayer mtp mudflap multilib multislot multitarget musepack musicbrainz mysql mythtv nautilus ncurses netcdf network nfs nls nntp no-seamonkey nodrm nptl nptlonly nsplugin numeric obex objc ocaml ofa ogg oggvorbis ole openal openexr opengl openmp p2p pam parport pcre pda pdf pdflib perl pic pie player plotutils png pnp portaudio postgres povray ppds pppd pulseaudio pyste python qhull qt qt3 qt3support qt4 quicktime rar readline realmedia reflection rhino rtc rtsp ruby samba sasl scanner screen sdl session shout silc slp smime sms sndfile sourceview sox speex spell spl sql sqlite srt sse sse2 ssl stream subtitles subversion svg sysfs syslog szip t1lib tagwriting tcpd tetex tga theora threads threadsafe threadsonly thunderbird tidy tiff tools totem truetype ucs2 udev unicode upnp usb utempter utf8 v4l v4l2 valgrind vcd vlm vorbis vorbis-psy wavpack webdav wmf wmp wxwindows x264 xanim xcomposite xerces-c xine xinerama xinetd xml xml2 xorg xosd xpm xprint xscreensaver xv xvid xvmc zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="canon" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de en fr" USERLAND="GNU" VIDEO_CARDS="radeon ati vesa vga fbdev nvidia"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 2


Jeroen Roovers (RETIRED)






          2008-05-24 17:09:48 UTC
        

Please try again without the two wonkier gcc flags:

CFLAGS="-O3 -fomit-frame-pointer -pipe -fprefetch-loop-arrays -funroll-loops
-mfpmath=sse"




Comment 3


Thomas Pasch





          2008-05-26 18:12:37 UTC
        

Unset the CFLAGS as requested -> same problem.

x86_64-pc-linux-gnu-gcc -I. -I. -DHAVE_CONFIG_H  -I/usr/include/freetype2  -DFUNCPROTO=15 -DOSMAJORVERSION=2 -DOSMINORVERSION=6  -D_GNU_SOURCE -DXTSTRINGDEFINES  -O2 -pipe -W -Wall -Wbad-function-cast -Wcast-align -Wcast-qual -Winline -Wmissing-declarations -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wundef -Wdeclaration-after-statement -Wextra -Wno-unknown-pragmas -Wswitch-enum -c ./fontutils.c
x86_64-pc-linux-gnu-gcc -I. -I. -DHAVE_CONFIG_H  -I/usr/include/freetype2  -DFUNCPROTO=15 -DOSMAJORVERSION=2 -DOSMINORVERSION=6  -D_GNU_SOURCE -DXTSTRINGDEFINES  -O2 -pipe -W -Wall -Wbad-function-cast -Wcast-align -Wcast-qual -Winline -Wmissing-declarations -Wmissing-prototypes -Wnested-externs -Wpointer-arith -Wshadow -Wstrict-prototypes -Wundef -Wdeclaration-after-statement -Wextra -Wno-unknown-pragmas -Wswitch-enum -c ./input.c
In file included from ./xtermcap.h:57,
                 from ./input.c:85:
/usr/include/curses.h:1315: error: expected ';', ',' or ')' before '*' token
make: *** [input.o] Error 1
make: *** Waiting for unfinished jobs....
./charproc.c: In function 'in_put':
./charproc.c:3242: warning: comparison between signed and unsigned
./charproc.c:3248: warning: comparison between signed and unsigned
 *
 * ERROR: x11-terms/xterm-235 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 2438:  Called die
 * The specific snippet of code:
 *       emake || die "emake failed."
 *  The die message:
 *   emake failed.






Comment 4


Jeroen Roovers (RETIRED)






          2008-05-26 18:37:20 UTC
        

Thank you for the info.




Comment 5


Donnie Berkholz (RETIRED)






          2008-05-28 07:32:07 UTC
        

What version of ncurses? Are any newer versions available?




Comment 6


Thomas Pasch





          2008-05-28 19:08:41 UTC
        

*  sys-libs/ncurses
      Latest version available: 5.6-r2
      Latest version installed: 5.6-r2
      Size of files: 2,352 kB
      Homepage:      http://www.gnu.org/software/ncurses/ http://dickey.his.com/ncurses/
      Description:   console display library
      License:       MIT





Comment 7


Thomas Dickey





          2008-06-03 00:27:42 UTC
        

I'm curious what's at line 1315 in curses.h (my current files all
have something in the #define's for KEY_xxx symbols around that point).




Comment 8


Donnie Berkholz (RETIRED)






          2008-06-04 06:18:24 UTC
        

(In reply to comment #7)
> I'm curious what's at line 1315 in curses.h (my current files all
> have something in the #define's for KEY_xxx symbols around that point).


  1304  typedef struct
  1305  {
  1306      short id;           /* ID to distinguish multiple devices */
  1307      int x, y, z;        /* event coordinates (character-cell) */
  1308      mmask_t bstate;     /* button state bits */
  1309  }
  1310  MEVENT;
  1311  
  1312  extern NCURSES_EXPORT(int) getmouse (MEVENT *);
  1313  extern NCURSES_EXPORT(int) ungetmouse (MEVENT *);
  1314  extern NCURSES_EXPORT(mmask_t) mousemask (mmask_t, mmask_t *);
  1315  extern NCURSES_EXPORT(bool) wenclose (const WINDOW *, int, int);
  1316  extern NCURSES_EXPORT(int) mouseinterval (int);
  1317  extern NCURSES_EXPORT(bool) wmouse_trafo (const WINDOW*, int*, int*, bool);
  1318  extern NCURSES_EXPORT(bool) mouse_trafo (int*, int*, bool);              /* generated */





Comment 9


Thomas Dickey





          2008-08-25 11:06:52 UTC
        

The easy way to see the problem would be to make a preprocessor-output,
e.g., "make main.i" for xterm (though perhaps not so easy if the failure's
inside an ebuild...).  Looking at curses.h, I see we've already declared
functions using "WINDOW *".  There might be some macro defining wenclose
in an included header (gcc's fix-includes has been the source of obscure
problems related to ncurses several times).

Or the problem could be with the preceding line - I don't see anything
obvious.




Comment 10


Thomas Pasch





          2008-08-25 18:36:15 UTC
        

Well after many tries, the reported problem is finally gone. I'm not 100% sure, but I think a re-emerge of ncurses has fixed it.

Hence this bug could probably be closed unfixed. Except someone reports the same problem..









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

