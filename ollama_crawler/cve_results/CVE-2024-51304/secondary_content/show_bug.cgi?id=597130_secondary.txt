Title: 597130 – app-portage/gentoolkit-0.3.2-r1 revdep-rebuild fails to emerge packages if --newuse is set in make.conf
URL: https://bugs.gentoo.org/show_bug.cgi?id=597130

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 597130
app-portage/gentoolkit-0.3.2-r1 revdep-rebuild fails to emerge packages if --newuse is set in make.conf
Last modified: 2016-10-16 10:03:52 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 597130 
      - app-portage/gentoolkit-0.3.2-r1 revdep-rebuild fails to emerge packages if --newuse is set in make.conf


Summary:
app-portage/gentoolkit-0.3.2-r1 revdep-rebuild fails to emerge packages if --...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2016-10-14 19:52 UTC by gentoo





      Modified:
    
2016-10-16 10:03 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



gentoo









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info output

              (emerge-info.txt,17.31 KB,
                text/plain)

            
2016-10-14 19:52 UTC,

            gentoo




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


gentoo





          2016-10-14 19:52:14 UTC
        

Created attachment 450222 [details]
emerge --info output

I included "-N" in the EMERGE_DEFAULT_OPTS (so that packages with changed USE will be re-emerged).  A side-effect of this is that, if I try to emerge a package that's already installed, emerge won't do anything.  (Or, in the terminology of the emerge man page, -N activates --selective, which is equivalent to --noreplace.)

In the case of revdep-rebuild, this results of revdep-rebuild skipping packages that need to be rebuilt, if they are already installed. (And usually they are.) So revdep-rebuild skips most of the packages that need to be rebuilt.

Revdep-rebuild needs to either override the default options (using --ignore-default-opts?) or at least override the setting described above.

Attaching emerge --info output.




Comment 1


Brian Dolbec (RETIRED)






          2016-10-14 21:33:42 UTC
        

revdep-rebuild calls emerge with the list of pkgs to re-emerge.

If it nuked the default opts, we would get I'm sure more people complaining.  Allowing them, would result in far fewer people with problems due to them being included.  An option like --newuse should not be a default option in my opinion.  It will cause more grief due to un-expected actions than it will save one or two keystrokes when entering an emerge command

There is no easy means to override just the one option.  So it would have to be one way or the other, all or none.

Revdep-rebuild will pass any options after a double-dash "--" along to emerge without considering them for revdep-rebuild (some revdep options pass thru to emerge like -q -v).

eg: revdep-rebuild -i -- --ignore-default-opts




Comment 2


gentoo





          2016-10-16 10:03:52 UTC
        

Thanks!  I've included REVDEP_REBUILD_DEFAULT_OPTS in make.conf and set it to something that doesn't include the -N use flag.  That should fix the issue.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

