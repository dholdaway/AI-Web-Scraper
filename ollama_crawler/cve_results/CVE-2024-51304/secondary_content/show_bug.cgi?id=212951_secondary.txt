Title: 212951 – app-crypt/pinentry-0.7.4-r1 can't build on uclibc due to lack of iconv support
URL: https://bugs.gentoo.org/show_bug.cgi?id=212951

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 212951
app-crypt/pinentry-0.7.4-r1 can't build on uclibc due to lack of iconv support
Last modified: 2008-03-12 22:35:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 212951 
      - app-crypt/pinentry-0.7.4-r1 can't build on uclibc due to lack of iconv support


Summary:
app-crypt/pinentry-0.7.4-r1 can't build on uclibc due to lack of iconv support
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Embedded Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-03-10 15:26 UTC by Aurélien Francillon





      Modified:
    
2008-03-12 22:35 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




app-crypt:pinentry-0.7.4-r1:20080311-072259.log

              (app-crypt:pinentry-0.7.4-r1:20080311-072259.log,5.15 KB,
                text/plain)

            
2008-03-11 07:29 UTC,

            Aurélien Francillon




Details





mini-iconv-0.1.ebuild

              (mini-iconv-0.1.ebuild,959 bytes,
                text/plain)

            
2008-03-12 20:45 UTC,

            Aurélien Francillon




Details





libiconv-0.ebuild.patch

              (libiconv-0.ebuild.patch,433 bytes,
                patch)

            
2008-03-12 20:48 UTC,

            Aurélien Francillon




Details
            | Diff





libiconv-0.ebuild.patch

              (libiconv-0.ebuild.patch,433 bytes,
                text/plain)

            
2008-03-12 21:03 UTC,

            Aurélien Francillon




Details





mini-iconv-0.1.ebuild

              (mini-iconv-0.1.ebuild,962 bytes,
                text/plain)

            
2008-03-12 21:04 UTC,

            Aurélien Francillon




Details





Show
              Obsolete (3)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Aurélien Francillon





          2008-03-10 15:26:29 UTC
        

Building pinentry (needed for gnupg) fails because of the lack of iconv support on uclibc.

checking for iconv... no, consider installing GNU libiconv
configure: error:

however trying by hand various options to configure () leads to no results ... 
I know iconv.gettext/etc support is broken on uclibc based hosts, i just fail to find a workaroud ...
However it seems to be "possible" to build as some one (solar?) uploaded a bin pkg in tinderbox for uclibc:
http://tinderbox.x86.dev.gentoo.org/html/uclibc/i386/pinentry-0.7.4-r1.html

so what are the magic invocations needed to build pinentry? a fake iconv lib ? 
any comprehensive doc about this ? 

Thanks in advance 
Aurélien


Reproducible: Always




Portage 2.1.4.4 (uclibc/x86/hardened, gcc-3.4.6, uclibc-0.9.28.3-r2, 2.6.23-hardened-r7 i686)
=================================================================
System uname: 2.6.23-hardened-r7 i686 Pentium III (Coppermine)
Timestamp of tree: Mon, 10 Mar 2008 01:46:01 +0000
app-shells/bash:     3.2_p17-r1
dev-lang/python:     2.4.4-r9
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-uclibc"
CFLAGS="-march=pentium3 -O2 -pipe -fomit-frame-pointer -msse -mmmx"
CHOST="i686-pc-linux-uclibc"
CONFIG_PROTECT="/etc /var/bind"
CONFIG_PROTECT_MASK="/etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-march=pentium3 -O2 -pipe -fomit-frame-pointer -msse -mmmx"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer nodoc noinfo noman sandbox sfperms strict test unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://ftp.proxad.net/mirrors/ftp.gentoo.org/"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/home/aurel/testingportage-hardeneduclibc"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="aalib apache2 audiofile berkdb bzip2 caps cdb chroot cli cracklib crypt curl dri dts expat ffmpeg gd gdbm ggi gmp hardened imagemagick imap ipv6 jpeg lcms libcaca libwww maildir mhash midi mmx mudflap ncurses no-htdocs ogg openmp pcre perl php pic pie png python readline reflection sasl session sftplogging snmp spl sse ssl tcpd tiff truetype uclibc uclibc-compat udev usb wmf x86 xml2 xorg xvid zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" ELIBC="uclibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="dummy fbdev v4l"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Jakub Moc (RETIRED)






          2008-03-10 18:24:38 UTC
        

Reopen with complete emerge log; thanks.




Comment 2


Aurélien Francillon





          2008-03-11 07:29:19 UTC
        

Created attachment 145796 [details]
app-crypt:pinentry-0.7.4-r1:20080311-072259.log

here is the full log ...
i also tried various combinaisons of the use flags but non helps...
thanks




Comment 3


Aurélien Francillon





          2008-03-11 07:30:42 UTC
        

repoening, log attached 





Comment 4


solar (RETIRED)






          2008-03-12 14:56:57 UTC
        

http://tinderbox.dev.gentoo.org/portage/local/misc/mini-iconv/




Comment 5


Aurélien Francillon





          2008-03-12 15:40:20 UTC
        

That's great thanks !
is it candidate to get into portage tree ?
I can write an ebuild and open a "new ebuild" bug if that's the missing part ...

thanks
Aurélien





Comment 6


Aurélien Francillon





          2008-03-12 20:45:51 UTC
        

Created attachment 145924 [details]
mini-iconv-0.1.ebuild

ebuild for 
dev-libs/mini-iconv 
if that can help some one ...




Comment 7


Aurélien Francillon





          2008-03-12 20:48:26 UTC
        

Created attachment 145925 [details, diff]
libiconv-0.ebuild.patch

patch to libiconv-0.ebuild in order to make virtual/libiconv 
depend on mini-iconv on uclibc




Comment 8


Aurélien Francillon





          2008-03-12 21:03:33 UTC
        

Created attachment 145926 [details]
libiconv-0.ebuild.patch

fixed a typo




Comment 9


Aurélien Francillon





          2008-03-12 21:04:46 UTC
        

Created attachment 145927 [details]
mini-iconv-0.1.ebuild

oups i uploaded the wrong file ... 
sorry for the noise




Comment 10


solar (RETIRED)






          2008-03-12 22:35:16 UTC
        

Attention gentoo.devs. Do *NOT* commit this ebuild to the tree or you will face the wrath of one really upset solar. Thanks in advance.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

