Title: 373777 – dev-util/cmake-2.8.4-r1 build failed
URL: https://bugs.gentoo.org/show_bug.cgi?id=373777

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 373777
dev-util/cmake-2.8.4-r1 build failed
Last modified: 2014-01-13 21:15:56 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 373777 
      - dev-util/cmake-2.8.4-r1 build failed


Summary:
dev-util/cmake-2.8.4-r1 build failed
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

Mac OSX

  (show other bugs)



Hardware:

All
        OS X
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Prefix








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-07-02 05:15 UTC by Naohiro Aota





      Modified:
    
2014-01-13 21:15 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



kensington









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




cmake-2.8.4-bandle-path.patch

              (cmake-2.8.4-bundle-path.patch,470 bytes,
                patch)

            
2011-07-02 05:21 UTC,

            Naohiro Aota




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Naohiro Aota






          2011-07-02 05:15:54 UTC
        

failed with 


-- fixup_bundle
--   app='/Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r1/image//Users/naota/Gentoo/usrCMake 2.8-4.app/Contents/MacOS/CMake 2.8-4'
--   libs=''
--   dirs='/Users/naota/Gentoo/usr/lib/qt4;/Users/naota/Gentoo/usr/bin'
-- warning: *NOT* handled - directory/file does not exist...
CMake Error at /Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r1/work/cmake-2.8.4/Modules/BundleUtilities.cmake:657 (message):
  error: fixup_bundle: not a valid bundle
Call Stack (most recent call first):
  Source/QtDialog/cmake_install.cmake:56 (fixup_bundle)
  Source/cmake_install.cmake:86 (INCLUDE)
  cmake_install.cmake:45 (INCLUDE)

As you can see, fixup_bundle called with strange path "~/Gentoo/usrCMake 2.8-4.app/...". This might be "~/Gentoo/usr/CMake 2.8-4.app/..."

cmake-2.8.4/CMakeLists.txt has the following lines to ensure the directory is separated by "/"

  STRING(SUBSTRING "${CMAKE_INSTALL_PREFIX}" ${LEN} 1 ENDCH)
    IF(NOT "${ENDCH}" STREQUAL "/")
      SET(CMAKE_INSTALL_PREFIX "${CMAKE_INSTALL_PREFIX}/")
    ENDIF(NOT "${ENDCH}" STREQUAL "/")
    SET(CMAKE_INSTALL_PREFIX 
      "${CMAKE_INSTALL_PREFIX}${CMAKE_BUNDLE_NAME}.app/Contents")

But the SET line is commented out because of our cmake-utils eclass.


Reproducible: Always




Comment 1


Naohiro Aota






          2011-07-02 05:21:22 UTC
        

Created attachment 278835 [details, diff]
cmake-2.8.4-bandle-path.patch

This solve at least the problem above, but still build fail.


-- verified='0'
-- info='external prerequisites found:
f='/Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r2/image/Users/naota/Gentoo/usr/CMake 2.8-4.app/Contents/bin/ccmake'
external_prereqs='/Users/naota/Gentoo/lib/libz.1.dylib;/Users/naota/Gentoo/usr/lib/libcrypto.1.0.0.dylib'
;external prerequisites found:
f='/Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r2/image/Users/naota/Gentoo/usr/CMake 2.8-4.app/Contents/bin/cmake'
external_prereqs='/Users/naota/Gentoo/lib/libz.1.dylib;/Users/naota/Gentoo/usr/lib/libcrypto.1.0.0.dylib'
;external prerequisites found:
f='/Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r2/image/Users/naota/Gentoo/usr/CMake 2.8-4.app/Contents/bin/cmakexbuild'
external_prereqs='/Users/naota/Gentoo/lib/libz.1.dylib'
;external prerequisites found:
f='/Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r2/image/Users/naota/Gentoo/usr/CMake 2.8-4.app/Contents/bin/cpack'
external_prereqs='/Users/naota/Gentoo/lib/libz.1.dylib;/Users/naota/Gentoo/usr/lib/libcrypto.1.0.0.dylib'
;external prerequisites found:
f='/Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r2/image/Users/naota/Gentoo/usr/CMake 2.8-4.app/Contents/bin/ctest'
external_prereqs='/Users/naota/Gentoo/lib/libz.1.dylib;/Users/naota/Gentoo/usr/lib/libcrypto.1.0.0.dylib'
;external prerequisites found:
f='/Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r2/image/Users/naota/Gentoo/usr/CMake 2.8-4.app/Contents/MacOS/CMake 2.8-4'
external_prereqs='/Users/naota/Gentoo/lib/libz.1.dylib;/Users/naota/Gentoo/usr/lib/libcrypto.1.0.0.dylib'
'
-- 
CMake Error at /Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r2/work/cmake-2.8.4/Modules/BundleUtilities.cmake:773 (message):
  error: verify_app failed
Call Stack (most recent call first):
  /Users/naota/Gentoo/var/tmp/portage/dev-util/cmake-2.8.4-r2/work/cmake-2.8.4/Modules/BundleUtilities.cmake:655 (verify_app)
  Source/QtDialog/cmake_install.cmake:56 (fixup_bundle)
  Source/cmake_install.cmake:86 (INCLUDE)
  cmake_install.cmake:45 (INCLUDE)

It seems this check if the libraries linked against the binary are "system" or "embedded", so it doesn't like Gentoo library. 

Possible fix would be

- To disable this test
or
- To link the libraries statically

(I don't have test either yet)




Comment 2


Fabian Groffen






          2011-08-21 07:58:19 UTC
        

cmake 2.8.5-r2 is installed right here.  If that one compiles for you too, do you agree on closing this bug?  Thanks




Comment 3


Naohiro Aota






          2011-08-21 15:18:47 UTC
        

(In reply to comment #2)
> cmake 2.8.5-r2 is installed right here.  If that one compiles for you too, do
> you agree on closing this bug?  Thanks

hmm, 2.8.5-r2 still failed here with the same error.




Comment 4


Fabian Groffen






          2011-08-26 20:50:03 UTC
        

odd, can't reproduce this




Comment 5


Naohiro Aota






          2011-11-07 13:42:19 UTC
        

2.8.6-r3 worked with USE="-qt4" but still not work with USE="qt4"




Comment 6


Michael Palimaka (kensington)






          2013-09-01 17:01:23 UTC
        

Is this still occurring with a recent CMake version?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

