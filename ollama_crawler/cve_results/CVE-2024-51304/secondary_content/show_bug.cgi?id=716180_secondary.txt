Title: 716180 – >=kde-apps/kscreen-5.18.0: File or directory //include/KF5 referenced by variable PlasmaQuick_INCLUDE_DIR does not exist
URL: https://bugs.gentoo.org/show_bug.cgi?id=716180

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 716180
>=kde-apps/kscreen-5.18.0: File or directory //include/KF5 referenced by variable PlasmaQuick_INCLUDE_DIR does not exist
Last modified: 2020-08-18 09:16:32 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 716180 
      - >=kde-apps/kscreen-5.18.0: File or directory //include/KF5 referenced by variable PlasmaQuick_INCLUDE_DIR does not exist


Summary:
>=kde-apps/kscreen-5.18.0: File or directory //include/KF5 referenced by vari...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Eclasses

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-04-04 14:37 UTC by Jimmy Kloss





      Modified:
    
2020-08-18 09:16 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge-info.txt,20.46 KB,
                text/plain)

            
2020-04-04 14:38 UTC,

            Jimmy Kloss




Details





build.log

              (kde-plasma:kscreen-5.18.4.1:20200404-125619.log,9.82 KB,
                text/x-log)

            
2020-04-04 15:00 UTC,

            Jimmy Kloss




Details





CMakeOutput.log

              (kde-plasma:kscreen-5.18.4.1:20200404-125619_CMakeOutput.log,44.31 KB,
                text/x-log)

            
2020-04-04 15:52 UTC,

            Jimmy Kloss




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jimmy Kloss





          2020-04-04 14:37:32 UTC
        

Ever since after kscreen-5.18.0, it wouldn't compile anymore, because of not finding the include dir. Could be my system config, but other packages work fine, though.

Error snippet:
-- Found KF5XmlGui: /lib64/cmake/KF5XmlGui/KF5XmlGuiConfig.cmake (found version "5.68.0") 
-- Found KF5: success (found suitable version "5.68.0", minimum required is "5.66.0") found components: Config DBusAddons Declarative GlobalAccel I18n IconThemes KCMUtils Plasma XmlGui 
CMake Error at /share/ECM/cmake/ECMConfig.cmake:11 (message):
  File or directory //include/KF5 referenced by variable
  PlasmaQuick_INCLUDE_DIR does not exist !
Call Stack (most recent call first):
  /lib64/cmake/KF5PlasmaQuick/KF5PlasmaQuickConfig.cmake:45 (set_and_check)
  //share/ECM/find-modules/FindKF5.cmake:74 (find_package)
  CMakeLists.txt:37 (find_package)


-- Configuring incomplete, errors occurred!


Changing KF5PlasmaQuickConfig.cmake line 45 from
set_and_check(PlasmaQuick_INCLUDE_DIR    "${PACKAGE_PREFIX_DIR}/include/KF5")
to
set_and_check(PlasmaQuick_INCLUDE_DIR    "/usr/include/KF5")

makes it work. But I have no clue if this is an issue with the ebuild, the eclasses or my system. 

% ls -lh / /usr|grep '\->'
lrwxrwxrwx   1 root root    7 14. Sep 2019  bin -> usr/bin
lrwxrwxrwx   1 root root    7 14. Sep 2019  lib -> usr/lib
lrwxrwxrwx   1 root root    9 14. Sep 2019  lib64 -> usr/lib64
lrwxrwxrwx   1 root root    8 14. Sep 2019  sbin -> usr/sbin
lrwxrwxrwx   1 root root   10  7. Jan 15:22 share -> /usr/share
lrwxrwxrwx 1 root root   20  6. Dez 17:57 portage -> /var/db/repos/gentoo
lrwxrwxrwx 1 root root    8  3. Mär 2017  tmp -> /var/tmp

Reproducible: Always

Steps to Reproduce:
1.emerge kscreen
2.
3.




Comment 1


Jimmy Kloss





          2020-04-04 14:38:28 UTC
        

Created attachment 629922 [details]
emerge --info




Comment 2


Andreas Sturmlechner






          2020-04-04 14:50:30 UTC
        

Attach full build.log please, not just that snippet.

$ equery l dev-qt/*
$ equery l kde-frameworks/*




Comment 3


Jimmy Kloss





          2020-04-04 15:00:30 UTC
        

Created attachment 629924 [details]
build.log

% equery l 'dev-qt/*'                                                                                                                                                                                                          
 * Searching for * in dev-qt ...                                                                                                                                                                                                                
[IP-] [  ] dev-qt/designer-5.14.1:5/5.14                                                                                                                                                                                                        
[IP-] [  ] dev-qt/linguist-5.14.1:5/5.14                                                                                                                                                                                                        
[IP-] [  ] dev-qt/linguist-tools-5.14.1:5/5.14                                                                                                                                                                                                  
[IP-] [  ] dev-qt/qdbus-5.14.1:5/5.14                                                                                                                                                                                                           
[IP-] [  ] dev-qt/qdbusviewer-5.14.1:5/5.14                                                                                                                                                                                                     
[IP-] [  ] dev-qt/qt-docs-5.14.1_p202001241012:5                                                                                                                                                                                                
[IP-] [  ] dev-qt/qtbluetooth-5.14.1:5/5.14                                                                                                                                                                                                     
[I--] [??] dev-qt/qtcharts-5.12.3:5/5.12                                                                                                                                                                                                        
[IP-] [  ] dev-qt/qtchooser-66:0                                                                                                                                                                                                                
[IP-] [  ] dev-qt/qtconcurrent-5.14.1:5/5.14                                                                                                                                                                                                    
[IP-] [  ] dev-qt/qtcore-5.14.1-r1:5/5.14                                                                                                                                                                                                       
[IP-] [  ] dev-qt/qtdbus-5.14.1:5/5.14                                                                                                                                                                                                          
[IP-] [  ] dev-qt/qtdeclarative-5.14.1-r2:5/5.14                                                                                                                                                                                                
[IP-] [  ] dev-qt/qtgraphicaleffects-5.14.1:5/5.14                                                                                                                                                                                              
[IP-] [  ] dev-qt/qtgui-5.14.1-r4:5/5.14.1                                                                                                                                                                                                      
[IP-] [  ] dev-qt/qthelp-5.14.1:5/5.14                                                                                                                                                                                                          
[IP-] [  ] dev-qt/qtimageformats-5.14.1:5/5.14                                                                                                                                                                                                  
[IP-] [  ] dev-qt/qtlockedfile-2.4.1_p20171024:0                                                                                                                                                                                                
[IP-] [  ] dev-qt/qtmultimedia-5.14.1-r1:5/5.14                                                                                                                                                                                                 
[IP-] [  ] dev-qt/qtnetwork-5.14.1:5/5.14                                                                                                                                                                                                       
[I--] [??] dev-qt/qtnetworkauth-5.12.5:5/5.12                                                                                                                                                                                                   
[IP-] [  ] dev-qt/qtopengl-5.14.1-r1:5/5.14                                                                                                                                                                                                     
[IP-] [  ] dev-qt/qtpaths-5.14.1:5/5.14                                                                                                                                                                                                         
[IP-] [  ] dev-qt/qtpositioning-5.14.1:5/5.14                                                                                                                                                                                                   
[IP-] [  ] dev-qt/qtprintsupport-5.14.1-r1:5/5.14                                                                                                                                                                                               
[IP-] [  ] dev-qt/qtquickcontrols-5.14.1:5/5.14                                                                                                                                                                                                 
[IP-] [  ] dev-qt/qtquickcontrols2-5.14.1:5/5.14                                                                                                                                                                                                
[IP-] [  ] dev-qt/qtscript-5.14.1:5/5.14                                                                                                                                                                                                        
[IP-] [  ] dev-qt/qtsensors-5.14.1:5/5.14                                                                                                                                                                                                       
[IP-] [  ] dev-qt/qtsingleapplication-2.6.1_p20171024:0                                                                                                                                                                                         
[IP-] [  ] dev-qt/qtsql-5.14.1:5/5.14.1                                                                                                                                                                                                         
[IP-] [  ] dev-qt/qtsvg-5.14.1:5/5.14                                                                                                                                                                                                           
[IP-] [  ] dev-qt/qttest-5.14.1:5/5.14                                                                                                                                                                                                          
[IP-] [  ] dev-qt/qtvirtualkeyboard-5.14.1:5/5.14                                                                                                                                                                                               
[IP-] [  ] dev-qt/qtwayland-5.14.1-r3:5/5.14                                                                                                                                                                                                    
[IP-] [  ] dev-qt/qtwebchannel-5.14.1:5/5.14                                                                                                                                                                                                    
[IP-] [  ] dev-qt/qtwidgets-5.14.1-r1:5/5.14                                                                                                                                                                                                    
[IP-] [  ] dev-qt/qtx11extras-5.14.1:5/5.14                                                                                                                                                                                                     
[IP-] [  ] dev-qt/qtxml-5.14.1:5/5.14                                                                                                                                                                                                           
[IP-] [  ] dev-qt/qtxmlpatterns-5.14.1:5/5.14

% equery l 'kde-frameworks/*'
 * Searching for * in kde-frameworks ...                                                                                                                                                                                                        
[IP-] [  ] kde-frameworks/attica-5.68.0:5/5.68                                                                                                                                                                                                  
[IP-] [  ] kde-frameworks/bluez-qt-5.68.0:5/5.68                                                                                                                                                                                                
[IP-] [  ] kde-frameworks/breeze-icons-5.68.0:5/5.68                                                                                                                                                                                            
[IP-] [  ] kde-frameworks/extra-cmake-modules-5.68.0:5/5.68                                                                                                                                                                                     
[IP-] [  ] kde-frameworks/frameworkintegration-5.68.0:5/5.68                                                                                                                                                                                    
[IP-] [  ] kde-frameworks/kactivities-5.68.0:5/5.68                                                                                                                                                                                             
[IP-] [  ] kde-frameworks/kactivities-stats-5.68.0:5/5.68                                                                                                                                                                                       
[IP-] [  ] kde-frameworks/karchive-5.68.0:5/5.68                                                                                                                                                                                                
[IP-] [  ] kde-frameworks/kauth-5.68.0:5/5.68                                                                                                                                                                                                   
[IP-] [  ] kde-frameworks/kbookmarks-5.68.0:5/5.68                                                                                                                                                                                              
[I--] [??] kde-frameworks/kcalendarcore-5.66.0:5/5.66                                                                                                                                                                                           
[IP-] [  ] kde-frameworks/kcmutils-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kcodecs-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kcompletion-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kconfig-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kconfigwidgets-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kcontacts-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kcoreaddons-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kcrash-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kdbusaddons-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kdeclarative-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kded-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kdelibs4support-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kdesignerplugin-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kdesu-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kdnssd-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kdoctools-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kemoticons-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kf-env-5:5
[IP-] [  ] kde-frameworks/kfilemetadata-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kglobalaccel-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kguiaddons-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kholidays-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/ki18n-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kiconthemes-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kidletime-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kimageformats-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kinit-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kio-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kirigami-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kitemmodels-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kitemviews-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kjobwidgets-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kjs-5.68.0:5/5.68
[I--] [??] kde-frameworks/kjsembed-5.60.0:5/5.60
[IP-] [  ] kde-frameworks/knewstuff-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/knotifications-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/knotifyconfig-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kpackage-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kparts-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kpeople-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kpty-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kquickcharts-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kross-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/krunner-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kservice-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/ktexteditor-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/ktextwidgets-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kunitconversion-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kwallet-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kwayland-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kwidgetsaddons-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kwindowsystem-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kxmlgui-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/kxmlrpcclient-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/networkmanager-qt-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/plasma-5.68.0-r1:5/5.68
[I--] [??] kde-frameworks/prison-5.63.0:5/5.63
[IP-] [  ] kde-frameworks/purpose-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/qqc2-desktop-style-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/solid-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/sonnet-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/syntax-highlighting-5.68.0:5/5.68
[IP-] [  ] kde-frameworks/threadweaver-5.68.0:5/5.68




Comment 4


Jimmy Kloss





          2020-04-04 15:52:34 UTC
        

Created attachment 629992 [details]
CMakeOutput.log

I removed the old unnedded packages (kde-frameworks/*, dev-qt/*), but that didn't change anything. Also added the CMakeOutput.log.




Comment 5


Andreas Sturmlechner






          2020-04-05 08:44:27 UTC
        

(In reply to Jimmy Kloss from comment #0)
> makes it work. But I have no clue if this is an issue with the ebuild, the
> eclasses or my system. 
> 
> % ls -lh / /usr|grep '\->'
> lrwxrwxrwx   1 root root    7 14. Sep 2019  bin -> usr/bin
> lrwxrwxrwx   1 root root    7 14. Sep 2019  lib -> usr/lib
> lrwxrwxrwx   1 root root    9 14. Sep 2019  lib64 -> usr/lib64
> lrwxrwxrwx   1 root root    8 14. Sep 2019  sbin -> usr/sbin
> lrwxrwxrwx   1 root root   10  7. Jan 15:22 share -> /usr/share
> lrwxrwxrwx 1 root root   20  6. Dez 17:57 portage -> /var/db/repos/gentoo
> lrwxrwxrwx 1 root root    8  3. Mär 2017  tmp -> /var/tmp
Well, clearly you are running an unusual layout. But you have still USE="split-usr" set according to emerge --info? I'm confused by that.




Comment 6


Jimmy Kloss





          2020-04-05 11:13:18 UTC
        

I find this confusing too. In my make.conf I set USE="-split-usr" and also masked split-usr in /etc/portage/profile/use.mask. So all packages are build without it.

In BOOTSTRAP_USE however split-usr remains. The portage manpage says it's used when going from stage1 to stage2, so I guess irrelevant for an installed system?

Now that I see '/share -> /usr/share'. I remember some KDE App that falsely looked for 'share' on '/', so I made a symlink. The only thing I want is a non split usr. Gentoo makes this pretty hard it seems. :/




Comment 7


Andreas Sturmlechner






          2020-04-05 11:22:12 UTC
        

You need "-split-usr" in /etc/portage/profile/use.mask
and "-split-usr" in /etc/portage/profiles/base/use.force.




Comment 8


Andreas Sturmlechner






          2020-04-05 11:27:46 UTC
        

(In reply to Andreas Sturmlechner from comment #7)
> and "-split-usr" in /etc/portage/profiles/base/use.force.

Sorry, "-split-usr" in /etc/portage/profile/use.force




Comment 9


Jimmy Kloss





          2020-04-05 12:02:54 UTC
        

with "-split-usr" in /etc/portage/profile/use.mask

% emerge -NuDpvq @world
[ebuild   R   ] sys-libs/ncurses-6.2-r1  USE="cxx (split-usr*) threads (tinfo) unicode -ada -debug -doc -gpm -minimal -profile -static-libs -test -trace" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] app-arch/bzip2-1.0.8  USE="(split-usr*) -static -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-apps/baselayout-2.7  USE="(split-usr*) -build" 
[ebuild   R   ] dev-libs/lzo-2.10  USE="(split-usr*) -examples -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] dev-libs/libaio-0.3.110  USE="(split-usr*) -static-libs -test" ABI_X86="(64) -32 (-x32)" 
[ebuild   R   ] sys-apps/tcp-wrappers-7.6.28  USE="ipv6 (split-usr*) -netgroups -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] net-libs/libmnl-1.0.4  USE="(split-usr*) -examples -static-libs" 
[ebuild   R   ] sys-apps/keyutils-1.6.1  USE="(split-usr*) -static -static-libs -test" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] app-arch/xz-utils-5.2.5  USE="extra-filters nls (split-usr*) threads -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-apps/attr-2.4.48-r3  USE="nls (split-usr*) -debug -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-apps/acl-2.2.53  USE="nls (split-usr*) -static-libs" ABI_X86="(64) -32 (-x32)" 
[ebuild   R   ] sys-libs/readline-8.0_p4  USE="(split-usr*) unicode -static-libs -utils" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-libs/e2fsprogs-libs-1.45.6  USE="(split-usr*) -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] net-firewall/iptables-1.6.1-r3  USE="ipv6 netlink (split-usr*) -conntrack -nftables -pcap -static-libs" 
[ebuild   R   ] app-editors/nano-4.9.1  USE="magic ncurses nls spell (split-usr*) unicode -debug -justify -minimal -slang -static" 
[ebuild   R   ] dev-libs/libusb-1.0.21-r1  USE="(split-usr*) udev -debug -doc -examples (-static-libs) -test" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-libs/zlib-1.2.11-r2  USE="minizip (split-usr*) -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] dev-libs/expat-2.2.8  USE="(split-usr*) unicode -examples -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-process/audit-2.8.5  USE="gssapi (split-usr*) -ldap -python -static-libs" ABI_X86="32 (64) (-x32)" PYTHON_TARGETS="python3_7 -python3_6" 
[ebuild   R   ] net-libs/libtirpc-1.2.5  USE="ipv6 kerberos (split-usr*) -static-libs" ABI_X86="(64) -32 (-x32)" 
[ebuild   R   ] dev-libs/libpcre-8.44  USE="bzip2 cxx jit pcre16 readline recursion-limit (split-usr*) (unicode) zlib -libedit -pcre32 -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] dev-libs/libpcre2-10.33-r1  USE="bzip2 jit pcre16 readline recursion-limit (split-usr*) unicode zlib -libedit -pcre32 -static-libs" ABI_X86="(64) -32 (-x32)" 
[ebuild   R   ] sys-libs/cracklib-2.9.7  USE="nls (split-usr*) zlib -python -static-libs" ABI_X86="32 (64) (-x32)" PYTHON_TARGETS="python3_7 -python2_7 -python3_6 -python3_8" 
[ebuild     U ] gui-apps/waybar-0.9.1 [0.8.0] USE="mpd network pulseaudio tray udev" 
[ebuild   R   ] sys-libs/libcap-2.33  USE="pam (split-usr*) -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-libs/pam-1.3.1_p20200128-r1  USE="audit berkdb cracklib filecaps pie (split-usr*) -debug -nis (-selinux) -static-libs" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-apps/coreutils-8.32-r1  USE="acl caps gmp nls (split-usr*) xattr -hostname -kill -multicall (-selinux) -static -test -vanilla" 
[ebuild   R   ] sys-apps/shadow-4.8.1-r2  USE="acl audit cracklib nls pam (split-usr*) su xattr -bcrypt (-selinux) -skey" 
[ebuild   R   ] dev-libs/libpwquality-1.4.2  USE="pam (split-usr*) -python -static-libs" PYTHON_TARGETS="python3_7 -python3_6 (-python3_8)" 
[ebuild   R   ] net-mail/mailutils-3.8  USE="berkdb clients gdbm ipv6 kerberos nls pam sasl (split-usr*) ssl tcpd threads -bidi -emacs -guile -kyotocabinet -ldap -mysql -postgres -python -servers -static-libs -tokyocabinet" PYTHON_SINGLE_TARGET="python3_7 -python2_7 -python3_6" 
[ebuild   R   ] sys-apps/util-linux-2.35.1-r1  USE="audit caps cramfs cryptsetup logger ncurses nls pam readline (split-usr*) systemd udev unicode -build -fdformat -hardlink -kill -python (-selinux) -slang -static-libs -su -suid -test -tty-helpers" ABI_X86="32 (64) (-x32)" PYTHON_TARGETS="python3_7 -python3_6 -python3_8" 
[ebuild   R   ] sys-process/procps-3.3.16-r2  USE="kill modern-top nls (split-usr*) systemd unicode (-elogind) -ncurses (-selinux) -static-libs -test" ABI_X86="(64) -32 (-x32)" 
[ebuild   R   ] sys-apps/systemd-245-r2  USE="acl audit cryptsetup dns-over-tls gcrypt idn kmod lz4 lzma pam pcre (policykit) resolvconf seccomp (split-usr*) sysv-utils xkb -apparmor -build -cgroup-hybrid -curl -elfutils -gnuefi -homed -http -importd -nat -pkcs11 -pwquality -qrcode -repart (-selinux) -static-libs -test -vanilla" ABI_X86="32 (64) (-x32)" 
[ebuild   R   ] sys-fs/e2fsprogs-1.45.6  USE="nls (split-usr*) -cron -fuse -static-libs"


with "split-usr" in /etc/portage/profile/use.mask everything stays "-split-usr". So in that file the meaning is reversed as in don't use what is in there.

/etc/portage/profiles/base/use.force was missing on my system, but whether I "-split-usr" OR "split-usr" makes no difference to 'emerge -NuDapvq @world' or BOOTSTRAP_USE. I also tried 'profile' instead of 'profiles' ('s' at the end), but no difference.




Comment 10


Jimmy Kloss





          2020-04-05 12:10:46 UTC
        

% cat /etc/portage/profile/use.force
-split-usr

No difference either. Or do I have to forcefully rebuild world?




Comment 11


Jimmy Kloss





          2020-04-15 12:16:11 UTC
        

It seems the following symlink made portage fall over:

lrwxrwxrwx   1 root root   10  7. Jan 15:22 share -> /usr/share

After removing it, kscreen emerged fine. Also plasma-desktop which behaved similar.

I can't remember which kde app required this symlink to /usr/share at runtime, though.
If I find it again, I file another bug report. 

I think portage shouldn't rely on guess magic, which can be fooled by a symlink, to identify a prefix.




Comment 12


Andreas Sturmlechner






          2020-04-15 12:17:52 UTC
        

Portage doesn't rely on guess magic, it is the build system that will pick up stuff like that. Same as it is possible to pollute the library lookup through cruft in /usr/local/.




Comment 13


Andreas Sturmlechner






          2020-04-15 12:19:17 UTC
        

(In reply to Jimmy Kloss from comment #11)
> I can't remember which kde app required this symlink to /usr/share at
> runtime, though.
> If I find it again, I file another bug report.

Please do, that would be interesting though I have all of kde-apps/* installed without such an issue.




Comment 14


Andreas Sturmlechner






          2020-08-13 19:12:04 UTC
        

(In reply to Jimmy Kloss from comment #11)
> It seems the following symlink made portage fall over:
> 
> lrwxrwxrwx   1 root root   10  7. Jan 15:22 share -> /usr/share
> ...
> I can't remember which kde app required this symlink to /usr/share at
> runtime, though.

I got a usrmerge/split-usr chroot myself now to test and could not identify any KDE package that would have needed that symlink.

I did not have time yet to reproduce the supposed brokenness caused by that share symlink.




Comment 15


Andreas Sturmlechner






          2020-08-18 09:16:32 UTC
        

I was also not able to reproduce the kscreen build failure with /share -> /usr/share symlink in place.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

