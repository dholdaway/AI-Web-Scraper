Title: 177314 – Building kdelibs-3.5.6-r8 with avahi use flag set breaks kwallet
URL: https://bugs.gentoo.org/show_bug.cgi?id=177314

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 177314
Building kdelibs-3.5.6-r8 with avahi use flag set breaks kwallet
Last modified: 2007-06-16 23:19:41 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 177314 
      - Building kdelibs-3.5.6-r8 with avahi use flag set breaks kwallet


Summary:
Building kdelibs-3.5.6-r8 with avahi use flag set breaks kwallet
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-05-06 12:54 UTC by brian





      Modified:
    
2007-06-16 23:19 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



kantras
mg









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


brian





          2007-05-06 12:54:58 UTC
        

The wallet manager sees no wallet files and cannot create a new one.
Uninstalling kdnssd-avahi allows some access but each app has to reopen the wallet for every request.

Reproducible: Always




Comment 1


Wulf Krueger (RETIRED)






          2007-05-07 21:44:26 UTC
        

I can't reproduce this problem. Emerged kdelibs-3.5.6-r8 with "avahi" USE flag 
set. Started kwalletmanager for the first time. No wallets, of course. Created 
a new one successfully. Closed kwalletmanager. Restarted it, the new wallet was 
there, could be opened and used.

Please post both your emerge --info and the output of "emerge -pv 
=kdelibs-3.5.6-r8 kwalletmanager".




Comment 2


brian





          2007-05-07 22:52:44 UTC
        

sudo emerge --info
Portage 2.1.2.6 (default-linux/x86/2006.1/desktop, gcc-4.1.1, glibc-2.5-r2, 2.6.19-suspend2-r1 i686)
=================================================================
System uname: 2.6.19-suspend2-r1 i686 Intel(R) Pentium(R) 4 CPU 2.66GHz
Gentoo Base System release 1.12.9
Timestamp of tree: Sat, 05 May 2007 17:59:01 +0000
dev-java/java-config: 1.3.7, 2.0.31-r5
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17.50.0.15
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.19.2-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=pentium4 -pipe -fomit-frame-pointer "
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/splash /etc/terminfo"
CXXFLAGS="-O2 -march=pentium4 -pipe -fomit-frame-pointer "
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://ftp.snt.utwente.nl/pub/os/linux/gentoo http://mirror.isp.net.au/ftp/pub/gentoo/ ftp://pandemonium.tiscali.de/pub/gentoo/ http://gentoo.inode.at/ ftp://ftp.gentoo.mesh-solutions.com/gentoo/"
LDFLAGS="-Wl,--hash-style=both"
LINGUAS="en_GB he"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/overlays/berkano-overlay /usr/local/overlays /usr/portage/local/layman/xeffects"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acpi aim alsa amuled ares arts artswrappersuid asf async berkdb bidi bitmap-fonts bootsplash bzip2 cairo cardbus cddb cdio cdparanoia cdr cdrom chroot cli corba cpudetection cracklib crypt css cups curlwrappers dbus debug_gdb dga dhcp dio dpms dri dvd dvdr dvdread dvi ecc eds emboss encode enscript esd ext-iiimf ext-png ext-zlib fam faxonly fftw firefox fortran ftp gdbm gif gimp glitz gnutls gpgme gphoto2 gpm gtk gtk2 hal hashstyle hpn http httpd iconv ieee1394 ipv6 irc jabber java javascript john jpeg jpeg2k kde kdepim kipi kqemu lcd ldap libg++ live lzo mad math matroska midi mikmod mmx mmxext mozsvg mp3 mp4live mpeg mpeg4 mplayer msn ncurses network neural nls no-old-linux nptl nptlonly nsplugin ogg opengl openssl oscar oss pam pcmcia pcre pdf perl png ppds pppd python qt3 quicktime rar readline real reflection rtc samba screen sdl session smime sms spell spl sse sse2 ssl stream subtitles subversion tcpd theora threads tiff transcode truetype truetype-fonts type1-fonts unicode vcd vorbis wifi win32codecs wmf x86 xanim xcomposite xml xorg xosd xv xvid zeroconf zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en_GB he" LIRC_DEVICES="sir" USERLAND="GNU" VIDEO_CARDS="radeon vesa"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

sudo emerge -pv =kdelibs-3.5.6-r8 kwalletmanager

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] kde-base/kdelibs-3.5.6-r8  USE="alsa arts avahi branding cups debug doc fam jpeg2k kdeenablefinal kdehiddenvisibility legacyssl lua openexr spell tiff utempter xinerama -acl -kerberos" LINGUAS="he" 0 kB
[ebuild   R   ] kde-base/kwalletmanager-3.5.6  USE="arts -debug -kdeenablefinal -kdehiddenvisibility -xinerama" 2,923 kB

Total: 2 packages (2 reinstalls), Size of downloads: 2,923 kB

I have remerged the binary package I built with avahi to the same effect. The kdeenablefinal & kdehiddenvisibility were set by default. I normally have these unset. I also left legacyssl,lua and openexr as they were in the ebuild.

BTW I have also found this post in the forum:
http://forums.gentoo.org/viewtopic-t-553898-highlight-avahi.html?sid=97c2c02f0f015a1c416e2fcd3cc3e43d


From the date of the post, it looks like the issue may not be -r8

Regards




Comment 3


Carsten Lohrke (RETIRED)






          2007-05-08 20:13:29 UTC
        

I don't even see what it should have to do with it. Do you imply noting -r8, that -r7 was fine?




Comment 4


Marcin Gryszkalis





          2007-05-13 11:12:28 UTC
        

I think it's something else that broke kwalletmanager - I can see the exactly same problem, but I have kde-base/kdelibs-3.5.6-r5 and -avahi

I recently upgraded udev to 111, shared-mime-info, gnutls, libmcrypt, glibc, libtasn1, coreutils and few other packages...




Comment 5


Marcin Gryszkalis





          2007-05-13 12:06:47 UTC
        

More info: I noticed my kded is not running, when trygin to start by hand I get
FATAL: DCOP communication problem!

and in .xsession-errorlog

DCOP: register 'kded' -> number of clients is now 42
DCOP: unregister 'kded-2'
DCOP: register 'kded' -> number of clients is now 42
DCOP: unregister 'kded-2'
KDE Daemon (kded) already running.
DCOP aborting call from 'anonymous-23453' to 'kded'
DCOP aborting call from 'anonymous-23455' to 'kded'
DCOP aborting call from 'anonymous-23454' to 'kded'
DCOP aborting call from 'anonymous-23448' to 'kded'
DCOP aborting call from 'anonymous-23451' to 'kded'
DCOP aborting call from 'anonymous-23450' to 'kded'
DCOP aborting call from 'anonymous-23452' to 'kded'
DCOP aborting call from 'anonymous-23491' to 'kded'
DCOP aborting call from 'anonymous-23492' to 'kded'
DCOP: unregister 'kded'
kded: ERROR: Communication problem with kded, it probably crashed.

and warning above

kded: WARNING: [KDEDModule* Kded::loadModule(const KService*, bool)] Could not load library. [ libaprutil-0.so.0: cannot open shared object file: No such file or directory ]
kdecore (KLibLoader): library=libkded_kdesvnd: No file named libkded_kdesvnd.la found in paths.
kded: WARNING: [KDEDModule* Kded::loadModule(const KService*, bool)] Could not load library. [ Library files for "libkded_kdesvnd.la" not found in paths. ]
kded: Could not load module 'kdesvnd'

That's right as I removed apr-0 and apr-utils-0 but didn't rebuild kdesvn (proceeding now)...





Comment 6


Marcin Gryszkalis





          2007-05-13 12:36:54 UTC
        

I can confirm that rebuilding kdesvn fixed the problem, so it may be the same with reporter, please check ~/.xession-errors for kded/dcop problems 




Comment 7


Carsten Lohrke (RETIRED)






          2007-05-15 10:11:43 UTC
        

Not a bug, if that was it. Feel free to reopen, if your problem is different, brian. Thanks for the pointer Marcin.




Comment 8


brian





          2007-05-20 18:55:27 UTC
        

I've since upgraded to -r9 with no problem until today after I rebuilt the kernel (2-6.21-r4 with the Powertop patch). kde crashed twice after reboots and the only relevant thing I could see in .xsession-errors was the line :
"kded: client.c:770: avahi_client_get_state: Assertion `client' failed"
I re-emerged kdnssd & rebooted ok.
Sorry not a lot of useful info.




Comment 9


David Sutton





          2007-05-22 22:11:11 UTC
        

Note: make sure you have avahi-daemon running when you start kde - if not then it can cause things like kwallet to stop work correctly




Comment 10


Wulf Krueger (RETIRED)






          2007-06-16 23:19:41 UTC
        

It still works just fine for me. If you get more information, feel free to re-open again.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

