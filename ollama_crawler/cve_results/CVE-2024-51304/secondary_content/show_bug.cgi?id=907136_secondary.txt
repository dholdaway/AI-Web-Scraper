Title: 907136 – =dev-lang/rust-bin-1.69.0 misscompiles =gnome-base/librsvg-2.56.0 on arm64 with signal: 11, SIGSEGV: invalid memory reference
URL: https://bugs.gentoo.org/show_bug.cgi?id=907136

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 907136
=dev-lang/rust-bin-1.69.0 misscompiles =gnome-base/librsvg-2.56.0 on arm64 with signal: 11, SIGSEGV: invalid memory reference
Last modified: 2023-09-28 06:35:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 907136 
      - =dev-lang/rust-bin-1.69.0 misscompiles =gnome-base/librsvg-2.56.0 on arm64 with signal: 11, SIGSEGV: invalid memory reference


Summary:
=dev-lang/rust-bin-1.69.0 misscompiles =gnome-base/librsvg-2.56.0 on arm64 wi...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Rust Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2023-05-25 07:13 UTC by tt_1





      Modified:
    
2023-09-28 06:35 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



arm64









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




compressed build log

              (build.log.gz,7.24 KB,
                application/gzip)

            
2023-05-25 07:13 UTC,

            tt_1




Details





emerge --info

              (emerge-info,5.81 KB,
                text/plain)

            
2023-05-25 07:13 UTC,

            tt_1




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


tt_1





          2023-05-25 07:13:06 UTC
        

Created attachment 862533 [details]
compressed build log

when I tried to update to librsvg-2.56.0 with current dev-lang/rust-bin-1.69.0, it misscompiles: 

error: could not compile `quote`
  process didn't exit successfully: `rustc --crate-name quote --edition=2018 /var/tmp/portage/gnome-base/librsvg-2.56.0/work/cargo_home/gentoo/quote-1.0.26/src/lib.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no -C debug-assertions=off --cfg 'feature="default"' --cfg 'feature="proc-macro"' -C metadata=664bf0b656ba133c -C extra-filename=-664bf0b656ba133c --out-dir /var/tmp/portage/gnome-base/librsvg-2.56.0/work/librsvg-2.56.0-.arm64/target/release/deps -L dependency=/var/tmp/portage/gnome-base/librsvg-2.56.0/work/librsvg-2.56.0-.arm64/target/release/deps --extern proc_macro2=/var/tmp/portage/gnome-base/librsvg-2.56.0/work/librsvg-2.56.0-.arm64/target/release/deps/libproc_macro2-9f67e97034115be2.rmeta --cap-lints allow` (signal: 11, SIGSEGV: invalid memory reference)

downgrading to dev-lang/rust-bin-1.68.2-r1 solves the issue

any idea whats going on there? 

the compressed build.log is attached




Comment 1


tt_1





          2023-05-25 07:13:27 UTC
        

Created attachment 862534 [details]
emerge --info




Comment 2


Sam James









          2023-05-25 07:23:24 UTC
        

This looks like the compiler is crashing when building something rather than it building a binary which is broken (miscompilation).

Anyway, in bug https://bugs.gentoo.org/877267#c1, I ended up fighting and eventually managed to get a backtrace out of it. I had to enable coredumps first (I did it via hacks using systemd-coredumpd outside the chroot, but you may want to try https://stackoverflow.com/a/29668405 too).




Comment 3


tt_1





          2023-07-10 06:49:21 UTC
        

I switched to dev-lang/rust-1.69.0-r1 and had no problems whatsoever, is there anything I can do to inspect the binaries and libs and compare them to the prebuild rust-bin from upstream?




Comment 4


tt_1





          2023-09-28 06:35:16 UTC
        

This issue is solved with current stable =rust-bin-1.71.1









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

