Title: 358047 – Module snd_intel8x0 in sys-kernel/tuxonice-sources-2.6.37 fails to detect plugged in headphones after hibernation.
URL: https://bugs.gentoo.org/show_bug.cgi?id=358047

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 358047
Module snd_intel8x0 in sys-kernel/tuxonice-sources-2.6.37 fails to detect plugged in headphones after hibernation.
Last modified: 2011-03-17 14:57:28 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 358047 
      - Module snd_intel8x0 in sys-kernel/tuxonice-sources-2.6.37 fails to detect plugged in headphones after hibernation.


Summary:
Module snd_intel8x0 in sys-kernel/tuxonice-sources-2.6.37 fails to detect plu...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Kernel Bug Wranglers and Kernel Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-03-09 12:32 UTC by Simon D.





      Modified:
    
2011-03-17 14:57 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



mobile+disabled









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Simon D.





          2011-03-09 12:32:33 UTC
        

Hi folks,
I upgraded my ThinkPad X41 to sys-kernel/tuxonice-sources-2.6.37 and used "$make oldconfig" to configure the kernel (old .config-file from tuxonice-sources-2.6.36).

Everything works fine right after reboot, but after waking up from the first "$hibernate-ram" command, the sound card fails to recognize whether any headphones are plugged in - no matter if they are or not, sound always only comes from the laptop's speakers. the headphone jack remains dead.

rebooting the system solves the problem until the next "$hibernate-ram".

I tried reloading the driver via "$modprope -r snd_intel8x0; modprobe snd_intel8x0", to no effect.

Running on 2.6.36 again now, and everything works as expected.

Will upgrade to sys-kernel/gentoo-sources-2.6.37-r1 and report if the problem persists.


Reproducible: Always

Steps to Reproduce:
1. Upgrade to  sys-kernel/gentoo-sources-2.6.37
2. Reboot
3. Play Sounds, repeatedly plug and unplug headphones. If headphones are plugged in, the laptop speakers are muted and the headphone jack plays the signal. If headphones are unplugged, the laptop speakers play the signal
4. Hibernate and wake up again.
5. It is now irrelevant whether headphones are plugged in or not, the headphone jack will always be dead, and the signal will always come from the laptop speakers
6. Reboot
7. GOTO Step 3.
Actual Results:  
After hibernation, the headphone jack cannot detect whether headphones are plugged in, sound always comes from the built-in speakers

Expected Results:  
No headphones plugged in --> Sound from speakers
Headphones plugged in --> Speakers muted, sound from Headphones

$ lsmod

Module                  Size  Used by
lib80211_crypt_tkip     6454  2 
snd_pcm_oss            27976  0 
snd_mixer_oss          10427  1 snd_pcm_oss
snd_seq_dummy           1154  0 
snd_seq_oss            20565  0 
snd_seq_midi_event      4730  1 snd_seq_oss
snd_seq                36776  5 snd_seq_dummy,snd_seq_oss,snd_seq_midi_event
snd_seq_device          4559  3 snd_seq_dummy,snd_seq_oss,snd_seq
snd_intel8x0           21887  4 
snd_ac97_codec         84858  1 snd_intel8x0
ac97_bus                 850  1 snd_ac97_codec
snd_pcm                54798  4 snd_pcm_oss,snd_intel8x0,snd_ac97_codec
snd_timer              14029  2 snd_seq,snd_pcm
ipw2200               113567  0 
snd                    40196  16 snd_pcm_oss,snd_mixer_oss,snd_seq_oss,snd_seq,snd_seq_device,snd_intel8x0,snd_ac97_codec,snd_pcm,snd_timer
libipw                 20068  1 ipw2200
soundcore               4611  1 snd
snd_page_alloc          5853  2 snd_intel8x0,snd_pcm
evdev                   5894  15 


$aplay -l

**** List of PLAYBACK Hardware Devices ****
card 0: ICH6 [Intel ICH6], device 0: Intel ICH [Intel ICH6]
  Subdevices: 0/1
  Subdevice #0: subdevice #0
card 0: ICH6 [Intel ICH6], device 4: Intel ICH - IEC958 [Intel ICH6 - IEC958]
  Subdevices: 1/1
  Subdevice #0: subdevice #0


pulseaudio 0.9.21.1
alsa-lib 1.0.23
alsa-plugins 1.0.23-r1
alsa-firmware 1.0.23
alsa-tools 1.0.23
alsa-utils 1.0.23-r1




Comment 1


Simon D.





          2011-03-12 16:18:05 UTC
        

I have updated to sys-kernel/gentoo-sources-2.6.37-r1 (as opposed to sys-kernel/tuxonice-sources-2.6.37) and I face the same problem - the problem seems to be independent of the tuxonice-patches, "$hibernate-ram" still breaks the headphone jack "sense" of the laptop.

Is there a not overly complicated way to use the snd_intel8x0 module from 2.6.36 in 2.6.37?

If you need more information I will happily provide them.

Best wishes,
Simon Diesch




Comment 2


Krzysztof Pawlik (RETIRED)






          2011-03-15 19:11:17 UTC
        

Affects vanilla sources, can you please try the latest 2.6.38?




Comment 3


Simon D.





          2011-03-17 14:57:28 UTC
        

I got 2.6.38 from kernel.org (released 2011-03-15) and the problem is gone. 

Configured again via the oldconfig command, I used the dysfunctional 2.6.37's .config file as source.

And that's it from my point of view - 2.6.36 is stable and functional and the problem seems to disappear again in the future - I will just skip '37.

Thanks.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

