Title: 921106 – sci-physics/geant-4.11.1.2-r1::gentoo fails with dev-lang/python:3.12 installed but not defaulted to
URL: https://bugs.gentoo.org/show_bug.cgi?id=921106

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 921106
sci-physics/geant-4.11.1.2-r1::gentoo fails with dev-lang/python:3.12 installed but not defaulted to
Last modified: 2024-03-10 18:52:04 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 921106 
      - sci-physics/geant-4.11.1.2-r1::gentoo fails with dev-lang/python:3.12 installed but not defaulted to


Summary:
sci-physics/geant-4.11.1.2-r1::gentoo fails with dev-lang/python:3.12 install...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Guilherme Amadio








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2023-12-30 22:13 UTC by CaptainBlood





      Modified:
    
2024-03-10 18:52 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



amadio
luc_pierard_de_maujouy









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




failing build log

              (sci-physics:geant-4.11.1.2-r1:20231230-230445.log.gz,3.01 KB,
                application/gzip)

            
2023-12-30 22:13 UTC,

            CaptainBlood




Details





working build log

              (sci-physics:geant-4.11.1.2-r1:20231217-023508.log.gz,786.36 KB,
                application/gzip)

            
2023-12-30 22:17 UTC,

            CaptainBlood




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


CaptainBlood





          2023-12-30 22:13:21 UTC
        

Created attachment 881056 [details]
failing build log

But it builds fine if dev-lang/python:3.12 is removed




Comment 1


CaptainBlood





          2023-12-30 22:17:55 UTC
        

Created attachment 881060 [details]
working build log

emerge --info sci-physics/geant
Portage 3.0.59 (python 3.11.7-final-0, default/linux/amd64/17.1, gcc-13, glibc-2.37-r7, 6.6.8-gentoo-std x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-6.6.8-gentoo-std-x86_64-Intel-R-_Core-TM-_i3-6100_CPU_@_3.70GHz-with-glibc2.37
KiB Mem:     3933676 total,    163492 free
KiB Swap:   65535996 total,  65534448 free
Timestamp of repository gentoo: Sat, 30 Dec 2023 19:15:01 +0000
Head commit of repository gentoo: 5c3be592705e073fda1dacac793dadf230db46dd
sh bash 5.1_p16-r6
ld GNU ld (Gentoo 2.41 p2) 2.41.0
distcc 3.4 x86_64-pc-linux-gnu [disabled]
app-misc/pax-utils:        1.3.5::gentoo
app-shells/bash:           5.1_p16-r6::gentoo
dev-java/java-config:      2.3.3-r1::gentoo
dev-lang/perl:             5.38.2-r1::gentoo
dev-lang/python:           2.7.18_p16-r1::gentoo, 3.10.13::gentoo, 3.11.7::gentoo, 3.12.1::gentoo
dev-lang/rust:             1.74.1::gentoo
dev-util/cmake:            3.27.7::gentoo
dev-util/meson:            1.2.3::gentoo
sys-apps/baselayout:       2.14-r1::gentoo
sys-apps/openrc:           0.48::gentoo
sys-apps/sandbox:          2.38::gentoo
sys-devel/autoconf:        2.13-r7::gentoo, 2.71-r6::gentoo
sys-devel/automake:        1.16.5-r1::gentoo
sys-devel/binutils:        2.41-r2::gentoo
sys-devel/binutils-config: 5.5::gentoo
sys-devel/clang:           15.0.7-r3::gentoo, 16.0.6::gentoo, 17.0.6::gentoo
sys-devel/gcc:             10.5.0::gentoo, 11.4.1_p20230824::gentoo, 12.3.1_p20230825::gentoo, 13.2.1_p20231216::gentoo
sys-devel/gcc-config:      2.11::gentoo
sys-devel/libtool:         2.4.7-r1::gentoo
sys-devel/lld:             15.0.7::gentoo, 17.0.6::gentoo
sys-devel/llvm:            15.0.7-r3::gentoo, 16.0.6::gentoo, 17.0.6::gentoo
sys-devel/make:            4.4.1-r1::gentoo
sys-kernel/linux-headers:  6.6::gentoo (virtual/os-headers)
sys-libs/glibc:            2.37-r7::gentoo
Repositories:

gentoo
    location: /var/db/repos/gentoo
    sync-type: rsync
    sync-uri: rsync://rsync.europe.gentoo.org/gentoo-portage
    priority: -1000
    volatile: False
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-jobs: 1
    sync-rsync-verify-metamanifest: yes
    sync-rsync-extra-opts: 

local
    location: /var/db/repos/local
    masters: gentoo
    priority: 10000
    volatile: False

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
AR="gcc-ar"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -mtune=native -O2 -pipe -Wa,-mbranches-within-32B-boundaries "
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/maven-bin-3.9/conf"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php8.1/ext-active/ /etc/php/cgi-php8.1/ext-active/ /etc/php/cli-php8.1/ext-active/ /etc/php/fpm-php8.1/ext-active/ /etc/php/phpdbg-php8.1/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=core2 -mtune=native -O2 -pipe -Wa,-mbranches-within-32B-boundaries "
DISTDIR="/var/cache/distfiles"
EMERGE_DEFAULT_OPTS="--alert y 			--alphabetical 			--ask-enter-invalid 			--autounmask y  			--autounmask-only n  			--autounmask-unrestricted-atoms y  	--autounmask-write y              --complete-graph y  			--misspell-suggestions n 			--noconfmem 			--nospinner  			--tree 			--with-bdeps y"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GDK_PIXBUF_MODULE_FILE GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR XDG_STATE_HOME"
FCFLAGS="-march=core2 -mtune=native -O2 -pipe -Wa,-mbranches-within-32B-boundaries "
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs binpkg-multi-instance buildpkg-live compress-build-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox pkgdir-index-trusted preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms split-elog strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-march=core2 -mtune=native -O2 -pipe -Wa,-mbranches-within-32B-boundaries "
GENTOO_MIRRORS="http://ftp-stud.hs-esslingen.de/pub/Mirrors/gentoo/     http://ftp.halifax.rwth-aachen.de/gentoo/     http://ftp.free.fr/mirrors/ftp.gentoo.org/     http://mirrors.soeasyto.com/distfiles.gentoo.org/     http://gentoo.mirrors.ovh.net/gentoo-distfiles/     http://mirror.eu.oneandone.net/linux/distributions/gentoo/gentoo/     http://mirror.leaseweb.com/gentoo/     http://www.mirrorservice.org/sites/distfiles.gentoo.org/     http://ftp.belnet.be/pub/rsync.gentoo.org/gentoo/     http://mirror.bytemark.co.uk/gentoo/"
LANG="fr_FR.utf8"
LDFLAGS="-Wl,-O1 -Wl,-fuse-ld=bfd "
LEX="flex"
LINGUAS="fr"
MAKEOPTS="-j3 -l3"
NM="gcc-nm"
PKGDIR="/var/cache/binpkgs"
PORTAGE_COMPRESS="lzma"
PORTAGE_COMPRESS_FLAGS="-9"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
RANLIB="gcc-ranlib"
SHELL="/bin/bash"
USE="amd64 asm custom-cflags emacs eselect-ldso fortran gentoo-vm gtk-doc minimal ocamlopt split-usr test-rust verify-sig" ABI_X86="64" ALSA_CARDS="hda-intel" CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt rdrand sse sse2 sse3 sse4_1 sse4_2 ssse3" ELIBC="glibc" GRUB_PLATFORMS="efi-64" INPUT_DEVICES="libinput" KERNEL="linux" L10N="fr" LUA_SINGLE_TARGET="lua5-4" LUA_TARGETS="lua5-4" PHP_TARGETS="php8-1" PYTHON_SINGLE_TARGET="python3_11" PYTHON_TARGETS="python3_11" QEMU_USER_TARGETS="aarch64" RUBY_TARGETS="ruby31" VIDEO_CARDS="intel"
Unset:  ADDR2LINE, ARFLAGS, AS, ASFLAGS, CC, CCLD, CONFIG_SHELL, CPP, CPPFLAGS, CTARGET, CXX, CXXFILT, ELFEDIT, EXTRA_ECONF, F77FLAGS, FC, GCOV, GPROF, INSTALL_MASK, LC_ALL, LD, LFLAGS, LIBTOOL, MAKE, MAKEFLAGS, OBJCOPY, OBJDUMP, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_RSYNC_EXTRA_OPTS, PYTHONPATH, READELF, RUSTFLAGS, SIZE, STRINGS, STRIP, YACC, YFLAGS

=================================================================
                        Package Settings
=================================================================

sci-physics/geant-4.11.1.2-r1::gentoo was built with the following:
USE="data -debug -doc examples freetype gdml geant3 hdf5 inventor motif opengl qt5 raytracerx -static-libs -tbb -threads trajectories vtk" ABI_X86="(64)"
CFLAGS="-march=core2 -mtune=native -O2 -flto -fuse-linker-plugin -fno-fat-lto-objects -pipe -Wa,-mbranches-within-32B-boundaries"
CXXFLAGS="-march=core2 -mtune=native -O2 -flto -fuse-linker-plugin -fno-fat-lto-objects -pipe -Wa,-mbranches-within-32B-boundaries"




Comment 2


Eli Schwartz






          2023-12-31 05:51:27 UTC
        

Relevant build log snippet:

-- Found HDF5: /usr/lib64/libhdf5.so;/usr/lib64/libz.so;/usr/lib64/libdl.a;/usr/lib64/libm.so (found suitable version "1.14.2", minimum required is "1.8")  
-- Found MPI_C: /usr/lib64/libmpi.so (found version "3.1") 
-- Found MPI: TRUE (found version "3.1") found components: C 
-- Found Python: /usr/bin/python3.12 (found version "3.12.1") found components: Interpreter 
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ModuleNotFoundError: No module named 'mpi4py'
CMake Error at /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:230 (message):
  Could NOT find mpi4py (missing: mpi4py_INCLUDE_DIR)
Call Stack (most recent call first):
  /usr/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:600 (_FPHSA_FAILURE_MESSAGE)
  /usr/lib64/cmake/vtk-9.2/Findmpi4py.cmake:28 (find_package_handle_standard_args)
  /usr/lib64/cmake/vtk-9.2/VTK-vtk-module-find-packages.cmake:256 (find_package)
  /usr/lib64/cmake/vtk-9.2/vtk-config.cmake:152 (include)
  cmake/Modules/G4InterfaceOptions.cmake:73 (find_package)
  cmake/Modules/G4CMakeMain.cmake:64 (include)
  CMakeLists.txt:49 (include)


Implication: this is missing dependencies.

```
ACCEPT_LICENSE=geant4 emerge --buildpkgonly =sci-physics/geant-4.11.1.2-r1::gentoo
```

-- Checking C++ feature CXXSTDLIB_FILESYSTEM_NATIVE - Success
CMake Error at cmake/Modules/G4OptionalComponents.cmake:42 (find_package):
  Could not find a package configuration file provided by "CLHEP" (requested
  version 2.4.6.0) with any of the following names:

    CLHEPConfig.cmake
    clhep-config.cmake

  Add the installation prefix of "CLHEP" to CMAKE_PREFIX_PATH or set
  "CLHEP_DIR" to a directory containing one of the above files.  If "CLHEP"
  provides a separate development package or SDK, be sure it has been
  installed.
Call Stack (most recent call first):
  cmake/Modules/G4CMakeMain.cmake:59 (include)
  CMakeLists.txt:49 (include)


-- Configuring incomplete, errors occurred!


Correction: it's missing more than just mpi?




Comment 3


Guilherme Amadio






          2024-02-17 08:35:12 UTC
        

Thanks for the bug report. MPI is only actually used in the examples and tests, so you can safely add -DCMAKE_DISABLE_FIND_PACKGE_MPI=1 or use -DPython_FIND_UNVERSIONED_NAMES=FIRST as workaround to pick up the correct version of Python. That can be done by exporting MYCMAKEARGS='...' emerge geant4.
My guess is that since the examples behave as separate projects, there is a mismatch in terms of what the main project and the subprojects are finding.
I will add one of the above to the ebuild when bumping it, as a new patch release just came out as well.




Comment 4


Guilherme Amadio






          2024-02-17 08:38:10 UTC
        

As for the other comment, indeed, sci-physics/clhep is a dependency and should have been pulled in automatically. If you have problems with that, it's a separate issue and should be investigated as well.




Comment 5


Guilherme Amadio






          2024-03-10 18:52:04 UTC
        

I have Python 3.11 as default and both 3.12 and 3.13 installed. I built both 4.11.1.3 and 4.11.2.0 and did not hit this issue with either of them, so I will close this as I can't reproduce.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

