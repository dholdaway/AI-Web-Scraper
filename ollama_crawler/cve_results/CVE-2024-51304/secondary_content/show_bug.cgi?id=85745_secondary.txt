Title: 85745 – Long delay while compiling Qt (running qmake) on amd64
URL: https://bugs.gentoo.org/show_bug.cgi?id=85745

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 85745
Long delay while compiling Qt (running qmake) on amd64
Last modified: 2006-10-06 05:08:55 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 85745 
      - Long delay while compiling Qt (running qmake) on amd64


Summary:
Long delay while compiling Qt (running qmake) on amd64
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Qt Bug Alias








URL:







Whiteboard:




Keywords:









Duplicates (3):
    

85747 85748 87383

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2005-03-18 03:45 UTC by marc baier





      Modified:
    
2006-10-06 05:08 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



amd64
gentoobugs
simon.strandman









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




strace

              (qt-emerge-strace.bz2,49.45 KB,
                application/x-bzip2)

            
2006-01-22 12:14 UTC,

            Simon Strandman




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


marc baier





          2005-03-18 03:45:04 UTC
        

hi,

i have the same problems as described in #85546/#81268

the problem for me is that i can't recompile qt.

the compile process stucks at this line:



Finding project files. Please wait...
  242 projects found.

Creating makefiles. Please wait...
  for /var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/src/moc/moc.pro (linux-g++)
/var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/bin/qmake  -spec /var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/mkspecs/linux-g++ -o /var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/./src/moc /var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/src/moc/moc.pro
  for /var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/src/qt.pro (linux-g++)
/var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/bin/qmake  -spec /var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/mkspecs/linux-g++ -o /var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/./src /var/tmp/portage/qt-3.3.4-r2/work/qt-x11-free-3.3.4/src/qt.pro


cpu is at 100% but it doesn't do anything. i am waiting for half an hour now but nothing happens. i tried different versions of qt, but that doesnt help either.

bash-2.05b# emerge info
Portage 2.0.51.19 (default-linux/amd64/2005.0, gcc-3.4.3, glibc-2.3.4.20041102-r1, 2.6.11-ck2 x86_64)
=================================================================
System uname: 2.6.11-ck2 x86_64 AMD Athlon(tm) 64 Processor 3200+
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb 26 2005, 16:57:28)]
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.3 [enabled]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r1
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.8.1-r4
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-march=athlon64 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/share/config /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=athlon64 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox"
GENTOO_MIRRORS="http://ftp.uni-erlangen.de/pub/mirrors/gentoo http://gentoo.osuosl.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="amd64 X acl acpi alsa avi berkdb bitmap-fonts cdr chroot crypt curl dga divx4linux dvd dvdread encode fam fbcon flac font-server fortran gif gpm gtk guile hal imlib ipv6 java jp2 jpeg lzw lzw-tiff mad matroska mmap mng mozsvg mp3 mpeg ncurses nls nptl nvidia oggvorbis opengl oss pam perl pic png python readline rtc sdl ssl svg tcpd tga theora tiff truetype truetype-fonts type1-fonts usb userlocales xml2 xpm xrandr xv xvid zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS




Comment 1


marc baier





          2005-03-18 03:56:54 UTC
        

aehm, for stupid reasons the bug has been added 3 times to the database.

#85747
#85748

sorry about that :)




Comment 2


Carsten Lohrke (RETIRED)






          2005-03-18 05:24:35 UTC
        

*** Bug 85748 has been marked as a duplicate of this bug. ***




Comment 3


Carsten Lohrke (RETIRED)






          2005-03-18 05:24:42 UTC
        

*** Bug 85747 has been marked as a duplicate of this bug. ***




Comment 4


Gregorio Guidi (RETIRED)






          2005-03-18 06:15:44 UTC
        

This is probably not related to Qt itself but specific to your system, so I don't know how much can we help you.

You should try with a different kernel, or trying to debug it manually using strace...




Comment 5


Simon Strandman





          2005-03-28 12:18:46 UTC
        

I have exactly the same problem. Qt used to compile and work fine with the same settings when I used 2004.3, but I did a reinstall from stage1 earlier today using 2005.0 and since then I haven't been able to emerge qt because of this.

I have tried with different versions of binutils, with CFLAGS, CXXFLAGS and LDFLAGS unset and with a gentoo-kernel instead of -ck but nothing helped. I have also tried emerging older versions of qt but they all have the same problem.

Portage 2.0.51.19 (default-linux/amd64/2005.0, gcc-3.4.3, glibc-2.3.4.20050125-r1, 2.6.11-ck3 x86_64)
=================================================================
System uname: 2.6.11-ck3 x86_64 AMD Athlon(tm) 64 Processor 3500+
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Mar 28 2005, 18:31:07)]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r7, 2.15.94.0.2.2
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.8.1-r4
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-Os -march=athlon64 -pipe -fomit-frame-pointer -fweb"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/lib/X11/xkb /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-Os -march=athlon64 -pipe -fomit-frame-pointer -fweb -fvisibility-inlines-hidden -fno-enforce-eh-specs"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox"
GENTOO_MIRRORS="http://snigel.no-ip.com/ http://mirror.pudas.net/gentoo ftp://ftp.rhnet.is/pub/gentoo/ ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror/ http://ftp.rhnet.is/pub/gentoo/"
LANG="sv_SE.UTF-8"
LC_ALL="sv_SE.UTF-8"
LDFLAGS="-Wl,-O1"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X aalib acpi alsa artswrappersuid berkdb caps cdr crypt dga dlloader dvd dvdr dvdread eds f77 fbcon fortran gcj gif gphoto2 gpm hal ipv6 jack jack-tmpfs java javascript jp2 jpeg kde kdeenablefinal lzw lzw-tiff mad mikmod mng mozilla mp3 mpeg ncurses nls nptl nptlonly nvidia objc offensive oggvorbis opengl pam perl pic png pnp python qt quicktime readline samba ssl svg tcpd tiff truetype truetype-fonts type1-fonts unicode usb userlocales vidix xine xml2 xmms xpm xrandr xv xvid zlib video_cards_nvidia linguas_sv"
Unset:  ASFLAGS, CBUILD, CTARGET, PORTDIR_OVERLAY




Comment 6


Caleb Tennis (RETIRED)






          2005-03-28 13:05:57 UTC
        

probably ought to get the amd64 team involved.




Comment 7


Simon Strandman





          2005-03-29 05:31:45 UTC
        

I found out that the build does continue if I just wait. I hangs for about 10-15 minutes and during that time qmake uses 100% CPU almost constantly, but then suddenly it continues. Something is definitly wrong here because it shouldn't take a 2200mhz CPU 10 minues under 100% load to create a makefile, but at least qt builds and works now.




Comment 8


Gregorio Guidi (RETIRED)






          2005-03-31 02:40:29 UTC
        

*** Bug 87383 has been marked as a duplicate of this bug. ***




Comment 9


P Nienaber





          2005-03-31 12:47:58 UTC
        

I'll second comment #7 -- it's not endless, it just takes a while.




Comment 10


Gregorio Guidi (RETIRED)






          2005-05-12 10:25:48 UTC
        

Is anyone still experiencing this bug?




Comment 11


Jean-Michel Smith





          2005-05-13 07:51:41 UTC
        

Yes, I'm experiencing it as well, with x11-libs/qt-3.3.4-r3, although the wait isn't 10-15 minutes (more like 5-10 minutes or so, but still, long enough that I was searching for this bug and in the forums before noticing that it continued).

Portage 2.0.51.19 (default-linux/amd64/2005.0, gcc-3.4.3, glibc-2.3.4.20041102-r1, 2.6.11-gentoo-r6 x86_64)
=================================================================
System uname: 2.6.11-gentoo-r6 x86_64 AMD Opteron(tm) Processor 246
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, May 12 2005, 10:26:14)]
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
dev-lang/python:     2.3.5
sys-apps/sandbox:    [Not Present]
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.9.5, 1.5, 1.8.5-r3, 1.7.9-r1, 1.6.3, 1.4_p6
sys-devel/binutils:  2.15.92.0.2-r8
sys-devel/libtool:   1.5.16
virtual/os-headers:  2.6.8.1-r4
ACCEPT_KEYWORDS="2005-spring amd64"
AUTOCLEAN="yes"
CFLAGS="-O2 -march=opteron -pipe -fweb -frename-registers -ftracer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=opteron -pipe -fweb -frename-registers -ftracer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache digest distlocks notitles sandbox strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X aalib acpi alsa apache2 arts avi berkdb bindist bitmap-fonts blender-game bonobo cdr cjk crypt cups curl dga directfb dv dvd dvdr eds encode esd exif fam flac font-server fortran freetds gdbm gif gphoto2 gpm graphviz gstreamer gtk gtkhtml guile imagemagick imap imlib innodb insecure-drivers ipv6 jabber jack java jp2 jpeg junit kde lcms libg++ lzw lzw-tiff mad mikmod mime mng mozilla mozirc mp3 mpeg mysql ncurses network nls nptl odbc ogg oggvorbis ooo-kde opengl oss pam pda pdflib perl png povray python qt quicktime radeon readline samba scanner sdl spell ssl tcltk tcpd theora tiff truetype truetype-fonts type1-fonts usb userlocales vorbis xine xinerama xml xml2 xmms xpm xrandr xv xvid zlib video_cards_radeon userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 12


P Nienaber





          2005-06-18 19:21:44 UTC
        

Still an issue in 3.3.4-r5.  I'm sitting around staring at this:

/var/tmp/portage/qt-3.3.4-r5/work/qt-x11-free-3.3.4/bin/qmake  -spec
/var/tmp/portage/qt-3.3.4-r5/work/qt-x11-free-3.3.4/mkspecs/linux-g++ -o
/var/tmp/portage/qt-3.3.4-r5/work/qt-x11-free-3.3.4/./src
/var/tmp/portage/qt-3.3.4-r5/work/qt-x11-free-3.3.4/src/qt.pro

Took maybe 3 minutes to do whatever it was doing on 2x2.0GHz K8 chips.  If this
is normal, perhaps a patch should at least be added saying "This may take a
while..." so people know it's normal, because it doesn't seem like it otherwise =)




Comment 13


Larry Lines





          2005-06-20 22:59:46 UTC
        

Good to know that it will eventually come out of this loop, but it took well
over ten minutes.  I found this bug so I went ahead and let it do its thing and
it does come out.  Same story as those above.  Just wanted to add my name to the
list of those having problems.




Comment 14


Simon Stelling (RETIRED)






          2005-07-28 02:39:04 UTC
        

experiencing this as well on my box. kde team: can't we just put a little "einfo
"The next step may take long; do not abort, even if it seems to hang""? It's
really trivial to fix but very annoying, and most users hitting this box have
really fast boxes. If you're okay with it, I'll include an einfo.

Portage 2.0.51.22-r2 (default-linux/amd64/2005.0, gcc-3.4.3, glibc-2.3.5-r0,
2.6.12-gentoo-r2 x86_64)
=================================================================
System uname: 2.6.12-gentoo-r2 x86_64 AMD Opteron(tm) Processor 242





Comment 15


Gregorio Guidi (RETIRED)






          2005-07-28 05:57:39 UTC
        

There's the technical difficulty that the info can only go before the "emake" 
call, that is, much before the point where it gets stuck. 
 
And we still have to figure out why this happens to someone but not to 
everyone... 
 




Comment 16


Diego Elio Pettenò (RETIRED)






          2005-10-11 02:32:42 UTC
        

I can't see this on latest 3.3.5 package, maybe that is fixed upstream, can 
someone confirm? 




Comment 17


P Nienaber





          2005-10-11 08:54:37 UTC
        

Not sure what you're trying to "see", but there never was an endless loop. 
3.3.5 still has the long delay somewhere around a minute into the build, both
with 3.3.4-r8's qmake and with its own.  note that there is an earlier run of
qmake that says "please wait..." that doesn't take very long at all (a couple of
seconds).




Comment 18


Parag Warudkar





          2006-01-02 15:24:03 UTC
        

Does passing -fast to configure resolve this? Don't think this is anything Gentoo specific - I remember seeing this when compiling Qt on Win XP.




Comment 19


Caleb Tennis (RETIRED)






          2006-01-06 06:26:23 UTC
        

I don't see it either.  Can you run in an strace and see where/why it might be stalling?





Comment 20


Simon Strandman





          2006-01-20 08:30:04 UTC
        

This bug is still present with qt 3.3.5, gcc4 and binutils 2.16.1. How would I do to strace it?




Comment 21


Caleb Tennis (RETIRED)






          2006-01-20 08:56:22 UTC
        

emerge strace
strace emerge qt




Comment 22


Simon Strandman





          2006-01-22 12:14:57 UTC
        

Created attachment 77855 [details]
strace

Output of strace emerge qt &> qt-emerge-strace




Comment 23


Simon Stelling (RETIRED)






          2006-10-06 05:08:55 UTC
        

Can't reproduce this with a current setup. Feel free to prove me wrong and reopen the bug :)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

