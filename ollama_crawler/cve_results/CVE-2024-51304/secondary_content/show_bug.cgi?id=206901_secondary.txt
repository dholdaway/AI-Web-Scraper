Title: 206901 – dev-java/sun-jdk-1.6 running 'java' dies quietly
URL: https://bugs.gentoo.org/show_bug.cgi?id=206901

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 206901
dev-java/sun-jdk-1.6 running 'java' dies quietly
Last modified: 2008-03-05 16:25:43 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 206901 
      - dev-java/sun-jdk-1.6 running 'java' dies quietly


Summary:
dev-java/sun-jdk-1.6 running 'java' dies quietly
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Java

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Java team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-01-21 18:11 UTC by Christoph Budziszewski





      Modified:
    
2008-03-05 16:25 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




the build environment

              (environment,155.24 KB,
                text/plain)

            
2008-01-21 18:13 UTC,

            Christoph Budziszewski




Details





build log with JAVA_PKG_DEBUG=1

              (dev-java:xalan-serializer-2.7.0:20080121-200852.log,167.98 KB,
                text/plain)

            
2008-01-21 20:12 UTC,

            Christoph Budziszewski




Details





strace /opt/sun-jdk-1.6.0*/bin/java -version

              (strace.log,25.84 KB,
                text/plain)

            
2008-01-23 01:17 UTC,

            Christoph Budziszewski




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Christoph Budziszewski





          2008-01-21 18:11:39 UTC
        

the Package fails to build. What did I do wrong?

Here is the build log:

>>> Emerging (1 of 1) dev-java/xalan-serializer-2.7.0 to /
 * xalan-j_2_7_0-src.tar.gz RMD160 SHA1 SHA256 size ;-) ...                                                   [ ok ]
 * checking ebuild checksums ;-) ...                                                                          [ ok ]
 * checking auxfile checksums ;-) ...                                                                         [ ok ]
 * checking miscfile checksums ;-) ...                                                                        [ ok ]
 * checking xalan-j_2_7_0-src.tar.gz ;-) ...                                                                  [ ok ]
 * Using: sun-jdk-1.6
>>> Unpacking source...
>>> Unpacking xalan-j_2_7_0-src.tar.gz to /var/tmp/portage/dev-java/xalan-serializer-2.7.0/work
tar: A lone zero block at 38548
removed `lib/BCEL.jar'
removed `lib/regexp.jar'
removed `lib/runtime.jar'
removed `lib/xercesImpl.jar'
removed `lib/xml-apis.jar'
removed `tools/JLex.jar'
removed `tools/ant.jar'
removed `tools/java_cup.jar'
removed `tools/stylebook-1.0-b3_xalan-2.jar'
removed `tools/xalan2jdoc.jar'
removed `tools/xalan2jtaglet.jar'
removed `src/xml-commons-external-1.3.02-src.tar.gz'
>>> Source unpacked.
>>> Compiling source in /var/tmp/portage/dev-java/xalan-serializer-2.7.0/work/xalan-j_2_7_0 ...
Rewriting source attributes
Using Sax to rewrite the build.xml files
Rewriting ./build.xml
Rewriting target attributes
Using Sax to rewrite the build.xml files
Rewriting ./build.xml
Rewriting nowarn attributes
Using Sax to rewrite the build.xml files
Rewriting ./build.xml
 * Disabling all optional ANT_TASKS
>>> Source compiled.
>>> Test phase [not enabled]: dev-java/xalan-serializer-2.7.0

>>> Install xalan-serializer-2.7.0 into /var/tmp/portage/dev-java/xalan-serializer-2.7.0/image/ category dev-java
 *
 * ERROR: dev-java/xalan-serializer-2.7.0 failed.
 * Call stack:
 *               ebuild.sh, line   46:  Called src_install
 *             environment, line 3876:  Called java-pkg_dojar 'src_install'
 *             environment, line 2287:  Called die
 * The specific snippet of code:
 *               diefunc "$FUNCNAME" "$LINENO" "$?" "${jar} does not exist";
 *  The die message:
 *   build/serializer.jar does not exist
 *
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/var/log/emerge/dev-java:xalan-serializer-2.7.0:20080121-175641.log'.
 * The ebuild environment file is located at '/var/tmp/portage/dev-java/xalan-serializer-2.7.0/temp/environment'.
 *
!!! When you file a bug report, please include the following information:
GENTOO_VM=sun-jdk-1.6  CLASSPATH="" JAVA_HOME="/opt/sun-jdk-1.6.0.03"
JAVACFLAGS="-source 1.4 -target 1.4" COMPILER="javac"
and of course, the output of emerge --info


Reproducible: Always




sharkbait ~ # emerge --info
Portage 2.1.4 (default-linux/x86/2006.1, gcc-4.1.2, glibc-2.7-r1, 2.6.22-hardened-r7-sharkbait i686)
=================================================================
System uname: 2.6.22-hardened-r7-sharkbait i686 Intel(R) Pentium(R) 4 CPU 3.00GHz
Timestamp of tree: Sun, 20 Jan 2008 08:30:07 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p17-r1
dev-java/java-config: 1.3.7, 2.0.33-r1
dev-lang/python:     2.3.5-r3, 2.4.4-r6
dev-python/pycrypto: 2.0.1-r6
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.10-r5
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS=" -O2 -march=pentium4 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS=" -O2 -march=pentium4 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--nospinner"
FEATURES="ccache distlocks metadata-transfer parallel-fetch sandbox sfperms strict unmerge-orphans userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/ ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo"
LINGUAS="de"
MAKEOPTS="-j5 -s"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp/"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/gentoo-de /usr/portage/local/layman/wrobel /usr/portage/local/layman/trauma /usr/portage/local/layman/portage-budzi /usr/local/portage-local"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X aac aalib acl acpi alsa apache2 bash-completion berkdb bitmap-fonts branding cairo cli cracklib crypt cups dbus divx dlloader dri dvd dvdr encode ffmpeg flac fortran gd gdbm geldkarte glitz gpm gtk2 hal hbci iconv imap ipv6 isdnlog jack jpeg kde kdeenablefinal kerberos ldap libcaca lirc lm_sensors midi mmx mp3 mpeg mudflap mysql nas ncurses nls nogcj nptl nptlonly objc opengl openmp pam pcre pda pdflib perl png postgres ppds pppd python qt qt3 qt4 readline reflection samba scanner scsh sdl session smp spl sse sse2 ssl tcpd threads truetype-fonts type1-fonts unicode usb x86 xface xinerama xorg xprint xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de" LIRC_DEVICES="hauppauge" USERLAND="GNU" VIDEO_CARDS="nv nvidia vesa"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Christoph Budziszewski





          2008-01-21 18:13:43 UTC
        

Created attachment 141497 [details]
the build environment

because it is mentioned in the errormessage.




Comment 2


Vlastimil Babka (Caster) (RETIRED)






          2008-01-21 18:27:51 UTC
        

Looks like ant died without saying a thing. No idea why. What version of ant-core is installed? Also please try rebuilding with 'JAVA_PKG_DEBUG=1 emerge ...' and post the build .log (not environment).




Comment 3


Christoph Budziszewski





          2008-01-21 20:12:30 UTC
        

Created attachment 141506 [details]
build log with JAVA_PKG_DEBUG=1

[ebuild   R   ] dev-java/ant-core-1.7.0  USE="-doc -source"




Comment 4


Vlastimil Babka (Caster) (RETIRED)






          2008-01-21 21:16:02 UTC
        

Weirder and weirder :)
does 'GENTOO_VM=sun-jdk-1.6 java -version' produce any output? What does java-check-environment say?




Comment 5


Vlastimil Babka (Caster) (RETIRED)






          2008-01-21 21:16:49 UTC
        

And if that's fine,
ant -version
ant -diagnostics




Comment 6


Christoph Budziszewski





          2008-01-22 00:04:13 UTC
        

well, ...


sharkbait ~ # GENTOO_VM=sun-jdk-1.6 java -version
sharkbait ~ # java-check-environment
 * === Java Environment Checker ===
 * The purpose of this script is to check the sanity of your Java Environment.
 * We have significantly changed and improved the way Java is handled in many
 * respects.
 * Please refer to our upgrade guide for details:
 *      http://www.gentoo.org/proj/en/java/java-upgrade.xml

 * Checking fastjar ...                                                                                       [ ok ]

 * Checking vm_environment_files ...                                                                          [ ok ]

 * Checking user_settings ...
 * Running as root. Don't need to check user settings.                                                        [ ok ]

 * Checking generation_1_system_vm ...                                                                        [ ok ]

 * Checking virtual_provides ...                                                                              [ ok ]

 * Checking overlays_eclasses ...                                                                             [ ok ]

 * Checking package_env ...                                                                                   [ ok ]

 * Java environment is sane. Congratulations!
sharkbait ~ # ant -version
sharkbait ~ # ant -diagnostics
sharkbait ~ # 




Comment 7


Vlastimil Babka (Caster) (RETIRED)






          2008-01-22 06:51:44 UTC
        

> sharkbait ~ # GENTOO_VM=sun-jdk-1.6 java -version

No wonder then, java doesn't work at all. Last step is to see if that's the run-java-tool or jdk itself. Try
$ /opt/sun-jdk-1.6.0*/bin/java -version
$ /opt/sun-jdk-1.6.0*/jre/bin/java -version

If not, try to remerge the sun-jdk.




Comment 8


Christoph Budziszewski





          2008-01-22 20:48:13 UTC
        

seems to be jdk itself, eclipse doesn't work either :-(

sharkbait ~ # /opt/sun-jdk-1.6.0*/bin/java -version
sharkbait ~ # /opt/sun-jdk-1.6.0*/jre/bin/java -version
sharkbait ~ # 

this is with sun-jdk-1.6.0.03 reemerged and also with update to sun-jdk-1.6.0.04

for run-java-tool:
sharkbait ~ # run-java-tool
* run-java-tool is not available for sun-jdk-1.6 on i686
* IMPORTANT: some Java tools are not available on some VMs on some architectur






Comment 9


Petteri Räty (RETIRED)






          2008-01-22 23:39:23 UTC
        

(In reply to comment #8)
> seems to be jdk itself, eclipse doesn't work either :-(
> 
> sharkbait ~ # /opt/sun-jdk-1.6.0*/bin/java -version
> sharkbait ~ # /opt/sun-jdk-1.6.0*/jre/bin/java -version
> sharkbait ~ # 
> 

strace /opt/sun-jdk-1.6.0*/bin/java -version




Comment 10


Christoph Budziszewski





          2008-01-23 01:17:15 UTC
        

Created attachment 141637 [details]
strace /opt/sun-jdk-1.6.0*/bin/java -version




Comment 11


Christoph Budziszewski





          2008-02-20 00:04:08 UTC
        

suddenly it works. Have done several things, including unmotivated emerge -e system (which didn't cure the flaw) and a *lot* of other updates. 
Maybe it is the new Kernel. 


here is actual emerge --info
Portage 2.1.4.3 (default-linux/x86/2006.1, gcc-4.1.2, glibc-2.7-r1, 2.6.23-hardened-r4-sharkbait i686)
=================================================================
System uname: 2.6.23-hardened-r4-sharkbait i686 Intel(R) Pentium(R) 4 CPU 3.00GHz
Timestamp of tree: Mon, 11 Feb 2008 17:30:01 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p17-r1
dev-java/java-config: 1.3.7, 2.0.33-r1
dev-lang/python:     2.4.4-r6
dev-python/pycrypto: 2.0.1-r6
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.10-r5
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.24
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS=" -O2 -march=pentium4 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS=" -O2 -march=pentium4 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--nospinner"
FEATURES="ccache collision-protect distlocks metadata-transfer parallel-fetch sandbox sfperms strict test unmerge-orphans userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/ ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo"
LINGUAS="de"
MAKEOPTS="-j5 -s"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp/"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/gentoo-de /usr/portage/local/layman/wrobel /usr/portage/local/layman/trauma /usr/portage/local/layman/portage-budzi /usr/local/portage-local"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X aac aalib acl acpi alsa bash-completion berkdb bitmap-fonts branding cairo cli cracklib crypt cups dbus divx dlloader dri dvd dvdr encode ffmpeg flac fortran gd gdbm geldkarte glitz gpm gtk2 hal hbci iconv imap ipv6 isdnlog jack jpeg kde kdeenablefinal kerberos ldap libcaca lirc lm_sensors midi mmx mp3 mpeg mudflap mysql nas ncurses nls nogcj nptl nptlonly objc opengl openmp pam pcre pda pdflib perl png postgres ppds pppd python qt qt3 qt4 readline reflection scanner scsh sdl session smp spl sse sse2 ssl tcpd threads truetype-fonts type1-fonts unicode usb x86 xface xinerama xorg xprint xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de" LIRC_DEVICES="hauppauge" USERLAND="GNU" VIDEO_CARDS="nv nvidia vesa"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 12


letrec@gmail.com





          2008-03-05 16:25:43 UTC
        

I'm seeing the same issue on 2.6.23-hardened-r8. At first try I had issues compiling eclipse with blackdown, but once I switched to sun-java6-jdk all compilation went fine and without hitch. 

However, now I can run 'java -version' without problem but cannot run eclipse as it fails with the error:

JVM terminated. Exit code=13
/usr/bin/java
-Xms40m
-Xmx256m
-Djava.library.path=/usr/lib
-jar /usr/lib/eclipse-3.2/startup.jar
-os linux
-ws gtk
-arch x86
-launcher /usr/lib/eclipse-3.2/eclipse
-name Eclipse
-showsplash 600
-exitdata 410015
-vm /usr/bin/java
-vmargs
-Xms40m
-Xmx256m
-Djava.library.path=/usr/lib
-jar /usr/lib/eclipse-3.2/startup.jar 

Should I file a new bug or how can I have it set as UNRESOLVED ?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

