Title: 196733 – high memory support (4GB)
URL: https://bugs.gentoo.org/show_bug.cgi?id=196733

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 196733
high memory support (4GB)
Last modified: 2007-10-22 20:01:08 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 196733 
      - high memory support (4GB)


Summary:
high memory support (4GB)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-10-22 18:42 UTC by Andrey





      Modified:
    
2007-10-22 20:01 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



loki_val









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andrey





          2007-10-22 18:42:37 UTC
        

the system is very slow
when 4Gb in (high memory support) is seelected
when selected none 
evrething is fine

but i have 1024MB RAM and when none selected only ~900 is visible 

Reproducible: Always

Steps to Reproduce:
1.make menuconfig (and select 4GB in High memory support)
2.reboot in new kernel
3.




 lspci
00:00.0 Host bridge: Intel Corporation 82852/82855 GM/GME/PM/GMV Processor to I/O Controller (rev 02)
00:00.1 System peripheral: Intel Corporation 82852/82855 GM/GME/PM/GMV Processor to I/O Controller (rev 02)
00:00.3 System peripheral: Intel Corporation 82852/82855 GM/GME/PM/GMV Processor to I/O Controller (rev 02)
00:02.0 VGA compatible controller: Intel Corporation 82852/855GM Integrated Graphics Device (rev 02)
00:02.1 Display controller: Intel Corporation 82852/855GM Integrated Graphics Device (rev 02)
00:1d.0 USB Controller: Intel Corporation 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) USB UHCI Controller #1 (rev 03)
00:1d.1 USB Controller: Intel Corporation 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) USB UHCI Controller #2 (rev 03)
00:1d.2 USB Controller: Intel Corporation 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) USB UHCI Controller #3 (rev 03)
00:1d.7 USB Controller: Intel Corporation 82801DB/DBM (ICH4/ICH4-M) USB2 EHCI Controller (rev 03)
00:1e.0 PCI bridge: Intel Corporation 82801 Mobile PCI Bridge (rev 83)
00:1f.0 ISA bridge: Intel Corporation 82801DBM (ICH4-M) LPC Interface Bridge (rev 03)
00:1f.1 IDE interface: Intel Corporation 82801DBM (ICH4-M) IDE Controller (rev 03)
00:1f.5 Multimedia audio controller: Intel Corporation 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) AC'97 Audio Controller (rev 03)
00:1f.6 Modem: Intel Corporation 82801DB/DBL/DBM (ICH4/ICH4-L/ICH4-M) AC'97 Modem Controller (rev 03)
01:04.0 Network controller: Intel Corporation PRO/Wireless 2200BG Network Connection (rev 05)
01:05.0 CardBus bridge: O2 Micro, Inc. OZ711M1/MC1 4-in-1 MemoryCardBus Controller (rev 20)
01:05.1 CardBus bridge: O2 Micro, Inc. OZ711M1/MC1 4-in-1 MemoryCardBus Controller (rev 20)
01:05.2 System peripheral: O2 Micro, Inc. OZ711Mx 4-in-1 MemoryCardBus Accelerator
01:06.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL-8139/8139C/8139C+ (rev 10)


  cat /proc/cpuinfo 
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 9
model name      : Intel(R) Celeron(R) M processor         1300MHz
stepping        : 5
cpu MHz         : 1299.893
cache size      : 512 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 2
wp              : yes
flags           : fpu vme de pse tsc msr mce cx8 apic sep mtrr pge mca cmov pat clflush dts acpi mmx fxsr sse sse2 tm pbe
bogomips        : 2601.35
clflush size    : 64




Comment 1


Andrey





          2007-10-22 18:46:05 UTC
        

i forget to say
that this bug is present in
vanilla-sources-2.6.22.9
and 
suspend2-sources-2.6.22-r2
gentoo-sources-latest-stable :) is too





Comment 2


Peter Alfredsen (RETIRED)






          2007-10-22 19:00:41 UTC
        

I will give you good odds that this is a mtrr issue, caused by the BIOS. This manifests when certain portions of your memory are not cacheable due to a bug in BIOS.
Please post the output of cat /proc/mtrr when HIGHMEM is enabled.
I suspect it will show something like this:
http://lkml.org/lkml/2003/11/9/79
>cat /proc/mtrr:
>reg00: base=0x00000000 (   0MB), size= 512MB: write-back, count=1
>reg01: base=0x20000000 ( 512MB), size= 256MB: write-back, count=1
>reg02: base=0x30000000 ( 768MB), size= 128MB: write-back, count=1
>reg03: base=0x38000000 ( 896MB), size=  64MB: write-back, count=1
>reg04: base=0x3c000000 ( 960MB), size=  32MB: write-back, count=1
>reg05: base=0x3e000000 ( 992MB), size=  16MB: write-back, count=1
>reg06: base=0xf0000000 (3840MB), size= 128MB: write-combining, count=1

As you can see, that leaves 1024-1008=16 MB uncacheable. If so, try booting with mem=1008 on the grub command line.

There probably exists an upgrade for your BIOS that solves this completely.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

