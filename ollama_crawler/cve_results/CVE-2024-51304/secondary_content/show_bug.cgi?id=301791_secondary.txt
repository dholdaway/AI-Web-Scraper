Title: 301791 – app-admin/gnome-system-tools is still not working for me
URL: https://bugs.gentoo.org/show_bug.cgi?id=301791

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 301791
app-admin/gnome-system-tools is still not working for me
Last modified: 2010-02-02 01:59:53 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 301791 
      - app-admin/gnome-system-tools is still not working for me


Summary:
app-admin/gnome-system-tools is still not working for me
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-01-22 01:22 UTC by Fred Krogh





      Modified:
    
2010-02-02 01:59 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




My  /etc/dbus-1/system.d/org.freedesktop.SystemToolsBackends.conf

              (org.freedesktop.SystemToolsBackends.conf,4.47 KB,
                text/plain)

            
2010-01-28 17:44 UTC,

            Fred Krogh




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Fred Krogh





          2010-01-22 01:22:05 UTC
        

When I access Users and Groups from the system/administration menu, I get

The configuration could not be loaded
An unknown error occurred.

Reproducible: Always

Steps to Reproduce:
1.  I've just done "emerge -DNv system-tools-backends liboobs gnome-system-tools

After this I did emerge -pv system-tools-backends liboobs gnome-system-tools which shows
[ebuild   R   ] app-admin/system-tools-backends-2.8.3  USE="-policykit" 0 kB
[ebuild   R   ] dev-libs/liboobs-2.22.2  USE="-doc" 0 kB
[ebuild   R   ] app-admin/gnome-system-tools-2.28.2  USE="samba -nfs -policykit" 0 kB


Actual Results:  
Attempting to run users-admin from the command line gives 

(users-admin:2249): Liboobs-WARNING **: There was an unknown error communicating with the backends: Failed to execute program /usr/libexec/dbus-daemon-launch-helper: Success

One has to appreciate the "Success" at the end.

The file evidently causing the problem has a directory entry of 

-rws--x--- 1 root messagebus 47328 Nov  1 19:07 /usr/libexec/dbus-daemon-launch-helper*

This file is in sys-apps/dbus-1.3.0-r1



emerge --info ================

Portage 2.1.7.16 (default/linux/amd64/10.0, gcc-4.4.2, glibc-2.11-r1, 2.6.32-gentoo-r2 x86_64)
=================================================================
System uname: Linux-2.6.32-gentoo-r2-x86_64-AMD_Opteron-tm-_Processor_242-with-gentoo-2.0.1
Timestamp of tree: Thu, 21 Jan 2010 21:30:01 +0000
app-shells/bash:     4.0_p37
dev-java/java-config: 1.3.7-r1, 2.1.10
dev-lang/python:     2.5.4-r2, 2.6.4, 3.1.1-r1
dev-util/cmake:      2.8.0
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.0-r1
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.5, 1.7.9-r1, 1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA dlj-1.1 sun-bcla-java-vm"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=native -ftree-vectorize -floop-interchange -floop-strip-mine -floop-block -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -march=native -ftree-vectorize -floop-interchange -floop-strip-mine -floop-block -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests distlocks fixpackages news parallel-fetch protect-owned sfperms strict unmerge-logs unmerge-orphans"
GENTOO_MIRRORS="http://gentoo.osuosl.org http://ftp.ucsb.edu/pub/mirrors/linux/gentoo  http://cudlug.cudenver.edu/gentoo http://gentoo.binarycompass.org"
LANG="en_us"
LC_ALL="C"
LDFLAGS="-Wl,-O1"
LINGUAS="en en_US en_US.ISO-8859-15 ISO-8859-15"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="   "
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac acl administrator aiglx alsa amd64 apache2 auctex audiofile bash-completion bcmath berkdb blas bonobo bzip2 cairo calendar cdrom clamav clamd cli clisp colordiff consolekit cracklib crypt ctype cups cxx dbus debugger deprecated dga discouraged divx-linux dri dvd dvdr dvdread emacs emul-linux86 esd extras fam fastcgi fbcon ffmpeg flac fortran ftp gd gdbm glut gmail gnome gnome-keyring gnutls gphoto2 gpm graphite gstreamer gtk hal iconv imagemagick ipv6 java javascript jpeg kde kerberos kpathsea latex latin1 leim libclamav libnotify libwww logrotate mad maildir mbox mcal mime mmx mmxext mng modules motif mouse mozcalendar mozilla mp3 mpeg2 mpi mudflap multilib mysql mysqli nat ncurses nls nocd nosendmail nptl nptlonly nsplugin nvidia objc offensive ogg openexr opengl openmp osc oscar pam pcre pdf perl png pop pop3d portaudio posix ppds pppd preview-latex python qt3support query-browser readline reflection regex replytolist rtc samba sasl session sharedmem smbclient sockets sound source sox speex spl sse sse2 ssl svg symlink sysfs tcltk tcpd tetex thunderbird tiff truetype unicode usb vhosts vorbis wxwidgets wxwindows xcomposite xine xmail xorg xulrunner xvid" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_US en_US.ISO-8859-15 ISO-8859-15" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nvidia" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Gilles Dartiguelongue (RETIRED)






          2010-01-22 07:43:00 UTC
        

Please list the groups your user is belonging to.
Also, system-tools-backends has to be started in default runlevel.




Comment 2


Fred Krogh





          2010-01-22 14:26:35 UTC
        

First, system-tools-backends is started at the default run level.  My user is "m"; here are the groups that m belongs to.

sys:x:3:root,bin,adm,m
adm:x:4:root,adm,daemon,m
disk:x:6:root,adm,haldaemon,m
wheel:x:10:root,m
floppy:x:11:root,m,haldaemon
audio:x:18:m,pulse
cdrom:x:19:m,haldaemon
video:x:27:root,m
games:x:35:m
usb:x:85:root,m,haldaemon
users:x:100:games,m
portage:x:250:portage,m
plugdev:x:409:root,m,haldaemon
power:x:414:m
stb-admin:x:1002:root,m
malc:x:447:root,m,apache
netdev:x:1000:root,m
wireshark:x:1003:m
pulse-access:x:1005:m

Thanks for looking.




Comment 3


Gilles Dartiguelongue (RETIRED)






          2010-01-25 00:02:49 UTC
        

also did you restart/reload dbus since you installed these packages ?




Comment 4


Fred Krogh





          2010-01-25 03:25:11 UTC
        

(In reply to comment #3)
> also did you restart/reload dbus since you installed these packages ?
> 
Not only that, I did a complete reboot.






Comment 5


Gilles Dartiguelongue (RETIRED)






          2010-01-27 22:05:35 UTC
        

hum, it really looks like s-t-b is not started. Could you install d-feet and check that system-tools-backends interfaces appear on the system bus ?




Comment 6


Fred Krogh





          2010-01-28 04:58:51 UTC
        

(In reply to comment #5)
> hum, it really looks like s-t-b is not started. Could you install d-feet and
> check that system-tools-backends interfaces appear on the system bus ?
> 
I'm not familiar with this tool, but after installing and running d-feet, System Bus has a line

org.fsreedesktop.SystemToolsBackends      system-tools-backends

I think this is what you thought might not be there.
Many thanks.





Comment 7


Daniel Gryniewicz (RETIRED)






          2010-01-28 13:16:06 UTC
        

I don't think dbus policy works that way; I don't think you can just give access to org.freedesktop.SystemToolsBackends and get it for all the sub nodes.  I think the default stb-admin policy needs to include org.freedesktop.SystemToolsBackends.Platform and so on for it to work.

Fred:
in /etc/dbus-1/system.d/org.freedesktop.SystemToolsBackends.conf, could you copy all the lines from right above the stb-admin policy into the stb-admin policy?  So, add these lines:

    <allow send_destination="org.freedesktop.SystemToolsBackends.Platform"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.GroupsConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.HostsConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.IfacesConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.NFSConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.NTPConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.ServicesConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.SMBConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.TimeConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.UserConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.UsersConfig"/>

Then restart the system dbus (likely a reboot is the easiest way to do this) and let us know if it works?




Comment 8


Fred Krogh





          2010-01-28 15:35:44 UTC
        

Thanks, but it gives the same error message as before.  Just to be sure, this is what the end of /etc/dbus-1/system.d/org.freedesktop.SystemToolsBackends.conf looks like.

  <policy group="stb-admin">
    <!-- be able to speak to the dispatcher -->
    <allow send_destination="org.freedesktop.SystemToolsBackends"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.Platform"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.GroupsConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.HostsConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.IfacesConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.NFSConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.NTPConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.ServicesConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.SMBConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.TimeConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.UserConfig"/>
    <allow send_destination="org.freedesktop.SystemToolsBackends.UsersConfig"/>
  </policy>
</busconfig>

The line just under the comment was there to begin with, the rest added as suggested.

I don't know if it matters, but when I run d-feet and look at system-tools-backends under Introspection Data, there is something called Object Paths, and nothing else. ConsoleKit and Hal both have other stuff listed under Object Paths.






Comment 9


Gilles Dartiguelongue (RETIRED)






          2010-01-28 17:39:50 UTC
        

just attach the complete file, it'll be easier to check.




Comment 10


Fred Krogh





          2010-01-28 17:44:31 UTC
        

Created attachment 217748 [details]
My  /etc/dbus-1/system.d/org.freedesktop.SystemToolsBackends.conf

The file requested




Comment 11


Fred Krogh





          2010-02-01 22:53:18 UTC
        

This works after: chmod a+x /usr/libexec/dbus-daemon-launch-helper
I hope this is not opening up something that should not be.





Comment 12


Gilles Dartiguelongue (RETIRED)






          2010-02-01 23:45:12 UTC
        

strange, my dbus has the exact same permission you showed and it works just fine.




Comment 13


Fred Krogh





          2010-02-02 01:59:53 UTC
        

Perhaps I wasn't clear.  Initially "ls -l /usr/libexec/dbus-daemon-launch-helper" gave "-rws--x--- 1 root messagebus 47328 Jan 21 17:23 /usr/libexec/dbus-daemon-launch-helper*".  I just added root and my user to the messagebus group, and now it works with the initial permissions.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

