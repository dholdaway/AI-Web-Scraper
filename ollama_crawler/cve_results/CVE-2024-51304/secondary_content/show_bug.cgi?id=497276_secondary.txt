Title: 497276 – dev-lang/perl-5.16.3 - links to system GLIBC rather than prefix GLIBC in RAP installation
URL: https://bugs.gentoo.org/show_bug.cgi?id=497276

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 497276
dev-lang/perl-5.16.3 - links to system GLIBC rather than prefix GLIBC in RAP installation
Last modified: 2014-01-06 19:36:03 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 497276 
      - dev-lang/perl-5.16.3 - links to system GLIBC rather than prefix GLIBC in RAP installation


Summary:
dev-lang/perl-5.16.3 - links to system GLIBC rather than prefix GLIBC in RAP ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

Prefix Support

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Prefix








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-01-06 15:09 UTC by Robert McGehee





      Modified:
    
2014-01-06 19:36 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Build.log for dev-lang/perl-5.16.3

              (build.log,227.36 KB,
                application/octet-stream)

            
2014-01-06 15:09 UTC,

            Robert McGehee




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Robert McGehee





          2014-01-06 15:09:34 UTC
        

Created attachment 367186 [details]
Build.log for dev-lang/perl-5.16.3

Hello,	
I have non-root access to a RH5 Linux machine on which I've managed to install a working Gentoo Prefix installation. Since the computers GLIBC libraries are archaic, I have tried getting a separate RAP installation installed using the bootscript here:  http://dev.gentoo.org/~heroxbd/bootstrap-rap.sh.

I seemed to have hit all the documented problems along the way: 
1) chown would hang on the linux headers installation (http://forums.gentoo.org/viewtopic-t-965704-start-0.html) require me to kill chown before stage 3 would continue. 
2) My system uses NFS authentication so I had to use the glibc-2.17 in the heroxbd overlay rather than the rap overlay and create these files: $EPREFIX/etc/group, $EPREFIX/etc/passwd and $EPREFIX/etc/resolve.conf files by hand (http://gentoo.2317880.n4.nabble.com/Gentoo-RAP-bootstrap-script-td268948.html). 
3) Last, I was unable to emerge the old version of portage from the bootscript (presumably due to bugs in the old version), but the latest version worked fine. (Consider upgrading portage in your bootscript.) 

However, after getting those solved, I was able to emerge the system successfully.

That said, I've encountered a problem with Perl that I hope to get help with. The dev-lang/perl-5.16.3 package installed at some point in the process (presumably bootstrap script). However, when the system tries to re-emerge perl on the new GLIBC with "emerge --uv --deep --newuse --with-bdeps=y world", the installation fails. Using the version of perl inside the heroxbd overlay doesn't fix the problem. The compilation fails on this line:

x86_64-pc-linux-gnu-gcc: /lib64/libc.so.6: version `GLIBC_2.14' not found (required by /data/research/prefix/var/tmp/portage/dev-lang/perl-5.16.3/work/perl-5.16.3/libperl.so.5.16.3)
makefile:361: recipe for target 'perl' failed
make: *** [perl] Error 1

This indicates to me that perl is trying to use the GLIBC libraries in /lib64 rather than the new RAP one in $EPREFIX/lib64. Could this be because the version of perl in $EPREFIX/usr/bin was compiled in the bootstrap phase before a new GLIBC existed? If so, is there a way around this?

Thanks, Robert

[lbos100]/data/research/prefix/etc/portage> emerge --info '=dev-lang/perl-5.16.3::heroxbd'
Portage 2.2.7-prefix (prefix/linux/amd64, gcc-4.7.3, unavailable, 2.6.18-348.6.1.0.1.el5 x86_64)
=================================================================
                        System Settings
=================================================================
System uname: Linux-2.6.18-348.6.1.0.1.el5-x86_64-Intel-R-_Xeon-R-_CPU_E7-_4830_@_2.13GHz-with-redhat-5.9-Tikanga
KiB Mem:   528103532 total, 127198156 free
KiB Swap:   33551744 total,  33551692 free
Timestamp of tree: Fri, 03 Jan 2014 23:06:24 +0000
ld GNU ld (GNU Binutils) 2.23
app-shells/bash:          4.2_p39-r1
dev-lang/python:          2.7.5-r4
dev-util/cmake:           2.8.12.1-r2
sys-devel/autoconf:       2.69
sys-devel/automake:       1.12.4, 1.14
sys-devel/binutils:       2.23::rap
sys-devel/gcc:            4.7.3::rap
sys-devel/gcc-config:     1.8-r00.1::rap
sys-devel/libtool:        2.4.2
sys-devel/make:           4.0-r1
sys-kernel/linux-headers: 3.9 (virtual/os-headers)
sys-libs/glibc:           2.17::rap
Repositories: gentoo_prefix science heroxbd rap
ACCEPT_KEYWORDS="~amd64 ~amd64-linux"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/gconf /etc/gentoo-release /etc/terminfo"
CXXFLAGS="-O2 -march=native -pipe"
DISTDIR="/data/research/prefix/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs collision-protect config-protect-if-modified distlocks ebuild-locks fixlafiles force-prefix merge-sync news parallel-fetch preserve-libs protect-owned sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-O2 -march=native -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="C"
LDFLAGS="-Wl,-O1"
MAKEOPTS="-j8"
PKGDIR="/data/research/prefix/usr/portage/packages"
PORTAGE_CONFIGROOT="/data/research/prefix/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/data/research/prefix/var/tmp"
PORTDIR="/data/research/prefix/usr/portage"
PORTDIR_OVERLAY="/data/research/prefix/var/lib/layman/science /data/research/prefix/var/lib/layman/heroxbd /data/research/prefix/usr/local/portage"
USE="X amd64 bash-completion berkdb blas bzip2 cli cracklib crypt cxx dri fortran gcj gdbm iconv mmx modules ncurses nls nptl openmp pcre prefix rap readline session sse sse2 ssl subversion tcpd threads unicode zlib" ABI_X86="64" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-5" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7" RUBY_TARGETS="ruby19 ruby18" USERLAND="GNU" VIDEO_CARDS="radeon" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, SYNC, USE_PYTHON




Comment 1


Robert McGehee





          2014-01-06 19:36:03 UTC
        

Ok, I got it working. I was able to downgrade to dev-lang/perl-5.16.2 and emerge a perl installation using the newer GLIBC libraries. Then I was able to upgrade back to dev-lang/perl-5.16.3 without any problem.

--Robert









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

