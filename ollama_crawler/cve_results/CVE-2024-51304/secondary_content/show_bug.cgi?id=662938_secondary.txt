Title: 662938 – dev-lang/rust-1.28.0 throws out a critical error [E0658] , but this doesn't stop emerge from merging
URL: https://bugs.gentoo.org/show_bug.cgi?id=662938

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 662938
dev-lang/rust-1.28.0 throws out a critical error [E0658] , but this doesn't stop emerge from merging
Last modified: 2018-08-09 08:56:15 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 662938 
      - dev-lang/rust-1.28.0 throws out a critical error [E0658] , but this doesn't stop emerge from merging


Summary:
dev-lang/rust-1.28.0 throws out a critical error [E0658] , but this doesn't s...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Rust Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2018-08-06 12:44 UTC by tt_1





      Modified:
    
2018-08-09 08:56 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



djc









See Also:


https://github.com/gentoo/gentoo-rust/pull/363

https://github.com/rust-lang/rust/issues/48075

https://github.com/rust-lang/rust/issues/52305





Package list:







Runtime testing required:

---























      Attachments
    




compressed build.log

              (build.log.zip,36.20 KB,
                application/zip)

            
2018-08-06 12:46 UTC,

            tt_1




Details





output of emerge --info

              (emerge-info,4.92 KB,
                text/plain)

            
2018-08-06 12:47 UTC,

            tt_1




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


tt_1





          2018-08-06 12:44:33 UTC
        

When compiling rust-1.28.0, clippy gets compiled and throws out this beauty: 

   Compiling toml v0.4.6
   Compiling idna v0.1.4
   Compiling rustc_version v0.2.2
   Compiling backtrace v0.3.6
   Compiling url v1.7.0
   Compiling error-chain v0.11.0
   Compiling clippy v0.0.202 (file:///var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/src/tools/clippy)
   Compiling cargo_metadata v0.5.4
   Compiling clippy_lints v0.0.202 (file:///var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/src/tools/clippy/clippy_lints)
error[E0658]: Using the `?` macro Kleene operator for "at most one" repetition is unstable (see issue #48075)
 --> <declare_lint macros>:6:37
  |
6 | : expr => $ edition_level : ident $ ( , ) ? ) => (
  |                                     ^^^^^
  |
  = help: add #![feature(macro_at_most_once_rep)] to the crate attributes to enable

error[E0658]: Using the `?` macro Kleene operator for "at most one" repetition is unstable (see issue #48075)
 --> <lint_array macros>:1:29
  |
1 | ( $ ( $ lint : expr ) , * $ ( , ) ? ) => {
  |                             ^^^^^
  |
  = help: add #![feature(macro_at_most_once_rep)] to the crate attributes to enable

error[E0658]: Using the `?` macro Kleene operator for "at most one" repetition is unstable (see issue #48075)
 --> <declare_lint macros>:6:37
  |
6 | : expr => $ edition_level : ident $ ( , ) ? ) => (
  |                                     ^^^^^
  |
  = help: add #![feature(macro_at_most_once_rep)] to the crate attributes to enable

error[E0658]: Using the `?` macro Kleene operator for "at most one" repetition is unstable (see issue #48075)
 --> <lint_array macros>:1:29
  |
1 | ( $ ( $ lint : expr ) , * $ ( , ) ? ) => {
  |                             ^^^^^
  |
  = help: add #![feature(macro_at_most_once_rep)] to the crate attributes to enable

error: aborting due to 2 previous errors

For more information about this error, try `rustc --explain E0658`.
error: Could not compile `clippy_lints`.

Caused by:
  process didn't exit successfully: `/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/bootstrap/debug/rustc --crate-name clippy_lints tools/clippy/clippy_lints/src/lib.rs --error-format json --crate-type lib --emit=dep-info,link -C opt-level=2 -C metadata=808dbce065b60ad1 -C extra-filename=-808dbce065b60ad1 --out-dir /var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps --target x86_64-unknown-linux-gnu -L dependency=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps -L dependency=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps --extern pulldown_cmark=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libpulldown_cmark-ebba01dbabb50f38.rlib --extern regex_syntax=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libregex_syntax-7768c532a4d73cb8.rlib --extern if_chain=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libif_chain-08067b1ac6a3dc39.rlib --extern serde=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libserde-954bbc780b0020e8.rlib --extern url=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/liburl-c708e1a067dd3842.rlib --extern cargo_metadata=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libcargo_metadata-b439e4a4bb7ed895.rlib --extern matches=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libmatches-fbf9546c1a654d6c.rlib --extern itertools=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libitertools-5fabdd39b0d58296.rlib --extern toml=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libtoml-62bd5734009e1cd8.rlib --extern unicode_normalization=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libunicode_normalization-912710911145d109.rlib --extern lazy_static=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/liblazy_static-8fc7d2db85a0ad9d.rlib --extern quine_mc_cluskey=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libquine_mc_cluskey-e46248baeb23cead.rlib --extern serde_derive=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libserde_derive-fbad2b99bfa6d574.so --extern semver=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/deps/libsemver-6d8f137054c75b61.rlib -L native=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/x86_64-unknown-linux-gnu/release/build/backtrace-sys-e9110a0f73074a74/out` (exit code: 101)
warning: build failed, waiting for other jobs to finish...
error: aborting due to 2 previous errors

For more information about this error, try `rustc --explain E0658`.
error: Could not compile `clippy_lints`.

Caused by:
  process didn't exit successfully: `/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/bootstrap/debug/rustc --crate-name clippy_lints tools/clippy/clippy_lints/src/lib.rs --error-format json --crate-type lib --emit=dep-info,link -C opt-level=2 -C metadata=5926decf1915fdac -C extra-filename=-5926decf1915fdac --out-dir /var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps -L dependency=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps --extern pulldown_cmark=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libpulldown_cmark-d415139627f93b01.rlib --extern regex_syntax=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libregex_syntax-9b09cd5290257a50.rlib --extern if_chain=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libif_chain-4e5915875d9f2d56.rlib --extern serde=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libserde-4cac8b64472a54f4.rlib --extern url=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/liburl-b24996703ea8897a.rlib --extern cargo_metadata=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libcargo_metadata-616b5536710c1ae0.rlib --extern matches=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libmatches-51d09f94fb6f26c4.rlib --extern itertools=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libitertools-cb13292f884d6995.rlib --extern toml=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libtoml-9c6e4743a4b1d972.rlib --extern unicode_normalization=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libunicode_normalization-5dac60218d700ffd.rlib --extern lazy_static=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/liblazy_static-59933e6c610d3f59.rlib --extern quine_mc_cluskey=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libquine_mc_cluskey-16cd1338e556efc4.rlib --extern serde_derive=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libserde_derive-fbad2b99bfa6d574.so --extern semver=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/deps/libsemver-2af0d4edd8c5a4c3.rlib -L native=/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/build/x86_64-unknown-linux-gnu/stage2-tools/release/build/backtrace-sys-1bf1db127596f6c1/out` (exit code: 101)
command did not execute successfully: "/var/tmp/portage/dev-lang/rust-1.28.0/work/rust-stage0/bin/cargo" "build" "--target" "x86_64-unknown-linux-gnu" "-j" "4" "--release" "--locked" "--frozen" "--manifest-path" "/var/tmp/portage/dev-lang/rust-1.28.0/work/rustc-1.28.0-src/src/tools/clippy/Cargo.toml" "--features" "" "--message-format" "json"
expected success, got: exit code: 101
Set({"src/tools/rustfmt"}) not skipped for "tool::Rustfmt" -- not in ["src/tools/miri"]
Building stage2 tool rustfmt (x86_64-unknown-linux-gnu)




Comment 1


tt_1





          2018-08-06 12:46:49 UTC
        

Created attachment 542536 [details]
compressed build.log

the full build log




Comment 2


tt_1





          2018-08-06 12:47:29 UTC
        

Created attachment 542538 [details]
output of emerge --info




Comment 3


tt_1





          2018-08-06 12:49:56 UTC
        

What is really odd, the emerge of dev-lang/rust-1.28.0 never came to a stop and finished despite this error.




Comment 4


tt_1





          2018-08-06 12:50:30 UTC
        

Might be related to https://github.com/gentoo/gentoo-rust/pull/363




Comment 5


Dirkjan Ochtman (RETIRED)






          2018-08-06 14:10:55 UTC
        

See https://github.com/rust-lang/rust/issues/52305. I'm inclined to just close this.




Comment 6


Dirkjan Ochtman (RETIRED)






          2018-08-08 13:04:00 UTC
        

Since this is not actually a problem (it just looks like a build failure, but the component being built won't be installed anyway), I'll just close this.




Comment 7


tt_1





          2018-08-08 13:41:04 UTC
        

Ok for me. If you want to chat with upstream about this, you can use the github issue link.




Comment 8


Dirkjan Ochtman (RETIRED)






          2018-08-08 13:44:20 UTC
        

The particular failure in this case is not very interesting (it's in miri, an experimental component that's never installed). I think the bug I referenced is more interesting because the problem here is the build system in the common case building the experimental component and showing the build failure in a way that might confuse the user into thinking something's wrong.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

