Title: 185749 – On some computer (and only some) app-backup/bacula-2.0.3 doesn't install 'director' despite USE sets correctly
URL: https://bugs.gentoo.org/show_bug.cgi?id=185749

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 185749
On some computer (and only some) app-backup/bacula-2.0.3 doesn't install 'director' despite USE sets correctly
Last modified: 2007-07-18 13:34:02 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 185749 
      - On some computer (and only some) app-backup/bacula-2.0.3 doesn't install 'director' despite USE sets correctly


Summary:
On some computer (and only some) app-backup/bacula-2.0.3 doesn't install 'dir...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-07-18 10:17 UTC by Thomas Capricelli





      Modified:
    
2007-07-18 13:34 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Thomas Capricelli





          2007-07-18 10:17:49 UTC
        

i did the same installation of bacula on two different computers. Using same USE flags and same version. On one computer, the stuff related to 'director' was not installed. Pretty much what i would have expected with USE=-bacula-nodir, although this flag was NOT set. I tried to re-install, but didn't manage neither.

I have no idea what difference between the two computers can have trigger this.

Reproducible: Always

Steps to Reproduce:
1. setup USE and package.keywords
2. emerge bacula
3.

Actual Results:  
no /etc/bacula/bacula-dir.conf, no /usr/sbin/bacula-dir (and 'which bacula-dir' gives nothing)
nothing special written during configure/compilation

On the other computer, everything is fine.

Expected Results:  
everything needed to use bacula director

"emerge -vp bacula" gives the same result on both computers:

[ebuild   R   ] app-backup/bacula-2.0.3  USE="X python readline sqlite3 ssl tcpd wxwindows -bacula-clientonly -bacula-console -bacula-nodir -bacula-nosd -bacula-split-init -doc -gnome -logrotate -logwatch -mysql -postgres -sqlite -static"


This is emerge --info on the computer where it FAILS :
Portage 2.1.3_rc8 (default-linux/amd64/2007.0, gcc-4.1.2, glibc-2.6-r0, 2.6.22 x86_64)
=================================================================
System uname: 2.6.22 x86_64 AMD Athlon(tm) 64 X2 Dual Core Processor 4200+
Gentoo Base System release 1.12.10
Timestamp of tree: Tue, 17 Jul 2007 16:20:01 +0000
dev-lang/python:     2.3.6-r2, 2.4.4-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O3 -pipe"
CHOST="x86_64-pc-linux-gnu"
MAKEOPTS="-j 3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
USE="3dnow 3dnowext X a52 aac acl alsa amd64 arts berkdb bidi bitmap-fonts browserplugin bzip2 cairo cdda cdio cli cracklib crypt cups dbus dga divx4linux djvu dri dts dv dvb dvd dvdread edl encode exif fam fbcon fbdev ffmpeg flac font-server fortran freetype gdbm gif glitz gnutls gpm gtk hal httpd iconv ilbc imap innodb ipv6 isdnlog jabber java jpeg jpeg2k kde lame libg++ live lm_sensors lua mad matroska midi mmx mmxext mng mozilla mp3 mpeg mudflap ncurses nls nptl nptlonly nsplugin nvidia obj-gc objc objc++ ogg oggvorbis opengl openmp pam pcre pdf perl perlsuid pic png pppd python qt3 qt4 quicktime readline reflection rtc rtsp samba sasl sdl session speex spl sqlite3 sse sse2 ssl stream svg tcpd theora tiff truetype truetype-fonts type1-fonts unicode usb v4l v4l2 vcd vlm vorbis wifi wmf wxwindows x264 xcomposite xine xinerama xorg xv xvid xvmc zeroconf zlib zrtp" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en fr it" USERLAND="GNU" VIDEO_CARDS="vga vesa"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS


And the info for the computer where it WORKS : 
Portage 2.1.3_rc8 (default-linux/x86/2007.0, gcc-4.1.1, glibc-2.5-r4, 2.6.20-vs2.2.0-gentoo i686)
=================================================================
System uname: 2.6.20-vs2.2.0-gentoo i686 AMD Athlon(tm) Processor
Gentoo Base System release 1.12.9
Timestamp of tree: Tue, 17 Jul 2007 16:20:01 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.23b
virtual/os-headers:  2.6.21
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=i586 -O3 -pipe"
CHOST="i686-pc-linux-gnu"
MAKEOPTS="-j2"
USE="3dnow 3dnowext X a52 aac acl alsa berkdb bidi bitmap-fonts cdda cdio cli cracklib crypt cups dbus dga dri dts dvd dvdnav dvdread encode fam fasttrack fbcon fbdev ffmpeg flac font-server fortran freetype gd gdbm geoip gif gnutella gnutls gpm hal httpd iconv imap innodb ipv6 isdnlog jpeg jpeg2k libg++ lirc live livecd lm_sensors lua lzo mad math matroska midi mmx mp2 mp3 mpeg mudflap ncurses nls nptl nptlonly ogg oggvorbis opengl openmp oss pam pcre pdf perl perlsuid png pppd python quicktime rdesktop readline real reflection sasl server session speex spl sse ssl stream svg tcpd theora tiff truetype truetype-fonts type1-fonts unicode v4l v4l2 vcd vlm vorbis wifi win32codecs wxwindows x264 x86 xinerama xorg xv xvid zaptel zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en it fr de" LIRC_DEVICES="pctv" USERLAND="GNU" VIDEO_CARDS="nvidia"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Jakub Moc (RETIRED)






          2007-07-18 10:47:15 UTC
        

Attach a complete emerge log here, please.




Comment 2


Thomas Capricelli





          2007-07-18 10:49:30 UTC
        

there are several problems
* The director stuff doesn't compile with my python (see excerpt)
* the 'make' doesn't exit with an error, it just discards the director stuff
* nothing is reported at the end of the compilation

/usr/lib64/python2.3/config/libpython2.3.a(zlibmodule.o): In function `PyZlib_unflush':
(.text+0x615): undefined reference to `inflate'
/usr/lib64/python2.3/config/libpython2.3.a(zlibmodule.o): In function `PyZlib_unflush':
(.text+0x682): undefined reference to `inflate'
/usr/lib64/python2.3/config/libpython2.3.a(zlibmodule.o): In function `PyZlib_unflush':
(.text+0x6ec): undefined reference to `inflateEnd'
/usr/lib64/python2.3/config/libpython2.3.a(zlibmodule.o): In function `PyZlib_flush':
(.text+0x8b3): undefined reference to `deflate'
/usr/lib64/python2.3/config/libpython2.3.a(zlibmodule.o): In function `PyZlib_flush':
(.text+0x915): undefined reference to `deflate'

afaics, those symbols belongs to the zlib package. I reinstalled zlib, then python-2.3 and it still fails with the same error.

Then, i unmerged python-2.3 (hope gentoo wont break), and now i can install bacula with the director stuff




Comment 3


Jakub Moc (RETIRED)






          2007-07-18 11:44:11 UTC
        

You should run python-updater after python upgrades.




Comment 4


Jakub Moc (RETIRED)






          2007-07-18 11:44:35 UTC
        

WORKSFORME, this apparently isn't a bacula bug. :)




Comment 5


John M. Drescher





          2007-07-18 13:34:02 UTC
        

I believe the problem is that the build process does not end with an error if one of the targets it builds fails to build correctly so the emerge can finish successfully with missing targets. I have had this happen a few times myself in various versions of bacula.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

