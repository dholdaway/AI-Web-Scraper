Title: 414187 – media-gfx/splashutils fails to compile against >sys-libs/zlib-1.2.5-r2 even with truetype disabled
URL: https://bugs.gentoo.org/show_bug.cgi?id=414187

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 414187
media-gfx/splashutils fails to compile against >sys-libs/zlib-1.2.5-r2 even with truetype disabled
Last modified: 2012-06-17 18:08:25 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 414187 
      - media-gfx/splashutils fails to compile against >sys-libs/zlib-1.2.5-r2 even with truetype disabled


Summary:
media-gfx/splashutils fails to compile against >sys-libs/zlib-1.2.5-r2 even w...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Michal Januszewski (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




384483



 

        Show dependency tree





 





      Reported:
    
2012-04-30 23:30 UTC by Carter Young





      Modified:
    
2012-06-17 18:08 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



esigra
mstomich









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Carter Young





          2012-04-30 23:30:40 UTC
        

Please see Bug 413117 for reasoning behind why this needs to be fixed, as this bug should be made a Depends on for Bug 413117 and Bug 413361.

Reproducible: Always

Steps to Reproduce:
1. Upgrade the following Packages to testing branch:
   dev-db/virtuoso-server
   dev-db/virtuoso-odbc
   sys-libs/zlib
   media-video/vlc
2. Disable truetype useflag
3. emerge/cave resolve -x splashutils
Actual Results:  
With truetype enabled, paludis correctly states that the version atom on sys-libs/zlib must be greater than 1.2.5 and less than 1.2.6 because of the minizip flag being needed on the new version of dev-db/virtuoso-server.  I masked sys-libs/zip-1.2.6 and tested each release of 1.2.5.1 and received the following error(with and without truetype enabled):

make -j3 CC=x86_64-pc-linux-gnu-gcc LIB=lib64 STRIP=true
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -Wl,-O1 -Wl,--as-needed fbres.c -o fbres
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -Wl,-O1 -Wl,--as-needed usleep.c -o usleep
true usleep
true fbres
make[1]: Entering directory `/var/tmp/paludis/media-gfx-splashutils-1.5.4.4-r1/work/miscsplashutils-0.1.8/fbtruetype'
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -I/usr/include/freetype2   -c -o fbtruetype.o fbtruetype.c
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -I/usr/include/freetype2   -c -o messages.o messages.c
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -I/usr/include/freetype2   -c -o console.o console.c
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -I/usr/include/freetype2   -c -o ttf.o ttf.c
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -I/usr/include/freetype2   -c -o luxisri.o luxisri.c
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -I/usr/include/freetype2 -Wl,-O1 -Wl,--as-needed -L/usr/lib64 -o fbtruetype -Wl,-O1 -Wl,--as-needed -L/usr/lib64 fbtruetype.o messages.o console.o ttf.o luxisri.o -lfreetype   -lm
x86_64-pc-linux-gnu-gcc -march=amdfam10 -O2 -pipe -I/usr/include/freetype2 -Wl,-O1 -Wl,--as-needed -L/usr/lib64 -static -o fbtruetype.static -Wl,-O1 -Wl,--as-needed -L/usr/lib64 fbtruetype.o messages.o console.o ttf.o luxisri.o -lfreetype -lz -lbz2   -lm
/usr/lib/gcc/x86_64-pc-linux-gnu/4.5.3/../../../../x86_64-pc-linux-gnu/bin/ld: cannot find -lz
collect2: ld returned 1 exit status
make[1]: *** [fbtruetype.static] Error 1
make[1]: *** Waiting for unfinished jobs....
make[1]: Leaving directory `/var/tmp/paludis/media-gfx-splashutils-1.5.4.4/work/miscsplashutils-0.1.8/fbtruetype'
make: *** [all] Error 2
/usr/libexec/paludis/utils/emake: emake returned error 2 

Expected Results:  
media-gfx/splashutils should compile against versions of sys-libs/zlib greater than 1.2.5-r2 

Disabling the truetype flag does allow sys-libs/zlib-1.2.6 to install cleanly but media-gfx/splashutils still fails.

Extra Information for media-gfx/splashutils-1.5.4.4:0::gentoo:
        >>> Running ebuild phase killold as paludisbuild:paludisbuild...
        >>> Starting builtin_killold
        >>> Done builtin_killold
        >>> Completed ebuild phase killold
        >>> Running ebuild phases initmisc infovars as paludisbuild:paludisbuild...
        >>> Starting builtin_initmisc
        >>> Done builtin_initmisc
        >>> Starting builtin_infovars
        ACCEPT_KEYWORDS=amd64
        CBUILD=x86_64-pc-linux-gnu
        CFLAGS=-march=amdfam10 -O2 -pipe
        CHOST=x86_64-pc-linux-gnu
        CONFIG_PROTECT= 
        CONFIG_PROTECT_MASK= 
        CPPFLAGS=
        CTARGET=
        CXXFLAGS=-march=amdfam10 -O2 -pipe
        DISTDIR=/var/cache/distfiles
        FEATURES=
        FFLAGS=
        GENTOO_MIRRORS=
        INSTALL_MASK=
        LANG=
        LC_ALL=C
        LDFLAGS=-Wl,-O1 -Wl,--as-needed
        LINGUAS=en en_US
        MAKEOPTS=-j3
        PORTAGE_COMPRESS=
        PORTAGE_COMPRESS_FLAGS=
        PORTAGE_CONFIGROOT=
        PORTAGE_RSYNC_EXTRA_OPTS=
        PORTAGE_RSYNC_OPTS=
        PORTAGE_TMPDIR=/var/tmp/paludis
        PORTDIR=/usr/portage
        PORTDIR_OVERLAY=
        SYNC=
        USE=fbcondecor gpm mng png truetype amd64 alsa_cards_ali5451 alsa_cards_als4000 alsa_cards_atiixp alsa_cards_atiixp-modem alsa_cards_bt87x alsa_cards_ca0106 alsa_cards_cmipci alsa_cards_emu10k1x alsa_cards_ens1370 alsa_cards_ens1371 alsa_cards_es1938 alsa_cards_es1968 alsa_cards_fm801 alsa_cards_hda-intel alsa_cards_intel8x0 alsa_cards_intel8x0m alsa_cards_maestro3 alsa_cards_trident alsa_cards_usb-audio alsa_cards_via82xx alsa_cards_via82xx-modem alsa_cards_ymfpci alsa_pcm_plugins_adpcm alsa_pcm_plugins_alaw alsa_pcm_plugins_asym alsa_pcm_plugins_copy alsa_pcm_plugins_dmix alsa_pcm_plugins_dshare alsa_pcm_plugins_dsnoop alsa_pcm_plugins_empty alsa_pcm_plugins_extplug alsa_pcm_plugins_file alsa_pcm_plugins_hooks alsa_pcm_plugins_iec958 alsa_pcm_plugins_ioplug alsa_pcm_plugins_ladspa alsa_pcm_plugins_lfloat alsa_pcm_plugins_linear alsa_pcm_plugins_meter alsa_pcm_plugins_mmap_emul alsa_pcm_plugins_mulaw alsa_pcm_plugins_multi alsa_pcm_plugins_null alsa_pcm_plugins_plug alsa_pcm_plugins_rate alsa_pcm_plugins_route alsa_pcm_plugins_share alsa_pcm_plugins_shm alsa_pcm_plugins_softvol apache2_modules_alias apache2_modules_auth_basic apache2_modules_auth_digest apache2_modules_authz_host apache2_modules_cgid apache2_modules_dav apache2_modules_dir apache2_modules_mime apache2_modules_php apache2_modules_rewrite apache2_mpms_worker calligra_features_braindump calligra_features_flow calligra_features_karbon calligra_features_kexi calligra_features_krita calligra_features_plan calligra_features_sheets calligra_features_stage calligra_features_tables calligra_features_words cameras_ptp2 collectd_plugins_df collectd_plugins_interface collectd_plugins_irq collectd_plugins_load collectd_plugins_memory collectd_plugins_rrdtool collectd_plugins_swap collectd_plugins_syslog elibc_glibc gpsd_protocols_aivdm gpsd_protocols_ashtech gpsd_protocols_earthmate gpsd_protocols_evermore gpsd_protocols_fv18 gpsd_protocols_garmin gpsd_protocols_garmintxt gpsd_protocols_gpsclock gpsd_protocols_itrax gpsd_protocols_mtk3301 gpsd_protocols_navcom gpsd_protocols_nmea gpsd_protocols_ntrip gpsd_protocols_oceanserver gpsd_protocols_oldstyle gpsd_protocols_oncore gpsd_protocols_rtcm104v2 gpsd_protocols_rtcm104v3 gpsd_protocols_sirf gpsd_protocols_superstar2 gpsd_protocols_timing gpsd_protocols_tnt gpsd_protocols_tripmate gpsd_protocols_tsip gpsd_protocols_ubx input_devices_evdev input_devices_keyboard input_devices_mouse input_devices_virtualbox kernel_linux lcd_devices_bayrad lcd_devices_cfontz lcd_devices_cfontz633 lcd_devices_glk lcd_devices_hd44780 lcd_devices_lb216 lcd_devices_lcdm001 lcd_devices_mtxorb lcd_devices_ncurses lcd_devices_text linguas_en linguas_en_US php_targets_php5-3 ruby_targets_ree18 ruby_targets_ruby18 userland_GNU video_cards_nouveau video_cards_nv video_cards_nvidia xtables_addons_account xtables_addons_chaos xtables_addons_condition xtables_addons_delude xtables_addons_dhcpmac xtables_addons_fuzzy xtables_addons_geoip xtables_addons_iface xtables_addons_ipmark xtables_addons_ipp2p xtables_addons_ipset xtables_addons_ipv4options xtables_addons_length2 xtables_addons_logmark xtables_addons_lscan xtables_addons_pknock xtables_addons_psd xtables_addons_quota2 xtables_addons_rawnat xtables_addons_steal xtables_addons_sysrq xtables_addons_tarpit xtables_addons_tee amd64 
        USE_PYTHON=
        >>> Done builtin_infovars
        >>> Completed ebuild phases initmisc infovars
        >>> Running ebuild phase tidyup as paludisbuild:paludisbuild...
        >>> Starting builtin_tidyup
        rm -fr /var/tmp/paludis/media-gfx-splashutils-1.5.4.4-info
        >>> Done builtin_tidyup
        >>> Completed ebuild phase tidyup

Extra Information for sys-libs/zlib-1.2.5-r2:0::gentoo:
        >>> Running ebuild phase killold as paludisbuild:paludisbuild...
        >>> Starting builtin_killold
        >>> Done builtin_killold
        >>> Completed ebuild phase killold
        >>> Running ebuild phases initmisc infovars as paludisbuild:paludisbuild...
        >>> Starting builtin_initmisc
        >>> Done builtin_initmisc
        >>> Starting builtin_infovars
        ACCEPT_KEYWORDS=amd64
        CBUILD=x86_64-pc-linux-gnu
        CFLAGS=-march=amdfam10 -O2 -pipe
        CHOST=x86_64-pc-linux-gnu
        CONFIG_PROTECT= 
        CONFIG_PROTECT_MASK= 
        CPPFLAGS=
        CTARGET=
        CXXFLAGS=-march=amdfam10 -O2 -pipe
        DISTDIR=/var/cache/distfiles
        FEATURES=
        FFLAGS=
        GENTOO_MIRRORS=
        INSTALL_MASK=
        LANG=
        LC_ALL=C
        LDFLAGS=-Wl,-O1 -Wl,--as-needed
        LINGUAS=en en_US
        MAKEOPTS=-j3
        PORTAGE_COMPRESS=
        PORTAGE_COMPRESS_FLAGS=
        PORTAGE_CONFIGROOT=
        PORTAGE_RSYNC_EXTRA_OPTS=
        PORTAGE_RSYNC_OPTS=
        PORTAGE_TMPDIR=/var/tmp/paludis
        PORTDIR=/usr/portage
        PORTDIR_OVERLAY=
        SYNC=
        USE=amd64 alsa_cards_ali5451 alsa_cards_als4000 alsa_cards_atiixp alsa_cards_atiixp-modem alsa_cards_bt87x alsa_cards_ca0106 alsa_cards_cmipci alsa_cards_emu10k1x alsa_cards_ens1370 alsa_cards_ens1371 alsa_cards_es1938 alsa_cards_es1968 alsa_cards_fm801 alsa_cards_hda-intel alsa_cards_intel8x0 alsa_cards_intel8x0m alsa_cards_maestro3 alsa_cards_trident alsa_cards_usb-audio alsa_cards_via82xx alsa_cards_via82xx-modem alsa_cards_ymfpci alsa_pcm_plugins_adpcm alsa_pcm_plugins_alaw alsa_pcm_plugins_asym alsa_pcm_plugins_copy alsa_pcm_plugins_dmix alsa_pcm_plugins_dshare alsa_pcm_plugins_dsnoop alsa_pcm_plugins_empty alsa_pcm_plugins_extplug alsa_pcm_plugins_file alsa_pcm_plugins_hooks alsa_pcm_plugins_iec958 alsa_pcm_plugins_ioplug alsa_pcm_plugins_ladspa alsa_pcm_plugins_lfloat alsa_pcm_plugins_linear alsa_pcm_plugins_meter alsa_pcm_plugins_mmap_emul alsa_pcm_plugins_mulaw alsa_pcm_plugins_multi alsa_pcm_plugins_null alsa_pcm_plugins_plug alsa_pcm_plugins_rate alsa_pcm_plugins_route alsa_pcm_plugins_share alsa_pcm_plugins_shm alsa_pcm_plugins_softvol apache2_modules_alias apache2_modules_auth_basic apache2_modules_auth_digest apache2_modules_authz_host apache2_modules_cgid apache2_modules_dav apache2_modules_dir apache2_modules_mime apache2_modules_php apache2_modules_rewrite apache2_mpms_worker calligra_features_braindump calligra_features_flow calligra_features_karbon calligra_features_kexi calligra_features_krita calligra_features_plan calligra_features_sheets calligra_features_stage calligra_features_tables calligra_features_words cameras_ptp2 collectd_plugins_df collectd_plugins_interface collectd_plugins_irq collectd_plugins_load collectd_plugins_memory collectd_plugins_rrdtool collectd_plugins_swap collectd_plugins_syslog elibc_glibc gpsd_protocols_aivdm gpsd_protocols_ashtech gpsd_protocols_earthmate gpsd_protocols_evermore gpsd_protocols_fv18 gpsd_protocols_garmin gpsd_protocols_garmintxt gpsd_protocols_gpsclock gpsd_protocols_itrax gpsd_protocols_mtk3301 gpsd_protocols_navcom gpsd_protocols_nmea gpsd_protocols_ntrip gpsd_protocols_oceanserver gpsd_protocols_oldstyle gpsd_protocols_oncore gpsd_protocols_rtcm104v2 gpsd_protocols_rtcm104v3 gpsd_protocols_sirf gpsd_protocols_superstar2 gpsd_protocols_timing gpsd_protocols_tnt gpsd_protocols_tripmate gpsd_protocols_tsip gpsd_protocols_ubx input_devices_evdev input_devices_keyboard input_devices_mouse input_devices_virtualbox kernel_linux lcd_devices_bayrad lcd_devices_cfontz lcd_devices_cfontz633 lcd_devices_glk lcd_devices_hd44780 lcd_devices_lb216 lcd_devices_lcdm001 lcd_devices_mtxorb lcd_devices_ncurses lcd_devices_text linguas_en linguas_en_US php_targets_php5-3 ruby_targets_ree18 ruby_targets_ruby18 userland_GNU video_cards_nouveau video_cards_nv video_cards_nvidia xtables_addons_account xtables_addons_chaos xtables_addons_condition xtables_addons_delude xtables_addons_dhcpmac xtables_addons_fuzzy xtables_addons_geoip xtables_addons_iface xtables_addons_ipmark xtables_addons_ipp2p xtables_addons_ipset xtables_addons_ipv4options xtables_addons_length2 xtables_addons_logmark xtables_addons_lscan xtables_addons_pknock xtables_addons_psd xtables_addons_quota2 xtables_addons_rawnat xtables_addons_steal xtables_addons_sysrq xtables_addons_tarpit xtables_addons_tee amd64 
        USE_PYTHON=
        >>> Done builtin_infovars
        >>> Completed ebuild phases initmisc infovars
        >>> Running ebuild phase tidyup as paludisbuild:paludisbuild...
        >>> Starting builtin_tidyup
        rm -fr /var/tmp/paludis/sys-libs-zlib-1.2.5-r2-info
        >>> Done builtin_tidyup
        >>> Completed ebuild phase tidyup




Comment 1


Carter Young





          2012-04-30 23:35:52 UTC
        

Strike through deponds on Added block.  Again I apologize for double posting




Comment 2


Mark Tomich





          2012-06-15 14:46:04 UTC
        

I've experienced the same problem you have, and according to http://www.techdot.org/2011/10/09/gentoo-irc-logs-10-08-2011/ (confirmed on my system), the root of the problem is that zlib needs to be built with the static-libs USE flag.




Comment 3


Samuli Suominen (RETIRED)






          2012-06-17 18:08:25 UTC
        

(In reply to comment #2)
> I've experienced the same problem you have, and according to
> http://www.techdot.org/2011/10/09/gentoo-irc-logs-10-08-2011/ (confirmed on
> my system), the root of the problem is that zlib needs to be built with the
> static-libs USE flag.

Then there is nothing left to do here since the ebuild has correct USE depend for zlib and static-libs:

splashutils-1.5.4.4-r1.ebuild: || ( <sys-libs/zlib-1.2.5.1-r2 sys-libs/zlib[static-libs] ) )









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

