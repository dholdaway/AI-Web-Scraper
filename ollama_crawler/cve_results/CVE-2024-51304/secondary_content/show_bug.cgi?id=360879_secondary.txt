Title: 360879 – net-fs/nfs-utils-1.2.3-r1 USE="nfsv3 -nfsv4" fails to mount NFSv3 shares
URL: https://bugs.gentoo.org/show_bug.cgi?id=360879

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 360879
net-fs/nfs-utils-1.2.3-r1 USE="nfsv3 -nfsv4" fails to mount NFSv3 shares
Last modified: 2013-03-24 20:20:39 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 360879 
      - net-fs/nfs-utils-1.2.3-r1 USE="nfsv3 -nfsv4" fails to mount NFSv3 shares


Summary:
net-fs/nfs-utils-1.2.3-r1 USE="nfsv3 -nfsv4" fails to mount NFSv3 shares
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Network Filesystems








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-03-28 07:43 UTC by Marek Królikowski





      Modified:
    
2013-03-24 20:20 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



rodrigo









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Marek Królikowski





          2011-03-28 07:43:12 UTC
        

After upgrade from net-fs/nfs-utils-1.1.4-r1 to net-fs/nfs-utils-1.2.3-r1 i can`t mount nfs from other Linux

Reproducible: Always

Steps to Reproduce:
1. umount /mnt/nfs
2. /etc/init.d/portmap stop
3. emerge -C portmap
4. emerge =net-fs/nfs-utils-1.2.3-r1 
5. etc-update
6. /etc/init.d/rpcbind start
7. mount /mnt/nfs
8. Got error after 5 minutes: mount.nfs: mount system call failed

Actual Results:  
mount.nfs: mount system call failed

Expected Results:  
Mouting NFS with no problem

WIZJA2 ~ # cat /etc/fstab
10.7.3.239:/backup2/wizja2    /mnt/nfs        nfs     rw      0    0




Comment 1


Marek Królikowski





          2011-03-28 07:53:27 UTC
        

WIZJA2 ~ # emerge -pv nfs-utils
These are the packages that would be merged, in order:
Calculating dependencies... done!
[ebuild   R   ] net-fs/nfs-utils-1.2.3-r1  USE="ipv6 nfsv3 tcpd -caps -kerberos -nfsv4" 0 kB

WIZJA2 ~ # mount -v /mnt/nfs/
mount.nfs: timeout set for Mon Mar 28 09:50:56 2011
mount.nfs: trying text-based options 'vers=4,addr=10.07.3.239,clientaddr=10.7.1.132'

Look he try use vers=4 - but there is -nfsv4 in flags....

I check from another machine with 1.1.4-r1:
PLK-POCZTA1 ~ # mount -v /mnt/nfs
mount.nfs: timeout set for Mon Mar 28 09:45:58 2011
mount.nfs: text-based options: 'addr=10.7.3.239'
mount.nfs: mount(2): Operation not supported
mount.nfs: trying 10.7.3.239 prog 100003 vers 3 prot UDP port 2049
mount.nfs: trying 10.7.3.239 prog 100005 vers 3 prot UDP port 1048
mount.nfs: text-based options (retry): 'addr=10.7.3.239,nfsvers=3,proto=udp,mountproto=udp,mountport=1048'

Did et-fs/nfs-utils ignore USE flags??




Comment 2


Marek Królikowski





          2011-03-28 08:55:07 UTC
        

Ok when i give to fstab option:
10.7.3.239:/backup2/wizja2    /mnt/nfs        nfs     rw,nfsvers=3      0    0
i can use mount -a and he mount NFS...
but when i reboot server netmount don`t mount NFS and i need do mount -a every restart...




Comment 3


Rafał Mużyło





          2011-03-28 12:48:13 UTC
        

Is this something like bug 295552 ?




Comment 4


Marek Królikowski





          2011-03-28 13:52:59 UTC
        

Yes and No :-)
Because this is about nfsv4 but if u see i compile nfs-utils with -nfsv4 but he still want mount nfs via nfsv4....
When i add to fstab nfsvers=3 it`s working...
But still not working netmount - i need mount -a every reboot server..




Comment 5


redneb





          2011-03-28 22:45:07 UTC
        

I have the same problem. After upgrading to net-fs/nfs-utils-1.2.3-r1, /etc/init.d/netmount does not work in any of my machines. I have to do a mount -a every time.




Comment 6


Marek Królikowski





          2011-03-29 05:04:21 UTC
        

After:
1. umount /mnt/nfs
2. /etc/init.d/portmap stop
3. emerge -C portmap
4. emerge =net-fs/nfs-utils-1.2.3-r1 
5. etc-update
6. /etc/init.d/rpcbind start
7. add nfsvers=3 to fstab
8. mount /mnt/nfs
9. reboot

Server can`t reboot " halt on umounting file systems" - need turn off from hand.
After next reboot server restarting with no problem.




Comment 7


Jeroen Roovers (RETIRED)






          2011-03-29 23:36:47 UTC
        

It would help to know what the NFS server is configured with and what it is exporting (/etc/exports).




Comment 8


Marek Królikowski





          2011-03-30 05:00:04 UTC
        

NAS ~ # emerge -pv nfs-utils
[ebuild   R   ] net-fs/nfs-utils-1.1.4-r1  USE="tcpd nfsv3 -kerberos -nonfsv4 -caps -ipv6 -nfsv4"

NAS ~ # cat /etc/exports
# /etc/exports: NFS file systems being exported.  See exports(5).
/nfs   10.7.0.0/255.255.0.0(rw,no_root_squash,sync,no_subtree_check)




Comment 9


Rodrigo Severo





          2011-03-30 21:42:46 UTC
        

After all I believe this is a duplicate of bug #295552.

Please take a look there for the proposed solution.




Comment 10


SpanKY






          2013-03-24 20:20:39 UTC
        

if you want things to mount at boot, use nfsmount init.d, not netmount.  the latter is meant only for simple cases, not the full nfs stack.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

