Title: 233365 – When gnome starts the keyboard layout is english, although only german should be active and is indicated
URL: https://bugs.gentoo.org/show_bug.cgi?id=233365

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 233365
When gnome starts the keyboard layout is english, although only german should be active and is indicated
Last modified: 2009-02-07 16:21:46 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 233365 
      - When gnome starts the keyboard layout is english, although only german should be active and is indicated


Summary:
When gnome starts the keyboard layout is english, although only german should...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-07-30 10:08 UTC by Florian Streibelt





      Modified:
    
2009-02-07 16:21 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



x11









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Xorg-Logfile as requested

              (Xorg.0.log,36.78 KB,
                text/plain)

            
2008-07-30 12:48 UTC,

            Florian Streibelt




Details





Xorg-Config as requested

              (xorg.conf,2.11 KB,
                text/plain)

            
2008-07-30 12:49 UTC,

            Florian Streibelt




Details





/etc/hal/fdi/policy/10-x11-input.fdi 

              (10-x11-input.fdi,3.26 KB,
                text/plain)

            
2008-07-30 14:52 UTC,

            Florian Streibelt




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Florian Streibelt





          2008-07-30 10:08:22 UTC
        

After my last update of ~amd portage, world and system yesternday, when I start Gnome the keyboard-layout is english. 

But gnome-keyboard-applet indicates it is "Deu"=German. When starting up the applet and configure the keyboad I can not make german to be the 'default' - the option box behind it stays grey.

When trying to 'show the layout' via the keyboard-applet it shows me a white space. 

When adding the german layout a second time (It is already listed) at least I get a german layout and I can 'show' the layout again. (No white dialog)

In my xorg.conf The kbd is set to be 'de'. Should work.




Reproducible: Always

Steps to Reproduce:
1.configure xorg with german layout?
2. configure gnome with german kbd-layout, delete the others from the list
3. restart gnome.

Actual Results:  
english keyboard layout

Expected Results:  
german keyboard layout ;)

An emerge --update shouldn't do such ;)




Comment 1


Florian Streibelt





          2008-07-30 10:47:13 UTC
        

ohh - and it seems without any warning the layout switches randomly back to english, the applet still indicates german layout.




Comment 2


Rémi Cardona (RETIRED)






          2008-07-30 12:40:54 UTC
        

A couple things :

1) please attach both your xorg.conf and Xorg.0.log files here
2) please try clicking on the "Reset to default" button in the Keyboard properties

Thanks




Comment 3


Florian Streibelt





          2008-07-30 12:48:41 UTC
        

Created attachment 161709 [details]
Xorg-Logfile as requested




Comment 4


Florian Streibelt





          2008-07-30 12:49:31 UTC
        

Created attachment 161711 [details]
Xorg-Config as requested




Comment 5


Florian Streibelt





          2008-07-30 12:52:52 UTC
        

okay, when I click on Reset to defaults (or 'Vorgabewerte') the layout is switched to 'USA' and the german layout is removed. 

The last checkbox 'default' is still not set, and when adding german as a layout I still can not make one of those to be the default.

In the meantime I removed the keyboard-applet from my panel, I think at least the random switching of the layout to us has not occured since I did that.

strange...







Comment 6


Rémi Cardona (RETIRED)






          2008-07-30 13:17:47 UTC
        

From your Xorg.0.log (near the end):

[snip]
(**) AT Translated Set 2 keyboard: always reports core events
(**) AT Translated Set 2 keyboard: Device: "/dev/input/event0"
(II) AT Translated Set 2 keyboard: Found keys
(II) AT Translated Set 2 keyboard: Configuring as keyboard
(II) XINPUT: Adding extended input device "AT Translated Set 2 keyboard" (type: KEYBOARD)
(**) Option "xkb_rules" "base"
(**) AT Translated Set 2 keyboard: xkb_rules: "base"
(**) Option "xkb_model" "evdev"
(**) AT Translated Set 2 keyboard: xkb_model: "evdev"
(**) Option "xkb_layout" "us"
(**) AT Translated Set 2 keyboard: xkb_layout: "us"
[snip]

So you have 3 solutions :
1) kill off HAL in Xorg : `USE=-hal emerge -1 xorg-server`
2) disable HAL in Xorg : add Option "AutoAddDevices" "off" in your ServerLayout
3) properly configure HAL : http://who-t.blogspot.com/2008/07/input-configuration-in-nutshell.html

Option #2 should be more than enough for now.




Comment 7


Florian Streibelt





          2008-07-30 14:52:07 UTC
        

Created attachment 161724 [details]
/etc/hal/fdi/policy/10-x11-input.fdi 

this file was empty initially.




Comment 8


Florian Streibelt





          2008-07-30 14:53:52 UTC
        

maybe a solution.

AutoAddDevices" "off" in your ServerLayout
is not supported by my Xorg. It refuses to start.

So I tried to configure my hal/x with evdev.

I took the x11-input.fdi linked on http://who-t.blogspot.com/2008/07/input-configuration-in-nutshell.html. The file already existed on my system, but was empty.

I added another match-section found on the internet for the layout. Dunno if that is needed.

I then changed the kbd-driver in my xorg.conf to evdev

for my normal window-manager I set in .xinitrc:
 setxkbmap de
to get german layout, gnome automagically found I use a evdev-managed keyboard.

Thanks for the hint on evdev!





Comment 9


Gilles Dartiguelongue (RETIRED)






          2008-11-22 00:15:14 UTC
        

@x11, could you give a hand here ?




Comment 10


Rémi Cardona (RETIRED)






          2008-11-22 19:20:22 UTC
        

(In reply to comment #8)
> AutoAddDevices" "off" in your ServerLayout
> is not supported by my Xorg. It refuses to start.

Could you attach your xorg.conf? This option is very well supported since 1.4.

Thanks




Comment 11


Gilles Dartiguelongue (RETIRED)






          2009-01-28 23:15:52 UTC
        

please get back to us.




Comment 12


Gilles Dartiguelongue (RETIRED)






          2009-01-28 23:16:59 UTC
        

meh, what am I doing... So how is this bug progressing ?




Comment 13


Florian Streibelt





          2009-02-07 16:21:46 UTC
        

(In reply to comment #12)
> meh, what am I doing... So how is this bug progressing ?
> 

hmm. It works for me now, at it seems I don't get any email from bugs.gentoo.org into my account.  auuughh!!! See comment #8, creating the file solved it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

