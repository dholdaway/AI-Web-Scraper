Title: 544006 – sys-devel/llvm: use of multibuild_merge_root causes 2x increase in required install space
URL: https://bugs.gentoo.org/show_bug.cgi?id=544006

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 544006
sys-devel/llvm: use of multibuild_merge_root causes 2x increase in required install space
Last modified: 2018-03-29 07:51:10 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 544006 
      - sys-devel/llvm: use of multibuild_merge_root causes 2x increase in required install space


Summary:
sys-devel/llvm: use of multibuild_merge_root causes 2x increase in required i...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

LLVM support project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2015-03-21 10:23 UTC by SpanKY





      Modified:
    
2018-03-29 07:51 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



candrews
galtgendo
mgorny
multilib+disabled









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info llvm

              (emerge-info.log,28.02 KB,
                text/plain)

            
2015-03-21 10:23 UTC,

            SpanKY




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


SpanKY






          2015-03-21 10:23:31 UTC
        

Created attachment 399356 [details]
emerge --info llvm

what should take ~8G to install is doubled because of the use of multibuild_merge_root in llvm.  which means the peak disk requirement for llvm w/clang enabled with a single ABI is now ~30G.

i've got a tmpfs mounted on /var/tmp/portage that normally is set to 20G.  to install llvm, i need to up that to 30G.  the partial failure shows:
# cd /var/tmp/portage/sys-devel/llvm-3.6.0/image
# du . --max-depth=1 -h
6.8G    ./usr
7.7G    ./_amd64
15G     .

it's probably not llvm specific ... multibuild_merge_root wastes a lot of time everywhere using `cp` especially in the single ABI case




Comment 1


Michał Górny









          2018-03-29 07:51:10 UTC
        

Unless you have a *good* patch, there's nothing I can do about it. You can get a better filesystem to make use of reflinking.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

