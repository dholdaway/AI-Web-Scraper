Title: 139504 – app-crypt/gnupg-1.9.21 fails to compile
URL: https://bugs.gentoo.org/show_bug.cgi?id=139504

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 139504
app-crypt/gnupg-1.9.21 fails to compile
Last modified: 2006-08-25 10:07:03 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 139504 
      - app-crypt/gnupg-1.9.21 fails to compile


Summary:
app-crypt/gnupg-1.9.21 fails to compile
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Crypto team [DISABLED]








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-07-06 18:34 UTC by Jon Hood (RETIRED)





      Modified:
    
2006-08-25 10:07 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



amd64









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jon Hood (RETIRED)






          2006-07-06 18:34:16 UTC
        

x86_64-pc-linux-gnu-gcc    -march=athlon64 -O3 -pipe -fomit-frame-pointer -funroll-loops -Wall  -Wl,-z,now -o gpgconf  gpgconf.o gpgconf-comp.o no-libgcrypt.o ../jnlib/libjnlib.a ../common/libcommon.a ../gl/libgnu.a  -L/usr/lib64 -lgpg-error -ldl
rfc822parse.c: In function 'insert_header':
rfc822parse.c:435: warning: pointer targets in passing argument 1 of '__builtin_strchr' differ in signedness
rfc822parse.c: In function 'rfc822parse_get_field':
rfc822parse.c:545: warning: pointer targets in passing argument 1 of 'strlen' differ in signedness
rfc822parse.c:547: warning: pointer targets in passing argument 1 of 'strlen' differ in signedness
rfc822parse.c:552: warning: pointer targets in passing argument 2 of '__builtin_stpcpy' differ in signedness
rfc822parse.c:556: warning: pointer targets in passing argument 2 of '__builtin_stpcpy' differ in signedness
rfc822parse.c: In function 'rfc822parse_enum_header_lines':
rfc822parse.c:604: warning: pointer targets in return differ in signedness
rfc822parse.c: In function 'find_header':
rfc822parse.c:657: warning: pointer targets in passing argument 1 of '__builtin_strchr' differ in signedness
rfc822parse.c:657: warning: pointer targets in assignment differ in signedness
rfc822parse.c: In function 'parse_field':
rfc822parse.c:770: warning: pointer targets in initialization differ in signedness
rfc822parse.c:771: warning: pointer targets in initialization differ in signedness
rfc822parse.c:772: warning: pointer targets in initialization differ in signedness
rfc822parse.c:790: warning: pointer targets in passing argument 1 of '__builtin_strchr' differ in signedness
rfc822parse.c:790: warning: pointer targets in assignment differ in signedness
rfc822parse.c:878: warning: pointer targets in passing argument 2 of 'append_to_token' differ in signedness
rfc822parse.c:879: warning: pointer targets in passing argument 2 of 'new_token' differ in signedness
rfc822parse.c:894: warning: pointer targets in assignment differ in signedness
rfc822parse.c:897: warning: pointer targets in passing argument 2 of 'new_token' differ in signedness
rfc822parse.c:907: warning: pointer targets in passing argument 1 of 'skip_ws' differ in signedness
rfc822parse.c:907: warning: pointer targets in assignment differ in signedness
rfc822parse.c:915: warning: pointer targets in passing argument 2 of 'new_token' differ in signedness
rfc822parse.c: In function 'rfc822parse_query_parameter':
rfc822parse.c:1036: warning: pointer targets in passing argument 1 of 'lowercase_string' differ in signedness
rfc822parse.c:1047: warning: pointer targets in passing argument 1 of 'lowercase_string' differ in signedness
rfc822parse.c: In function 'rfc822parse_query_media_type':
rfc822parse.c:1075: warning: pointer targets in passing argument 1 of 'lowercase_string' differ in signedness
rfc822parse.c:1090: warning: pointer targets in passing argument 1 of 'lowercase_string' differ in signedness
x86_64-pc-linux-gnu-gcc    -march=athlon64 -O3 -pipe -fomit-frame-pointer -funroll-loops -Wall  -Wl,-z,now -o gpg-connect-agent  gpg-connect-agent.o no-libgcrypt.o ../jnlib/libjnlib.a ../common/libcommon.a ../gl/libgnu.a -L/usr/lib64 -lassuan -L/usr/lib64 -lgpg-error  -ldl
x86_64-pc-linux-gnu-gcc    -march=athlon64 -O3 -pipe -fomit-frame-pointer -funroll-loops -Wall  -Wl,-z,now -o gpgkey2ssh  gpgkey2ssh-gpgkey2ssh.o ../jnlib/libjnlib.a ../common/libcommon.a ../gl/libgnu.a -L/usr/lib64 -lgcrypt -L/usr/lib64 -lgpg-error -L/usr/lib64 -lgpg-error -ldl
x86_64-pc-linux-gnu-gcc    -march=athlon64 -O3 -pipe -fomit-frame-pointer -funroll-loops -Wall  -Wl,-z,now -o gpgparsemail  gpgparsemail.o rfc822parse.o  -ldl
x86_64-pc-linux-gnu-gcc    -march=athlon64 -O3 -pipe -fomit-frame-pointer -funroll-loops -Wall  -Wl,-z,now -o symcryptrun  symcryptrun.o  ../jnlib/libjnlib.a ../common/libcommon.a ../gl/libgnu.a ../common/libsimple-pwquery.a -L/usr/lib64 -lgcrypt -L/usr/lib64 -lgpg-error -L/usr/lib64 -lgpg-error  -ldl
x86_64-pc-linux-gnu-gcc    -march=athlon64 -O3 -pipe -fomit-frame-pointer -funroll-loops -Wall  -Wl,-z,now -o watchgnupg  watchgnupg.o  -ldl
symcryptrun.o: In function `confucius_process':
symcryptrun.c:(.text+0x92d): undefined reference to `openpty'
symcryptrun.c:(.text+0x9a9): undefined reference to `login_tty'
collect2: ld returned 1 exit status

# emerge --info
Portage 2.1.1_pre2-r4 (default-linux/amd64/2005.1, gcc-4.1.1/amd64-vanilla, glibc-2.4-r3, 2.6.15-gentoo-r5 x86_64)
=================================================================
System uname: 2.6.15-gentoo-r5 x86_64 AMD Athlon(tm) 64 X2 Dual Core Processor 4200+
Gentoo Base System version 1.12.1
dev-lang/python:     2.3.5-r2, 2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.17
sys-devel/gcc-config: 2.0.0_rc1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.16
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64 -O3 -pipe -fomit-frame-pointer -funroll-loops"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib64/mozilla/defaults/pref /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/eselect/compiler /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=athlon64 -O3 -pipe -fomit-frame-pointer -funroll-loops"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer multilib-strict sandbox sfperms strict test"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="amd64 X alsa apache2 arts avi berkdb bitmap-fonts browserplugin bzip2 cdinstall cli crypt css cups curl curlwrappers dba dlloader dri dvd dvdr dvdread eds emboss encode ffmpeg firefox flash foomaticdb fortran ftp gd gif glibc-omitfp glitz gnome gpm gstreamer gtk gtk2 imagemagick imlib ipv6 isdnlog java jpeg kde kerberos ldap lucene lzw lzw-tiff mad mjpeg mp3 mpeg mysql ncurses nls nptl nptlonly nsplugin nvidia ogg opengl pam pascal pcntl pcre pdflib perl php png posix postgres ppds pppd python qt qt3 qt4 quicktime readline reflection ruby samba sdl session sox spell spl sql ssl subversion tcpd threads tiff truetype truetype-fonts type1-fonts unicode usb userlocales vcd vorbis wmf xml xml2 xmlrpc xmms xorg xpm xv xvid zip zlib elibc_glibc input_devices_keyboard input_devices_mouse input_devices_evdev kernel_linux userland_GNU video_cards_nvidia video_cards_nv"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Jory A. Pratt





          2006-07-06 18:37:42 UTC
        

This is not true.

     Thu Jun 29 21:02:34 2006 >>> app-crypt/gnupg-1.9.21
       merge time: 3 minutes and 31 seconds.


     Sun Jun 18 23:23:46 2006 >>> sys-libs/glibc-2.4-r3
       merge time: 4 hours, 52 minutes and 11 seconds.

     Mon Jun 19 14:26:46 2006 >>> sys-libs/glibc-2.4-r3
       merge time: 4 hours, 50 minutes and 31 seconds.

     Sat Jun 24 22:58:16 2006 >>> sys-libs/glibc-2.4-r3
       merge time: 2 hours, 3 minutes and 44 seconds.

I will dig threw it all a bit later but it is NOT a glibc issue at all.




Comment 2


Jory A. Pratt





          2006-07-06 18:40:36 UTC
        

your undefined references come back to shadow package for a quick start. I will see what we can do to prevent such failure in the future tho.




Comment 3


Robin Johnson









          2006-07-06 21:00:43 UTC
        

I'm running glibc-2.4-r3 and gnupg-1.9.21 perfectly fine here (ppc64-32ul, ~ppc).
I'm suspecting this is an error with your toolchain or glibc.

Your machine is leaving out libutil that is provided by glibc for some reason.

Here's the error that failed on your box:
x86_64-pc-linux-gnu-gcc    -march=athlon64 -O3 -pipe -fomit-frame-pointer
-funroll-loops -Wall  -Wl,-z,now -o symcryptrun  symcryptrun.o 
../jnlib/libjnlib.a ../common/libcommon.a ../gl/libgnu.a
../common/libsimple-pwquery.a -L/usr/lib64 -lgcrypt -L/usr/lib64 -lgpg-error
-L/usr/lib64 -lgpg-error  -ldl
symcryptrun.o: In function `confucius_process':
symcryptrun.c:(.text+0x92d): undefined reference to `openpty'
symcryptrun.c:(.text+0x9a9): undefined reference to `login_tty'
collect2: ld returned 1 exit status

Here's the same thing passing on my machine:
if gcc -DHAVE_CONFIG_H -I. -I. -I..  -I../gl -I../intl -I../common -DLOCALEDIR=\"/usr/local/share/locale\" -DGNUPG_BINDIR="\"/usr/local/bin\"" -DGNUPG_LIBEXECDIR="\"/usr/local/libexec\"" -DGNUPG_LIBDIR="\"/usr/local/lib/gnupg\"" -DGNUPG_DATADIR="\"/usr/local/share/gnupg\"" -DGNUPG_SYSCONFDIR="\"/usr/local/etc/gnupg\""          -g -O2 -Wall -MT symcryptrun.o -MD -MP -MF ".deps/symcryptrun.Tpo" -c -o symcryptrun.o symcryptrun.c; \
	then mv -f ".deps/symcryptrun.Tpo" ".deps/symcryptrun.Po"; else rm -f ".deps/symcryptrun.Tpo"; exit 1; fi
gcc    -g -O2 -Wall   -o symcryptrun  symcryptrun.o -lutil ../jnlib/libjnlib.a ../common/libcommon.a ../gl/libgnu.a ../common/libsimple-pwquery.a -lgcrypt -lgpg-error -lgpg-error  -ldl 





Comment 4


Jon Hood (RETIRED)






          2006-08-19 08:53:08 UTC
        

Well, it looks to be a glibc issue then, but no one can help me. While most applications are fine, some like samba and gnupg have these issues. Glibc won't even pass its tests, and when I disable tests, it leaves me with an unusable system.

GCONV_PATH=/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/iconvdata LC_ALL=C   /var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/elf/ld-linux.so.2 --library-path /var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/math:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/elf:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/dlfcn:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/nss:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/nis:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/rt:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/resolv:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/crypt:/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/nptl /var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/math/test-double  > /var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/math/test-double.out
make[2]: *** [/var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/math/test-double.out] Error 1
make[2]: Leaving directory `/var/tmp/portage/glibc-2.4-r3/work/glibc-2.4/math'
make[1]: *** [math/tests] Error 2
make[1]: Leaving directory `/var/tmp/portage/glibc-2.4-r3/work/glibc-2.4'
make: *** [check] Error 2

...

# cat /var/tmp/portage/glibc-2.4-r3/work/build-x86-x86_64-pc-linux-gnu-nptl/math/test-double.out
testing double (without inline functions)
Failure: Real part of: csin (NaN + NaN i) == NaN + NaN i: Exception "Invalid operation" set

Test suite completed:
  2626 test cases plus 2401 tests for exception flags executed.
  1 errors occurred.




Comment 5


Simon Stelling (RETIRED)






          2006-08-25 10:07:03 UTC
        

Can't confirm either here. I guess your system is messed up :|









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

