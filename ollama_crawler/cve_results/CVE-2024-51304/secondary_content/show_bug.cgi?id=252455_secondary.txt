Title: 252455 – xine-lib-1.1.15-r1 doesn't build after ffmpeg upgrade (postprocess.h: No such file or directory)
URL: https://bugs.gentoo.org/show_bug.cgi?id=252455

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 252455
xine-lib-1.1.15-r1 doesn't build after ffmpeg upgrade (postprocess.h: No such file or directory)
Last modified: 2009-01-03 13:56:25 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 252455 
      - xine-lib-1.1.15-r1 doesn't build after ffmpeg upgrade (postprocess.h: No such file or directory)


Summary:
xine-lib-1.1.15-r1 doesn't build after ffmpeg upgrade (postprocess.h: No such...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Media-video project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-12-25 06:45 UTC by Konstantin Agouros





      Modified:
    
2009-01-03 13:56 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



pchrist
relson









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Konstantin Agouros





          2008-12-25 06:45:14 UTC
        

after the upgrade of ffmpeg xine-lib deos not build anymore. Maybe it's an unlucky combination of use flags.

Reproducible: Always

Steps to Reproduce:
1. emerge xine-lib
2.
3.

Actual Results:  
../../../include/xine.h:2230: warning: 'xine_tvsystem' is deprecated
pp.c:33:27: i686-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I../../../include -I../../.. -I../../../include -I../../../include -I../../../src -I../../../src/xine-engine -I../../../src/xine-engine -I../../../src/xine-utils -I../../../src/input -I../../../src/input -I../../../lib -I../../../lib -fvisibility=hidden -fomit-frame-pointer -D_REENTRANT -D_FILE_OFFSET_BITS=64 -DXINE_COMPILE -Wformat=2 -Wno-format-zero-length -Wmissing-format-attribute -Werror-implicit-function-declaration -Wstrict-aliasing=2 -march=athlon-xp -O3 -pipe -frename-registers -ffunction-sections -DNDEBUG -c noise.c  -fPIC -DPIC -o .libs/xineplug_post_planar_la-noise.o
 error: postprocess.h: No such file or directory
pp.c:59: error: 'PP_QUALITY_MAX' undeclared here (not in a function)
pp.c:79: error: expected specifier-qualifier-list before 'pp_context_t'
pp.c: In function 'set_parameters':
pp.c:90: error: 'post_plugin_pp_t' has no member named 'lock'
pp.c:90: warning: passing argument 1 of 'pthread_mutex_lock' from incompatible pointer type
pp.c:94: error: 'post_plugin_pp_t' has no member named 'lock'
pp.c:94: warning: passing argument 1 of 'pthread_mutex_unlock' from incompatible pointer type
pp.c: In function 'get_help':
pp.c:127: error: 'pp_help' undeclared (first use in this function)
pp.c:127: error: (Each undeclared identifier is reported only once
pp.c:127: error: for each function it appears in.)
pp.c:127: warning: format '%s' expects type 'char *', but argument 5 has type 'struct xine_post_api_parameter_t *'
pp.c: In function 'pp_open_plugin':
pp.c:197: error: 'PP_FORMAT_420' undeclared (first use in this function)
pp.c:197: warning: assignment makes integer from pointer without a cast
pp.c:199: error: 'PP_CPU_CAPS_MMX' undeclared (first use in this function)
pp.c:199: error: invalid operands to binary |
pp.c:199: error: incompatible types in assignment
pp.c:201: error: 'PP_CPU_CAPS_MMX2' undeclared (first use in this function)
pp.c:201: error: invalid operands to binary |
pp.c:201: error: incompatible types in assignment
pp.c:203: error: 'PP_CPU_CAPS_3DNOW' undeclared (first use in this function)
pp.c:203: error: invalid operands to binary |
pp.c:203: error: incompatible types in assignment
pp.c:205: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:206: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c:208: error: 'post_plugin_pp_t' has no member named 'lock'
pp.c:208: warning: passing argument 1 of 'pthread_mutex_init' from incompatible pointer type
pp.c: In function 'pp_dispose':
pp.c:251: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:252: error: implicit declaration of function 'pp_free_mode'
pp.c:252: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:253: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:255: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c:256: error: implicit declaration of function 'pp_free_context'
pp.c:256: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c:257: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c: In function 'pp_draw':
pp.c:305: error: 'post_plugin_pp_t' has no member named 'lock'
pp.c:305: warning: passing argument 1 of 'pthread_mutex_lock' from incompatible pointer type
pp.c:307: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c:315: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c:316: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c:318: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c:318: error: implicit declaration of function 'pp_get_context'
pp.c:320: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:321: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:322: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:326: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:327: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:327: error: implicit declaration of function 'pp_get_mode_by_name_and_quality'
pp.c:330: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:331: error: implicit declaration of function 'pp_postprocess'
pp.c:335: error: 'post_plugin_pp_t' has no member named 'pp_mode'
pp.c:335: error: 'post_plugin_pp_t' has no member named 'pp_context'
pp.c:338: error: 'post_plugin_pp_t' has no member named 'lock'
pp.c:338: warning: passing argument 1 of 'pthread_mutex_unlock' from incompatible pointer type
pp.c:340: error: 'post_plugin_pp_t' has no member named 'pp_mode'
distcc[2380] ERROR: compile pp.c on localhost failed
make[3]: *** [xineplug_post_planar_la-pp.lo] Error 1
make[3]: *** Waiting for unfinished jobs....
In file included from ../../../src/xine-engine/xine_internal.h:34,
                 from unsharp.c:25:
../../../include/xine.h:2230: warning: 'xine_tvsystem' is deprecated
In file included from ../../../src/xine-engine/xine_internal.h:34,
                 from noise.c:25:
../../../include/xine.h:2230: warning: 'xine_tvsystem' is deprecated
In file included from ../../../src/xine-engine/xine_internal.h:34,
                 from boxblur.c:25:
../../../include/xine.h:2230: warning: 'xine_tvsystem' is deprecated
make[3]: Leaving directory `/var/tmp/portage/media-libs/xine-lib-1.1.15-r1/work/xine-lib-1.1.15/src/post/planar'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/media-libs/xine-lib-1.1.15-r1/work/xine-lib-1.1.15/src/post'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-libs/xine-lib-1.1.15-r1/work/xine-lib-1.1.15/src'
make: *** [all-recursive] Error 1
 * 
 * ERROR: media-libs/xine-lib-1.1.15-r1 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 2702:  Called die
 * The specific snippet of code:
 *       emake || die "emake failed."
 *  The die message:
 *   emake failed.
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/var/tmp/portage/media-libs/xine-lib-1.1.15-r1/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/media-libs/xine-lib-1.1.15-r1/temp/environment'.
 * 

 * Messages for package media-libs/xine-lib-1.1.15-r1:

 * 
 * ERROR: media-libs/xine-lib-1.1.15-r1 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 2702:  Called die
 * The specific snippet of code:
 *       emake || die "emake failed."
 *  The die message:
 *   emake failed.
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/var/tmp/portage/media-libs/xine-lib-1.1.15-r1/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/media-libs/xine-lib-1.1.15-r1/temp/environment'.
 * 


Expected Results:  
success full build

emerge --info: 
Portage 2.1.4.5 (default/linux/x86/2008.0, gcc-4.1.2, glibc-2.6.1-r0, 2.6.26-gentoo-r4-64bit x86_64)
=================================================================
System uname: 2.6.26-gentoo-r4-64bit x86_64 AMD Athlon(tm) 64 Processor 3200+
Timestamp of tree: Wed, 24 Dec 2008 17:05:01 +0000
distcc 3.0 i686-pc-linux-gnu [enabled]
app-shells/bash:     3.2_p33
dev-java/java-config: 1.3.7-r1, 2.1.6-r1
dev-lang/python:     2.4.4-r13, 2.5.2-r7
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.7.8-r1, 1.12.11.1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r2
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.1-r1
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=athlon-xp -O3 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib/mozilla/defaults/pref /usr/share/config /var/bind"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-march=athlon-xp -O3 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="distcc distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://pandemonium.tiscali.de/pub/gentoo/ http://mirror.ovh.net/gentoo-distfiles/ http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/ http://mirror.muntinternet.net/pub/gentoo/ http://mirror.qubenet.net/mirror/gentoo/"
LDFLAGS="-Wl,-O1"
LINGUAS="en de el"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow X acl amr asf berkdb bzip2 caps cli cracklib crypt cups divx4linux dlloader dri emacs encode firefox fortran gdbm gnome gpm gtk gtk2 hbci iconv imap imlib ipv6 isdnlog java jpeg ldap loop-aes mbox midi mmx mozcalendar mpeg mudflap ncurses nls nptl nptlonly nsplugin old-crypt opengl openmp oss pam pcre pdf perl png postgres pppd python quicktime readline reflection sdk server session spl sse ssl sysfs tcpd truetype unicode v4l win32codecs x86 xorg xvid zlib" ALSA_CARDS="emu10k1" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en de el" USERLAND="GNU" VIDEO_CARDS="nv nvidia vesa fbdev"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


Panagiotis Christopoulos (RETIRED)






          2008-12-25 11:50:58 UTC
        

Please submit your "emerge -pv ffmpeg xine-lib" output. Also, your "find /usr/include/ -name "postprocess.h" " output. 




Comment 2


Konstantin Agouros





          2008-12-25 18:21:02 UTC
        

# emerge -pv ffmpeg xine-lib

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] media-video/ffmpeg-0.4.9_p20081014  USE="X amr encode ipv6 mmx v4l x264 xvid zlib -aac (-altivec) -bindist -debug -dirac -doc -gsm -hardcoded-tables -ieee1394 -mmxext -mp3 -network -schroedinger -sdl -ssse3 -test -theora -threads -v4l2 -vhook -vorbis" 0 kB 
[ebuild   R   ] media-libs/xine-lib-1.1.15-r1  USE="X a52 aac aalib alsa arts directfb dts dvd dxr3 esd fbcon flac gnome gtk imagemagick ipv6 libcaca mad mng modplug musepack nls opengl oss samba sdl speex theora truetype v4l vidix vorbis win32codecs xcb xinerama xv xvmc (-altivec) -debug -jack -mmap -pulseaudio (-real) -vcd (-vis) -wavpack" 0 kB 

 # find /usr/include/ -name "postprocess.h"
/usr/include/libpostproc/postprocess.h






Comment 3


Panagiotis Christopoulos (RETIRED)






          2008-12-25 18:37:21 UTC
        

Can you give a try with distcc disabled?




Comment 4


Konstantin Agouros





          2008-12-25 20:34:31 UTC
        

tried without and had the same problem.




Comment 5


David Relson





          2009-01-03 01:48:01 UTC
        

An interesting situation!  The problem appears to be bad pathing when looking for postprocess.h

"find /usr/include -name postprocess.h" reports:

  /usr/include/postproc/postprocess.h
  /usr/include/libpostproc/postprocess.h

The compilation command (and error) are:

 x86_64-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I../../../include -I../../.. -I../../../include -I../../../include -I../../../src -I../../../src/xine-engine -I../../../src/xine-engine -I../../../src/xine-utils -I../../../src/input -I../../../src/input -I../../../lib -I../../../lib -fvisibility=hidden -fomit-frame-pointer -D_REENTRANT -D_FILE_OFFSET_BITS=64 -DXINE_COMPILE -Wformat=2 -Wno-format-zero-length -Wmissing-format-attribute -Werror-implicit-function-declaration -Wstrict-aliasing=2 -march=athlon64 -O2 -pipe -msse3 -frename-registers -ffunction-sections -DNDEBUG -c noise.c  -fPIC -DPIC -o .libs/xineplug_post_planar_la-noise.o
pp.c:33:27: error: postprocess.h: No such file or directory

Note that "postproc" isn't included in any of the "-I" directives.

In pp.c is the following:

#ifdef HAVE_FFMPEG_AVUTIL_H
#  include <postprocess.h>
#else
#  include <libpostproc/postprocess.h>
#endif

In configure.h is:

/* Define to 1 if you have the <ffmpeg/avutil.h> header file. */
#define HAVE_FFMPEG_AVUTIL_H 1


Together these cause gcc to look for <postprocess.h> (rather than libpostproc/postprocess.h).  However, as noted above, gcc is looking for .../include/postprocess.h, not include/libpostproc/postprocess.h





Comment 6


Konstantin Agouros





          2009-01-03 08:05:36 UTC
        

I found the problem (finally):

I had an old installation of ffmpeg in /usr/local/. As /usr/local/include was in the search path this caused the trouble.

mv /usr/local/include /usr/local/include_ ; emerge xine-lib 

solved the problem. Sorry for the confusion.

Kontantin




Comment 7


David Relson





          2009-01-03 13:54:50 UTC
        

Old, orphaned installations appear to have been my problem :-<

All is good now!






Comment 8


Alexis Ballier






          2009-01-03 13:56:25 UTC
        

(In reply to comment #7)
> Old, orphaned installations appear to have been my problem :-<
> 
> All is good now!
> 

closing then









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

