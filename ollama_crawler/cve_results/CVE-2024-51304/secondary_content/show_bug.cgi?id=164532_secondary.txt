Title: 164532 – emerge-webrsync requires >=coreutils-6.4 for date command
URL: https://bugs.gentoo.org/show_bug.cgi?id=164532

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 164532
emerge-webrsync requires >=coreutils-6.4 for date command
Last modified: 2008-02-17 20:55:32 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 164532 
      - emerge-webrsync requires >=coreutils-6.4 for date command


Summary:
emerge-webrsync requires >=coreutils-6.4 for date command
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Tools

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:




144509



Blocks:







 

        Show dependency tree





 





      Reported:
    
2007-01-30 11:57 UTC by edjunior





      Modified:
    
2008-02-17 20:55 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



esigra









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




test success of the -r option to distinguish between gnu and bsd date

              (date.patch,1.05 KB,
                patch)

            
2007-01-30 22:50 UTC,

            Zac Medico




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


edjunior





          2007-01-30 11:57:10 UTC
        

When I executed emerge-webrsync, it returns a error with 'date' command and can't find a correct file to download (it looks for 'portage-.tar.bz2.md5sum', for example).

Reproducible: Always




I guess I found the piece of code modified on rev. 5154 (http://sources.gentoo.org/viewcvs.py/portage/main/trunk/bin/emerge-webrsync?rev=5154&view=diff&r1=5154&r2=5153&p1=main/trunk/bin/emerge-webrsync&p2=/main/trunk/bin/emerge-webrsync)




Comment 1


Harald van Dijk (RETIRED)






          2007-01-30 12:40:53 UTC
        

So, what's the error you get? Also, please always provide your emerge --info.




Comment 2


Zac Medico






          2007-01-30 21:48:37 UTC
        

I see how that revision would be a problem if the portage tree is empty and hence USERLAND is unknown.




Comment 3


Zac Medico






          2007-01-30 22:50:38 UTC
        

Created attachment 108691 [details, diff]
test success of the -r option to distinguish between gnu and bsd date

This is fixed in svn r5840.




Comment 4


Zac Medico






          2007-01-31 02:18:48 UTC
        

(In reply to comment #0)
> When I executed emerge-webrsync, it returns a error with 'date' command and
> can't find a correct file to download (it looks for 'portage-.tar.bz2.md5sum',
> for example).

Actually, portage initializes USERLAND even without the portage tree, so I'm not sure what may have caused that error.  Are you able to reproduce it.  If so, what is the exact error?




Comment 5


Zac Medico






          2007-01-31 02:27:29 UTC
        

Waiting for more info...




Comment 6


edjunior





          2007-01-31 10:53:56 UTC
        

(In reply to comment #5)
> Waiting for more info...
> 

i've only tried to execute `emerge-webrsync`, then it returns an error:

# emerge-webrsync -v
Fetching most recent snapshot
date: data inválida `@1170154366'
date: data inválida `@1170154366'
date: data inválida `@1170154366'
Attempting to fetch file dated:
--08:52:46--  http://distfiles.gentoo.org/snapshots/portage-.tar.bz2.md5sum
           => `/var/tmp/emerge-webrsync/portage-.tar.bz2.md5sum'
Resolvendo distfiles.gentoo.org... 156.56.247.195, 216.165.129.135, 64.50.236.52, ...
Connecting to distfiles.gentoo.org|156.56.247.195|:80... conectado!
HTTP requisição enviada, aguardando resposta... 404 Not Found
08:52:47 ERRO 404: Not Found.

--08:52:47--  http://distro.ibiblio.org/pub/linux/distributions/gentoo/snapshots/portage-.tar.bz2.md5sum
           => `/var/tmp/emerge-webrsync/portage-.tar.bz2.md5sum'
Resolvendo distro.ibiblio.org... 152.46.7.109
Connecting to distro.ibiblio.org|152.46.7.109|:80... conectado!
HTTP requisição enviada, aguardando resposta... 404 Not Found
08:52:47 ERRO 404: Not Found.

 --- No md5sum present on the mirror. (Not yet available.)
date: data inválida `@1170067967'
date: data inválida `@1170067967'
...


# emerge --info
Portage 2.1.2 (default-linux/x86/2006.1/desktop, gcc-3.3.5-20050130, glibc-2.3.4.20041102-r1, 2.6.15-gentoo-r1 i686)
=================================================================
System uname: 2.6.15-gentoo-r1 i686 Intel(R) Pentium(R) 4 CPU 3.00GHz
Gentoo Base System version 1.6.13
Timestamp of tree: Tue, 30 Jan 2007 01:47:01 +0000
dev-java/java-config: 1.3.0-r2, 2.0.26-r5
dev-lang/python:     2.4.2
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.11-r4
sys-devel/libtool:   1.5.18-r1
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-Os -march=pentium4 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/terminfo"
CXXFLAGS="-Os -march=pentium4 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="pt_BR.ISO-8859-1"
LC_ALL="pt_BR.ISO-8859-1"
LINGUAS="pt_BR"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X alsa apache2 arts berkdb bitmap-fonts cairo cdr cli cracklib crypt cups dbus dlloader dri dvd dvdr eds emboss encode esd fam firefox fortran gdbm gif gpm gstreamer gtk hal iconv ipv6 isdnlog jpeg kde ldap libg++ mad midi mikmod mp3 mpeg musicbrainz ncurses nfs nls nptl nptlonly ogg opengl oss pam pcre perl png ppds pppd python qt3 qt4 quicktime readline reflection samba sdl session spell spl ssl subversion tcpd truetype truetype-fonts type1-fonts udev unicode vorbis win32codecs x86 xml xorg xv zlib" ALSA_CARDS="intel8x0" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="pt_BR" USERLAND="GNU" VIDEO_CARDS="i810"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY





Comment 7


Zac Medico






          2007-01-31 11:16:25 UTC
        

(In reply to comment #6)
> date: data inválida `@1170154366'

What version of coreutils do you have installed?  With sys-apps/coreutils-6.7-r1 I can run `date -d @1170154366` and it works properly.  Maybe that's not supported by older versions?




Comment 8


edjunior





          2007-01-31 11:42:15 UTC
        

(In reply to comment #7)
> (In reply to comment #6)
> > date: data inválida `@1170154366'
> 
> What version of coreutils do you have installed?  With
> sys-apps/coreutils-6.7-r1 I can run `date -d @1170154366` and it works
> properly.  Maybe that's not supported by older versions?
> 
Hmmm...the problem may be this one. My coreutils version is 5.2.1-r6.

$ date --version
date (coreutils) 5.2.1
Written by David MacKenzie.

Let me try to upgrade my coreutils.




Comment 9


edjunior





          2007-01-31 12:02:33 UTC
        

That's it! I've upgraded coreutils to version 6.4 and then emerge-webrsync works fine.

# date --version
date (GNU coreutils) 6.4
Copyright (C) 2006 Free Software Foundation, Inc.

Thanks!




Comment 10


Zac Medico






          2007-01-31 17:14:27 UTC
        

I'll adjust the deps in the ebuild.




Comment 11


Zac Medico






          2007-01-31 17:55:14 UTC
        

The dep is fixed.




Comment 12


Zac Medico






          2007-02-01 08:13:56 UTC
        

Unfortunately I had to make the dep conditional on !selinux in order to avoid breaking their deptree due to bug #144509.  Hopefully they'll fix that soon (otherwise they won't be able to use emerge-webrsync with portage-2.1.2).




Comment 13


Jakub Moc (RETIRED)






          2008-02-17 20:55:32 UTC
        

Useless bug, 6.9-r1 is the oldest version in the tree. Closing.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

