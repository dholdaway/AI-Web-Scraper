Title: 618534 – =net-fs/nfs-utils-1.3.4-r1[-nfsidmap,-nfsv4,-nfsv41]: checking for nfs4_init_name_mapping in -lnfsidmap... no
URL: https://bugs.gentoo.org/show_bug.cgi?id=618534

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 618534
=net-fs/nfs-utils-1.3.4-r1[-nfsidmap,-nfsv4,-nfsv41]: checking for nfs4_init_name_mapping in -lnfsidmap... no
Last modified: 2017-05-19 11:59:32 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 618534 
      - =net-fs/nfs-utils-1.3.4-r1[-nfsidmap,-nfsv4,-nfsv41]: checking for nfs4_init_name_mapping in -lnfsidmap... no


Summary:
=net-fs/nfs-utils-1.3.4-r1[-nfsidmap,-nfsv4,-nfsv41]: checking for nfs4_init_...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2017-05-15 14:46 UTC by Thomas Beutin





      Modified:
    
2017-05-19 11:59 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



bkohler









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,11.05 KB,
                text/plain)

            
2017-05-15 14:46 UTC,

            Thomas Beutin




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Thomas Beutin





          2017-05-15 14:46:25 UTC
        

Created attachment 472658 [details]
build.log

[...]
checking for nfs4_init_name_mapping in -lnfsidmap... no
configure: error: libnfsidmap not found.
[...]

# emerge --info net-fs/nfs-utils 
Portage 2.3.5 (python 2.7.12-final-0, default/linux/amd64/13.0, gcc-5.4.0, glibc-2.23-r3, 4.9.16-gentoo x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-4.9.16-gentoo-x86_64-Intel-R-_Xeon-R-_CPU_E5-2680_v2_@_2.80GHz-with-gentoo-2.3
KiB Mem:   264194212 total, 252381684 free
KiB Swap:   16777212 total,  16777212 free
Timestamp of repository gentoo: Mon, 15 May 2017 14:00:01 +0000
sh bash 4.3_p48-r1
ld GNU ld (Gentoo 2.26.1 p1.0) 2.26.1
app-shells/bash:          4.3_p48-r1::gentoo
dev-lang/perl:            5.24.1-r1::gentoo
dev-lang/python:          2.7.12::gentoo, 3.4.5::gentoo
dev-util/cmake:           3.7.2::gentoo
dev-util/pkgconfig:       0.28-r2::gentoo
sys-apps/baselayout:      2.3::gentoo
sys-apps/openrc:          0.24.2::gentoo
sys-apps/sandbox:         2.10-r3::gentoo
sys-devel/autoconf:       2.13::gentoo, 2.69::gentoo
sys-devel/automake:       1.13.4::gentoo, 1.14.1::gentoo, 1.15-r2::gentoo
sys-devel/binutils:       2.26.1::gentoo
sys-devel/gcc:            5.4.0-r3::gentoo
sys-devel/gcc-config:     1.7.3::gentoo
sys-devel/libtool:        2.4.6-r3::gentoo
sys-devel/make:           4.2.1::gentoo
sys-kernel/linux-headers: 4.4::gentoo (virtual/os-headers)
sys-libs/glibc:           2.23-r3::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000

x-portage
    location: /usr/local/portage
    masters: gentoo
    priority: 0

science
    location: /var/lib/layman/science
    masters: gentoo
    priority: 50

sunrise
    location: /var/lib/layman/sunrise
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=ivybridge -fomit-frame-pointer -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /var/bind"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.6/ext-active/ /etc/php/apache2-php7.0/ext-active/ /etc/php/cgi-php5.6/ext-active/ /etc/php/cgi-php7.0/ext-active/ /etc/php/cli-php5.6/ext-active/ /etc/php/cli-php7.0/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=ivybridge -fomit-frame-pointer -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j50"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="X509 aac aacplus aalib accounting acl adns aim amd64 ansi apache2 audit automount autotrace bacula-console bash-completion bcmath bidi bind-mysql bittorrent bzip2 cairo calendar caps ccache cdb cgi chipcard chroot command-args corefonts cpudetection cpulimit cracklib cramfs cron crypt cscope css csv ctype curl curlwrappers customlog cvsgraph cxx cyrus dba dbi dbm dbx device-mapper devmap dhcp djvu dlopen dnsdb ecc emf encode enscript exif expat fam fastcgi ffmpeg fftw fits flac flash flatfile fontconfig fortran fpm fpx ftp gd gdal gdbm geoip geos gif git gmp graphviz gs gzip hardened hardenedphp hdf5 hdri hpn http i18n iconv icq icu idea idled idn imagemagick imap imlib imlib2 inifile innodb ipalias ipv6 jabber jbig jpeg jpeg2k json lapack lcms ldap less libwww lm_sensors lmtp logrotate logwatch lz4 lzma lzo mbox mcal memlimit mgetty mhash milter mime mimencode ming mmap mp3 mpeg mpm-prefork mppe-mppc multilib mysql mysqli nagios-dns nagios-game nagios-ntp nagios-ping nagios-ssh ncurses netboot netcdf netifrc network nfs nls nntp nptl nptlonly oav odbc ogg oggvorbis opencl openexr openmp openrc openssh openssl pam pam_chroot pam_console pam_timestamp pango parse-clocks pcntl pcre pdf pdfkit pdflib perl php pic plotutils png posix postfix postgis postgres postscript procmail proj pwdb python qdbm qemu quotas radius raw readline recode reiserfs rmtp rpc rrdtool rss sample sasl screen sendfile sensord session sftp sftplogging shaper shared sharedext sieve simplexml slang slp smartcard smime smp sms smtp snmp snortsam soap sockets socks5 spamassassin spell spl sql sqlite sqlite3 ssl stream subversion svg sysfs syslog sysvipc szip tcpd theora threads tidy tiff tls tokenizer transparent-proxy truetype truetype-fonts type1-fonts udev unicode userlocales utf8 uuid vhosts vim-syntax virtual-users virus-scan vorbis vpx wddx webp withsamplescripts wmf x264 xattr xfs xinetd xls xml xml2 xmlrpc xpm xsl xslt xvid yahoo yaz zlib" ABI_X86="64" APACHE2_MODULES="access auth auth_basic auth_digest authn_default authn_core authn_file authz_core authz_groupfile authz_host authz_user authn_dbm authn_dbd authz_dbd dbd ident imagemap authn_alias authn_anon authz_dbm authz_owner authz_default authz_user auth_digest authz_host alias file_cache echo charset_lite cache disk_cache mem_cache ext_filter case_filter case-filter-in deflate filter mime_magic cern_meta proxy_ajp proxy_balancer expires http2 headers usertrack proxy proxy_html proxy_connect proxy_ftp proxy_http info include cgi cgid dav dav_lock dav_fs vhost_alias speling rewrite log_config logio env setenvif mime status substitute autoindex asis negotiation dir imap actions userdir so unique_id version dumpio log_forensic reqtimeout socache_shmcb unixd proxy_fcgi slotmem_shm ratelimit remoteip lbmethod_bybusyness lbmethod_byrequests lbmethod_bytraffic lbmethod_heartbeat proxy_wstunnel macro" APACHE2_MPMS="event" CPU_FLAGS_X86="aes avx mmx mmxext popcnt sse sse2 sse3 sse4 sse4_1 sse4_2 ssse3" CURL_SSL="openssl" ELIBC="glibc" KERNEL="linux" PHP_TARGETS="php5-6 php7-0" PYTHON_SINGLE_TARGET="python3_4" PYTHON_TARGETS="python2_7 python3_4" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" USERLAND="GNU"
USE_PYTHON="2.7 3.4"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

net-fs/nfs-utils-1.3.4::gentoo was built with the following:
USE="caps ipv6 tcpd uuid -kerberos -libmount -nfsdcld -nfsidmap -nfsv4 -nfsv41 (-selinux)" ABI_X86="64"




Comment 1


Ben Kohler






          2017-05-15 16:22:09 UTC
        

FWIW, installing net-libs/libnfsidmap first should work around the issue.  I'm not sure if this needs to be an uncoditional dep or if the USE/dep logic just isn't quite right.




Comment 2


Thomas Beutin





          2017-05-15 17:58:07 UTC
        

(In reply to Ben Kohler from comment #1)
> FWIW, installing net-libs/libnfsidmap first should work around the issue. 
> I'm not sure if this needs to be an uncoditional dep or if the USE/dep logic
> just isn't quite right.

This might be true (i didn't checked it), but since NFSv4 doesn't give any benefit to me - and net-libs/libnfsidmap is used only for NFSv4 - i prefer to live w/o it.




Comment 3


Ben Kohler






          2017-05-15 18:07:51 UTC
        

Yes, of course, but some people seeing this bug may prefer to temporarily have nfs-utils with unneeded nfsv4 support, over no nfs-utils at all =)  just a rough workaround, not a final solution




Comment 4


Oliver Schwabedissen





          2017-05-17 04:35:53 UTC
        

I had the same problem yesterday morning when I tried to emerge nfs-utils-1.3.4-r1:

checking for event.h... yes
checking for nfs4_init_name_mapping in -lnfsidmap... no
configure: error: libnfsidmap not found.

Then I set the "nfsidmap" USE flag, but this didn't pull in net-libs/libnfsidmap.

Next I emerged net-libs/libnfsidmap manually. This time emerging nfs-utils-1.3.4-r1 aborted with 

x86_64-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I../../support/include  -I/usr/include/tirpc  -D_GNU_SOURCE -Wall -Wextra -Wstrict-prototypes  -pipe -O2 -march=core2 -pipe    -O2 -march=core2 -pipe -c -o gssd-krb5_util.o `test -f 'krb5_util.c' || echo './'`krb5_util.c
context.c:40:26: fatal error: rpc/auth_gss.h: No such file or directory
compilation terminated.
make[2]: *** [Makefile:660: gssd-context.o] Error 1
make[2]: *** Waiting for unfinished jobs....
In file included from gssd_proc.c:77:0:
krb5_util.h:7:26: fatal error: rpc/auth_gss.h: No such file or directory
compilation terminated.
make[2]: *** [Makefile:786: gssd-gssd_proc.o] Error 1
In file included from gssd.c:72:0:
krb5_util.h:7:26: fatal error: rpc/auth_gss.h: No such file or directory
compilation terminated.
krb5_util.c:122:26: fatal error: rpc/auth_gss.h: No such file or directory
compilation terminated.
make[2]: *** [Makefile:772: gssd-gssd.o] Error 1
make[2]: *** [Makefile:800: gssd-krb5_util.o] Error 1
make[2]: Leaving directory '/var/tmp/portage/net-fs/nfs-utils-1.3.4-r1/work/nfs-utils-1.3.4/utils/gssd'
make[1]: *** [Makefile:450: all-recursive] Error 1
make[1]: Leaving directory '/var/tmp/portage/net-fs/nfs-utils-1.3.4-r1/work/nfs-utils-1.3.4/utils'
make: *** [Makefile:474: all-recursive] Error 1

At this point I gave up.

In the evening I did another "emerge --sync", tried to emerge nfs-utils-1.3.4-r1 again and this time it went without problems. So maybe another "emerge --sync" helps.

FWIW: NFS4 is disabled here in make.conf (-nfsv4). And after emerging nfs-utils-1.3.4-r1 successfully I also disabled NFS41 (-nfsv41) and emerged nfs-utils again w/o problems.




Comment 5


Oliver Schwabedissen





          2017-05-17 18:12:48 UTC
        

Forgot to mention that I removed the nfsidmap USE flag and also net-libs/libnfsidmap before I emerged nfs-utils-1.3.4-r1 successfully.




Comment 6


Thomas Beutin





          2017-05-19 11:59:32 UTC
        

For me it also works now w/o any NSFv4 stuff:

[ebuild   R    ] net-fs/nfs-utils-1.3.4-r1::gentoo  USE="caps ipv6 tcpd uuid -kerberos -libmount -nfsdcld -nfsidmap -nfsv4 -nfsv41 (-selinux)" 0 KiB









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

