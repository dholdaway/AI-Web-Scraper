Title: 138919 – gentoo-sources-2.6.17 menuconfig lacks SATA_INTEL_COMBINED support
URL: https://bugs.gentoo.org/show_bug.cgi?id=138919

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 138919
gentoo-sources-2.6.17 menuconfig lacks SATA_INTEL_COMBINED support
Last modified: 2006-07-24 15:35:15 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 138919 
      - gentoo-sources-2.6.17 menuconfig lacks SATA_INTEL_COMBINED support


Summary:
gentoo-sources-2.6.17 menuconfig lacks SATA_INTEL_COMBINED support
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Kernel Bug Wranglers and Kernel Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-07-02 15:12 UTC by Lee Bailey





      Modified:
    
2006-07-24 15:35 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Lee Bailey





          2006-07-02 15:12:06 UTC
        

I'm using a Dell e1505 (Inspiron 6400), and the 2.6.16-r9 kernel's menuconfig had support for the CONFIG_SCSI_SATA_INTEL_COMBINED flag, which is necessary to the operation of the laptop.

DIFF showed, between the 2.6.16-r9 and the 2.6.17 .config files, that the entry for CONFIG_SCSI_SATA_INTEL_COMBINED was entirely missing in the 2.6.17 .config entry, and again, menuconfig appears to lack the option entirely.

Given the age of the laptop (brand new), and the lack of any alternatives that worked, I'd imagine that this option was not intentionally removed.

(note: All kernels referenced are the standard gentoo-* ebuilds, not vanilla or otherwise)




Comment 1


Daniel Drake (RETIRED)






          2006-07-02 16:40:27 UTC
        

The option is not removed, only hidden. It is automatically selected when all of the following conditions are met:

IDE is built-in
BLK_DEV_IDE_SATA (old SATA drivers) are disabled
SCSI_SATA_AHCI _or_ SCSI_ATA_PIIX is enabled

If you find otherwise, please reopen this bug. After satisfying the above conditions you may have to restart menuconfig before the search feature shows it being set as =y




Comment 2


Lee Bailey





          2006-07-02 16:49:17 UTC
        

In my .config file, both SCSI_SATA_ACHI and SCSI_ATA_PIIX were set as =y, and the drive was still unreadable.
The addition of CONFIG_SCSI_SATA_INTEL_COMBINED=y was the only change that enabled my system to boot.




Comment 3


Daniel Drake (RETIRED)






          2006-07-03 01:41:53 UTC
        

(In reply to comment #2)
> In my .config file, both SCSI_SATA_ACHI and SCSI_ATA_PIIX were set as =y, and
> the drive was still unreadable.

How about the other conditions that I mentioned?






Comment 4


Lee Bailey





          2006-07-03 08:50:25 UTC
        

Yes, sorry, I misread your post, but looking at a saved copy of my .config, IDE was built in, as were the two SCSI_ options mentioned, and BLK_DEV_IDE_SATA was disabled.
Is there any testing I can do to help you figure this out?




Comment 5


Daniel Drake (RETIRED)






          2006-07-04 07:08:32 UTC
        

When you configured 2.6.17, did you start with a fresh .config or did you copy one from a 2.6.16 kernel?




Comment 6


Lee Bailey





          2006-07-04 08:03:24 UTC
        

I used a fresh configuration.




Comment 7


Daniel Drake (RETIRED)






          2006-07-04 08:31:46 UTC
        

The next step is for you to describe exactly how you can produce a config (starting from a blank config, i.e. run "make defconfig") which doesnt have CONFIG_SCSI_SATA_INTEL_COMBINED=y when the above mentioned conditions are met.

I have tried this myself and I cannot reproduce the problem. The default config includes CONFIG_SCSI_SATA_INTEL_COMBINED=y, if I turn off AHCI and PIIX libata drivers it goes to =n, if I turn either one back on it goes to =y again.






Comment 8


Lee Bailey





          2006-07-04 09:57:33 UTC
        

Here's what I've come up with so far, I tried replicating once, and it worked (the replication worked; the bug was still there), and the next time I tried the same steps, it came out fine (ie- no bug):

1) Unmerge gentoo-sources-2.6.17
2) Clean up any leftovers you might have, just in case.
3) Re-merge, set up the symbolic link, etc
4) make menuconfig, enable PIIX, INTEL_COMBINED should still be missing (not =n, or commented out, but missing entirely-- search for "COMBINED" comes up empty)
5) make menuconfig, enable AHCI, and INTEL_COMBINED will still prove absent (but as stated above, it's not 100% reproducible, I couldn't tell you what changed between the trials)

I hope that helps.




Comment 9


Daniel Drake (RETIRED)






          2006-07-24 15:35:15 UTC
        

You have to exit menuconfig before the COMBINED option goes to =y (see comment #1)

I have tried several times and cannot reproduce this, i.e. the COMBINED option goes to =y after exiting menuconfig.

If you can reproduce this reliably, please reopen. Please remember to restart menuconfig before checking if COMBINED has toggled itself.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

