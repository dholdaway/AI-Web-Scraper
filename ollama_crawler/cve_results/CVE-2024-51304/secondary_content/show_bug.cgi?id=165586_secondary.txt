Title: 165586 – kbuildsycoca complains about undefined mimetype/servicetype's
URL: https://bugs.gentoo.org/show_bug.cgi?id=165586

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 165586
kbuildsycoca complains about undefined mimetype/servicetype's
Last modified: 2007-04-27 05:45:34 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 165586 
      - kbuildsycoca complains about undefined mimetype/servicetype's


Summary:
kbuildsycoca complains about undefined mimetype/servicetype's
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-02-06 10:15 UTC by Evgeny Stambulchik





      Modified:
    
2007-04-27 05:45 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



do.not.do.it
rogerx.oss
tkrah









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Evgeny Stambulchik





          2007-02-06 10:15:04 UTC
        

Every time I run a KDE app I get hundreds of warnings on the console, like:

kbuildsycoca: WARNING: '/usr/share/applications/gqview.desktop' specifies undefined mimetype/servicetype 'image/x-xbitmap'

However, the relevant mime entries seem to be there, e.g.:

$ ls -l /usr/share/mime/image/x-xbitmap.xml
-rw-r--r-- 1 root root 530 Jan 28 09:42 /usr/share/mime/image/x-xbitmap.xml

Reproducible: Always

Steps to Reproduce:




Comment 1


Roger





          2007-02-08 03:35:48 UTC
        

Hey yea!  What up wit this? 

(Know one things, it been around for awhile but I rarely run KDE, so figured it was something known a year ago. :-/ )




Comment 2


Roger





          2007-02-08 03:47:01 UTC
        

$ qfile /usr/kde/3.5/bin/kbuildsycoca
kde-base/kdelibs (/usr/kde/3.5/bin/kbuildsycoca)

$ qfile /usr/share/applications/<insert any other file name here> 


kbuildsycoca is owned and compiled by kdelibs.  It looks as if kbuildsycoca is parsing a universal folder /usr/share/applications/ and is having errors with parsing /usr/share/applications/* files not owned by kde (ie. gnome, openoffice, ...)

Can it be fixed?  I'm not sure because kbuildsycoca has been compiled and installed recently here.

Hopefully somebody (such as a KDE geek ;-) will know a better answer to this trivial problem.







Comment 3


Torsten Krah





          2007-02-15 12:26:56 UTC
        

Same thing here - but also this:

kbuildsycoca running...
Reusing existing ksycoca
kio (KSycoca): ERROR: No database available!
kbuildsycoca: WARNING: 'qeditor_part.desktop' specifies undefined mimetype/servi
cetype 'text/english'


and than hundreds more of the last one.

This was a fresh install - deleted all .kde* in $HOME and removed /usr/kde/3.5 completly.
The first time it works - kcontrol run fine,kaffeine too.
But when i start kaffeine the second time the error is there again - although it was a fresh install.

Cant get it working again, kcontrol also show a empty control panel, only a network folder is there and a message like this:

kcontrol: WARNING: No K menu group with X-KDE-BaseGroup=settings found ! Defaulting to Settings/

My emerge --info:

Portage 2.1.1-r2 (default-linux/x86/2006.0, gcc-4.1.1, glibc-2.5-r0, 2.6.20-gentoo i686)
=================================================================
System uname: 2.6.20-gentoo i686 Intel(R) Pentium(R) M processor 1.60GHz
Gentoo Base System version 1.12.6
Last Sync: Thu, 15 Feb 2007 12:00:01 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.31
dev-lang/python:     2.3.5-r2, 2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -mtune=i686 -fomit-frame-pointer -pipe -mno-tls-direct-seg-refs"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /opt/openjms/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/bind"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O2 -mtune=i686 -fomit-frame-pointer -pipe -mno-tls-direct-seg-refs"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer noinfo sandbox sfperms strict"
GENTOO_MIRRORS="http://ftp.club-internet.fr/pub/mirrors/gentoo"
LANG="de_DE.utf8"
LC_ALL="de_DE.utf8"
LINGUAS="de"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/gentoo-de /usr/local/portage/default /usr/local/portage/layman/catalystframework"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X aalib acl alsa alsa_cards_ali5451 alsa_cards_als4000 alsa_cards_atiixp alsa_cards_atiixp-modem alsa_cards_bt87x alsa_cards_ca0106 alsa_cards_cmipci alsa_cards_emu10k1 alsa_cards_emu10k1x alsa_cards_ens1370 alsa_cards_ens1371 alsa_cards_es1938 alsa_cards_es1968 alsa_cards_fm801 alsa_cards_hda-intel alsa_cards_intel8x0 alsa_cards_intel8x0m alsa_cards_maestro3 alsa_cards_trident alsa_cards_usb-audio alsa_cards_via82xx alsa_cards_via82xx-modem alsa_cards_ymfpci alsa_pcm_plugins_adpcm alsa_pcm_plugins_alaw alsa_pcm_plugins_asym alsa_pcm_plugins_copy alsa_pcm_plugins_dmix alsa_pcm_plugins_dshare alsa_pcm_plugins_dsnoop alsa_pcm_plugins_empty alsa_pcm_plugins_extplug alsa_pcm_plugins_file alsa_pcm_plugins_hooks alsa_pcm_plugins_iec958 alsa_pcm_plugins_ioplug alsa_pcm_plugins_ladspa alsa_pcm_plugins_lfloat alsa_pcm_plugins_linear alsa_pcm_plugins_meter alsa_pcm_plugins_mulaw alsa_pcm_plugins_multi alsa_pcm_plugins_null alsa_pcm_plugins_plug alsa_pcm_plugins_rate alsa_pcm_plugins_route alsa_pcm_plugins_share alsa_pcm_plugins_shm alsa_pcm_plugins_softvol apache2 apm arts bash-completion berkdb bitmap-fonts bzip2 cjk cli cracklib crypt cscope cups dga directfb dlloader dri dvd eds elibc_glibc emboss encode esd fbcon firefox flac foomaticdb fortran gdbm ggi gif gnome gpm gstreamer gtk gtk2 gtkhtml hal iconv idn imlib input_devices_evdev input_devices_keyboard input_devices_mouse input_devices_synaptics ipv6 isdnlog jack java jikes jpeg jpeg2k kde kerberos kernel_linux lcd_devices_bayrad lcd_devices_cfontz lcd_devices_cfontz633 lcd_devices_glk lcd_devices_hd44780 lcd_devices_lb216 lcd_devices_lcdm001 lcd_devices_mtxorb lcd_devices_ncurses lcd_devices_text lcms ldap libg++ libwww linguas_de lirc_devices_pctv mad midi mikmod mmx modperl motif mp3 mpeg musepack mysql nas ncurses nls nptl ogg opengl oss pam pcre perl png postgres pppd python qt3 qt4 quicktime readline reflection samba scanner sdl session slang snmp spell spl sse sse2 ssl startup-notification svga tcltk tcpd tiff truetype truetype-fonts type1-fonts udev unicode userland_GNU video_cards_radeon video_cards_v4l vorbis xinerama xml xorg xprint xv zeroconf zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS






Comment 4


Guy





          2007-03-03 02:39:14 UTC
        

I'm having the same issue with 2 of three PCs. Anyone have any thoughts?




Comment 5


Guy





          2007-03-03 03:21:07 UTC
        

The problem is apparently old, superceded crap in /usr/kde/3.5 as per this post in the gentoo forums: http://forums.gentoo.org/viewtopic-p-3732879.html#3732879

Several points: The +10 days mentioned in the post is specific to that person's configuration. i.e. Your situation is certain to vary. 

I tried +35 days on one system and that turned out to be not such a good idea. It looks like I'll need to rebuild kde on that box from scratch. The mime issue was eliminated but I lost some compiled programs I needed. I needed to do a larger number of days.

When all else fails, I suggest that you completely clear out /usr/kde/3.5 and rebuild kde from scratch. This is a last resort suggestion.




Comment 6


Torsten Krah





          2007-03-05 09:50:34 UTC
        

You did not read my post, did you?
Again : I have cleared out all!

It works one time fine - but after reboot/shutdown/suspend its broken again.

So this is still an issue i would say - because i dont know why this happens, i dont want to clear out every reboot all kde*.

kind regards




Comment 7


Torsten Krah





          2007-03-14 09:03:22 UTC
        

Found a solution, which may work:

XDG_DATA_DIRS and XDG_CONFIG_DIRS is only set to directories used by xfce.
Extending these ones by the ones kde uses, it starts working again.

kind regards




Comment 8


Evgeny Stambulchik





          2007-03-14 09:14:28 UTC
        

(In reply to comment #7)

In my environment these are not defined at all. If I set to e.g.

setenv XDG_DATA_DIRS $KDEDIR/share/:/usr/share/
setenv XDG_CONFIG_DIRS $KDEDIR/etc/xdg/:/etc/xdg/

nothing changes.




Comment 9


Torsten Krah





          2007-03-14 19:10:51 UTC
        

In my environment ( xfce4 ) kde works again and its working everytime, and my menu has more kde program entries, without them they are gone.
So here it changes a lot. 

I've also defined the other 2 XDG entries XDG_DATA_HOME= and XDG_CONFIG_HOME.

kind regards




Comment 10


Carsten Lohrke (RETIRED)






          2007-04-15 11:18:32 UTC
        

I think here are two different issues mixed. First, the kbuildsycoca warnings do not matter. Ignore them. Ubuntu has even silenced them, but I'm not sure, if this makes a lot of sense. Second, the XDG variables matter only for users of other desktops than KDE. XDG_DATA_DIRS is already set, XDG_CONFIG_DIRS will be with the next revsion bump I'm preparing.




Comment 11


Roger





          2007-04-15 22:48:52 UTC
        

Right.  Sort of like beating my console to death with a baseball bat.  If these are truly meaningless errors for other users, they should be only outputed with the optional "-v --verbose" switch.

<shrugs>... my opinion.




Comment 12


Evgeny Stambulchik





          2007-04-22 16:13:12 UTC
        

(In reply to comment #10)
> I think here are two different issues mixed. First, the kbuildsycoca warnings
> do not matter. Ignore them. Ubuntu has even silenced them, but I'm not sure, if
> this makes a lot of sense.

Well, if they are really harmless, it's best to silence them. But why do they exist at all?? I guess KDE folks never run anything from the command prompt ;-). The tons of these stupid messages may shadow really important warnings an app is issuing (especially since the kbuildsycoca warnings appear asynchronously).






Comment 13


Carsten Lohrke (RETIRED)






          2007-04-25 08:40:56 UTC
        

Well, the output can be helpful, when there're really issues and for testing purposes. I don't think it's a good idea to remoove the possibility to do so. And no, while KDE apps can be quite verbose, I do not get a lot of these, because I do not have a lot of applicatons installed, which install mimelnk stuff, which isn't available in KDE's mimelnk db. 

Push the output to /dev/null if you don't like it and if you're too lazy to do this each time on the commandline, create an alias.




Comment 14


Evgeny Stambulchik





          2007-04-25 08:50:42 UTC
        

(In reply to comment #13)
> Well, the output can be helpful, when there're really issues and for testing
> purposes. I don't think it's a good idea to remoove the possibility to do so.

Please re-read the bug description. I repeat: the warnings are WRONG in this case, as the mime db entries ARE there.




Comment 15


Carsten Lohrke (RETIRED)






          2007-04-25 09:00:37 UTC
        

KDE 3 uses it's own mime db, not the shared one.




Comment 16


Evgeny Stambulchik





          2007-04-25 09:23:36 UTC
        

(In reply to comment #15)
> KDE 3 uses it's own mime db, not the shared one.

So why the hell it tinkers with the _shared_ .desktop entries?! Any advise on how to stop it doing stupid things like this while keeping correct warnings displayed?





Comment 17


Carsten Lohrke (RETIRED)






          2007-04-25 17:17:24 UTC
        

mime db entries != desktop entries

*sigh*, long explanation: The shared mime db is in /usr/share/mime KDE gathers its information from the .../share/mimelnk/ subdirectories with the directories in $KDEDIRS plus your KDE home dir as base. So, taking the inital mimetype as example, we have 

/usr/share/mime/image/x-xbitmap.xml (shared mime db)

and the corresponding

/usr/kde/3.5/share/mimelnk/image/x-bmp.desktop  (dont be tricked by the .desktop ending, it's not a xdg compliant desktop entry)

Now you could think renaming x-bmp.desktop to x-xbitmap.desktop would do, but wrong: You'd also need to go through the _whole_ KDE sources and replacing all occurences of MimeTyp=image/x-bmp in all application desktop-entries (that is with Type=application in them) with image/x-xbitmap. The latter job is scriptable of course, but you still have lookup and compare the mime db's manually. Hell of a job, but if you like it, I'm sure the kde.org devs appreciate your patches.




Comment 18


Evgeny Stambulchik





          2007-04-25 17:42:39 UTC
        

(In reply to comment #17)
> mime db entries != desktop entries

My point is KDE parses the whole /usr/share/applications/ dir (which is NOT KDE-specific), and thus pretends to be a good netizen. On the other hand, when time comes to understand it, it forgets about anything but itself. This is just plain inconsistent (it's not a Gentoo's failure, of course, but I'd like to see a remedy e.g. like what Ubuntu folks did).




Comment 19


Carsten Lohrke (RETIRED)






          2007-04-26 22:56:48 UTC
        

No, /usr/share/applications/ is not KDE specific, but that doesn't mean there aren't desktop entries to process in it.




Comment 20


Roger





          2007-04-27 05:45:34 UTC
        

Reminds me of Microsoft.  Microsoft binaries report no debugging info.

But with KDE, seems they want to obtain the same objective, but with overloading us with debugging output.  Maybe they just want to irritate Gnome users?

:-/

This is really a KDE bug.  KDE devs should really group this debug output into a higher debug level instead of displaying this junk with other more useful debug info.  Or is this only possible when using C? <grin>










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

