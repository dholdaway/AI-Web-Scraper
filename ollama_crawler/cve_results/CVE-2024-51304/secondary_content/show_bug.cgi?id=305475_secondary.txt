Title: 305475 – media-gfx/hugin-2009.2.0 crashes immediately after splash
URL: https://bugs.gentoo.org/show_bug.cgi?id=305475

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 305475
media-gfx/hugin-2009.2.0 crashes immediately after splash
Last modified: 2010-06-05 22:49:22 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 305475 
      - media-gfx/hugin-2009.2.0 crashes immediately after splash


Summary:
media-gfx/hugin-2009.2.0 crashes immediately after splash
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Graphics Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-02-17 01:56 UTC by Jessica Leigh





      Modified:
    
2010-06-05 22:49 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



lu_zero
wxwidgets
x11









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Example of WxGLCanvas usage

              (glcanvastest.cpp,2.48 KB,
                text/plain)

            
2010-02-17 01:57 UTC,

            Jessica Leigh




Details





emerge --info output

              (emerge_info.out,3.94 KB,
                text/plain)

            
2010-02-17 01:59 UTC,

            Jessica Leigh




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jessica Leigh





          2010-02-17 01:56:32 UTC
        

I emerged hugin and launched it and it crashed after briefly displaying a splash screen with the following error message:

The program 'hugin' received an X Window System error.
This probably reflects a bug in the program.
The error was 'BadRequest (invalid request code or no such operation)'.
  (Details: serial 861 error_code 1 request_code 135 minor_code 19)
  (Note to programmers: normally, X errors are reported asynchronously;
   that is, you will receive the error a while after causing it.
   To debug your program, run it with the --sync command line
   option to change this behavior. You can then get a meaningful
   backtrace from your debugger if you break on the gdk_x_error() function.)

I then did as suggested and ran hugin through gdb (breaking on gdk_x_error didn't seem to work... breaking on exit did, however). Here's the backtrace:

#0  0x00007ffff102dee0 in exit () from /lib/libc.so.6
#1  0x00007ffff00df4b3 in ?? () from /usr/lib/libgdk-x11-2.0.so.0
#2  0x00007ffff25d814c in _XError () from /usr/lib/libX11.so.6
#3  0x00007ffff25df863 in _XReply () from /usr/lib/libX11.so.6
#4  0x00007ffff7e74106 in ?? () from /usr/lib64/opengl/ati/lib/libGL.so.1
#5  0x00007ffff7e524f5 in ?? () from /usr/lib64/opengl/ati/lib/libGL.so.1
#6  0x00007ffff7e4b9ea in glXQueryVersion () from /usr/lib64/opengl/ati/lib/libGL.so.1
#7  0x00007ffff319eaa9 in wxGLCanvas::QueryGLXVersion() () from /usr/lib/libwx_gtk2u_gl-2.8.so.0
#8  0x00007ffff319f51a in wxGLCanvas::Create(wxWindow*, wxGLContext const*, wxGLCanvas const*, int, wxPoint const&, wxSize
const&, long, wxString const&, int*, wxPalette const&) () from /usr/lib/libwx_gtk2u_gl-2.8.so.0
#9  0x00007ffff319fc1b in wxGLCanvas::wxGLCanvas(wxWindow*, int, wxPoint const&, wxSize const&, long, wxString const&,
int*, wxPalette const&) () from /usr/lib/libwx_gtk2u_gl-2.8.so.0
#10 0x000000000052752c in GLViewer::GLViewer(wxFrame*, PT::Panorama&, int*, GLPreviewFrame*) ()
#11 0x000000000051df30 in GLPreviewFrame::GLPreviewFrame(wxFrame*, PT::Panorama&) ()
#12 0x0000000000486d59 in MainFrame::MainFrame(wxWindow*, PT::Panorama&) ()
#13 0x000000000046d331 in huginApp::OnInit() ()
#14 0x00007ffff44a5cf3 in wxEntry(int&, wchar_t**) () from /usr/lib/libwx_baseu-2.8.so.0
#15 0x000000000046b4c2 in main ()

It looked like a problem with wxGTK's WxGLCanvas widget, so I copied an example on how to use this widget, compiled it, and got virtually the same error message.  I've attached the sample program, which I got from http://wiki.wxwidgets.org/WxGLCanvas It can be compiled with the following:

g++ -g glcanvastest.cpp `wx-config --libs --gl-libs` `wx-config --cxxflags` -lglut -o glcanvastest


Other details worth noting:

- I tried hugin-2009-4.0 and wxGTK-2.8.10.1-r1 (separately) with the same result
- I've got an ATI video card. I've got ati-drivers-9.11 installed, and the ATI version of openGL selected with eselect

Reproducible: Always

Steps to Reproduce:
1. emerge hugin
2. launch with command line or launcher


Actual Results:  
The splash screen displays very briefly before the program crashes with the error message described above.

Expected Results:  
hugin should open, at the very least.




Comment 1


Jessica Leigh





          2010-02-17 01:57:43 UTC
        

Created attachment 219951 [details]
Example of WxGLCanvas usage

This program will crash on my system in the same way that hugin does.




Comment 2


Jessica Leigh





          2010-02-17 01:59:35 UTC
        

Created attachment 219955 [details]
emerge --info output




Comment 3


Jessica Leigh





          2010-02-17 02:19:58 UTC
        

Sorry, in fact wxGTK-2.8.10.1-r1 was what I had originally installed. When I said that I'd tried hugin-2009-4.0 and wxGTK-2.8.10.1-r1 separately with the same results, I meant hugin-2009.4.0 and wxGTK-2.8.10.1-r5. I have not tried these two together; however, I suspect that the problem actually lies with wxGTK rather than with hugin.




Comment 4


Ryan Hill (RETIRED)






          2010-02-18 03:17:52 UTC
        

hey, a teapot. :)

it seems to work fine here.  what is the output of two wx-config commands used on the command line?  what about `eselect wxwidgets show`?




Comment 5


Jessica Leigh





          2010-02-18 23:13:26 UTC
        

From eselect wxwidgets show:

gtk2-unicode-release-2.8

... and wx-config --libs --gl-libs: 

-lwx_gtk2u_gl-2.8
-L/usr/lib64 -pthread -Wl,-O1  -L/usr/lib64   -lwx_gtk2u_richtext-2.8 -lwx_gtk2u_aui-2.8 -lwx_gtk2u_xrc-2.8 -lwx_gtk2u_qa-2.8 -lwx_gtk2u_html-2.8 -lwx_gtk2u_adv-2.8 -lwx_gtk2u_core-2.8 -lwx_baseu_xml-2.8 -lwx_baseu_net-2.8 -lwx_baseu-2.8

... and wx-config --cflags:

-I/usr/lib64/wx/include/gtk2-unicode-release-2.8 -I/usr/include/wx-2.8 -D_FILE_OFFSET_BITS=64 -D_LARGE_FILES -D__WXGTK__ -pthread

Didn't even get to see the teapot :)






Comment 6


Ryan Hill (RETIRED)






          2010-02-19 02:38:00 UTC
        

looks fine to me.  does it work with the xorg-x11 opengl driver?




Comment 7


Jessica Leigh





          2010-02-19 03:54:21 UTC
        

(In reply to comment #6)
> looks fine to me.  does it work with the xorg-x11 opengl driver?

It seems not to. Just to make sure I did everything right, I eselected the xorg-x11 opengl, logged out, re-emerged wxGTK, and recompiled the demo WxGLCanvas program... same error.

Also tried launching hugin (I got lazy and didn't re-emerge it... but I think I shouldn't have to, right? Sometimes the mysteries of linking feel like black magic). Same thing too.






Comment 8


Ryan Hill (RETIRED)






          2010-02-19 22:53:27 UTC
        

hrm, the few seemingly related mentions of something like this i can find all implicate fglrx.

eg. http://www.mail-archive.com/pkg-phototools-devel@lists.alioth.debian.org/msg01261.html

x11, any ideas?





Comment 9


Luca Barbato






          2010-02-20 07:44:00 UTC
        

You may try to use a newer ati driver (that uses the normal libGL), still I wonder if things like glxgears or mplayer -vo gl do show the same issue




Comment 10


Jessica Leigh





          2010-02-20 11:09:37 UTC
        

Right on. I emerged the latest ~amd64 version of ati-drivers (x11-drivers/ati-drivers-10.1) and I get the teapot! Also the hugin window. I'd recommend that the ati-drivers gods work on getting v. 10.1 into amd64 as soon as possible (I have a true gift for stating the obvious).

Your guess that mplayer -vo gl would crash was also correct, by the way (I was too lazy to emerge and check glxgears, but I'm sure you're right there too).

Thanks! Do I need to change the status/reassign this bug?





Comment 11


Jessica Leigh





          2010-06-03 02:00:42 UTC
        

Ack. I upgraded to ati-drivers-10.5 (required for xorg 1.7.6)and it seems to have broken things that use libGL. So hugin now crashes again, as does mplayer -vo gl, and the rgl package for R (dev-lang/R-2.10.1)




Comment 12


Jessica Leigh





          2010-06-05 11:28:21 UTC
        

Looks like I spoke too soon. I just did my weekly updates and everything's fine now. Oops.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

