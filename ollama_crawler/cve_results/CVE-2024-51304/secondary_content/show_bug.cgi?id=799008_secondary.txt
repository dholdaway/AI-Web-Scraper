Title: 799008 – app-misc/rpick-0.8.4 - error: could not compile vec_map
URL: https://bugs.gentoo.org/show_bug.cgi?id=799008

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 799008
app-misc/rpick-0.8.4 - error: could not compile vec_map
Last modified: 2021-07-21 09:25:29 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 799008 
      - app-misc/rpick-0.8.4 - error: could not compile vec_map


Summary:
app-misc/rpick-0.8.4 - error: could not compile vec_map
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Randy Barlow








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-06-28 07:26 UTC by Toralf Förster





      Modified:
    
2021-07-21 09:25 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



ionen
proxy-maint









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge-info.txt

              (emerge-info.txt,17.31 KB,
                text/plain)

            
2021-06-28 07:26 UTC,

            Toralf Förster




Details





app-misc:rpick-0.8.4:20210628-071142.log

              (app-misc:rpick-0.8.4:20210628-071142.log,25.06 KB,
                text/plain)

            
2021-06-28 07:26 UTC,

            Toralf Förster




Details





emerge-history.txt

              (emerge-history.txt,439.72 KB,
                text/plain)

            
2021-06-28 07:26 UTC,

            Toralf Förster




Details





environment

              (environment,71.67 KB,
                text/plain)

            
2021-06-28 07:26 UTC,

            Toralf Förster




Details





etc.portage.tar.bz2

              (etc.portage.tar.bz2,35.32 KB,
                application/x-bzip)

            
2021-06-28 07:26 UTC,

            Toralf Förster




Details





temp.tar.bz2

              (temp.tar.bz2,20.01 KB,
                application/x-bzip)

            
2021-06-28 07:26 UTC,

            Toralf Förster




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Toralf Förster






          2021-06-28 07:26:42 UTC
        

The futex facility returned an unexpected error code.
error: could not compile `vec_map`

Caused by:
  process didn't exit successfully: `rustc --crate-name vec_map /var/tmp/portage/app-misc/rpick-0.8.4/work/cargo_home/gentoo/vec_map-0.8.2/src/lib.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts --crate-type lib --emit=dep-info,metadata,link -C opt-level=3 -C linker-plugin-lto -C metadata=27da588ee3b24fa1 -C extra-filename=-27da588ee3b24fa1 --out-dir /var/tmp/portage/app-misc/rpick-0.8.4/work/rpick-0.8.4/target/release/deps -L dependency=/var/tmp/portage/app-misc/rpick-0.8.4/work/rpick-0.8.4/target/release/deps --cap-lints allow` (exit status: 134)
warning: build failed, waiting for other jobs to finish...

  -------------------------------------------------------------------

  This is an unstable amd64 chroot image at a tinderbox (==build bot)
  name: 17.1_no_multilib-j3_debug-20210620-175917

  -------------------------------------------------------------------

gcc-config -l:
 [1] x86_64-pc-linux-gnu-11.1.0 *
clang version 12.0.0
Target: x86_64-pc-linux-gnu
Thread model: posix
InstalledDir: /usr/lib/llvm/12/bin
/usr/lib/llvm/12
12.0.0
Python 3.9.5
Available Ruby profiles:
  [1]   ruby26 (with Rubygems)
  [2]   ruby30 (with Rubygems) *
Available Rust versions:
  [1]   rust-bin-1.53.0 *
Available Java Virtual Machines:
  (none found)

The Glorious Glasgow Haskell Compilation System, version 8.10.4
  HEAD of ::gentoo
commit cc3e0160f8a24a38b1d4624fd2ddd4bfdad6588f
Author: Repository mirror & CI <repomirrorci@gentoo.org>
Date:   Sun Jun 27 06:36:31 2021 +0000

    2021-06-27 06:36:30 UTC

emerge -qpvO app-misc/rpick
[ebuild  N    ] app-misc/rpick-0.8.4  USE="-debug"




Comment 1


Toralf Förster






          2021-06-28 07:26:44 UTC
        

Created attachment 719700 [details]
emerge-info.txt




Comment 2


Toralf Förster






          2021-06-28 07:26:45 UTC
        

Created attachment 719703 [details]
app-misc:rpick-0.8.4:20210628-071142.log




Comment 3


Toralf Förster






          2021-06-28 07:26:47 UTC
        

Created attachment 719706 [details]
emerge-history.txt




Comment 4


Toralf Förster






          2021-06-28 07:26:48 UTC
        

Created attachment 719709 [details]
environment




Comment 5


Toralf Förster






          2021-06-28 07:26:49 UTC
        

Created attachment 719712 [details]
etc.portage.tar.bz2




Comment 6


Toralf Förster






          2021-06-28 07:26:51 UTC
        

Created attachment 719715 [details]
temp.tar.bz2




Comment 7


Randy Barlow





          2021-06-28 14:56:08 UTC
        

Hi Toralf,

This one has a similar error message to https://bugs.gentoo.org/798645, though on a different crate:

The futex facility returned an unexpected error code.

I am not able to reproduce this one either.




Comment 8


Toralf Förster






          2021-06-28 14:59:14 UTC
        

(In reply to Randy Barlow from comment #7)
> Hi Toralf,
> 
> This one has a similar error message to https://bugs.gentoo.org/798645,
> though on a different crate:
> 
> The futex facility returned an unexpected error code.
> 
> I am not able to reproduce this one either.

Hhm, but b/c this is a different image I do not think that both images are broken in the same way, rather the way of emerged packages or whatever else.
Maybe -j3 is the reason ?

jobs is currently set to "3" :

RUST_TEST_THREADS=${jobs}
RUST_TEST_TASKS=${jobs}




Comment 9


Randy Barlow





          2021-07-21 01:16:49 UTC
        

Hi Toralf!

I have tried to reproduce this with MAKEOPTS=-j3, RUST_TEST_THREADS=3, and RUST_TEST_TASKS=3, but it builds for me. I don't usually set RUST_TEST_THREADS or RUST_TEST_TASKS, but I do usually use MAKEOPTS=-j8, -j4, and -j12 on three different systems and rpick build on all of those.

Any other ideas on what might be happening?




Comment 10


Ionen Wolkens






          2021-07-21 06:06:18 UTC
        

fwiw I can't reproduce this either

Only other times I seen these futex errors was in bugs like bug #801418, but it doesn't sound related (was caused by abi_x86_32 and CONFIG_COMPAT_32BIT_TIME being disabled in the kernel, but this is a no-multilib profile so I don't see how it could be involved -- I did try to build this on no-multilib, was fine too, not that I tried to change kernel.. but I'd believe the tinderbox has sane settings).




Comment 11


Toralf Förster






          2021-07-21 09:02:19 UTC
        

(In reply to Ionen Wolkens from comment #10)
> fwiw I can't reproduce this either
> 
> Only other times I seen these futex errors was in bugs like bug #801418, but
> it doesn't sound related (was caused by abi_x86_32 and
> CONFIG_COMPAT_32BIT_TIME being disabled in the kernel, but this is a
> no-multilib profile so I don't see how it could be involved -- I did try to
> build this on no-multilib, was fine too, not that I tried to change kernel..
> but I'd believe the tinderbox has sane settings).

Hhm, it emerges fine here today at about 13 images - so it seems rather to be load problem with the tinderbox ?

CONFIG_COMPAT_32BIT_TIME  is set to "y" FWIW so I'll close this til it can be (reliable) be reproduced.




Comment 12


Toralf Förster






          2021-07-21 09:16:57 UTC
        

and looking at the affected image it emerged fin ean hour later:

-rw-r--r-- 1 root root 26602 Jun 28 09:11 task.20210628-091159.app_misc_rpick.log
-rw-r--r-- 1 root root  1062 Jun 28 10:01 task.20210628-100130.app_misc_rpick.log

So either image specific or tinderbox had a hickup.




Comment 13


Ionen Wolkens






          2021-07-21 09:25:29 UTC
        

I guess(?) it could be some kind of race condition, although I never seen this kind before.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

