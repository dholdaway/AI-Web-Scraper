Title: 235708 – use.local.desc contains global flags
URL: https://bugs.gentoo.org/show_bug.cgi?id=235708

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 235708
use.local.desc contains global flags
Last modified: 2010-06-09 16:16:40 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 235708 
      - use.local.desc contains global flags


Summary:
use.local.desc contains global flags
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Eclasses

  (show other bugs)



Hardware:

All
        All
      







Importance:
      
High
       normal
      


Assignee:

Doug Goldstein (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




282919



 

        Show dependency tree





 





      Reported:
    
2008-08-25 19:42 UTC by Ulrich Müller





      Modified:
    
2010-06-09 16:16 UTC
      (History)
    




          CC List:
        

6 
          users
          
            (show)
          



antarus
jer
maekke
pva
qa
tcunha









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




global USE flags currently in use.local.desc

              (globalflags,3.29 KB,
                text/plain)

            
2008-08-25 19:43 UTC,

            Ulrich Müller




Details





repoman patch

              (repoman-global-local-use.patch,1.32 KB,
                patch)

            
2009-10-16 17:56 UTC,

            Peter Volkov (RETIRED)




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ulrich Müller






          2008-08-25 19:42:38 UTC
        

As discussed on IRC: use.local.desc contains some global USE flags (actually, quite a few, I count 140). These should be filtered out.




Comment 1


Ulrich Müller






          2008-08-25 19:43:47 UTC
        

Created attachment 163774 [details]
global USE flags currently in use.local.desc




Comment 2


Jeroen Roovers (RETIRED)






          2008-08-25 19:49:13 UTC
        

I'd say this problem existed long before GLEP 56 was conceived. To wit:
$ euses -cs perl
perl - Adds support/bindings for the Perl language
app-office/gnumeric:perl - Enable perl plugin loader.
media-tv/mythtv:perl - Builds the perl bindings for MythTV. Allows you to write scripts in Perl to control your MythTV setup or communicate with it.
net-analyzer/symon:perl - Enables a generic perl symux client

It may be more of a QA issue than a problem with GLEP 56 conversion specifically.




Comment 3


Jeroen Roovers (RETIRED)






          2008-08-25 19:51:03 UTC
        

Another randomly picked example:

$ euses -cs doc
doc - Adds extra documentation (API, Javadoc, etc)
app-crypt/mit-krb5:doc -  Creates and installs the API and implementation documentation. This is only useful if you want to develop software which depends on kerberos.
app-misc/beagle:doc - Builds programmer documentation for Beagle using app-doc/monodoc.
media-libs/swfdec:doc - Build documentation
net-print/hplip:doc - Build documentation
sys-apps/hal:doc - Generates documentation that describes HAL's fdi format.




Comment 4


Alec Warner (RETIRED)








          2008-08-25 20:28:57 UTC
        

Global use flags in use.local.desc are not illegal; the local description is just a more descriptive application of the global flag to a given package.

Am I wrong here?






Comment 5


Markus Meier






          2008-08-25 20:36:36 UTC
        

(In reply to comment #4)
> Am I wrong here?

no. but this bug is seems to be a dupe of bug #202967.





Comment 6


Ulrich Müller






          2008-08-25 20:36:56 UTC
        

I'm not sure, but the devmanual says: "All USE flags must be described in either use.desc or use.local.desc in the profiles/ directory."

From the "either ... or" I would conclude that a flag must not be listed in both.





Comment 7


Doug Goldstein (RETIRED)






          2008-08-25 21:22:03 UTC
        

(In reply to comment #4)
> Global use flags in use.local.desc are not illegal; the local description is
> just a more descriptive application of the global flag to a given package.
> 
> Am I wrong here?
> 

Yes, you're wrong. I originally proposed using use.local.desc to override global USE flag descriptions and started to add them. Halcy0n reverted those commits and told me that it was against QA and it was wrong. This back and forth discussion is what resulted in GLEP 56, which explicitly makes it valid in metadata.xml




Comment 8


Alec Warner (RETIRED)








          2008-08-25 22:06:06 UTC
        

I will add an option to the script --use_desc_file which will be a path to the use.desc file; by default it will use the default location in repo_path/profiles/use.desc.

It will not output flags that are global flags.  I expect to have this fixed tonight.

-Alec




Comment 9


Ulrich Müller






          2009-10-16 15:44:55 UTC
        

(In reply to comment #8)
> I expect to have this fixed tonight.

Any news here?





Comment 10


Peter Volkov (RETIRED)






          2009-10-16 17:56:12 UTC
        

Filtering use flags without fixing tree in advance is not good idea, since we loose useful descriptions, e.g.:

local:perl:media-video/ffprobe: Installs tools written in perl to produce plots based on video frame bitrate and size
local:perl:net-analyzer/symon: Enables a generic perl symux client
local:perl:sys-apps/util-linux: install the chkdupexe helper script

If this is policy then we repoman check (and then developers will have to fix this). Patch for this check follows.

QA, if you agree that we should enforce this policy, please, CC portage team.




Comment 11


Peter Volkov (RETIRED)






          2009-10-16 17:56:52 UTC
        

Created attachment 207343 [details, diff]
repoman patch




Comment 12


Peter Volkov (RETIRED)






          2010-06-09 16:16:40 UTC
        

Since nobody stepped in to ban this completely and I really think this kind of things are useful all we need is to update devmanual to document this possibility... Also see bug 309963 where it is suggested to drop 'either global or local'. Closing as WORKSFORME as I don't see anything to do here. Please, reopen if I'm wrong.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

