Title: 776370 – sys-process/numactl-2.0.12 fails to compile: /bin/sh: aclocal-1.15: command not found
URL: https://bugs.gentoo.org/show_bug.cgi?id=776370

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 776370
sys-process/numactl-2.0.12 fails to compile: /bin/sh: aclocal-1.15: command not found
Last modified: 2021-03-29 15:00:44 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 776370 
      - sys-process/numactl-2.0.12 fails to compile: /bin/sh: aclocal-1.15: command not found


Summary:
sys-process/numactl-2.0.12 fails to compile: /bin/sh: aclocal-1.15: command n...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-03-15 13:41 UTC by Agostino Sarubbo





      Modified:
    
2021-03-29 15:00 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge_info

              (emerge_info,5.42 KB,
                text/plain)

            
2021-03-15 13:41 UTC,

            Agostino Sarubbo




Details





sys-process:numactl-2.0.12:20210315-133918.log

              (sys-process:numactl-2.0.12:20210315-133918.log,7.43 KB,
                text/plain)

            
2021-03-15 13:41 UTC,

            Agostino Sarubbo




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Agostino Sarubbo






          2021-03-15 13:41:40 UTC
        

This package fails to compile on a stable system. Attached relevant logs and emerge --info




Comment 1


Agostino Sarubbo






          2021-03-15 13:41:52 UTC
        

Created attachment 691590 [details]
emerge_info

emerge --info




Comment 2


Agostino Sarubbo






          2021-03-15 13:41:54 UTC
        

Created attachment 691593 [details]
sys-process:numactl-2.0.12:20210315-133918.log

build log




Comment 3


Thomas Deutschmann (RETIRED)






          2021-03-15 15:18:09 UTC
        

> config.status: executing depfiles commands
> config.status: executing libtool commands
>  * abi_x86_64.amd64: running multilib-minimal_abi_src_compile
> CDPATH="${ZSH_VERSION+.}:" && cd /tmp/portage/sys-process/numactl-2.0.12/work/numactl-2.0.12 && aclocal-1.15 -I m4
> /bin/sh: aclocal-1.15: command not found
> make: *** [Makefile:755: /tmp/portage/sys-process/numactl-2.0.12/work/numactl-2.0.12/aclocal.m4] Error 127
>  * ERROR: sys-process/numactl-2.0.12::gentoo failed (compile phase):
>  *   emake failed
>  *




Comment 4


Sam James









          2021-03-28 04:26:41 UTC
        

1) This is weird:

checking for a BSD-compatible install... /usr/lib/portage/python3.8/ebuild-helpers/xattr/install -c
checking whether build environment is sane... yes
/bin/sh: /tmp/portage/sys-process/numactl-2.0.12/work/numactl-2.0.12-abi_x86_64.amd64/build-aux/missing: No such file or directory
configure: WARNING: 'missing' script is too old or missing
checking for a thread-safe mkdir -p... /bin/mkdir -p

Maintainer mode has been triggered when it tries to run aclocal again (a specific version). We need to understand why. Is there anything weird in your environment? Was config.log helpful?

2) These settings are dangerous:

CFLAGS="-O2 -march=x86-64 -g0 -fno-stack-protector -fno-stack-clash-protection -fstack-check=no -fno-stack-check"
CXXFLAGS="-O2 -march=x86-64 -g0 -fno-stack-protector -fno-stack-clash-protection -fstack-check=no -fno-stack-check"

I know you know they're dangerous, but not just from a security perspective: they're going to end up breaking things. A lot of packages expect stack protection now and this is like testing them to their limit as to whether we filter everywhere we should.

I'm also unsure if binutils (and other critical but non-glibc packages) also filter to the extent required.

This sort of thing usually ends up with odd breakages appearing all over the place.. I wonder if this is related to the git bug with jq?




Comment 5


Agostino Sarubbo






          2021-03-28 09:44:47 UTC
        

(In reply to Sam James from comment #4)
> 1) This is weird:
> 
> checking for a BSD-compatible install...
> /usr/lib/portage/python3.8/ebuild-helpers/xattr/install -c
> checking whether build environment is sane... yes
> /bin/sh:
> /tmp/portage/sys-process/numactl-2.0.12/work/numactl-2.0.12-abi_x86_64.amd64/
> build-aux/missing: No such file or directory
> configure: WARNING: 'missing' script is too old or missing
> checking for a thread-safe mkdir -p... /bin/mkdir -p
> 
> Maintainer mode has been triggered when it tries to run aclocal again (a
> specific version). We need to understand why. Is there anything weird in
> your environment? Was config.log helpful?
> 
> 2) These settings are dangerous:
> 
> CFLAGS="-O2 -march=x86-64 -g0 -fno-stack-protector
> -fno-stack-clash-protection -fstack-check=no -fno-stack-check"
> CXXFLAGS="-O2 -march=x86-64 -g0 -fno-stack-protector
> -fno-stack-clash-protection -fstack-check=no -fno-stack-check"
> 
> I know you know they're dangerous, but not just from a security perspective:
> they're going to end up breaking things. A lot of packages expect stack
> protection now and this is like testing them to their limit as to whether we
> filter everywhere we should.
> 
> I'm also unsure if binutils (and other critical but non-glibc packages) also
> filter to the extent required.
> 
> This sort of thing usually ends up with odd breakages appearing all over the
> place.. I wonder if this is related to the git bug with jq?

Hi Sam, thanks for giving an hand here.

I don't agree with you. I consider stack-protection a 'plus' and the program must behave in the same way with and without SSP.

If you are right and the SSP is mandatory for a program then we must ensure that there is no breakage with user cflags ( via filter-flags ).

I made a bit of diff with numactl build of another machine and I have:

(CDPATH="${ZSH_VERSION+.}:" && cd /var/tmp/portage/sys-process/numactl-2.0.12/work/numactl-2.0.12 && /bin/sh '/var/tmp/portage/sys-process/numactl-2.0.12/work/numactl-2.0.12-abi_x86_64.amd64/build-aux/missing' autoheader)

So do you have an idea because here it is doing:
CDPATH="${ZSH_VERSION+.}:" && cd /tmp/portage/sys-process/numactl-2.0.12/work/numactl-2.0.12 && aclocal-1.15 -I m4

?




Comment 6


Agostino Sarubbo






          2021-03-29 15:00:44 UTC
        

Libtool was also broken so I started 'emerge -e world' to see if something will improve. Well it works now, I don't know what exactly was broken but it has not been catched by our tools.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

