Title: 126149 – app-emacs/apel-10.6 compile fails with segfault
URL: https://bugs.gentoo.org/show_bug.cgi?id=126149

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 126149
app-emacs/apel-10.6 compile fails with segfault
Last modified: 2006-04-13 07:18:20 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 126149 
      - app-emacs/apel-10.6 compile fails with segfault


Summary:
app-emacs/apel-10.6 compile fails with segfault
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Emacs project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-03-14 06:04 UTC by Patrizio Bassi





      Modified:
    
2006-04-13 07:18 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Patrizio Bassi





          2006-03-14 06:04:28 UTC
        

path-util.el -> /var/tmp/portage/apel-10.6/image/usr/share/emacs/site-lisp/apel
filename.el -> /var/tmp/portage/apel-10.6/image/usr/share/emacs/site-lisp/apel
install.el -> /var/tmp/portage/apel-10.6/image/usr/share/emacs/site-lisp/apel
>>> Source compiled.
>>> Test phase [not enabled]: app-emacs/apel-10.6

>>> Install apel-10.6 into /var/tmp/portage/apel-10.6/image/ category app-emacs
emacs -batch -q -no-site-file -l APEL-MK -f compile-apel \
        /var/tmp/portage/apel-10.6/image//usr /var/tmp/portage/apel-10.6/image///usr/share/emacs/site-lisp /var/tmp/portage/apel-10.6/image///usr/share/emacs/site-lisp
Loading /var/tmp/portage/apel-10.6/work/apel-10.6/APEL-CFG...
Loading /var/tmp/portage/apel-10.6/work/apel-10.6/APEL-ELS...
Loading /var/tmp/portage/apel-10.6/work/apel-10.6/EMU-ELS...

LISPDIR=/var/tmp/portage/apel-10.6/image///usr/share/emacs/site-lisp
VERSION_SPECIFIC_LISPDIR=/var/tmp/portage/apel-10.6/image///usr/share/emacs/site-lisp
Fatal error (11).make: *** [elc] Segmentation fault

!!! ERROR: app-emacs/apel-10.6 failed.
Call stack:
  ebuild.sh, line 1557:   Called dyn_install
  ebuild.sh, line 1039:   Called src_install

!!! (no error message)
!!! If you need support, post the topmost build error, and the call stack if relevant.


i know nothing about emacs and its tools, so i don't know what's happening




Comment 1


Jakub Moc (RETIRED)






          2006-03-14 06:15:23 UTC
        

emerge --info missing. Also, is this reproducible, i.e. - does it fail again at *exactly* the same place?




Comment 2


Patrizio Bassi





          2006-03-14 06:38:32 UTC
        

Portage 2.1_pre6-r2 (default-linux/x86/2006.0, gcc-4.1.0, glibc-2.3.6-r6, 2.6.16-rc2-git1 i686)
=================================================================
System uname: 2.6.16-rc2-git1 i686 Pentium III (Katmai)
Gentoo Base System version 1.12.0_pre16
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [disabled]
dev-lang/python:     2.4.2-r1
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.91.0.6-r1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r3
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -mtune=pentium3 -march=pentium3 -pipe -fomit-frame-pointer -mmmx -msse -ffast-math"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /etc/mail/dspam /opt/openjms/config /usr/kde/2/share/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/bind /var/qmail/control /var/run/dspam"
CONFIG_PROTECT_MASK="/etc/gconf /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/env.d"
CXXFLAGS="-O3 -mtune=pentium3 -march=pentium3 -pipe -fomit-frame-pointer -mmmx -msse -ffast-math"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks fixpackages metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://www.die.unipd.it/pub/Linux/distributions/gentoo-sources/ http://gentoo.ngi.it"
LANG="it_IT.utf8"
LC_ALL="it_IT.utf8"
LDFLAGS="-Wl,-O1 -Wl,--sort-common -Wl,--enable-new-dtags -Wl,-Bdirect -Wl,--as-needed -Wl,-hashvals -Wl,-zdynsort"
LINGUAS="it"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/myportage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 X X509 Xaw3d a52 aac aalib accessibility acl acpi activefilter adns alsa apache2 apm arts asf audiofile avi bash-completion berkdb bidi bitmap-fonts bootsplash browserplugin bzip2 cairo caps cdda cddb cdio cdparanoia cdr cgi chroot clamav cli client codecs crypt css cups curl dba dbus dga dhcp directfb djbfft dri edl eds emboss encode ethereal exif expat extraengine faac faad fam fbcon ffmpeg fftw firefox flac flash foomaticdb foreign-package fortran ftp gcj gd gdbm geometry ggi gif gimp gimpprint glut glx gnokii gnome gnutls gphoto2 gpm graphviz gs gstreamer gtk gtk2 gtkhtml guile h264 hal iconv idea idn imagemagick imap imlib innodb ipod irda irmc jack java javascript jikes jit joystick jpeg jpeg2k junit justify kde kdeenablefinal kerberos kqemu lame lcd lcms ldap libcaca libclamav libg++ libgda libusb libwww lirc live lm_sensors lua lzo mad mailwrapper matroska md5sum mdb mhash mikmod mime mmx mmx2 mmxext mng mono motif mozcalendar mozdevelop mozilla mozsvg mozxmlterm mp3 mp4 mp4live mpeg mpeg2 mpeg4 mplayer msn msnextras musepack mysql mysqli mythtv nagios-dns nagios-ntp nagios-ping nagios-ssh ncurses neXt network ngui nls nntp no_wxgtk1 nobsh nopie nossp noxalan nptl nptlonly nsplugin oav odbc ogg openal opengl openssl operanom2 oss pam pcre pda pdf pdflib pdo pear perl php png pnp postgres ppds pthreads python qemu-fast qhull qt quicktime quotas readline real rrdtool rtc ruby samba scanner sdl server session sftplogging sguil slang slp snortsam soap sockets socks5 softmmu softquota spamassassin speex spell sqlite3 sse ssl subject-rewrite svg svga tcltk tcpd tetex tga theora tiff tokenizer truetype truetype-fonts trusted type1-fonts udev unicode usb userlocales vidix vorbis win32codecs wma wmf wmv wsconvert wxwindows x264 xanim xchatdccserver xchattext xcomposite xine xinerama xml xml2 xmlrpc xmms xosd xpm xprint xsl xv xvid xvm xvmc zlib elibc_glibc kernel_linux linguas_it userland_GNU"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, MAKEOPTS



100% reproducable, always same point, even if i go the that temp dir.




Comment 3


Matthew Kennedy (RETIRED)






          2006-03-14 22:42:51 UTC
        

It works for me with app-editors/emacs-cvs.  Are you using app-editors/emacs-cvs or app-editors/emacs?  Also, I don't have your complicated LD_FLAGS or CFLAGS and I'm unlikely to even test them -- have you tried with simpler settings?

localhost:~$ emerge info
*** Deprecated use of action 'info', use '--info' instead
Portage 2.1_pre5-r4 (default-linux/x86/2005.1, gcc-3.4.5, glibc-2.3.6-r3, 2.6.14-gentoo-r6 i686)
=================================================================
System uname: 2.6.14-gentoo-r6 i686 AMD Athlon(tm) XP 3200+
Gentoo Base System version 1.12.0_pre16
dev-lang/python:     2.3.5, 2.4.2-r1
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1-r2
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r3
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=athlon-xp -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/share/X11/xkb /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/texmf/web2c /etc/env.d"
CXXFLAGS="-O2 -march=athlon-xp -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig cvs digest distlocks noclean notitles sandbox sfperms sign strict userpriv usersandbox"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LC_ALL="en_US.UTF-8"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow X a52 aac acl alsa avi berkdb bitmap-fonts browserplugin bzip2 cairo cdda cddb cdio cjk crypt cups dbus doc dri dts dv dvb dvd dvdr dvdread emacs emboss encode examples exif ffmpeg firefox flac foomaticdb fortran gcj gdbm gif gnome gnutls gstreamer gtk gtk2 guile hal howl imlib java jpeg lcms libg++ libwww live lzo mad matroska mikmod mmx mmxext mod mozilla mp3 mpeg ncurses nfs nls nptl nptlonly nsplugin offensive ogg oggvorbis opengl pam pcre pdflib png python quicktime readline real screen sdl shout source speex spell sse ssl stream svg tcpd tga theora threads tiff truetype truetype-fonts type1-fonts unicode utf8 v4l v4l2 vcd vlm vorbis win32codecs xml xml2 xv zlib elibc_glibc kernel_linux userland_GNU"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, LANG, LDFLAGS, LINGUAS





Comment 4


Patrizio Bassi





          2006-03-15 00:53:57 UTC
        

i unset my c/ldflags, same error

i'm using emacs, no cvs.
exactly same error

Portage 2.1_pre6-r3 (default-linux/x86/2006.0, gcc-4.1.0, glibc-2.3.6-r6, 2.6.16-rc2-git1 i686)
=================================================================
System uname: 2.6.16-rc2-git1 i686 Pentium III (Katmai)
Gentoo Base System version 1.12.0_pre16
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [disabled]
dev-lang/python:     2.4.2-r1
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.91.0.6-r1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r3
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -mcpu=i686 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /etc/mail/dspam /opt/openjms/config /usr/kde/2/share/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/bind /var/qmail/control /var/run/dspam"
CONFIG_PROTECT_MASK="/etc/gconf /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/env.d"
CXXFLAGS=""
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks fixpackages metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://www.die.unipd.it/pub/Linux/distributions/gentoo-sources/ http://gentoo.ngi.it"
LANG="it_IT.utf8"
LC_ALL="it_IT.utf8"
LINGUAS="it"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/myportage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 X X509 Xaw3d a52 aac aalib accessibility acl acpi activefilter adns alsa apache2 apm arts asf audiofile avi bash-completion berkdb bidi bitmap-fonts bootsplash browserplugin bzip2 cairo caps cdda cddb cdio cdparanoia cdr cgi chroot clamav cli client codecs crypt css ctype cups curl dba dbus dga dhcp directfb djbfft dri edl eds emboss encode ethereal exif expat extraengine faac faad fam fastbuild fbcon ffmpeg fftw firefox flac flash foomaticdb force-cgi-redirect foreign-package fortran ftp gcj gd gdbm geometry ggi gif gimp gimpprint glut glx gnokii gnome gnutls gphoto2 gpm graphviz gs gstreamer gtk gtk2 gtkhtml guile h264 hal iconv idea idn imagemagick imap imlib innodb ipod irda irmc jack java javascript jikes jit joystick jpeg jpeg2k junit justify kde kdeenablefinal kerberos kqemu lame lcd lcms ldap libcaca libclamav libg++ libgda libusb libwww lirc live lm_sensors lua lzo mad mailwrapper matroska md5sum mdb memlimit mhash mikmod mime mmx mmx2 mmxext mng mono motif mozcalendar mozdevelop mozilla mozsvg mozxmlterm mp3 mp4 mp4live mpeg mpeg2 mpeg4 mplayer msn msnextras musepack mysql mysqli mythtv nagios-dns nagios-ntp nagios-ping nagios-ssh ncurses neXt network ngui nls nntp no_wxgtk1 nobsh nopie nossp noxalan nptl nptlonly nsplugin oav odbc ogg openal opengl openssl operanom2 oss pam pcre pda pdf pdflib pdo pear perl php png pnp posix postgres ppds pthreads python qemu-fast qhull qt quicktime quotas readline real rrdtool rtc ruby samba scanner sdl server session sftplogging sguil simplexml slang slp snortsam soap sockets socks5 softmmu softquota spamassassin speex spell spl sqlite3 sse ssl subject-rewrite svg svga tcltk tcpd tetex tga theora tiff tokenizer truetype truetype-fonts trusted type1-fonts udev unicode usb userlocales vidix vorbis win32codecs wma wmf wmv wsconvert wxwindows x264 xanim xchatdccserver xchattext xcomposite xine xinerama xml xml2 xmlrpc xmms xosd xpm xprint xsl xv xvid xvm xvmc zlib elibc_glibc kernel_linux linguas_it userland_GNU"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, LDFLAGS, MAKEOPTS





Comment 5


Patrizio Bassi





          2006-03-30 00:09:58 UTC
        

i have same problem with other similar packages.

probably elc problem..should i compile emacs somehow?
i mean cflags or similar filtered out..




Comment 6


Matthew Kennedy (RETIRED)






          2006-03-30 07:56:15 UTC
        

You mentioned that you have the same problem with other packages.  Please list them here also.




Comment 7


Patrizio Bassi





          2006-03-30 08:10:50 UTC
        

analog for example

>>> Compiling source in /var/tmp/portage/analog-1.29/work/analog-1.29 ...
Fatal error (11)./usr/portage/app-emacs/analog/analog-1.29.ebuild: line 20: 29801 Segmentation fault      emacs --batch -f batch-byte-compile --no-site-file --no-init-file *.el
>>> Source compiled.
>>> Test phase [not enabled]: app-emacs/analog-1.29

(ehi this shows the analog ebuild is bugged and merge goes ahead...check that too!)




Comment 8


Patrizio Bassi





          2006-03-30 08:13:11 UTC
        

i'm sure it's emacs to seg. fault....why...no idea.




Comment 9


Patrizio Bassi





          2006-04-12 02:04:18 UTC
        

no news? any idea to fix like compile emacs with some flags...




Comment 10


Matthew Kennedy (RETIRED)






          2006-04-12 08:06:49 UTC
        

Have you tried building an emacs with USE='-*' -- ie. all emacs use flags disabled?  It could be a problem with a linked library.  Can you compile elisp files outside of emerge? cp analog.el to your ~/ and run "emacs -batch -f byte-compile-file -q analog.el".  If you can reproduce it there, could you try compiling emacs on your system outside of emerge (ie. download the emacs source, build it yourself), see if that also reproduces the problem.  If it does segfault there, set ulimit -c unlimited and get a backtrace on the core file.




Comment 11


Patrizio Bassi





          2006-04-12 08:22:10 UTC
        

it fails outside emerge too.

i'll try building emacs with simple cflags...




Comment 12


Patrizio Bassi





          2006-04-13 07:18:20 UTC
        

i compiled emacs with safer cflags (-O2) and now it works.

try to filter it.

i close this now. thanks for help









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

