Title: 158546 – sys-devel/gcc-4.1.1-r1 fails the bootstrap comparision on Efika
URL: https://bugs.gentoo.org/show_bug.cgi?id=158546

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 158546
sys-devel/gcc-4.1.1-r1 fails the bootstrap comparision on Efika
Last modified: 2007-10-07 04:29:09 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 158546 
      - sys-devel/gcc-4.1.1-r1 fails the bootstrap comparision on Efika


Summary:
sys-devel/gcc-4.1.1-r1 fails the bootstrap comparision on Efika
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-12-19 07:53 UTC by Fernando J. Pereda (RETIRED)





      Modified:
    
2007-10-07 04:29 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge output

              (gcc-fails,4.29 KB,
                text/plain)

            
2006-12-19 07:55 UTC,

            Fernando J. Pereda (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Fernando J. Pereda (RETIRED)






          2006-12-19 07:53:05 UTC
        

I'm getting the attached errors while building gcc-4.1.1-r1 on the Efika. This is my emerge --info:

--8<--
demeter ~ # emerge --info
Portage 2.1.1-r2 (default-linux/ppc/ppc32/2006.1, gcc-4.1.1, glibc-2.4-r3, 2.6.19-efika ppc)
=================================================================
System uname: 2.6.19-efika ppc G2_LE
Gentoo Base System version 1.12.6
Last Sync: Mon, 18 Dec 2006 21:00:01 +0000
distcc 2.18.3 powerpc-unknown-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: [Not Present]
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.16
ACCEPT_KEYWORDS="ppc"
AUTOCLEAN="yes"
CBUILD="powerpc-unknown-linux-gnu"
CFLAGS="-Os -mcpu=603e -pipe"
CHOST="powerpc-unknown-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/terminfo"
CXXFLAGS="-Os -mcpu=603e -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distcc distlocks metadata-transfer nodoc noinfo noman sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo
"                                                                                                   MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='
/packages'"                                                                                         PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="ppc alsa alsa_cards_aoa alsa_cards_aoa-fabric-layout alsa_cards_aoa-onyx alsa_cards_aoa-soundbu
s alsa_cards_aoa-soundbus-i2s alsa_cards_aoa-tas alsa_cards_aoa-toonie alsa_cards_powermac alsa_cards_usb-audio alsa_cards_via82xx apache2 berkdb bitmap-fonts bonobo cdr cli cracklib crypt cups dlloader dri dvd elibc_glibc emboss encode firefox gdbm gif gpm gstreamer gtkhtml iconv input_devices_evdev input_devices_keyboard input_devices_mouse ipv6 isdnlog jpeg kernel_linux libg++ libwww mad mikmod mozilla mp3 mpeg ncurses nptl nptlonly ogg opengl pam pcre pdf perl png pppd python qt3 qt4 quicktime readline reflection ruby sdl session spell spl ssl tcpd truetype truetype-fonts type1-fonts udev unicode userland_GNU video_cards_ati video_cards_chips video_cards_dummy video_cards_fbdev video_cards_glint video_cards_imstt video_cards_mga video_cards_nv video_cards_s3 video_cards_s3virge video_cards_savage video_cards_sisusb video_cards_tdfx video_cards_trident video_cards_v4l video_cards_voodoo vorbis xml xorg xv zlib"                                                                         Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY
--8<--

I'm using nfsroot with local swap (~1Gb). Here is cpuinfo and meminfo in case it matters:

--8<--
demeter ~ # cat /proc/cpuinfo 
processor       : 0
cpu             : G2_LE
clock           : 396.000000MHz
revision        : 1.4 (pvr 8082 2014)
bogomips        : 65.53
timebase        : 33000000
platform        : Efika
machine         : EFIKA5K2 CHRP PowerPC System
revision        : 2B3
vendor          : bplan
demeter ~ # cat /proc/meminfo 
MemTotal:       125760 kB
MemFree:         40816 kB
Buffers:             0 kB
Cached:          77180 kB
SwapCached:        996 kB
Active:          41452 kB
Inactive:        37100 kB
SwapTotal:     1326488 kB
SwapFree:      1324100 kB
Dirty:               0 kB
Writeback:           0 kB
AnonPages:        1204 kB
Mapped:           1796 kB
Slab:             5044 kB
SReclaimable:     2928 kB
SUnreclaim:       2116 kB
PageTables:        200 kB
NFS_Unstable:        0 kB
Bounce:              0 kB
CommitLimit:   1389368 kB
Committed_AS:     7624 kB
VmallocTotal:   868276 kB
VmallocUsed:       820 kB
VmallocChunk:   867452 kB
--8<--

Also note that I've tried with and without distcc and with MAKEOPTS="-j5" and I always get the same error.

During the compiling the machine swaps a lot (~150Mb of swap is used sometimes)

Please feel free to ignore the bug if you consider my setup just too weird. Pointers to what to look for will be DEFINITELY useful, though.

- ferdy




Comment 1


Fernando J. Pereda (RETIRED)






          2006-12-19 07:55:55 UTC
        

Created attachment 104362 [details]
emerge output

I meant MAKEOPTS="-j1" and not MAKEOPTS="-j5" (thats what emerge --info is already showing)

- ferdy




Comment 2


David Gurvich





          2006-12-19 08:59:21 UTC
        

I was never able to build gcc-4.1.1-r1 on my ppc system, but r2 and r3 both built.




Comment 3


SpanKY






          2006-12-19 14:35:35 UTC
        

i'd suspect your NFS is causing problems rather than gcc ... you didnt really provide any information about it




Comment 4


Fernando J. Pereda (RETIRED)






          2006-12-19 14:52:57 UTC
        

This is the export line on the server:

--8<--
/path host(insecure,no_root_squash,rw,sync)
--8<--

I'm using the following kernel arguments on the Efika:

--8<--
ip=CLIENT_IP::GATEWAY root=/dev/nfs nfsroot=SERVER_IP:/path
--8<--

I'm using vanilla-sources-2.6.17.6 on the server. And:

--8<--
[ebuild   R   ] net-fs/nfs-utils-1.0.6-r6  USE="tcpd" 0 kB
--8<--

I'm not sure what kind of information you'd need. Thanks.

- ferdy






Comment 5


SpanKY






          2006-12-19 20:07:50 UTC
        

ugh, that probably means you're using like nfsv2 with udp

please force nfsvers=3 and tcp proto

you should also use async ... i dont think the data guarantee you should really be worried about in your setup




Comment 6


Fernando J. Pereda (RETIRED)






          2006-12-20 08:56:32 UTC
        

Same problem though different files seem to differ:

--8<--
Bootstrap comparison failure!
./builtins.o differs
./c-common.o differs
./c-cppbuiltin.o differs
./combine.o differs
./cse.o differs
./except.o differs
./flow.o differs
./function.o differs
./gcc.o differs
./ifcvt.o differs
./insn-attrtab.o differs
./insn-recog.o differs
./loop.o differs
./optabs.o differs
./recog.o differs
./sched-rgn.o differs
./varasm.o differs
cp/cp-lang.o differs
--8<--

This is the mount line in the client (the Efika):

--8<--
192.168.0.2:/mnt/biggie/.chroots/efika on / type nfs (rw,tcp,nfsvers=3,addr=192.168.0.2)
--8<--

And the new export line in the server:

--8<--
/path host(insecure,no_root_squash,rw,async)
--8<--

- ferdy




Comment 7


SpanKY






          2007-10-07 04:29:09 UTC
        

i really think this is a kernel/fs problem, not gcc









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

