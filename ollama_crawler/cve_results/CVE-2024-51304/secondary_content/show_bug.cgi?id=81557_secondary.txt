Title: 81557 – KDE apps fail to load modules.
URL: https://bugs.gentoo.org/show_bug.cgi?id=81557

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 81557
KDE apps fail to load modules.
Last modified: 2005-05-12 12:02:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 81557 
      - KDE apps fail to load modules.


Summary:
KDE apps fail to load modules.
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-02-10 18:03 UTC by Paul Slinski





      Modified:
    
2005-05-12 12:02 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



sbriesen









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Paul Slinski





          2005-02-10 18:03:06 UTC
        

after merging the update: arts-1.3.2-r1 KDE no longer functions properly. KDE will start, arts will segfault and kdesktop will fail to run.

unmerging arts allows normal operation of KDE.

I merged arts again, and rebuilt kdemultimedia. arts no longer segfaults, but kdesktop still fails to run.


Reproducible: Always
Steps to Reproduce:
1. emerge an older version of arts
2. emerge arts-1.3.2-r1
3. attempt to use KDE as a desktop

Actual Results:  
No error output from kdesktop.


Portage 2.0.51-r15 (default-linux/x86/2004.3, gcc-3.4.3,
glibc-2.3.4.20041102-r0, 2.6.10-gentoo-r6 i686)
=================================================================
System uname: 2.6.10-gentoo-r6 i686 Intel(R) Pentium(R) 4 CPU 3.06GHz
Gentoo Base System version 1.6.9
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb  7 2005, 21:40:39)]
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.3 [enabled]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.5, 1.8.5-r3, 1.6.3, 1.7.9-r1, 1.4_p6, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r2
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CFLAGS="-O3 -march=pentium4 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /opt/openjms/config /usr/kde/2/share/config
/usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown
/usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref
/usr/share/config /usr/share/texmf/dvipdfm/config/
/usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/
/usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=pentium4 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms"
GENTOO_MIRRORS="http://mirror.datapipe.net/gentoo
http://mirror.datapipe.net/gentoohttp://gentoo.mirrors.pair.com/"
LDFLAGS="-Wl,-z,now"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X a52 aac aalib alsa aotuv apm arts artswrappersuid audiofile avi
bash-completion berkdb bitmap-fonts bzip2 caps cdparanoia crypt cups divx4linux
djbfft dmalloc dpms dts dv dvd dvdread dxr3 ecc edl encode esd f77 fam fame flac
font-server foomaticdb fpx gcj gdbm gif gimp gnokii gnome gphoto2 gpm graphviz
gstreamer gtk gtk2 gtkhtml idea ieee1394 imagemagick imlib ipv6 jack jai java
javascript jce jimi jms jmx jpeg jpeg2k junit kde kdeenablefinal lcms libcaca
libclamav libg++ libwww live lzomad matroska mikmod mjpeg mmap mmx mmx2 mng
motif mozcalendar mozdevelop mozilla moznocompose moznoirc moznomail mozp3p
mozxmlterm mpeg multicall mythtv nas ncurses network nptl nvidia offensive
oggvorbis openal opengl oss pam pda pdflib perl pic png povray pvm python qt
quicktime readline real rtc samba sblive scanner sdl silc slangslp sms sndfile
spell sse sse2 ssl svg svga svgz tcltk tcpd tetex tga theora threads tiff
truetype truetype-fonts type1-fonts userlocales v4l v4l2 vidix wifi wmf
xanimxine xinerama xml xml2 xmms xprint xscreensaver xv xvid xvmc zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL




Comment 1


Gregorio Guidi (RETIRED)






          2005-02-11 08:06:28 UTC
        

1.3.2-r1 is a very minor update, and it is not likely to be the main cause
of artsd crashing, and as you said, the crash could not be reproduced with
that version afterwards...
Unfortunately, arts crashing randomly at startup is not something never seen,
as you can see by searching http://bugs.kde.org, and we can't do much for it.

For the kdesktop problem, some hint would be useful (something in
~/.xsession-errors?), since I cannot reproduce it here.





Comment 2


Stefan Briesenick (RETIRED)






          2005-02-11 15:23:23 UTC
        

I have the same problem here. I don't know if aRts is the problem, but there were some KDE related updates and now KDE is very instable and lot of things are broken. Amarok doesn't start anymore:

amaroK: [Loader] Starting amarokapp..
amaroK: [Loader] Don't run gdb, valgrind, etc. against this binary! Use amarokapp.
amarokapp: symbol lookup error: amarokapp: undefined symbol: _ZTI9QGLWidget




Comment 3


Stefan Briesenick (RETIRED)






          2005-02-11 15:27:37 UTC
        

oh well, I enabled the new 'kdeenablefinal'. But I had never any problems with

myconf="--enable-final" emerge kde

in the past. But perhaps the new use-flag broke something?






Comment 4


Paul Slinski





          2005-02-11 16:09:01 UTC
        

There are some errors starting artsd that might help, but after I rebuilt kdemultimedia they went away.
Stefan Briesenick, do you have any debug info? 

I got them doing a: artswrapper -l0

I can't seem to get any debug info from kdesktop (which seems to be the main problem here).




Comment 5


Stefan Briesenick (RETIRED)






          2005-02-11 16:49:09 UTC
        

no debug output right now. I try to re-emerge some of the kdelibs/kdebase and such things. If it still exists, I try to get some debug info.

btw: there was also an nvidia-kernel update. And amarok shows an GL error. Also 'slickclock'. Hmm....




Comment 6


Paul Slinski





          2005-02-11 19:09:55 UTC
        

I thought maybe I'd rebuild kdebase, but now we have the following problem:

checking for perl... /usr/bin/perl
checking for Qt... libraries /usr/qt/3/lib, headers /usr/qt/3/include using -mt
checking for moc... /usr/qt/3/bin/moc
checking for uic... /usr/qt/3/bin/uic
checking whether uic supports -L ... yes
checking whether uic supports -nounload ... yes
checking if Qt needs -ljpeg... no
checking for rpath... yes
checking for KDE... libraries /usr/kde/3.3/lib, headers /usr/kde/3.3/include
checking if UIC has KDE plugins available... no
configure: error: you need to install kdelibs first.

!!! ERROR: kde-base/kdebase-3.3.2-r2 failed.
!!! Function kde_src_compile, Line 141, Exitcode 1
!!! died running ./configure, kde_src_compile:configure
!!! If you need support, post the topmost build error, NOT this status message.

Maybe we just have a path problem?




Comment 7


Stefan Briesenick (RETIRED)






          2005-02-12 05:01:26 UTC
        

yeahh!!! same problem here. "emerge amarok" gives the same error.

But: "emerge kdelibs" works and then you can emerge "kdebase" or "amarok" again.




Comment 8


Gregorio Guidi (RETIRED)






          2005-02-12 06:35:18 UTC
        

For this problem:
checking if UIC has KDE plugins available... no

see for instance bug 81066 or 81511, it's related to a Qt upgrade probably.

> amarokapp: symbol lookup error: amarokapp: undefined symbol: _ZTI9QGLWidget

this is strange, did you recompile Qt with USE="-opengl"?

What have you upgraded other than arts? qt, kdelibs, kdebase...

> There are some errors starting artsd that might help, but after I rebuilt 
> kdemultimedia they went away.

Sometimes this can happen when mixing things compiled with gcc-3.3 and gcc-3.4
maybe this is the case? See bug 61146 or 67532 for further information.





Comment 9


Paul Slinski





          2005-02-12 09:03:36 UTC
        

Gregorio, this is a fresh system. Everything is built with the same version of gcc.

So far, I've rebuilt just about every base kde build to try and solve the problem.

If I run KDE for the root user, everything is fine. Maybe it's permissions?




Comment 10


Gregorio Guidi (RETIRED)






          2005-02-12 10:12:38 UTC
        

any hint when running 'kdesktop' form a konsole?




Comment 11


Paul Slinski





          2005-02-12 10:27:13 UTC
        

Gregorio, no just a vague message:

(output using gdb)
[New Thread -1233053376 (LWP 4187)]
Detaching after fork from child process 4190.
kdesktop: Saver Engine started, timeout: 900
kio (KSycoca): Trying to open ksycoca from /var/tmp/kdecache-snafu/ksycoca
kdesktop: KDIconView::initDotDirectories found dir /home/snafu/Desktop/
kio (KTrader): KServiceTypeProfile::offers( ThumbCreator, )
kio (KTrader): Returning 12 offers
kdesktop: m_excludeListkdedevice/floppy5_mounted,kdedevice/cdwriter_mounted,kdedevice/cdrom_mounted,kdedevice/dvd_mounted,kdedevice/floppy_mounted,kdedevice/hdd_mounted,kdedevice/nfs_mounted,kdedevice/smb_mounted,kdedevice/zip_mounted,print/printer,kdedevice/floppy5_unmounted,kdedevice/cdwriter_unmounted,kdedevice/cdrom_unmounted,kdedevice/dvd_unmounted,kdedevice/floppy_unmounted,kdedevice/hdd_unmounted,kdedevice/nfs_unmounted,kdedevice/smb_unmounted,kdedevice/zip_unmounted
kdesktop:  m_excludeList / item count:19
ERROR: Communication problem with kdesktop, it probably crashed.

Whish is, of course, not much of an error and there are no "verbose" or "debug" command line options available.

Next new crash is: kcminit
It seems that the more I re-build, the worse it gets.

Which package provides kdesktop?





Comment 12


Gregorio Guidi (RETIRED)






          2005-02-12 11:29:26 UTC
        

> Which package provides kdesktop?
kdebase

Have you tried cleaning completely /tmp/kde* and /var/tmp/kdecache* and
restarting everything? The permissions on /tmp/.ICE-unix and /tmp/.X11-unix
should be considered, too, since it seems that inter process communication
with dcop does not work at all.





Comment 13


Paul Slinski





          2005-02-12 18:52:31 UTC
        

The only way to clear up the kdesktop problem was to move my .kde-3.3 directory and allow kde to start over again with fresh settings.

However, a few applications still crash, namely kcminit.

I removed all of the temp files in /tmp, /var/tmp and ~/.mcop etc. and it didn't help.

These errors all started after the last kde package updates:
kdelibs-3.3.2-r2
arts-1.3.2-r1
kdebase-3.3.2-r2

The QT update came later.

Is there something that changed in those builds that would affect normal operations?





Comment 14


Stefan Briesenick (RETIRED)






          2005-02-13 16:00:50 UTC
        

after rebuilding all KDE compoments, everything is fine. I think, it was the 'kdeenablefinal' which broke things when only some components are merged with it. After remerging *all* KDE components with 'kdeenablefinal', my problems are gone. ;)

emerge --newuse world

is your friend. ;)





Comment 15


Paul Slinski





          2005-02-13 19:49:07 UTC
        

Stefan: Thank you for the info on that command line option. I never knew it existed. However, it didn't help.

Gregorio: kcminit is crashing when trying to lad the kgamma module. I'll investigate further.

As fo the initial bug, I suppose we've fixed it somehow - that is, if Stefan is up and running.

Sure was an interesting mystery. 





Comment 16


Stefan Briesenick (RETIRED)






          2005-02-13 20:19:44 UTC
        

I'm up and running again.

beside the amarok problem and the compile errors after, my "Plastik" were gone. Not available anymore in KControl. Strange look.

Solution:

1. (re-)emerge kdelibs
2. (re-)emerge all other kde stuff

all problems are gone now.




Comment 17


Gregorio Guidi (RETIRED)






          2005-02-14 07:24:56 UTC
        

So, all problems seem to happen when loading modules provided by packages that
were not recompiled... (arts loads modules provided by kdemultimedia at 
startup, and kgamma is provided by kdegraphics). Really strange...

by the way, the problem of disappearing styles is again bug 81066.





Comment 18


Paul Slinski





          2005-02-14 07:34:09 UTC
        

Gregorio: Correct it seems to be a problem with modules.

I managed to get around the kcminit issue by renaming kcm_kgamma.so to kcm_kgamma.so-old so that kcminit wouldn't find it and try to execute it.






Comment 19


Gregorio Guidi (RETIRED)






          2005-03-06 08:59:32 UTC
        

Still having problems? Or found any hints?




Comment 20


Stefan Briesenick (RETIRED)






          2005-03-07 16:48:11 UTC
        

it works for me. If you have such strange happenings, just re-emerge kdelibs/kdebase and in this case kdeartwork and your problems are gone. Not nice, but it works.





Comment 21


Paul Slinski





          2005-03-22 15:36:51 UTC
        

Still having difficulties with the kgamma module (with KDE 3.4 this time) as well as one named kdns.

Should I file a different bug report?




Comment 22


Gregorio Guidi (RETIRED)






          2005-03-23 02:40:14 UTC
        

> Should I file a different bug report?
That's not needed.

Have you tried without setting LDFLAGS, this really seems a compiler/linker problem...




Comment 23


Gregorio Guidi (RETIRED)






          2005-05-12 09:17:19 UTC
        

No reply from reporter.




Comment 24


Paul Slinski





          2005-05-12 09:36:12 UTC
        

(Could have sworn I updated this)

OK, I gave up. I tried a plethora of different compiles, flags etc. and none helped. I wound up removing the offending modules from /usr/kde/3.4/lib/kde3/kcm_kgamma.so etc. 

No huge loss.




Comment 25


Gregorio Guidi (RETIRED)






          2005-05-12 11:53:58 UTC
        

Have you tried without LDFLAGS, too? And disabling ccache? (otherwise any try could be useless)




Comment 26


Paul Slinski





          2005-05-12 12:02:47 UTC
        

Oh, I didn't think to disable ccache.
I'll try tonight if you like.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

