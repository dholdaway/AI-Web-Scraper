Title: 322645 – sys-apps/devicekit-disks can not find DEVICEMAPPER
URL: https://bugs.gentoo.org/show_bug.cgi?id=322645

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 322645
sys-apps/devicekit-disks can not find DEVICEMAPPER
Last modified: 2010-08-10 13:52:57 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 322645 
      - sys-apps/devicekit-disks can not find DEVICEMAPPER


Summary:
sys-apps/devicekit-disks can not find DEVICEMAPPER
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Freedesktop bugs








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-06-03 17:04 UTC by Patrice





      Modified:
    
2010-08-10 13:52 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge--info,5.09 KB,
                text/plain)

            
2010-06-03 17:14 UTC,

            Patrice




Details





config.log

              (config.log,35.56 KB,
                text/plain)

            
2010-06-03 17:15 UTC,

            Patrice




Details





build.log

              (build.log,8.03 KB,
                text/plain)

            
2010-06-03 17:21 UTC,

            Patrice




Details





environment

              (environment,60.12 KB,
                text/plain)

            
2010-06-03 17:22 UTC,

            Patrice




Details





pkg-config --list-all

              (pkg-config-list,44.82 KB,
                text/plain)

            
2010-06-04 16:28 UTC,

            Patrice




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Patrice





          2010-06-03 17:04:19 UTC
        

When trying to update to gnome 2.28 on a stable amd64 gentoo system, devicekit-disks-009 failed to emerge, and some others packages are not able to emerge due to dependancies (gnome-disk-utility, gvfs ...).

Reproducible: Always

Steps to Reproduce:
1.emerge --sync
2.emerge -uDN world
3.

Actual Results:  
checking for POLKIT_GOBJECT_1... yes
checking for POLKIT_BACKEND_1... yes
checking for LIBPARTED... yes
checking for DEVMAPPER... configure: error: Package requirements (devmapper >= 1.02) were not met:

No package 'devmapper' found

Consider adjusting the PKG_CONFIG_PATH environment variable if you
installed software in a non-standard prefix.

Alternatively, you may set the environment variables DEVMAPPER_CFLAGS
and DEVMAPPER_LIBS to avoid the need to call pkg-config.
See the pkg-config man page for more details.


!!! Please attach the following file when seeking support:
!!! /home/portage/portage/sys-apps/devicekit-disks-009/work/DeviceKit-disks-009/config.log
 * ERROR: sys-apps/devicekit-disks-009 failed:
 *   econf failed
 * 
 * Call stack:
 *     ebuild.sh, line   54:  Called src_configure
 *   environment, line 1610:  Called gnome2_src_configure
 *   environment, line 1353:  Called econf '--localstatedir=/var' '--disable-ansi' '--enable-man-pages' '--disable-verbose-mode' '--disable-gtk-doc'
 *     ebuild.sh, line  544:  Called die
 * The specific snippet of code:
 *   			die "econf failed"
 * 
 * If you need support, post the output of 'emerge --info =sys-apps/devicekit-disks-009',
 * the complete build log and the output of 'emerge -pqv =sys-apps/devicekit-disks-009'.
 * The complete build log is located at '/home/portage/portage/sys-apps/devicekit-disks-009/temp/build.log'.
 * The ebuild environment file is located at '/home/portage/portage/sys-apps/devicekit-disks-009/temp/environment'.
 * S: '/home/portage/portage/sys-apps/devicekit-disks-009/work/DeviceKit-disks-009'

>>> Failed to emerge sys-apps/devicekit-disks-009, Log file:

>>>  '/home/portage/portage/sys-apps/devicekit-disks-009/temp/build.log'

So emerge fail !

Expected Results:  
Should work ...

Don't know if it's a bug or if it comes from my system.
I have tried to solve posting on french forum, but no one can helped.




Comment 1


Patrice





          2010-06-03 17:14:07 UTC
        

Created attachment 234001 [details]
emerge --info




Comment 2


Patrice





          2010-06-03 17:15:57 UTC
        

Created attachment 234003 [details]
config.log




Comment 3


Patrice





          2010-06-03 17:21:43 UTC
        

Created attachment 234005 [details]
build.log




Comment 4


Patrice





          2010-06-03 17:22:05 UTC
        

Created attachment 234007 [details]
environment




Comment 5


Rafał Mużyło





          2010-06-03 20:12:53 UTC
        

What does 'pkg-config devmapper --modversion' print, while run 
from command line ?
What version of lvm2 you have installed ?




Comment 6


Patrice





          2010-06-04 05:57:23 UTC
        

Hi,

This is what I have :

pkg-config devmapper --modversion
Package devmapper was not found in the pkg-config search path.
Perhaps you should add the directory containing `devmapper.pc'
to the PKG_CONFIG_PATH environment variable
No package 'devmapper' found

And :

lvm2 2.02.56-r2

is installed.




Comment 7


Rafał Mużyło





          2010-06-04 13:06:18 UTC
        

First check if /usr/lib/pkgconfig/devmapper.pc exists.
If not, reemerge sys-fs/lvm2.
If still not, attach its build log.

However, if it does exist, it will mean, that something
is wrong with either pkg-config or one of the files in
/usr/lib/pkgconfig/.




Comment 8


Patrice





          2010-06-04 14:23:34 UTC
        

Hi,
I have this :

ls -la /usr/lib/pkgconfig/
total 24
drwxr-xr-x  2 root    root    4096  4 juin  16:13 .
drwxr-xr-x 25 patrice patrice 4096 26 mai   15:41 ..
-r--r--r--  1 root    root     286  4 juin  16:12 devmapper-event.pc
-r--r--r--  1 root    root     220  4 juin  16:12 devmapper.pc
-rw-r--r--  1 root    root     235 27 mai   01:52 libgcj-4.4.3.pc
lrwxrwxrwx  1 root    root      15 27 mai   01:54 libgcj-4.4.pc -> libgcj-4.4.3.pc
lrwxrwxrwx  1 root    root      15 27 mai   01:54 libgcj.pc -> libgcj-4.4.3.pc
-r--r--r--  1 root    root     226  4 juin  16:12 lvm2app.pc

I reemerge sys-fs/lvm2, but no change with devicekit-disks' emerge.
And here is devmapper.pc :

prefix=/usr
exec_prefix=${prefix}
libdir=/usr/lib64
includedir=${prefix}/include

Name: devmapper
Description: device-mapper library
Version: 1.02.40
Cflags: -I${includedir}
Libs: -L${libdir} -ldevmapper
Libs.private:






Comment 9


Rafał Mużyło





          2010-06-04 16:05:46 UTC
        

OK, let's see:
- does 'pkg-config --list-all' lists all of those ?
- if you temporarily move those pc files from gcc,
is devmapper reported correctly ?




Comment 10


Patrice





          2010-06-04 16:28:54 UTC
        

Created attachment 234125 [details]
pkg-config --list-all

Hi, here is the result of
pkg-config --list-all
I don't know how to read that, sorry ...
But, it seems that there are 2 problems with lapack.pc and blas.pc.




Comment 11


Patrice





          2010-06-04 16:32:11 UTC
        

(In reply to comment #9)
> OK, let's see:
> - does 'pkg-config --list-all' lists all of those ?
> - if you temporarily move those pc files from gcc,
> is devmapper reported correctly ?
> 

No, it's not reported correctly.




Comment 12


Rafał Mużyło





          2010-06-04 19:28:41 UTC
        

Try fixing the problem with those two files first.

I think I've seen a bug, where due to malformed
pkgconfig file from one package, a different
package was incorrectly reported, though I can't
remember the number.

You may need a sort of "bisect" - leave devmapper pc files,
temporarily move half of the other files, '--list-all',
see if all are listed, if they are, add half of remaining,
if not, remove half of the added, repeat, till you find one,
that breaks it (yeah, it will be a pain).

Cause if that's not it, I've got no idea - this pc file, you've
pasted, looks correct.




Comment 13


Rémi Cardona (RETIRED)






          2010-06-06 20:02:08 UTC
        

gnome is in fdo alias




Comment 14


Patrice





          2010-06-07 18:35:52 UTC
        

(In reply to comment #13)
> gnome is in fdo alias
> 

What does it mean ? Sorry, I don't understand fdo !




Comment 15


Jorge Manuel B. S. Vicetto (RETIRED)






          2010-06-07 18:49:48 UTC
        

FDO = FreeDesktop.org - in this particular case the team that deals with these bugs

What Rémi meant was that the GNOME team doesn't need to get all notifications in this bug in duplicate as they already get all notifications sent to the freedesktop alias.




Comment 16


Rafał Mużyło





          2010-06-07 23:54:01 UTC
        

(In reply to comment #13)
> gnome is in fdo alias
> 

Duly noted.




Comment 17


Patrice





          2010-06-11 15:36:17 UTC
        

Hi all,
I managed it to work.
There are devmapper.pc and devmapper-event.pc as well as lvm2app.pc in
/usr/lib/pkgconfig
But, there are missing in 
/usr/lib64/pkgconfig
I don't know why.
I create a symlink :
ln -s /usr/lib/pkgconfig/devmapper* /usr/lib64/pkgconfig/
(the same for lvm2app.pc)
And devicekit-disks emerge normally, as well as the entire Gnome
packages.
Don't think it's a bug finally ...
Sorry for the inconvenience, and thanks a lot for your help.







Comment 18


Gilles Dartiguelongue (RETIRED)






          2010-08-10 13:13:17 UTC
        

This could very well be a problem of a package installing a bad .pc file that makes --list-all fail (that also makes the macro fail) as said in comment #7.

Symlinking probably made the relevant .pc files appear earlier in the list which allowed configure to run successfully, however, you probably have other packages that won't work. Can you still reproduce the problem ? Can you find a package that has a .pc file that is not listed in pkg-config --list-all output ?




Comment 19


Samuli Suominen (RETIRED)






          2010-08-10 13:27:25 UTC
        

(In reply to comment #17)
> Hi all,
> I managed it to work.
> There are devmapper.pc and devmapper-event.pc as well as lvm2app.pc in
> /usr/lib/pkgconfig
> But, there are missing in 
> /usr/lib64/pkgconfig
> I don't know why.
> I create a symlink :
> ln -s /usr/lib/pkgconfig/devmapper* /usr/lib64/pkgconfig/
> (the same for lvm2app.pc)
> And devicekit-disks emerge normally, as well as the entire Gnome
> packages.

That doesn't make much sense because /usr/lib should be a symlink to /usr/lib64 in amd64 multilib system:

$ ls -ld /usr/lib
lrwxrwxrwx 1 root root 5 Apr 27  2009 /usr/lib -> lib64

Futhermore, lvm2-2.02.72 seems to install the pkg-config file in correct directory lib64.

$ qfile -v devmapper.pc
sys-fs/lvm2-2.02.72 (/usr/lib64/pkgconfig/devmapper.pc)

So I don't see how that symlinking would have made any difference... 

Close this bug as WORKSFORME perhaps?




Comment 20


Gilles Dartiguelongue (RETIRED)






          2010-08-10 13:42:15 UTC
        

given that issue seems limited to one person, I guess so.
@Patrice, if you still want to dig up the issue, please answer questions in comment #18 and reopen the bug if you can reproduce the problem.
Thanks.




Comment 21


Patrice





          2010-08-10 13:52:57 UTC
        

(In reply to comment #20)
Hi,
As I said in my last message, I don't think it's a bug. It must be a
problem with my conf (I had few problems before with libs as it
seems that for me, /usr/lib is not linked to /usr/lib64. Don't ask me why, I don't know.).
By the way, thanks to everyone for helping me.
I guess I am the only one with this issue, and sorry for that.
Thus, bug can be close (I just don't know how to do it).
Thanks to all.











Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

