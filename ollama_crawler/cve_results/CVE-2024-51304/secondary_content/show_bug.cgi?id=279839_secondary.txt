Title: 279839 – x11-misc/xvidcap-1.1.7 hangs if x11-libs/libX11 is built with xcb support
URL: https://bugs.gentoo.org/show_bug.cgi?id=279839

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 279839
x11-misc/xvidcap-1.1.7 hangs if x11-libs/libX11 is built with xcb support
Last modified: 2010-02-07 22:55:32 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 279839 
      - x11-misc/xvidcap-1.1.7 hangs if x11-libs/libX11 is built with xcb support


Summary:
x11-misc/xvidcap-1.1.7 hangs if x11-libs/libX11 is built with xcb support
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Desktop Misc. Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-08-01 01:50 UTC by ferret





      Modified:
    
2010-02-07 22:55 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


ferret





          2009-08-01 01:50:32 UTC
        

If the conditions in the summary are met, xvidcap crashes after a certain amount of video data has been recorded, usually only about a second's worth.

This is a know issue mentioned on the upstream bug tracker and FAQ:

http://sourceforge.net/tracker/?func=detail&aid=2200546&group_id=81535&atid=563254
http://sourceforge.net/apps/mediawiki/xvidcap/index.php?title=Faq#xvidcap_hangs_on_starting_a_capture_session._What_can_I_do_about_it.3F

Now, at first I thought a possible solution would be to do an EAPI-2 DEPEND on x11-libs/libX11[-xcb], but the thing is, it's extremely difficult to remove libxcb from a system.  libX11 builds against it and then puts it in its pkg-config, so everything that builds against libX11 using pkg-config will end up linked against libxcb too, even though they don't have it in DEPEND.

So I think the most realistic "solution" would be to put a big fat warning or error into the xvidcap ebuild, with a mention of this bug.




Comment 1


ferret





          2009-08-10 02:57:37 UTC
        

I forgot to mention a few things.

This is the version of libxcb I had (higher versions are masked):

x11-libs/libxcb-1.1.90.1

I didn't try the masked versions, I suppose I could have at the time if I had noticed them, but now I've built my whole system back up without xcb and I don't want to put it back again unless I'm sure it will work.

However, as the issue is mentioned prominently on the upstream tracker, it seems that many or maybe all people with an xcb built libX11 are affected.

Note, I also tried it with LIBXCB_ALLOW_SLOPPY_LOCK=1 in the environment, because supposedly that fixes some apps with xcb problems.  In this case it made no difference.


emerge --info:

Portage 2.1.6.13 (default/linux/amd64/2008.0/desktop, gcc-4.3.4, glibc-2.10.1-r0, 2.6.30.4 x86_64)
=================================================================
System uname: Linux-2.6.30.4-x86_64-AMD_Turion-tm-_64_Mobile_ML-34-with-gentoo-2.0.1
Timestamp of tree: Mon, 10 Aug 2009 02:15:03 +0000
app-shells/bash:     4.0_p28
dev-java/java-config: 2.1.8-r1
dev-lang/python:     2.6.2-r1, 3.1
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.4.3-r3
sys-apps/sandbox:    2.0
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.9.6-r2, 1.10.2, 1.11
sys-devel/binutils:  2.19.1-r1
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6a
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64 -O2 -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-march=athlon64 -O2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="buildsyspkg collision-protect distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://www.mirrorservice.org/sites/www.ibiblio.org/gentoo/ http://gentoo.mirror.sdv.fr http://ftp.heanet.ie/pub/gentoo/"
LANG="en_GB.UTF-8"
LDFLAGS="-Wl,-O1"
LINGUAS="en_GB en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/junk /usr/local/portage/multilib"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac aalib acpi alsa amd64 avi bash-completion berkdb bittorrent bluetooth branding bzip2 cairo cdparanoia cdr cleartype cli cracklib crypt curl divx dri dvd dvdr eds emboss encode evo fam fbcon ffmpeg firefox flac flash ftp gdbm gif gmp gnutls gpm gtk gtk2 iconv id3 imap imlib java javascript jikes jpeg kpathsea lame lib32 libcaca libnotify libwww lua lzo mad mikmod mmx mmxext mng motif mp3 mp4 mpeg mudflap multilib music ncurses nptl nptlonly nss ogg oggvorbis opengl openmp pcre pdf pdflib perl png ppds python quicktime readline reflection rtc samba sdl session spell spl sqlite sse sse2 ssl svg sysfs tcpd theora tiff truetype unicode usb videos vim-syntax vorbis wmf x264 xft xml xml2 xorg xosd xulrunner xv xvid zlib" ALSA_CARDS="atiixp" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse" KERNEL="linux" LCD_DEVICES="ncurses text" LINGUAS="en_GB en" USERLAND="GNU" VIDEO_CARDS="radeon vesa"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 2


David Abbott (RETIRED)






          2010-02-06 23:55:53 UTC
        

Works fine here with;
[ebuild   R   ] x11-misc/xvidcap-1.1.7  USE="mp3 theora" 0 kB
[ebuild   R   ] x11-libs/libX11-1.3.3  USE="doc* ipv6 xcb -debug" 0 kB
ferret can you give it a try?




Comment 3


ferret





          2010-02-07 22:55:32 UTC
        

Thanks for the poke David.

It seems to have been fixed in one of the underlying libraries at some point, since I can no longer reproduce this crash with xcb enabled (which I turned back on a couple of months ago).









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

