Title: 840206 – Conflicting dependencies preventing upgrade
URL: https://bugs.gentoo.org/show_bug.cgi?id=840206

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 840206
Conflicting dependencies preventing upgrade
Last modified: 2022-04-27 04:52:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 840206 
      - Conflicting dependencies preventing upgrade


Summary:
Conflicting dependencies preventing upgrade
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2022-04-22 14:57 UTC by rjgleits





      Modified:
    
2022-04-27 04:52 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




output from emerge including errors

              (emergelog,59.72 KB,
                text/plain)

            
2022-04-22 14:57 UTC,

            rjgleits




Details





output from emerge --info

              (emergeinfo,6.83 KB,
                text/plain)

            
2022-04-23 07:55 UTC,

            rjgleits




Details





output from grep -R dev-qt /etc/portage

              (grep_dev-qt_etcportage,1.44 KB,
                text/plain)

            
2022-04-23 08:00 UTC,

            rjgleits




Details





emerge -epv @world output

              (emergelog2,191.76 KB,
                text/plain)

            
2022-04-25 22:14 UTC,

            rjgleits




Details





output from emerge -epv --backtrack=0 @world

              (emergelog3,181.43 KB,
                text/plain)

            
2022-04-26 11:33 UTC,

            rjgleits




Details





Output from emerge -p -uvDU @world --backtrack=200

              (emergelog4,54.43 KB,
                text/plain)

            
2022-04-26 11:37 UTC,

            rjgleits




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


rjgleits





          2022-04-22 14:57:13 UTC
        

Created attachment 773291 [details]
output from emerge including errors

Hello,

A conflict of dependencies apparently involving kde and qt is preventing any upgrades in my installation of Gentoo. The situation seems to have arisen with the upgrade of qt to 5.15.3 and nearly concurrent upgrade of kde-plasma  to 5.24. I have tried emerge -auD @world, emerge -a @world, and emerge -au @world. All of them fail. I checked the listed dependencies in the error message to the results of equery depgraph for the package. These results conflict. 
But if a package requires >= packagex-5.15.2, does that mean that 5.15.3 is OK?
Attached is a log of regular and error messages from emerge. I also tried masking qtwayland5.15.2 and unmerging it, but neither allowed the emerge to complete. 

What's the solution? 

Thanks,

Bob




Comment 1


Andreas Sturmlechner






          2022-04-22 15:19:57 UTC
        

Bugs require emerge --info output always.

The information is not complete without you providing your full emerge command. Regardless, please try with --deep and --backtrack=30 in addition.

> $ grep -R dev-qt /etc/portage
^ cleanup any resulting entries inside package.mask, update any entries in package.accept_keywords or, better, take a really close look if they are actually needed.

> $ grep dev-qt /var/lib/portage/world
^ cleanup any output that may yield.




Comment 2


rjgleits





          2022-04-23 07:55:00 UTC
        

Created attachment 773441 [details]
output from emerge --info




Comment 3


rjgleits





          2022-04-23 08:00:45 UTC
        

Created attachment 773447 [details]
output from grep -R dev-qt /etc/portage




Comment 4


rjgleits





          2022-04-23 08:12:11 UTC
        

The attached file emergelog was created with the following command:
emerge -auD --backtrack=30 @world &>emergelog

I attached the output of grep -R dev-qt /etc/portage. Please define what I need to clean up.

Also attached output from grep dev-qt /var/lib/portage/world. What needs to be cleaned up in it?

The masking of dev-qt/qtwayland-5.15.2-r17 had no effect.




Comment 5


rjgleits





          2022-04-25 12:34:45 UTC
        

This is looking like a problem in kde. the ebuilds for
kde-plasma/plasma-workspace-5.24.4 and
kde-plasma/layer-shell-qt-5.24.4 show dependencies on 
>=dev-qt/qtwayland-${QTMIN}:5=
This leads to emerge insisting that there is no match for qtwayland. Can someone from the KDE team verify that '=' is necessary? Masking qtwayland-5.15.2 doesn't help. I see that the '=' is there in 5.23.5-r2 ebuild. But it may be causing a problem due to the new version of qt.

Since qtwayland-5.15.2 and all other dev-qt 5.15.2 packages have been removed, it appears that we're stuck. I see that masking kde latest version is not going to help either.

Best Wishes,

Bob




Comment 6


Sam James









          2022-04-25 13:51:28 UTC
        

(In reply to rjgleits from comment #5)
> This is looking like a problem in kde. the ebuilds for
> kde-plasma/plasma-workspace-5.24.4 and
> kde-plasma/layer-shell-qt-5.24.4 show dependencies on 
> >=dev-qt/qtwayland-${QTMIN}:5=
> This leads to emerge insisting that there is no match for qtwayland. Can
> someone from the KDE team verify that '=' is necessary? Masking
> qtwayland-5.15.2 doesn't help. I see that the '=' is there in 5.23.5-r2
> ebuild. But it may be causing a problem due to the new version of qt.
> 

Yes, the = is necessary -- it means "rebuild if (sub)slot changes", not "exactly this version".

Please drop all masks for Qt related software, KDE, etc.

> Since qtwayland-5.15.2 and all other dev-qt 5.15.2 packages have been
> removed, it appears that we're stuck. I see that masking kde latest version
> is not going to help either.
> 


Can you run: emerge -epv --backtrack=0 @world and share the output as an attachment?

> Best Wishes,
> 
> Bob




Comment 7


rjgleits





          2022-04-25 22:14:26 UTC
        

Created attachment 774564 [details]
emerge -epv @world output

All masks on qt and kde elements were removed.




Comment 8


Sam James









          2022-04-26 03:11:55 UTC
        

(In reply to rjgleits from comment #7)
> Created attachment 774564 [details]
> emerge -epv @world output
> 
> All masks on qt and kde elements were removed.

Please emerge --deselect dev-qt/assistant:5 dev-qt/qdbusviewer:5. You also need to emerge --deselect app-shells/bashdb given it's incompatible with Bash 5.1.

(You should not have things you don't personally want/use in your @world file, hence dropping Qt stuff, which your -pev @world output shows is unresolvable/gone anyway.)

Then try -epv @world --backtrack=0 again (don't run it without -p), then share emerge -p -uvDU @world --backtrack=200.




Comment 9


rjgleits





          2022-04-26 11:33:34 UTC
        

Created attachment 774630 [details]
output from emerge -epv --backtrack=0 @world

Deselections you recommended were performed.




Comment 10


rjgleits





          2022-04-26 11:37:48 UTC
        

Created attachment 774756 [details]
Output from emerge -p -uvDU @world --backtrack=200

It looks like the problem has been resolved, but I'll wait for your opinion before going ahead with the actual emerge.




Comment 11


Sam James









          2022-04-26 12:55:14 UTC
        

(In reply to rjgleits from comment #10)
> Created attachment 774756 [details]
> Output from emerge -p -uvDU @world --backtrack=200
> 
> It looks like the problem has been resolved, but I'll wait for your opinion
> before going ahead with the actual emerge.

Go for launch!









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

