Title: 120822 – baselayout fail to initialize atheros card correctly
URL: https://bugs.gentoo.org/show_bug.cgi?id=120822

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 120822
baselayout fail to initialize atheros card correctly
Last modified: 2006-03-10 05:03:10 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 120822 
      - baselayout fail to initialize atheros card correctly


Summary:
baselayout fail to initialize atheros card correctly
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

Roy Marples (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-01-29 07:46 UTC by Benjamin Judas





      Modified:
    
2006-03-10 05:03 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



mobile+disabled
radek









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




quick debug for association test

              (iwconfig-debug.patch,308 bytes,
                patch)

            
2006-02-01 11:44 UTC,

            Roy Marples (RETIRED)




Details
            | Diff





transscript of net.ath0

              (typescript,9.36 KB,
                text/plain)

            
2006-02-02 10:07 UTC,

            Benjamin Judas




Details





basic net-config

              (net,395 bytes,
                text/plain)

            
2006-02-21 11:30 UTC,

            Benjamin Judas




Details





wireless-config

              (wireless,156 bytes,
                text/plain)

            
2006-02-21 11:31 UTC,

            Benjamin Judas




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Benjamin Judas





          2006-01-29 07:46:52 UTC
        

Problem:
========

After upgrading to madwifi-driver-0.1401.20060117 and the appropriate version of madwifi-tools I cannot initialize my wlan-device anymore (neither via the init-script nor manually).

On bootup, I get the following informations:
* Starting ath0
*   Configuring wireless network for ath0
<pause ~15 seconds>
*   Failed to configure wireless for ath0

The wireless LED on my thinkpad remains dark.

After login, ifconfig shows only lo being configured. However, ifconfig -a shows  ath0 (the atheros-device), eth0 (internal nic), eth1 (firewire-nic), lo and wifi0.

iwconfig shows ath0 being configured: Essid correct, key off (should be on), Link-Quality 0/94, AP set to 00.00.00.00.00.00

Trying with "wlanconfig ath0 list .." works, for example ".. list ap" shows my local ap.

Calling "ifconfig ath0 192.168.115.106 up" (I don't have a DHCP-Server) works, after calling that, ath0 and wifi0 show up in "ifconfig" as configured devices.
However, the Wireless-LED remains dark and I cannot ping anthing except lo and ath0 locally. Pinging another box in my LAN results in 100% packet-loss. The default route is configured correctly.

Wireless extensions work via Win2k on my Thinkpad (yes, shame on my, I know ;) ) and the internal wired-NIC works, too.

/etc/conf.d/net is set as follows:
ifconfig_ath0=( "192.168.115.106 netmask 255.255.255.0" )
routes_ath0=( "default gw 192.168.115.1" )
essid_ath0=( "homenet" )
key_ath0=( "supersekrit" )

Versions:
=========
baselayout-1.12.20.0_pre15-r1   // upgraded from stable after problem occured
udev-081-r1   // also upgraded
madwifi-driver-0.1401.20060117
madwifi-tools-0.1401-20060117
kernel-2.6.14-gentoo-r5




Comment 1


Jakub Moc (RETIRED)






          2006-01-29 09:41:37 UTC
        

emerge --info, please...




Comment 2


Benjamin Judas





          2006-01-29 10:08:10 UTC
        

Portage 2.0.54 (default-linux/x86/2005.0, gcc-3.3.5, glibc-2.3.5-r2,glibc-2.3.2-r9, 2.6.14-gentoo-r5 i686)
=================================================================
System uname: 2.6.14-gentoo-r5 i686 Mobile Intel(R) Pentium(R) 4 - M CPU 2.00GHz
Gentoo Base System version 1.12.0_pre15
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.3 [enabled]
dev-lang/python:     2.2.3-r5, 2.3.5-r2, 2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.4.19-r1, 2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=pentium4 -mmmx -m3dnow -msse -msse2 -mfpmath=sse -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/splash /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=pentium4 -mmmx -m3dnow -msse -msse2 -mfpmath=sse -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks keepwork noauto sandbox sfperms strict userpriv usersandbox"
GENTOO_MIRRORS="ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo ftp://sunsite.de/mirrors/gentoo ftp://ftp.tu-clausthal.de/pub/linux/gentoo http://www.ibiblio.org/pub/Linux/distributions/gentoo"
LANG="de_DE.UTF-8"
LC_ALL="de_DE.UTF-8"
LINGUAS="de"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage-overlay"
SYNC="rsync://rsync.de.gentoo.org/gentoo-portage"
USE="x86 X aalib acl alsa apm arts audiofile avi berkdb bitmap-fonts bonobo bzip2 cdr crypt curl dvd eds emboss encode esd exif expat fam ffmpeg flac foomaticdb fortran gdbm gif glut gnome gpm gstreamer gtk gtk2 gtkhtml hal idn ieee1394 imagemagick imlib ipv6 java jpeg kde lcms ldap libg++ libwww mad mhash mikmod mng motif mozilla mp3 mpeg ncurses nls ogg oggvorbis opengl oss pam pcre pdflib perl png python qt quicktime readline recode samba sdl slang snmp speex spell ssl svga tcltk tcpd tiff truetype truetype-fonts type1-fonts udev usb vorbis wifi xine xml xml2 xmms xv xvid zlib linguas_de userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LDFLAGS, MAKEOPTS





Comment 3


Henrik Brix Andersen





          2006-01-29 12:30:23 UTC
        

(In reply to comment #0)
> iwconfig shows ath0 being configured: Essid correct, key off (should be on),

Try setting the WEP key manually using iwconfig.

> udev-081-r1   // also upgraded

You're using an ~ARCH version of udev. Don't do that. How many other packages do you have that is marked for testing?

> madwifi-driver-0.1401.20060117
> madwifi-tools-0.1401-20060117

I assume you mean 0.1401.20060117?

> kernel-2.6.14-gentoo-r5

Please try to reproduce with gentoo-sources-2.6.15-r1.




Comment 4


Benjamin Judas





          2006-01-29 13:46:36 UTC
        

(In reply to comment #3)
> Try setting the WEP key manually using iwconfig.
Works and iwconfig shows the ap-id-string and the link-status as being established.

> You're using an ~ARCH version of udev. Don't do that. How many other packages
> do you have that is marked for testing?
I upgraded to the testing versions of udev and baselayout after a reccomendation in the forums:
http://forums.gentoo.org/viewtopic-t-426841-highlight-madwifi.html
http://forums.gentoo.org/viewtopic-t-422314-highlight-madwifi.html
The problem, however is totally the same with the 'original' stable versions.

> I assume you mean 0.1401.20060117?
Correct, sorry for the typo.

> Please try to reproduce with gentoo-sources-2.6.15-r1.
Compiled new kernel, compiled madwifi-driver and madwifi-tools against new kernel, problem persists. However, not at least the WLAN-Led is flashing from time to time.


Additional information:
=======================

ifconfig after manually initializing the device with ifconfig:
-8<-----------------------------------------------------------

ath0      Protokoll:Ethernet  Hardware Adresse 00:05:4E:43:FB:DB  
          inet Adresse:192.168.115.106  Bcast:192.168.115.255  Maske:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2177 errors:0 dropped:0 overruns:0 frame:0
          TX packets:12 errors:0 dropped:0 overruns:0 carrier:0
          Kollisionen:0 Sendewarteschlangenl




Comment 5


Benjamin Judas





          2006-01-29 13:46:36 UTC
        

(In reply to comment #3)
> Try setting the WEP key manually using iwconfig.
Works and iwconfig shows the ap-id-string and the link-status as being established.

> You're using an ~ARCH version of udev. Don't do that. How many other packages
> do you have that is marked for testing?
I upgraded to the testing versions of udev and baselayout after a reccomendation in the forums:
http://forums.gentoo.org/viewtopic-t-426841-highlight-madwifi.html
http://forums.gentoo.org/viewtopic-t-422314-highlight-madwifi.html
The problem, however is totally the same with the 'original' stable versions.

> I assume you mean 0.1401.20060117?
Correct, sorry for the typo.

> Please try to reproduce with gentoo-sources-2.6.15-r1.
Compiled new kernel, compiled madwifi-driver and madwifi-tools against new kernel, problem persists. However, not at least the WLAN-Led is flashing from time to time.


Additional information:
=======================

ifconfig after manually initializing the device with ifconfig:
-8<-----------------------------------------------------------

ath0      Protokoll:Ethernet  Hardware Adresse 00:05:4E:43:FB:DB  
          inet Adresse:192.168.115.106  Bcast:192.168.115.255  Maske:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:2177 errors:0 dropped:0 overruns:0 frame:0
          TX packets:12 errors:0 dropped:0 overruns:0 carrier:0
          Kollisionen:0 Sendewarteschlangenlänge:0 
          RX bytes:388196 (379.0 Kb)  TX bytes:504 (504.0 b)

eth0      Protokoll:Ethernet  Hardware Adresse 00:06:1B:D1:8D:EC  
          inet Adresse:192.168.115.104  Bcast:192.168.115.255  Maske:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:878 errors:0 dropped:0 overruns:0 frame:0
          TX packets:100 errors:0 dropped:0 overruns:0 carrier:0
          Kollisionen:0 Sendewarteschlangenlänge:1000 
          RX bytes:137185 (133.9 Kb)  TX bytes:12842 (12.5 Kb)
          Interrupt:11 

lo        Protokoll:Lokale Schleife  
          inet Adresse:127.0.0.1  Maske:255.0.0.0
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:11 errors:0 dropped:0 overruns:0 frame:0
          TX packets:11 errors:0 dropped:0 overruns:0 carrier:0
          Kollisionen:0 Sendewarteschlangenlänge:0 
          RX bytes:930 (930.0 b)  TX bytes:930 (930.0 b)

wifi0     Protokoll:UNSPEC  Hardware Adresse 00-05-4E-43-FB-DB-00-EA-00-00-00-00-00-00-00-00  
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:7831 errors:0 dropped:0 overruns:0 frame:38
          TX packets:92 errors:0 dropped:0 overruns:0 carrier:0
          Kollisionen:0 Sendewarteschlangenlänge:199 
          RX bytes:938534 (916.5 Kb)  TX bytes:4828 (4.7 Kb)
          Interrupt:11 Speicher:f28a0000-f28b0000 
->8-----------------------------------------------------------


iwconfig after setting key manually:
-8<-----------------------------------------------------------

ath0      IEEE 802.11g  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:2.462 GHz  Access Point: 00:0F:66:56:E2:B9   
          Bit Rate:36 Mb/s   Tx-Power:31 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:7375-6C61-7068-6174   Security mode:restricted
          Power Management:off
          Link Quality=56/94  Signal level=-39 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0
->8-----------------------------------------------------------


routing-table:

DEST           ROUTER         GENMASK        FLAGS  METRIC  REF  USE  IFACE
192.168.115.0  0.0.0.0        255.255.255.0  U      0       0      0  ath0
127.0.0.0      0.0.0.0        255.0.0.0      U      0       0      0  lo
0.0.0.0        192.168.115.1  0.0.0.0        UG     0       0      0  ath0


In the end, the result remains the same: no outgoing traffic. Nothing is 'pingable' except the local devices.





Comment 6


Benjamin Judas





          2006-01-31 07:38:56 UTC
        

Gah, sorry -- forgot to reopen




Comment 7


Henrik Brix Andersen





          2006-02-01 06:35:03 UTC
        

Please retest with net-wireless/madwifi-driver-0.1420.20060201.




Comment 8


Benjamin Judas





          2006-02-01 08:28:30 UTC
        

That helped, little-benni is back online. 

Ok, Uberlord - now this one's for you now: The card is working now, but the init-script doesn't set the key successfully (works when set manually). I read your forums-post and upgraded to baselayout 1.12.0_pre15-r1. Probably some parser-changes for /etc/conf.d/net?

I tried various formats for the key: the classical cleartext-entry and also the hex-entry (with dashes [i.e. AAAA-BBBB-CC} and without dashes [AAAABBBBCC])




Comment 9


Henrik Brix Andersen





          2006-02-01 08:34:23 UTC
        

Reassigning to Royb since manual configuration of wireless parameters works.




Comment 10


Roy Marples (RETIRED)






          2006-02-01 10:23:20 UTC
        

(In reply to comment #1)
> /etc/conf.d/net is set as follows:
> ifconfig_ath0=( "192.168.115.106 netmask 255.255.255.0" )
> routes_ath0=( "default gw 192.168.115.1" )
> essid_ath0=( "homenet" )
> key_ath0=( "supersekrit" )

That doesn't work as keys are set by essid and not by interface.

key_homenet="supersekrit"

That does work.




Comment 11


Benjamin Judas





          2006-02-01 11:20:38 UTC
        

(In reply to comment #9)
> That doesn't work as keys are set by essid and not by interface.
> 
> key_homenet="supersekrit"
> 
> That does work.
> 
Well, this also doesn't work (and honestly, I had set the key per-ESSID -- I only confused old stuff in conf.d/net and the current and working config in conf.d/wireless).:

ifconfig_ath0=( "192.168.115.106 netmask 255.255.255.0" )
routes_ath0=( "default gw 192.168.115.1" )
essid_ath0=( "homenet" )
key_homenet=( "AAAA-BBBB-CC" )

The script still is non-functional. If you could give me some info where to place debug-output in the script, I could do a further examination.






Comment 12


Roy Marples (RETIRED)






          2006-02-01 11:44:02 UTC
        

Created attachment 78668 [details, diff]
quick debug for association test

This patches outputs the configured wireless interface, including key set for each association attempt.

Please post it here.




Comment 13


Benjamin Judas





          2006-02-02 09:13:17 UTC
        

Ok, here is a 1:1 transscript of a test-session. I added nothing, I deleted nothing. And yes - this is totally weird:

root@betelgeuze:/home/benni  $  /etc/init.d/net.ath0 start
* Starting ath0
*   Configuring wireless network for ath0
ath0      IEEE 802.11g  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:2.412 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:17 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11a  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:5.28 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:17 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11a  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:5.22 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:15 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11a  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:5.23 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:15 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11g  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:2.447 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:17 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11a  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:5.745 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:16 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11a  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:5.54 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:17 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11a  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:5.24 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:15 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11a  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:5.52 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:17 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

ath0      IEEE 802.11a  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:5.62 GHz  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:17 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

 *   Failed to configure wireless for ath0   [ !! ]
root@betelgeuze:/home/benni  $  iwconfig
eth0      no wireless extensions.

lo        no wireless extensions.

eth1      no wireless extensions.

wifi0     no wireless extensions.

ath0      IEEE 802.11g  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Channel:0  Access Point: 00:00:00:00:00:00   
          Bit Rate:0 kb/s   Tx-Power:17 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
          Link Quality=0/94  Signal level=-95 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

root@betelgeuze:/home/benni  $  ifconfig ath0 192.168.115.106 up 
root@betelgeuze:/home/benni  $  route add default gw 192.168.115.1 ath0 
root@betelgeuze:/home/benni  $  iwconfig ath0 key AAAABBBBCC
root@betelgeuze:/home/benni  $  iwconfig
eth0      no wireless extensions.

lo        no wireless extensions.

eth1      no wireless extensions.

wifi0     no wireless extensions.

ath0      IEEE 802.11g  ESSID:"hausnetz"  Nickname:"hausnetz"
          Mode:Managed  Frequency:2.462 GHz  Access Point: 00:0F:66:56:E2:B9   
          Bit Rate:36 Mb/s   Tx-Power:31 dBm   Sensitivity=0/3  
          Retry:off   RTS thr:off   Fragment thr:off
          Encryption key:AAAA-BBBB-CC   Security mode:restricted
          Power Management:off
          Link Quality=55/94  Signal level=-40 dBm  Noise level=-95 dBm
          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0
          Tx excessive retries:0  Invalid misc:0   Missed beacon:0

root@betelgeuze:/home/benni  $  ping www.google.de
PING www.l.google.com (64.233.183.103) 56(84) bytes of data.
64 bytes from 64.233.183.103: icmp_seq=1 ttl=246 time=202 ms
64 bytes from 64.233.183.103: icmp_seq=2 ttl=246 time=99.2 ms
64 bytes from 64.233.183.103: icmp_seq=3 ttl=246 time=193 ms

--- www.l.google.com ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2005ms
rtt min/avg/max/mdev = 99.205/165.104/202.709/46.752 ms




Comment 14


Roy Marples (RETIRED)






          2006-02-02 09:52:53 UTC
        

Could you add an ifconfig "${iface}" after the iwconfig "${iface}" line the patch added to check the interface is marked as up? Thanks.




Comment 15


Benjamin Judas





          2006-02-02 10:07:57 UTC
        

Created attachment 78735 [details]
transscript of net.ath0

transscript of net.ath0 with iwconfig- and ifconfig-verbosity




Comment 16


Roy Marples (RETIRED)






          2006-02-03 09:35:50 UTC
        

Is your AP hiding or broadcasting its SSID?

BTW, I just cannot replicate this on my atheros card :/




Comment 17


Benjamin Judas





          2006-02-03 11:33:47 UTC
        

(In reply to comment #15)
> Is your AP hiding or broadcasting its SSID?
It's set to broadcast it

> BTW, I just cannot replicate this on my atheros card :/
Well, I also was very suprised when it stopped working. But hey - I am used to be looked at like an Alien-User when reporting bugs ;) -- "Looking for the strangest bugs in Gentoo? Call 555-BEE-JAY" (yes, sometimes it really seems to be like that...)




Comment 18


Roy Marples (RETIRED)






          2006-02-03 12:07:11 UTC
        

Try adding this on line 362 of /lib/rcscripts/net.modules.d/iwconfig

interface_up "${iface}"

If that doesn't fix it try doing this on the same line

interface_down "${iface}"
interface_up "${iface}"





Comment 19


Benjamin Judas





          2006-02-04 01:51:45 UTC
        

(In reply to comment #17)
> Try adding this on line 362 of /lib/rcscripts/net.modules.d/iwconfig
> 
> interface_up "${iface}"
> 
> If that doesn't fix it try doing this on the same line
> 
> interface_down "${iface}"
> interface_up "${iface}"

Both tries didn't help. :/

What I tried now is writing a simple init-script to initialize the card:

depend() {
        use coldplug hotplug pcmcia usb isdn wlan
}

start() {
        ebegin "Starting Wifi Networking"
        ifconfig ath0 192.168.115.106 up
        einfo "Setting WEP configuration"
        iwconfig ath0 key AAAABBBBCC
        iwconfig ath0 essid hausnetz
        einfo "Setting default route"
        route add default gw 192.168.115.1
}

stop() {
        ebegin "Stopping Wifi Networking"
        ifconfig ath0 down
        einfo "Removing WEP configuration"
        iwconfig ath0 key off
        iwconfig ath0 essid off
}


This script works perfectly....




Comment 20


Roy Marples (RETIRED)






          2006-02-08 04:56:21 UTC
        

(In reply to comment #17)
> Try adding this on line 362 of /lib/rcscripts/net.modules.d/iwconfig
> 
> interface_up "${iface}"
> 
> If that doesn't fix it try doing this on the same line
> 
> interface_down "${iface}"
> interface_up "${iface}"
> 


Try adding this there
iwconfig "${iface}" essid -- off

Yes, I know that your script works - what I don't understand is why your madwifi isn't associating and mine is.




Comment 21


Benjamin Judas





          2006-02-10 11:31:55 UTC
        

(In reply to comment #19)
> 
> Try adding this there
> iwconfig "${iface}" essid -- off
> 
> Yes, I know that your script works - what I don't understand is why your
> madwifi isn't associating and mine is.
> 

Ok, did that.

iwconfig shows no essid being set.




Comment 22


Roy Marples (RETIRED)






          2006-02-16 02:32:54 UTC
        

pre16 is out. Could you test that please?

Also, could you test baselayout-1.11.14-r5 or tell me if any baselayout versions actually worked for you?




Comment 23


Benjamin Judas





          2006-02-16 10:37:08 UTC
        

(In reply to comment #21)
> pre16 is out. Could you test that please?
> 
> Also, could you test baselayout-1.11.14-r5 or tell me if any baselayout
> versions actually worked for you?
> 
The previous stable (x86) version of baselayout worked for me. The problem however didn't come up after I upgraded baselayout. It all started with an upgrade of madwifi-driver.

Well, I also have some good news which somehow push the problem under baselayouts carpet: I did some experiments with iwconfig_$iface in /etc/conf.d/wireless in the last hour and I found out something interesting:

This config doesn't work:
essid_ath0 = ("homenet")
key_homenet = ("AAAABBBBCC")
routes_hausnetz=("default via 192.168.115.1")

This also doesn't work:
routes_hausnetz=("default via 192.168.115.1")
iwconfig_ath0=("key AAAABBBBCC essid hausnetz")

This config WORKS (please note the additional key_$iface statement):
key_hausnetz=("AAAABBBBCC")
routes_hausnetz=("default via 192.168.115.1")
iwconfig_ath0=("key AAAABBBBCC essid hausnetz")




Comment 24


Roy Marples (RETIRED)






          2006-02-17 00:39:25 UTC
        

With a working config, the act of removing the iwconfig_ath0 line causes it not to work? If so, could you email me your exact configs (working and non-working) please? I think it maybe an issue with the keys themselves.




Comment 25


Benjamin Judas





          2006-02-21 11:30:05 UTC
        

Created attachment 80371 [details]
basic net-config




Comment 26


Benjamin Judas





          2006-02-21 11:31:14 UTC
        

Created attachment 80372 [details]
wireless-config




Comment 27


Benjamin Judas





          2006-02-21 11:32:28 UTC
        

(In reply to comment #23)
> With a working config, the act of removing the iwconfig_ath0 line causes it not
> to work? If so, could you email me your exact configs (working and non-working)
> please? I think it maybe an issue with the keys themselves.
> 

Sorry about the delay, but I had some family-matters to deal with. Anyway - I attached the two configs. Lemme know if you need more.




Comment 28


Roy Marples (RETIRED)






          2006-03-10 05:03:10 UTC
        

Closing this as WORKSFORME as with beejays exact settings it works for me using madwifi.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

