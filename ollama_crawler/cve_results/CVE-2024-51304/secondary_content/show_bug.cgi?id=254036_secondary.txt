Title: 254036 – media-video/ffmpeg-0.4.9_p20081014 configure fails x264 test
URL: https://bugs.gentoo.org/show_bug.cgi?id=254036

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 254036
media-video/ffmpeg-0.4.9_p20081014 configure fails x264 test
Last modified: 2009-01-11 23:04:56 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 254036 
      - media-video/ffmpeg-0.4.9_p20081014 configure fails x264 test


Summary:
media-video/ffmpeg-0.4.9_p20081014 configure fails x264 test
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Media-video project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-01-07 04:14 UTC by David H





      Modified:
    
2009-01-11 23:04 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


David H





          2009-01-07 04:14:47 UTC
        

Attempting to emerge ffmpeg-0.4.9_p20081014 dies with the following error:

x264 does not satisfy CPP condition: X264_BUILD >= 65

Reproducible: Always

Steps to Reproduce:
#PORTDIR_OVERLAY="" emerge -v ffmpeg -a

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild     U ] media-video/ffmpeg-0.4.9_p20081014 [0.4.9_p20070616] USE="aac encode ipv6%* mmx mp3%* sdl theora vorbis x264 xvid zlib -X* (-altivec) -amr -bindist% -debug -dirac% -doc -gsm% -hardcoded-tables% -ieee1394 -mmxext% -network -schroedinger% -ssse3% -test -threads -v4l -v4l2% -vhook% (-a52%*) (-imlib%*) (-ogg%*) (-oss%*) (-truetype%*)" 0 kB



The full log is:

-----------------------------------------------------

>>> Unpacking source...
>>> Unpacking ffmpeg-0.4.9-p20081014.tar.bz2 to /usr/portage/tmp/portage/media-video/ffmpeg-0.4.9_p20081014/work
 * Applying ffmpeg-shared-gcc4.1.patch ...                                                                                         [ ok ]
 * Applying ffmpeg-0.4.9_p20081014-sparc-gcc43.patch ...                                                                           [ ok ]
>>> Source unpacked.
>>> Compiling source in /usr/portage/tmp/portage/media-video/ffmpeg-0.4.9_p20081014/work/ffmpeg ...
true
ERROR: x264 does not satisfy CPP condition: X264_BUILD >= 65
If you think configure made a mistake, make sure you are using the latest
version from SVN.  If the latest version fails, report the problem to the
ffmpeg-user@mplayerhq.hu mailing list or IRC #ffmpeg on irc.freenode.net.
Include the log file "config.err" produced by configure as this will help
solving the problem.
 *
 * ERROR: media-video/ffmpeg-0.4.9_p20081014 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 2442:  Called die
 * The specific snippet of code:
 *       ./configure --prefix=/usr --libdir=/usr/$(get_libdir) --shlibdir=/usr/$(get_libdir) --mandir=/usr/share/man --enable-static --enable-shared --cc="$(tc-getCC)" ${myconf} || die "configure failed";
 *  The die message:
 *   configure failed

-----------------------------------------------------

emerge --info :

---------------------

# emerge --info
Portage 2.1.6.4 (default/linux/x86/2008.0/desktop, gcc-4.1.2, glibc-2.6.1-r0, 2.6.23-gentoo-r8 i686)
=================================================================
System uname: Linux-2.6.23-gentoo-r8-i686-AMD_Athlon-tm-with-glibc2.0
Timestamp of tree: Thu, 01 Jan 2009 07:35:01 +0000
distcc 3.0 i686-pc-linux-gnu [disabled]
app-shells/bash:     3.2_p17-r1
dev-java/java-config: 1.3.7, 2.1.6
dev-lang/python:     2.4.4-r14, 2.5.2-r7
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.9-r2
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r2
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-Os -march=athlon-xp -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-Os -march=athlon-xp -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks fixpackages parallel-fetch prelink protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://gentoo.osuosl.org"
LANG="en_US"
LDFLAGS="-Wl,-O1"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/usr/portage/tmp"
PORTDIR="/usr/portage/portage"
PORTDIR_OVERLAY="/usr/portage/overlay"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="a52 aac acl acpi apache2 bluetooth branding bzip2 cairo cdr cli cracklib crypt css cups dbus dlloader dri dts dvd dvdr dvdread emboss encode evo exif fam ffmpeg firefox flac fortran gdbm gif gimpprint gpm gtk2 hal iconv imap imlib ipv6 isdnlog java jpeg ldap libnotify libwww mad maildir midi mikmod mjpeg mmx mp3 mpeg mplayer mudflap mysql ncurses nls no-htdocs nptl nptlonly nvidia ogg opengl openmp pam pcre pdf perl pic png ppds pppd python qt3 qt3support qt4 quicktime readline reflection reiserfs sasl sdl session spell spl ssl startup-notification svg sysfs tcpd theora tiff truetype truetype-fonts type1-fonts unicode usb vcd vorbis win32codecs x264 x86 xine xml xorg xulrunner xv xvid xvmc zlib" ALSA_CARDS="usb-usx2y emu10k1 emu10k1x" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host        authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir      disk_cache env expires ext_filter file_cache filter headers ident imagemap       include info log_config logio mem_cache mime mime_magic negotiation proxy       proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling    status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="nvidia nv"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LC_ALL, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Samuli Suominen (RETIRED)






          2009-01-11 18:29:05 UTC
        

So which version of x264 do you have installed?




Comment 2


David H





          2009-01-11 18:51:08 UTC
        

I currently have 20061014-r1

I see now that portage wants to "downgrade" x264 to to  media-libs/x264-0.0.20081006

# emerge -pv x264

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild     U ] dev-lang/yasm-0.7.1 [0.6.0] USE="nls" 1,380 kB [?=>0]
[ebuild     UD] media-libs/x264-0.0.20081006 [20061014-r1] USE="threads* -debug" 2,196 kB [?=>0]

This is probably the problem?  since portage saw it as a downgrade, perhaps it didn't get included in the dependency list of ffmpeg, and configure didn't like the version I have installed?   i.e. the ffmpeg ebuild ls looking for 

    x264? ( >=media-libs/x264-0.0.20081006 )

but portage thinks  20061014-r1 >= 0.0.20081006

I'm guessing that if I "upgrade" to this version the error might resolve itself? 





Comment 3


David H





          2009-01-11 19:16:27 UTC
        

Update: manually installing/upgrading x264 resolved the ffmpeg/x264 issue.




Comment 4


Samuli Suominen (RETIRED)






          2009-01-11 21:23:58 UTC
        

The way portage handles up and downgrades has changed quite a few times iirc... 

Since it works for you now, closing.




Comment 5


Ben de Groot (RETIRED)






          2009-01-11 23:04:56 UTC
        

(In reply to comment #2)
> I currently have 20061014-r1
> This is probably the problem? 

Yes, that version is not in portage anymore, so this bug is actually invalid.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

