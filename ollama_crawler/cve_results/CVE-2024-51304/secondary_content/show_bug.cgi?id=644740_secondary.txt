Title: 644740 – net-analyzer/icinga2-2.8.0 fails to emerge on one host but succeeds on another
URL: https://bugs.gentoo.org/show_bug.cgi?id=644740

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 644740
net-analyzer/icinga2-2.8.0 fails to emerge on one host but succeeds on another
Last modified: 2018-01-19 09:07:28 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 644740 
      - net-analyzer/icinga2-2.8.0 fails to emerge on one host but succeeds on another


Summary:
net-analyzer/icinga2-2.8.0 fails to emerge on one host but succeeds on another
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Matthew Thode ( prometheanfire )








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2018-01-16 10:04 UTC by Timo Eissler





      Modified:
    
2018-01-19 09:07 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



jstein
morlix









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info of the system where emerge fails

              (emerge_failed__emerge_info.txt,5.83 KB,
                text/plain)

            
2018-01-16 10:04 UTC,

            Timo Eissler




Details





emerge --info of the system where emerge succeeds

              (emerge_succeeds__emerge_info.txt,6.37 KB,
                text/plain)

            
2018-01-16 10:04 UTC,

            Timo Eissler




Details





emerge logfile

              (emerge_icinga2.log,605.04 KB,
                text/x-log)

            
2018-01-17 19:36 UTC,

            Timo Eissler




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Timo Eissler





          2018-01-16 10:04:18 UTC
        

Created attachment 515022 [details]
emerge --info of the system where emerge fails

emergeing net-analyzer/icinga2-2.8.0 fails on one server with:

[ 64%] Linking CXX shared library ../../Bin/Gentoo/libicinga.so
cd /var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build/lib/icinga && /usr/bin/cmake -E cmake_link_script CMakeFiles/icinga.dir/link.txt --verbose=1
/usr/lib64/ccache/bin/x86_64-pc-linux-gnu-g++ -fPIC -march=ivybridge -msahf -mrdrnd -mf16c -mfsgsbase --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=8192 -O2 -pipe -lpthread  -pthread -fvisibility=hidden -std=c++0x -Wl,-O1 -Wl,--as-needed -Wl,--gc-sections -Wl,--no-export-dynamic -Bsymbolic-functions -Wl,--dynamic-list-cpp-typeinfo -Wl,--dynamic-list-data -shared -Wl,-soname,libicinga.so.2.8.0 -o ../../Bin/Gentoo/libicinga.so.2.8.0 CMakeFiles/icinga.dir/apiactions.cpp.o CMakeFiles/icinga.dir/apievents.cpp.o CMakeFiles/icinga.dir/checkable.cpp.o CMakeFiles/icinga.dir/checkable-dependency.cpp.o CMakeFiles/icinga.dir/checkable-downtime.cpp.o CMakeFiles/icinga.dir/checkable-event.cpp.o CMakeFiles/icinga.dir/checkable-flapping.cpp.o CMakeFiles/icinga.dir/checkable-script.cpp.o CMakeFiles/icinga.dir/checkcommand.cpp.o CMakeFiles/icinga.dir/checkresult.cpp.o CMakeFiles/icinga.dir/cib.cpp.o CMakeFiles/icinga.dir/clusterevents.cpp.o CMakeFiles/icinga.dir/command.cpp.o CMakeFiles/icinga.dir/comment.cpp.o CMakeFiles/icinga.dir/compatutility.cpp.o CMakeFiles/icinga.dir/dependency.cpp.o CMakeFiles/icinga.dir/dependency-apply.cpp.o CMakeFiles/icinga.dir/downtime.cpp.o CMakeFiles/icinga.dir/eventcommand.cpp.o CMakeFiles/icinga.dir/externalcommandprocessor.cpp.o CMakeFiles/icinga.dir/host.cpp.o CMakeFiles/icinga.dir/hostgroup.cpp.o CMakeFiles/icinga.dir/icingaapplication.cpp.o CMakeFiles/icinga.dir/icinga-itl.cpp.o CMakeFiles/icinga.dir/customvarobject.cpp.o CMakeFiles/icinga.dir/legacytimeperiod.cpp.o CMakeFiles/icinga.dir/macroprocessor.cpp.o CMakeFiles/icinga.dir/notificationcommand.cpp.o CMakeFiles/icinga.dir/notification.cpp.o CMakeFiles/icinga.dir/notification-apply.cpp.o CMakeFiles/icinga.dir/objectutils.cpp.o CMakeFiles/icinga.dir/pluginutility.cpp.o CMakeFiles/icinga.dir/scheduleddowntime.cpp.o CMakeFiles/icinga.dir/scheduleddowntime-apply.cpp.o CMakeFiles/icinga.dir/service-apply.cpp.o CMakeFiles/icinga.dir/checkable-check.cpp.o CMakeFiles/icinga.dir/checkable-comment.cpp.o CMakeFiles/icinga.dir/service.cpp.o CMakeFiles/icinga.dir/servicegroup.cpp.o
CMakeFiles/icinga.dir/checkable-notification.cpp.o CMakeFiles/icinga.dir/timeperiod.cpp.o CMakeFiles/icinga.dir/user.cpp.o CMakeFiles/icinga.dir/usergroup.cpp.o  -L/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build/third-party/yajl -Wl,-rpath,/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build/third-party/yajl:/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build/Bin/Gentoo: -lboost_thread-mt -lboost_system-mt -lboost_program_options-mt -lboost_regex-mt -lboost_chrono-mt -lboost_date_time-mt -lboost_atomic-mt ../../Bin/Gentoo/libremote.so.2.8.0 ../../Bin/Gentoo/libconfig.so.2.8.0 ../../Bin/Gentoo/libbase.so.2.8.0 -ldl -lboost_thread-mt -lboost_system-mt -lboost_program_options-mt -lboost_regex-mt -lboost_chrono-mt -lboost_date_time-mt -lboost_atomic-mt -lssl -lcrypto ../../Bin/Gentoo/libyajl.so.2.1.0 ../../Bin/Gentoo/libmmatch.so.2.8.0 ../../Bin/Gentoo/libsocketpair.so.2.8.0 ../../Bin/Gentoo/libexecvpe.so.2.8.0
cd /var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build/lib/icinga && /usr/bin/cmake -E cmake_symlink_library ../../Bin/Gentoo/libicinga.so.2.8.0 ../../Bin/Gentoo/libicinga.so.2.8.0 ../../Bin/Gentoo/libicinga.so
make[2]: Leaving directory '/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build'
[ 64%] Built target icinga
make[1]: Leaving directory '/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build'
make: *** [Makefile:166: all] Error 2
 * ERROR: net-analyzer/icinga2-2.8.0::gentoo failed (compile phase):
 *   emake failed
 *
 * If you need support, post the output of `emerge --info '=net-analyzer/icinga2-2.8.0::gentoo'`,
 * the complete build log and the output of `emerge -pqv '=net-analyzer/icinga2-2.8.0::gentoo'`.
 * The complete build log is located at '/var/tmp/portage/net-analyzer/icinga2-2.8.0/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/net-analyzer/icinga2-2.8.0/temp/environment'.
 * Working directory: '/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build'
 * S: '/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0'




Anyone a idea what's the cause for this?

Kind regards,

Timo




Comment 1


Timo Eissler





          2018-01-16 10:04:57 UTC
        

Created attachment 515024 [details]
emerge --info of the system where emerge succeeds




Comment 2


Jonas Stein






          2018-01-16 16:17:00 UTC
        

It is sad to read that you have problems with the software. The situation seems to be a bit more complicate and requires some analysis.
We can not help you efficiently via bug tracker. The bug tracker aims rather on specific problems in .ebuilds and less on individual systems. 

I have had very good experience on the gentoo IRC [1] with questions like this. Of course there are also forums and mailing lists [2,3].
I hope you understand, that I will close the bug here therefore and wish you good luck on one of the mentioned channels [4].

Please reopen the ticket in order to provide an indication for an specific error in an ebuild or any gentoo related product.

I suggest to ask with exact the same information in #gentoo first.

[1] https://www.gentoo.org/get-involved/irc-channels/
[2] https://forums.gentoo.org/
[3] https://www.gentoo.org/get-involved/mailing-lists/all-lists.html
[4] https://www.gentoo.org/support/




Comment 3


Matthew Thode ( prometheanfire )









          2018-01-17 02:15:37 UTC
        

icinga2 tents to take a ton of ram to compile (yay c++).  I'd look at dmesg for oom messages and gcc being killed (this happens on my 4G VM).




Comment 4


Timo Eissler





          2018-01-17 11:05:45 UTC
        

I'm pretty sure that memory isn't the problem. I also could see a OOM in dmesg.

# LANG=C free -m
              total        used        free      shared  buff/cache   available
Mem:          16001        3735         734           0       11531       12082
Swap:          8191           0        8191

Extracting the icinga tgz and compiling manually without portage but with the same cmake compiles successfully.




Comment 5


Matthew Thode ( prometheanfire )









          2018-01-17 17:09:38 UTC
        

Ya, 12G should be more than enough.  If you could attach the build log of the fail that could help.




Comment 6


Timo Eissler





          2018-01-17 19:36:22 UTC
        

Created attachment 515200 [details]
emerge logfile

Here the logfile made with "emerge -dv icinga2"




Comment 7


Matthew Thode ( prometheanfire )









          2018-01-18 20:12:15 UTC
        

[ 48%] Building CXX object lib/cli/CMakeFiles/cli.dir/nodesetupcommand.cpp.o
cd /var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build/lib/cli && /usr/bin/x86_64-pc-linux-gnu-g++ -DI2_CLI_BUILD -I/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build/third-party/yajl/include -I/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0 -I/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0/lib -I/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build -I/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build/lib   -DNDEBUG -march=native -mtune=generic -O2 -pipe -lpthread  -pthread -fvisibility=hidden -std=c++0x -fPIC   -o CMakeFiles/cli.dir/nodesetupcommand.cpp.o -c /var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0/lib/cli/nodesetupcommand.cpp
../Bin/Gentoo/libremote.so.2.8.0: undefined reference to `boost::re_detail_106300::cpp_regex_traits_implementation<char>::transform[abi:cxx11](char const*, char const*) const'
../Bin/Gentoo/libremote.so.2.8.0: undefined reference to `boost::re_detail_106300::cpp_regex_traits_implementation<char>::transform_primary[abi:cxx11](char const*, char const*) const'
collect2: error: ld returned 1 exit status
make[2]: *** [plugins/CMakeFiles/check_nscp_api.dir/build.make:116: Bin/Gentoo/check_nscp_api] Error 1
make[2]: Leaving directory '/var/tmp/portage/net-analyzer/icinga2-2.8.0/work/icinga2-2.8.0_build'
make[1]: *** [CMakeFiles/Makefile2:2441: plugins/CMakeFiles/check_nscp_api.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....




rebuild your boost and it should go away




Comment 8


Timo Eissler





          2018-01-19 09:07:28 UTC
        

Thank you very much! Rebuilding boost fixed it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

