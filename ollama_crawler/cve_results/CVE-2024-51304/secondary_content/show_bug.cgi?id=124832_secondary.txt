Title: 124832 – splashutils-1.1.9.10-r1 fails on Gentoo GCC 4.1.0 Release
URL: https://bugs.gentoo.org/show_bug.cgi?id=124832

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 124832
splashutils-1.1.9.10-r1 fails on Gentoo GCC 4.1.0 Release
Last modified: 2008-02-10 22:41:34 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 124832 
      - splashutils-1.1.9.10-r1 fails on Gentoo GCC 4.1.0 Release


Summary:
splashutils-1.1.9.10-r1 fails on Gentoo GCC 4.1.0 Release
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GCC Porting

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       minor
      


Assignee:

Michal Januszewski (RETIRED)








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

125282

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2006-03-03 10:45 UTC by Bob





      Modified:
    
2008-02-10 22:41 UTC
      (History)
    




          CC List:
        

7 
          users
          
            (show)
          



andre
patrizio.bassi
paulmedic555
pkdevel
rockoo
Tinitus1
tschenturs









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Bob





          2006-03-03 10:45:05 UTC
        

Splashutils-1.1.9.10-r1 will not compile when using Gentoo's GCC 4.1.0 release.

error:

make[1]: Leaving directory `/var/tmp/portage/splashutils-1.1.9.10-r1/work/miscsplashutils-0.1.3/fbtruetype'
make[1]: Entering directory `/var/tmp/portage/splashutils-1.1.9.10-r1/work/miscsplashutils-0.1.3/kbd'
cc -march=pentium3 -O2 -fomit-frame-pointer -pipe   -c -o fgconsole.o fgconsole.c
cc -march=pentium3 -O2 -fomit-frame-pointer -pipe   -c -o getfd.o getfd.c
cc -march=pentium3 -O2 -fomit-frame-pointer -pipe -Wl,-O1 -Wl,--sort-common -s fgconsole.o getfd.o -o fgconsole
make[1]: Leaving directory `/var/tmp/portage/splashutils-1.1.9.10-r1/work/miscsplashutils-0.1.3/kbd'
  CONF    libjpeg
  MAKE    libjpeg
In file included from /usr/lib/klibc/include/stdio.h:9,
                 from jinclude.h:46,
                 from jcapimin.c:20:
/usr/lib/klibc/include/stdarg.h:9:25: error: stdarg.h: No such file or directory
In file included from jinclude.h:46,
                 from jcapimin.c:20:
/usr/lib/klibc/include/stdio.h:100: error: expected declaration specifiers or '...' before 'va_list'
/usr/lib/klibc/include/stdio.h:102: error: expected declaration specifiers or '...' before 'va_list'
/usr/lib/klibc/include/stdio.h:104: error: expected declaration specifiers or '...' before 'va_list'
/usr/lib/klibc/include/stdio.h:106: error: expected declaration specifiers or '...' before 'va_list'
/usr/lib/klibc/include/stdio.h:108: error: expected declaration specifiers or '...' before 'va_list'
/usr/lib/klibc/include/stdio.h:119: error: expected declaration specifiers or '...' before 'va_list'
make[1]: *** [jcapimin.o] Error 1
make: *** [jpeglib] Error 2

!!! ERROR: media-gfx/splashutils-1.1.9.10-r1 failed.
Call stack:
  ebuild.sh, line 1933:   Called dyn_compile
  ebuild.sh, line 971:   Called src_compile

!!! failed to build splashutils
!!! If you need support, post the topmost build error, and the call stack if relevant.




Comment 1


Bob





          2006-03-03 10:46:37 UTC
        

# emerge --info

Portage 2.1_pre5-r2 (default-linux/x86/2006.0, gcc-4.1.0, glibc-2.3.6-r3, 2.6.15-gentoo-r1 i686)
=================================================================
System uname: 2.6.15-gentoo-r1 i686 Pentium III (Coppermine)
Gentoo Base System version 1.12.0_pre16
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
dev-lang/python:     2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1-r2
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium3 -O2 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/kde/3/share/config /usr/share/X11/xkb /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/splash /etc/terminfo /etc/env.d"
CXXFLAGS="-march=pentium3 -O2 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks sandbox sfperms strict userpriv usersandbox"
GENTOO_MIRRORS="************"
LDFLAGS="-Wl,-O1 -Wl,--sort-common -s"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://************/gentoo-portage"
USE="x86 X a52 aac aalib acpi alsa apache2 arts artswrappersuid asf audiofile avi bash-completion berkdb bigger-fonts bitmap-fonts bluetooth browserplugin bzip2 cairo ccache cdparanoia cdr cgi clamav commercial crypt css cups curl dbus divx4linux dlloader dri dvd dvdr dvdread eds emboss encode esd exif fam fat fbcon ffmpeg firefox flac foomaticdb fortran gdbm gif gimp gimpprint glitz gnome gphoto2 gpm gstreamer gtk gtk2 gtkhtml hal howl idn imagemagick imap imlib ipv6 java jpeg kde kdeenablefinal kdexdeltas lcms ldap libg++ libwww lm_sensors logrotate mad matrox mbox mikmod mmx mng motif mozilla mp3 mpeg musicbrainz nautilus ncurses nls nptl nptlonly nsplugin ntfs offensive ogg on-the-fly-crypt opengl oss pam pcre pdf pdflib perl pic png pop ppds python qt quicktime rdesktop readline real s3 s3virge samba scanner sdl slang smp smtp snmp sockets spell sse sse2 ssl svg sysfs tcltk tcpd tiff toolbar transcode truetype truetype-fonts type1-fonts udev unicode usb userlocales vcd vorbis win32codecs xcomposite xine xinerama xml xml2 xmms xprint xscreensaver xv xvid zeroconf zlib elibc_glibc input_devices_mouse input_devices_keyboard kernel_linux userland_GNU video_cards_fbdev video_cards_vesa video_cards_s3 video_cards_s3virge video_cards_matrox"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, LANG, LC_ALL, LINGUAS





Comment 2


Philip Kovacs





          2006-03-03 11:02:56 UTC
        

It's not just a gcc 4.x problem. It fails on stable gcc 3.4.5 also:


cc -march=pentium4 -O2 -fomit-frame-pointer -pipe   -c -o fgconsole.o fgconsole.c
cc -march=pentium4 -O2 -fomit-frame-pointer -pipe   -c -o getfd.o getfd.c
cc -march=pentium4 -O2 -fomit-frame-pointer -pipe  fgconsole.o getfd.o -o fgconsole
make[1]: Leaving directory `/var/tmp/portage/splashutils-1.1.9.10-r1/work/miscsplashutils-0.1.3/kbd'
  CONF    libjpeg
  MAKE    libjpeg
In file included from /usr/lib/klibc/include/stdio.h:9,
                 from jinclude.h:46,
                 from jcapimin.c:20:
/usr/lib/klibc/include/stdarg.h:9:25: stdarg.h: No such file or directory
In file included from jinclude.h:46,
                 from jcapimin.c:20:
/usr/lib/klibc/include/stdio.h:100: error: syntax error before "va_list"
/usr/lib/klibc/include/stdio.h:102: error: syntax error before "va_list"
/usr/lib/klibc/include/stdio.h:104: error: syntax error before "va_list"
/usr/lib/klibc/include/stdio.h:106: error: syntax error before "va_list"
/usr/lib/klibc/include/stdio.h:108: error: syntax error before "va_list"
/usr/lib/klibc/include/stdio.h:119: error: syntax error before "va_list"
make[1]: *** [jcapimin.o] Error 1
make: *** [jpeglib] Error 2

!!! ERROR: media-gfx/splashutils-1.1.9.10-r1 failed.
Call stack:
  ebuild.sh, line 1933:   Called dyn_compile
  ebuild.sh, line 971:   Called src_compile

!!! failed to build splashutils
!!! If you need support, post the topmost build error, and the call stack if relevant.

---emerge --info----

Portage 2.1_pre5-r2 (default-linux/x86/2006.0, gcc-3.4.5, glibc-2.3.5-r2, 2.6.14-gentoo-r5 i686)
=================================================================
System uname: 2.6.14-gentoo-r5 i686 Intel(R) Pentium(R) 4 CPU 2.40GHz
Gentoo Base System version 1.6.14
dev-lang/python:     2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium4 -O2 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/share/X11/xkb /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/splash /etc/terminfo /etc/env.d"
CXXFLAGS="-march=pentium4 -O2 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distcc distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://mirror.datapipe.net/gentoo ftp://gentoo.mirrors.pair.com http://gentoo.ccccom.com http://distfiles.gentoo.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
LANG="en_US.utf8"
LC_ALL="en_US.utf8"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="x86 X aalib alsa apm avi bitmap-fonts cdr crypt cups dvd dvdr eds emboss encode fbcon foomaticdb gif gpm gstreamer gtk gtk2 imlib jpeg libg++ libwww mad mikmod mmx mp3 mpeg ncurses nls nptl ogg opengl oss pdflib perl png python quicktime readline sdl slang spell sse sse2 ssl tcpd truetype truetype-fonts type1-fonts udev unicode vorbis xml xml2 xv xvid zlib elibc_glibc input_devices_keyboard input_devices_mouse kernel_linux userland_GNU video_cards_nv"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, LDFLAGS, LINGUAS





Comment 3


Bob





          2006-03-03 11:57:10 UTC
        

found a solution:  splashutils depends upon klibc but the portage dependencies seem to be all wrong.  i did an emerge -uDpv world today and found klibc was going to be updated a few ebuilds AFTER splashutils.  that won't work.

even if i already had klibc emerged, i found that i had to re-emerge klibc and then rebuild splashutils.  then splashutils built properly.  you probably know that both packages build off of kernel information and that you'd have to rebuild them both after a kernel upgrade. i'm not exactly sure why this splash building error happened to me, as i haven't ever bumped the kernel on the box where i encountered this problem.

at any rate, try this:

"emerge klibc splashutils" and see if that fixes the problem.  if it does, maybe the ebuild needs to be updated to eliminate this problem.  hth.




Comment 4


Philip Kovacs





          2006-03-03 12:14:27 UTC
        

Confirmed.  emerge --oneshot klibc to reinstall (same version of) klibc (1.2.1-r1) and then re-emerging splashutils yields no build errors.   I don't recall changing kernels however.   I did regress from 2.6.15 back to 2.6.14, for reasons not important here, but I think that was before I installed klibc 1.2.1-r1 for the first time on Feb 7.  I am not sure.

Obviously you're onto something.




Comment 5


Jakub Moc (RETIRED)






          2006-03-06 12:41:02 UTC
        

*** Bug 125282 has been marked as a duplicate of this bug. ***




Comment 6


Patrizio Bassi





          2006-03-09 09:03:28 UTC
        

after emerging lastest klibc

 CC      cmd.o
  CC      common.o
  CC      daemon.o
In file included from daemon.c:27:
/var/tmp/portage/splashutils-1.1.9.10-r1/work/splashutils-1.1.9.10/linux/include/linux/input.h:801: error: expected specifier-qualifier-list before &#8216;kernel_ulong_t&#8217;
make: *** [daemon.o] Error 1

!!! ERROR: media-gfx/splashutils-1.1.9.10-r1 failed.

Portage 2.1_pre5-r4 (default-linux/x86/2006.0, gcc-4.1.0, glibc-2.3.6-r6, 2.6.16-rc2-git1 i686)
=================================================================
System uname: 2.6.16-rc2-git1 i686 Pentium III (Katmai)
Gentoo Base System version 1.12.0_pre16
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [disabled]
dev-lang/python:     2.4.2-r1
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.91.0.6-r1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r3
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -mtune=pentium3 -march=pentium3 -pipe -fomit-frame-pointer -mmmx -msse -ffast-math"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /etc/mail/dspam /opt/openjms/config /usr/kde/2/share/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/bind /var/qmail/control /var/run/dspam"
CONFIG_PROTECT_MASK="/etc/gconf /etc/splash /etc/terminfo /etc/texmf/web2c /etc/env.d"
CXXFLAGS="-O3 -mtune=pentium3 -march=pentium3 -pipe -fomit-frame-pointer -mmmx -msse -ffast-math"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks fixpackages sandbox sfperms strict"
GENTOO_MIRRORS="http://www.die.unipd.it/pub/Linux/distributions/gentoo-sources/ http://gentoo.ngi.it"
LANG="it_IT.utf8"
LC_ALL="it_IT.utf8"
LDFLAGS="-Wl,-O1 -Wl,--sort-common -Wl,--enable-new-dtags -Wl,-Bdirect -Wl,--as-needed -Wl,-hashvals -Wl,-zdynsort"
LINGUAS="it"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/myportage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 X X509 Xaw3d a52 aac aalib accessibility acl acpi activefilter adns alsa apache2 apm arts asf audiofile avi bash-completion berkdb bidi bitmap-fonts bootsplash browserplugin bzip2 cairo caps cdda cddb cdio cdparanoia cdr cgi chroot clamav cli client codecs crypt css cups curl dba dbus dga dhcp directfb djbfft dri edl eds emboss encode ethereal exif expat extraengine faac faad fam fbcon ffmpeg fftw firefox flac flash foomaticdb foreign-package fortran ftp gcj gd gdbm geometry ggi gif gimp gimpprint glut glx gnokii gnome gnutls gphoto2 gpm graphviz gs gstreamer gtk gtk2 gtkhtml guile h264 hal iconv idea idn imagemagick imap imlib innodb ipod irda irmc jack java javascript jikes jit joystick jpeg jpeg2k junit justify kde kdeenablefinal kerberos kqemu lame lcd lcms ldap libcaca libclamav libg++ libgda libusb libwww lirc live lm_sensors lua lzo mad mailwrapper matroska md5sum mdb mhash mikmod mime mmx mmx2 mmxext mng mono motif mozcalendar mozdevelop mozilla mozsvg mozxmlterm mp3 mp4 mp4live mpeg mpeg2 mpeg4 mplayer msn msnextras mysql mysqli mythtv nagios-dns nagios-ntp nagios-ping nagios-ssh ncurses neXt network ngui nls nntp no_wxgtk1 nobsh nopie nossp noxalan nptl nptlonly nsplugin oav odbc ogg openal opengl openssl operanom2 oss pam pcre pda pdf pdflib pdo pear perl php png pnp postgres ppds pthreads python qemu-fast qhull qt quicktime quotas readline real rrdtool rtc ruby samba scanner sdl server session sftplogging sguil slang slp snortsam soap sockets socks5 softmmu softquota spamassassin speex spell sqlite3 sse ssl subject-rewrite svg svga tcltk tcpd tetex tga theora tiff tokenizer truetype truetype-fonts trusted type1-fonts udev unicode usb userlocales vidix vorbis win32codecs wmf wsconvert wxwindows x264 xanim xchatdccserver xchattext xcomposite xine xinerama xml xml2 xmlrpc xmms xosd xpm xprint xsl xv xvid xvm xvmc zlib elibc_glibc kernel_linux linguas_it userland_GNU"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, MAKEOPTS





Comment 7


Robert Golding





          2006-03-10 20:44:38 UTC
        

(In reply to comment #3)
> found a solution:  splashutils depends upon klibc but the portage dependencies
> seem to be all wrong.  i did an emerge -uDpv world today and found klibc was
> going to be updated a few ebuilds AFTER splashutils.  that won't work.
> 
> even if i already had klibc emerged, i found that i had to re-emerge klibc and
> then rebuild splashutils.  then splashutils built properly.  you probably know
> that both packages build off of kernel information and that you'd have to
> rebuild them both after a kernel upgrade. i'm not exactly sure why this splash
> building error happened to me, as i haven't ever bumped the kernel on the box
> where i encountered this problem.
> 
> at any rate, try this:
> 
> "emerge klibc splashutils" and see if that fixes the problem.  if it does,
> maybe the ebuild needs to be updated to eliminate this problem.  hth.
> 

Failed to fix problem. Here is my emerge --info
rob rob # emerge --info

Portage 2.1_pre5-r4 (default-linux/x86/2005.0, gcc-3.4.5, glibc-2.4-r0, 2.6.15-gentoo-r5 i686)
=================================================================
System uname: 2.6.15-gentoo-r5 i686 AMD Athlon(tm) XP 2500+
Gentoo Base System version 1.12.0_pre16
ccache version 2.3 [disabled]
dev-lang/python:     2.3.5, 2.4.2-r1
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=athlon-xp -mtune=athlon-xp -O2 -pipe -fomit-frame-pointer -momit-leaf-frame-pointer -fno-ident"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/splash /etc/terminfo /etc/env.d"
CXXFLAGS="-march=athlon-xp -mtune=athlon-xp -O2 -pipe -fomit-frame-pointer -momit-leaf-frame-pointer -fno-ident -fvisibility-inlines-hidden"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://mirror.aarnet.edu.au/pub/gentoo http://mirror.pacific.net.au/linux/Gentoo http://ftp.swin.edu.au/gentoo http://distfiles.gentoo.org http://gentoo.osuosl.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow 3dnowext X a52 aac aalib alsa apm arts avi bash-completion berkdb bitmap-fonts bluetooth bonobo browserplugin bzlib cdr crypt cups dri dv dvd dvdr dvdread eds emboss encode esd fame firefox foomaticdb fortran freetype gdbm gif gimp gnome gpm gstreamer gtk gtk2 hal imlib ipv6 java javascript jpeg kde libg++ libwww mad mikmod mjpeg mmx mmxext motif mp3 mpeg mpg mplayer ncurses nls nptl nptlonly nsplugin nvivia ogg oggvorbis opengl oss pam pdf pdflib perl png ppds python qt quicktime readline real sane scanner sdl spell sse ssl svg svga tcpd tga tiff totem truetype truetype-fonts type1-fonts usb v4l vcd vorbis win32codecs wmf xine xml2 xmms xsane xv xvid zlib elibc_glibc kernel_linux userland_GNU"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY





Comment 8


Sebastian Roeder





          2006-03-11 02:42:14 UTC
        

I can confirm this error here too on x86 with stable GCC 3.4.5 but ~x86 baselayout and portage 2.1_preX. Maybe it's a portage problem? Can somebody reproduce the bug with stable portage?




Comment 9


Michal Januszewski (RETIRED)






          2006-03-11 16:59:13 UTC
        

There is no need to test it with different Portage versions, I think.

First of all, we are dealing with two different issues here. The first one was related to klibc and it can probably be fixed by simply remerging it/upgrading to the latest available version.

The second problem is a bug in the kernel headers. A simple workaround is to move '#ifdef __KERNEL__' from line 839 to somewhere before 'struct input_device_id {' in include/linux/input.h in your kernel source tree.




Comment 10


Bob





          2006-03-13 15:01:38 UTC
        

(In reply to comment #9)
> There is no need to test it with different Portage versions, I think.
> 
> First of all, we are dealing with two different issues here. The first one was
> related to klibc and it can probably be fixed by simply remerging it/upgrading
> to the latest available version.

going back to the first problem:  re-emerging the _same_version_ of klibc fixed the problem. it wasn't an update.  if there were an update to klibc then the "emerge -uD world" command would have fixed the problem by updating klibc before splashutils.  because there was no update to klibc, that didn't happen.  

this would suggest that the first problem is not avoidable using the traditional portage "dependency" rules.  splashutils needed klibc rebuilt regardless of the fact that there was no klibc update in play.  that's a bug, isn't it?




Comment 11


Mark Loeser (RETIRED)






          2006-03-16 23:51:49 UTC
        

This doesn't look like it is gcc-4.x specific, so I'm removing the blocker.  Readd it if I'm wrong please :)




Comment 12


Michal Januszewski (RETIRED)






          2006-03-17 09:37:22 UTC
        

Bob: It would be. But as far as I can tell, splashutils doesn't require a rebuild of klibc. When you got these errors, it was probably caused by a breakage somewhere else in the system (gcc, kernel headers etc). Unless you can provide me with a way to reproduce it (eg. 'emerge -C klibc ; emerge splashutils' leads to a compilation error), I don't see what can be done about it here.




Comment 13


Patrizio Bassi





          2006-03-20 07:13:04 UTC
        

michael you fix works, but you can do this:

copy the input.h file locally, patch and merge.




Comment 14


André Terpstra





          2006-04-06 21:02:13 UTC
        

(In reply to comment #9)
> There is no need to test it with different Portage versions, I think.
> 
> First of all, we are dealing with two different issues here. The first one was
> related to klibc and it can probably be fixed by simply remerging it/upgrading
> to the latest available version.
> 
> The second problem is a bug in the kernel headers. A simple workaround is to
> move '#ifdef __KERNEL__' from line 839 to somewhere before 'struct
> input_device_id {' in include/linux/input.h in your kernel source tree.
> 

The second problem still exists.Is a patch underway?




Comment 15


Michal Januszewski (RETIRED)






          2006-04-16 00:21:08 UTC
        

Please see bug #124301 for a fix of the input.h problem.




Comment 16


Robert Golding





          2006-04-17 03:55:28 UTC
        

Had already tried comment# 3's fix, but wouldn't work.  

Then tried "emerge splashutils" after upgrade to kernel 2.6.16-r2, (bug# 124301) but still no joy.

The re-tried "emerge klibc splashutils" (as per comment #3) again and it worked this time with the new kernel.






Comment 17


Mark Loeser (RETIRED)






          2006-04-19 21:12:30 UTC
        

Ignore me... :)




Comment 18


Mike McQuaid





          2006-05-08 07:45:12 UTC
        

Still no joy with any method described. Running GCC 4.1, kernel 2.6.16 and ~amd64.

Last part of emerge:

  CC      common.o
  CC      daemon.o
In file included from daemon.c:28:
/var/tmp/portage/splashutils-1.1.9.10-r1/work/splashutils-1.1.9.10/linux/include/linux/input.h:801: error: expected specifier-qualifier-list before &#8216;kernel_ulong_t&#8217;
make: *** [daemon.o] Error 1

!!! ERROR: media-gfx/splashutils-1.1.9.10-r1 failed.
Call stack:
  ebuild.sh, line 1525:   Called dyn_compile
  ebuild.sh, line 928:   Called src_compile
  splashutils-1.1.9.10-r1.ebuild, line 139:   Called die

!!! failed to build splashutils
!!! If you need support, post the topmost build error, and the call stack if relevant.





Comment 19


Michal Januszewski (RETIRED)






          2006-07-05 08:40:29 UTC
        

Closing. The kernel headers problem should be fixed in gentoo-sources and the klibc issue, whatever it was, can be fixed simply by reemerging klibc.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

