Title: 503158 – media-video/totem-3.8.2-r1 and gst-plugins-vaapi-0.5.8 segfault
URL: https://bugs.gentoo.org/show_bug.cgi?id=503158

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 503158
media-video/totem-3.8.2-r1 and gst-plugins-vaapi-0.5.8 segfault
Last modified: 2014-04-03 16:00:34 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 503158 
      - media-video/totem-3.8.2-r1 and gst-plugins-vaapi-0.5.8 segfault


Summary:
media-video/totem-3.8.2-r1 and gst-plugins-vaapi-0.5.8 segfault
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-03-01 21:57 UTC by Jan Vesely





      Modified:
    
2014-04-03 16:00 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



gstreamer
mehmet









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jan Vesely





          2014-03-01 21:57:31 UTC
        

trying to play mkv video using totem:
No accelerated IMDCT transform found
libva info: VA-API version 0.33.0
libva info: va_getDriverName() returns 0
libva info: Trying to open /usr/lib64/va/drivers/i965_drv_video.so
libva info: Found init function __vaDriverInit_0_33
libva info: va_openDriver() returns 0

** (totem:7891): CRITICAL **: gst_vaapi_image_get_plane: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:7891): CRITICAL **: gst_vaapi_image_get_pitch: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:7891): CRITICAL **: gst_vaapi_image_get_plane: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:7891): CRITICAL **: gst_vaapi_image_get_pitch: assertion '_gst_vaapi_image_is_mapped(image)' failed
Segmentation fault

$ vainfo
libva info: VA-API version 0.33.0
libva info: va_getDriverName() returns 0
libva info: Trying to open /usr/lib64/va/drivers/i965_drv_video.so
libva info: Found init function __vaDriverInit_0_33
libva info: va_openDriver() returns 0
vainfo: VA-API version: 0.33 (libva 1.1.1)
vainfo: Driver version: Intel i965 driver - 1.0.20
vainfo: Supported profile and entrypoints
      VAProfileMPEG2Simple            :	VAEntrypointVLD
      VAProfileMPEG2Main              :	VAEntrypointVLD
      VAProfileH264Baseline           :	VAEntrypointVLD
      VAProfileH264Baseline           :	VAEntrypointEncSlice
      VAProfileH264Main               :	VAEntrypointVLD
      VAProfileH264Main               :	VAEntrypointEncSlice
      VAProfileH264High               :	VAEntrypointVLD
      VAProfileH264High               :	VAEntrypointEncSlice
      VAProfileVC1Simple              :	VAEntrypointVLD
      VAProfileVC1Main                :	VAEntrypointVLD
      VAProfileVC1Advanced            :	VAEntrypointVLD



Reproducible: Always




Comment 1


Pacho Ramos






          2014-03-01 22:25:33 UTC
        

Please provide emerge --info output. Also, works ok for me with totem-3.10.1




Comment 2


Jan Vesely





          2014-03-01 22:30:05 UTC
        

(In reply to Pacho Ramos from comment #1)
> Please provide emerge --info output. Also, works ok for me with totem-3.10.1

same segfault with totem 3.10.1

$ emerge --info
Portage 2.2.7 (default/linux/amd64/13.0, gcc-4.7.3, glibc-2.17, 3.13.5-gentoo x86_64)
=================================================================
System uname: Linux-3.13.5-gentoo-x86_64-Intel-R-_Core-TM-_i5-2520M_CPU_@_2.50GHz-with-gentoo-2.2
KiB Mem:     3985020 total,    477824 free
KiB Swap:    4194300 total,   3623428 free
Timestamp of tree: Sat, 01 Mar 2014 20:00:01 +0000
ld GNU ld (GNU Binutils) 2.23.2
app-shells/bash:          4.2_p45
dev-lang/python:          2.7.5-r3, 3.3.3
dev-util/cmake:           2.8.11.2
dev-util/pkgconfig:       0.28
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.12.4
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.11.6, 1.13.4
sys-devel/binutils:       2.23.2
sys-devel/gcc:            4.7.3-r1
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.13 (virtual/os-headers)
sys-libs/glibc:           2.17
Repositories: gentoo local
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=native -mtune=native -fomit-frame-pointer -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -march=native -mtune=native -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
USE="X X509 a52 aac acl aio alsa amd64 apng avx berkdb blksha1 bluetooth branding bzip2 cairo caps cdda cddb cdr chroot clang cli clutter colord colordiff cracklib crypt cryptsetup css ctype cups curl custom-optimization cxx dbus dga dri drm dts dv dvd dvdnav dvdr dvi dvipdfm eap-sim egl enca exif expat faac faad fbcon ffmpeg filter flac fontconfig fortran fpm fpx g3dvl gbm gd gdbm gdm gif gimp gles gles1 gles2 glib gmp gnome gnome-keyring gnome-online-accounts gnutls gpg gpm graphics graphite gstreamer gtk gtk3 gtkstyle gudev hardened hddtemp hdri hpn hwdb hybrid iconv icu id3tag idle imagemagick ipv6 irc ithreads jabber jit jpeg jpeg2k json justify keymap kpathsea lcms ldns libkms libnotify libsecret llvm llvm-shared-libs lm_sensors logrotate lto mad mbox mikmod minizip mktemp mmap mmx mmxext mng modules mozilla mp3 mp4 mpeg multicall multilib multitarget musepack mysqli mysqlnd nat nautilus ncurses networkmanager nls nptl objc ogg openal opencl opengl openmp openrc optimization opus osmesa pam pcap pch pcmcia pcre pdf pkcs11 playtools png policykit publishers pulseaudio quicktime raw readline reencrypt rtc samba science secure-delete security session sha512 shared-dricore smartcard smp sockets speex spell sqlite srv sse sse2 sse3 sse4 sse4_1 ssl ssse3 strong-optimization svg syslog system-cairo system-ffmpeg system-icu system-jpeg system-libCg system-sqlite systemd sysvipc t1lib tci templates theora threads threadsafe thunar tiff timezone tokenizer tor-hardening tordns truetype udev unicode unlock-notify usb v4l vaapi valgrind vdpau vhosts vim-syntax vorbis wavpack wayland wayland-compositor webgl webkit2 webp wmf x264 xanim xattr xcb xcomposite xfs xhtml xml xmp xpm xv xvid xvmc xwayland zip zlib" ABI_X86="64" ALSA_CARDS="hda-intel" APACHE2_MODULES="alias auth_digest authn_anon authn_default authn_file authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd dir env expires ext_filter file_cache filter headers ident imagemap include info log_config mem_cache mime mime_magic negotiation proxy rewrite setenvif so status unique_id userdir vhost_alias" APACHE2_MPMS="worker" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CURL_SSL="openssl" DRACUT_MODULES="plymouth systemd" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" GRUB_PLATFORMS="pc efi-64 multiboot" INPUT_DEVICES="evdev synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer pdfimport" LINGUAS="en_GB en_US en" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-3" PYTHON_SINGLE_TARGET="python3_3" PYTHON_TARGETS="python3_3" QEMU_SOFTMMU_TARGETS="i386 x86_64 arm ppc" RUBY_TARGETS="ruby19" USERLAND="GNU" VIDEO_CARDS="nouveau intel i965" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
USE_PYTHON="3.3"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, SYNC




Comment 3


Jan Vesely





          2014-03-01 22:34:02 UTC
        

I see these messages in dmesg:
[32025.280986] vqueue:src[7850]: segfault at 0 ip 00007fddf802e0a0 sp 00007fddd55d99f8 error 4 in orcexec.u7EFsV (deleted)[7fddf802e000+10000]
[32027.582977] vqueue:src[7869]: segfault at 0 ip 00007f209c0370a0 sp 00007f206fdb99f8 error 4 in orcexec.TtiTGC (deleted)[7f209c037000+10000]
[32036.110873] vqueue:src[7902]: segfault at 0 ip 00007f94180120a0 sp 00007f94013d49f8 error 4 in orcexec.X3CoYi (deleted)[7f9418012000+10000]
[32937.241457] vqueue:src[11817]: segfault at 0 ip 00007fe5900320a0 sp 00007fe585feb9f8 error 4 in orcexec.q3H9rO (deleted)[7fe590032000+10000]
[34401.294202] vqueue:src[19624]: segfault at 0 ip 00007f992d7bf0a0 sp 00007f98f7ffd9f8 error 4 in orcexec.aM9aqU (deleted)[7f992d7bf000+10000]
[34438.752428] vqueue:src[19647]: segfault at 0 ip 00007f02b026a0a0 sp 00007f02877799f8 error 4 in orcexec.sOGOMg (deleted)[7f02b026a000+10000]




Comment 4


Pacho Ramos






          2014-03-01 22:37:54 UTC
        

Then, try with other files, and try to get a backtrace:
https://wiki.gentoo.org/wiki/Project:Quality_Assurance/Backtraces




Comment 5


Jan Vesely





          2014-03-01 23:08:03 UTC
        

All files I have tried segfault in the same way, here's a backtrace:

(gdb) r The\ Hobbit\ -\ An\ Unexpected\ Journey\ -\ Trailer.mp4
Starting program: /usr/bin/totem The\ Hobbit\ -\ An\ Unexpected\ Journey\ -\ Trailer.mp4
warning: Could not load shared library symbols for linux-vdso.so.1.
Do you need "set solib-search-path" or "set sysroot"?
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib64/libthread_db.so.1".
[New Thread 0x7fffe7967700 (LWP 17531)]
[New Thread 0x7fffe7166700 (LWP 17532)]
[New Thread 0x7fffddc9f700 (LWP 17533)]
[New Thread 0x7fffd2e14700 (LWP 17534)]
[New Thread 0x7fffcbfff700 (LWP 17535)]
[New Thread 0x7fffcb7fe700 (LWP 17536)]
[New Thread 0x7fffca97d700 (LWP 17537)]
[New Thread 0x7fffca17c700 (LWP 17538)]
[New Thread 0x7fffc952f700 (LWP 17539)]
libva info: VA-API version 0.33.0
libva info: va_getDriverName() returns 0
libva info: Trying to open /usr/lib64/va/drivers/i965_drv_video.so
libva info: Found init function __vaDriverInit_0_33
libva info: va_openDriver() returns 0
[New Thread 0x7fffbe3bf700 (LWP 17540)]
[New Thread 0x7fffbd59c700 (LWP 17541)]
[New Thread 0x7fffbc940700 (LWP 17542)]
[New Thread 0x7fff9ff7f700 (LWP 17543)]

** (totem:17527): CRITICAL **: gst_vaapi_image_get_plane: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:17527): CRITICAL **: gst_vaapi_image_get_pitch: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:17527): CRITICAL **: gst_vaapi_image_get_plane: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:17527): CRITICAL **: gst_vaapi_image_get_pitch: assertion '_gst_vaapi_image_is_mapped(image)' failed

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7fffbe3bf700 (LWP 17540)]
0x00007fffe40540a0 in ?? ()
(gdb) bt
#0  0x00007fffe40540a0 in ?? ()
#1  0x00007ffff52138f6 in video_orc_unpack_NV12 (d1=d1@entry=0x7fffa001f610 "x", s1=s1@entry=0x0, s2=s2@entry=0x0, n=n@entry=960) at tmp-orc.c:5030
#2  0x00007ffff51f494b in unpack_NV12 (info=<optimized out>, flags=<optimized out>, dest=0x7fffa001f610, data=<optimized out>, stride=<optimized out>, x=<optimized out>, y=0, width=1920)
    at video-format.c:1054
#3  0x00007fffbe825df3 in videoconvert_convert_generic (convert=0x7fffa001f430, dest=<optimized out>, src=0x7fffbe3bdfb0) at videoconvert.c:540
#4  0x00007fffbe822e04 in gst_video_convert_transform_frame (filter=0x7fffa80640d0, in_frame=0x7fffbe3bdfb0, out_frame=0x7fffbe3be250) at gstvideoconvert.c:574
#5  0x00007ffff51fb2cc in gst_video_filter_transform (trans=0x7fffa80640d0, inbuf=<optimized out>, outbuf=0x7fffa80e2e90) at gstvideofilter.c:270
#6  0x00007ffff001eb97 in gst_base_transform_handle_buffer (trans=trans@entry=0x7fffa80640d0, inbuf=inbuf@entry=0x7fffa80e2720, outbuf=outbuf@entry=0x7fffbe3be5f8) at gstbasetransform.c:2094
#7  0x00007ffff001f455 in gst_base_transform_chain (pad=<optimized out>, parent=0x7fffa80640d0, buffer=0x7fffa80e2720) at gstbasetransform.c:2201
#8  0x00007ffff4d2edb8 in gst_pad_chain_data_unchecked (data=0x7fffa80e2720, type=<optimized out>, pad=0x7fffac007420) at gstpad.c:3760
#9  gst_pad_push_data (pad=0x7fffac0071f0, type=type@entry=4112, data=<optimized out>) at gstpad.c:3990
#10 0x00007ffff4d357d6 in gst_pad_push (pad=<optimized out>, buffer=<optimized out>) at gstpad.c:4093
#11 0x00007ffff001f585 in gst_base_transform_chain (pad=<optimized out>, parent=0x7fffa8038110, buffer=<optimized out>) at gstbasetransform.c:2237
#12 0x00007ffff4d2edb8 in gst_pad_chain_data_unchecked (data=0x7fffa80e2720, type=<optimized out>, pad=0x7fffac006fc0) at gstpad.c:3760
#13 gst_pad_push_data (pad=0x7fffac007650, type=type@entry=4112, data=<optimized out>) at gstpad.c:3990
#14 0x00007ffff4d357d6 in gst_pad_push (pad=<optimized out>, buffer=<optimized out>) at gstpad.c:4093
#15 0x00007ffff001f585 in gst_base_transform_chain (pad=<optimized out>, parent=0x7fffa80630d0, buffer=<optimized out>) at gstbasetransform.c:2237
#16 0x00007ffff4d2edb8 in gst_pad_chain_data_unchecked (data=0x7fffa80e2720, type=<optimized out>, pad=0x7fffac007880) at gstpad.c:3760
#17 gst_pad_push_data (pad=0x7fffac007ab0, type=type@entry=4112, data=<optimized out>) at gstpad.c:3990
#18 0x00007ffff4d357d6 in gst_pad_push (pad=<optimized out>, buffer=<optimized out>) at gstpad.c:4093
#19 0x00007ffff001f585 in gst_base_transform_chain (pad=<optimized out>, parent=0x7fffa805f4d0, buffer=<optimized out>) at gstbasetransform.c:2237
#20 0x00007ffff4d2edb8 in gst_pad_chain_data_unchecked (data=0x7fffa80e2720, type=<optimized out>, pad=0x7fffac007ce0) at gstpad.c:3760
#21 gst_pad_push_data (pad=pad@entry=0x7fffa80284f0, type=type@entry=4112, data=<optimized out>, data@entry=0x7fffa80e2720) at gstpad.c:3990
#22 0x00007ffff4d357d6 in gst_pad_push (pad=pad@entry=0x7fffa80284f0, buffer=buffer@entry=0x7fffa80e2720) at gstpad.c:4093
#23 0x00007ffff4d1fb1b in gst_proxy_pad_chain_default (pad=<optimized out>, parent=<optimized out>, buffer=0x7fffa80e2720) at gstghostpad.c:128
#24 0x00007ffff4d2edb8 in gst_pad_chain_data_unchecked (data=0x7fffa80e2720, type=<optimized out>, pad=0x7fffa8026530) at gstpad.c:3760
#25 gst_pad_push_data (pad=0x7fffac006930, type=type@entry=4112, data=<optimized out>, data@entry=0x7fffa80e2720) at gstpad.c:3990
#26 0x00007ffff4d357d6 in gst_pad_push (pad=<optimized out>, buffer=buffer@entry=0x7fffa80e2720) at gstpad.c:4093
#27 0x00007fffddedbd4b in gst_queue_push_one (queue=0x231d8e0) at gstqueue.c:1115
#28 gst_queue_loop (pad=<optimized out>) at gstqueue.c:1244
#29 0x00007ffff4d5d5e1 in gst_task_func (task=0x7fffa806e050) at gsttask.c:316
#30 0x00007ffff63fe9b2 in ?? () from /usr/lib64/libglib-2.0.so.0
#31 0x00007ffff63fe1f5 in ?? () from /usr/lib64/libglib-2.0.so.0
#32 0x00007ffff617bf3a in start_thread () from /lib64/libpthread.so.0
#33 0x00007ffff5eb69ad in clone () from /lib64/libc.so.6




Comment 6


Pacho Ramos






          2014-03-01 23:43:59 UTC
        

did you try with orc-0.4.18?




Comment 7


Jan Vesely





          2014-03-01 23:47:09 UTC
        

(In reply to Pacho Ramos from comment #6)
> did you try with orc-0.4.18?

this is with orc-0.4.18. gst-plugins-base-1.2.3 requires that version




Comment 8


Pacho Ramos






          2014-03-02 08:11:43 UTC
        

Please show "emerge -Opv x11-libs/libva x11-libs/libva-intel-driver x11-drivers/xf86-video-intel"

I have:
[ebuild   R   ~] x11-libs/libva-1.1.1-r1  USE="X drm opengl vdpau -egl -wayland" ABI_X86="(64) -32 (-x32)" VIDEO_CARDS="intel -dummy -fglrx -nvidia" 0 kB
[ebuild   R   ~] x11-libs/libva-intel-driver-1.0.20-r1  USE="X drm -wayland" ABI_X86="(64) -32 (-x32)" 0 kB
[ebuild   R   ~] x11-drivers/xf86-video-intel-2.99.910  USE="dri sna udev -debug -glamor -uxa -xvmc" 0 kB




Comment 9


Mart Raudsepp






          2014-03-02 10:46:04 UTC
        

not sure why it would end up in videoconvert. Also please show what plugins are actually created by starting it with GST_DEBUG=*FACTORY*:4 variable in environment




Comment 10


Jan Vesely





          2014-03-02 14:51:01 UTC
        

(In reply to Pacho Ramos from comment #8)
> Please show "emerge -Opv x11-libs/libva x11-libs/libva-intel-driver
> x11-drivers/xf86-video-intel"
> 
> I have:
> [ebuild   R   ~] x11-libs/libva-1.1.1-r1  USE="X drm opengl vdpau -egl
> -wayland" ABI_X86="(64) -32 (-x32)" VIDEO_CARDS="intel -dummy -fglrx
> -nvidia" 0 kB
> [ebuild   R   ~] x11-libs/libva-intel-driver-1.0.20-r1  USE="X drm -wayland"
> ABI_X86="(64) -32 (-x32)" 0 kB
> [ebuild   R   ~] x11-drivers/xf86-video-intel-2.99.910  USE="dri sna udev
> -debug -glamor -uxa -xvmc" 0 kB

$ emerge -Opv x11-libs/libva x11-libs/libva-intel-driver x11-drivers/xf86-video-intel

These are the packages that would be merged, in order:

[ebuild   R   ~] x11-libs/libva-1.1.1-r1  USE="X drm egl opengl vdpau wayland" ABI_X86="(64) -32 (-x32)" VIDEO_CARDS="intel -dummy -fglrx -nvidia" 0 kB
[ebuild   R   ~] x11-libs/libva-intel-driver-1.0.20-r1  USE="X drm wayland" ABI_X86="(64) -32 (-x32)" 0 kB
[ebuild   R   ~] x11-drivers/xf86-video-intel-2.99.910  USE="dri sna udev xvmc -debug -glamor -uxa" 0 kB

Total: 3 packages (3 reinstalls), Size of downloads: 0 kB




Comment 11


Jan Vesely





          2014-03-02 14:56:37 UTC
        

(In reply to Mart Raudsepp from comment #9)
> not sure why it would end up in videoconvert. Also please show what plugins
> are actually created by starting it with GST_DEBUG=*FACTORY*:4 variable in
> environment

0:00:00.182141187 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "playbin" named "play"
0:00:00.183105296 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "audioconvert" named "audio-converter"
0:00:00.183803363 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "scaletempo" named "scaletempo"
0:00:00.183940389 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "cluttersink" named "video-sink"
0:00:00.184492431 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "autoaudiosink" named "audio-sink"
0:00:00.185130314 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "fakesink" named "tempsink"
0:00:00.187471093 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "capsfilter" named "audiofilter"
0:00:00.187586569 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "bin" named "audiosinkbin"
0:00:00.208718598 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "goom" named "vis"
0:00:00.293520517 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "pulsesink" named "audio-sink-actual-sink-pulse"
0:00:00.295802825 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "uridecodebin"
0:00:00.296202085 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "filesrc" named "source"
0:00:00.296500905 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "decodebin"
0:00:00.296654464 21119      0x22c4d30 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "typefind" named "typefind"
0:00:00.311344816 21119      0x2154190 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "qtdemux"
0:00:00.312714251 21119 0x7f15400c8f20 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "multiqueue"
0:00:00.314169072 21119 0x7f15400c8f20 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "h264parse"
0:00:00.314565029 21119 0x7f15400c8f20 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "capsfilter"
0:00:00.315884461 21119 0x7f15400c8f20 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "aacparse"
0:00:00.320579307 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "vaapidecode"
libva info: VA-API version 0.33.0
0:00:00.322309562 21119      0x2261990 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "faad"
libva info: va_getDriverName() returns 0
libva info: Trying to open /usr/lib64/va/drivers/i965_drv_video.so
libva info: Found init function __vaDriverInit_0_33
libva info: va_openDriver() returns 0
0:00:00.326086301 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "input-selector"
0:00:00.326615374 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:365:gst_element_factory_create: creating element "input-selector"
0:00:00.326824072 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "tee" named "audiotee"
0:00:00.327300330 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "bin" named "vbin"
0:00:00.327394534 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "queue" named "vqueue"
0:00:00.327767054 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "identity" named "identity"
0:00:00.328325726 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "videobalance" named "videobalance"
0:00:00.328823174 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "videoconvert" named "conv"
0:00:00.329472121 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "videoscale" named "scale"
0:00:00.333421949 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "videoconvert" named "conv"
0:00:00.333525223 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "videoscale" named "scale"
0:00:00.333652155 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "videoconvert" named "conv2"
0:00:00.337083286 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "bin" named "vdbin"
0:00:00.337134506 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "videoconvert" named "vdconv"
0:00:00.337624921 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "deinterlace" named "deinterlace"
0:00:00.338534390 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "bin" named "abin"
0:00:00.338604345 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "queue" named "aqueue"
0:00:00.338843967 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "identity" named "identity"
0:00:00.339202694 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "volume" named "volume"
0:00:00.339398663 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "audioconvert" named "conv"
0:00:00.340568986 21119      0x226d940 INFO     GST_ELEMENT_FACTORY gstelementfactory.c:363:gst_element_factory_create: creating element "audioresample" named "resample"

** (totem:21119): CRITICAL **: gst_vaapi_image_get_plane: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:21119): CRITICAL **: gst_vaapi_image_get_pitch: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:21119): CRITICAL **: gst_vaapi_image_get_plane: assertion '_gst_vaapi_image_is_mapped(image)' failed

** (totem:21119): CRITICAL **: gst_vaapi_image_get_pitch: assertion '_gst_vaapi_image_is_mapped(image)' failed
Segmentation fault




Comment 12


Jan Vesely





          2014-03-10 12:59:50 UTC
        

After the recent set of updates, I no longer see segfaults and videos play with little  cpu use, so I guess everything is working.

Feel free to close this bug




Comment 13


Pacho Ramos






          2014-03-10 21:05:36 UTC
        

Umm, interesting :O




Comment 14


Mehmet Giritli





          2014-04-02 20:23:40 UTC
        

I see this bug with totem 3.10 and gst-plugins-vaapi-0.5.8. I strongly believe that this is in fact https://bugzilla.gnome.org/show_bug.cgi?id=725058.

In my case the seg fault occurs precisely when subtitles are to be shown. So, if the video does not have subs it won't crash at all. Also, it wont crash until the moment subs in a movie are shown.

It'd be really helpful if Jan can actually verify this theory :-) and the bug should perhaps stay open as a tracker for the people who are facing this problem and seeking help here.




Comment 15


Jan Vesely





          2014-04-03 15:58:43 UTC
        

(In reply to Mehmet Giritli from comment #14)
> I see this bug with totem 3.10 and gst-plugins-vaapi-0.5.8. I strongly
> believe that this is in fact
> https://bugzilla.gnome.org/show_bug.cgi?id=725058.
> 
> In my case the seg fault occurs precisely when subtitles are to be shown.
> So, if the video does not have subs it won't crash at all. Also, it wont
> crash until the moment subs in a movie are shown.
> 
> It'd be really helpful if Jan can actually verify this theory :-) and the
> bug should perhaps stay open as a tracker for the people who are facing this
> problem and seeking help here.

The original crashes happened with or without subtitles, and got fixed by upgrading libva and/or libva-intel-driver. Totem would crash immediately without displaying a single frame.

However, I still see corruption (usually followed by totem hang) when using subtitles (I don't use them that often so I really don't care). I think gnome bug 725058 is still present and it is separate from this one.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

