Title: 159247 – package move over a installed package shows as an update in ~arch
URL: https://bugs.gentoo.org/show_bug.cgi?id=159247

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 159247
package move over a installed package shows as an update in ~arch
Last modified: 2006-12-27 16:12:56 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 159247 
      - package move over a installed package shows as an update in ~arch


Summary:
package move over a installed package shows as an update in ~arch
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-12-27 15:47 UTC by Petteri Räty (RETIRED)





      Modified:
    
2006-12-27 16:12 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Petteri Räty (RETIRED)






          2006-12-27 15:47:17 UTC
        

Putting this stuff to updates:
betelgeuse@pena /usr/portage/profiles/updates $ cvs diff
Index: 4Q-2006
===================================================================
RCS file: /var/cvsroot/gentoo-x86/profiles/updates/4Q-2006,v
retrieving revision 1.23
diff -u -r1.23 4Q-2006
--- 4Q-2006     20 Dec 2006 21:46:58 -0000      1.23
+++ 4Q-2006     27 Dec 2006 23:41:48 -0000
@@ -21,3 +21,5 @@
 move dev-java/jgoodies-looks-bin dev-java/jgoodies-looks
 slotmove dev-libs/g-wrap 1.3 0
 move dev-ruby/rubygfe games-util/rubygfe
+move dev-java/kunststoff-bin dev-java/kunststoff
+slotmove =dev-java/kunststoff-2.0.1* 0 2.0

The purpose is to move the -bin version to source and make it the same slot.
This results in the following:

pena tomcat # emerge -pv kunststoff

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild     U ] dev-java/kunststoff-2.0.2-r1 [2.0.1] USE="-doc% -source%" 0 kB

Total: 1 package (1 upgrade), Size of downloads: 0 kB
pena tomcat # emerge -Cpv kunststoff

>>> These are the packages that would be unmerged:

 dev-java/kunststoff
    selected: 2.0.1 2.0.2-r1
   protected: none
     omitted: none

>>> 'Selected' packages are slated for removal.
>>> 'Protected' and 'omitted' packages will not be removed.

pena tomcat # emerge --clean -pv

>>> These are the packages that would be unmerged:

 dev-java/kunststoff
    selected: 2.0.2-r1
   protected: 2.0.1
     omitted: none

>>> 'Selected' packages are slated for removal.
>>> 'Protected' and 'omitted' packages will not be removed.

Stable seems to work fine:
aria betelgeuse # emerge -pv kunststoff

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] dev-java/kunststoff-2.0.2  USE="-doc -jikes" 0 kB

Total size of downloads: 0 kB
aria betelgeuse # emerge -Cp kunststoff

>>> These are the packages that would be unmerged:

 dev-java/kunststoff
    selected: 2.0.1 2.0.2
   protected: none
     omitted: none

>>> 'Selected' packages are slated for removal.
>>> 'Protected' and 'omitted' packages will not be removed.

aria betelgeuse # emerge --clean -pv

>>> These are the packages that would be unmerged:

 dev-java/kunststoff
    selected: 2.0.2
   protected: 2.0.1
     omitted: none

>>> 'Selected' packages are slated for removal.
>>> 'Protected' and 'omitted' packages will not be removed.

The ~x86 machine:
pena tomcat # emerge --info
Portage 2.1.2_rc4-r1 (default-linux/x86/2006.1/desktop, gcc-4.1.1, glibc-2.5-r0, 2.6.19-ge61d5fd0-dirty i686)
=================================================================
System uname: 2.6.19-ge61d5fd0-dirty i686 Intel(R) Core(TM)2 CPU          6600  @ 2.40GHz
Gentoo Base System version 1.13.0_alpha10
Last Sync: Unknown
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
dev-java/java-config: 1.3.7, 2.0.31
dev-lang/python:     2.4.4, 2.5-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=nocona -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /opt/openjms/config /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O2 -march=nocona -pipe"
DISTDIR="/var/distfiles"
FEATURES="autoaddcvs autoconfig ccache collision-protect cvs distlocks fixpackages java-strict parallel-fetch sandbox sfperms sign strict stricter userpriv usersandbox verify-rdepend"
GENTOO_MIRRORS=" http://trumpetti.atm.tut.fi/gentoo  http://lame.lut.fi/linux/gentoo "
LANG="en_US.utf8"
LC_ALL="en_US.utf8"
LDFLAGS="-Wl,--as-needed"
LINGUAS="fi"
MAKEOPTS="-j2"
PKGDIR="/home/pkg/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/mnt/checkouts/overlays/betelgeuse"
SYNC="rsync://192.168.150.1:/portage"
USE="x86 aac acl acpi alsa alsa_cards_cs46xx alsa_cards_hda-intel alsa_pcm_plugins_adpcm alsa_pcm_plugins_alaw alsa_pcm_plugins_asym alsa_pcm_plugins_copy alsa_pcm_plugins_dmix alsa_pcm_plugins_dshare alsa_pcm_plugins_dsnoop alsa_pcm_plugins_empty alsa_pcm_plugins_extplug alsa_pcm_plugins_file alsa_pcm_plugins_hooks alsa_pcm_plugins_iec958 alsa_pcm_plugins_ioplug alsa_pcm_plugins_ladspa alsa_pcm_plugins_lfloat alsa_pcm_plugins_linear alsa_pcm_plugins_meter alsa_pcm_plugins_mulaw alsa_pcm_plugins_multi alsa_pcm_plugins_null alsa_pcm_plugins_plug alsa_pcm_plugins_rate alsa_pcm_plugins_route alsa_pcm_plugins_share alsa_pcm_plugins_shm alsa_pcm_plugins_softvol arts audiofile bash-completion berkdb bitmap-fonts bluetooth bzip2 cairo cdb cddb cdparanoia cdr cli cracklib crypt cups dbus dlloader dri dts dvd dvdr dvdread elibc_glibc emboss esd fam ffmpeg firefox gif gstreamer hal iconv input_devices_evdev input_devices_keyboard input_devices_mouse isdnlog java jpeg kde kdeenablefinal kdehiddenvisibility kernel_linux libg++ linguas_fi logitech-mouse mad mikmod mjpeg mmx mp3 mpeg ncurses network nptl nptlonly nsplugin nvidia offensive ogg opengl pam pcre png ppds pppd qt3 quicktime readline real reflection rtc samba session spell spl sse sse2 ssl subversion svg symlink theora threads truetype truetype-fonts type1-fonts udev unicode usb userland_GNU userlocales video_cards_none video_cards_nvidia vim-syntax vorbis xcb xcomposite xinerama xml xorg xv xvid xvmc zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Zac Medico






          2006-12-27 16:12:56 UTC
        

As I said on irc:

[15:55] <zmedico> Betelgeuse: so, the move put 2 packages in the same slot?
[15:56] <zmedico> I think the ~arch version is behaving correcly.
[15:57] <zmedico> if 2 packages are in the same slot, it ignores (and cleans) the one that was installed first
[16:00] <zmedico> Betelgeuse: apparently 2.0.1 was installed after 2.0.2-r1. Since they're both in the same slot, 2.0.2-r1 is effectively overwritten by 2.0.1.
[16:01] <zmedico> so it appears as an upgrade, since 2.0.2-r1 has been overwritten.
[16:02] <zmedico> it uses the COUNTER file to determine the order of installation.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

