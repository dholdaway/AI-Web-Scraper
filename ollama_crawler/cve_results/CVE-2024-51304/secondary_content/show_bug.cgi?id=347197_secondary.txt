Title: 347197 – app-text/texlive-2010: incorrect output format selected
URL: https://bugs.gentoo.org/show_bug.cgi?id=347197

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 347197
app-text/texlive-2010: incorrect output format selected
Last modified: 2011-06-30 15:14:09 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 347197 
      - app-text/texlive-2010: incorrect output format selected


Summary:
app-text/texlive-2010: incorrect output format selected
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

TeX project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




355085



 

        Show dependency tree





 





      Reported:
    
2010-11-29 16:36 UTC by Alexander Dubov





      Modified:
    
2011-06-30 15:14 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Tex config file

              (fmtutil.cnf,1.09 KB,
                text/plain)

            
2010-12-26 03:27 UTC,

            Alexander Dubov




Details





pdflatex output

              (t1.log,2.67 KB,
                text/plain)

            
2010-12-27 02:32 UTC,

            Alexander Dubov




Details





"fmtutil-sys --byfmt pdflatex" output

              (fmt.out,21.26 KB,
                text/plain)

            
2011-01-07 02:02 UTC,

            Alexander Dubov




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alexander Dubov





          2010-11-29 16:36:16 UTC
        

I have a system which used to have a perfectly working texlive-2008 installed.

Recently I upgraded it to texlive-2010, carefully purging all older texlive related packages (I actually tried several approaches and installation subsets). No errors were reported during installation.

Problem is, pdflatex, when invoked, won't produce pdf files, defaulting to dvi instead:

Case 1: pdflatex test.tex -> test.dvi (incorrectly, should be test.pdf; debug shows, however, that pdflatex.fmt is correctly selected and accessed).

Case 2: pdflatex --output-format pdf test.tex -> test.pdf (works correctly, however, command line switch should not be necessary).

Besides the inconvenience, this particular shortcoming breaks compilation of some packages which invoke pdflatex to produce documentation, as dvi is produced instead.

Any insights to the problem will be much appreciated.




Comment 1


Alexis Ballier






          2010-12-09 15:48:46 UTC
        

that's definitely not normal (and doesn't happen to me)

please attach your '/etc/texmf/web2c/fmtutil.cnf' file

also, please update the files in /etc with etc-update and run texmf-update just in case




Comment 2


Alexis Ballier






          2010-12-26 01:32:29 UTC
        

(In reply to comment #1)
> that's definitely not normal (and doesn't happen to me)
> 
> please attach your '/etc/texmf/web2c/fmtutil.cnf' file
> 
> also, please update the files in /etc with etc-update and run texmf-update just
> in case
> 

^^

please reopen with this information




Comment 3


Alexander Dubov





          2010-12-26 03:27:56 UTC
        

Created attachment 258077 [details]
Tex config file

I'm sorry for the delay, busy month.
I still got this problem on multiple machines.




Comment 4


Alexander Dubov





          2010-12-26 03:28:47 UTC
        

Required config file now attached.




Comment 5


Alexis Ballier






          2010-12-26 14:21:19 UTC
        

ok, so let's try to investigate in more details:

alexis@portable ~ $ kpsewhich 'pdflatex.ini'
/usr/share/texmf-dist/tex/latex/latexconfig/pdflatex.ini
alexis@portable ~ $ cat $(kpsewhich 'pdflatex.ini')
% Thomas Esser, 1998. public domain.
\input pdftexconfig.tex
\scrollmode
\input latex.ltx
\endinput
alexis@portable ~ $ 

do you get the same ?

alexis@portable ~ $ kpsewhich 'pdftexconfig.tex'
/usr/share/texmf/tex/generic/config/pdftexconfig.tex
alexis@portable ~ $ cat $(kpsewhich 'pdftexconfig.tex')
% Set pdfTeX parameters for pdf mode (replacing pdftex.cfg file).
% Thomas Esser, 2004. public domain.
\pdfoutput=1
\pdfcompresslevel=9
\pdfdecimaldigits=3
\pdfpagewidth=210 true mm
\pdfpageheight=297 true mm
\pdfhorigin=1 true in
\pdfvorigin=1 true in
\pdfpkresolution=600
% 
% As of TeX Live 2010, we output PDF 1.5 by default, so we can enable
% more compression.  To change this for the installation, comment out or
% delete these lines and remake the formats.  To change it for a
% particular LaTeX document, \RequirePackage{pdf14} early.
% 
\pdfminorversion=5
\pdfobjcompresslevel=2
\endinput

and here too ?

\pdfoutput=1 should set the output to... heh... pdf :)




Comment 6


Alexis Ballier






          2010-12-26 14:22:17 UTC
        

ah and also, please attach a document that is compiled into dvi with pdf(la)tex and the .log file associated, to see if something's wrong here




Comment 7


Alexander Dubov





          2010-12-27 02:26:08 UTC
        

(In reply to comment #5)
> ok, so let's try to investigate in more details:
> 
> alexis@portable ~ $ kpsewhich 'pdflatex.ini'
> /usr/share/texmf-dist/tex/latex/latexconfig/pdflatex.ini

Yes.

> alexis@portable ~ $ cat $(kpsewhich 'pdflatex.ini')
> % Thomas Esser, 1998. public domain.
> \input pdftexconfig.tex
> \scrollmode
> \input latex.ltx
> \endinput
> alexis@portable ~ $ 
> 
> do you get the same ?

Exactly the same.

> 
> alexis@portable ~ $ kpsewhich 'pdftexconfig.tex'
> /usr/share/texmf/tex/generic/config/pdftexconfig.tex

Yes.

> alexis@portable ~ $ cat $(kpsewhich 'pdftexconfig.tex')
> % Set pdfTeX parameters for pdf mode (replacing pdftex.cfg file).
> % Thomas Esser, 2004. public domain.
> \pdfoutput=1
> \pdfcompresslevel=9
> \pdfdecimaldigits=3
> \pdfpagewidth=210 true mm
> \pdfpageheight=297 true mm
> \pdfhorigin=1 true in
> \pdfvorigin=1 true in
> \pdfpkresolution=600
> % 
> % As of TeX Live 2010, we output PDF 1.5 by default, so we can enable
> % more compression.  To change this for the installation, comment out or
> % delete these lines and remake the formats.  To change it for a
> % particular LaTeX document, \RequirePackage{pdf14} early.
> % 
> \pdfminorversion=5
> \pdfobjcompresslevel=2
> \endinput
> 
> and here too ?

All the same.

> 
> \pdfoutput=1 should set the output to... heh... pdf :)
> 

It is set.






Comment 8


Alexander Dubov





          2010-12-27 02:32:14 UTC
        

Created attachment 258149 [details]
pdflatex output

Output for basic latex file:
---
\documentclass[12pt, a4]{article}

\begin{document}
bla-bla-bla-bla
\end{document}
---

/usr/bin/pdflatex links to /usr/bin/pdftex, which in turn links to /usr/bin/pdftex-texlive-core-2010




Comment 9


Alexis Ballier






          2011-01-06 18:30:45 UTC
        

(In reply to comment #8)
> Created an attachment (id=258149) [details]
> pdflatex output
> 
> Output for basic latex file:
> ---
> \documentclass[12pt, a4]{article}
> 
> \begin{document}
> bla-bla-bla-bla
> \end{document}
> ---

this is _really_ weird. Do you get the same if you add '\pdfoutput=1' at the beginning of your tex document?








Comment 10


Alexis Ballier






          2011-01-06 18:40:59 UTC
        

please attach the output of the command 'fmtutil-sys --byfmt pdflatex' (as root) also




Comment 11


Alexander Dubov





          2011-01-07 01:58:51 UTC
        

> this is _really_ weird. Do you get the same if you add '\pdfoutput=1' at the
> beginning of your tex document?
> 

Then it works correctly.
Command line format selector also works correctly, as described in the original report.





Comment 12


Alexander Dubov





          2011-01-07 02:02:15 UTC
        

Created attachment 259113 [details]
"fmtutil-sys --byfmt pdflatex" output




Comment 13


Alexis Ballier






          2011-01-11 13:08:07 UTC
        

again, everything seems sane, please attach the ouput of 'texconfig conf'




Comment 14


Alexander Dubov





          2011-01-13 02:52:23 UTC
        

(In reply to comment #13)
> again, everything seems sane, please attach the ouput of 'texconfig conf'
> 

If this is of any help, I shall mention that xetex worked correctly all the time. The problem somehow affects only pdftex.

Is it possible that the problem occurs in the pdftex binary, as a result of "configure" picking up some wrong defines?

The output of texconfig:

=========================== version information ==========================

==================== binaries found by searching $PATH ===================
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/x86_64-pc-linux-gnu/gcc-bin/4.5.1:/usr/lib64/subversion/bin:/home/netroot/amd64/powerpc-gnuspe/bin                                                              
kpsewhich: /usr/bin/kpsewhich                                                   
updmap: /usr/bin/updmap                                                         
fmtutil: /usr/bin/fmtutil                                                       
texconfig: /usr/bin/texconfig                                                   
tex: /usr/bin/tex                                                               
pdftex: /usr/bin/pdftex                                                         
mktexpk: /usr/bin/mktexpk                                                       
dvips: /usr/bin/dvips                                                           
dvipdfm: /usr/bin/dvipdfm 
=========================== active config files ==========================
//etc/texmf/dvips/config/config.ps                                        
//etc/texmf/web2c/fmtutil.cnf                                             
//etc/texmf/web2c/updmap.cfg                                              
/usr/share/texmf/dvipdfm/config/config                                    
/usr/share/texmf/tex/generic/config/pdftexconfig.tex                      
/usr/share/texmf/web2c/mktex.cnf                                          
/usr/share/texmf/web2c/texmf.cnf                                          
/usr/share/texmf/xdvi/XDvi                                                

============================= font map files =============================
psfonts.map: //var/lib/texmf/fonts/map/dvips/updmap/psfonts.map           
pdftex.map: //var/lib/texmf/fonts/map/pdftex/updmap/pdftex.map            
ps2pk.map: //var/lib/texmf/fonts/map/dvips/updmap/ps2pk.map               
dvipdfm.map: //var/lib/texmf/fonts/map/dvipdfm/updmap/dvipdfm.map         

=========================== kpathsea variables ===========================
TEXMFMAIN=/usr/share/texmf                                                
TEXMFDIST=/usr/share/texmf-dist                                           
TEXMFLOCAL=/usr/local/share/texmf                                         
TEXMFSYSVAR=//var/lib/texmf                                               
TEXMFSYSCONFIG=//etc/texmf                                                
TEXMFVAR=/root/.texlive2010/texmf-var                                     
TEXMFCONFIG=/root/.texlive2010/texmf-config                               
TEXMFHOME=/root/texmf                                                     
VARTEXFONTS=//var/cache/fonts                                             
TEXMF={/root/.texlive2010/texmf-config,/root/.texlive2010/texmf-var,/root/texmf,!!//etc/texmf,!!//var/lib/texmf,!!/usr/share/texmf,!!/usr/local/share/texmf,!!/usr/share/texmf-site,!!/usr/share/texmf-dist}                                    
SYSTEXMF=//var/lib/texmf:/usr/share/texmf:/usr/local/share/texmf:/usr/share/texmf-site:/usr/share/texmf-dist
TEXMFDBS={!!//etc/texmf,!!//var/lib/texmf,!!/usr/share/texmf,!!/usr/local/share/texmf,!!/usr/share/texmf-site,!!/usr/share/texmf-dist}
WEB2C={/root/.texlive2010/texmf-config,/root/.texlive2010/texmf-var,/root/texmf,!!//etc/texmf,!!//var/lib/texmf,!!/usr/share/texmf,!!/usr/local/share/texmf,!!/usr/share/texmf-site,!!/usr/share/texmf-dist}/web2c
TEXPSHEADERS=.:{/root/.texlive2010/texmf-config,/root/.texlive2010/texmf-var,/root/texmf,!!//etc/texmf,!!//var/lib/texmf,!!/usr/share/texmf,!!/usr/local/share/texmf,!!/usr/share/texmf-site,!!/usr/share/texmf-dist}/{dvips,fonts/{enc,type1,type42,type3}}//
TEXCONFIG={/root/.texlive2010/texmf-config,/root/.texlive2010/texmf-var,/root/texmf,!!//etc/texmf,!!//var/lib/texmf,!!/usr/share/texmf,!!/usr/local/share/texmf,!!/usr/share/texmf-site,!!/usr/share/texmf-dist}/dvips//
ENCFONTS=.:{/root/.texlive2010/texmf-config,/root/.texlive2010/texmf-var,/root/texmf,!!//etc/texmf,!!//var/lib/texmf,!!/usr/share/texmf,!!/usr/local/share/texmf,!!/usr/share/texmf-site,!!/usr/share/texmf-dist}/fonts/enc//
TEXFONTMAPS=.:{/root/.texlive2010/texmf-config,/root/.texlive2010/texmf-var,/root/texmf,!!//etc/texmf,!!//var/lib/texmf,!!/usr/share/texmf,!!/usr/local/share/texmf,!!/usr/share/texmf-site,!!/usr/share/texmf-dist}/fonts/map/{kpsewhich,pdftex,dvips,}//

==== kpathsea variables from environment only (ok if no output here) ====
TEXINPUTS=/usr/lib64/ocaml/ocamldoc:





Comment 15


Alexis Ballier






          2011-01-29 19:29:30 UTC
        

seems sane again, could you try as different users ?

and give me the output of the 'env' command with a failing user.




Comment 16


Alexander Dubov





          2011-01-31 02:59:56 UTC
        

(In reply to comment #15)
> seems sane again, could you try as different users ?
> 

I tried some, it does not seem to affect anything (all users got the same problem).

> and give me the output of the 'env' command with a failing user.
> 

MANPATH=/etc/java-config-2/current-system-vm/man:/usr/local/share/man:/usr/share/man:/usr/share/binutils-data/x86_64-pc-linux-gnu/2.21.51.0.1/man:/usr/share/gcc-data/x86_64-pc-linux-gnu/4.5.1/man:/etc/java-config/system-vm/man/:/usr/lib64/php5/man/:/usr/share/postgresql-9.0/man                                          
TERM=xterm                                                                      
SHELL=/bin/bash                                                                 
XDG_SESSION_COOKIE=94740ec8bda02e67b3b2bd2248a5564d-1296442478.975785-947379441 
SSH_CLIENT=192.168.1.7 43540 22                                                 
GNOME_KEYRING_CONTROL=/tmp/keyring-TQUVSb                                       
SSH_TTY=/dev/pts/15                                                             
LC_ALL=en_US.utf8                                                               
ANT_HOME=/usr/share/ant                                                         
SBCL_HOME=/usr/lib64/sbcl                                                       
SGML_CATALOG_FILES=/etc/sgml/sgml-ent.cat:/etc/sgml/sgml-docbook.cat:/etc/sgml/xml-docbook-4.1.2.cat:/etc/sgml/xml-docbook-4.2.cat:/etc/sgml/sgml-docbook-3.0.cat:/etc/sgml/dsssl-docbook-stylesheets.cat:/etc/sgml/openjade-1.3.2.cat:/etc/sgml/sgml-docbook-4.1.cat:/etc/sgml/sgml-docbook-4.0.cat:/etc/sgml/sgml-docbook-3.1.cat:/etc/sgml/xml-simple-docbook-4.1.2.4.cat:/etc/sgml/xml-simple-docbook-1.0.cat:/etc/sgml/sgml-docbook-4.2.cat:/etc/sgml/xml-docbook-4.4.cat:/etc/sgml/sgml-lite.cat:/etc/sgml/xml-docbook-4.3.cat:/etc/sgml/xml-docbook-4.5.cat              
USER=oak                                                                        
LS_COLORS=no=00:fi=00:di=01;34:ln=01;36:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=01;05;37;41:mi=01;05;37;41:su=37;41:sg=30;43:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.svgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.lzma=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.bz2=01;31:*.bz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.rar=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.pdf=00;32:*.ps=00;32:*.txt=00;32:*.patch=00;32:*.diff=00;32:*.log=00;32:*.tex=00;32:*.doc=00;32:*.aac=00;36:*.au=00;36:*.flac=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:                    
PRELINK_PATH_MASK=/usr/lib64/libfreebl3.so:/usr/lib64/libnssdbm3.so:/usr/lib64/libsoftokn3.so                                                                   
LIBGL_DRIVERS_PATH=/usr/lib64/dri:/usr/lib32/dri                                
GUILE_LOAD_PATH=/usr/share/guile/1.8                                            
GDK_USE_XFT=1                                                                   
PAGER=/usr/bin/less                                                             
CONFIG_PROTECT_MASK=/etc/gentoo-release /etc/sandbox.d /etc/env.d/java/ /etc/php/cli-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/apache2-php5/ext-active/ /etc/fonts/fonts.conf /etc/gconf /etc/terminfo /etc/eselect/postgresql /etc/texmf/web2c /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/revdep-rebuild                                                       
XDG_CONFIG_DIRS=/etc/xdg                                                        
FLTK_DOCDIR=/usr/share/doc/fltk-1.1.10-r1/html                                  
SBCL_SOURCE_ROOT=/usr/lib64/sbcl/src                                            
MAIL=/var/mail/oak                                                              
PATH=/usr/local/bin:/usr/bin:/bin:/opt/bin:/usr/x86_64-pc-linux-gnu/gcc-bin/4.5.1:/usr/lib64/subversion/bin:/usr/games/bin                                      
HG=/usr/bin/hg                                                                  
DISTCC_LOG=                                                                     
PWD=/home/oak                                                     
JAVA_HOME=/etc/java-config-2/current-system-vm                                  
LIBXCB_ALLOW_SLOPPY_LOCK=1                                                      
JAVAC=/etc/java-config-2/current-system-vm/bin/javac                            
EDITOR=/bin/nano                                                                
LANG=en_US.utf8                                                                 
GNOME_KEYRING_PID=31576                                                         
PYTHONDOCS_3_1=/usr/share/doc/python-docs-3.1.1/html/library                    
PBS_SERVER_HOME=/var/spool/torque                                               
DISTCC_VERBOSE=0                                                                
DCCC_PATH=/usr/lib/distcc/bin                                                   
KRB5CCNAME=FILE:/tmp/krb5cc_10025                                               
TEXINPUTS=/usr/lib64/ocaml/ocamldoc:                                            
DISTCCD_PATH=/bin:/usr/bin:/usr/local/powerpc-gnuspe/bin                        
CCL_DEFAULT_DIRECTORY=/usr/lib64/clozurecl                                      
JDK_HOME=/etc/java-config-2/current-system-vm                                   
SHLVL=1
HOME=/home/oak
LANGUAGE=en_US.utf8
JAVACC_HOME=/usr/share/javacc/
LESS=-R -M --shift 5
LOGNAME=oak
GCC_SPECS=
CVS_RSH=ssh
XDG_DATA_DIRS=/usr/local/share:/usr/share:/usr/share/gdm
SSH_CONNECTION=192.168.1.7 43540 192.168.1.14 22
LESSOPEN=|lesspipe.sh %s
R_HOME=/usr/lib64/R
INFOPATH=/usr/share/info:/usr/share/binutils-data/x86_64-pc-linux-gnu/2.21.51.0.1/info:/usr/share/gcc-data/x86_64-pc-linux-gnu/4.5.1/info:/usr/share/info/emacs-23
DISPLAY=localhost:14.0
USB_DEVFS_PATH=/dev/bus/usb
RUBYOPT=-rauto_gem
OPENGL_PROFILE=xorg-x11
LADSPA_PATH=/usr/lib64/ladspa
SANE_CONFIG_DIR=/etc/sane.d
CONFIG_PROTECT=/opt/openjms/config /usr/share/X11/xkb /var/spool/torque /usr/share/config /usr/share/openvpn/easy-rsa
_=/usr/bin/env





Comment 17


Alexis Ballier






          2011-06-30 15:14:09 UTC
        

really, really, really, i dont understand what the problem may be... and you seem to be the only one to have it which doesnt make it easy to understand :(

could you please try with texlive-core-2010-r2 ? there's no change related to this but who knows...

also please try with dev-tex/pdftex, eselect it via 'eselect pdftex set 1'
if it fails, please attach the build log of pdftex (which should be easier to read than texlive's one)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

