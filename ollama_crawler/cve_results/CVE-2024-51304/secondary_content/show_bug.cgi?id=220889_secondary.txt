Title: 220889 – ruby-glib2-0.16.0-r2 does not build with -pthread
URL: https://bugs.gentoo.org/show_bug.cgi?id=220889

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 220889
ruby-glib2-0.16.0-r2 does not build with -pthread
Last modified: 2008-05-08 10:45:04 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 220889 
      - ruby-glib2-0.16.0-r2 does not build with -pthread


Summary:
ruby-glib2-0.16.0-r2 does not build with -pthread
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-05-08 10:23 UTC by Balint Dobai-Pataky





      Modified:
    
2008-05-08 10:45 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Balint Dobai-Pataky





          2008-05-08 10:23:36 UTC
        

i had dev-lang/ruby-1.8.6_p114 with "threads" (pthread support) enabled, and ruby-glib2 built upon it fine.

now that i removed the thread "threads" flag for ruby, emerging ruby-glib2-0.16.0-r2 fails with:

creating Makefile
make[1]: Entering directory `/dev/shm/portage/dev-ruby/ruby-glib2-0.16.0-r2/work/ruby-gnome2-all-0.16.0/glib/src'
make[1]: warning: jobserver unavailable: using -j1.  Add `+' to parent make rule.
gcc -I. -I. -I/usr/lib/ruby/1.8/i686-linux -I. -DHAVE_RB_DEFINE_ALLOC_FUNC -DHAVE_RB_BLOCK_PROC -DHAVE_OBJECT_ALLOCATE -DHAVE_NODE_ATTRASGN -DHAVE_G_THREAD_INIT -DHAVE_G_MAIN_DEPTH -DHAVE_G_LISTENV -DHAVE_RB_CHECK_ARRAY_TYPE -DRUBY_GLIB2_COMPILATION  -I/usr/lib/ruby/site_ruby/1.8/i686-linux  -fPIC -march=pentium4 -O2 -pipe -fno-strict-aliasing  -fPIC -Wall -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include   -pthread -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include    -c glib-enum-types.c
glib-enum-types.c: In function 'g_markup_collect_type_get_type':
glib-enum-types.c:250: error: expected expression before ',' token
glib-enum-types.c:251: error: extra brace group at end of initializer
glib-enum-types.c:251: error: (near initialization for 'values[0]')
glib-enum-types.c:251: error: expected expression before ',' token
glib-enum-types.c:252: error: extra brace group at end of initializer
glib-enum-types.c:252: error: (near initialization for 'values[0]')
glib-enum-types.c:252: error: expected expression before ',' token
glib-enum-types.c:253: error: extra brace group at end of initializer
glib-enum-types.c:253: error: (near initialization for 'values[0]')
glib-enum-types.c:254: error: extra brace group at end of initializer
glib-enum-types.c:254: error: (near initialization for 'values[0]')
make[1]: *** [glib-enum-types.o] Error 1
make[1]: Leaving directory `/dev/shm/portage/dev-ruby/ruby-glib2-0.16.0-r2/work/ruby-gnome2-all-0.16.0/glib/src'
make: *** [all] Error 2
 * 
 * ERROR: dev-ruby/ruby-glib2-0.16.0-r2 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 2256:  Called ruby-gnome2_src_compile
 *             environment, line 2101:  Called die
 * The specific snippet of code:
 *       emake CC=${CC:-gcc} CXX=${CXX:-g++} || die "emake failed"
 *  The die message:
 *   emake failed
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/var/log/portage/dev-ruby:ruby-glib2-0.16.0-r2:20080508-090313.log'.
 * The ebuild environment file is located at '/dev/shm/portage/dev-ruby/ruby-glib2-0.16.0-r2/temp/environment'.


Reproducible: Always




Comment 1


Balint Dobai-Pataky





          2008-05-08 10:24:10 UTC
        

Portage 2.1.4.4 (default-linux/x86/2007.0, gcc-4.1.2, glibc-2.6.1-r0, 2.6.23-gentoo-r9 i686)
=================================================================
System uname: 2.6.23-gentoo-r9 i686 Intel(R) Xeon(TM) MP CPU 2.50GHz
Timestamp of tree: Tue, 06 May 2008 06:06:01 +0000
app-shells/bash:     3.2_p17-r1
dev-lang/python:     2.4.4-r9
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.1
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium4 -O2 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-march=pentium4 -O2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer parallel-fetch sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LINGUAS="en hu ro"
MAKEOPTS="-j9"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/dev/shm"
PORTDIR="/usr/portage"
SYNC="rsync://isis/gentoo-portage"
USE="3dnow 3dnowext X aac acpi alsa apm avi bash-completion berkdb branding browserplugin bzip2 cairo cdparanoia cdr css cups cursors dbus dga dmi dvd dvdr encode erandom evolution exif fbsplash firefox flac foomaticdb fpu gdm gif gimp gimpprint glitz gnome gnutls gstreamer gtk gtk2 hal howl icons imagemagick jabber jbig jpeg kqemu libnotify live maildir mbox mime mmx mmxext mozdevelop mozilla mozmail moznocompose moznoirc moznoroaming mozsvg mp3 mp4 mpeg mplayer mtrr mysql nautilus ncurses nls nptl nptlonly ogg oss pam pcre pdf pdflib perl perlsuid png ppds python quicktime readline remote rtc samba scanner screen sdl session slang softmmu sox spell sse ssl startup-notification subtitles svg svga tcpd threads tiff tracker truetype udev unicode usb userlocales utf8 vcd vorbis win32codecs wma x264 x86 xine xml xorg xprint xscreensaver xv xvid xvmc zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 	emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m 	maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw copy dshare dsnoop extplug file hooks ladspa lfloat linear meter mulaw multi null rate route share shm" APACHE2_MODULES="access auth auth_dbm auth_anon auth_digest alias file-cache echo charset-lite cache disk-cache mem-cache ext-filter case_filter case-filter-in deflate mime-magic cern-meta expires headers usertrack unique-id proxy proxy-connect proxy-ftp proxy-http info include cgi cgid dav dav-fs vhost-alias speling rewrite log_config logio env setenvif mime status autoindex asis negotiation dir imap actions userdir so filter unique_id authz_host" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en hu ro" USERLAND="GNU" VIDEO_CARDS="ati nv vesa"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY





Comment 2


Balint Dobai-Pataky





          2008-05-08 10:40:03 UTC
        

sorry, this is not "threads" related.
couldn't find what it is, yet.




Comment 3


Balint Dobai-Pataky





          2008-05-08 10:45:04 UTC
        

dev-ruby/ruby-glib2-0.16.0-r3 builds fine, sorry for the traffic









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

