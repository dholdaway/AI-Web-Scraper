Title: 297483 – >=dev-libs/glib-2.22.3:dbus-glib needs to be updated on some systems after glib update
URL: https://bugs.gentoo.org/show_bug.cgi?id=297483

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 297483
>=dev-libs/glib-2.22.3:dbus-glib needs to be updated on some systems after glib update
Last modified: 2011-04-09 10:54:23 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 297483 
      - >=dev-libs/glib-2.22.3:dbus-glib needs to be updated on some systems after glib update


Summary:
>=dev-libs/glib-2.22.3:dbus-glib needs to be updated on some systems after gl...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:









Duplicates (5):
    

301118 302044 308541 332367 336138

      (view as bug list)
    


Depends on:







Blocks:




gnome2.28



 

        Show dependency tree





 





      Reported:
    
2009-12-19 04:19 UTC by Willard Dawson





      Modified:
    
2011-04-09 10:54 UTC
      (History)
    




          CC List:
        

10 
          users
          
            (show)
          



chaujc
galtgendo
gentoo
ghepeu
help
kanelxake
moiman
rose
tl
zeekec









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Text file containing output from emerge --info && FEATURES="test stricter" emerge -1 glib

              (do-merge-test.1,646.96 KB,
                text/plain)

            
2009-12-22 20:15 UTC,

            Willard Dawson




Details





Build log

              (build.log,634.14 KB,
                text/plain)

            
2009-12-23 20:57 UTC,

            Willard Dawson




Details





2.22.4-build.log

              (build.log,433.13 KB,
                text/plain)

            
2010-01-24 10:20 UTC,

            Pacho Ramos




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Willard Dawson





          2009-12-19 04:19:39 UTC
        

Earlier today, after a system reboot, KDM console logon broke - after each successful login, the login screen was presented again.  This happens on each login attempt.

/var/log/messages shows:

Dec 18 20:29:20 wdawsonlt kdm: :0[17551]: Cannot open ConsoleKit session: Unable to open session: Launch helper exited with unknown return code 0               
Dec 18 20:29:20 wdawsonlt kdm: :0[17551]: Cannot close ConsoleKit session: Unable to close session: no session open                                             

wdawsonlt ~ # /etc/init.d/consolekit status
* status: crashed

I tried downgrading consolekit to sys-auth/consolekit-0.3.0-r2 but that did not affect the situation.

I read the thread at http://forums.gentoo.org/viewtopic-t-786654.html, but following the recommendations there was not helpful.

I changed to -consolekit and re-emerge kdm, etc., and of course I can access my KDE environment, but this seems like an sad "solution" to this problem.

How to debug it?


Reproducible: Always




# emerge --info
Portage 2.1.7.15 (default/linux/x86/10.0, gcc-4.3.4, glibc-2.11-r1, 2.6.30-gentoo-r6 i686)                                                                      
=================================================================               
System uname: Linux-2.6.30-gentoo-r6-i686-Intel-R-_Pentium-R-_M_processor_2.00GHz-with-gentoo-2.0.1                                                             
Timestamp of tree: Fri, 18 Dec 2009 21:00:01 +0000                              
app-shells/bash:     4.0_p35                                                    
dev-java/java-config: 2.1.10                                                    
dev-lang/python:     2.5.4-r3, 2.6.4, 3.1.1-r1                                  
dev-python/pycrypto: 2.1.0                                                      
dev-util/cmake:      2.8.0                                                      
sys-apps/baselayout: 2.0.1                                                      
sys-apps/openrc:     0.5.3                                                      
sys-apps/sandbox:    2.2                                                        
sys-devel/autoconf:  2.13, 2.64                                                 
sys-devel/automake:  1.5-r1, 1.7.9-r2, 1.8.5-r4, 1.9.6-r3, 1.10.3, 1.11.1       
sys-devel/binutils:  2.20                                                       
sys-devel/gcc-config: 1.4.1                                                     
sys-devel/libtool:   2.2.6b                                                     
virtual/os-headers:  2.6.30-r1                                                  
ACCEPT_KEYWORDS="x86 ~x86"                                                      
ACCEPT_LICENSE="* -@EULA PUEL dlj-1.1 Nessus-EULA sun-bcla-java-vm"             
CBUILD="i686-pc-linux-gnu"                                                      
CFLAGS="-march=i686 -O2 -pipe -ggdb"                                            
CHOST="i686-pc-linux-gnu"                                                       
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config"                      
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"                                                 
CXXFLAGS="-march=i686 -O2 -pipe -ggdb"                                          
DISTDIR="/usr/portage/distfiles"                                                
FEATURES="assume-digests distlocks fixpackages news parallel-fetch protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"                 
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"                                                           
LDFLAGS="-Wl,-O1"                                                               
MAKEOPTS=""                                                                     
PKGDIR="/usr/portage/packages"                                                  
PORTAGE_CONFIGROOT="/"                                                          
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"                                                  
PORTAGE_TMPDIR="/var/tmp"                                                       
PORTDIR="/usr/portage"                                                          
PORTDIR_OVERLAY="/usr/local/portage"                                            
SYNC="rsync://rsync.gentoo.org/gentoo-portage"                                  
USE="3dnow 3dnowext X a52 aac acl acpi aiglx alsa apache2 apm ati audiofile avahi avi bash-completion berkdb bitmap-fonts bzip2 cairo caps cardbus cdio cdr cli consolekit cracklib crypt ctype cups cxx dba dbtool dbus digitalradio diskio djvu dri dts dvdread eds emboss encode esd ethereal exif expat fastbuild ffmpeg fftw fglrx foomaticdb force-cgi-redirect fortran ftp fuse gamin gd gdbm gif glib glitz glut gmp gpm gstreamer gtk gtk2 gtkhtml guile hal iconv idn imlib ipv6 ithreads jack java jpeg kde kerberos kqemu lcms ldap libclamav libg++ libwww lirc live lm_sensors lua mad madwifi matroska mdnsresponder-compat memlimit mhash mikmod mmx mmxext mng modules mono motif mozilla mp3 mpeg mudflap mysql ncurses netboot netjack networking nforce2 nls nptl nptlonly nsplugin nvidia ocaml ogg oggvorbis opengl openmp oss pam pango pch pcmcia pcre pdf pdflib pear perl php pmu png policykit portaudio posix pppd pulseaudio python qt qt3support qtmt quicktime readline reflection ruby samba sasl sdl session simplexml slang sndfile snmp soap sockets spell spl sql sqlite sse sse2 ssl svg sysfs tcl tcltk tcpd theora threads threadsafe tiff tk tokenizer truetype truetype-fonts type1-fonts udev unicode utempter vorbis webkit wifi win32codecs x86 xanim xinerama xml xmlrpc xorg xscreensaver xsl xulrunner xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" FOO2ZJS_DEVICES="hp2600n" INPUT_DEVICES="evdev keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="radeon"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

Installed versions (after recompiling with -consolekit)---

kde-base/kdm-4.3.4 (handbook kerberos pam -aqua -consolekit -debug -kdeenablefinal -kdeprefix)
sys-apps/hal-0.5.14 (X acpi apm crypt dell kernel_linux laptop -consolekit -debug -disk-partition -doc -kernel_FreeBSD -policykit -selinux)
sys-auth/consolekit-0.4.1 (pam -debug -doc -policykit)
sys-auth/pambase (cracklib sha512 -consolekit -debug -gnome-keyring -mktemp -passwdqc -selinux -ssh)




Comment 1


Rafał Mużyło





          2009-12-19 08:20:32 UTC
        

What errors get into the log when you try to start
consolekit with the initscript ?




Comment 2


Willard Dawson





          2009-12-19 12:05:51 UTC
        

(In reply to comment #1)
> What errors get into the log when you try to start
> consolekit with the initscript ?
> 

Neither /etc/init.d/stop nor start cause anything to log in /var/log/messages (I'm using app-admin/syslog-ng, if that matters).  




Comment 3


Rafał Mużyło





          2009-12-19 13:20:34 UTC
        

Well, if it started, there may be something under /var/log/ConsoleKit.
(just a note - downgrading consolekit may have broken things more).
How do you start KDE (making sure it's not a dupe of xinit problem) ?




Comment 4


Willard Dawson





          2009-12-19 14:44:17 UTC
        

(In reply to comment #3)
> Well, if it started, there may be something under /var/log/ConsoleKit.
> (just a note - downgrading consolekit may have broken things more).
> How do you start KDE (making sure it's not a dupe of xinit problem) ?
> 

Consolekit does not start, or does not stay up.  There are no errors logged to /var/log/messages.  console-kit-daemon is not running.

There are messages logged to /var/log/ConsoleKit/history. Not sure if posting those here will help... if so I'll put it as an attachment.

KDE is started by /etc/init.d/xdm. Here are my /etc/conf.d/xdm file contents:

CHECKVT=7
DISPLAYMANAGER="kdm"
NEEDS_HALD="auto"





Comment 5


Christian Hesse





          2009-12-19 21:56:40 UTC
        

Same problem here.
For me it looks like it is related to dbus:

22:50:27 root@io:~# /usr/sbin/console-kit-daemon --no-daemon
process 6741: arguments to dbus_connection_ref() were incorrect, assertion "connection != NULL" failed in file /tmp/portage/sys-apps/dbus-1.3.0-r1/work/dbus-1.3.0/dbus/dbus-connection.c line 2557.
This is normally a bug in some application using the D-Bus library.
  D-Bus not built with -rdynamic so unable to print a backtrace
Aborted




Comment 6


Christian Hesse





          2009-12-19 22:25:14 UTC
        

Reemerging dev-libs/dbus-glib worked for me. Everything is fine again.




Comment 7


Neil Bothwick





          2009-12-20 00:33:09 UTC
        

(In reply to comment #6)
> Reemerging dev-libs/dbus-glib worked for me. Everything is fine again.
> 

Same here. I had recently update glib from 2.22.2 to 2.22.3, could this be why the DBus bindings need to be rebuilt. What about other glib bindings?




Comment 8


Willard Dawson





          2009-12-21 17:36:25 UTC
        

(In reply to comment #6)
> Reemerging dev-libs/dbus-glib worked for me. Everything is fine again.
> 

Nice.  That worked for me, too.  Thanks!




Comment 9


Willard Dawson





          2009-12-21 17:39:03 UTC
        

(In reply to comment #7)
> (In reply to comment #6)
> > Reemerging dev-libs/dbus-glib worked for me. Everything is fine again.
> > 
> 
> Same here. I had recently update glib from 2.22.2 to 2.22.3, could this be why
> the DBus bindings need to be rebuilt. What about other glib bindings?
> 

That would be nice to have. Other issues I'm experiencing are probably a result of this same issue.  Is there a list of glib bindings that need to be rebuilt, or a way to discover it?





Comment 10


Christian Hesse





          2009-12-21 17:50:15 UTC
        

(In reply to comment #9)
> (In reply to comment #7)
> > Same here. I had recently update glib from 2.22.2 to 2.22.3, could this be why
> > the DBus bindings need to be rebuilt. What about other glib bindings?
> > 
> 
> That would be nice to have. Other issues I'm experiencing are probably a result
> of this same issue.  Is there a list of glib bindings that need to be rebuilt,
> or a way to discover it?

This could give an idea about what needs rebuilding:
$ qlist -I glib

No idea whether or not there is a better way.




Comment 11


Gilles Dartiguelongue (RETIRED)






          2009-12-21 19:39:38 UTC
        

changing summary to reflect the problem. It looks like a couple of people are hitting this with x86 and ppc. amd64 users seem unaffected.

Could you guys run:
$ FEATURES="test stricter" emerge -1 glib

and tell us if any test fails ?




Comment 12


Willard Dawson





          2009-12-22 14:02:47 UTC
        

(In reply to comment #11)
> changing summary to reflect the problem. It looks like a couple of people are
> hitting this with x86 and ppc. amd64 users seem unaffected.
> 
> Could you guys run:
> $ FEATURES="test stricter" emerge -1 glib
> 
> and tell us if any test fails ?
> 

This seems odd, but at the end reports PASS...

make[6]: Entering directory `/var/tmp/portage/dev-libs/glib-2.22.3/work/glib-2.22.3/glib/tests'
TEST: testing... (pid=7680)
  /random-generator/rand-1:                                            OK
  /random-generator/rand-2:                                            OK
  /random-generator/random-conversions:                                OK
  /misc/assertions:                                                    OK
  /misc/test-data:                                                     OK
  /misc/primetoul:                                                     OK
  /forking/fail assertion:                                             OK
  /forking/patterns:                                                   OK
  /misc/log-handler:
GLib-CRITICAL **: g_str_has_prefix: assertion `str != NULL' failed
aborting...

** CRITICAL **: Test passing
aborting...

** ERROR **: Test failing
aborting...

GLib-CRITICAL **: g_str_has_prefix: assertion `str != NULL' failed
aborting...
OK
PASS: testing


... and, again, here:

make  check-local
make[5]: Entering directory `/var/tmp/portage/dev-libs/glib-2.22.3/work/glib-2.22.3/glib/tests'
TEST: testing... (pid=7929)
  /random-generator/rand-1:                                            OK
  /random-generator/rand-2:                                            OK
  /random-generator/random-conversions:                                OK
  /misc/assertions:                                                    OK
  /misc/test-data:                                                     OK
  /misc/primetoul:                                                     OK
  /forking/fail assertion:                                             OK
  /forking/patterns:                                                   OK
  /misc/log-handler:
GLib-CRITICAL **: g_str_has_prefix: assertion `str != NULL' failed
aborting...

** CRITICAL **: Test passing
aborting...

** ERROR **: Test failing
aborting...

GLib-CRITICAL **: g_str_has_prefix: assertion `str != NULL' failed
aborting...
OK
PASS: testing



And, finally, at the end:

 * ERROR: dev-libs/glib-2.22.3 failed:                            
 *   install aborted due to poor programming practices shown above

I guess that's expected, though...?





Comment 13


Gilles Dartiguelongue (RETIRED)






          2009-12-22 16:35:18 UTC
        

hopefully that would be the source of the problem. Could you provide a full build.log so we can open an upstream bug report with all needed information (and emerge --info, the more the better) ?




Comment 14


Willard Dawson





          2009-12-22 20:15:28 UTC
        

Created attachment 213797 [details]
Text file containing output from emerge --info && FEATURES="test stricter" emerge -1 glib




Comment 15


Willard Dawson





          2009-12-23 20:57:57 UTC
        

Created attachment 213968 [details]
Build log




Comment 16


Giacomo Perale





          2009-12-27 23:06:41 UTC
        

FWIW I'm on x86 and I had a lot of issues when I upgraded to glib 2.22.3 too, so I was forced to rebuild the gstreamer stack (gstreamer, gst-plugins), a few 'semi-deprecated' libraries (libonobo/libonoboui, corba, gnome-vfs) who probably I had last compiled against glib 2.20 or even glib 2.18 and some random applications (gnome-media, totem, nautilus, evolution-data-server).

Today I found that drag'n'drop didn't work with rhythmbox; the console was full of these error messages:

(rhythmbox:7361): GLib-GObject-CRITICAL **: g_type_add_interface_static: assertion `g_type_parent (interface_type) == G_TYPE_INTERFACE' failed

(rhythmbox:7361): Gtk-CRITICAL **: gtk_container_foreach: assertion `GTK_IS_CONTAINER (container)' failed

After a rebuild rhythmbox works again. These seem to be clear symptoms of an ABI break... 




Portage 2.2_rc61 (default/linux/x86/10.0/desktop, gcc-4.3.4, glibc-2.9_p20081201-r2, 2.6.32-gentoo-amd64 x86_64)
=================================================================
System uname: Linux-2.6.32-gentoo-amd64-x86_64-AMD_Athlon-tm-_Dual_Core_Processor_4850e-with-gentoo-2.0.1
Timestamp of tree: Sun, 27 Dec 2009 22:30:01 +0000
app-shells/bash:     4.0_p35
dev-java/java-config: 2.1.10
dev-lang/python:     2.6.4
dev-util/cmake:      2.8.0
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.0
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.29
ACCEPT_KEYWORDS="x86"
ACCEPT_LICENSE="* -@EULA"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=athlon64 -O2 -pipe -msse3 -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=athlon64 -O2 -pipe -msse3 -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--alphabetical"
FEATURES="assume-digests distlocks fixpackages news parallel-fetch protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://ftp.unina.it/pub/linux/distributions/gentoo/ http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo/ http://sunsite.cnlab-switch.ch/ftp/mirror/gentoo/"
LANG="it_IT"
LDFLAGS="-Wl,-O1,--hash-style=gnu,--sort-common,--as-needed"
LINGUAS="it en"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /usr/local/gstreamer-overlay /usr/local/springlobby"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac acl acpi alsa applet bash-completion berkdb boost branding bzip2 cairo cdda cdio cdr cli consolekit cracklib crypt cups curl cxx dbus dirac djvu dri dts dvb dvd dvdr eds emboss encode evo exif faac faad fam ffmpeg fftw flac fontconfig fortran fuse gcj gdbm gif gimp gnome gnome-keyring gnutls gphoto2 gpm gstreamer gtk hal iconv imagemagick java jce jpeg jpeg2k lapack lcms libnotify lua lzma mad mmx mmxext mng modules mono mp3 mp4 mpeg mudflap musepack musicbrainz mysql nautilus ncurses nls nntp nptl nptlonly nsplugin ogg openexr opengl openmp pam pcre pdf perl png policykit ppds pppd python qt3support quicktime readline reflection samba scanner schroedinger sdl session smp spell spl sqlite sqlite3 sse sse2 sse3 ssl startup-notification svg sysfs tcpd theora threads thunar tiff truetype udev unicode usb v4l v4l2 vorbis webkit win32codecs wmf x264 x86 xattr xcb xcomposite xml xmp xorg xulrunner xv xvid zlib" ALSA_CARDS="emu10k1 intel8x0" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2" ELIBC="glibc" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="it en" QEMU_SOFTMMU_TARGETS="i386 x86_64" RUBY_TARGETS="ruby18" SANE_BACKENDS="mustek_usb" USERLAND="GNU" VIDEO_CARDS="radeon" 
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 17


Romain Perier (RETIRED)






          2009-12-29 10:48:56 UTC
        

Someone who has not rebuilt glib reverse-deps yet, could test this patch ?
http://git.gnome.org/browse/glib/commit/?h=glib-2-22&id=84e791e580c3a16d628c8161a92a0652aa94b294




Comment 18


Romain Perier (RETIRED)






          2010-01-05 16:07:01 UTC
        

please get back us




Comment 19


Gilles Dartiguelongue (RETIRED)






          2010-01-05 16:40:57 UTC
        

I upgraded my x86 yesterday (without this patch) and didn't notice any breakage.

# emerge --info
Portage 2.2_rc61 (default/linux/x86/10.0, gcc-4.4.2, glibc-2.11-r1, 2.6.32-gentoo i686)
=================================================================
System uname: Linux-2.6.32-gentoo-i686-Pentium_III_-Katmai-with-gentoo-2.0.1
Timestamp of tree: Sat, 02 Jan 2010 01:45:01 +0000
distcc 3.1 i686-pc-linux-gnu [enabled]
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p35
dev-lang/python:     2.6.4, 3.1.1-r1
dev-python/pycrypto: 2.0.1-r8
dev-util/ccache:     2.4-r8
dev-util/cmake:      2.8.0
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.0
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.5, 1.7.9-r1, 1.9.6-r2, 1.10.3, 1.11.1
sys-devel/binutils:  2.20
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="x86 ~x86"
ACCEPT_LICENSE="* -@EULA"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=pentium3 -g -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -march=pentium3 -g -pipe -fvisibility-inlines-hidden"
DISTDIR="/var/tmp/distfiles"
FEATURES="assume-digests buildpkg ccache distcc distlocks fixpackages multilib-strict news parallel-fetch preserve-libs protect-owned sandbox sfperms splitdebug strict unmerge-logs unmerge-orphans userfetch usersandbox"
GENTOO_MIRRORS="ftp://91.121.125.139/gentoo-distfiles/ http://91.121.125.139/gentoo-distfiles/ ftp://91.121.124.139/gentoo-distfiles/"
LANG="fr_FR.UTF-8"
LC_ALL="fr_FR.UTF-8"
LDFLAGS="-Wl,-O1,--as-needed,--hash-style=gnu"
LINGUAS="fr en ja zh zh_CN"
MAKEOPTS="-j6 -l4.0"
PKGDIR="/var/tmp/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="   "
SYNC="rsync://shinobu/gentoo-portage"
USE="X a52 aac aalib acl acpi alsa applet asyncns avahi bash-completion bogofilter bzip2 cairo caps cdr cjk cli consolekit cracklib crypt cups daap dbus device-mapper dri dvd dvdr eds encode evo exif fbcon ffmpeg flac freewnn galago git gmp gnome gnome-keyring gnutls gphoto2 gpm gstreamer gtk gtkhtml iconv ipv6 jabber jpeg laptop lcms ldap libgda libnotify logrotate lzma lzo mad matroska mmx mng modules mpeg mudflap musicbrainz nautilus ncurses nfs nls nntp nptl nptlonly nsplugin ogg openct opengl openmp pam pcre pdf png ppds pppd pth python readline reflection samba sasl session spell spl sqlite sqlite3 sse ssl startup-notification subversion svg sysfs tcpd theora threads tracker udev unicode urandom usb v4l v4l2 vim-syntax vorbis x264 x86 xattr xcb xinerama xml xorg xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="dav dav_fs authn_file auth_digest authz_groupfile authz_host dir mime autoindex alias" APACHE2_MPMS="event" ELIBC="glibc" INPUT_DEVICES="evdev wacom" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="fr en ja zh zh_CN" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="intel radeon vesa" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 20


Willard Dawson





          2010-01-05 16:51:48 UTC
        

(In reply to comment #18)
> please get back us
> 

Sorry, not sure I can help.  Maybe I already rebuilt glib reverse-deps...?

So, I made a patch file and a local portage overlay to test it.  Glib compiles
with the patch just fine... so, to test it, I'll need to re-emerge
dev-libs/dbus-glib and others, or not...?




Comment 21


Romain Perier (RETIRED)






          2010-01-06 09:44:14 UTC
        

(In reply to comment #20)
> (In reply to comment #18)
> > please get back us
> > 
> 
> Sorry, not sure I can help.  Maybe I already rebuilt glib reverse-deps...?
> 
> So, I made a patch file and a local portage overlay to test it.  Glib compiles
> with the patch just fine... so, to test it, I'll need to re-emerge
> dev-libs/dbus-glib and others, or not...?
> 

Depending if you still have the issue or not, you've just to rebuild glib with this patch, don't rebuild rdep yet (at the origin we suspect ABI breakage)





Comment 22


Willard Dawson





          2010-01-06 12:33:21 UTC
        

(In reply to comment #21)
> Depending if you still have the issue or not, you've just to rebuild glib with
> this patch, don't rebuild rdep yet (at the origin we suspect ABI breakage)

Reemerging dev-libs/dbus-glib worked for me, before applying the patch, to resolve the problems with ConsoleKit.







Comment 23


Rafał Mużyło





          2010-01-07 16:12:30 UTC
        

Yesterday, glib 2.22.4 was released, containing this fix.




Comment 24


Gilles Dartiguelongue (RETIRED)






          2010-01-07 16:49:14 UTC
        

yes, we know, it'd be nice to know if it fixes this problem though.




Comment 25


Romain Perier (RETIRED)






          2010-01-09 11:09:22 UTC
        

(In reply to comment #23)
> Yesterday, glib 2.22.4 was released, containing this fix.
> 
Could you bump it in your own overlay and test it ?

@Gilles: If glib-2.22.4 really solves these bugs, the better choice would be to bump it and then drop glib-2.22.3 (it's broken... so why keep it ?)
opinion ?




Comment 26


Romain Perier (RETIRED)






          2010-01-09 11:10:01 UTC
        

Or include the fix in glib-2.22.3... since it's only broken for x86...




Comment 27


Rafał Mużyło





          2010-01-09 13:02:19 UTC
        

Unless I'm missing something, nothing is
the commit that introduced this regression
in 2.22.3 is x86 specific.

If the problem in this bug was caused by g_set_prgname change,
2.22.4 fixes it, as it reverts that change. If it was caused
by something else, we're back at the start anyway.





Comment 28


Romain Perier (RETIRED)






          2010-01-15 09:58:54 UTC
        

well glib-2.22.4 is out, could you quickly bump it in your own overlay, and test it ? I just want to check something.

thanks in advance




Comment 29


Gilles Dartiguelongue (RETIRED)






          2010-01-17 09:45:16 UTC
        

*** Bug 301118 has been marked as a duplicate of this bug. ***




Comment 30


Romain Perier (RETIRED)






          2010-01-17 11:05:12 UTC
        

ping ^^




Comment 31


Pacho Ramos






          2010-01-24 10:20:31 UTC
        

Created attachment 217305 [details]
2.22.4-build.log

2.22.4 still fails test on my x86 system
Portage 2.1.6.13 (default/linux/x86/10.0/desktop, gcc-4.3.4, glibc-2.10.1-r1, 2.6.31-tuxonice i686)
=================================================================
System uname: Linux-2.6.31-tuxonice-i686-Genuine_Intel-R-_CPU_T2300_@_1.66GHz-with-gentoo-1.12.13
Timestamp of tree: Sat, 16 Jan 2010 15:30:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p35
dev-java/java-config: 2.1.9-r2
dev-lang/python:     2.6.4
dev-util/ccache:     2.4-r7
dev-util/cmake:      2.6.4-r3
sys-apps/baselayout: 1.12.13
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O2 -march=native -pipe -fomit-frame-pointer"
DISTDIR="/usr/distfiles"
FEATURES="ccache distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://ftp.free.fr/mirrors/ftp.gentoo.org"
LANG="es_ES.UTF-8"
LC_ALL="es_ES.UTF-8"
LDFLAGS="-Wl,-O1"
LINGUAS="es es_ES en_US"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/sunrise /usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi alsa applet avahi bash-completion berkdb branding bzip2 cairo cdda cddb cdinstall cdr cleartype cli consolekit cracklib crypt css cups cxx daap dbus djvu dri dts dvd dvdr dvi eds emboss encode evo exif fam fat ffmpeg firefox flac fortran gdbm gif glitz gnome gnome-keyring gpm gstreamer gtk hal iconv imagemagick java jpeg kdehiddenvisibility kpathsea laptop latex libnotify lm_sensors lzma mad mikmod mmx mmxext mng modules mono mp3 mp4 mpeg mudflap music musicbrainz nautilus ncurses network network-cron networkmanager nls nptl nptlonly ntfs nvidia ogg opengl openmp pam pango pch pcre pdf perl png policykit ppds pppd python qt3support quicktime readline reflection reiserfs scanner sdl session spell spl sse sse2 ssl ssse3 startup-notification svg sysfs t1lib tcpd threads thunar tiff truetype unicode usb vcd vorbis win32codecs x264 x86 xattr xcb xml xmp xorg xpm xulrunner xv xvid zeroconf zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="es es_ES en_US" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nvidia nv vesa"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 32


Rafał Mużyło





          2010-01-24 14:00:14 UTC
        

*** Bug 302044 has been marked as a duplicate of this bug. ***




Comment 33


Romain Perier (RETIRED)






          2010-01-25 15:01:41 UTC
        

pacho: same here, glib-2.22.4 does not pass its testsuite, arfff...




Comment 34


Gilles Dartiguelongue (RETIRED)






          2010-01-28 23:55:05 UTC
        

+*glib-2.22.4 (28 Jan 2010)
+
+  28 Jan 2010; Gilles Dartiguelongue <eva@gentoo.org> -glib-2.20.5.ebuild,
+  +glib-2.22.4.ebuild:
+  Version bump. Bug fixes, and notably bug #297483. Disable test affecting
+  live filesystem, bug #297684.
+
Thanks for reporting.




Comment 35


Pacho Ramos






          2010-01-29 09:22:36 UTC
        

(In reply to comment #34)
> Disable test affecting
> +  live filesystem, bug #297684.
> +
> Thanks for reporting.
> 

Ups, this is why the test error looked me "familiar" 

Thanks for the bump




Comment 36


Gilles Dartiguelongue (RETIRED)






          2010-03-09 07:07:01 UTC
        

*** Bug 308541 has been marked as a duplicate of this bug. ***




Comment 37


Gilles Dartiguelongue (RETIRED)






          2010-03-09 07:07:57 UTC
        

Reopening since this popped up on a stable box migration it seems. We should probably do a news item since it is likely to hit a couple of users.




Comment 38


Pacho Ramos






          2010-03-09 20:46:03 UTC
        

What will be the "fix"? rebuild dbus-glib? Maybe we should consider stabling a newer dbus-glib version, but I don't know if newer versions are really needed :-/




Comment 39


Jimmy C. Chau





          2010-03-09 21:30:41 UTC
        

reply to comment 33:

Rebuilding dbus-glib alone may not be enough to solve all of these problems.  Pidgin also broke for me (bug #308565) and remained broken after I rebuilt dbus-glib to fix evince (bug #308541).  

However, rebuilding nearly everything might do the trick; for pidgin, I "emerge -ave pidgin" and now pidgin runs again.  




Comment 40


Jimmy C. Chau





          2010-03-09 21:31:37 UTC
        

(In reply to comment #39)
> reply to comment 33:
> 

Whoops, I mean in reply to comment 38.




Comment 41


Pacho Ramos






          2010-06-13 15:25:29 UTC
        

This is no longer an issue with 2.24.1 and, regarding 2.22, we have done some workarounds to try to minimize this problem (like stabilizing some newer versions of affected tools). 

Feel free to reopen if this is still an issue for you with latest stable or testing




Comment 42


simon





          2010-08-13 22:26:07 UTC
        

Should be re-opened. I upgraded from glib-2.22.5 to 2.24.1-r1 on Aug 2, and since then various weird issues had occured:
* kde's new akonadi-server didn't start any more
* gimp didn't start any more
* xserver restartet randomly

These problems have disappeared after re-emerging dbus-glib.




Comment 43


Daniel Barkalow





          2010-09-16 01:44:49 UTC
        

I'm still seeing this with glib-2.24.1-r1 and dbus-glib-0.86 (a build of glib requires a subsequent rebuild of dbus-glib in order to avoid having programs that use dbus-glib fail with the message from comment #5, and revdep-rebuild doesn't even find it).





Comment 44


Juergen Rose





          2010-09-18 09:28:58 UTC
        

Please reopen bug, I suppose that I hit the same problem, compare Bug 336138.




Comment 45


Pacho Ramos






          2010-09-18 10:16:12 UTC
        

Reopening




Comment 46


Pacho Ramos






          2010-09-18 10:19:51 UTC
        

*** Bug 336138 has been marked as a duplicate of this bug. ***




Comment 47


Pacho Ramos






          2010-09-18 17:41:29 UTC
        

*** Bug 332367 has been marked as a duplicate of this bug. ***




Comment 48


Gilles Dartiguelongue (RETIRED)






          2010-09-19 08:25:29 UTC
        

*** Bug 336138 has been marked as a duplicate of this bug. ***




Comment 49


Rafał Mużyło





          2010-12-25 17:13:48 UTC
        

Got hit by this yesterday with glib-2.26.1 and dbus-glib-0.92.
Looks I've been wrong about this being fixed.
While rebuild of dbus-glib helped for most apps, there are still a few that complain.
Does anyone have an idea was could be the cause of this problem ?




Comment 50


Rafał Mużyło





          2010-12-25 17:33:29 UTC
        

To be a bit more specific - a lot of dbus dependent apps behaved as in comment 5.




Comment 51


Pacho Ramos






          2010-12-28 16:52:12 UTC
        

Since we have not much idea about what is causing this and, for example in my case, have never experienced this problem, I would try to report this also to upstream as maybe they will know more about this:
https://bugs.freedesktop.org/enter_bug.cgi?product=dbus




Comment 52


Samuli Suominen (RETIRED)






          2011-01-11 13:16:07 UTC
        

Why is this bug open? Yes, you still need to rebuild dbus-glib after glib or dbus upgrade. You want package manager to do that for you? See bug 192319.




Comment 53


Rafał Mużyło





          2011-01-11 19:25:15 UTC
        

The point is: why is it necessary in the first place ?
dbus-glib is neither one of x11-drivers nor a sip module - that rebuild shouldn't be required.




Comment 54


Rafał Mużyło





          2011-03-17 16:37:20 UTC
        

Recently I came upon an  interesting entry in udisks git, that might be the original cause of this problem.

See https://bugzilla.redhat.com/show_bug.cgi?id=673544.




Comment 55


Gilles Dartiguelongue (RETIRED)






          2011-03-17 17:02:54 UTC
        

this is interesting indeed. It's just one more package to know about when updating dbus-glib or rebuilding dbus-glib after a dbus upgrade.




Comment 56


genbug





          2011-04-09 08:53:12 UTC
        

It's also worth noting that this won't get picked up by revdep-rebuild.

This should at least be in a big fat ewarning or something so that I don't have to start googling and searching forums when half by system breaks when I update a major package.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

