Title: 600328 – media-libs/phonon-4.9.0:: Build failure in qt4 version with +pulseaudio
URL: https://bugs.gentoo.org/show_bug.cgi?id=600328

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 600328
media-libs/phonon-4.9.0:: Build failure in qt4 version with +pulseaudio
Last modified: 2017-03-13 06:42:05 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 600328 
      - media-libs/phonon-4.9.0:: Build failure in qt4 version with +pulseaudio


Summary:
media-libs/phonon-4.9.0:: Build failure in qt4 version with +pulseaudio
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2016-11-20 15:21 UTC by Manuel Lauss





      Modified:
    
2017-03-13 06:42 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




media-libs/phonon-9999 build log

              (build.log,75.20 KB,
                text/plain)

            
2016-11-26 12:46 UTC,

            Manuel Lauss




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Manuel Lauss





          2016-11-20 15:21:01 UTC
        

Trying to build media-libs/phonon-4.9.0 (4.7.0 and 9999 fail same way):

using +pulseaudio breaks the build, qt4-moc chokes on something

/usr/lib64/qt4/bin/moc -I/tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999-qt4-abi_x86_64.amd64/phonon -I/tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999-qt4-abi_x86_64.amd64/includes/phonon -I/tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999/phonon -I/tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999/includes -I/tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999 -I/usr/include/qt4/QtDesigner -I/usr/include/qt4/QtDeclarative -I/usr/include/qt4/QtScriptTools -I/usr/include/qt4/QtDBus -I/usr/include/qt4/QtXml -I/usr/include/qt4/QtSql -I/usr/include/qt4/QtOpenGL -I/usr/include/qt4/QtMultimedia -I/usr/include/qt4/QtNetwork -I/usr/include/qt4/QtXmlPatterns -I/usr/include/qt4/QtWebKit -I/usr/include/qt4/QtHelp -I/usr/include/qt4/QtUiTools -I/usr/include/qt4/QtTest -I/usr/include/qt4/QtScript -I/usr/include/qt4/QtSvg -I/usr/include/qt4/Qt3Support -I/usr/include/qt4/QtGui -I/usr/include/qt4/QtCore -I/usr/share/qt4/mkspecs/default -I/usr/include/qt4 -I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include -I/usr/include -I/usr/include -I/usr/include -DHAVE_PULSEAUDIO -DPHONON_ASSERT_STATES -DPHONON_BACKEND_DIR_SUFFIX="/phonon_backend/" -DPHONON_BUILD_WITH_CMAKE -DPHONON_LIBRARY_PATH="/usr/lib64/qt4/plugins" -DPHONON_NO_GRAPHICSVIEW -D_BSD_SOURCE -o /tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999-qt4-abi_x86_64.amd64/phonon/factory.moc /tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999/phonon/factory.cpp
/tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999/phonon/globalstatic_p.h:52: Parse error at "defined"
AUTOGEN: error: process for /tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999-qt4-abi_x86_64.amd64/phonon/factory.moc failed:
/tmp-ram/portage/media-libs/phonon-9999/work/phonon-9999/phonon/globalstatic_p.h:52: Parse error at "defined"


media-libs/phonon-gstreamer-4.9.0[qt4] breaks the same way.  The error message is
bogus though, it's always line 52 in some random include file.




Comment 1


Michał Górny









          2016-11-26 11:56:12 UTC
        

Please attach the build.log file, and attach or paste 'emerge --info media-sound/pulseaudio dev-qt/qtcore:4'.




Comment 2


Manuel Lauss





          2016-11-26 12:24:57 UTC
        

It's a problem with LTO.




Comment 3


Manuel Lauss





          2016-11-26 12:44:08 UTC
        

spoke too soon, forgot to add +pulseaudio, but I did disable LTO just in case.


# emerge --info media-sound/pulseaudio dev-qt/qtcore:4
Portage 2.3.2 (python 3.5.2-final-0, default/linux/amd64/13.0/desktop/plasma/systemd, gcc-6.2.0, glibc-2.24, 4.9.0-rc6-00133-g10b9dd56860e-dirty x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-4.9.0-rc6-00133-g10b9dd56860e-dirty-x86_64-Intel-R-_Core-TM-_i7-4910MQ_CPU_@_2.90GHz-with-gentoo-2.3
KiB Mem:    32900312 total,   1514156 free
KiB Swap:   21955904 total,  21955904 free
Timestamp of repository gentoo: Sat, 26 Nov 2016 07:45:01 +0000
sh bash 4.4_p5
ld GNU ld (Gentoo git) 2.27.51.20161119
distcc 3.2rc1 x86_64-pc-linux-gnu [disabled]
app-shells/bash:          4.4_p5::gentoo
dev-java/java-config:     2.2.0-r3::gentoo
dev-lang/perl:            5.24.1_rc4::gentoo
dev-lang/python:          2.7.12::gentoo, 3.5.2::gentoo
dev-util/cmake:           3.7.0::gentoo
dev-util/pkgconfig:       0.29.1::gentoo
sys-apps/baselayout:      2.3::gentoo
sys-apps/openrc:          0.22.4::gentoo
sys-apps/sandbox:         2.10-r2::gentoo
sys-devel/autoconf:       2.13::gentoo, 2.69-r2::gentoo
sys-devel/automake:       1.11.6-r2::gentoo, 1.12.6-r1::gentoo, 1.13.4-r1::gentoo, 1.14.1-r1::gentoo, 1.15-r2::gentoo
sys-devel/binutils:       9999::gentoo
sys-devel/gcc:            6.2.0-r1::gentoo
sys-devel/gcc-config:     1.8-r1::gentoo
sys-devel/libtool:        2.4.6-r2::gentoo
sys-devel/make:           4.2.1::gentoo
sys-kernel/linux-headers: 4.8::gentoo (virtual/os-headers)
sys-libs/glibc:           2.24::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://moya/gentoo-portage
    priority: -1000

mano
    location: /etc/portage/overlay
    masters: gentoo
    priority: 0

steam-overlay
    location: /var/lib/layman/steam-overlay
    masters: gentoo
    priority: 50

x11
    location: /var/lib/layman/x11
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64 ~amd64 ~amd64-linux"
ACCEPT_LICENSE="* -@EULA GPL-3 LGPL-3 Oracle-BCLA-JavaSE NVIDIA-CUDA PUEL NVIDIA-CODEC-SDK"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O3 -flto=9 -fno-fat-lto-objects -march=haswell -mtune=haswell -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O3 -flto=9 -fno-fat-lto-objects -march=haswell -mtune=haswell -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--quiet-build=n"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs cgroup compressdebug config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersync"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://mirror.netcologne.de/gentoo/"
LANG="C"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j8"
PKGDIR="/usr/portage/packages"
PORTAGE_BZIP2_COMMAND="/bin/bzip2"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/tmp-ram"
USE="X acl amd64 bash-completion bluetooth bzip2 crypt dbus dri gstreamer iconv inotify introspection ipv6 jpeg lzma nls nptl opengl pam png policykit pulseaudio qml qt4 ssl systemd threads tiff udev udisks unicode upower usb xcb zlib" ABI_X86="64" CALLIGRA_FEATURES="author braindump flow karbon kexi krita sheets stage words" CAMERAS="*" CPU_FLAGS_X86="mmx mmxext sse3 ssse3 sse sse2 sse4_1 sse4_2 avx avx2 fma3 aes f16c" CURL_SSL="openssl" ELIBC="glibc" GPSD_PROTOCOLS="*" GRUB_PLATFORMS="efi-64" INPUT_DEVICES="evdev synaptics" KERNEL="linux" LINGUAS="en" LLVM_TARGETS="AArch64 AMDGPU ARM BPF Mips NVPTX" PYTHON_SINGLE_TARGET="python3_5" PYTHON_TARGETS="python2_7 python3_5" RUBY_TARGETS="ruby23" SANE_BACKENDS="*" USERLAND="GNU" VIDEO_CARDS="nvidia intel i965"
Unset:  CC, CPPFLAGS, CTARGET, CXX, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON

=================================================================
                        Package Settings
=================================================================

media-sound/pulseaudio-9.0::gentoo was built with the following:
USE="X alsa alsa-plugin asyncns bluetooth caps dbus glib gnome ipv6 native-headset realtime sox ssl systemd udev zeroconf -doc -equalizer -gdbm -gtk -jack -libressl -libsamplerate -lirc (-neon) -ofono-headset -orc (-oss) -qt4 (-selinux) (-system-wide) -tcpd -test -webrtc-aec -xen" ABI_X86="32 64 -x32"
CFLAGS="-O2 -march=haswell -mtune=haswell -pipe -fno-lto"
CXXFLAGS="-O2 -march=haswell -mtune=haswell -pipe -fno-lto"


dev-qt/qtcore-4.8.7-r2::gentoo was built with the following:
USE="exceptions glib iconv icu qt3support ssl (-aqua) -debug -libressl -pch" ABI_X86="64 -32 -x32"
CFLAGS="-O2 -march=haswell -mtune=haswell -pipe -fno-lto"
CXXFLAGS="-O2 -march=haswell -mtune=haswell -pipe -fno-lto"




Comment 4


Manuel Lauss





          2016-11-26 12:46:17 UTC
        

Created attachment 454426 [details]
media-libs/phonon-9999 build log

I suspect that dev-libs/glib is at fault here, 4 weeks ago it still built fine,
and in between only glib received an update.




Comment 5


Manuel Lauss





          2017-03-13 06:42:05 UTC
        

This issue seems to have been resolved by some upstream changes, it's working again. Hence, closing as worksforme.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

