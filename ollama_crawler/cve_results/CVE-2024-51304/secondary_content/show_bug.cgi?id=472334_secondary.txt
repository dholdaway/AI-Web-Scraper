Title: 472334 – sys-fs/cryptsetup-1.6.1 fails on "cannot find -ldevmapper"
URL: https://bugs.gentoo.org/show_bug.cgi?id=472334

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 472334
sys-fs/cryptsetup-1.6.1 fails on "cannot find -ldevmapper"
Last modified: 2021-07-01 09:18:02 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 472334 
      - sys-fs/cryptsetup-1.6.1 fails on "cannot find -ldevmapper"


Summary:
sys-fs/cryptsetup-1.6.1 fails on "cannot find -ldevmapper"
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-06-04 20:18 UTC by Kobboi





      Modified:
    
2021-07-01 09:18 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



mrueg









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Kobboi





          2013-06-04 20:18:20 UTC
        

[ebuild     U  ] sys-fs/cryptsetup-1.6.1 [1.6.0] USE="gcrypt%* nls python udev -kernel% -nettle% -openssl% -reencrypt (-selinux) -static -static-libs -urandom" PYTHON_SINGLE_TARGET="python2_7%* -python2_5% -python2_6%" PYTHON_TARGETS="python2_7%* -python2_5% -python2_6%" 0 kB

/bin/sh ../libtool --tag=CC   --mode=link x86_64-pc-linux-gnu-gcc -Wall  -march=core2 -msse4 -mcx16 -mpopcnt -msahf -O2 -pipe -Wl,--version-script=../lib/libcryptsetup.sym -version-info 9:0:5 -Wl,-O1 -Wl,--as-needed -o libcryptsetup.la -rpath /usr/lib64 libcryptsetup_la-setup.lo libcryptsetup_la-utils.lo libcryptsetup_la-utils_benchmark.lo libcryptsetup_la-utils_crypt.lo libcryptsetup_la-utils_loop.lo libcryptsetup_la-utils_devpath.lo libcryptsetup_la-utils_wipe.lo libcryptsetup_la-utils_fips.lo libcryptsetup_la-utils_device.lo libcryptsetup_la-libdevmapper.lo libcryptsetup_la-volumekey.lo libcryptsetup_la-random.lo libcryptsetup_la-crypt_plain.lo -luuid -L/lib64 -ldevmapper -lgcrypt -lgpg-error crypto_backend/libcrypto_backend.la luks1/libluks1.la loopaes/libloopaes.la verity/libverity.la tcrypt/libtcrypt.la 
libtool: link: x86_64-pc-linux-gnu-gcc -shared  -fPIC -DPIC  .libs/libcryptsetup_la-setup.o .libs/libcryptsetup_la-utils.o .libs/libcryptsetup_la-utils_benchmark.o .libs/libcryptsetup_la-utils_crypt.o .libs/libcryptsetup_la-utils_loop.o .libs/libcryptsetup_la-utils_devpath.o .libs/libcryptsetup_la-utils_wipe.o .libs/libcryptsetup_la-utils_fips.o .libs/libcryptsetup_la-utils_device.o .libs/libcryptsetup_la-libdevmapper.o .libs/libcryptsetup_la-volumekey.o .libs/libcryptsetup_la-random.o .libs/libcryptsetup_la-crypt_plain.o  -Wl,--whole-archive crypto_backend/.libs/libcrypto_backend.a luks1/.libs/libluks1.a loopaes/.libs/libloopaes.a verity/.libs/libverity.a tcrypt/.libs/libtcrypt.a -Wl,--no-whole-archive  -Wl,--as-needed -luuid -L/lib64 -ldevmapper /usr/lib64/libgcrypt.so -lgpg-error  -march=core2 -msse4 -mcx16 -mpopcnt -msahf -O2 -Wl,--version-script=../lib/libcryptsetup.sym -Wl,-O1   -Wl,-soname -Wl,libcryptsetup.so.4 -o .libs/libcryptsetup.so.4.5.0
/usr/lib/gcc/x86_64-pc-linux-gnu/4.7.3/../../../../x86_64-pc-linux-gnu/bin/ld: cannot find -ldevmapper


Reproducible: Always




Comment 1


Samuli Suominen (RETIRED)






          2013-06-04 21:11:56 UTC
        

With what USE flags is lvm2 emerged with? The dependency is there.

# emerge -pv lvm2

Does re-emerging it help? Have you ran `revdep-rebuild` lately?




Comment 2


Kobboi





          2013-06-04 21:21:16 UTC
        

# eix -e lvm2
[I] sys-fs/lvm2
     Available versions:  (~)2.02.95-r4 (~)2.02.97 2.02.97-r1 (~)2.02.98{tbz2} {clvm cman +lvm1 readline selinux static static-libs +thin +udev}
     Installed versions:  2.02.98{tbz2}(06:38:55 PM 05/09/2013)(lvm1 readline thin udev -clvm -cman -selinux -static -static-libs)
     Homepage:            http://sources.redhat.com/lvm2/
     Description:         User-land utilities for LVM2 (device-mapper) software.

# equery files lvm2 | grep devmapper
/lib64/device-mapper/libdevmapper-event-lvm2mirror.so
/lib64/device-mapper/libdevmapper-event-lvm2raid.so
/lib64/device-mapper/libdevmapper-event-lvm2snapshot.so
/lib64/device-mapper/libdevmapper-event-lvm2thin.so
/lib64/libdevmapper-event-lvm2.so.2.02
/lib64/libdevmapper-event-lvm2mirror.so
/lib64/libdevmapper-event-lvm2raid.so
/lib64/libdevmapper-event-lvm2snapshot.so
/lib64/libdevmapper-event-lvm2thin.so
/lib64/libdevmapper-event.so.1.02
/lib64/libdevmapper.so.1.02
/usr/include/libdevmapper-event.h
/usr/include/libdevmapper.h
/usr/lib64/libdevmapper-event-lvm2.so
/usr/lib64/libdevmapper-event.so
/usr/lib64/libdevmapper.so
/usr/lib64/pkgconfig/devmapper-event.pc
/usr/lib64/pkgconfig/devmapper.pc




Comment 3


Kobboi





          2013-06-04 21:23:39 UTC
        

@preserved-rebuild is empty. Running revdep-rebuild says all is consistent.

Shouldn't -L/lib64 be -L/usr/lib64?




Comment 4


Kobboi





          2013-06-04 21:29:07 UTC
        

Re-emerge of lvm2-2.02.98 fixes the issue. First emerge was on May 9th and the ebuild was apparently patched without revision upstep.




Comment 5


Kobboi





          2013-06-04 21:30:54 UTC
        

Never mind, the change seems trivial and unrelated. What happened then?




Comment 6


Jeroen Roovers (RETIRED)






          2013-06-05 13:55:05 UTC
        

Index: cryptsetup-1.6.1.ebuild
===================================================================
RCS file: /var/cvsroot/gentoo-x86/sys-fs/cryptsetup/cryptsetup-1.6.1.ebuild,v
retrieving revision 1.2
retrieving revision 1.3
diff -u -B -r1.2 -r1.3
--- cryptsetup-1.6.1.ebuild     4 Jun 2013 22:00:52 -0000       1.2
+++ cryptsetup-1.6.1.ebuild     4 Jun 2013 22:14:11 -0000       1.3
@@ -1,6 +1,6 @@
 # Copyright 1999-2013 Gentoo Foundation
 # Distributed under the terms of the GNU General Public License v2
-# $Header: /var/cvsroot/gentoo-x86/sys-fs/cryptsetup/cryptsetup-1.6.1.ebuild,v 1.2 2013/06/04 22:00:52 radhermit Exp $
+# $Header: /var/cvsroot/gentoo-x86/sys-fs/cryptsetup/cryptsetup-1.6.1.ebuild,v 1.3 2013/06/04 22:14:11 flameeyes Exp $
 
 EAPI=5
 PYTHON_COMPAT=( python{2_5,2_6,2_7} )
@@ -31,10 +31,10 @@
        sys-libs/e2fsprogs-libs[static-libs(+)]
        udev? ( virtual/udev[static-libs(+)] )"
 # We have to always depend on ${LIB_DEPEND} rather than put behind
-# static? () because we provide a shared library which links against
+# !static? () because we provide a shared library which links against
 # these other packages. #414665
 RDEPEND="static-libs? ( ${LIB_DEPEND} )
-       ${LIB_DEPEND//\[static-libs(+)]}
+       ${LIB_DEPEND//\[static-libs\(+\)\]}
        selinux? ( sys-libs/libselinux )
        python? ( ${PYTHON_DEPS} )"
 DEPEND="${RDEPEND}

Could it be this one, again?




Comment 7


Kobboi





          2021-07-01 09:18:02 UTC
        

Closing as irrelevant and no longer reproducible because of it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

