Title: [ci skip] Add warning about deduplication of after_xxx_commit shortcuts by ConfusedVorlon · Pull Request #51184 · rails/rails · GitHub
URL: https://github.com/rails/rails/pull/51184

Skip to content




















Navigation Menu

Toggle navigation




 













            Sign in
          








        Product
        













GitHub Copilot
        Write better code with AI
      







Security
        Find and fix vulnerabilities
      







Actions
        Automate any workflow
      







Codespaces
        Instant dev environments
      







Issues
        Plan and track work
      







Code Review
        Manage code changes
      







Discussions
        Collaborate outside of code
      







Code Search
        Find more, search less
      






Explore



      All features

    



      Documentation

    





      GitHub Skills

    





      Blog

    










        Solutions
        






By company size



      Enterprises

    



      Small and medium teams

    



      Startups

    




By use case



      DevSecOps

    



      DevOps

    



      CI/CD

    



      View all use cases

    






By industry



      Healthcare

    



      Financial services

    



      Manufacturing

    



      Government

    



      View all industries

    






              View all solutions
              


 




        Resources
        






Topics



      AI

    



      DevOps

    



      Security

    



      Software Development

    



      View all

    






Explore



      Learning Pathways

    





      White papers, Ebooks, Webinars

    





      Customer Stories

    



      Partners

    










        Open Source
        










GitHub Sponsors
        Fund open source developers
      








The ReadME Project
        GitHub community articles
      




Repositories



      Topics

    



      Trending

    



      Collections

    








        Enterprise
        













Enterprise platform
        AI-powered developer platform
      




Available add-ons







Advanced Security
        Enterprise-grade security features
      







GitHub Copilot
        Enterprise-grade AI features
      







Premium Support
        Enterprise-grade 24/7 support
      







Pricing












Search or jump to...







Search code, repositories, users, issues, pull requests...

 




        Search
      













Clear
 
















































 




              Search syntax tips
 














        Provide feedback
      









 
We read every piece of feedback, and take your input very seriously.


Include my email address so I can be contacted


     Cancel

    Submit feedback










        Saved searches
      
Use saved searches to filter your results more quickly









 





Name






Query



            To see all available qualifiers, see our documentation.
          
 





     Cancel

    Create saved search








                Sign in
              


                Sign up
              
Reseting focus









You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.
 


Dismiss alert



















        rails
 
/

rails

Public





 

Notifications
 You must be signed in to change notification settings


 

Fork
    21.6k




 


          Star
 56k














Code







Issues
517






Pull requests
743






Discussions







Actions







Security







Insights



 

 


Additional navigation options


 










          Code











          Issues











          Pull requests











          Discussions











          Actions











          Security











          Insights






 













    
    New issue
  

 


 







Have a question about this project? Sign up for a free GitHub account to open an issue and contact its maintainers and the community.
  

    Sign up for GitHub


By clicking “Sign up for GitHub”, you agree to our terms of service and
  privacy statement. We’ll occasionally send you account related emails.

    Already on GitHub?
    Sign in
    to your account
  





Jump to bottom



[ci skip] Add warning about deduplication of after_xxx_commit shortcuts
#51184






 Merged



vipulnsward
  merged 1 commit into


  rails:main

from

ConfusedVorlon:document_after_commit_deduplication







 

Feb 25, 2024








 Merged





    [ci skip] Add warning about deduplication of after_xxx_commit shortcuts
  
#51184


vipulnsward
  merged 1 commit into


  rails:main

from

ConfusedVorlon:document_after_commit_deduplication







 

Feb 25, 2024















      Conversation

      7





      Commits

      1





  Checks

  3





      Files changed

    





 Conversation












 








      
            Copy link

 
 




Contributor






ConfusedVorlon


      

      commented


        Feb 25, 2024







Motivation / Background
I'm not the first person to be bitten by deduplication of after_xxx_commit shortcuts.
#40648
#51171
Detail
Adds documentation to warn about this.

















    Sorry, something went wrong.
  









 
All reactions




















 






 



Add warning about deduplication of after_xxx_commit shortcuts























79fa0e3






 











rails-bot
bot



          added
  the 

  activerecord

 label


      Feb 25, 2024










vipulnsward




          added
  the 

  docs

 label


      Feb 25, 2024









 Hide details
View details


vipulnsward



        merged commit 2abee30
      into

      

rails:main


Feb 25, 2024

        3 checks passed
      























 








      
            Copy link

 
 




Member





vipulnsward


      

      commented


        Feb 25, 2024









Thanks!














 
All reactions
























    Sorry, something went wrong.
  

 











zzak 

      added a commit
        to zzak/rails
      that referenced
      this pull request

    
May 23, 2024









 



Revert "Merge pull request rails#51184 from ConfusedVorlon/document_a…


…























d4150ab





…fter_commit_deduplication"

This reverts commit 2abee30, reversing
changes made to e34a0ee.

A warning on each method is excessive and the warning should already be covered under the guide:
https://edgeguides.rubyonrails.org/active_record_callbacks.html#transaction-callbacks












zzak 

      added a commit
        to zzak/rails
      that referenced
      this pull request

    
May 23, 2024









 



[7-2-stable] Revert "Merge pull request rails#51184 from ConfusedVorl…


…























11a9309





…on/document_after_commit_deduplication"

This reverts commit 2abee30, reversing
changes made to e34a0ee.

A warning on each method is excessive and the warning should already be covered under the guide:
https://edgeguides.rubyonrails.org/active_record_callbacks.html#transaction-callbacks
















 








      
            Copy link

 
 




Member





zzak


      

      commented


        May 23, 2024









This is already documented here:
https://edgeguides.rubyonrails.org/active_record_callbacks.html#transaction-callbacks

Using both after_create_commit and after_update_commit with the same method name will only allow the last callback defined to take effect, as they both internally alias to after_commit which overrides previously defined callbacks with the same method name.















 
All reactions
























    Sorry, something went wrong.
  

 













 








      
            Copy link

 
 




Contributor


Author





ConfusedVorlon


      

      commented


        May 23, 2024









@zzak So it is - however people don't necessarily check/remember that guide.
Indeed, this bit me because I was reading the method's docs, rather than thinking to check the overview guide for this.
Personally, I don't see any problem with duplicating a warning so that people can get the info at the method definition as well as if they RTM.














 
All reactions
























    Sorry, something went wrong.
  

 











zzak 

      added a commit
      that referenced
      this pull request

    
May 23, 2024









 



Merge pull request #51886 from zzak/revert-51184


…























95a6729





Revert "Merge pull request #51184 from ConfusedVorlon/document_after_commit_deduplication"












zzak 

      added a commit
      that referenced
      this pull request

    
May 23, 2024









 



Merge pull request #51887 from zzak/7-2-revert-51184


…























8af5082





[7-2-stable] Revert "Merge pull request #51184 from ConfusedVorlon/document_after_commit_deduplication"
















 








      
            Copy link

 
 




Member





zzak


      

      commented


        May 23, 2024









@ConfusedVorlon Thanks for your PR, and apologies for not getting feedback sooner.
I would prefer something in the form as I mentioned here: #51886 (comment)














 
All reactions
























    Sorry, something went wrong.
  

 













 








      
            Copy link

 
 




Contributor


Author





ConfusedVorlon


      

      commented


        May 23, 2024









I gotta say - this does not fill me with enthusiasm for trying to improve the docs.
I saw a problem, I offered a fix, it was merged.
Now you think that the red warning in the guide is sufficient - and you remove the warnings at the method definition.
If you think that's better - so be it.
To my mind - the big red warning in the guide only emphasises the need for warnings at the method definition.
Personally, I would suggest that if you want to improve the style of documentation after changes are committed, then a pull request would be a better solution than a revert.














 
All reactions
























    Sorry, something went wrong.
  

 













 








      
            Copy link

 
 




Member





zzak


      

      commented


        May 23, 2024









I disagree that there needs to be a warning at every method definition, but open to adding a note in the top-level ClassMethods overview.
This is consistent with the rest of our documentation, please show me if that is not the case.
As for the method naming, for example we use after_*_commit in the guides where we typically use wildcard notation for dynamic methods (See: Dirty).
It's on me because if I could have reviewed your PR sooner, I would have given you that guidance sooner and hopefully we could gain some momentum together.
If you want to submit the other PR feel free to ping me.














 
All reactions
























    Sorry, something went wrong.
  

 













 








      
            Copy link

 
 




Contributor


Author





ConfusedVorlon


      

      commented


        May 23, 2024

•




          edited
          
        











 Loading















If you want to submit the other PR feel free to ping me.

Nope. I'm done.
I'll remember this gotcha. The next person will have to find out the hard way.
btw - this wasn't submitted out of nowhere. I did ask for advice on format first.
#51171














 
All reactions
























    Sorry, something went wrong.
  

 













jjb



    mentioned this pull request
    
May 23, 2024





      debug test connection pool starts reaper in fork
      jjb/rails#2
 


 Closed
















4 tasks











zzak 

      added a commit
        to zzak/rails
      that referenced
      this pull request

    
May 31, 2024









 

 



Document callback deduplication with regards to ActiveRecord::Transac…


…























df97206





…tion

/cc rails#51184, rails#51171, rails#40648, rails#48910

Co-authored-by: Rob Jonson <rob@hobbyistsoftware.com>












zzak 

      added a commit
        to zzak/rails
      that referenced
      this pull request

    
May 31, 2024









 

 



Document callback deduplication with regards to ActiveRecord::Transac…


…























a2b9e92





…tion

/cc rails#51184, rails#51171, rails#40648, rails#48910

Co-authored-by: Rob Jonson <rob@hobbyistsoftware.com>












zzak 

      added a commit
      that referenced
      this pull request

    
May 31, 2024









 

 



Document callback deduplication with regards to ActiveRecord::Transac…


…























8820a67





…tion

/cc #51184, #51171, #40648, #48910

Co-authored-by: Rob Jonson <rob@hobbyistsoftware.com>












xjunior 

      pushed a commit
        to xjunior/rails
      that referenced
      this pull request

    
Jun 9, 2024









 

 



Revert "Merge pull request rails#51184 from ConfusedVorlon/document_a…


…















abb6185





…fter_commit_deduplication"

This reverts commit 2abee30, reversing
changes made to e34a0ee.

A warning on each method is excessive and the warning should already be covered under the guide:
https://edgeguides.rubyonrails.org/active_record_callbacks.html#transaction-callbacks












xjunior 

      pushed a commit
        to xjunior/rails
      that referenced
      this pull request

    
Jun 9, 2024









 

 

 



Document callback deduplication with regards to ActiveRecord::Transac…


…















ffd0ea5





…tion

/cc rails#51184, rails#51171, rails#40648, rails#48910

Co-authored-by: Rob Jonson <rob@hobbyistsoftware.com>












jianbo 

      pushed a commit
        to jianbo/fix-association-initialize-order
      that referenced
      this pull request

    
Jul 8, 2024









 



Revert "Merge pull request rails#51184 from ConfusedVorlon/document_a…


…














270e4b2





…fter_commit_deduplication"

This reverts commit 2abee30, reversing
changes made to e34a0ee.

A warning on each method is excessive and the warning should already be covered under the guide:
https://edgeguides.rubyonrails.org/active_record_callbacks.html#transaction-callbacks












jianbo 

      pushed a commit
        to jianbo/fix-association-initialize-order
      that referenced
      this pull request

    
Jul 8, 2024









 

 



Document callback deduplication with regards to ActiveRecord::Transac…


…














271f71a





…tion

/cc rails#51184, rails#51171, rails#40648, rails#48910

Co-authored-by: Rob Jonson <rob@hobbyistsoftware.com>












DanielaVelasquez 

      pushed a commit
        to DanielaVelasquez/rails
      that referenced
      this pull request

    
Oct 3, 2024









 

 



Revert "Merge pull request rails#51184 from ConfusedVorlon/document_a…


…














9f69340





…fter_commit_deduplication"

This reverts commit 2abee30, reversing
changes made to e34a0ee.

A warning on each method is excessive and the warning should already be covered under the guide:
https://edgeguides.rubyonrails.org/active_record_callbacks.html#transaction-callbacks












DanielaVelasquez 

      pushed a commit
        to DanielaVelasquez/rails
      that referenced
      this pull request

    
Oct 3, 2024









 

 

 



Document callback deduplication with regards to ActiveRecord::Transac…


…














ac87c16





…tion

/cc rails#51184, rails#51171, rails#40648, rails#48910

Co-authored-by: Rob Jonson <rob@hobbyistsoftware.com>










 




Sign up for free
to join this conversation on GitHub.
    Already have an account?
    Sign in to comment











    Reviewers
  


    No reviews





    Assignees
  

    No one assigned




    Labels
  


activerecord


docs






    Projects
  



    None yet


 



    Milestone
  

      No milestone








    Development
  
Successfully merging this pull request may close these issues.

 






      3 participants
    



 

 

 




 


Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.











Footer








        © 2024 GitHub, Inc.
      


Footer navigation


Terms


Privacy


Security


Status


Docs


Contact




      Manage cookies
    





      Do not share my personal information
    
















    You can’t perform that action at this time.

