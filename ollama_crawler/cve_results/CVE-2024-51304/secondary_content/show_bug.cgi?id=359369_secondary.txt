Title: 359369 – sys-kernel/gentoo-sources-2.6.38 - Synaptics Touchpad not found after resume suspend
URL: https://bugs.gentoo.org/show_bug.cgi?id=359369

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 359369
sys-kernel/gentoo-sources-2.6.38 - Synaptics Touchpad not found after resume suspend
Last modified: 2011-04-27 03:08:27 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 359369 
      - sys-kernel/gentoo-sources-2.6.38 - Synaptics Touchpad not found after resume suspend


Summary:
sys-kernel/gentoo-sources-2.6.38 - Synaptics Touchpad not found after resume ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Kernel Bug Wranglers and Kernel Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-03-18 13:59 UTC by Marko D





      Modified:
    
2011-04-27 03:08 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge info

              (emerge-info.txt,5.32 KB,
                text/plain)

            
2011-03-22 02:51 UTC,

            Marko D




Details





xorg.log

              (Xorg.0.log,28.00 KB,
                text/plain)

            
2011-03-22 02:51 UTC,

            Marko D




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Marko D





          2011-03-18 13:59:16 UTC
        

After updating the kernel from gentoo-sources-2.6.37-r2 to gentoo-sources-2.6.38, the system fails to resume completely after a suspend (close lid). 
The desktop env is Gnome. After re-opening the lid the Gnome login screen is restored, but not the keyboard and mouse. Last error in Xorg.log is
"Synaptics Touchpad: Read error No such device".
If the system is using kernel 2.6.37-r2 then the resume functionality is OK (keyboard and mouse device are restored correctly).
The graphic card driver is Nouveau from kernel (not the ebuild from portage) 

Reproducible: Always

Steps to Reproduce:
1. Boot using kernel 2.6.38
2. Login to a Gnome session
3. Suspend the system (using Gnome menu System -->Shut down --> Suspend or by closing the lid)
4. Wait for suspend to finish
5. Try to restore the system (open the lid)
Actual Results:  
Display is restored with Gnome login screen, but the login can not be used, because there is no keyboard or mouse 

Expected Results:  
Display should be restored with keyboard and mouse fully functional

The suspend functionality is fine with kernel 2.6.37-r2 (gentoo-sources). The .config file for kernel 2.6.38 was created by copying the .config file from kernel 2.6.37-r2 and running "make oldconfig".




Comment 1


SpanKY






          2011-03-19 03:39:07 UTC
        

does this happy every time ?  ive see this error once in a while for many versions (no idea when it started, or if it has always been this way).  i simply suspend/resume again to make it come up.




Comment 2


Marko D





          2011-03-19 21:31:21 UTC
        

Reproducible: Always




Comment 3


Jeroen Roovers (RETIRED)






          2011-03-22 00:22:08 UTC
        

1) Please post your `emerge --info' output in a comment.
1) Please attach the Xorg log.
1) If relevant, please attach the (relevant part of your) dmesg output.




Comment 4


Marko D





          2011-03-22 02:51:09 UTC
        

Created attachment 266789 [details]
emerge info




Comment 5


Marko D





          2011-03-22 02:51:44 UTC
        

Created attachment 266791 [details]
xorg.log




Comment 6


Marko D





          2011-03-22 03:13:55 UTC
        

Errors in dmesg:

1) not sure if is related, occurs before suspending the system:
------------[ cut here ]------------
WARNING: at kernel/printk.c:288 do_syslog+0x84/0x430()
Hardware name: E8410
Attempt to access syslog with CAP_SYS_ADMIN but no CAP_SYSLOG (deprecated).
Modules linked in: ext2 acpi_cpufreq freq_table mperf iwlagn pcmcia iwlcore sdhci_pci mac80211 e1000e cfg80211 rfkill firewire_ohci firewire_core yenta_socket ppdev pcmcia_rsrc sdhci mmc_core pcmcia_core crc_itu_t nouveau parport_pc parport video drm_kms_helper ttm drm
Pid: 2689, comm: syslog-ng Not tainted 2.6.38-gentoo.neptun #1
Call Trace:
 [<ffffffff8104114a>] ? warn_slowpath_common+0x78/0x8c
 [<ffffffff81118e70>] ? kmsg_release+0x0/0x1b
 [<ffffffff810411ff>] ? warn_slowpath_fmt+0x45/0x4a
 [<ffffffff810416cb>] ? do_syslog+0x84/0x430
 [<ffffffff81035c1d>] ? need_resched+0x1a/0x23
 [<ffffffff81035c2b>] ? should_resched+0x5/0x24
 [<ffffffff8141d100>] ? _cond_resched+0x9/0x20
 [<ffffffff810c1560>] ? arch_local_irq_save+0x12/0x1b
 [<ffffffff81118e70>] ? kmsg_release+0x0/0x1b
 [<ffffffff811105b4>] ? proc_reg_open+0x8b/0x11f
 [<ffffffff81110529>] ? proc_reg_open+0x0/0x11f
 [<ffffffff810cbc23>] ? __dentry_open+0x123/0x252
 [<ffffffff810d4c33>] ? dget+0x12/0x1d
 [<ffffffff810d7b70>] ? finish_open+0x97/0x159
 [<ffffffff810d6db9>] ? do_path_lookup+0xdf/0x107
 [<ffffffff810d808f>] ? do_filp_open+0x16f/0x601
 [<ffffffff81035c1d>] ? need_resched+0x1a/0x23
 [<ffffffff81035c2b>] ? should_resched+0x5/0x24
 [<ffffffff8141d100>] ? _cond_resched+0x9/0x20
 [<ffffffff81035c1d>] ? need_resched+0x1a/0x23
 [<ffffffff81035c2b>] ? should_resched+0x5/0x24
 [<ffffffff81035c1d>] ? need_resched+0x1a/0x23
 [<ffffffff81035c2b>] ? should_resched+0x5/0x24
 [<ffffffff810e1672>] ? alloc_fd+0x69/0x10f
 [<ffffffff810cc9d9>] ? do_sys_open+0x56/0xdd
 [<ffffffff810098d2>] ? system_call_fastpath+0x16/0x1b
---[ end trace 8a8c3d5d5ceccaa3 ]---


2) After resume from suspend (can not access system directly, only using ssh):
i8042: failed to resume active multiplexor, mouse won't work
...
psmouse.c: Failed to deactivate mouse on isa0060/serio4
psmouse.c: Failed to enable mouse on isa0060/serio4 

The only error is at the end of Xorg.0.log file;
 Synaptics Touchpad: Read error No such device

The system has luks on root partition and on swap partition. /boot partition is not encrypted.




Comment 7


Marko D





          2011-04-17 01:52:41 UTC
        

Problem fixed with a kernel parameter: i8042.nomux=1




Comment 8


Stratos Psomadakis (RETIRED)






          2011-04-21 12:33:28 UTC
        

I think this can be closed as "RESOLVED WORKSFORME".
The i8042.nomux seems to be a known workaround for several issues with touchpads.

This bug could be a 'minor regression' in 2.6.38 suspend/resume code mabye, but since there is a workaround, I think it can be closed.




Comment 9


Marko D





          2011-04-27 03:08:27 UTC
        

Maybe this issue could be reported upstream, so the driver maintainer(s) would be aware of it ?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

