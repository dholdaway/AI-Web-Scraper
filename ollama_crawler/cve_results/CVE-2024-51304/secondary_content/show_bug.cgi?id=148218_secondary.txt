Title: 148218 – www-client/mozilla-firefox-1.5.0.7 doesn't compile
URL: https://bugs.gentoo.org/show_bug.cgi?id=148218

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 148218
www-client/mozilla-firefox-1.5.0.7 doesn't compile
Last modified: 2007-01-05 17:20:31 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 148218 
      - www-client/mozilla-firefox-1.5.0.7 doesn't compile


Summary:
www-client/mozilla-firefox-1.5.0.7 doesn't compile
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

148215

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2006-09-19 10:07 UTC by Erik Logtenberg





      Modified:
    
2007-01-05 17:20 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Output of emerge --info

              (emerge-info.log,2.76 KB,
                text/plain)

            
2006-09-19 10:08 UTC,

            Erik Logtenberg




Details





Strace (-f) log of emerge mozilla-firefox

              (emerge-strace.log,3.16 KB,
                text/plain)

            
2006-09-20 11:56 UTC,

            Erik Logtenberg




Details





# strace -f emerge --oneshot dev-libs/nss > strace.log 2>&1

              (strace.log.bz2,378.35 KB,
                text/plain)

            
2006-10-08 10:14 UTC,

            Erik Logtenberg




Details





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Erik Logtenberg





          2006-09-19 10:07:33 UTC
        

When compiling www-client/mozilla-firefox-1.5.0.7 with gcc-4.1.1 (sys-devel/gcc-4.1.1), emerge fails very early in the process. Even before it really begins compiling. I'm using the default-linux/x86/2006.1 profile.

Output of emerge www-client/mozilla-firefox is as follows:

>>> Emerging (1 of 1) www-client/mozilla-firefox-1.5.0.7 to /
 * firefox-1.5.0.7-source.tar.bz2 MD5 ;-) ...                                                                                                                                                
(...)
 * checking firefox-nl-1.5.0.7.xpi ;-) ...                                                                                                                                                   
>>> Unpacking source...
>>> Unpacking firefox-1.5.0.7-source.tar.bz2 to /var/tmp/portage/mozilla-firefox-1.5.0.7/work
>>> Unpacking mozilla-firefox-1.5.0.7-patches-0.1.tar.bz2 to /var/tmp/portage/mozilla-firefox-1.5.0.7/work
 * Unpacking firefox-nl-1.5.0.7.xpi to /var/tmp/portage/mozilla-firefox-1.5.0.7/work
 * Applying various patches (bugfixes/updates) ...
 *   000_flex-configure-LANG.patch ...                                                                                                                                                       
(...)
 *   300_firefox-1.5-makeopts.patch ...                                                                                                                                                      
 * Done with patching
 * Running eautoreconf in '/var/tmp/portage/mozilla-firefox-1.5.0.7/work/mozilla' ...
 * Running autoconf ...                                                                                                                                                                      
>>> Source unpacked.
>>> Compiling source in /var/tmp/portage/mozilla-firefox-1.5.0.7/work/mozilla ...

==========================================================
Building mozilla-firefox-1.5.0.7 with the following configuration
==========================================================

./configure --prefix=/usr --host=i686-pc-linux-gnu --mandir=/usr/share/man --infodir=/usr/share/info --datadir=/usr/share --sysconfdir=/etc --localstatedir=/var/lib --build=i686-pc-linux-gnu

!!! ERROR: www-client/mozilla-firefox-1.5.0.7 failed.
Call stack:
  , line 1546:   Called dyn_compile
  , line 937:   Called src_compile
  , line 167:   Called econf
  , line 540:   Called die

!!! econf failed
!!! If you need support, post the topmost build error, and the call stack if relevant.


I'm not sure if this is enough information to actually trace the problem. I know the mere combination of www-client/mozilla-firefox-1.5.0.7, gcc-4.1.1, 2006.1, Pentium 4 is not enough to reproduce the error, since this very same combination is up and running on one of my other workstations.
For your information I also copy/paste my emerge --info output to an attachment. Please tell me what other information you may need to trace the error, so I can collect it for you.
I placed this bugreport with 'GCC Porting', as this problem began when I ran "emerge -e world" as part of the migration to gcc-4.1.1 (from gcc-3.4.6). Before that, firefox compiled fine.

Kind regards,

Erik Logtenberg.




Comment 1


Erik Logtenberg





          2006-09-19 10:08:32 UTC
        

Created attachment 97436 [details]
Output of emerge --info

This is the output of emerge --info on my system.




Comment 2


SpanKY






          2006-09-19 10:46:49 UTC
        

firefox-1.5.0.7 certainly builds with gcc-4.1.1; something else is wrong on your system




Comment 3


Erik Logtenberg





          2006-09-19 11:32:28 UTC
        

That is certainly true. Any ideas on how I can gather more information on this issue so it can be tracked down?

I do believe the upgrade to gcc-4.1.1 has something to do with it, since firefox (and thunderbird and enigmail) have stopped compiling during the "emerge -e world" that was part of the migrationprocess.

However this seems to happen only in certain circumstances. Does my "emerge --info" output provide enough information on these circumstances for anyone to be able to reproduce it?





Comment 4


SpanKY






          2006-09-19 12:01:05 UTC
        

post the actual build errors




Comment 5


Erik Logtenberg





          2006-09-20 01:21:43 UTC
        

How do I get to see 'the actual build errors'? I pasted the output of emerge literally, except where the (...) are.
You see that the "!!! ERROR: www-client/mozilla-firefox-1.5.0.7 failed." line follows directly after the "./configure --prefix=/usr --host=i686-pc-linux-gnu --mandir=/usr/share/man --infodir=/usr/share/info --datadir=/usr/share --sysconfdir=/etc --localstatedir=/var/lib --build=i686-pc-linux-gnu" part. There is no configure output that I left out, it simply returns the error before it actually seems to begin configuring.





Comment 6


Jakub Moc (RETIRED)






          2006-09-20 02:47:15 UTC
        

*** Bug 148215 has been marked as a duplicate of this bug. ***




Comment 7


Jakub Moc (RETIRED)






          2006-09-20 02:48:48 UTC
        

Your system appears to have completely messed up autotools or whatnot, this has nothing to do w/ gcc version nor w/ firefox (same with Bug 148215)




Comment 8


Erik Logtenberg





          2006-09-20 03:09:38 UTC
        

That may be true, but I can still compile any other package that I want. Even if gcc-4.1.1 is not the cause of this bug, it's still a fact that I was able to compile firefox before I upgraded to gcc-4.1.1, and during upgrade to gcc-4.1.1. it stopped working.

I followed the steps in the howto:
1) Use gcc-config to select gcc-4.1.1 (and do source /etc/profile)
2) emerge libtool
3) emerge -e system
4) emerge -e world
With step 4, firefox, thunderbird and libstdc++-v3 didn't compile. I used 'emerge --resume --skipfirst' for each of them, which continued fine.
5) build a new kernel
6) reboot
After reboot, I tried again if I could emerge firefox and/or thunderbird, which was still not the case.
At this moment I'm still using the firefox that has been compiled with gcc-3.4.6 and this still works like a charm. However I would like to upgrade firefox to the latest version, since there are some security issues with the version I still use. Therefore I'd like to be able to compile it again.

Do you have any thoughts on how I can assert which package is messed up, and how to fix this?
And how it is possible that I can still compile any other package?






Comment 9


Erik Logtenberg





          2006-09-20 11:35:55 UTC
        

> Your system appears to have completely messed up autotools or whatnot

Could you try to specify the "whatnot" please? I checked autotoolset, and it's not even installed on my system. I tried installing dev-util/autotoolset-0.11.4-r1 (and installed app-arch/sharutils-4.2.1-r11 as a dependancy). Although emerge'ing autotoolset works fine, it didn't fix the firefox issue.





Comment 10


Erik Logtenberg





          2006-09-20 11:56:08 UTC
        

Created attachment 97567 [details]
Strace (-f) log of emerge mozilla-firefox

This is a snippet from the strace log. I think this is where it goes wrong. It shows the "/configure ..."-line and the "!!! ERROR..."-line.

You can see stuff like:
[pid 20092] <... getpeername resumed> 0xbf937044, [128]) = -1 ENOTCONN (Transport endpoint is not connected)
[pid 19971] <... rt_sigprocmask resumed> [], 8) = 0
[pid 20092] write(3, "\25\3\1\0 /\10}X\246\27\343e\202\2656T\371*\261\235\370"..., 37 <unfinished ...>

in there. There's already a lot of this above the "./configure"-line, so maybe the fault is has already occurred earlier on.
I'd like your opinion on this.




Comment 11


SpanKY






          2006-09-23 03:00:29 UTC
        

go into the portage dir and run ./configure yourself with the same options and see what happens




Comment 12


Erik Logtenberg





          2006-09-24 01:03:42 UTC
        

Okay, I tried running that ./configure statement manually, and guess what.. it works like a charm.

Moreover, I've found out that when I run the emerge process step by step, as follows:

# ebuild /usr/portage/www-client/mozilla-firefox/mozilla-firefox-1.5.0.7.ebuild unpack
# ebuild /usr/portage/www-client/mozilla-firefox/mozilla-firefox-1.5.0.7.ebuild compile
# ebuild /usr/portage/www-client/mozilla-firefox/mozilla-firefox-1.5.0.7.ebuild install
# ebuild /usr/portage/www-client/mozilla-firefox/mozilla-firefox-1.5.0.7.ebuild qmerge

Then it compiles and merges just fine!
However when I attempt to use 'emerge' like so:
# emerge mozilla-firefox
it fails, as described in the posts above.

I notice the same issue with libstdc++-v3.





Comment 13


SpanKY






          2006-10-07 17:50:47 UTC
        

pust the full strace; you snipped too much




Comment 14


Erik Logtenberg





          2006-10-08 10:14:37 UTC
        

Created attachment 99140 [details]
# strace -f emerge --oneshot dev-libs/nss > strace.log 2>&1




Comment 15


Erik Logtenberg





          2006-10-08 10:20:49 UTC
        

Hi,

The problem seems to be more a portage-issue than a Firefox issue. The same thing happens for instance to dev-libs/nss. When I run a "emerge -uD --newuse world", most packages compile fine, but some do not. dev-libs/nss is one of them. To show this, I've attached the output of:

# strace -f emerge --oneshot dev-libs/nss > strace.log 2>&1

Please note that I'm perfectly able to get dev-libs/nss installed by using the 'ebuild' tool, and stepping through compile, install and qmerge manually:

# ebuild /usr/portage/dev-libs/nss/nss-3.11.3-r1.ebuild compile
# ebuild /usr/portage/dev-libs/nss/nss-3.11.3-r1.ebuild install
# ebuild /usr/portage/dev-libs/nss/nss-3.11.3-r1.ebuild qmerge

And voila, it's installed just fine.
Exactly the same thing with mozilla-firefox and a couple of other packages, and perfectly reproducable. It only affects a small portion of packages, most don't have this problem.
(Perhaps "Applications" isn't quite the right Component for this bug?)

Kind regards,

Erik Logtenberg.





Comment 16


Jory A. Pratt





          2006-12-24 08:02:49 UTC
        

(In reply to comment #15)
> Hi,
> 
> The problem seems to be more a portage-issue than a Firefox issue. The same
> thing happens for instance to dev-libs/nss. When I run a "emerge -uD --newuse
> world", most packages compile fine, but some do not. dev-libs/nss is one of
> them. To show this, I've attached the output of:
> 
> # strace -f emerge --oneshot dev-libs/nss > strace.log 2>&1
> 
> Please note that I'm perfectly able to get dev-libs/nss installed by using the
> 'ebuild' tool, and stepping through compile, install and qmerge manually:
> 
> # ebuild /usr/portage/dev-libs/nss/nss-3.11.3-r1.ebuild compile
> # ebuild /usr/portage/dev-libs/nss/nss-3.11.3-r1.ebuild install
> # ebuild /usr/portage/dev-libs/nss/nss-3.11.3-r1.ebuild qmerge
> 
> And voila, it's installed just fine.
> Exactly the same thing with mozilla-firefox and a couple of other packages, and
> perfectly reproducable. It only affects a small portion of packages, most don't
> have this problem.
> (Perhaps "Applications" isn't quite the right Component for this bug?)
> 
> Kind regards,
> 
> Erik Logtenberg.
> 


I am not sure what you expect gentoo to do here. It works fine for all of us. I suggest closing bug wfm, unless a dev can actually dupilicate this bug.






Comment 17


Elfyn McBratney (beu) (RETIRED)






          2007-01-05 17:20:31 UTC
        

Resolving WORKSFORME as per comment #16 - please provide additional information to reproduce this.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

