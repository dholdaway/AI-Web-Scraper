Title: 103859 – dev-libs/libpcre-6.3 fails to compile on PPC
URL: https://bugs.gentoo.org/show_bug.cgi?id=103859

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 103859
dev-libs/libpcre-6.3 fails to compile on PPC
Last modified: 2005-09-13 07:46:59 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 103859 
      - dev-libs/libpcre-6.3 fails to compile on PPC


Summary:
dev-libs/libpcre-6.3 fails to compile on PPC
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

PPC
        Linux
      







Importance:
      
High
       normal
      


Assignee:

PPC Porters








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-08-26 15:25 UTC by Neil Bothwick





      Modified:
    
2005-09-13 07:46 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge log

              (3694-libpcre-6.3.log,26.25 KB,
                text/plain)

            
2005-08-26 15:32 UTC,

            Neil Bothwick




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Neil Bothwick





          2005-08-26 15:25:30 UTC
        

dev-libs/libpcre-6.3 fails to compile on on my iBook G4. 
This library is the subject of GLSA 200508-17, updating it is a priority. 

Reproducible: Always
Steps to Reproduce:
1. emerge libpcre -avu  
2.  
3.  
  
Actual Results:  
powerpc-unknown-linux-gnu-g++ -shared 
-nostdlib /usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/../../../crti.o /usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/crtbeginS.o  .libs/pcrecpp.o .libs/pcre_scanner.o .libs/pcre_stringpiece.o  
-Wl,--rpath -Wl,/mnt/scratch/portage/libpcre-6.3/work/pcre-6.3/.libs 
-Wl,--rpath -Wl,/usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4 -Wl,--rpath 
-Wl,/usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4 ./.libs/libpcre.so 
-L/mnt/scratch/portage/libpcre-6.3/work/pcre-6.3 
-L/mnt/scratch/portage/libpcre-6.3/work/pcre-6.3/.libs 
-L/usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4 
-L/usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/../../../../powerpc-unknown-linux-gnu/lib 
-L/usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/../../.. /usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/libstdc++.so 
-L/usr/powerpc-unknown-linux-gnu/bin -L/usr/powerpc-unknown-linux-gnu/lib 
-L/usr/lib/gcc/powerpc-unknown-linux-gnu/../../../powerpc-unknown-linux-gnu/lib 
-lm -lc 
-lgcc_s /usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/crtsavres.o /usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/crtendS.o /usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/../../../crtn.o  
-Wl,-soname -Wl,libpcrecpp.so.0 -o .libs/libpcrecpp.so.0.0.0 
(cd .libs && rm -f libpcrecpp.so.0 && ln -s libpcrecpp.so.0.0.0 
libpcrecpp.so.0) 
(cd .libs && rm -f libpcrecpp.so && ln -s libpcrecpp.so.0.0.0 libpcrecpp.so) 
powerpc-unknown-linux-gnu-ar cru .libs/libpcrecpp.a  pcrecpp.o pcre_scanner.o 
pcre_stringpiece.o 
powerpc-unknown-linux-gnu-ranlib .libs/libpcrecpp.a 
creating libpcrecpp.la 
(cd .libs && rm -f libpcrecpp.la && ln -s ../libpcrecpp.la libpcrecpp.la) 
powerpc-unknown-linux-gnu-g++ -c -O2 -mcpu=G4 -fno-strict-aliasing 
-fomit-frame-pointer -pipe -fPIC -I. -I. -DSUPPORT_UTF8   ./pcrecpp_unittest.cc 
/bin/sh ./libtool --mode=link powerpc-unknown-linux-gnu-g++  -I. -I.   -o 
pcrecpp_unittest  pcrecpp_unittest.o \ 
        libpcrecpp.la libpcreposix.la 
powerpc-unknown-linux-gnu-g++ -I. -I. -o .libs/pcrecpp_unittest 
pcrecpp_unittest.o  ./.libs/libpcrecpp.so 
-L/mnt/scratch/portage/libpcre-6.3/work/pcre-6.3 
-L/mnt/scratch/portage/libpcre-6.3/work/pcre-6.3/.libs /usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/libstdc++.so 
-L/usr/powerpc-unknown-linux-gnu/bin -L/usr/powerpc-unknown-linux-gnu/lib 
-L/usr/lib/gcc/powerpc-unknown-linux-gnu/../../../powerpc-unknown-linux-gnu/lib ./.libs/libpcreposix.so /mnt/scratch/portage/libpcre-6.3/work/pcre-6.3/.libs/libpcre.so 
-Wl,--rpath -Wl,/usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4 
pcrecpp_unittest.o: file not recognized: File format not recognized 
collect2: ld returned 1 exit status 
make: *** [pcrecpp_unittest] Error 1 
 
!!! ERROR: dev-libs/libpcre-6.3 failed. 
!!! Function src_compile, Line 38, Exitcode 2 
!!! (no error message) 
!!! If you need support, post the topmost build error, NOT this status message. 
 
 

Expected Results:  
compiled and merged  

Portage 2.0.51.22-r2 (default-linux/ppc/2005.0, gcc-3.4.4, glibc-2.3.5-r0, 
2.6.12-gentoo-r9 ppc) 
================================================================= 
System uname: 2.6.12-gentoo-r9 ppc 7447A, altivec supported 
Gentoo Base System version 1.12.0_pre6 
ccache version 2.4 [enabled] 
dev-lang/python:     2.4.1-r1 
sys-apps/sandbox:    1.2.12 
sys-devel/autoconf:  2.13, 2.59-r7 
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6 
sys-devel/binutils:  2.16.1 
sys-devel/libtool:   1.5.18-r1 
virtual/os-headers:  2.6.11-r2 
ACCEPT_KEYWORDS="ppc ~ppc" 
AUTOCLEAN="yes" 
CBUILD="powerpc-unknown-linux-gnu" 
CFLAGS="-O2 -mcpu=G4 -fno-strict-aliasing -fomit-frame-pointer -pipe" 
CHOST="powerpc-unknown-linux-gnu" 
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/share/config /var/qmail/control" 
CONFIG_PROTECT_MASK="/etc/gconf /etc/init.d /etc/terminfo /etc/texmf/web2c /etc/env.d" 
CXXFLAGS="-O2 -mcpu=G4 -fno-strict-aliasing -fomit-frame-pointer -pipe" 
DISTDIR="/mnt/portage/distfiles" 
FEATURES="autoconfig buildpkg ccache distlocks sandbox sfperms strict" 
GENTOO_MIRRORS="ftp://gentoo.digimed.co.uk/ 
http://pandemonium.tiscali.de/pub/gentoo/ http://mir.zyrianes.net/gentoo/ 
ftp://mir.zyrianes.net/gentoo/ ftp://mirror.nutsmaas.nl/gentoo" 
LINGUAS="en_GB" 
PKGDIR="/mnt/portage/packages/krikkit" 
PORTAGE_TMPDIR="/mnt/scratch" 
PORTDIR="/usr/portage" 
PORTDIR_OVERLAY="/mnt/portage/local" 
SYNC="rsync://desiato/gentoo" 
USE="ppc X alsa altivec arts berkdb bitmap-fonts bonobo cddb cdr crypt cups 
curl dv dvd emboss encode exif fam flac foomaticdb gdbm gif gimpprint gphoto2 
gpm gstreamer gtk gtk2 gtkhtml guile hal ieee1394 imagemagick imlib java jpeg 
kde kdeenablefinal libwww mad motif mp3 mpeg mysql ncurses offensive ogg 
oggvorbis opengl pdflib perl png ppds python qt readline sdl slang speex spell 
ssl tcltk tcpd tetex tiff truetype truetype-fonts type1-fonts unicode usb 
vhosts vorbis wifi xml xml2 xmms xv zlib linguas_en_GB userland_GNU 
kernel_linux elibc_glibc" 
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, MAKEOPTS




Comment 1


Neil Bothwick





          2005-08-26 15:32:54 UTC
        

Created attachment 66942 [details]
emerge log




Comment 2


Jeremy Huddleston (RETIRED)






          2005-08-29 00:51:57 UTC
        

Can youu try MAKEOPTS=-j1




Comment 3


Neil Bothwick





          2005-08-29 02:31:28 UTC
        

That doesn't help, it aborts with the same error. 
 
I tried unpacking the tarball and doing "./configure && make" and it worked. 
So I tried unpacking the archive with "ebuild xxx unpack", then going into the 
directory it created and running "./configure && make", it worked again. 
However, "ebuild xxx compile" failed. 
 
Here's the output from unpack 
 
>>> Unpacking source... 
>>> Unpacking pcre-6.3.tar.bz2 to /mnt/scratch/portage/libpcre-6.3/work 
 * Applying pcre-6.3-uclibc-tuple.patch ...           [ ok ] 
 * Applying pcre-6.3-link.patch ...                   [ ok ] 
 * TODO: Fix this bad -fPIC handling 
 * Patching ${S}/ltmain.sh ... 
 *   Portage patch seems to be already applied. 
 *   Please verify that it is not needed. 
 *   Applying sed-1.5.6.patch ... 
 * Applying uClibc/libtool patches ... 
>>> Source unpacked. 
 
Hope this helps 
 




Comment 4


Michael Hanselmann (hansmi) (RETIRED)






          2005-08-29 02:40:02 UTC
        

Can you please run "file pcrecpp_unittest.o" after the compilation failed?




Comment 5


Neil Bothwick





          2005-08-29 11:05:56 UTC
        

I would, but I just did an emerge world -uavDN and it merged fine. Here's what 
I've emerged since the previous failure 
 
     Mon Aug 29 12:09:56 2005 >>> sys-devel/gcc-3.4.4-r1 
     Mon Aug 29 12:31:00 2005 >>> app-portage/eix-0.3.0 
     Mon Aug 29 12:34:02 2005 >>> dev-util/pkgconfig-0.19 
     Mon Aug 29 13:00:36 2005 >>> media-libs/libsdl-1.2.9 
     Mon Aug 29 13:11:25 2005 >>> media-video/mplayer-1.0_pre7-r1 
     Mon Aug 29 13:11:58 2005 >>> media-sound/abcde-2.3.0 
     Mon Aug 29 18:42:46 2005 >>> sys-devel/binutils-config-1.8-r5 
     Mon Aug 29 18:45:39 2005 >>> dev-libs/libpcre-6.3 
 
 




Comment 6


Joe Jezak (RETIRED)






          2005-09-13 07:46:59 UTC
        

I can't reproduce this, please reopen if anyone is still having a problem.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

