Title: 110182 – squid-2.5.11 cannot emerge
URL: https://bugs.gentoo.org/show_bug.cgi?id=110182

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 110182
squid-2.5.11 cannot emerge
Last modified: 2006-02-27 20:48:42 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 110182 
      - squid-2.5.11 cannot emerge


Summary:
squid-2.5.11 cannot emerge
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Network Proxy Developers (OBSOLETE)








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

110188

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2005-10-22 18:53 UTC by Anton Koinov





      Modified:
    
2006-02-27 20:48 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Anton Koinov





          2005-10-22 18:53:11 UTC
        

Gettig the following errors trying to emerge squid:

>>> md5 files   ;-) squid-2.5.10-r2.ebuild
>>> md5 files   ;-) squid-2.5.10-r4.ebuild
>>> md5 files   ;-) squid-2.5.11.ebuild
>>> md5 files   ;-) files/squid.confd
>>> md5 files   ;-) files/squid.initd
>>> md5 files   ;-) files/squid.cron
>>> md5 files   ;-) files/digest-squid-2.5.11
>>> md5 files   ;-) files/digest-squid-2.5.10-r2
>>> md5 files   ;-) files/digest-squid-2.5.10-r4
>>> md5 files   ;-) files/squid.pam
>>> md5 files   ;-) files/squid-logrotate
>>> md5 files   ;-) files/squid.pam-include
>>> md5 src_uri ;-) squid-2.5.STABLE11.tar.gz
>>> md5 src_uri ;-) squid-2.5.STABLE11-patches-20051019.tar.gz
>>> Unpacking source...
>>> Unpacking squid-2.5.STABLE11.tar.gz to /var/tmp/portage/squid-2.5.11/work
>>> Unpacking squid-2.5.STABLE11-patches-20051019.tar.gz to
/var/tmp/portage/squid-2.5.11/work
 * Applying various patches (bugfixes/updates) ...
 *   01_all_squid-2.5.STABLE11-delaypools_truncated.patch ...                  
                                                                               
                         [ ok ]
 *   02_all_squid-2.5.STABLE11-tcp_outgoing_xxx.patch ...                      
                                                                               
                         [ ok ]
 *   03_all_squid-2.5.STABLE11-ldap_auth.patch ...                             
                                                                               
                         [ ok ]
 *   04_all_squid-2.5.STABLE11.accel_single_host_pconn.patch ...               
                                                                               
                         [ ok ]
 *   05_all_squid-2.5.STABLE11-CACHE_HTTP_PORT.patch ...                       
                                                                               
                         [ ok ]
 *   06_all_squid-2.5.STABLE11-CNAME.patch ...                                 
                                                                               
                         [ ok ]
 *   07_all_squid-2.5.STABLE11-httpd_accel-internal.patch ...                  
                                                                               
                         [ ok ]
 *   08_all_squid-2.5.STABLE11-IMS-HEAD.patch ...                              
                                                                               
                         [ ok ]
 *   09_all_squid-2.5.STABLE11-redirect-CONNECT.patch ...                      
                                                                               
                         [ ok ]
 *   10_all_squid-2.5.STABLE11-setcookie.patch ...                             
                                                                               
                         [ ok ]
 *   11_all_squid-2.5.STABLE11-rfc1738_do_escape.patch ...                     
                                                                               
                         [ ok ]
 *   80_all_squid-2.5.9-gentoo.patch ...                                       
                                                                               
                         [ ok ]
 * Done with patching
configure.in:1372: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1468: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1469: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1470: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1471: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1472: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1473: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1474: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1475: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1476: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1477: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1478: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1479: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1480: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1481: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1482: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1869: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1898: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1922: warning: AC_TRY_RUN called without default to allow cross
compiling
autoconf: Undefined macros:

!!! ERROR: net-proxy/squid-2.5.11 failed.
!!! Function src_unpack, Line 62, Exitcode 1
!!! autoconf failed
!!! If you need support, post the topmost build error, NOT this status message.

Reproducible: Always
Steps to Reproduce:
1. emerge squid

Actual Results:  
error shown above

Expected Results:  
emerge without errors

Portage 2.0.51.22-r3 (default-linux/x86/2005.0, gcc-3.3.6, glibc-2.3.5-r2,
2.6.12-gentoo-r10 i686)
=================================================================
System uname: 2.6.12-gentoo-r10 i686 AMD Athlon(tm) Processor
Gentoo Base System version 1.6.13
dev-lang/python:     2.3.5-r2, 2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.20
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=i686 -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/share/config /var/bind /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/init.d /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=i686 -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org
http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X acl apache2 apm arts avi bash-completion berkdb bitmap-fonts cdr
crypt cups curl dvd dvdr eds emboss encode fam foomaticdb gd gdbm gif gpm
gstreamer imagemagick imap imlib jpeg libg++ libwww mad maildir mikmod mp3 mpeg
mysql ncurses nls nptl nptlonly ogg oss pam pcre pdflib perl png python quotas
radeon readline samba sasl sdl spell ssl tcpd tiff truetype truetype-fonts
type1-fonts udev vorbis winbind xml2 xmms zlib userland_GNU kernel_linux
elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


Jakub Moc (RETIRED)






          2005-10-23 02:09:34 UTC
        

@net-proxy herd: Please remove cyfred from metadata.xml wrt Bug 98273.




Comment 2


Alin Năstac (RETIRED)






          2005-10-25 13:06:23 UTC
        

cyfred has been removed from metadata.xml

what is the output of "equery list autoconf" command?




Comment 3


Anton Koinov





          2005-10-25 21:55:15 UTC
        

# equery list autoconf
[ Searching for package 'autoconf' in all categories among: ]
 * installed packages
[I--] [  ] sys-devel/autoconf-wrapper-3-r1 (0)
[I--] [  ] sys-devel/autoconf-2.59-r6 (2.5)
[I--] [  ] sys-devel/autoconf-2.13 (2.1)

Just to be sure, re-emerged all three packages listed above, still getting the
same error.




Comment 4


Alin Năstac (RETIRED)






          2005-10-27 03:44:24 UTC
        

I've updated my machine to the lastest stable packages and still I'm unable to
reproduce this.




Comment 5


Anton Koinov





          2005-10-28 21:07:39 UTC
        

Well, this is the problem. I have been having this problem on several machines I
have installed in the last year or so. All starts OK, until one day the emerge
no longer works. Something gets broken after system updates.

I tried to play with the USE flags and compiler settings, the end result is the
same. Something gets messed up, but I do not know what.

How do I do my system updates. I emerge sync every weekend and then emerge -uD
world. Can you try emerge -uD --newuse world to see if that brakes your
configuration?

I greatly suspect that this problem is the same as in bug 110188. I have tried
emerging squid on my desktop and got the same error.

As I mentioned in the other bug, I do not have experience with autoconf, but do
not mind digging into this if you give me some directions.




Comment 6


Alin Năstac (RETIRED)






          2005-10-29 00:20:57 UTC
        

The error seems to be sys-devel/m4's fault.

Try "emerge --oneshot sys-devel/m4". 
If isn't working try running "perl-cleaner all".
If still isn't working try "emerge --oneshot =sys-devel/autoconf-2.13".






Comment 7


Anton Koinov





          2005-10-29 12:04:56 UTC
        

did all three, still the same problem.

Is there a way to get the name of the missing macro? Or maybe a way to enable
debug output for autoconf and m4?




Comment 8


Alin Năstac (RETIRED)






          2005-10-31 20:39:07 UTC
        

this is the stunning part! normally it should output the names of the undefined
macros.

I suggest you to find all m4 files in /usr/share (find /usr/share -iname
'*.m4'), find the associated ebuild for every file (equery belongs
$parentdirectory), remove those directories and re-emerge the associated ebuilds.

Be carefull! You should remove files from one ebuild at a time, for avoiding
disasters like removing foo's files which are required by bar ebuild.




Comment 9


Anton Koinov





          2005-11-02 23:13:36 UTC
        

This is what I did:

1. Found all m4 files as described
2. Identified the packages they belong to
3. For each package, deleted its m4 files and then reemerged

Still no go, same error.

If you think it would make a difference, in step (3) I can delete all files
returned by 'emerge files package', instead of just the m4 files.




Comment 10


Alin Năstac (RETIRED)






          2005-11-02 23:30:56 UTC
        

base-system guys, I need help from you. 
I don't know anything else that might help.




Comment 11


Alin Năstac (RETIRED)






          2005-11-03 21:25:33 UTC
        

I forgot to tell you to run revdep-rebuild. 




Comment 12


Anton Koinov





          2005-11-03 23:17:04 UTC
        

I run revdep-rebuild regularly after a system update.

Ran it again, nothing to rebuild. Still the same problem.

Is there a way to run autoconf manually and trace the execution?




Comment 13


Alin Năstac (RETIRED)






          2005-12-08 15:34:01 UTC
        

(In reply to comment #5)
> How do I do my system updates. I emerge sync every weekend and then emerge -uD
> world. Can you try emerge -uD --newuse world to see if that brakes your
> configuration?

For more than 2 years I update my boxes using emerge -uDN world and I didn't
managed to irreparably bork any system of mine. I had my share of problems, but
usually it was my fault.

(In reply to comment #12)
> Is there a way to run autoconf manually and trace the execution?

You could run autoconf in ${S} by yourself:
   WANT_AUTOCONF=2.1 autoconf
Does it work this way?

last resort: emerge -e system && emerge -e world 
Given the latest gcc update, it may be the safest thing to do.






Comment 14


Anton Koinov





          2005-12-15 11:06:30 UTC
        

I agree this is really strange. Before I submitted this bug report, I have
searched the bugs, the forums, and the web, and I could not find any mention of
the same problem. I can only suspect this is a rare one.

At the same time, all the systems I installed over the last year and a half, all
ended up with the same problem. Not sure whether I am doing something wrong, or
I use a strange combination of USE flags, but this problem existed on all of my
Gentoo systems, which all had very different hardware, and two very different
setups (server and desktop).

I have tried the suggestions from the previous post, same result. Running
autoconf, I get the same errors too:

# WANT_AUTOCONF=2.1 autoconf
configure.in:1372: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1468: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1469: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1470: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1471: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1472: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1473: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1474: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1475: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1476: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1477: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1478: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1479: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1480: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1481: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1482: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1869: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1898: warning: AC_TRY_RUN called without default to allow cross
compiling
configure.in:1922: warning: AC_TRY_RUN called without default to allow cross
compiling
autoconf: Undefined macros:




Comment 15


Alin Năstac (RETIRED)






          2005-12-20 07:42:55 UTC
        

I'm sorry but I can't help you.
This bug goes to the herd responsible with sys-devel/autoconf.




Comment 16


Anton Koinov





          2005-12-29 19:42:08 UTC
        

*** Bug 110188 has been marked as a duplicate of this bug. ***




Comment 17


Anton Koinov





          2005-12-29 19:43:57 UTC
        

The problem seems to be on autoconf-2.13. I got the same error while emerging 
net-print/foomatic-filters-3.0.2. For this package, autoconf-2.59 finished successfully:

WANT_AUTOCONF=2.1 autoconf -> error
WANT_AUTOCONF=2.5 autoconf -> success

------------------

I have also noticed, that even though autoconf-2.13 errors out, it DOES finish the configure script and I can run configure and make.

I was able to manually ebuild the packages that have this autoconf error and install them. All seem to be working fine.

This does confirm that the problem is in autoconf-2.13.




Comment 18


Alin Năstac (RETIRED)






          2005-12-30 06:39:06 UTC
        

please test it without WANT_AUTOCONF.
it fails for me if I set WANT_AUTOCONF=2.5




Comment 19


Anton Koinov





          2005-12-30 14:26:14 UTC
        

Sorry, I think I have only confused the matter with my last update.

It is foomatic-filters that passes autoconf-2.59 without errors, but gives the same "Undefined macros" error with 2.13. This lead me to the conclusion that the problem is only in autoconf-2.13. 

Squid _fails_ with autoconf 2.5 for me too. Running without WANT_AUTOCONF will default to ver. 2.13.

Both foomatic-filters and squid, although they get "Undefined macros" with autoconf-2.13, will successfully configure and compile manually afterwords. That is, autoconf-2.13 outputs the error but does generate the configure script successfully. 

In fact, the same thing happens for mozilla and mozilla-firefox (see bug 110188) -- I was able to manually compile amd install all of these four packages after autoconf stops with the error. They all seem to work just fine.

I do not think the problem is directly related to squid, to make things clearer, it may be better to open a new bug for autoconf-2.13 and make this one a duplicate of it. Let me know what you think and I can do it.




Comment 20


Alin Năstac (RETIRED)






          2005-12-30 23:04:33 UTC
        

please send to my email address your binary package of autoconf-2.13.
you could built it by running quickpkg autoconf-2.13 on your machine.




Comment 21


Alin Năstac (RETIRED)






          2006-02-01 13:37:58 UTC
        

After some messages exchanged with the reporter, I concluded that it has the same autoconf-2.13 as me, so it cannot be the cause of this malfunction.

Since no one else had the same problem, I close it as WORKSFORME.




Comment 22


Anton Koinov





          2006-02-27 20:48:42 UTC
        

I had the case insensitive flag enabled for grep. It was in
/et/env.d/ which is later compiled into /etc/profile on a Gentoo system.
A mistake I made long time ago... Now everything works just fine.

Many thanks for the help and sorry for the stupid problem.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

