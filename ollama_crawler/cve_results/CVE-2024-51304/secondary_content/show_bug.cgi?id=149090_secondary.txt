Title: 149090 – media-gfx/fontforge-20060703-r1 fails due to certain CFLAGS
URL: https://bugs.gentoo.org/show_bug.cgi?id=149090

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 149090
media-gfx/fontforge-20060703-r1 fails due to certain CFLAGS
Last modified: 2009-01-21 16:48:34 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 149090 
      - media-gfx/fontforge-20060703-r1 fails due to certain CFLAGS


Summary:
media-gfx/fontforge-20060703-r1 fails due to certain CFLAGS
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Fonts Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-09-25 10:35 UTC by Petr Kopecky





      Modified:
    
2009-01-21 16:48 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



vapier









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge fontforge >& log

              (log,31.07 KB,
                text/plain)

            
2006-10-01 04:47 UTC,

            Petr Kopecky




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Petr Kopecky





          2006-09-25 10:35:02 UTC
        

Compilation of fontforge-20060703-r1 fails with such message:

i686-pc-linux-gnu-gcc -shared  ArabicForms.lo alphabet.lo backtrns.lo char.lo
cjk.lo memory.lo ucharmap.lo unialt.lo ustring.lo utype.lo usprintf.lo
gwwiconv.lo  -L/usr/local/lib  -Wl,-O1 -Wl,-soname -Wl,libgunicode.so.2 -o
../.libs/libgunicode.so.2.0.2
cjk.lo: file not recognized: File format not recognized
collect2: ld returned 1 exit status
make[1]: *** [../libgunicode.la] Error 1
make[1]: Leaving directory


#emerge --info

Portage 2.1.1 (default-linux/x86/2006.0, gcc-4.1.1, glibc-2.4-r3, 2.6.17-gentoo-r8 i686)
=================================================================
System uname: 2.6.17-gentoo-r8 i686 AMD Athlon(tm) XP 2600+
Gentoo Base System version 1.12.5
Last Sync: Sat, 23 Sep 2006 15:59:01 +0000
ccache version 2.3 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.2.11-r1
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.8.1-r1, 2.6.17-r1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=athlon-xp -O3 -pipe -fforce-addr -fomit-frame-pointer -funroll-loops -falign-functions=4 -maccumulate-outgoing-args"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/splash /etc/terminfo"
CXXFLAGS="-march=athlon-xp -O3 -pipe -fforce-addr -fomit-frame-pointer -funroll-loops -falign-functions=4 -maccumulate-outgoing-args"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer parallel-fetch sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.sh.cvut.cz/MIRRORS/gentoo/gentoo/ ftp://ftp.linux.cz/pub/linux/gentoo/ ftp://ftp.fi.muni.cz/pub/linux/gentoo/"
LANG="cs_CZ"
LC_ALL="cs_CZ"
LDFLAGS="-Wl,-O1"
LINGUAS="cs"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /usr/portage/local/layman/sunrise"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow X Xaw3d aac acl acpi alsa apache2 apm arts artswrappersuid bash-completion bitmap-fonts cdr cli crypt curl dbus dga directfb dlloader dri dvd eds elibc_glibc emacs emboss encode esd exif fam fbcon ffmpeg flac fortran gatos gdbm gif gphoto2 gpm gstreamer iconv icq imap imlib input_devices_keyboard input_devices_mouse isdnlog jabber jpeg kde kdeenablefinal kernel_linux kipi libwww linguas_cs lirc lirc_devices_serial lm_sensors mad mailbox mikmod mmx mng motif mozilla moznocompose moznoirc moznomail mp3 mule ncurses nls nowin nptl nptlonly nsplugin ogg opengl oscar oss pam pcre pdflib perl plotutils png pppd python qt qt3 qt4 quicktime readline reflection samba sdl session sndfile spell spl ssl svg tcpd tetex tiff truetype truetype-fonts type1-fonts udev unicode userland_GNU v4l video_cards_fbdev video_cards_r128 video_cards_v4l video_cards_vesa vorbis win32codecs x86 xcomposite xml xml2 xorg xosd xv xvid zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_RSYNC_EXTRA_OPTS


`/var/tmp/portage/fontforge-20060703-r1/work/fontforge-20060703/Unicode'
make: *** [libgunicode] Error 2

!!! ERROR: media-gfx/fontforge-20060703-r1 failed.
Call stack:
  ebuild.sh, line 1546:   Called dyn_compile
  ebuild.sh, line 937:   Called src_compile
  fontforge-20060703-r1.ebuild, line 42:   Called die

!!! (no error message)
!!! If you need support, post the topmost build error, and the call stack if
relevant.




Comment 1


SpanKY






          2006-09-28 14:07:02 UTC
        

yeah i still cant reproduce ... please post the full output as an attachment:
emerge fontforge >& log




Comment 2


Petr Kopecky





          2006-10-01 04:47:52 UTC
        

Created attachment 98508 [details]
emerge fontforge >& log




Comment 3


SpanKY






          2006-10-01 15:28:59 UTC
        

post the cjk.lo file as an attachment

you could also try building with MAKEOPTS=-j1




Comment 4


Petr Kopecky





          2006-10-02 02:27:48 UTC
        

I did some deep investigation of the problem and it looks that there is a problem with optimization flags. I am using this:

CFLAGS="-march=athlon-xp -O3 -pipe -fforce-addr -fomit-frame-pointer -funroll-loops -falign-functions=4 -maccumulate-outgoing-args"

Without -maccumulate-outgoing-args : CFLAGS="-march=athlon-xp -O3 -pipe -fforce-addr -fomit-frame-pointer -funroll-loops -falign-functions=4"

it works.




Comment 5


Anders Storsveen





          2006-10-29 04:50:08 UTC
        

I get this error,and I have for a while:


gpsdraw.c: In function 'PSDrawElipse':
gpsdraw.c:442: fatal error: internal consistency failure
compilation terminated.
Preprocessed source stored into /var/tmp/portage/media-gfx/fontforge-20061025/temp/ccAxABA9.out file, please attach this to your bugreport.
make[1]: *** [gpsdraw.lo] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-gfx/fontforge-20061025/work/fontforge-20061025/gdraw'
make: *** [libgdraw] Error 2


going from:
CFLAGS="-march=pentium-m -O3 -pipe -fomit-frame-pointer -maccumulate-outgoing-args -ftracer"
to:
CFLAGS="-march=pentium-m -O3 -pipe"

fixes it

This has been this way since fontforge came into portage.




Comment 6


SpanKY






          2006-10-29 07:53:00 UTC
        

that is an unrelated issue, go read Bug 130161




Comment 7


Pawel Madej aka Nysander





          2008-11-24 23:45:49 UTC
        

is this a problem anymore with current version of fontforge? if not please close this bug




Comment 8


Peter Volkov (RETIRED)






          2008-12-21 17:01:45 UTC
        

I can't reproduce it with gcc-4.3.2 and not in the tree media-gfx/fontforge-20081215. Petr, is this bug still reproducible?




Comment 9


Peter Volkov (RETIRED)






          2009-01-21 16:48:34 UTC
        

No feedback from Petr and recent versions does not expose this problem. Closing.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

