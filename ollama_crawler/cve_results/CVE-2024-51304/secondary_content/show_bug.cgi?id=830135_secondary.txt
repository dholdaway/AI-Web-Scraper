Title: 830135 – kde-apps/dolphin-21.08.3 crashes on startup with QFont::setPointSizeF error
URL: https://bugs.gentoo.org/show_bug.cgi?id=830135

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 830135
kde-apps/dolphin-21.08.3 crashes on startup with QFont::setPointSizeF error
Last modified: 2021-12-29 09:12:20 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 830135 
      - kde-apps/dolphin-21.08.3 crashes on startup with QFont::setPointSizeF error


Summary:
kde-apps/dolphin-21.08.3 crashes on startup with QFont::setPointSizeF error
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-12-28 03:54 UTC by Xi





      Modified:
    
2021-12-29 09:12 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




dolphin crash log

              (dolphin-crash.log,27.58 KB,
                text/plain)

            
2021-12-28 03:55 UTC,

            Xi




Details





systemd core dump

              (dolphin-crash.log,38.88 KB,
                text/plain)

            
2021-12-28 05:36 UTC,

            Xi




Details





kcrash info for Dolphin

              (dolphin-20211228-163125.kcrash,3.69 KB,
                text/plain)

            
2021-12-28 05:37 UTC,

            Xi




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Xi





          2021-12-28 03:54:43 UTC
        

Previously, I had this issue, https://bugs.gentoo.org/829596, when starting Dolphin. After I upgraded systemd, the `cgroup` error is gone, but I got another error.

```
Dec 28 14:46:57 gentoo systemd[1957]: Started Dolphin - File Manager.                                                                                                                                                                                                         [201/1286]
Dec 28 14:46:57 gentoo kded5[2236]: Registering ":1.112/StatusNotifierItem" to system tray
Dec 28 14:46:57 gentoo plasmashell[2286]: QFont::setPointSizeF: Point size <= 0 (0.000000), must be greater than 0
Dec 28 14:46:57 gentoo plasmashell[2286]: file:///usr/share/plasma/plasmoids/org.kde.plasma.taskmanager/contents/ui/Task.qml:377: Unable to assign [undefined] to QString
```

Reproducible: Always

Steps to Reproduce:
1. Emerge kde-apps/dolphin-21.08.3 and sys-apps/systemd-249.7
2. Start Dolphin
3.
Actual Results:  
Dolphin crashes on startup

Expected Results:  
Dolphin starts

After the Dolphin crashed for a while, I got this massive error (attached) in my journal log. A similar error also occurs when I try to launch KCalc, but not Kate.




Comment 1


Xi





          2021-12-28 03:55:50 UTC
        

Created attachment 760605 [details]
dolphin crash log




Comment 2


Xi





          2021-12-28 05:36:06 UTC
        

Created attachment 760608 [details]
systemd core dump




Comment 3


Xi





          2021-12-28 05:37:20 UTC
        

Created attachment 760609 [details]
kcrash info for Dolphin




Comment 4


Xi





          2021-12-29 02:00:53 UTC
        

After taking sam's advice to recompile plasma related packages using GCC, I can use dolphin and KCalc now. I don't think recompiling ALL plasma packages is necessary, since most of the system works with clang, but since qt5 is not actively maintained upstream, I suspect more clang compiling related issues may occur in the future until we move to qt6.




Comment 5


Andreas Sturmlechner






          2021-12-29 08:55:13 UTC
        

I doubt recompiling Plasma packages helps at all, since dolphin has no dependencies on it. But hey, there you go.




Comment 6


Sam James









          2021-12-29 09:04:26 UTC
        

For posterity: my advice was to rebuild Qt bits with GCC rather than Clang given the changes in LLVM 13 which seem to end up manifesting as UB-causing-null-or-near-null pointers. Unless a decent bug report is made to Qt upstream and they fix it, there's not much prospect of us getting it fixed.

So easier to just use GCC.




Comment 7


Andreas Sturmlechner






          2021-12-29 09:12:20 UTC
        

There are various UB related fixes in upstream's 5.15 branch not yet picked in KDE repos.

https://invent.kde.org/groups/qt/-/issues?scope=all&state=opened&search=ub









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

