Title: 364927 – gnome-extra/gnome-media - Gnome Sound Preferences - Enabling "Window and Button Sounds" freezes Gnome when going offline
URL: https://bugs.gentoo.org/show_bug.cgi?id=364927

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 364927
gnome-extra/gnome-media - Gnome Sound Preferences - Enabling "Window and Button Sounds" freezes Gnome when going offline
Last modified: 2011-06-04 17:16:34 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 364927 
      - gnome-extra/gnome-media - Gnome Sound Preferences - Enabling "Window and Button Sounds" freezes Gnome when going offline


Summary:
gnome-extra/gnome-media - Gnome Sound Preferences - Enabling "Window and Butt...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-04-26 13:08 UTC by Roy Smith





      Modified:
    
2011-06-04 17:16 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Roy Smith





          2011-04-26 13:08:54 UTC
        

If you have "Window and Button Sounds" enabled in Gnomes sound preferences, the desktop will either become very sluggish or hard-freeze whenever you choose "Disconnect" from either Networkmanager, Wicd, or wpa_supplicant through the command line (wpa_cli terminate). Once you re-connect, everything stabilizes again.

Reproducible: Always

Steps to Reproduce:
1.Enable Window and Button Sounds in Gnome's volume control (sound preferences)
2.Go online
3.Disconnect from being online
Actual Results:  
The Gnome desktop will become very sluggish and when you try to open File Manager or anything else, there is an excellent chance Gnome will hard-freeze, requiring a cold reboot. The problem does not exist if you log into Gnome while offline. You first have to go online, then back offline after logging in for the problem to occur.

Expected Results:  
Choosing disconnect from being online should only disconnect without any adverse side effects.

The problem only happens in Gentoo, not other Linux distributions. The version of Gnome that definitely has this problem is 2.32.1. I do not know if the problem persists on other versions of gnome. I do not know if the problem is kernel specific or platform specific but probably is not. It is my guess that whenever you disconnect to go offline, even with a command line interface such as wpa_supplicant, a system sound will sound if "Window and Button Sounds" is activated like it does in Microsoft Windows and that is how the system sounds are relevant to the problem.




Comment 1


Roy Smith





          2011-04-26 13:29:21 UTC
        

(In reply to comment #0)
> If you have "Window and Button Sounds" enabled in Gnomes sound preferences, the
> desktop will either become very sluggish or hard-freeze whenever you choose
> "Disconnect" from either Networkmanager, Wicd, or wpa_supplicant through the
> command line (wpa_cli terminate). Once you re-connect, everything stabilizes
> again. The problem occurs when you are connected via a wireless router or a wired Ethernet cable. It may also be reproducible when getting online by other means, I haven't tested that out.
> 
> Reproducible: Always
> 
> Steps to Reproduce:
> 1.Enable Window and Button Sounds in Gnome's volume control (sound preferences)
> 2.Go online
> 3.Disconnect from being online
> Actual Results:  
> The Gnome desktop will become very sluggish and when you try to open File
> Manager or anything else, there is an excellent chance Gnome will hard-freeze,
> requiring a cold reboot. The problem does not exist if you log into Gnome while
> offline. You first have to go online, then back offline after logging in for
> the problem to occur.
> 
> Expected Results:  
> Choosing disconnect from being online should only disconnect without any
> adverse side effects.
> 
> The problem only happens in Gentoo, not other Linux distributions. The version
> of Gnome that definitely has this problem is 2.32.1. I do not know if the
> problem persists on other versions of gnome. I do not know if the problem is
> kernel specific or platform specific but probably is not. It is my guess that
> whenever you disconnect to go offline, even with a command line interface such
> as wpa_supplicant, a system sound will sound if "Window and Button Sounds" is
> activated like it does in Microsoft Windows and that is how the system sounds
> are relevant to the problem.




Comment 2


Roy Smith





          2011-04-26 13:33:46 UTC
        

Sorry for the double post. I tried to edit my original post but I ended up posting all over again.




Comment 3


Jeroen Roovers (RETIRED)






          2011-04-26 17:30:11 UTC
        

1) Please post your `emerge --info' output too.
2) Describe what sound backend you use with GNOME.
3) Information about the sound hardware could be relevant.




Comment 4


Roy Smith





          2011-04-26 18:45:01 UTC
        

My sound hardware is Intel based (IDT 92HD71B7X) and Alsa is my sound backend but it is integrated with Pulse Audio. My sound device is labeled Internal Audio, one output and one input, and it is set at analog stereo duplex. I have a volume control for both Alsa and Pulse Audio and I have an Alsa mixer. When I play music, I'm pretty sure it is using Alsa. I'm sorry if I am not very clear about my system specs.



roy@roylocalhost ~ $ su
Password: 
roylocalhost roy # emerge --info
Portage 2.1.9.42 (default/linux/x86/10.0/desktop, gcc-4.4.5, libc-0-r0, 2.6.36-gentoo-r8 i686)
=================================================================
System uname: Linux-2.6.36-gentoo-r8-i686-Intel-R-_Core-TM-2_Duo_CPU_T6600_@_2.20GHz-with-gentoo-1.12.14
Timestamp of tree: Sat, 23 Apr 2011 13:15:01 +0000
app-shells/bash:     4.1_p9
dev-lang/python:     2.6.6-r2, 2.7.1-r1, 3.1.3-r1
dev-util/cmake:      2.8.1-r2
sys-apps/baselayout: 1.12.14-r1
sys-apps/sandbox:    2.4
sys-devel/autoconf:  2.13, 2.65-r1
sys-devel/automake:  1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.4.5
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.10
sys-devel/make:      3.81-r2
sys-kernel/linux-headers: 2.6.36.1
virtual/os-headers:  0
ACCEPT_KEYWORDS="x86"
ACCEPT_LICENSE="* -@EULA AdobeFlash-10.1 Broadcom"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=i686 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -march=i686 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks fixlafiles fixpackages news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://mirror.mcs.anl.gov/pub/gentoo/ rsync://mirror.mcs.anl.gov/gentoo/ ftp://mirror.mcs.anl.gov/pub/gentoo/ ftp://gentoo.chem.wisc.edu/gentoo/ rsync://gentoo.chem.wisc.edu/gentoo/ http://gentoo.chem.wisc.edu/gentoo/ http://mirrors.cs.wmich.edu/gentoo http://www.cyberuse.com/gentoo/ http://mirror.datapipe.net/gentoo ftp://mirror.datapipe.net/gentoo http://gentoo.mirrors.easynews.com/linux/gentoo/ http://chi-10g-1-mirror.fastsoft.net/pub/linux/gentoo/gentoo-distfiles/ ftp://chi-10g-1-mirror.fastsoft.net/pub/linux/gentoo/gentoo-distfiles/ http://www.gtlib.gatech.edu/pub/gentoo rsync://rsync.gtlib.gatech.edu/gentoo ftp://ftp.gtlib.gatech.edu/pub/gentoo http://gentoo.mirrors.hoobly.com/ ftp://distro.ibiblio.org/pub/linux/distributions/gentoo/ http://distro.ibiblio.org/pub/linux/distributions/gentoo/ rsync://distro.ibiblio.org/pub/linux/distributions/gentoo/ ftp://ftp.ussg.iu.edu/pub/linux/gentoo http://lug.mtu.edu/gentoo/ ftp://lug.mtu.edu/gentoo/ ftp://gentoo.netnitco.net/pub/mirrors/gentoo/source/ http://gentoo.netnitco.net http://gentoo.osuosl.org/ http://gentoo.mirrors.pair.com/ ftp://gentoo.mirrors.pair.com/ rsync://mirrors.rit.edu/gentoo/ ftp://mirrors.rit.edu/gentoo/ http://mirrors.rit.edu/gentoo/ ftp://mirror.iawnet.sandia.gov/pub/gentoo/ http://mirror.iawnet.sandia.gov/gentoo/ rsync://gentoo.mirrors.tds.net/gentoo http://gentoo.mirrors.tds.net/gentoo http://ftp.ucsb.edu/pub/mirrors/linux/gentoo/ ftp://ftp.ucsb.edu/pub/mirrors/linux/gentoo/ ftp://ftp.lug.udel.edu/pub/gentoo/ http://mirror.lug.udel.edu/pub/gentoo/ ftp://mirror.its.uidaho.edu/gentoo/ http://mirror.its.uidaho.edu/pub/gentoo/ http://gentoo.cites.uiuc.edu/pub/gentoo/ ftp://gentoo.cites.uiuc.edu/pub/gentoo/ rsync://gentoo.cs.uni.edu/gentoo-distfiles http://gentoo.cs.uni.edu/ http://mirror.usu.edu/mirrors/gentoo/ ftp://ftp.wallawalla.edu/pub/mirrors/ftp.gentoo.org"
LANG="C"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync3.us.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi alsa avahi berkdb bluetooth branding bzip2 cairo cdr cli consolekit cracklib crypt cups cxx dbus dri dts dvd dvdr emboss encode esd exif fam firefox flac fortran gdbm gdu gif gnome gpm gtk iconv ipv6 jack jpeg lcms ldap libnotify mad mikmod mng modules mp3 mp4 mpeg mudflap ncurses nls nptl nptlonly ogg opengl openmp pam pango pcre pdf perl png policykit polkit ppds pppd pulseaudio python qt3support qt4 readline sdl session spell ssl startup-notification svg sysfs tcpd tiff truetype udev unicode usb vorbis x264 x86 xcb xml xorg xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="fbdev glint intel mach64 mga neomagic nouveau nv r128 radeon savage sis tdfx trident vesa via vmware dummy v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, LINGUAS, MAKEOPTS, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 5


Roy Smith





          2011-04-26 20:19:38 UTC
        

To clarify my hardware info, I think it is ALSA based with the Pulse Audio plugin. And lsusb shows my sound card is Intel 82801I (ICH9 family), HD audio controler, rev 03.




Comment 6


Jeroen Roovers (RETIRED)






          2011-04-27 00:50:06 UTC
        

Can you check what processes are making your system slow? Running top(1) in a terminal is usually telling.




Comment 7


Roy Smith





          2011-04-27 10:02:57 UTC
        

I ran top while the system was sluggish but everything looked ok to me. I only observed the CPU load column and everything was at zero except for gkrellm, the system monitor, which was only using 1%.




Comment 8


Roy Smith





          2011-04-27 11:13:28 UTC
        

Let me clarify my comment in my opening description of the problem. The problem does not exist in other Linux distributions that also use Gnome as the desktop (such as Fedora or Mint), so that might lead one to believe that Gnome itself is not the problem. It seems to be Gentoo specific.




Comment 9


Roy Smith





          2011-05-01 14:59:55 UTC
        

The Gnome-media package contains the gnome-volume-control (sound preferences). If I disable the pulsesaudio use flag in gnome-media, the problem persists. This seems to rule out the possibility of pulseaudio being the problem.




Comment 10


Pacho Ramos






          2011-05-04 15:19:20 UTC
        

(In reply to comment #9)
> The Gnome-media package contains the gnome-volume-control (sound preferences).
> If I disable the pulsesaudio use flag in gnome-media, the problem persists.
> This seems to rule out the possibility of pulseaudio being the problem.

I am totally unable to reproduce without pulseaudio (I don't have it), could you recheck on a new created user account?




Comment 11


Roy Smith





          2011-05-04 15:36:36 UTC
        

I re-checked the problem using a new user account and the problem does still persist. Keep in mind Gnome may not completely freeze immediately but it will become sluggish in certain ways, for example, if you open up Nautilus, nothing will show in the main window for a minute or two but the drop down menus on the task bar may still work properly, giving the impression the problem does not exist.




Comment 12


Pacho Ramos






          2011-05-04 16:14:57 UTC
        

All keeps working for me :-|




Comment 13


Roy Smith





          2011-05-04 20:12:29 UTC
        

After playing with it a little more, I discovered the problem is much worse when I am online using my wireless router than when I use an Ethernet cable. When I am using an Ethernet cable,and disconnect, Nautilus opens fine and it populates with no problem but the icons on the right side of the taskbar such as the volume control icon and the nm-applet fail to drop down their menu when clicked on and the only way to get it back is to log out and log back in. But when I am online using the wireless router, and disconnect, that is when Nautilus will not even populate itself and it is when the system is more likely to freeze. I hardly ever use an Ethernet cable to get online with so that is why I really never knew the problem was not as bad using an Ethernet cable. I'm assuming you were using an Ethernet cable to connect with. Did you check the icons on the right side of the taskbar to see if they operated properly after disconnecting? Have you tested it out using a wireless router? Thank you so much for looking into this for me.




Comment 14


Pacho Ramos






          2011-05-05 16:59:35 UTC
        

All keeps working ok for me, I would check "dmesg" and ~/.xsession-errors file




Comment 15


Pacho Ramos






          2011-06-04 10:49:54 UTC
        

(In reply to comment #14)
> All keeps working ok for me, I would check "dmesg" and ~/.xsession-errors file

Any news here?




Comment 16


Roy Smith





          2011-06-04 11:10:52 UTC
        

dmesg and .xsession errors do not show anything relevant. I am going to wait and see of upgrades fixes the problem. When the problem is fixed, I will report back. Thank you.




Comment 17


Pacho Ramos






          2011-06-04 14:40:13 UTC
        

Did you check them when system was getting borked? Also look at /var/log/messages in that time




Comment 18


Roy Smith





          2011-06-04 16:45:39 UTC
        

Hello Mr. Ramos,

I am happy to report that the problem no longer exists but I am perplexed as to why is it fixed. I tried everything to simulate the conditions it took to freeze the desktop but I no longer can. I made a couple of changes to my hard drive such as move another OS to a different partition (multi-boot) and installed Windows 7 where the old OS used to be, but surely this had nothing to do with it the problem going away. Those are the only changes that I made as far as I can tell. I did install another world update last month which only installed a few packages since it had not been long since I did it previously but I'm sure I tested it out after the update to see if the problem persisted but I really can't remember now.

I hope nobody feels bad at me for installing Windows 7 on my computer since many out there are Micro$oft haters but I could not find a program in Linux to sync my iPhone.

If I discover what I did to fix the problem I will surely post it here if this bug report remains open.

All the best,
Roy




Comment 19


Pacho Ramos






          2011-06-04 17:16:34 UTC
        

Thanks a lot for your feedback, will close then as it works for me and don't worry about what can we think related with people installing what they prefer ;-), I don't mind and hope nobody else does.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

