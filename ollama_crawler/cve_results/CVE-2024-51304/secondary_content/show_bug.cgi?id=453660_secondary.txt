Title: 453660 – =sys-kernel/openvz-sources-2.6.32.68.8 fails to compile with gcc:4.4 and the suggested config
URL: https://bugs.gentoo.org/show_bug.cgi?id=453660

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 453660
=sys-kernel/openvz-sources-2.6.32.68.8 fails to compile with gcc:4.4 and the suggested config
Last modified: 2013-04-24 08:32:25 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 453660 
      - =sys-kernel/openvz-sources-2.6.32.68.8 fails to compile with gcc:4.4 and the suggested config


Summary:
=sys-kernel/openvz-sources-2.6.32.68.8 fails to compile with gcc:4.4 and the ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo VPS Team (OBSOLETE)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




452078



 

        Show dependency tree





 





      Reported:
    
2013-01-23 11:52 UTC by Agostino Sarubbo





      Modified:
    
2013-04-24 08:32 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



andreis.vinogradovs
bug
proxy-maint









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Agostino Sarubbo






          2013-01-23 11:52:26 UTC
        

Step I followed:

cd /usr/src/linux-2.6.32-openvz-068.8
wget http://download.openvz.org/kernel/branches/rhel6-2.6.32/042stab068.8/configs/config-2.6.32-042stab068.8.x86_64 -o .config
make -j4

Result:
  HOSTCC  scripts/basic/fixdep
  HOSTCC  scripts/basic/docproc
  HOSTCC  scripts/basic/hash
  HOSTCC  scripts/kconfig/conf.o
  HOSTCC  scripts/kconfig/kxgettext.o
  HOSTCC  scripts/kconfig/zconf.tab.o
  HOSTLD  scripts/kconfig/conf
scripts/kconfig/conf -s arch/x86/Kconfig
  CHK     include/linux/version.h
  UPD     include/linux/version.h
  CHK     include/linux/utsrelease.h                                                                                                                                                
  UPD     include/linux/utsrelease.h                                                                                                                                                
  SYMLINK include/asm -> include/asm-x86                                                                                                                                            
  HOSTCC  scripts/kallsyms                                                                                                                                                          
  HOSTCC  scripts/conmakehash                                                                                                                                                       
  CC      scripts/mod/empty.o                                                                                                                                                       
  HOSTCC  scripts/mod/mk_elfconfig                                                                                                                                                  
  HOSTCC  scripts/mod/mod-extract                                                                                                                                                   
  MKELF   scripts/mod/elfconfig.h                                                                                                                                                   
  HOSTCC  scripts/mod/file2alias.o                                                                                                                                                  
  HOSTCC  scripts/mod/modpost.o                                                                                                                                                     
  HOSTCC  scripts/mod/sumversion.o                                                                                                                                                  
  HOSTLD  scripts/mod/modpost                                                                                                                                                       
  CC      kernel/bounds.s                                                                                                                                                           
  GEN     include/linux/bounds.h                                                                                                                                                    
  CC      arch/x86/kernel/asm-offsets.s                                                                                                                                             
In file included from include/linux/prefetch.h:14,                                                                                                                                  
                 from include/linux/list.h:7,                                                                                                                                       
                 from include/linux/module.h:9,                                                                                                                                     
                 from include/linux/crypto.h:21,                                                                                                                                    
                 from arch/x86/kernel/asm-offsets_64.c:8,                                                                                                                           
                 from arch/x86/kernel/asm-offsets.c:4:                                                                                                                              
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/processor.h: In function 'get_aperfmperf':                                                                                  
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/processor.h:1009: error: implicit declaration of function 'cpu_data_rh'                                                     
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/processor.h:1009: error: 'struct cpuinfo_x86' has no member named 'cpu_index'                                               
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/processor.h:1009: error: 'struct cpuinfo_x86' has no member named 'cpu_index'                                               
In file included from /usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/pgtable.h:321,                                                                                        
                 from include/linux/mm.h:41,                                                                                                                                        
                 from include/linux/suspend.h:8,                                                                                                                                    
                 from arch/x86/kernel/asm-offsets_64.c:13,                                                                                                                          
                 from arch/x86/kernel/asm-offsets.c:4:
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/pgtable_64.h: In function 'has_transparent_hugepage':
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/pgtable_64.h:207: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/pgtable_64.h:207: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
In file included from /usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/suspend_64.h:10,
                 from /usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/suspend.h:4,
                 from arch/x86/kernel/asm-offsets_64.c:20,
                 from arch/x86/kernel/asm-offsets.c:4:
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h: In function 'use_xsaveopt':
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:63: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:63: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:63: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:63: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:63: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:63: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h: In function 'use_xsave':
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:68: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:68: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:68: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:68: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:68: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:68: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h: In function 'get_fpu_cwd':
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:445: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:445: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h: In function 'get_fpu_swd':
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:454: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:454: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h: In function 'get_fpu_mxcsr':
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:463: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
/usr/src/linux-2.6.32-openvz-068.8/arch/x86/include/asm/i387.h:463: error: 'struct cpuinfo_x86' has no member named 'cpu_index'
make[1]: *** [arch/x86/kernel/asm-offsets.s] Error 1
make: *** [prepare0] Error 2




Comment 1


Agostino Sarubbo






          2013-01-23 11:52:57 UTC
        

vbp ~ # gcc -v
Using built-in specs.
Target: x86_64-pc-linux-gnu
Configured with: /var/tmp/portage/sys-devel/gcc-4.4.7/work/gcc-4.4.7/configure --prefix=/usr --bindir=/usr/x86_64-pc-linux-gnu/gcc-bin/4.4.7 --includedir=/usr/lib/gcc/x86_64-pc-linux-gnu/4.4.7/include --datadir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.4.7 --mandir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.4.7/man --infodir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.4.7/info --with-gxx-include-dir=/usr/lib/gcc/x86_64-pc-linux-gnu/4.4.7/include/g++-v4 --host=x86_64-pc-linux-gnu --build=x86_64-pc-linux-gnu --disable-altivec --disable-fixed-point --without-ppl --without-cloog --enable-nls --without-included-gettext --with-system-zlib --enable-obsolete --disable-werror --enable-secureplt --enable-multilib --enable-libmudflap --disable-libssp --enable-libgomp --with-python-dir=/share/gcc-data/x86_64-pc-linux-gnu/4.4.7/python --enable-checking=release --disable-libgcj --enable-libstdcxx-time --enable-languages=c,c++,fortran --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-clocale=gnu --enable-targets=all --with-bugurl=http://bugs.gentoo.org/ --with-pkgversion='Gentoo 4.4.7 p1.1, pie-0.4.5'
Thread model: posix
gcc version 4.4.7 (Gentoo 4.4.7 p1.1, pie-0.4.5)




Comment 2


Andreis Vinogradovs ( slepnoga )





          2013-01-23 20:25:06 UTC
        

What letter "o" for wget you use? Uppercase or lowercase?

In your post I see a capital letter, maybe I misunderstood the post or did you go wrong? 

I just repeated build again and it completed successfully


ashgabad linux # wget http://download.openvz.org/kernel/branches/rhel6-2.6.32/042stab068.8/configs/config-2.6.32-042stab068.8.x86_64 -o .config
ashgabad linux # cat .config 
--2013-01-23 22:16:08--  http://download.openvz.org/kernel/branches/rhel6-2.6.32/042stab068.8/configs/config-2.6.32-042stab068.8.x86_64
Resolving download.openvz.org (download.openvz.org)... 199.115.104.11
Connecting to download.openvz.org (download.openvz.org)|199.115.104.11|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 102420 (100K) [application/x-troff-man]
Saving to: ‘config-2.6.32-042stab068.8.x86_64.2’

     0K .......... .......... .......... .......... .......... 49%  119K 0s
    50K .......... .......... .......... .......... .......... 99%  122K 0s
   100K                                                       100% 37.3G=0.8s

2013-01-23 22:16:09 (121 KB/s) - ‘config-2.6.32-042stab068.8.x86_64.2’ saved [102420/102420]

ashgabad linux # wget http://download.openvz.org/kernel/branches/rhel6-2.6.32/042stab068.8/configs/config-2.6.32-042stab068.8.x86_64 -O .config
--2013-01-23 22:16:28--  http://download.openvz.org/kernel/branches/rhel6-2.6.32/042stab068.8/configs/config-2.6.32-042stab068.8.x86_64
Resolving download.openvz.org (download.openvz.org)... 199.115.104.11
Connecting to download.openvz.org (download.openvz.org)|199.115.104.11|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 102420 (100K) [application/x-troff-man]
Saving to: ‘.config’

100%[===========================================================================================================================================================================>] 102,420      128KB/s   in 0.8s   

2013-01-23 22:16:29 (128 KB/s) - ‘.config’ saved [102420/102420]




Comment 3


Andreis Vinogradovs ( slepnoga )





          2013-01-23 20:33:06 UTC
        

> In your post I see a capital letter, maybe I misunderstood the post or did
> you go wrong? 

I apologize for my еnglish, 's/capital/lowercase' of course




Comment 4


Jordi Marqués





          2013-03-08 08:59:59 UTC
        

I'm using that kernel on 4 hosts, 32 and 64 bit, using suggested config, and gcc:4.4 without any problem.

I can not reproduce that problem, but it remembers me to what happens when trying to compile openvz sources without official config.




Comment 5


Sergey Popov (RETIRED)






          2013-04-24 08:32:25 UTC
        

phantom linux-2.6.32-openvz-068.8 # wget http://download.openvz.org/kernel/branches/rhel6-2.6.32/042stab068.8/configs/config-2.6.32-042stab068.8.x86_64 -O .config

phantom linux-2.6.32-openvz-068.8 # make -j8 && echo success
(snip)
success

phantom linux-2.6.32-openvz-068.8 # emerge --info
Portage 2.1.11.55 (default/linux/amd64/13.0/developer, gcc-4.4.7, glibc-2.15-r3, 3.7.10-gentoo-r1-BADO x86_64)
=================================================================
System uname: Linux-3.7.10-gentoo-r1-BADO-x86_64-Intel-R-_Core-TM-_i7_CPU_950_@_3.07GHz-with-gentoo-2.1
KiB Mem:     8166424 total,    350720 free
KiB Swap:          0 total,         0 free
Timestamp of tree: Fri, 19 Apr 2013 21:45:01 +0000
ld GNU ld (GNU Binutils) 2.22
ccache version 3.1.9 [enabled]
app-shells/bash:          4.2_p37
dev-lang/python:          2.7.3-r3, 3.2.3-r2
dev-util/ccache:          3.1.9
dev-util/pkgconfig:       0.28
sys-apps/baselayout:      2.1-r1
sys-apps/openrc:          0.11.8
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.69
sys-devel/automake:       1.12.6
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.4.7, 4.6.3
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.7 (virtual/os-headers)
sys-libs/glibc:           2.15-r3
Repositories: gentoo pinkbyte
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/openvpn/easy-rsa"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe"
DISTDIR="/bound/distfiles"
EMERGE_DEFAULT_OPTS="--keep-going --jobs=3"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs ccache collision-protect config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch protect-owned sandbox sfperms sign splitdebug strict test-fail-continue unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://mirror.yandex.ru/gentoo-distfiles"
LANG="ru_RU.UTF-8"
LDFLAGS="-Wl,--hash-style=gnu -Wl,-O1 -Wl,--as-needed -Wl,--hash-style=gnu"
MAKEOPTS="-j9"
PKGDIR="/bound/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/bound/portage"
PORTDIR_OVERLAY="/bound/overlays/pinkbyte"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="a52 aac acl acpi alsa amd64 bzip2 cairo cdda cdr cli cracklib crypt cxx dbus dri dts dvd dvdr emboss encode exif fam firefox flac fortran gif gpm iconv ipv6 jpeg lcms mad mmx mng modules mp3 mp4 mpeg mudflap multilib ncurses nls nptl ogg openmp pam pango pcre pdf png policykit ppds qt3support readline sdl session snmp spell sse sse2 ssl startup-notification svg tcpd threads truetype udev udisks unicode upower usb vorbis wxwidgets x264 xcb xml xv xvid zlib" ABI_X86="64" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LINGUAS="ru ru_RU" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-3" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
USE_PYTHON="2.7"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS



Can not reproduce this with recommended config and compiler version. Closing as WORKSFORME









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

