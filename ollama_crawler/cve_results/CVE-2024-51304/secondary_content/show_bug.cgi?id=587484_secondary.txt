Title: 587484 – Document proxy-related environment variables
URL: https://bugs.gentoo.org/show_bug.cgi?id=587484

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 587484
Document proxy-related environment variables
Last modified: 2023-08-20 07:58:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 587484 
      - Document proxy-related environment variables


Summary:
Document proxy-related environment variables
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Documentation

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:




911938



Blocks:




377365 912589



 

        Show dependency tree





 





      Reported:
    
2016-06-29 08:06 UTC by Martin Mokrejš





      Modified:
    
2023-08-20 07:58 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin Mokrejš





          2016-06-29 08:06:22 UTC
        

I find the manpage incomplete while searching for variables related to "proxy" settings.

I assume http_proxy, https_proxy, ftp_proxy should be used.

Does rsync_proxy exist? Or how can I make portage use rsync through a tunnelled port local port? Or can I avoid the rsync altogether and use syncing over http (firewall denies all rsync://)? I know about emerge-websync, a pointer to it from the manpage would be also helpful but it fetches some tarball, so is less often updated.




Comment 1


Zac Medico






          2016-06-29 08:37:02 UTC
        

The make.conf man page already mentions http_proxy, ftp_proxy, and RSYNC_PROXY. These variables are not actually known by portage, but by programs that portage calls. I see in the wget man page that it also support https_proxy.

(In reply to Martin Mokrejš from comment #0)
> Does rsync_proxy exist?

See RSYNC_PROXY in the rsync man page.

> Or how can I make portage use rsync through a
> tunnelled port local port?

Hmm, better refer to the rsync documentation.

> Or can I avoid the rsync altogether and use
> syncing over http (firewall denies all rsync://)? I know about
> emerge-websync, a pointer to it from the manpage would be also helpful but
> it fetches some tarball, so is less often updated.

There's also emerge-delta-webrsync. The snapshots are daily.




Comment 2


Martin Mokrejš





          2016-06-29 10:57:45 UTC
        

(In reply to Zac Medico from comment #1)
> The make.conf man page already mentions http_proxy, ftp_proxy, and

Doh, I went through 'man emerge' of course to look for command line arguments and env variables. :(

Having the possibility to define defaults in make.conf is fine, but command line options should exist as well.

> RSYNC_PROXY. These variables are not actually known by portage, but by

OK, I see.

> programs that portage calls. I see in the wget man page that it also support
> https_proxy.
> 
> (In reply to Martin Mokrejš from comment #0)
> > Does rsync_proxy exist?
> 
> See RSYNC_PROXY in the rsync man page.
> 
> > Or how can I make portage use rsync through a
> > tunnelled port local port?
> 
> Hmm, better refer to the rsync documentation.

fully_networked$ ssh -v -R:1654:127.0.0.1:22 clusternode
clusternode$ export RSYNC_CONNECT_PROG='ssh -p 1654 127.0.0.1 nc %H 873'
clusternode$ emerge --sync
$ emerge --sync 
>>> Syncing repository 'gentoo' into '/scratch/mmokrejs/gentoo_rap/usr/portage'...
>>> Starting rsync with rsync://176.28.50.119/gentoo-portage...
>>> Checking server timestamp ...
ssh: connect to host 127.0.0.1 port 1654: Connection refused
rsync: safe_read failed to read 1 bytes [Receiver]: Connection reset by peer (104)
rsync error: error in rsync protocol data stream (code 12) at io.c(276) [Receiver=3.1.2]
>>> Retrying...


Something is wrong. And yes, I did realize I had not installed netcat on the fully networked node. The error had a hardly chance to be propagated back to emerge to report, true. But installing netcat still did not help, weird.


> 
> > Or can I avoid the rsync altogether and use
> > syncing over http (firewall denies all rsync://)? I know about
> > emerge-websync, a pointer to it from the manpage would be also helpful but
> > it fetches some tarball, so is less often updated.
> 
> There's also emerge-delta-webrsync. The snapshots are daily.

Thanks, I at least can sync using the emerge-delta-webrsync, perfect!




Comment 3


Martin Mokrejš





          2016-06-29 12:41:54 UTC
        

OK, this works:

fully_networked$ ssh -R:1654:127.0.0.1:22 clusternode

clusternode$ export RSYNC_CONNECT_PROG='ssh -p 1654 127.0.0.1 nc %H 873'
clusternode$ emerge --sync




Comment 4


Larry the Git Cow






          2023-08-19 14:59:05 UTC
        

The bug has been referenced in the following commit(s):

https://gitweb.gentoo.org/proj/portage.git/commit/?id=45341379cdcdfb74ab44ffb0297564f12fb9beb5

commit 45341379cdcdfb74ab44ffb0297564f12fb9beb5
Author:     Sam James <sam@gentoo.org>
AuthorDate: 2023-08-19 14:58:24 +0000
Commit:     Sam James <sam@gentoo.org>
CommitDate: 2023-08-19 14:59:00 +0000

    make.conf.5: mention https_proxy
    
    We support it as of recent (from today) commits.
    
    Bug: https://bugs.gentoo.org/587484
    Signed-off-by: Sam James <sam@gentoo.org>

 NEWS            | 2 ++
 man/make.conf.5 | 2 +-
 2 files changed, 3 insertions(+), 1 deletion(-)




Comment 5


Larry the Git Cow






          2023-08-20 07:58:38 UTC
        

The bug has been referenced in the following commit(s):

https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=a6a68c0255b6d3132dd555b1519a035204bffde2

commit a6a68c0255b6d3132dd555b1519a035204bffde2
Author:     Sam James <sam@gentoo.org>
AuthorDate: 2023-08-20 07:57:47 +0000
Commit:     Sam James <sam@gentoo.org>
CommitDate: 2023-08-20 07:58:22 +0000

    sys-apps/portage: add 3.0.51
    
    Bug: https://bugs.gentoo.org/587484
    Closes: https://bugs.gentoo.org/673624
    Closes: https://bugs.gentoo.org/691434
    Closes: https://bugs.gentoo.org/835927
    Closes: https://bugs.gentoo.org/909009
    Closes: https://bugs.gentoo.org/911335
    Closes: https://bugs.gentoo.org/911629
    Closes: https://bugs.gentoo.org/911938
    Signed-off-by: Sam James <sam@gentoo.org>

 sys-apps/portage/Manifest              |   1 +
 sys-apps/portage/portage-3.0.51.ebuild | 234 +++++++++++++++++++++++++++++++++
 2 files changed, 235 insertions(+)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

