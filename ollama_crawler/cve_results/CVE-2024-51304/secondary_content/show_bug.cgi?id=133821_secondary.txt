Title: 133821 – media-libs/imlib-1.9.15 --as-needed fix
URL: https://bugs.gentoo.org/show_bug.cgi?id=133821

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 133821
media-libs/imlib-1.9.15 --as-needed fix
Last modified: 2007-02-05 22:20:49 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 133821 
      - media-libs/imlib-1.9.15 --as-needed fix


Summary:
media-libs/imlib-1.9.15 --as-needed fix
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

No maintainer - Look at https://wiki.gentoo.org/wiki/Project:Proxy_Maintainers if you want to take care of it








URL:







Whiteboard:




Keywords:








Depends on:




133819



Blocks:




as-needed



 

        Show dependency tree





 





      Reported:
    
2006-05-19 16:21 UTC by Thomas S. Howard





      Modified:
    
2007-02-05 22:20 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



dberkholz









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




imlib-1.9.15 --as-needed fix

              (imlib-1.9.15-as-needed.patch,2.18 KB,
                patch)

            
2006-05-19 16:21 UTC,

            Thomas S. Howard




Details
            | Diff





/imlib-1.9.15.ebuild.patch --as-needed

              (imlib-1.9.15.ebuild.patch,421 bytes,
                patch)

            
2006-05-19 16:23 UTC,

            Thomas S. Howard




Details
            | Diff





imlib-1.9.15 --as-needed fix, revised

              (imlib-1.9.15-as-needed.patch,449 bytes,
                patch)

            
2006-05-21 21:08 UTC,

            Thomas S. Howard




Details
            | Diff





imlib-1.9.15.ebuild.patch --as-needed, revised

              (imlib-1.9.15.ebuild.patch,962 bytes,
                patch)

            
2006-05-21 21:29 UTC,

            Thomas S. Howard




Details
            | Diff





emerge ' media-libs/imlib-1.9.15 ' failed

              (imlib-1.9.15-failed,30.40 KB,
                text/plain)

            
2006-08-23 15:39 UTC,

            Hueseyin Koese




Details





Show
              Obsolete (2)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Thomas S. Howard





          2006-05-19 16:21:07 UTC
        

The good news is, with gtk fixed (see bug #133819) , little else is required and imlib doesn't any need patching, except for configure and imlib-config, so the ldflags come before the objects, and not in the output, respectively.




Comment 1


Thomas S. Howard





          2006-05-19 16:21:54 UTC
        

Created attachment 87082 [details, diff]
imlib-1.9.15 --as-needed fix




Comment 2


Thomas S. Howard





          2006-05-19 16:23:40 UTC
        

Created attachment 87083 [details, diff]
/imlib-1.9.15.ebuild.patch --as-needed




Comment 3


Diego Elio Pettenò (RETIRED)






          2006-05-19 17:46:52 UTC
        

See the notes on bug #133820 about configure. About imlib-config.in, as that's afterward installed, you should not hardcode LDFLAGS there (if you want to know why, look at http://farragut.flameeyes.is-a-geek.org/articles/2006/05/19/why-it-is-a-bad-idea-to-record-user-settings-during-compile .





Comment 4


Thomas S. Howard





          2006-05-19 18:05:31 UTC
        

(In reply to comment #3)
> See the notes on bug #133820 about configure. About imlib-config.in, as that's
> afterward installed, you should not hardcode LDFLAGS there (if you want to know
> why, look at
> http://farragut.flameeyes.is-a-geek.org/articles/2006/05/19/why-it-is-a-bad-idea-to-record-user-settings-during-compile
> .
> 
Yeah, I know. That's the thing: upstream was hardcoding the ldflags into imlib-config, which was killing other ebuilds.





Comment 5


Thomas S. Howard





          2006-05-21 21:08:34 UTC
        

Created attachment 87223 [details, diff]
imlib-1.9.15 --as-needed fix, revised

Removed modifications to configure in original patch. No other way make those changes without editing libtool, configure, or aclocal.m4. Unfortunately, the order of the compiler options is set with an internal libtool macro. Still, the removal of hard coded LDFLAGS in imlib-config output is necessary to avoid trouble with other packages.




Comment 6


Thomas S. Howard





          2006-05-21 21:29:21 UTC
        

Created attachment 87226 [details, diff]
imlib-1.9.15.ebuild.patch --as-needed, revised

Now uses eautoreconf instead of bare calls to autoconf and automake as the one in portage now does.




Comment 7


Hueseyin Koese





          2006-08-23 15:39:31 UTC
        

Created attachment 94970 [details]
emerge ' media-libs/imlib-1.9.15 ' failed

hallo,

both versions of ' imlib ' failed, same error :-(

and this

patching file /var/tmp/portage/imlib-1.9.15/work/imlib-1.9.15/ltmain.sh
Hunk #1 FAILED at 3462.
1 out of 1 hunk FAILED -- saving rejects to file /var/tmp/portage/imlib-1.9.15/work/imlib-1.9.15/ltmain.sh.rej

some Packages depending on imlib !

Thanks

CooSee ' Ya




Comment 8


Thomas S. Howard





          2006-11-09 16:17:20 UTC
        

(In reply to comment #7)
> Created an attachment (id=94970) [edit]
> emerge ' media-libs/imlib-1.9.15 ' failed
> 
> hallo,
> 
> both versions of ' imlib ' failed, same error :-(
> 
> and this
> 
> patching file /var/tmp/portage/imlib-1.9.15/work/imlib-1.9.15/ltmain.sh
> Hunk #1 FAILED at 3462.
> 1 out of 1 hunk FAILED -- saving rejects to file
> /var/tmp/portage/imlib-1.9.15/work/imlib-1.9.15/ltmain.sh.rej

That doesn't make sense. None of the patches do anything to ltmain.sh; it looks like something is up with libtool on your system and possibly the eautoreconf,elibtoolize,etc. stuff is failing because of it.

As to the other problem, with the undefined symbols, again, I'm not changing anything in the utils subdirectory. I do notice from the compiler output that you were (and possibly still are) using a binutils patched for -Bdirect and that your ldflags are a bit, umm, shall we say "comprehensive". E.g.:

 -Wl,-O1 -Wl,--sort-common -Wl,-Bdirect -Wl,-hashvals -Wl,-zdynsort
 -Wl,--as-needed

Revert to a version of binutils from Gentoo and set your ldflags to this:

 -Wl,-O1,--as-needed

I think that will fix the ltmain.sh errors as well.







Comment 9


Samuli Suominen (RETIRED)






          2007-02-05 22:20:49 UTC
        

My entire system is built with --as-needed and had no problems with imlib at all.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

