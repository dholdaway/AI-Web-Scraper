Title: 362749 – net-libs/webkit-gtk-1.2.7 ebuild contains patch for masked package media-libs/libpng-1.5.1
URL: https://bugs.gentoo.org/show_bug.cgi?id=362749

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 362749
net-libs/webkit-gtk-1.2.7 ebuild contains patch for masked package media-libs/libpng-1.5.1
Last modified: 2011-04-10 06:27:01 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 362749 
      - net-libs/webkit-gtk-1.2.7 ebuild contains patch for masked package media-libs/libpng-1.5.1


Summary:
net-libs/webkit-gtk-1.2.7 ebuild contains patch for masked package media-libs...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-04-09 17:50 UTC by Chris Pabst





      Modified:
    
2011-04-10 06:27 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Chris Pabst





          2011-04-09 17:50:18 UTC
        

(This is my first bug, so please be gentle if I have messed something up :) )

The ebuild for the net-libs/webkit-gtk-1.2.7 (which appears to be the current version of this package) contains a patch called webkit-gtk-1.2.7-libpng15.patch that appears to be for package media-libs/libpng version 1.5 or greater. However, according to the package list for media-libs/libpng, the highest current unmasked version is 1.4.5. When I try 'emerge webkit-gtk', I get:

orangu3 ~ # emerge =net-libs/webkit-gtk-1.2.7
Calculating dependencies... done!

>>> Verifying ebuild manifests

>>> Emerging (1 of 1) net-libs/webkit-gtk-1.2.7
 * webkit-1.2.7.tar.gz RMD160 SHA1 SHA256 size ;-) ...                      [ ok ]
 * Package:    net-libs/webkit-gtk-1.2.7
 * Repository: gentoo
 * Maintainer: gnome@gentoo.org
 * USE:        amd64 elibc_glibc gstreamer jit kernel_linux multilib userland_GNU
 * FEATURES:   sandbox
>>> Unpacking source...
>>> Unpacking webkit-1.2.7.tar.gz to /var/tmp/portage/net-libs/webkit-gtk-1.2.7/work
>>> Source unpacked in /var/tmp/portage/net-libs/webkit-gtk-1.2.7/work
>>> Preparing source in /var/tmp/portage/net-libs/webkit-gtk-1.2.7/work/webkit-1.2.7 ...
 * Applying webkit-gtk-1.2.5-darwin8.patch ...                              [ ok ]
 * Applying webkit-gtk-1.2.5-tests-build.patch ...                          [ ok ]
 * Applying webkit-gtk-1.2.7-libpng15.patch ...

 * Failed Patch: webkit-gtk-1.2.7-libpng15.patch !
 *  ( /usr/portage/net-libs/webkit-gtk/files/webkit-gtk-1.2.7-libpng15.patch )
 *
 * Include in your bugreport the contents of:
 *
 *   /var/tmp/portage/net-libs/webkit-gtk-1.2.7/temp/webkit-gtk-1.2.7-libpng15.patch.out

 * ERROR: net-libs/webkit-gtk-1.2.7 failed (prepare phase):
 *   Failed Patch: webkit-gtk-1.2.7-libpng15.patch!
 *
 * Call stack:
 *     ebuild.sh, line   56:  Called src_prepare
 *   environment, line 3096:  Called epatch '/usr/portage/net-libs/webkit-gtk/files/webkit-gtk-1.2.7-libpng15.patch'
 *   environment, line 1765:  Called die
 * The specific snippet of code:
 *               die "Failed Patch: ${patchname}!";
 *
 * If you need support, post the output of 'emerge --info =net-libs/webkit-gtk-1.2.7',
 * the complete build log and the output of 'emerge -pqv =net-libs/webkit-gtk-1.2.7'.
 * The complete build log is located at '/var/tmp/portage/net-libs/webkit-gtk-1.2.7/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/net-libs/webkit-gtk-1.2.7/temp/environment'.
 * S: '/var/tmp/portage/net-libs/webkit-gtk-1.2.7/work/webkit-1.2.7'


'emerge =net-libs/webkit-gtk-1.2.6' works just fine.

 

Reproducible: Always

Steps to Reproduce:
1. Take an amd64 gentoo system that hasn't had a full update in a while (1 month for me - based on ebuild checkin date, any time before 4 Apr 2011).
2. Make sure the current version of media-libs/libpng (1.4.5 as of this moment)
2. Run ' emerge --update --deep --newuse world' (--newuse is probably not needed)
3. When it gets to webkit-gtk', it should fail.
Actual Results:  
Calculating dependencies... done!

>>> Verifying ebuild manifests

>>> Emerging (1 of 1) net-libs/webkit-gtk-1.2.7
 * webkit-1.2.7.tar.gz RMD160 SHA1 SHA256 size ;-) ...                      [ ok ]
 * Package:    net-libs/webkit-gtk-1.2.7
 * Repository: gentoo
 * Maintainer: gnome@gentoo.org
 * USE:        amd64 elibc_glibc gstreamer jit kernel_linux multilib userland_GNU
 * FEATURES:   sandbox
>>> Unpacking source...
>>> Unpacking webkit-1.2.7.tar.gz to /var/tmp/portage/net-libs/webkit-gtk-1.2.7/work
>>> Source unpacked in /var/tmp/portage/net-libs/webkit-gtk-1.2.7/work
>>> Preparing source in /var/tmp/portage/net-libs/webkit-gtk-1.2.7/work/webkit-1.2.7 ...
 * Applying webkit-gtk-1.2.5-darwin8.patch ...                              [ ok ]
 * Applying webkit-gtk-1.2.5-tests-build.patch ...                          [ ok ]
 * Applying webkit-gtk-1.2.7-libpng15.patch ...

 * Failed Patch: webkit-gtk-1.2.7-libpng15.patch !
 *  ( /usr/portage/net-libs/webkit-gtk/files/webkit-gtk-1.2.7-libpng15.patch )
 *
 * Include in your bugreport the contents of:
 *
 *   /var/tmp/portage/net-libs/webkit-gtk-1.2.7/temp/webkit-gtk-1.2.7-libpng15.patch.out

 * ERROR: net-libs/webkit-gtk-1.2.7 failed (prepare phase):
 *   Failed Patch: webkit-gtk-1.2.7-libpng15.patch!
 *
 * Call stack:
 *     ebuild.sh, line   56:  Called src_prepare
 *   environment, line 3096:  Called epatch '/usr/portage/net-libs/webkit-gtk/files/webkit-gtk-1.2.7-libpng15.patch'
 *   environment, line 1765:  Called die
 * The specific snippet of code:
 *               die "Failed Patch: ${patchname}!";
 *
 * If you need support, post the output of 'emerge --info =net-libs/webkit-gtk-1.2.7',
 * the complete build log and the output of 'emerge -pqv =net-libs/webkit-gtk-1.2.7'.
 * The complete build log is located at '/var/tmp/portage/net-libs/webkit-gtk-1.2.7/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/net-libs/webkit-gtk-1.2.7/temp/environment'.
 * S: '/var/tmp/portage/net-libs/webkit-gtk-1.2.7/work/webkit-1.2.7'


Expected Results:  
Successful build.

orangu3 ~ # emerge --info
Portage 2.1.9.42 (default/linux/amd64/10.0, gcc-4.3.4, glibc-2.11.3-r0, 2.6.36-gentoo-r5 x86_64)
=================================================================
System uname: Linux-2.6.36-gentoo-r5-x86_64-AMD_Athlon-tm-_64_Processor_3200+-with-gentoo-1.12.14
Timestamp of tree: Mon, 04 Apr 2011 23:30:01 +0000
app-shells/bash:     4.1_p9
dev-lang/python:     2.6.6-r1, 2.7.1-r1, 3.1.3-r1
dev-util/cmake:      2.8.4
sys-apps/baselayout: 1.12.14-r1
sys-apps/sandbox:    2.4
sys-devel/autoconf:  2.13, 2.65-r1
sys-devel/automake:  1.9.6-r2, 1.10.2, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.3.4, 4.4.5
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.10
sys-devel/make:      3.81-r2
virtual/os-headers:  2.6.36.1 (sys-kernel/linux-headers)
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5.3/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=athlon64 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks fixlafiles fixpackages news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X acl alsa amd64 bash-completion berkdb bzip2 cairo cdr cli consolekit cracklib crypt cups cvs cxx dbus dri dvdr fontconfig fortran ftp gdbm gimp gnome gpm gtk gzip iconv imap ipv6 jadetex java6 javascript jpeg mmx modules mudflap multilib ncurses nls nptl nptlonly opengl openmp pam pcre perl php png pppd python readline samba session sharedmem source sse sse2 ssl static-libs subversion sysfs tcl tcpd tiff tk tokenizer truetype unicode usb vim-syntax xml xorg zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LINGUAS, MAKEOPTS, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


Lars Wendler (Polynomial-C) (RETIRED)






          2011-04-09 18:11:42 UTC
        

This is quite strange. I just tried to compile webkit-gtk with the libpng15 patch and it didn't fail. Can you please re-sync your portage-tree and tray again?




Comment 2


Lars Wendler (Polynomial-C) (RETIRED)






          2011-04-09 18:12:26 UTC
        

Damn typos!

I mean "try" not "tray" :)




Comment 3


Chris Pabst





          2011-04-09 18:17:43 UTC
        

Lars,

The issue is that libpng 1.5 is not on my system. It is showing as masked (or just no available) on the package page for libpng.

http://packages.gentoo.org/package/media-libs/libpng

So it is blowing up when trying to build against libpng 1.4.5.

Is there a way you can check that?

Thanks
Chris




Comment 4


Rafał Mużyło





          2011-04-09 18:57:09 UTC
        

No, the issue is that you, after not updating for awhile, still managed to get an outdated tree.

The problem with that patch was solved less than a day later, on Apr 5 17:00:11 2011 UTC (you may see the commit log, if you really need to).

Those libpng 1.5 patches are added to the tree, so once 1.5 is keyworded, the tree is ready for it.

Though in case of this patch, I still see two deprecation warnings left - I do hope, the patch doesn't need re-fixing.




Comment 5


Chris Pabst





          2011-04-09 22:14:37 UTC
        

Yup, that was it. I ran emerge --sync again, removed my local mask on webkit-gtk, and webkit-gtk1.2.7 is installing right now. Thanks for the info, and I believe this bug can be closed.

Thanks
Chris




Comment 6


Lars Wendler (Polynomial-C) (RETIRED)






          2011-04-10 06:27:01 UTC
        

Let's close this bug.

Thanks for your report even though it has turned out to be no real bug and don't hesitate to file new reports in case you find bugs :)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

