Title: 466888 – =x11-drivers/xf86-video-intel-2.21.6 - Stabilization request. (was: sys-kernel/hardened-sources-3.8.3 - i915 - PCI ID: 0x0166 - IER: 0xb0403529 - Hangcheck timer elapsed... GPU hung.)
URL: https://bugs.gentoo.org/show_bug.cgi?id=466888

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 466888
=x11-drivers/xf86-video-intel-2.21.6 - Stabilization request. (was: sys-kernel/hardened-sources-3.8.3 - i915 - PCI ID: 0x0166 - IER: 0xb0403529 - Hangcheck timer elapsed... GPU hung.)
Last modified: 2013-07-04 14:22:02 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 466888 
      - =x11-drivers/xf86-video-intel-2.21.6 - Stabilization request. (was: sys-kernel/hardened-sources-3.8.3 - i915 - PCI ID: 0x0166 - IER: 0xb0403529 - Hangcheck timer elapsed... GPU hung.)


Summary:
=x11-drivers/xf86-video-intel-2.21.6 - Stabilization request. (was: sys-kerne...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo X packagers








URL:



https://bugs.freedesktop.org/show_bug...
        




Whiteboard:




Keywords:

STABLEREQ







Depends on:







Blocks:









 





      Reported:
    
2013-04-23 10:44 UTC by Anton Bolshakov





      Modified:
    
2013-07-04 14:22 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



hardened-kernel+disabled
kernel
roman.zilka
zerochaos









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Xorg.log

              (Xorg.0.log,40.98 KB,
                text/plain)

            
2013-04-23 15:38 UTC,

            Anton Bolshakov




Details





i915_error_state

              (i915_error_state.bz2,173.71 KB,
                application/x-bzip)

            
2013-04-23 15:43 UTC,

            Anton Bolshakov




Details





i915_error_state-mesa911.bz2

              (i915_error_state-mesa911.bz2,165.14 KB,
                text/plain)

            
2013-04-23 23:51 UTC,

            Anton Bolshakov




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Anton Bolshakov





          2013-04-23 10:44:04 UTC
        

I have upgraded hardened kernel from 3.7.5-r1 to 3.8.3 
and hit the following bug:

[  113.501373] [drm:i915_hangcheck_hung] *ERROR* Hangcheck timer elapsed... GPU hung
[  113.501376] [drm] capturing error event; look for more information in /debug/dri/0/i915_error_state
[  113.504650] [drm:kick_ring] *ERROR* Kicking stuck wait on render ring
[  121.474393] [drm:i915_hangcheck_hung] *ERROR* Hangcheck timer elapsed... GPU hung

My workstation freezes for a while during it so it's a major issue.
I have found a similar bug report:
https://bugs.freedesktop.org/show_bug.cgi?id=54226

I don't think it has anything to do with hardened, so CC to core team.

emerge --info
Portage 2.1.11.55 (gentoo/hardened/linux/amd64, gcc-4.6.3, glibc-2.15-r3, 3.8.3-hardened x86_64)
=================================================================
System uname: Linux-3.8.3-gentoo-x86_64-Intel-R-_Core-TM-_i5-3320M_CPU_@_2.60GHz-with-gentoo-2.1
KiB Mem:     7984216 total,   6717516 free
KiB Swap:    4194300 total,   4194300 free
Timestamp of tree: Mon, 22 Apr 2013 23:15:01 +0000
ld GNU ld (GNU Binutils) 2.22
app-shells/bash:          4.2_p37
dev-java/java-config:     2.1.12-r1
dev-lang/python:          2.7.3-r3, 3.2.3-r2
dev-util/cmake:           2.8.9
dev-util/pkgconfig:       0.28
sys-apps/baselayout:      2.1-r1
sys-apps/openrc:          0.11.8::pentoo
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.4_p6-r1, 1.10.3, 1.11.6, 1.12.6
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.6.3
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4-r4
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.7 (virtual/os-headers)
sys-libs/glibc:           2.15-r3
Repositories: gentoo pentoo steam-overlay local-overlay
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA PUEL AdobeFlash-11.x Google-TOS dlj-1.1 google-chrome Oracle-BCLA-JavaSE Intel-SDP"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -mtune=generic -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/openvpn/easy-rsa /usr/share/polkit-1/actions"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=core2 -mtune=generic -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS=""
FCFLAGS="-O2 -pipe -frecord-gcc-switches"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync multilib-strict news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe -frecord-gcc-switches"
GENTOO_MIRRORS="http://mirror.nus.edu.sg/gentoo"
INSTALL_MASK="*.la"
LDFLAGS="-Wl,-O1 -Wl,--as-needed -Wl,--hash-style=gnu"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_BZIP2_COMMAND="lbzip2"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/pentoo /var/lib/layman/steam /usr/local/portage"
SYNC="rsync://rsync6.tw.gentoo.org/gentoo-portage/"
USE="X a52 aac acl acpi adns alsa amd64 berkdb branding bzip2 cairo caps cdda cli consolekit cracklib crypt cups curl cxx dbus directfb dri dts dvdr emboss encode exif fbcon firefox flac fortran gdbm gif gpm gtk hardened iconv ipv6 jack jpeg justify kde lcms libnotify lm_sensors lua lzma mad mmx mng modules mp3 mp4 mpeg mudflap multilib ncurses networkmanager nls nptl ogg opengl openmp orc oss pam pango pax_kernel pcre pdf perl png policykit ppds pulseaudio python qt3support qt4 readline ruby samba sdl session spell sqlite sse sse2 ssl startup-notification subversion svg tcpd tiff truetype udev udisks unicode upower urandom usb vorbis wxwidgets x264 xattr xcb xinerama xml xv xvid zlib" ABI_X86="32 64" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" GRUB_PLATFORMS="coreboot efi-32 efi-64 emu multiboot pc qemu" INPUT_DEVICES="evdev keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="pdfimport" LINGUAS="en ru" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-3" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_2" QEMU_SOFTMMU_TARGETS="arm i386 x86_64" QEMU_USER_TARGETS="arm i386 x86_64" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="fbdev vesa intel" XFCE_PLUGINS="brightness menu logout trash" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, LANG, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON

lspci | grep VGA
00:02.0 VGA compatible controller: Intel Corporation 3rd Gen Core processor Graphics Controller (rev 09)




Comment 1


Anthony Basile






          2013-04-23 14:21:48 UTC
        

This is not a hardened issue.




Comment 2


Anton Bolshakov





          2013-04-23 15:38:09 UTC
        

Created attachment 346384 [details]
Xorg.log




Comment 3


Anton Bolshakov





          2013-04-23 15:43:28 UTC
        

Created attachment 346386 [details]
i915_error_state




Comment 4


Tom Wijsman (TomWij) (RETIRED)






          2013-04-23 16:51:08 UTC
        

> I have found a similar bug report:
> https://bugs.freedesktop.org/show_bug.cgi?id=54226

Similar, but not the same; the IER in the error state is different.

Searching the IER yielded me the bug I've placed in the URL field above, it appears that this may be fixed in Mesa; so, please try to unmask and emerge =media-libs/mesa-9.1.1 to see whether that version works. If so, please let us know. If not, you may want to wait for the next version to be released.




Comment 5


Anton Bolshakov





          2013-04-23 23:51:57 UTC
        

Created attachment 346422 [details]
i915_error_state-mesa911.bz2

unfortunately, the bug is still there after upgrading to mesa-9.1.1.
The error state is slightly different, see the attachment




Comment 6


Anton Bolshakov





          2013-04-24 22:08:33 UTC
        

There is intel_drv error in the xorg.log, so I went ahead and upgraded intel video driver to the latest:
x11-drivers/xf86-video-intel-2.21.6

That seems fixed it.




Comment 7


Mike Pagano






          2013-04-24 23:44:00 UTC
        

Great news




Comment 8


Rick Farina (Zero_Chaos)






          2013-04-25 00:01:50 UTC
        

(In reply to comment #7)
> Great news

A stable kernel requires two unstable packages to not crash.  Pretty sure it's not appropriate to close this... we need mesa-9.1.1 and x11-drivers/xf86-video-intel-2.21.6 stabilized to close this...




Comment 9


Anton Bolshakov





          2013-04-25 01:48:24 UTC
        

I downgraded everything back to stable and done more testing.

There is only 1 driver requires stabilisation:
=x11-drivers/xf86-video-intel-2.21.3

But again, that's my bug specifically and I'm not sure about the id=54226.
You might still want to stabilize a higher version mesa. It's better to check with xorg team.

So apparently, hardened team is involved, because they stabilized 3.8.x without waiting for the gentoo-sources at least. Please let them know not to do it in future.




Comment 10


Roman Žilka





          2013-04-30 11:03:23 UTC
        

The new hardened stable is probably due to bug 467758.




Comment 11


Roman Žilka





          2013-04-30 11:07:42 UTC
        

By the way, I ran into almost identical (mis)behavior / log messages. I could fix it by re-emerging xf86-video-intel (2.20.13) with USE="uxa". In total: "dri sna udev uxa -glamor -xvmc".




Comment 12


Roman Žilka





          2013-04-30 11:14:22 UTC
        

media-libs/mesa-9.0.1  USE="classic egl g3dvl gallium llvm nptl pax_kernel shared-glapi vdpau -bindist -debug -gbm -gles1 -gles2 -openvg -osmesa -pic -r600-llvm-compiler (-selinux) (-wayland) -xa -xorg -xvmc" VIDEO_CARDS="i965 intel -i915 -nouveau -r100 -r200 -r300 -r600 -radeon -radeonsi -vmware"

x11-base/xorg-server-1.13.4:0/1.13.4  USE="nptl udev xorg xvfb -dmx -doc -ipv6 -kdrive -minimal (-selinux) -static-libs -suid -tslib -xnest"

# eselect mesa list
64bit i915 (Intel 915, 945)
  [1]   gallium *
64bit i965 (Intel 965, G/Q3x, G/Q4x)
  [1]   classic *
64bit r300 (Radeon R300-R500)
64bit r600 (Radeon R600-R700, Evergreen, Northern Islands)
64bit sw (Software renderer)
  [1]   classic
  [2]   gallium *
32bit i915 (Intel 915, 945)
  [1]   classic
  [2]   gallium *
32bit i965 (Intel 965, G/Q3x, G/Q4x)
  [1]   classic *
32bit r300 (Radeon R300-R500)
  [1]   gallium *
32bit r600 (Radeon R600-R700, Evergreen, Northern Islands)
  [1]   gallium *
32bit sw (Software renderer)
  [1]   classic
  [2]   gallium *




Comment 13


Tom Wijsman (TomWij) (RETIRED)






          2013-07-04 12:55:41 UTC
        

Hmm, seems they lost track of this; bumped & reassigned.




Comment 14


Chí-Thanh Christopher Nguyễn






          2013-07-04 13:05:43 UTC
        

Stabilization of xf86-video-intel-2.21.11 is handled in bug 475480.




Comment 15


Anton Bolshakov





          2013-07-04 14:22:02 UTC
        

ok, the package is in stabilization list.
I'm closing this bug then. Thanks!









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

