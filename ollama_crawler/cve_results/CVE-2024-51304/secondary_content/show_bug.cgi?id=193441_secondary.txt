Title: 193441 – /sbin/rc ignoring RC_DEVICES setting of "static" in /etc/conf.d/rc and starting udevd anyway
URL: https://bugs.gentoo.org/show_bug.cgi?id=193441

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 193441
/sbin/rc ignoring RC_DEVICES setting of "static" in /etc/conf.d/rc and starting udevd anyway
Last modified: 2007-09-30 11:53:40 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 193441 
      - /sbin/rc ignoring RC_DEVICES setting of "static" in /etc/conf.d/rc and starting udevd anyway


Summary:
/sbin/rc ignoring RC_DEVICES setting of "static" in /etc/conf.d/rc and starti...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-09-22 19:17 UTC by Michael Weiser





      Modified:
    
2007-09-30 11:53 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michael Weiser





          2007-09-22 19:17:18 UTC
        

When setting RC_DEVICES="static", udevd is started anyway. When putting

RC_DEVICES="static"

just before

if [ "${RC_DEVICES}" = "static" ]

in /sbin/rc, udevd is not started, as expected. It seems that /etc/conf.d/rc settings are not correctly sourced or otherwise not honoured.

Reproducible: Always

Steps to Reproduce:
1. set RC_DEVICES="static"
2. reboot
Actual Results:  
# grep RC_DEVICES /etc/conf.d/rc
RC_DEVICES="static"
# pstree | grep udevd
     |-udevd
#

Expected Results:  
# grep RC_DEVICES /etc/conf.d/rc
RC_DEVICES="static"
# pstree | grep udevd
# 


This was observed on Buffalo Linkstations running current ~ppc and ~arm Gentoo Linux. Since they're embedded devices without lots of RAM and hardware changes, it actually makes sense, to run them with a static /dev.




Comment 1


SpanKY






          2007-09-22 22:26:18 UTC
        

please post `emerge --info` like the bug reporting page told you to




Comment 2


Michael Weiser





          2007-09-23 11:45:33 UTC
        

Sorry.

Linkstation Pro (~arm):

Portage 2.1.3.9 (!../usr/local/portage/profiles/eldalonde, gcc-4.2.0, glibc-2.6.1-r0, 2.6.22-ls-gl armv5tejl)
=================================================================
System uname: 2.6.22-ls-gl armv5tejl ARM926EJ-S rev 0 (v5l)
Timestamp of tree: Fri, 21 Sep 2007 18:30:01 +0000
distcc 2.18.3 armv5tejl-unknown-linux-gnueabi (protocols 1 and 2) (default port 3632) [enabled]
app-shells/bash:     3.2_p17-r1
dev-lang/python:     2.5.1-r2
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.10-r4
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18
sys-devel/gcc-config: 1.4.0-r2
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r2
ACCEPT_KEYWORDS="arm ~arm"
CBUILD="armv5tejl-unknown-linux-gnueabi"
CFLAGS="-O2 -pipe -mcpu=arm926ej-s -fomit-frame-pointer"
CHOST="armv5tejl-unknown-linux-gnueabi"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O2 -pipe -mcpu=arm926ej-s -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="distcc distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror/ ftp://ftp.uni-erlangen.de/pub/mirrors/gentoo ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo ftp://ftp.wh2.tu-dresden.de/pub/mirrors/gentoo ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_EXTRA_OPTS="--exclude-from=/etc/portage/rsync_excludes"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="arm bzip2 cracklib crypt iconv idn kerberos midi ncurses nptl nptlonly pam pcre perl python readline recode ssl tcpd xinetd zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="chips dummy fbdevglint mach64 mga nv r128 radeon s3 s3virge savage sisusb tdfx trident v4l vga voodoo"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS

Linkstation HG (~ppc):
Portage 2.1.3.9 (!/usr/local/portage/profiles/nogrod, gcc-4.2.0, glibc-2.6.1-r0, 2.6.22-gentoo-r6 ppc)
=================================================================
System uname: 2.6.22-gentoo-r6 ppc 82xx
Timestamp of tree: Fri, 21 Sep 2007 18:30:01 +0000
distcc 2.18.3 powerpc-unknown-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
app-shells/bash:     3.2_p17-r1
dev-lang/python:     2.4.4-r4, 2.5.1-r2
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.10-r4
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18
sys-devel/gcc-config: 1.4.0-r2
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r2
ACCEPT_KEYWORDS="ppc ~ppc"
CBUILD="powerpc-unknown-linux-gnu"
CFLAGS="-O2 -mcpu=603e -fno-strict-aliasing -pipe -fsigned-char"
CHOST="powerpc-unknown-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O2 -mcpu=603e -fno-strict-aliasing -pipe -fsigned-char"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror/ ftp://ftp.uni-erlangen.de/pub/mirrors/gentoo ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo ftp://ftp.wh2.tu-dresden.de/pub/mirrors/gentoo ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_EXTRA_OPTS="--exclude-from=/etc/portage/rsync_excludes"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="cracklib crypt iconv kerberos kuro libwww mbox midi ncurses nptl nptlonly pam pcre perl ppc python readline recode ssl tcpd xinetd zlib" ALSA_CARDS="aoa aoa-fabric-layout aoa-onyx aoa-soundbus aoa-soundbus-i2s aoa-tas aoa-toonie powermac usb-audio via82xx" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="chips dummy fbdev glint imstt mach64 mga nv r128 radeon s3 s3virge savage sisusb tdfx trident v4l voodoo"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS





Comment 3


SpanKY






          2007-09-30 03:03:14 UTC
        

unable to reproduce with baselayout-1.12.10-r4 and udev-114

/sbin/rc clearly pulls in /sbin/functions.sh which clearly pulls in /etc/conf.d/rc (these are the first things done in each file)

this should work:
(source /sbin/functions.sh ; echo $RC_DEVICES)

if it doesnt, source the file with `set -x` to find out where it's going wrong




Comment 4


Michael Weiser





          2007-09-30 11:47:41 UTC
        

Sorry, I'm a moron. I could have sworn, it was reproducible. Now, of course, it isn't. Most likely cause for udevd running now seems to me an emerge -atuND I did which emerged udev which in turn started it after installing. This would be a different bug entirely. Sorry I wasted your time. It works as expected now.




Comment 5


SpanKY






          2007-09-30 11:53:40 UTC
        

dont worry about it, happens to everyone









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

