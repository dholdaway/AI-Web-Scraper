Title: 313237 – mail-client/mozilla-thunderbird-3.0.3-r2 slow and segf
URL: https://bugs.gentoo.org/show_bug.cgi?id=313237

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 313237
mail-client/mozilla-thunderbird-3.0.3-r2 slow and segf
Last modified: 2010-04-18 17:13:33 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 313237 
      - mail-client/mozilla-thunderbird-3.0.3-r2 slow and segf


Summary:
mail-client/mozilla-thunderbird-3.0.3-r2 slow and segf
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Mozilla Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-04-05 14:34 UTC by Justin Lecher (RETIRED)





      Modified:
    
2010-04-18 17:13 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge.info

              (emerge.info,4.64 KB,
                text/plain)

            
2010-04-08 06:34 UTC,

            Justin Lecher (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Justin Lecher (RETIRED)






          2010-04-05 14:34:12 UTC
        

So it is really slow in loading IMAP mails and segf. I don't know where it comes from

Program received signal SIGSEGV, Segmentation fault.
nsQueryInterface::operator() (this=<value optimized out>, aIID=..., answer=0x7fffffffbcb8) at nsCOMPtr.cpp:47
47	nsCOMPtr.cpp: No such file or directory.
	in nsCOMPtr.cpp
(gdb) bt
#0  nsQueryInterface::operator() (this=<value optimized out>, aIID=..., answer=0x7fffffffbcb8) at nsCOMPtr.cpp:47
#1  0x00002aaaaad167cc in nsCOMPtr_base::assign_from_qi (this=0x7fffffffbd00, qi=..., iid=...) at nsCOMPtr.cpp:96
#2  0x00002aaab29e1ea0 in nsCOMPtr (this=0x2aaabb07df60, url=<value optimized out>, exitCode=<value optimized out>) at ../../../mozilla/dist/include/xpcom/nsCOMPtr.h:572
#3  nsImapIncomingServer::OnStopRunningUrl (this=0x2aaabb07df60, url=<value optimized out>, exitCode=<value optimized out>) at nsImapIncomingServer.cpp:2353
#4  0x00002aaab28b2317 in nsMsgMailNewsUrl::SetUrlState (this=0x2aaabe4d8008, aRunningUrl=<value optimized out>, aExitCode=0) at nsMsgMailNewsUrl.cpp:135
#5  0x00002aaab29f31d5 in nsImapMailFolder::SetUrlState (this=0x2aaac3306800, aProtocol=0x2aaac6374000, aUrl=0x2aaabe4d8008, isRunning=0, statusCode=0) at nsImapMailFolder.cpp:6604
#6  0x00002aaaaad6267f in NS_InvokeByIndex_P (that=0x8000003f, methodIndex=2997825744, paramCount=4294950072, params=0x1) at xptcinvoke_x86_64_linux.cpp:208
#7  0x00002aaaaad58fcb in nsProxyObjectCallInfo::Run (this=0x2aaabebb6540) at nsProxyEvent.cpp:181
#8  0x00002aaaaad53c91 in nsThread::ProcessNextEvent (this=0x2aaaae948160, mayWait=<value optimized out>, result=0x7fffffffbfcc) at nsThread.cpp:521
#9  0x00002aaaaad1c734 in NS_ProcessNextEvent_P (thread=0x8000003f, mayWait=-1297141552) at nsThreadUtils.cpp:247
#10 0x00002aaab4699385 in nsBaseAppShell::Run (this=0x2aaab27a2940) at nsBaseAppShell.cpp:170
#11 0x00002aaab587d91e in nsAppStartup::Run (this=0x2aaab27fb300) at nsAppStartup.cpp:193
#12 0x00002aaaaaac742c in XRE_main (argc=<value optimized out>, argv=<value optimized out>, aAppData=<value optimized out>) at nsAppRunner.cpp:3321
#13 0x00000000004018c0 in main (argc=3, argv=0x7fffffffc838) at nsMailApp.cpp:103




Comment 1


Justin Lecher (RETIRED)






          2010-04-05 16:44:42 UTC
        

nsQueryInterface::operator() (this=<value optimized out>, aIID=..., answer=0x7fffffffb758) at nsCOMPtr.cpp:47
47	nsCOMPtr.cpp: No such file or directory.
	in nsCOMPtr.cpp
(gdb) bt
#0  nsQueryInterface::operator() (this=<value optimized out>, aIID=..., answer=0x7fffffffb758) at nsCOMPtr.cpp:47
#1  0x00002aaaaad167cc in nsCOMPtr_base::assign_from_qi (this=0x7fffffffb7a0, qi=..., iid=...) at nsCOMPtr.cpp:96
#2  0x00002aaab29e1ea0 in nsCOMPtr (this=0x2aaabb085f60, url=<value optimized out>, exitCode=<value optimized out>) at ../../../mozilla/dist/include/xpcom/nsCOMPtr.h:572
#3  nsImapIncomingServer::OnStopRunningUrl (this=0x2aaabb085f60, url=<value optimized out>, exitCode=<value optimized out>) at nsImapIncomingServer.cpp:2353
#4  0x00002aaab28b2317 in nsMsgMailNewsUrl::SetUrlState (this=0x2aaabb5f3008, aRunningUrl=<value optimized out>, aExitCode=0) at nsMsgMailNewsUrl.cpp:135
#5  0x00002aaab29f31d5 in nsImapMailFolder::SetUrlState (this=0x2aaac31f7400, aProtocol=0x2aaac44f8800, aUrl=0x2aaabb5f3008, isRunning=0, statusCode=0) at nsImapMailFolder.cpp:6604
#6  0x00002aaaaad6267f in NS_InvokeByIndex_P (that=0x8000001f, methodIndex=2997825744, paramCount=4294948696, params=0x1) at xptcinvoke_x86_64_linux.cpp:208
#7  0x00002aaaaad58fcb in nsProxyObjectCallInfo::Run (this=0x2aaabf06b040) at nsProxyEvent.cpp:181
#8  0x00002aaaaad53c91 in nsThread::ProcessNextEvent (this=0x2aaaae948160, mayWait=<value optimized out>, result=0x7fffffffba6c) at nsThread.cpp:521
#9  0x00002aaaaad1c734 in NS_ProcessNextEvent_P (thread=0x8000001f, mayWait=-1297141552) at nsThreadUtils.cpp:247
#10 0x00002aaaaad5469f in nsThread::Shutdown (this=0x2aaac3d1f6b0) at nsThread.cpp:468
#11 0x00002aaabcc1612b in nsStdoutPoller::Join (this=0x2aaabd14fce0) at nsPipeTransport.cpp:2010
#12 0x00002aaabcc16420 in nsPipeTransport::Join (this=0x2aaac1fcd410) at nsPipeTransport.cpp:630
#13 0x00002aaabcc11a29 in nsEnigMimeVerify::Finish (this=0x2aaabd14f6a0) at nsEnigMimeVerify.cpp:338
#14 0x00002aaabcc12109 in nsEnigMimeVerify::OnStopRequest (this=0x2aaabd14f6a0, aRequest=<value optimized out>, aContext=<value optimized out>, aStatus=<value optimized out>) at nsEnigMimeVerify.cpp:676
#15 0x00002aaabcc1f6cb in nsPipeFilterListener::OnStopRequest (this=0x2aaac47d0200, aRequest=0x2aaac1ae3530, aContext=0x0, aStatus=0) at nsPipeFilterListener.cpp:662
#16 0x00002aaabcc0e753 in nsEnigMimeListener::OnStopRequest (this=0x2aaabedc4540, aRequest=0x2aaac1ae3530, aContext=0x0, aStatus=0) at nsEnigMimeListener.cpp:415
#17 0x00002aaabcc1f6cb in nsPipeFilterListener::OnStopRequest (this=0x2aaac47d0800, aRequest=0x2aaac1ae3530, aContext=0x0, aStatus=0) at nsPipeFilterListener.cpp:662
#18 0x00002aaabcc1f699 in nsPipeFilterListener::OnStopRequest (this=0x2aaac47d0900, aRequest=0x2aaac1ae3530, aContext=0x7fffffffb758, aStatus=0) at nsPipeFilterListener.cpp:654
#19 0x00002aaabcc0e753 in nsEnigMimeListener::OnStopRequest (this=0x2aaabedc4780, aRequest=0x2aaac1ae3530, aContext=0x0, aStatus=0) at nsEnigMimeListener.cpp:415
#20 0x00002aaab2a0b8e6 in nsImapCacheStreamListener::OnStopRequest (this=0x2aaac7b183a0, request=<value optimized out>, aCtxt=0x7fffffffb758, aStatus=1) at nsImapProtocol.cpp:8337
#21 0x00002aaab323e11f in nsInputStreamPump::OnStateStop (this=0x2aaac3574ac0) at nsInputStreamPump.cpp:576
#22 0x00002aaab323e4b8 in nsInputStreamPump::OnInputStreamReady (this=0x2aaac3574ac0, stream=0x2aaab2af30d0) at nsInputStreamPump.cpp:401
#23 0x00002aaaaad3c7cc in nsInputStreamReadyEvent::Run (this=0x2aaac3a7e7c0) at nsStreamUtils.cpp:111
#24 0x00002aaaaad53c91 in nsThread::ProcessNextEvent (this=0x2aaaae948160, mayWait=<value optimized out>, result=0x7fffffffbfcc) at nsThread.cpp:521
#25 0x00002aaaaad1c734 in NS_ProcessNextEvent_P (thread=0x8000001f, mayWait=-1297141552) at nsThreadUtils.cpp:247
#26 0x00002aaab4699385 in nsBaseAppShell::Run (this=0x2aaab27a3ac0) at nsBaseAppShell.cpp:170
#27 0x00002aaab587d91e in nsAppStartup::Run (this=0x2aaab54039c0) at nsAppStartup.cpp:193
#28 0x00002aaaaaac742c in XRE_main (argc=<value optimized out>, argv=<value optimized out>, aAppData=<value optimized out>) at nsAppRunner.cpp:3321
#29 0x00000000004018c0 in main (argc=3, argv=0x7fffffffc838) at nsMailApp.cpp:103





Comment 2


Justin Lecher (RETIRED)






          2010-04-05 16:46:18 UTC
        

Additionally I often see things like
[Thread 0x2aaacbe00910 (LWP 30331) exited]
2010-04-05 18:39:43	autosyncActivities	ERROR	OnDownloadError: Deleted of jlec@gentoo.org





Comment 3


Jory A. Pratt






          2010-04-08 04:32:39 UTC
        

jlec you of all people know we need your emerge --info, Please test 3.0.4 quite a few stability issues have been addressed that should help with your segfault. Please let us know.




Comment 4


Justin Lecher (RETIRED)






          2010-04-08 06:34:16 UTC
        

(In reply to comment #3)
> jlec you of all people know we need your emerge --info, Please test 3.0.4 quite
> a few stability issues have been addressed that should help with your segfault.
> Please let us know.
> 

Sorry for that, but I was so pissed, because it is hard to work if you mail client crashes all time.

So it happens on every amd64 box I am running. I am not sure what package causes the problem, butit might be that it is fixed in 3.0.4. I will report back later.





Comment 5


Justin Lecher (RETIRED)






          2010-04-08 06:34:58 UTC
        

Created attachment 226967 [details]
emerge.info

emerge --info




Comment 6


Justin Lecher (RETIRED)






          2010-04-08 17:55:49 UTC
        

I am sorry, but it doesn't fix it. Still seqfaulting and slow imap.




Comment 7


Jory A. Pratt






          2010-04-08 22:58:54 UTC
        

Justin give me your useflags on mozilla-thunderbird please.




Comment 8


Justin Lecher (RETIRED)






          2010-04-09 06:14:27 UTC
        

alsa crypt custom-optimization dbus gnome ldap lightning linguas_de startup-notification system-sqlite

But I also tried -custom-optimization -system-sqlite, which doesn't work.




Comment 9


Justin Lecher (RETIRED)






          2010-04-09 11:22:37 UTC
        

 bt
#0  0x00002aaaab14f10e in nsQueryInterface::operator()(nsID const&, void**) const () from /usr/lib64/mozilla-thunderbird/libxpcom_core.so
#1  0x00002aaaab14f222 in nsCOMPtr_base::assign_from_qi(nsQueryInterface, nsID const&) () from /usr/lib64/mozilla-thunderbird/libxpcom_core.so
#2  0x00002aaab9ca2b25 in ?? () from /usr/lib64/mozilla-thunderbird/components/libmail.so
#3  0x00002aaab9ba970c in ?? () from /usr/lib64/mozilla-thunderbird/components/libmail.so
#4  0x00002aaab9cab2a1 in ?? () from /usr/lib64/mozilla-thunderbird/components/libmail.so
#5  0x00002aaaab188216 in NS_InvokeByIndex_P () from /usr/lib64/mozilla-thunderbird/libxpcom_core.so
#6  0x00002aaaab181333 in ?? () from /usr/lib64/mozilla-thunderbird/libxpcom_core.so
#7  0x00002aaaab17d53b in ?? () from /usr/lib64/mozilla-thunderbird/libxpcom_core.so
#8  0x00002aaaab153430 in NS_ProcessNextEvent_P(nsIThread*, int) () from /usr/lib64/mozilla-thunderbird/libxpcom_core.so
#9  0x00002aaabb8d2661 in ?? () from /usr/lib64/mozilla-thunderbird/components/libwidget_gtk2.so
#10 0x00002aaabd0dd784 in ?? () from /usr/lib64/mozilla-thunderbird/components/libtoolkitcomps.so
#11 0x00002aaaaaf024fa in XRE_main () from /usr/lib64/mozilla-thunderbird/libxul.so
#12 0x00000000004018ab in ?? ()
#13 0x00002aaaab3e9ba6 in __libc_start_main () from /lib/libc.so.6
#14 0x0000000000401699 in ?? ()
#15 0x00007fffffffc908 in ?? ()
#16 0x000000000000001c in ?? ()
#17 0x0000000000000003 in ?? ()
#18 0x00007fffffffd009 in ?? ()
#19 0x00007fffffffd038 in ?? ()
#20 0x00007fffffffd03b in ?? ()
#21 0x0000000000000000 in ?? ()





Comment 10


Justin Lecher (RETIRED)






          2010-04-10 09:52:56 UTC
        

So -safe-mode and al combinations of sqlite and optimizations have no effect





Comment 11


Justin Lecher (RETIRED)






          2010-04-12 12:31:16 UTC
        

The slowness happens with all versions of thunderbird{-bin} in the tree.
Disabling all plugins and recreating the profile, doesn't help.




Comment 12


Justin Lecher (RETIRED)






          2010-04-13 09:51:57 UTC
        

So I think the slowness seems to be fixed. It was probably some kind of problem with the server. But I will continue looking at it.

I also have the requested strace. Please ping me on irc.




Comment 13


Justin Lecher (RETIRED)






          2010-04-16 07:08:40 UTC
        

I don't know how or why, but it seems to be fixed.




Comment 14


Jory A. Pratt






          2010-04-18 17:13:33 UTC
        

(In reply to comment #13)
> I don't know how or why, but it seems to be fixed.
> 

Closing. Reopen if bug should show its face again.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

