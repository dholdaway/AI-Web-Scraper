Title: 90027 – after merging glibc-2.3.5 my aterm-1.00_beta2 segfaults... all efforts to remerge aterm and get it back to work correctly havent succeeded yet
URL: https://bugs.gentoo.org/show_bug.cgi?id=90027

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 90027
after merging glibc-2.3.5 my aterm-1.00_beta2 segfaults... all efforts to remerge aterm and get it back to work correctly havent succeeded yet
Last modified: 2005-05-02 13:50:42 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 90027 
      - after merging glibc-2.3.5 my aterm-1.00_beta2 segfaults... all efforts to remerge aterm and get it back to work correctly havent succeeded yet


Summary:
after merging glibc-2.3.5 my aterm-1.00_beta2 segfaults... all efforts to rem...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Michal Januszewski (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-22 04:29 UTC by Nicolas Vilz





      Modified:
    
2005-05-02 13:50 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Nicolas Vilz





          2005-04-22 04:29:12 UTC
        

I upgraded glibc 2.3.4-20050125-r1 to 2.3.5. after that i couldn't start aterm anymore, it crashed with segmentation fault everytime. 
I tried to remerge several aterm, afterstep, libgif and tiff to get aterm back to work again, but didn't succeed (still segfault)
after downgrading glibc back to 2.3.4-20050125-r1, it worked correctly.

that happened on my x86 box... now i am about to upgrade glibc-2.3.4-20050125-r1 to 2.3.5 on my ppc-box, too, and i have a suspect, that aterm will crash again on this box... any hints how to cleanly upgrade glibc and use aterm again?

Reproducible: Always
Steps to Reproduce:
1.emerge =sys-libs/glibc-2.3.5
2.aterm # ---> segmentation fault
3.emerge =sys-libs/glibc-2.3.4-20050125-r1
4.aterm # ---> works again...

Actual Results:  
aterm should work on both glibc-versions...

Expected Results:  
aterm segfaultet

Portage 2.0.51.19 (default-linux/x86/2005.0, gcc-3.4.3-20050110,
glibc-2.3.4.20050125-r1, 2.6.11-gentoo-r4 i686)
=================================================================
System uname: 2.6.11-gentoo-r4 i686 AMD Athlon(tm) MP Processor 1900+
Gentoo Base System version 1.6.11
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Feb 18 2005, 19:00:50)]
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
dev-lang/python:     2.3.5
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.9.5, 1.5, 1.6.3, 1.4_p6, 1.8.5-r3, 1.7.9-r1
sys-devel/binutils:  2.15.92.0.2-r8
sys-devel/libtool:   1.5.14
virtual/os-headers:  2.6.11
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CFLAGS="-march=athlon-mp -O3 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env
/usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=athlon-mp -O3 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig candy ccache cvs distlocks sandbox sfperms
strict userpriv usersandbox"
GENTOO_MIRRORS="http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/mnt/gentoomirror/gatekeeper-temp/"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://gentoo-distfiles.local.nil.nul/gentoo-portage"
USE="x86 X aalib alsa apache2 apm arts avi bash-completion berkdb bitmap-fonts
cddb cdparanoia cdr crypt cups curl divx4linux dvd dvdr dvdread emboss encode
esd fam flac foomaticdb fortran gd gdbm gif gnome gpm gstreamer gtk gtk2
imagemagick imap imlib ipv6 jack java jpeg kde libg++ libwww mad mailbox maildir
mbox mikmod mmx motif mozilla mp3 mpeg mysql ncurses nls nntp nvidia ogg
oggvorbis opengl oss pam pdflib perl php png python qt quicktime readline ruby
sasl sdl slang spell sql sqlite sse ssl subversion svga tcltk tcpd tidy tiff
truetype truetype-fonts type1-fonts vhosts vorbis webdav xinerama xml xml2 xmms
xv xvid zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS

--

output of strace aterm follows:

--

open("/usr/lib/opengl/nvidia/lib/libGLcore.so.1", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\300H\v"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=7626156, ...}) = 0
mmap2(NULL, 7670696, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) =
0xb737d000
mmap2(0xb7a9e000, 114688, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x720) = 0xb7a9e000
mmap2(0xb7aba000, 80808, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xb7aba000
close(3)                                = 0
open("/usr/lib/opengl/nvidia/lib/libnvidia-tls.so.1", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0 \3\0\000"..., 512) = 512
lseek(3, 1272, SEEK_SET)                = 1272
read(3, "\4\0\0\0\20\0\0\0\1\0\0\0GNU\0\0\0\0\0\2\0\0\0\2\0\0\0"..., 32) = 32
fstat64(3, {st_mode=S_IFREG|0755, st_size=2320, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =
0xb737c000
mmap2(NULL, 5556, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0xb737a000
mmap2(0xb737b000, 4096, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0) = 0xb737b000
close(3)                                = 0
open("/lib/libdl.so.2", O_RDONLY)       = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\300\v\0"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=10948, ...}) = 0
mmap2(NULL, 12388, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) =
0xb7376000
mmap2(0xb7378000, 8192, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1) = 0xb7378000
close(3)                                = 0
open("//usr/lib/gcc/i686-pc-linux-gnu/3.4.3-20050110/tls/i686/libstdc++.so.6",
O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("//usr/lib/gcc/i686-pc-linux-gnu/3.4.3-20050110/tls/i686", 0xbfffe708) =
-1 ENOENT (No such file or directory)
open("//usr/lib/gcc/i686-pc-linux-gnu/3.4.3-20050110/tls/libstdc++.so.6",
O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("//usr/lib/gcc/i686-pc-linux-gnu/3.4.3-20050110/tls", 0xbfffe708) = -1
ENOENT (No such file or directory)
open("//usr/lib/gcc/i686-pc-linux-gnu/3.4.3-20050110/i686/libstdc++.so.6",
O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("//usr/lib/gcc/i686-pc-linux-gnu/3.4.3-20050110/i686", 0xbfffe708) = -1
ENOENT (No such file or directory)
open("//usr/lib/gcc/i686-pc-linux-gnu/3.4.3-20050110/libstdc++.so.6", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\300\265"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=828300, ...}) = 0
mmap2(NULL, 842932, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) =
0xb72a8000
mmap2(0xb736c000, 20480, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0xc4) = 0xb736c000
mmap2(0xb7371000, 19636, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0xb7371000
close(3)                                = 0
open("//usr/lib/gcc/i686-pc-linux-gnu/3.4.3-20050110/libgcc_s.so.1", O_RDONLY) = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\200\25"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0644, st_size=37232, ...}) = 0
mmap2(NULL, 34052, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) =
0xb729f000
mmap2(0xb72a7000, 4096, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x7) = 0xb72a7000
close(3)                                = 0
open("/usr/lib/libXt.so.6", O_RDONLY)   = 3
read(3, "\177ELF\1\1\1\0\0\0\0\0\0\0\0\0\3\0\3\0\1\0\0\0\240\276"..., 512) = 512
fstat64(3, {st_mode=S_IFREG|0755, st_size=418252, ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =
0xb729e000
mmap2(NULL, 380252, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) =
0xb7241000
mmap2(0xb729a000, 16384, PROT_READ|PROT_WRITE,
MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x58) = 0xb729a000
close(3)                                = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =
0xb7240000
mprotect(0xb737a000, 4096, PROT_READ|PROT_WRITE) = 0
mprotect(0xb737a000, 4096, PROT_READ|PROT_EXEC) = 0
mprotect(0xb737d000, 7475200, PROT_READ|PROT_WRITE) = 0
mprotect(0xb737d000, 7475200, PROT_READ|PROT_EXEC) = 0
mprotect(0xb7bf9000, 4096, PROT_READ)   = 0
mprotect(0xb7ef2000, 393216, PROT_READ|PROT_WRITE) = 0
mprotect(0xb7ef2000, 393216, PROT_READ|PROT_EXEC) = 0
set_thread_area({entry_number:-1 -> 6, base_addr:0xb72406c0, limit:1048575,
seg_32bit:1, contents:0, read_exec_only:0, limit_in_pages:1, seg_not_present:0,
useable:1}) = 0
munmap(0xb7fc8000, 131830)              = 0
brk(0)                                  = 0x806a000
brk(0x808b000)                          = 0x808b000
open("/dev/zero", O_RDWR)               = 3
mmap2(NULL, 8192, PROT_READ|PROT_WRITE|PROT_EXEC, MAP_PRIVATE, 3, 0) = 0xb7fe7000
close(3)                                = 0
getpid()                                = 14489
mmap2(NULL, 622592, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) =
0xb71a8000
getpid()                                = 14489
modify_ldt(17, {entry_number:666, base_addr:0x806a350, limit:512, seg_32bit:1,
contents:0, read_exec_only:0, limit_in_pages:0, seg_not_present:0, useable:1},
16) = 0
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV +++

--
gatekeeper ~ # emerge -pv x11-terms/aterm

These are the packages that I would merge, in order:

Calculating dependencies  ...done!
[ebuild   R   ] x11-terms/aterm-1.00_beta2  -cjk -debug -xgetdefault




Comment 1


Nicolas Vilz





          2005-04-22 04:39:31 UTC
        

I run on 2.3.4-20050125-r1 now so that i am able to use aterm (with fvwm-crystal), the strace-output was with 2.3.5 




Comment 2


Michal Januszewski (RETIRED)






          2005-04-24 13:34:29 UTC
        

Is aterm the only application that misbehaves after the glibc upgrade? Can you try merging an older version of aterm (0.4.2-x) to see whether it works with the new glibc?




Comment 3


Nicolas Vilz





          2005-04-24 16:31:31 UTC
        

i tried 0.4.2-r13 and it works ... strange... i haven't notice any other misbehaviour, yet, but i keep watching... 




Comment 4


Nicolas Vilz





          2005-04-25 00:54:15 UTC
        

on my ppc-box i had aterm 0.4.2-r11 and it worked fine after upgrading glibc... i am trying to upgrade to 0.4.2.r13 now... 




Comment 5


Nicolas Vilz





          2005-04-26 21:57:18 UTC
        

ok guys, i got errors on restarting xorg-x11, i only got 

Symbol __glXgetActiveScreen from module /usr/lib/modules/extensions/libdri.a is unresolved!
Symbol __glXgetActiveScreen from module /usr/lib/modules/extensions/libdri.a is unresolved!

and no x11-screen. after downgrading to 2.3.4.20050125-r1 i worked again... i will try remerging xorg-x11 again and i hope that will help...




Comment 6


Nicolas Vilz





          2005-04-29 02:58:12 UTC
        

strange... now with other libtool, aterm works (with 1.00_beta2, too) ... i havent restartet my x11-session yet, so i leave that bug open...




Comment 7


Michal Januszewski (RETIRED)






          2005-05-02 04:33:58 UTC
        

If you restart your x session, please make sure that you put a comment here so that I know whether the bug can be closed :)




Comment 8


Nicolas Vilz





          2005-05-02 07:20:29 UTC
        

d'oh... sorry, i forgot about that... i restarted x11 and my computer... and it seems to be ok :) thx for your help.




Comment 9


Michal Januszewski (RETIRED)






          2005-05-02 13:50:42 UTC
        

Well then, I'm closing the bug :)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

