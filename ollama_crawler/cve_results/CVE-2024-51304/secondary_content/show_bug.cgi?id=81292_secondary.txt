Title: 81292 – /etc/conf.d/net: dhcpcd + peer_dns: still overwrites /etc/resolv.conf
URL: https://bugs.gentoo.org/show_bug.cgi?id=81292

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 81292
/etc/conf.d/net: dhcpcd + peer_dns: still overwrites /etc/resolv.conf
Last modified: 2005-02-08 15:08:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 81292 
      - /etc/conf.d/net: dhcpcd + peer_dns: still overwrites /etc/resolv.conf


Summary:
/etc/conf.d/net: dhcpcd + peer_dns: still overwrites /etc/resolv.conf
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-02-08 13:14 UTC by Ioannis Aslanidis (RETIRED)





      Modified:
    
2005-02-08 15:08 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ioannis Aslanidis (RETIRED)






          2005-02-08 13:14:15 UTC
        

I've set peer_dns="no" (and alternating with peer_dns_eth0="no") in /etc/conf.d/net but after starting /etc/init.d/net.eth0, /etc/resolv.conf gets overwriten, thus losing its contents.

I was forced to create a script that is executed after the network is brought up that restores my custom /etc/resolv.conf values.



Reproducible: Always
Steps to Reproduce:
1. Set peer_dns="no" in /etc/conf.d/net
2. /etc/init.d/net.eth0 start
3. cat /etc/resolv.conf

Actual Results:  
/etc/resolv.conf gets overwritten each time an ethernet (at least) device is
brought up.

Expected Results:  
/etc/resolv.conf custom values should be kept unmodified after bringing up a device.

Portage 2.0.51-r15 (default-linux/x86/2004.2/gcc34, gcc-3.3.5,
glibc-2.3.4.20040808-r1, 2.6.10-gentoo-r6 i686)
=================================================================
System uname: 2.6.10-gentoo-r6 i686 AMD Athlon(tm) XP 2000+
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb  7 2005, 11:38:23)]
distcc 2.16 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.3 [enabled]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.8.5-r3, 1.5, 1.6.3, 1.7.9-r1, 1.4_p6, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r1
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-O3 -march=athlon-xp -ftracer -fomit-frame-pointer -ffast-math -pipe
-fforce-addr -fforce-mem -falign-functions=4"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.2/share/config
/usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown
/usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref
/usr/share/config /usr/share/texmf/dvipdfm/config/
/usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/
/usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=athlon-xp -ftracer -fomit-frame-pointer -ffast-math -pipe
-fforce-addr -fforce-mem -falign-functions=4"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig buildpkg ccache distlocks fixpackages sandbox
sfperms usersandbox"
GENTOO_MIRRORS="http://gentoo.blueyonder.co.uk http://mir.zyrianes.net/gentoo/
http://pandemonium.tiscali.de/pub/gentoo/
ftp://ftp.wh2.tu-dresden.de/pub/mirrors/gentoo ftp://mir.zyrianes.net/gentoo/
http://ftp.heanet.ie/pub/gentoo/ ftp://ftp.heanet.ie/pub/gentoo/
ftp://ftp.easynet.nl/mirror/gentoo/ ftp://pandemonium.tiscali.de/pub/gentoo/
http://ftp.easynet.nl/mirror/gentoo/ ftp://mirror.nutsmaas.nl/gentoo/"
LANG="es_ES.UTF-8"
LC_ALL="C"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 3dnow 3dnowex X aalib acpi acpi4linux alsa apache2 apm arts audiofile
avi berkdb bitmap-fonts blender-game bluetooth bootsplash bzlib c++ caps cddb
cdinstall cdparanoia cdr cdrom chroot clamav clanVoice codecs crypt cups curl
dga dio directfb divx4linux dvd dvdr dvdread encode erandom esd ethereal f77 fam
fastcgi fbcon flac flash font-server foomaticdb fortran freetype gd gdbm ggi gif
gimp gimpprint gmp gnome gpm gstreamer gtk gtk2 icq imagemagick imlib ipv6 java
jikes jpeg junit kde lcms ldap libg++ libwww live mad memlimit mikmod mmx mmx2
motif mozilla mpeg msn mysql ncurses network nls nocd nptl nptlonly oggvorbis
opengl oss pam pdflib perl pic png ppds python qt quicktime radeon readline rtc
samba sdl session slang spell sse ssl svg svga szip tcltk tcpd tetex tiff
truetype truetype-fonts ttf type1-fonts unicode usb userlocales v4l v4l2 videos
wmf xml xml2 xmms xv xvid zlib linguas_es linguas_el"
Unset:  ASFLAGS, CBUILD, CTARGET, LDFLAGS, PORTDIR_OVERLAY




Comment 1


Roy Marples (RETIRED)






          2005-02-08 14:30:22 UTC
        

You're using baselayout-1.9.x, which does not support that setting - which has been deprecated anyway.

dhcp_eth0="nodns"

is now the correct syntax for baselayout-1.11.9-r1




Comment 2


Ioannis Aslanidis (RETIRED)






          2005-02-08 14:40:58 UTC
        

Thank you very much. :)




Comment 3


Michiel de Bruijne





          2005-02-08 15:08:47 UTC
        

You can also add dhcpcd_eth0="-R" to /etc/conf.d/net









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

