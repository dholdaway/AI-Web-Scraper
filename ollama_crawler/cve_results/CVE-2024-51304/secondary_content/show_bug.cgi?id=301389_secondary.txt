Title: 301389 – [mozilla-overlay] mozilla-firefox-3.6 segfaults during startup or shortly after
URL: https://bugs.gentoo.org/show_bug.cgi?id=301389

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 301389
[mozilla-overlay] mozilla-firefox-3.6 segfaults during startup or shortly after
Last modified: 2010-07-18 08:31:07 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 301389 
      - [mozilla-overlay] mozilla-firefox-3.6 segfaults during startup or shortly after


Summary:
[mozilla-overlay] mozilla-firefox-3.6 segfaults during startup or shortly after
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Unspecified

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Mozilla Gentoo Team








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

301819

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2010-01-18 14:49 UTC by Michael Gaber





      Modified:
    
2010-07-18 08:31 UTC
      (History)
    




          CC List:
        

25 
          users
          
            (show)
          



Adrian.Bassett
aidanamarks
brendlerjg
bugs
caster
cedric.godin
che
drwook
fabio.coatti
gentoo
harrisl
ikelos
leonidp.lists
orodruinlair
psdasilva
rogerx.oss
shark
sven-loe
torsten
transacid
vladimir
xmw
zeekec
zima
zsojka









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




mozilla-firefox-3.6 crash backtrace

              (firefox-crash-backtrace.txt,7.05 KB,
                text/plain)

            
2010-01-23 19:24 UTC,

            Mike Auty (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michael Gaber





          2010-01-18 14:49:15 UTC
        

when i startup firefox i get either this:

tigerchen@keksdose-mobile ~ $ firefox 
Segmentation fault


or shortly after, but i couldn't trace it to a special action.
i could reproduce it when i log in to weave and start the first import action but there are other occasions where it also crashs shortly after starting

Reproducible: Always




emerge --info www-client/mozilla-firefox
Portage 2.2_rc61 (default/linux/x86/10.0, gcc-4.4.2, glibc-2.11-r1, 2.6.32-gentoo-r1 i686)
=================================================================
                        System Settings
=================================================================
System uname: Linux-2.6.32-gentoo-r1-i686-Intel-R-_Core-TM-2_CPU_T7200_@_2.00GHz-with-gentoo-2.0.1
Timestamp of tree: Mon, 18 Jan 2010 13:45:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p35
dev-java/java-config: 2.1.10
dev-lang/python:     2.6.4, 3.1.1-r1
dev-util/ccache:     2.4-r8
dev-util/cmake:      2.8.0
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.0
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.10.3, 1.11.1
sys-devel/binutils:  2.20
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="x86 ~x86"
ACCEPT_LICENSE="*"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=core2 -pipe -fomit-frame-pointer -mfpmath=sse"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -march=core2 -pipe -fomit-frame-pointer -mfpmath=sse"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests ccache distlocks fixpackages news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS=" http://linux.rz.ruhr-uni-bochum.de/download/gentoo-mirror/ http://ftp.uni-erlangen.de/pub/mirrors/gentoo"
LANG="de_DE.utf8"
LDFLAGS="-Wl,-O1"
LINGUAS="de"
MAKEOPTS="-j10 -l3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/x11 /usr/local/portage/layman/mozilla"
SYNC=" rsync://rsync.de.gentoo.org/gentoo-portage"
USE="X aac acl acpi alsa avahi bash-completion berkdb bluetooth bzip2 caps cdda cddb cdparanoia cdr cli cracklib crypt css cups cxx dbus dga dri dvd dvdr encode exif fastcgi fftw firefox flac fortran ftp gdbm gif gnutls gpm hal iconv idn imap ipod ipv6 jabber java java6 jpeg kerberos latex ldap matroska mime mmx mmxext modules mp3 mudflap mysql mysqli ncurses nls nptl nptlonly nsplugin offensive ogg opengl openmp pam pcmcia pcre pdf perl php png ppds pppd python qt3support qt4 raw readline reflection samba scanner session smp spl sse sse2 sse3 ssl ssse3 subversion svg sysfs syslog tcpd theora threads tiff truetype unicode usb v4l vcd vorbis wifi win32codecs wmf x264 x86 xattr xcb xcomposite xinerama xml xorg xpm xulrunner xv zeroconf zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de" RUBY_TARGETS="ruby18" SANE_BACKENDS="artec_eplus48u" USERLAND="GNU" VIDEO_CARDS="radeon radeonhd ati vesa" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

www-client/mozilla-firefox-3.6_rc1 was built with the following:
USE="alsa dbus java -bindist -custom-optimization -gnome -libnotify -mozdevelop -networkmanager -sqlite -startup-notification" LINGUAS="de -af -ar -as -be -bg -bn -bn_BD -bn_IN -ca -cs -cy -da -el -en -en_GB -en_US -eo -es -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy -fy_NL -ga -ga_IE -gl -gu -gu_IN -he -hi -hi_IN -hr -hu -id -is -it -ja -ka -kk -kn -ko -ku -lt -lv -mk -ml -mr -nb -nb_NO -nl -nn -nn_NO -oc -or -pa -pa_IN -pl -pt -pt_BR -pt_PT -rm -ro -ru -si -sk -sl -sq -sr -sv -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW" 
CFLAGS="-march=core2 -pipe -Wno-return-type -w"
CXXFLAGS="-march=core2 -pipe -Wno-return-type -w"




Comment 1


Jory A. Pratt






          2010-01-19 03:24:55 UTC
        

you will need to test in safe-mode `firefox --safe-mode` will work from terminal. If all works fine there you will need to check your plugins.




Comment 2


Michael Gaber





          2010-01-22 12:42:13 UTC
        

tested with safe mode, and resolved it to some kind of javascript problem.

it is reproducable by doing this (you need a facebook account and play mafia wars):

1. either install unframe-mw (live) or copy the javascript of it from here: http://www.spockholm.com/mafia/testing.php
2. log in to fb and go to mw on any page.
3. either click bookmark or paste js-code to adressbar
4. see browser crash

i tried with current version, so current is 3.6 stable

P.S. i got a lot of these, but only on 1 run, not on all tests and don't know if it's related at all:
(firefox:31790): Gdk-WARNING **: XID collision, trouble ahead




Comment 3


Mark Tiefenbruck





          2010-01-22 21:24:48 UTC
        

I also have segfaults immediately after showing the browser window, but mine still happens in safe mode. Also, safe mode disables add-ons, so I don't need to check those. The safe mode dialog box works fine, so it's something that happens after the initial launch.




Comment 4


Sven L.





          2010-01-22 21:38:39 UTC
        

Hello,

mozilla-firefox 3.6 crashes on serveral sites on the net for example 'www.handelsblatt.de'. I get a lot of the '(firefox:4377): Gdk-WARNING **: XID collision, trouble ahead' warnings and if I try to open the page it segfaults. The save-mode does not help. I seems to be a javascript issue but I need to investigate more.

Reproducable: Always

Portage 2.1.6.13 (default/linux/x86/10.0/desktop, gcc-4.3.4, glibc-2.10.1-r1, 2.6.32.4 i686)                                                                    
=================================================================               
                        System Settings                                         
=================================================================               
System uname: Linux-2.6.32.4-i686-AMD_Athlon-tm-_XP_2000+-with-gentoo-1.12.13   
Timestamp of tree: Fri, 22 Jan 2010 17:00:01 +0000                              
distcc 3.1 i686-pc-linux-gnu [disabled]                                         
app-shells/bash:     4.0_p35                                                    
dev-java/java-config: 1.3.7-r1, 2.1.10                                          
dev-lang/python:     2.4.4-r13, 2.5.4-r3, 2.6.4                                 
dev-python/pycrypto: 2.0.1-r8                                                   
dev-util/cmake:      2.6.4-r3                                                   
sys-apps/baselayout: 1.12.13                                                    
sys-apps/sandbox:    1.6-r2                                                     
sys-devel/autoconf:  2.13, 2.63-r1                                              
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2   
sys-devel/binutils:  2.18-r3                                                    
sys-devel/gcc-config: 1.4.1                                                     
sys-devel/libtool:   2.2.6b                                                     
virtual/os-headers:  2.6.27-r2                                                  
ACCEPT_KEYWORDS="x86"                                                           
CBUILD="i686-pc-linux-gnu"                                                      
CFLAGS="-O2 -march=athlon-xp -pipe -mfpmath=sse,387 -mmmx -msse -fomit-frame-pointer"                                                                           
CHOST="i686-pc-linux-gnu"                                                       
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/lib/hsqldb"                     
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/eselect/postgresql /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/udev/rules.d"                                         
CXXFLAGS="-O2 -march=athlon-xp -pipe -mfpmath=sse,387 -mmmx -msse -fomit-frame-pointer"                                                                         
DISTDIR="/usr/portage/distfiles"                                                
FEATURES="distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"                                                  
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"                                                           
LDFLAGS="-Wl,-O1"                                                               
MAKEOPTS="-j2"                                                                  
PKGDIR="/usr/portage/packages"                                                  
PORTAGE_CONFIGROOT="/"                                                          
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"                                                  
PORTAGE_TMPDIR="/var/tmp"                                                       
PORTDIR="/usr/portage"                                                          
SYNC="rsync://rsync.gentoo.org/gentoo-portage"                                  
USE="X a52 aac acl acpi alsa berkdb bluetooth branding bzip2 cairo cdr cli consolekit cracklib crypt cups cxx dbus dri dts dvd dvdr dvdread eds emboss encode evo fam firefox flac fortran fts3 gdbm gif gnome gpm gstreamer gtk hal iconv imap ipv6 java jpeg kde ldap libnotify mad mikmod mng modules mp3 mp4 mpeg mudflap mysql ncurses nls nptl nptlonly odbc ogg opengl openmp pam pcre pdf perl png ppds pppd python qt3support qt4 quicktime readline reflection sdl session spell spl sql sqlite ssl startup-notification svg sysfs tcpd thunar tiff truetype unicode usb vorbis webkit win32codecs x264 x86 xml xorg xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="fbdev glint intel mach64 mga neomagic nv r128 radeon savage sis tdfx trident vesa via vmware voodoo"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY

=================================================================
                        Package Settings
=================================================================

www-client/mozilla-firefox-3.6 was built with the following:
USE="alsa dbus gnome java libnotify networkmanager startup-notification -bindist -custom-optimization" LINGUAS="-af -ar -as -be -bg -bn -bn_BD -bn_IN -ca -cs -cy -da -de -el -en -en_GB -en_US -eo -es -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy -fy_NL -ga -ga_IE -gl -gu -gu_IN -he -hi -hi_IN -hr -hu -id -is -it -ja -ka -kk -kn -ko -ku -lt -lv -mk -ml -mr -nb -nb_NO -nl -nn -nn_NO -oc -or -pa -pa_IN -pl -pt -pt_BR -pt_PT -rm -ro -ru -si -sk -sl -sq -sr -sv -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW"
CFLAGS="-march=athlon-xp -pipe -Wno-return-type -w"
CXXFLAGS="-march=athlon-xp -pipe -Wno-return-type -w"





Comment 5


Robert Cabrera





          2010-01-23 00:55:58 UTC
        

I'm not using the mozilla-overlay, I'm using the 3.6 (and xulrunner-1.9.2) version just released into the Gentoo ~x86 tree.

Launch Mozilla-firefox-3.6 and the notification icon appears on my cursor (kde-4.3.4) and for a brief moment a broswer window appears then nothing, crash. Check running processes shows firefox as zombie.

Related note: During installation phase xulrunner-1.9.2 showed several files as being "needed" with yellow bullets. After installing revdep-rebuild attempted to rebuild google-gadgets, but failed near end of build. Changed use to -xulrunner then built fine. 

Tried rebuilding nss as suggested during installations of xulrunner/Firefox and run lafilefixer --justfixit no avail.

Reinstalled xulrunner-1.9.1.7 and Mozilla-Firefox-3.5.7 then google-gadgets rebuilt fine with xulrunner use flag.

Many seem to be having problem with latest fire-fox see this thread in forum http://forums.gentoo.org/viewtopic-t-812351.html

Reproducable: always

emerge --info www-client/mozilla-firefox
Portage 2.2_rc61 (default/linux/x86/10.0/desktop, gcc-4.4.2, glibc-2.11-r1, 2.6.30-tuxonice-r6 i686)
=================================================================                                   
                        System Settings                                                             
=================================================================                                   
System uname: Linux-2.6.30-tuxonice-r6-i686-Intel-R-_Pentium-R-_M_processor_2.26GHz-with-gentoo-1.12.13
Timestamp of tree: Fri, 22 Jan 2010 20:15:01 +0000                                                     
app-shells/bash:     4.0_p35                                                                           
dev-java/java-config: 2.1.10                                                                           
dev-lang/python:     2.6.4                                                                             
dev-util/cmake:      2.6.4-r3                                                                          
sys-apps/baselayout: 1.12.13                                                                           
sys-apps/sandbox:    2.2                                                                               
sys-devel/autoconf:  2.13, 2.63-r1                                                                     
sys-devel/automake:  1.8.5-r3, 1.9.6-r2, 1.10.2                                                        
sys-devel/binutils:  2.19.1-r1                                                                         
sys-devel/gcc-config: 1.4.1                                                                            
sys-devel/libtool:   2.2.6b                                                                            
virtual/os-headers:  2.6.30-r1                                                                         
ACCEPT_KEYWORDS="x86"                                                                                  
ACCEPT_LICENSE="*"                                                                                     
CBUILD="i686-pc-linux-gnu"                                                                             
CFLAGS="-march=pentium-m -O2 -pipe -fomit-frame-pointer"                                               
CHOST="i686-pc-linux-gnu"                                                                              
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config /usr/share/config/kdm"                       
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/skel /etc/splash /etc/terminfo /etc/udev/rules.d"                                                     
CXXFLAGS="-march=pentium-m -O2 -pipe -fomit-frame-pointer"                                                                   
DISTDIR="/usr/portage/distfiles"                                                                                             
FEATURES="assume-digests collision-protect distlocks fixpackages news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"                                                                           
GENTOO_MIRRORS="http://gentoo.osuosl.org/ http://gentoo.netnitco.net http://osmirrors.cerias.purdue.edu/pub/gentoo/ http://www.cyberuse.com/gentoo/ http://gentoo.mirrors.hoobly.com/ ftp://gentoo.imj.fr/pub/gentoo/ http://130.59.10.35/ftp/mirror/gentoo/"                                                                                                                          
LANG="en_US.UTF-8"                                                                                                           
LC_ALL=""                                                                                                                    
LDFLAGS="-Wl,-O1 -Wl,--as-needed"                                                                                            
LINGUAS="en en_US"                                                                                                           
MAKEOPTS="-j2 -s"                                                                                                            
PKGDIR="/usr/portage/packages"                                                                                               
PORTAGE_CONFIGROOT="/"                                                                                                       
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"                                                            
PORTAGE_TMPDIR="/var/tmp"                                                                                                    
PORTDIR="/usr/portage"                                                                                                       
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"                                                                        
USE="X a52 aac aalib acl acpi akonadi alsa apm autoipd avahi bash-completion berkdb bluetooth bonjour branding bzip2 cairo cdda cdparanoia cdr cleartype cli connection-sharing consolekit contrast corefonts cracklib crypt css cups cxx dbus dell designer-plugin desktopglobe dga dhclient dhcpcd djvu dri dts dv dvb dvd dvdr ebook editor eds embedded emboss emovix encode evo exif faac faad fam fame fbcon fbcondecor fbsplash ffmpeg firefox firefox3 flac fortran fts3 gadu gcj gdbm gif gimp gmm gnokii google-gadgets gphoto2 gpm graphviz groupwise grub gtk hal handbook hotpixels hyperestraier iconv ieee1394 imagemagick inotify ioctl jack java jce joystick jpeg jpeg2k kde kerberos kig-scripting kipi konqueror ladspa lame laptop lcms lensfun libcaca libnotify libsamplerate lm_sensors lzma lzo mad mdnsresponder-compat meanwhile mikmod mjpeg mmx mng modules mozilla mp3 mp4 mpeg mplayer msn mudflap musicbrainz mysql ncurses networkmanager nls npp nptl nptlonly nsplugin ntfs nvidia objc objc++ objc-gc ogg openexr opengl openmp oscar otr pam pcre pdf perl plasma pmu png pnm policykit ppds pppd python qt3support qt4 quicktime raw rdp readline reflection resolvconf rss rtc samba sasl schroedinger sdl semantic-desktop session sndfile solver sox speex spell spl sql sqlite sse sse2 ssl startup-notification svg symlink sysfs tcpd theora threads thumbnail thunar tidy tiff tk truetype unicode usb v4l v4l2 vcd vhook vidix vnc vorbis wavpack webpresence wicd wifi win32codecs winpopup wma wmf wpd wpg x264 x86 xattr xcomposite xinerama xml xmlpatterns xorg xscreensaver xulrunner xv xvid xvmc yahoo yv12 zeroconf zip zlib" ALSA_CARDS="intel8x0 intel8x0m" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse synaptics joystick" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_US" RUBY_TARGETS="ruby18" SANE_BACKENDS="epson epson2" USERLAND="GNU" VIDEO_CARDS="nv nvidia"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY

=================================================================
                        Package Settings
=================================================================

www-client/mozilla-firefox-3.6 was built with the following:
USE="alsa dbus java libnotify networkmanager startup-notification -bindist -custom-optimization -gnome" LINGUAS="en en_US -af -ar -as -be -bg -bn -bn_BD -bn_IN -ca -cs -cy -da -de -el -en_GB -eo -es -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy -fy_NL -ga -ga_IE -gl -gu -gu_IN -he -hi -hi_IN -hr -hu -id -is -it -ja -ka -kk -kn -ko -ku -lt -lv -mk -ml -mr -nb -nb_NO -nl -nn -nn_NO -oc -or -pa -pa_IN -pl -pt -pt_BR -pt_PT -rm -ro -ru -si -sk -sl -sq -sr -sv -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW"
CFLAGS="-march=pentium-m -pipe -Wno-return-type -w"
CXXFLAGS="-march=pentium-m -pipe -Wno-return-type -w"




Comment 6


Jory A. Pratt






          2010-01-23 01:05:50 UTC
        

For those expierencing the crash please test with a clean profile. Make sure you post your results back to this bug report.




Comment 7


Robert Cabrera





          2010-01-23 01:57:39 UTC
        

Installed mozilla-firefox-3.6/xulrunner-1.9.2 again. This time I launched with clean profile, no love, still crashes. Same google-gadget issue as I previously reported.

I am reinstalling 3.5.7 as I write this.

So problem is more than a profile issue.

I hope this helps.

Ciao




Comment 8


Jory A. Pratt






          2010-01-23 02:25:17 UTC
        

(In reply to comment #7)
> I am reinstalling 3.5.7 as I write this.
> Ciao
> 

Actually this does not help I will need backtrace info if you want to see the problem resolved for you.




Comment 9


Robert Cabrera





          2010-01-23 02:49:56 UTC
        


(In reply to comment #8)
> (In reply to comment #7)
> > I am reinstalling 3.5.7 as I write this.
> > Ciao
> > 
> 
> Actually this does not help I will need backtrace info if you want to see the
> problem resolved for you.
> 
Jory,
I don't know how to debug or backtrace. I'm just a 47year old truck-driver and computer hobbyist who's been running Gentoo since 2004. I'm not a programmer or computer professional. So, If you need me to debug /backtrace (whatever this entails) you're going to have to tell me what that means and coach me on how to do it. Sorry :(




Comment 10


Boney McCracker





          2010-01-23 08:56:34 UTC
        

segfault on startup here too




Comment 11


Michael Gaber





          2010-01-23 09:38:33 UTC
        

does happen on a clean profile (rm -rf .mozilla) somewhat:

first startup on a clean profile works up to the first crash, however initiated. after this crash it is only possible to start ff either in -safe-mode or with a new profile again.
otherwise it will directly segfault before i see any window at all!




Comment 12


Mark





          2010-01-23 16:43:55 UTC
        

I think this is a duplicate of 301819.  Referring to that bug, I set the "custom-optimization" flag on XULrunner and all works perfectly for me.




Comment 13


Mike Auty (RETIRED)






          2010-01-23 19:24:59 UTC
        

Created attachment 217266 [details]
mozilla-firefox-3.6 crash backtrace

Ok, here's a backtrace for my particular scenario which appears to match that of many others on this bug.  The system works fine until a crash, after the crash firefox won't start (no error messages other than the glib g_set_prgname, but that occurred whether it started or not).  It would start up fine once in safe-mode, but then after crashing in that it would no longer allow startup in safe-mode.  The situation could be fixed by removing the profile.

The backtrace doesn't seem particularly helpful, it just shows that it appears to be somewhere in the midst of javascript processing.  This is the same backtrace as was received if not running in safe-mode.

The crash-on-startup appears reminiscent of a bug I remember (but haven't been able to track down again, I think it was solved by the patch at [1]) whereby the session-restore code was broken in someway, and hence would crash on startup when it tried to restore the previous tabs.  Once the tabs are cleared out (by removing the profile, or in some cases running in safe-mode) firefox once again runs ok (until the next crash).

In case it's related to sqlite I've tried both with and without extensions on 3.6.22-r1 and with extensions on 3.6.22, all crashed on startup.  I've also tried with pixman-0.17.2 rather than 0.17.4 (and so it appears to be different to bug 301892).  I haven't tried custom-optimizations yet.  I have tried rebuilding nss, nspr, xulrunner and then mozilla-firefox, but there was no change.

Any other information I can provide that might be useful?

[1] http://git.overlays.gentoo.org/gitweb/?p=proj/mozilla.git;a=blob;f=www-client/mozilla-firefox/files/303-fix-restroe-session.patch;h=cda748af5f0d3a53972834a8676aa692466acdf1;hb=7e3cf72aca00d54c58cd371b03e07d8592dbe6c9

Portage 2.2_rc61 (default/linux/x86/10.0, gcc-4.4.2, glibc-2.11-r1, 2.6.32.5 i686)
=================================================================
                        System Settings
=================================================================
System uname: Linux-2.6.32.5-i686-Intel-R-_Core-TM-2_Quad_CPU_Q6600_@_2.40GHz-with-gentoo-2.0.1
Timestamp of tree: Sat, 23 Jan 2010 14:30:01 +0000
distcc 3.1 i686-pc-linux-gnu [disabled]
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p37
dev-java/java-config: 2.1.10
dev-lang/python:     2.6.4, 3.1.1-r1
dev-python/pycrypto: 2.1.0
dev-util/ccache:     2.4-r8
dev-util/cmake:      2.8.0
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.0-r1
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.3, 1.11.1
sys-devel/binutils:  2.20
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="x86 ~x86"
ACCEPT_LICENSE="*"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe -ggdb"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -march=native -pipe -ggdb"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests ccache collision-protect cvs distlocks fixpackages news parallel-fetch protect-owned sandbox sfperms sign splitdebug strict unmerge-logs unmerge-orphans userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="en_GB.UTF-8"
LC_ALL="en_GB"
LDFLAGS="-Wl,--as-needed"
LINGUAS="en en_GB"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/overlays/autogenerated /usr/local/overlays/ikelos /usr/local/overlays/personal"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi alsa amr applet bash-completion berkdb bluetooth bzip2 cairo cdr cli consolekit cpudetection cracklib crypt cups curl cvs cxx dbus device-mapper devil dga divx dri dvb dvd dvdr encode exif extensions fam ffmpeg flash fortran fts3 fuse gdbm gedit gif git gnome gnome-keyring gpm graphviz gstreamer gtk h323 hal hddtemp hpn iconv id3 ieee1394 imap iplayer ipv6 java jpeg kdrive kvm ldap libnotify libsamplerate libsoup lightning lm_sensors mad mmx modules moonlight mozdevelop mp3 mpeg mudflap music nautilus ncurses networkmanager nls nptl nptlonly nvidia ogg opengl openmp openssl pam pango pcre pcsc-lite pdf perl pipechan png policykit pppd pulseaudio python qt4 quicktime readline realmedia reflection sdl server session sip smp spl sqlite sse sse2 ssl ssse3 subversion svg sysfs system-wide tcpd theora totem tracker truetype unicode usb v4l v4l2 vorbis wav win32codecs wmp x264 x86 x86emu xcb xcomposite xklavier xml xorg xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev wacom" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_GB" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nvidia vesa" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

www-client/mozilla-firefox-3.6 was built with the following:
USE="alsa dbus gnome java libnotify networkmanager -bindist -custom-optimization -startup-notification" LINGUAS="en en_GB -af -ar -as -be -bg -bn -bn_BD -bn_IN -ca -cs -cy -da -de -el -en_US -eo -es -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy -fy_NL -ga -ga_IE -gl -gu -gu_IN -he -hi -hi_IN -hr -hu -id -is -it -ja -ka -kk -kn -ko -ku -lt -lv -mk -ml -mr -nb -nb_NO -nl -nn -nn_NO -oc -or -pa -pa_IN -pl -pt -pt_BR -pt_PT -rm -ro -ru -si -sk -sl -sq -sr -sv -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW" 
CFLAGS="-march=native -pipe -ggdb -Wno-return-type -w"
CXXFLAGS="-march=native -pipe -ggdb -Wno-return-type -w"




Comment 14


Mike Auty (RETIRED)






          2010-01-23 19:36:31 UTC
        

Having said that, I just successfully recovered from a crash with my tabs intact, so it's still unclear as to what the problem is, or how to fix it...  5:\




Comment 15


Jory A. Pratt






          2010-01-23 21:32:02 UTC
        

*** Bug 301819 has been marked as a duplicate of this bug. ***




Comment 16


Jory A. Pratt






          2010-01-23 22:21:55 UTC
        

3.6 has been masked until problem is found and fixed.




Comment 17


Michael Gaber





          2010-01-23 22:42:47 UTC
        

just tried with -custom-optimisations on ff and xulrunner - works like a charm




Comment 18


Harris Landgarten





          2010-01-24 04:09:40 UTC
        

I am running 3.6 with the new xulrunner under gnome and have checked all the sites listed in this bug as problems with no issues. Maybe this is a kde issue.




Comment 19


Boney McCracker





          2010-01-24 04:24:42 UTC
        

(In reply to comment #18)
> I am running 3.6 with the new xulrunner under gnome and have checked all the
> sites listed in this bug as problems with no issues. Maybe this is a kde issue.
> 

lol not




Comment 20


Chema





          2010-01-24 09:42:43 UTC
        

I don't think this is a reason to hardmask it on ALL architectures, i have amd64 and have no problem with any of the sites in this bug.




Comment 21


Iskren Slavov





          2010-01-24 10:21:02 UTC
        

Using on amd64, with custom-optimization. Unmasked and keywored (~amd64) mozilla-firefox-3.6, xulrunner-1.9.2 and it all works fine for me.

(In reply to comment #20)
> I don't think this is a reason to hardmask it on ALL architectures, i have
> amd64 and have no problem with any of the sites in this bug.
> 






Comment 22


Michael Weber (RETIRED)






          2010-01-24 10:28:36 UTC
        

works here on system with pretty much ~amd64 stuff, too.
wm: gnome-2.28/.29, 
plugins: Hide Capion, Compact Menu 2, adblock plus, firebug, fireftp.
just set it to unstable, no need for hardmask b'caus stupid facebook.




Comment 23


Johannes Jeske





          2010-01-24 10:48:43 UTC
        

I am using XFCE and I don't have any problems, either. Really seems to be a KDE issue. Somebody using KDE and having this problem should try running Firefox with XFCE or Gnome or something.




Comment 24


Peter Read





          2010-01-24 11:01:59 UTC
        

I'll just echo the growing "this looks fine on amd64" sentiment.  my x86 boxes are at work so I'll check them out tomorrow if I can...




Comment 25


Viktor Yu. Kovalskii





          2010-01-24 12:13:03 UTC
        

At home I'm using XFCE4.6 on ~x86 and firefox crashes at startup.

emerge --info www-client/mozilla-firefox
Portage 2.2_rc61 (default/linux/x86/10.0, gcc-4.4.2, glibc-2.11-r1, 2.6.32-tuxonice-r1 i686)
=================================================================
                        System Settings
=================================================================
System uname: Linux-2.6.32-tuxonice-r1-i686-Intel-R-_Core-TM-_Duo_CPU_T2350_@_1.86GHz-with-gentoo-2.0.1
Timestamp of tree: Sat, 23 Jan 2010 15:45:02 +0000
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p37
dev-java/java-config: 2.1.10
dev-lang/python:     2.6.4
dev-python/pycrypto: 2.1.0
dev-util/ccache:     2.4-r8
dev-util/cmake:      2.8.0
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.0-r1
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.19.1-r1
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="x86 ~x86"
ACCEPT_LICENSE="* -@EULA PUEL LOKI-EULA sun-prerelease-jdk7 skype-eula"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=prescott -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe -march=prescott -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests ccache collision-protect distlocks fixpackages metadata-transfer news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="http://trumpetti.atm.tut.fi/gentoo/ http://mirror.yandex.ru/gentoo-distfiles http://distfiles.gentoo.org"
LANG="ru_RU.UTF-8"
LC_ALL=""
LDFLAGS="-Wl,-O1"
LINGUAS="ru"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/oschtan-overlay /var/lib/layman/sunrise /var/lib/layman/rion /var/lib/layman/rostov /var/lib/layman/mozilla /var/lib/layman/qutim-overlay /usr/local/portage/flying /var/lib/layman/calculate /var/lib/layman/science /var/lib/layman/qting-edge /usr/local/portage/g-ctan"
SYNC="rsync://rsync.ru.gentoo.org/gentoo-portage/"
USE="7zip X a52 aac aalib acl acpi additions alsa amr amrnb amrwb ao archive aspell audacious audiofile bash-completion bdf berkdb bluetooth branding bzip2 cairo cdda cddb cdparanoia cdr chardet cjk clamav cleartype cli consolekit cracklib crypt curl cxx cyrillic dbus dia dirac divx djvu docbook dot dri drm dvd dvdnav dvdr dvdread dvi emerald enca encode equalizer esd exif fbcondecor fbsplash ffmpeg firefox flac fontconfig fortran fuse gd gecko gif gimp git glitz gnutls gphoto2 gpm gs gstreamer gtk hal hddtemp html icons iconv imagemagick java java6 jbig jpeg jpeg2k lame laptop latex lcms libnotify libsamplerate live lm_sensors lzma mad madwifi matroska mikmod mime mjpeg mmx mmxext mng modules motif mp2 mp3 mp4 mpeg mplayer mudflap multitarget musepack ncurses nls nptl nptlonly nsplugin oav objc objc++ objc-gc ogg opengl openmp optimisememory pam pcre pdf perl plotutils png pppd projectm python qt3support quicktime rar rcc readline realmedia reflection rtc rtf samba science scrobbler sdl session smp sndfile sound speex spell spl sqlite sqlite3 srt sse sse2 ssl startup-notification subversion suid svg symlink sysfs syslog szip t1lib tcpd templates theora thunar tiff truetype type1 unicode unsupported usb utempter v4l v4l2 vcd vorbis wav wavpack wma wmf wmp wxwidgets wxwindows x264 x264-svn-encoder x86 xattr xcb xcomposite xfce xml xmp xorg xpm xscreensaver xulrunner xv xvid xvmc zip zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" CAMERAS="adc65 agfa_cl20 aox barbie canon casio_qv clicksmart310 digigr8 digita dimagev dimera3500 directory enigma13 fuji gsmart300 hp215 iclick jamcam jd11 kodak_dc120 kodak_dc210 kodak_dc240 kodak_dc3200 kodak_ez200 konica konica_qm150 largan lg_gsm mars mustek panasonic_coolshot panasonic_dc1000 panasonic_dc1580 panasonic_l859 pccam300 pccam600 polaroid_pdc320 polaroid_pdc640 polaroid_pdc700 ptp2 ricoh ricoh_g3 samsung sierra sipix_blink sipix_blink2 sipix_web2 smal sonix sony_dscf1 sony_dscf55 soundvision spca50x sq905 stv0674 stv0680 sx330z template toshiba_pdrm11" ELIBC="glibc" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="ru" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="intel" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

www-client/mozilla-firefox-3.6 was built with the following:
USE="alsa dbus java libnotify startup-notification -bindist -custom-optimization -gnome -networkmanager" LINGUAS="ru -af -ar -as -be -bg -bn -bn_BD -bn_IN -ca -cs -cy -da -de -el -en -en_GB -en_US -eo -es -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy -fy_NL -ga -ga_IE -gl -gu -gu_IN -he -hi -hi_IN -hr -hu -id -is -it -ja -ka -kk -kn -ko -ku -lt -lv -mk -ml -mr -nb -nb_NO -nl -nn -nn_NO -oc -or -pa -pa_IN -pl -pt -pt_BR -pt_PT -rm -ro -si -sk -sl -sq -sr -sv -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW" 
CFLAGS="-pipe -march=prescott -Wno-return-type -w"
CXXFLAGS="-pipe -march=prescott -Wno-return-type -w"

But at work I'm using KDE4 on ~amd64 and firefox works succesfully

 emerge --info www-client/mozilla-firefox
Portage 2.2_rc61 (default/linux/amd64/10.0/desktop, gcc-4.4.2, glibc-2.11-r1, 2.6.32-gentoo-r2 x86_64)
=================================================================
                        System Settings
=================================================================
System uname: Linux-2.6.32-gentoo-r2-x86_64-Intel-R-_Core-TM-2_Duo_CPU_E7500_@_2.93GHz-with-gentoo-2.0.1
Timestamp of tree: Sun, 24 Jan 2010 07:45:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p37
dev-java/java-config: 2.1.10
dev-lang/python:     2.6.4
dev-util/ccache:     2.4-r8
dev-util/cmake:      2.8.0
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.0-r1
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.8.5-r3, 1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA PUEL sun-prerelease-jdk7"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=native -mtune=native"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe -march=native -mtune=native"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests ccache collision-protect distlocks fixpackages metadata-transfer news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="http://mirror.yandex.ru/gentoo-distfiles/ http://trumpetti.atm.tut.fi/gentoo ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror http://distfiles.gentoo.org ftp://seclorum.msk.ru/etc/gentoo/portage"
LANG="ru_RU.UTF-8"
LC_ALL=""
LDFLAGS="-Wl,-O1"
LINGUAS="ru"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/oschtan /var/lib/layman/rostov /var/lib/layman/rion /usr/local/portage/mozilla /usr/local/portage/sci /usr/local/portage/qting-edge /usr/local/portage/flying"
SYNC="rsync://rsync.ru.gentoo.org/gentoo-portage"
USE="7zip X a52 aac aalib acl acpi additions alsa amd64 amr amrnb amrwb ao apm applet audacious audiofile bash-completion bdf berkdb branding bs2b bzip2 cairo cdparanoia cdr cgi cjk clamav cli color-console consolekit cracklib crypt cups cxx dbus divx djvu dri drm dts dvd dvdr dvdread emboss emerald emf enca encode evo examples exif extensions fam fbcondecor ffmpeg firefox3 flac fortran ftp fuse gd gecko gif gimp glitz gmedia gphoto2 gpm graphviz gtk hal hddtemp hdri htmlhandbook icons iconv icq imagemagick imlib java javascript jbig jpeg jpeg2k kde lame latex lcms libnotify libsamplerate lm_sensors lzma mad mdnsresponder-compat midi mikmod mime mjpeg mmx mng modplug modules motif mozilla mp2 mp3 mp4 mpeg mplayer mudflap multilib multitarget musepack ncurses network nls nova npp nptl nptlonly nsplugin oav objc objc++ objc-gc ogg openexr opengl openmp oscar pam pcre pdf perl pertty plotutils png povray ppds pppd projectm python qt3 qt3support qt4 quicktime rar rcc readline realmedia reflection rtc samba scrobbler sdl sensord session sndfile sound source spell spl sqlite srt sse sse2 ssl ssse3 startup-notification subversion suid svg symlink sysfs syslog szip tcpd templates theora thunar tidy tiff truetype type1 unicode unsupported usb userlocales utempter vcd visualization vorbis wavpack wma wmf wmp x264 x264-svn-encoder xattr xcb xcomposite xml xorg xpm xscreensaver xulrunner xv xvid zip zlib" ALSA_CARDS="intel-hda" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" CAMERAS="adc65 agfa_cl20 aox barbie canon casio_qv clicksmart310 digigr8 digita dimagev dimera3500 directory enigma13 fuji gsmart300 hp215 iclick jamcam jd11 kodak_dc120 kodak_dc210 kodak_dc240 kodak_dc3200 kodak_ez200 konica konica_qm150 largan lg_gsm mars mustek panasonic_coolshot panasonic_dc1000 panasonic_dc1580 panasonic_l859 pccam300 pccam600 polaroid_pdc320 polaroid_pdc640 polaroid_pdc700 ptp2 ricoh ricoh_g3 samsung sierra sipix_blink sipix_blink2 sipix_web2 smal sonix sony_dscf1 sony_dscf55 soundvision spca50x sq905 stv0674 stv0680 sx330z template toshiba_pdrm11 jl2005a topfield" ELIBC="glibc" FOO2ZJS_DEVICES="hpp1006" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="ru" RUBY_TARGETS="ruby18" SANE_BACKENDS="plustek" USERLAND="GNU" VIDEO_CARDS="intel" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

www-client/mozilla-firefox-3.6 was built with the following:
USE="alsa dbus java libnotify (multilib) startup-notification -bindist -custom-optimization -gnome -networkmanager" LINGUAS="ru -af -ar -as -be -bg -bn -bn_BD -bn_IN -ca -cs -cy -da -de -el -en -en_GB -en_US -eo -es -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy -fy_NL -ga -ga_IE -gl -gu -gu_IN -he -hi -hi_IN -hr -hu -id -is -it -ja -ka -kk -kn -ko -ku -lt -lv -mk -ml -mr -nb -nb_NO -nl -nn -nn_NO -oc -or -pa -pa_IN -pl -pt -pt_BR -pt_PT -rm -ro -si -sk -sl -sq -sr -sv -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW" 
CFLAGS="-pipe -march=native -mtune=native -fPIC -Wno-return-type -w"
CXXFLAGS="-pipe -march=native -mtune=native -fPIC -Wno-return-type -w"




Comment 26


Shark





          2010-01-24 12:14:07 UTC
        

I Had the same problem on ~x86, fixed by switching +custom-optimizations. On my box the segfault was due to wrong memory alignment (the instruction executed at the segfault was MOVAPS to memory). Seems mozilla defaults to -Os instead of -O2, maybe gcc with -Os doesn't align to 4-words to reduce memory usage?. 




Comment 27


Sven L.





          2010-01-24 12:49:08 UTC
        

I rebuild firefox with -custom-optimisations and it now works on my x86 box well. 




Comment 28


Sven L.





          2010-01-24 12:49:50 UTC
        

I rebuild firefox with -custom-optimisations and it works now stable. 




Comment 29


Sipingal Liu





          2010-01-24 13:11:24 UTC
        

I have no lucky even downloading the binary version from the mozilla.org. I think that is an upstream bug.




Comment 30


Silvio





          2010-01-24 13:13:18 UTC
        

(In reply to comment #28)
> I rebuild firefox with -custom-optimisations and it works now stable. 
> 

No, it is necessary to rebuild both forefox and xulrunner with that USE flag, and morover I make it solved rebuilding sqlite.

USE=custom-optimization emerge sqlite xulrunner firefox






Comment 31


Michael Gaber





          2010-01-24 14:43:34 UTC
        

can't be an de issue, cause I'm using fluxbox :P

but nevertheless using custom-optimisations fixed it.

and it is NOT only "no need for hardmask b'caus stupid facebook" but this was only a easy and easily reproducible way to get it to crash




Comment 32


Zdenek Sojka





          2010-01-24 15:36:11 UTC
        

Does help adding -mstackrealign to your CFLAGS? And recompiling sys-libs/zlib and/or mozilla-firefox afterwards.

See http://gcc.gnu.org/bugzilla/show_bug.cgi?id=42513




Comment 33


Nikos Chantziaras





          2010-01-24 17:16:36 UTC
        

I'm on KDE and I don't have this problem. I'm using FF 3.6 since RC1 and it never crashed. I don't have "custom-optimization" or anything like that enabled.




Comment 34


Jory A. Pratt






          2010-01-24 18:45:57 UTC
        

This only effects x86 users. We are working on a work around to the breakage, if all goes well it will be avaliable in a couple of hours.




Comment 35


Jory A. Pratt






          2010-01-24 19:18:04 UTC
        

For those effected, please update your portage tree in a few hours and re-emerge xulrunner/firefox 3.6/1.9.2. If you are still expierencing a problem let us know, you will *NOT* need to enable custom-optimization.




Comment 36


Max Steel





          2010-01-24 19:46:19 UTC
        

Here it works!

Portage 2.2_rc61 (default/linux/amd64/10.0, gcc-4.3.4, glibc-2.10.1-r1, 2.6.32-gentoo-r2 x86_64)
=================================================================                               
System uname: Linux-2.6.32-gentoo-r2-x86_64-AMD_Athlon-tm-_64_Processor_4000+-with-gentoo-2.0.1 
Timestamp of tree: Sun, 24 Jan 2010 18:30:01 +0000                                              
app-shells/bash:     4.0_p35                                                                    
dev-java/java-config: 2.1.9-r2                                                                  
dev-lang/python:     2.6.4                                                                      
dev-util/cmake:      2.8.0                                                                      
sys-apps/baselayout: 2.0.1                                                                      
sys-apps/openrc:     0.6.0-r1                                                                   
sys-apps/sandbox:    2.2                                                                        
sys-devel/autoconf:  2.13, 2.63-r1                                                              
sys-devel/automake:  1.8.5-r3, 1.9.6-r2, 1.10.2                                                 
sys-devel/binutils:  2.18-r3                                                                    
sys-devel/gcc-config: 1.4.1                                                                     
sys-devel/libtool:   2.2.6b                                                                     
virtual/os-headers:  2.6.27-r2                                                                  
ACCEPT_KEYWORDS="amd64"                                                                         
ACCEPT_LICENSE="* -@EULA"                                                                       
CBUILD="x86_64-pc-linux-gnu"                                                                    
CFLAGS="-march=native -mfpmath=sse -msse3 -O2 -falign-functions=64 -fstack-protector -pipe -fno-ident -fomit-frame-pointer -frename-registers -fstrict-aliasing -funswitch-loops -fpeel-loops -fsched-spec-load -maccumulate-outgoing-args -fbranch-target-load-optimize -funit-at-a-time -ftree-vectorize -fvect-cost-model -ftree-loop-im -ftree-loop-ivcanon -fivopts -fpredictive-commoning -fdata-sections -ffunction-sections"                                                                                                    
CHOST="x86_64-pc-linux-gnu"                                                                                                       
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/bind"                                                                                                                               
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/udev/rules.d"                                                                                         
CXXFLAGS="-march=native -mfpmath=sse -msse3 -O2 -falign-functions=64 -fstack-protector -pipe -fno-ident -fomit-frame-pointer -frename-registers -fstrict-aliasing -funswitch-loops -fpeel-loops -fsched-spec-load -maccumulate-outgoing-args -fbranch-target-load-optimize -funit-at-a-time -ftree-vectorize -fvect-cost-model -ftree-loop-im -ftree-loop-ivcanon -fivopts -fpredictive-commoning -fdata-sections -ffunction-sections"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS=""
FEATURES="assume-digests distlocks fixpackages news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://de-mirror.org/distro/gentoo/ ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo/ ftp://gentoo.tiscali.nl/"
LANG="de_DE.utf8"
LDFLAGS="-Wl,-O1 -Wl,-z,relro -Wl,-z,combreloc -Wl,--enable-new-dtags -Wl,--as-needed -Wl,--sort-common"
LINGUAS="de"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/oss-overlay /usr/local/portage/layman/kde /usr/local/portage/layman/kde-sunset /usr/local/portage/layman/gnome /usr/local/portage/eigen"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext 7zip X a52 aac aalib accessibility acl acpi additions adns aiglx aio akode alsa amarok2 amazon amd64 amr amrnb amrwb ao aotuv ares asf async audio audiofile autoipd automount avahi avantgo avi bash-completion berkdb bidi bitmap-fonts bluetooth branding bzip2 cairo caps cdda cddb cdio cdparanoia cdr cdrom chm cjk clamav clamd clamdtop cli consolekit cracklib crypt css ctype cups curl custom-cflags custom-cpuopts custom-cxxflags custom-optimization cvs cxx daap dba dbus dcc dcc_video dcc_voice dga djbfft djvu dmi dmx dpms dri dts dv dvb dvd dvdr dvdread dynamic eigen emovix encode enscript esd ethereal exif expat exscalibar extrafilters fam fame fastbuild fbcondecor ffmpeg fftw firefox3 flac fontconfig foomaticdb force-cgi-redirect fpx ftp gd gdbm gecko geoip gif glibc-omitfp glut glx gmp gnokii gpgme gphoto2 gpm graphviz gs gsm gstreamer gzip h323 hal hdri hpn hunspell ical iconv icq icu id3 id3tag idea idn ifp imagemagick imlib immqt-bc ipod ipv6 irmc isdnlog ithreads jabber javascript jbig jce joystick jpeg jpeg2k kde kdehiddenvisibility kdepim kig-scripting kipi lame lcms ldap lha libcaca libg++ libsamplerate libssh2 libwww linuxthreads-tls live lm_sensors logitech-mouse logrotate lua lzo mad maps marok matroska md5sum memlimit midi mikmod mjpeg mmap mmx mmxext mng modplug mozilla mozsvg mp2 mp3 mp4 mpeg msn mtp multilib musepack musicbrainz mysql ncurses network nfsv3 nfsv4 njb nls nptl nptlonly nsplugin ntfs nuv ogg oggvorbis openal openexr opengl oscar oss oss4 pam pam-console pccts pcre pda pdf perl pic png pnm posix pppd projectm python qt qt-dbus qt-webkit qt3 qt3support qt4 quicktime rar rdesktop rdp readline reflection reiserfs rle rtc screen sdl semantic-desktop session shorten sid simplexml sip slang sms sndfile soap sockets soundex speex spell spl sqlite sqlite3 srt sse sse-filters sse2 sse3 ssh ssl startup-notification svg syslog tetex tga theora threads threadsafe thumbnail tidy tiff tokenizer truetype truetype-fonts twolame type1-fonts udev unicode unzip urandom usb userlocales utempter utf8 v4l v4l2 vcd vdpau video vorbis vorbis-psy wavpack wma wma-fixed wmf x264 xanim xattr xcb xcomposite xext xine xinerama xml xml2 xorg xpm xprint xrandr xscreensaver xsl xulrunner xv xvid xvmc yv12 zip zlib zvbi" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="alias cache dir mime vhost_alias version status speling proxy_http authz_host authz_owner authz_user auth_basic authn_alias authn_default headers include info log_config mem_cache proxy proxy_connect proxy_ftp proxy_http" ELIBC="glibc" INPUT_DEVICES="keyboard mouse joystick evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nv nvidia vesa"
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

[I] www-client/mozilla-firefox
     Installed versions:  3.6(11:02:14 23.01.2010)(alsa custom-optimization dbus linguas_de startup-notification -bindist -elibc_FreeBSD -gnome -java -libnotify -linguas_af -linguas_ar -linguas_as -linguas_be -linguas_bg -linguas_bn -linguas_bn_BD -linguas_bn_IN -linguas_ca -linguas_cs -linguas_cy -linguas_da -linguas_el -linguas_en -linguas_en_GB -linguas_en_US -linguas_eo -linguas_es -linguas_es_AR -linguas_es_CL -linguas_es_ES -linguas_es_MX -linguas_et -linguas_eu -linguas_fa -linguas_fi -linguas_fr -linguas_fy -linguas_fy_NL -linguas_ga -linguas_ga_IE -linguas_gl -linguas_gu -linguas_gu_IN -linguas_he -linguas_hi -linguas_hi_IN -linguas_hr -linguas_hu -linguas_id -linguas_is -linguas_it -linguas_ja -linguas_ka -linguas_kk -linguas_kn -linguas_ko -linguas_ku -linguas_lt -linguas_lv -linguas_mk -linguas_ml -linguas_mr -linguas_nb -linguas_nb_NO -linguas_nl -linguas_nn -linguas_nn_NO -linguas_oc -linguas_or -linguas_pa -linguas_pa_IN -linguas_pl -linguas_pt -linguas_pt_BR -linguas_pt_PT -linguas_rm -linguas_ro -linguas_ru -linguas_si -linguas_sk -linguas_sl -linguas_sq -linguas_sr -linguas_sv -linguas_sv_SE -linguas_ta -linguas_ta_LK -linguas_te -linguas_th -linguas_tr -linguas_uk -linguas_vi -linguas_zh_CN -linguas_zh_TW -networkmanager)

[I] net-libs/xulrunner
     Installed versions:  1.9.2(1.9)(01:56:01 23.01.2010)(alsa custom-optimization dbus startup-notification -debug -elibc_FreeBSD -gnome -java -libnotify -networkmanager)





Comment 37


Max Steel





          2010-01-24 19:58:21 UTC
        

Sorry, here is emerge --info www-client/mozilla-firefox net-libs/xulrunner

EMERGE_DEFAULT_OPTS="" emerge --info www-client/mozilla-firefox net-libs/xulrunner
Portage 2.2_rc61 (default/linux/amd64/10.0, gcc-4.3.4, glibc-2.10.1-r1, 2.6.32-gentoo-r2 x86_64)    
=================================================================                                   
                        System Settings                                                             
=================================================================                                   
System uname: Linux-2.6.32-gentoo-r2-x86_64-AMD_Athlon-tm-_64_Processor_4000+-with-gentoo-2.0.1     
Timestamp of tree: Sun, 24 Jan 2010 18:30:01 +0000                                                  
app-shells/bash:     4.0_p35                                                                        
dev-java/java-config: 2.1.9-r2                                                                      
dev-lang/python:     2.6.4                                                                          
dev-util/cmake:      2.8.0                                                                          
sys-apps/baselayout: 2.0.1                                                                          
sys-apps/openrc:     0.6.0-r1                                                                       
sys-apps/sandbox:    2.2                                                                            
sys-devel/autoconf:  2.13, 2.63-r1                                                                  
sys-devel/automake:  1.8.5-r3, 1.9.6-r2, 1.10.2                                                     
sys-devel/binutils:  2.18-r3                                                                        
sys-devel/gcc-config: 1.4.1                                                                         
sys-devel/libtool:   2.2.6b                                                                         
virtual/os-headers:  2.6.27-r2                                                                      
ACCEPT_KEYWORDS="amd64"                                                                             
ACCEPT_LICENSE="* -@EULA"                                                                           
CBUILD="x86_64-pc-linux-gnu"                                                                        
CFLAGS="-march=native -mfpmath=sse -msse3 -O2 -falign-functions=64 -fstack-protector -pipe -fno-ident -fomit-frame-pointer -frename-registers -fstrict-aliasing -funswitch-loops -fpeel-loops -fsched-spec-load -maccumulate-outgoing-args -fbranch-target-load-optimize -funit-at-a-time -ftree-vectorize -fvect-cost-model -ftree-loop-im -ftree-loop-ivcanon -fivopts -fpredictive-commoning -fdata-sections -ffunction-sections"                                                                                                    
CHOST="x86_64-pc-linux-gnu"                                                                                                       
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/bind"                                                                                                                               
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/udev/rules.d"                                                                                         
CXXFLAGS="-march=native -mfpmath=sse -msse3 -O2 -falign-functions=64 -fstack-protector -pipe -fno-ident -fomit-frame-pointer -frename-registers -fstrict-aliasing -funswitch-loops -fpeel-loops -fsched-spec-load -maccumulate-outgoing-args -fbranch-target-load-optimize -funit-at-a-time -ftree-vectorize -fvect-cost-model -ftree-loop-im -ftree-loop-ivcanon -fivopts -fpredictive-commoning -fdata-sections -ffunction-sections"                                                                                                  
DISTDIR="/usr/portage/distfiles"                                                                                                  
EMERGE_DEFAULT_OPTS=""                                                                                                            
FEATURES="assume-digests distlocks fixpackages news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"                                                                                                       
GENTOO_MIRRORS="ftp://de-mirror.org/distro/gentoo/ ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo/ ftp://gentoo.tiscali.nl/"                                                                                                                         
LANG="de_DE.utf8"                                                                                                                 
LDFLAGS="-Wl,-O1 -Wl,-z,relro -Wl,-z,combreloc -Wl,--enable-new-dtags -Wl,--as-needed -Wl,--sort-common"                          
LINGUAS="de"                                                                                                                      
MAKEOPTS="-j4"                                                                                                                    
PKGDIR="/usr/portage/packages"                                                                                                    
PORTAGE_CONFIGROOT="/"                                                                                                            
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"                                                                      
PORTAGE_TMPDIR="/var/tmp"                                                                                                         
PORTDIR="/usr/portage"                                                                                                            
PORTDIR_OVERLAY="/usr/local/portage/layman/oss-overlay /usr/local/portage/layman/kde /usr/local/portage/layman/kde-sunset /usr/local/portage/layman/gnome /usr/local/portage/eigen"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext 7zip X a52 aac aalib accessibility acl acpi additions adns aiglx aio akode alsa amarok2 amazon amd64 amr amrnb amrwb ao aotuv ares asf async audio audiofile autoipd automount avahi avantgo avi bash-completion berkdb bidi bitmap-fonts bluetooth branding bzip2 cairo caps cdda cddb cdio cdparanoia cdr cdrom chm cjk clamav clamd clamdtop cli consolekit cracklib crypt css ctype cups curl custom-cflags custom-cpuopts custom-cxxflags custom-optimization cvs cxx daap dba dbus dcc dcc_video dcc_voice dga djbfft djvu dmi dmx dpms dri dts dv dvb dvd dvdr dvdread dynamic eigen emovix encode enscript esd ethereal exif expat exscalibar extrafilters fam fame fastbuild fbcondecor ffmpeg fftw firefox3 flac fontconfig foomaticdb force-cgi-redirect fpx ftp gd gdbm gecko geoip gif glibc-omitfp glut glx gmp gnokii gpgme gphoto2 gpm graphviz gs gsm gstreamer gzip h323 hal hdri hpn hunspell ical iconv icq icu id3 id3tag idea idn ifp imagemagick imlib immqt-bc ipod ipv6 irmc isdnlog ithreads jabber javascript jbig jce joystick jpeg jpeg2k kde kdehiddenvisibility kdepim kig-scripting kipi lame lcms ldap lha libcaca libg++ libsamplerate libssh2 libwww linuxthreads-tls live lm_sensors logitech-mouse logrotate lua lzo mad maps marok matroska md5sum memlimit midi mikmod mjpeg mmap mmx mmxext mng modplug mozilla mozsvg mp2 mp3 mp4 mpeg msn mtp multilib musepack musicbrainz mysql ncurses network nfsv3 nfsv4 njb nls nptl nptlonly nsplugin ntfs nuv ogg oggvorbis openal openexr opengl oscar oss oss4 pam pam-console pccts pcre pda pdf perl pic png pnm posix pppd projectm python qt qt-dbus qt-webkit qt3 qt3support qt4 quicktime rar rdesktop rdp readline reflection reiserfs rle rtc screen sdl semantic-desktop session shorten sid simplexml sip slang sms sndfile soap sockets soundex speex spell spl sqlite sqlite3 srt sse sse-filters sse2 sse3 ssh ssl startup-notification svg syslog tetex tga theora threads threadsafe thumbnail tidy tiff tokenizer truetype truetype-fonts twolame type1-fonts udev unicode unzip urandom usb userlocales utempter utf8 v4l v4l2 vcd vdpau video vorbis vorbis-psy wavpack wma wma-fixed wmf x264 xanim xattr xcb xcomposite xext xine xinerama xml xml2 xorg xpm xprint xrandr xscreensaver xsl xulrunner xv xvid xvmc yv12 zip zlib zvbi" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="alias cache dir mime vhost_alias version status speling proxy_http authz_host authz_owner authz_user auth_basic authn_alias authn_default headers include info log_config mem_cache proxy proxy_connect proxy_ftp proxy_http" ELIBC="glibc" INPUT_DEVICES="keyboard mouse joystick evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nv nvidia vesa"
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

www-client/mozilla-firefox-3.6 was built with the following:
USE="alsa custom-optimization dbus (multilib) startup-notification -bindist -gnome -java -libnotify -networkmanager" LINGUAS="de -af -ar -as -be -bg -bn -bn_BD -bn_IN -ca -cs -cy -da -el -en -en_GB -en_US -eo -es -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy -fy_NL -ga -ga_IE -gl -gu -gu_IN -he -hi -hi_IN -hr -hu -id -is -it -ja -ka -kk -kn -ko -ku -lt -lv -mk -ml -mr -nb -nb_NO -nl -nn -nn_NO -oc -or -pa -pa_IN -pl -pt -pt_BR -pt_PT -rm -ro -ru -si -sk -sl -sq -sr -sv -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW"
CFLAGS="-march=native -fstack-protector -pipe -fno-ident -fPIC -Wno-return-type -w"
CXXFLAGS="-march=native -fstack-protector -pipe -fno-ident -fPIC -Wno-return-type -w"


net-libs/xulrunner-1.9.2 was built with the following:
USE="alsa custom-optimization dbus (multilib) startup-notification -debug -gnome -java -libnotify -networkmanager"
CFLAGS="-march=native -fstack-protector -pipe -fno-ident -fPIC -Wno-return-type -w"
CXXFLAGS="-march=native -fstack-protector -pipe -fno-ident -fPIC -Wno-return-type -w"





Comment 38


Robert Cabrera





          2010-01-24 20:07:03 UTC
        

I've been busy the last couple of days with family business. I just checked on the forum thread which has been prematurely marked as "solved". http://forums.gentoo.org/viewtopic-t-812351.html

Just to be sure I understand what's been discovered and actually resolved, it appears this issue only effects x86 and ~x86 arches and that enabling the "custom-optimization" USE flag appears to be a work-around.

Just curious (again I'm no IT guy just a hobbyist) but perhaps the problem could be that the finished compiled binaries are "too generic" on highly optimized systems?

I know in my case that my kernel has been tweaked from years of experimentation. My kernel is completely optimized to run on my pentium-m laptop. All generic kernel optimizations have been turned off.

I don't know if this would effect things as they have done, but I thought it might be helpful to mention.

Thanks folks for all of the hard work and effort. I'm looking forward to trying the new ebuild later when it's reached the mirrors. Thanks in advance




Comment 39


Robert Cabrera





          2010-01-24 20:12:04 UTC
        

(In reply to comment #37)
> Sorry, here is emerge --info www-client/mozilla-firefox net-libs/xulrunner
> 
> EMERGE_DEFAULT_OPTS="" emerge --info www-client/mozilla-firefox
> net-libs/xulrunner
> Portage 2.2_rc61 (default/linux/amd64/10.0, gcc-4.3.4, glibc-2.10.1-r1,
> 2.6.32-gentoo-r2 x86_64)    

Max, according to what has been posted here and on the forum thread, I don't believe you were ever effected. The problem only seems to manifest itself on x86 and ~x86 arches. 64bit arches don't appear to have been effected at all.

Ciao




Comment 40


Rafał Mużyło





          2010-01-24 22:06:47 UTC
        

To add to confusion:
I'm on x86, was using ebuilds for rc2 from the overlay,
edited to work with full release and haven't experienced any crashes.
xulrunner-1.9.2:
USE="alsa dbus java libnotify sqlite startup-notification -custom-optimization -debug -gnome -networkmanager" 
CFLAGS="-march=athlon -mtune=athlon -pipe -Wno-return-type -w"
CXXFLAGS="-march=athlon -mtune=athlon -pipe -Wno-return-type -w"
firefox-3.6:
USE="alsa dbus java libnotify sqlite startup-notification -bindist -custom-optimization -gnome -networkmanager" LINGUAS="en_US pl -af -ar -as -be -bg -bn -bn_BD -bn_IN -ca -cs -cy -da -de -el -en -en_GB -eo -es -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy -fy_NL -ga -ga_IE -gl -gu -gu_IN -he -hi -hi_IN -hr -hu -id -is -it -ja -ka -kk -kn -ko -ku -lt -lv -mk -ml -mr -nb -nb_NO -nl -nn -nn_NO -oc -or -pa -pa_IN -pt -pt_BR -pt_PT -rm -ro -ru -si -sk -sl -sq -sr -sv -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW" 
CFLAGS="-march=athlon -mtune=athlon -pipe -Wno-return-type -w"
CXXFLAGS="-march=athlon -mtune=athlon -pipe -Wno-return-type -w"




Comment 41


Robert Cabrera





          2010-01-24 22:15:44 UTC
        

I just got through recompiling/installing with the custom-optimization USE flag enabled. Will see how it goes.

However a note to maintainers when I re-emerged xulrunner I again got this message, "* Any package that requires xulrunner:1.9 slot could and most likely will
 * have issues. These issues should be reported to maintainer, and mozilla herd
 * should be cc'd on the bug report. Thank you anarchy@gentoo.org .
>>> Regenerating /etc/ld.so.cache...
<<< !needed  obj /usr/lib/xulrunner-1.9.1/libmozjs.so
<<< !needed  obj /usr/lib/xulrunner-1.9.1/libxpcom.so
<<< !needed  obj /usr/lib/xulrunner-1.9.1/libxul.so"

Which are the exact xulrunner warnings I had with the initial install. I'm currently running revdep-rebuild and will report back if there are additional issues. TIA




Comment 42


Jory A. Pratt






          2010-01-24 22:24:21 UTC
        

(In reply to comment #41)
> I just got through recompiling/installing with the custom-optimization USE flag
> enabled. Will see how it goes.
Okay you all have failed to understand, you do not need to enable custom-optimization useflag if you have just sync'd your tree. I have update the mozcoreconf-2.eclass to address the x86 runtime issues.




Comment 43


Robert Cabrera





          2010-01-24 23:10:45 UTC
        

(In reply to comment #42)
> (In reply to comment #41)
> > I just got through recompiling/installing with the custom-optimization USE flag
> > enabled. Will see how it goes.
> Okay you all have failed to understand, you do not need to enable
> custom-optimization useflag if you have just sync'd your tree. I have update
> the mozcoreconf-2.eclass to address the x86 runtime issues.
> 

Jury,
At the time when I synced your changes hadn't hit the mirrors yet as both xulrunner and firefox were still hard-masked. I compiled and reinstalled with the custom-optimization USE flag more for my own purposes to see if Firefox would work for me like that, and it did.

(It's Sunday the wife and kids are busy, my favorite football team,the Dolphins, were eliminated, thus I no longer care about who's playing, so I had some time on my hand to experiment.)

Building both with the USE="custom-optimization" works brilliantly, however "google-gadgets" still breaks with this change.

I see now that your updates have hit the mirrors and I'm rebuilding without the custom-optimization flag as we speak. I will respond back with my results as soon as I've finished. TIA




Comment 44


Fabio Coatti





          2010-01-25 15:35:30 UTC
        

I can confirm that now FF 3.6 works just fine without USE="custom-optimization" on ~x86, many thanks!
(in make.conf I have -O2 in GCC options.)




Comment 45


Petr Zima





          2010-01-25 16:36:51 UTC
        

Also confirming that mozilla-firefox-3.6 now works without segfaults even without "custom-optimization" use flag on x86 (32-bit Pentium 4). Most probably we are hitting Bug 270120, since:
1) it is x86 (32bit) specific,
2) it is gcc-4.4 specific (?), at least for me
3) it is -O3 specific, -O2 helps
I cannot confirm this on 100%, since the mozilla's configure ignores CFLAGS envvar and accepts only "-enable-optimize=-Ox", hence I know no simple way to use my default "-O3 -fno-tree-vectorize" with xulrunner or firefox. Anyway, when the bug in gcc-4.4 gets fixed this workaround in moz* eclass should be removed.

Btw. First I modified the ebuilds for xulrunner and firefox to force "-O2" in my local overlay. Then I got quite confused, when the version from portage started to build with "-O2" while the ebuild was left unchanged! Hence I point out again to other lame/indolent users like me:

The bug is fixed in eclass/moz*.eclass, see Comment #42 ;)




Comment 46


Robert Cabrera





          2010-01-25 23:24:05 UTC
        

Jory,
Great work! The new build works as advertised. Keep up the good work! Thanks again for your rapid help and resolution.

Ciao




Comment 47


Torsten Kurbad





          2010-03-18 22:27:38 UTC
        

I just ran into the same on my netbook (Atom N270) while using gcc 4.4.3 with

CFLAGS="-march=native -O3 -mfpmath=sse -fomit-frame-pointer -pipe"
CXXFLAGS=${CFLAGS}"

In addition to mozilla-firefox, also seamonkey crashed right at the start.

Changing CFLAGS to:

CFLAGS="-march=native -O3 -mstackrealign -mfpmath=sse -fomit-frame-pointer -pipe"

and rebuilding

sys-libs/zlib
media-libs/alsa-lib
net-libs/xulrunner
www-client/firefox

fixed firefox 3.6 for me. Seamonkey still crashes most of the time upon startup - but I can't seem to figure out, why...




Comment 48


Torsten Kurbad





          2010-03-18 22:36:08 UTC
        

(In reply to comment #47)
Update:

seamonkey works if started by calling /usr/lib/seamonkey/seamonkey-bin directly instead of using the mozilla-launcher through /usr/bin/seamonkey




Comment 49


Roger





          2010-06-12 08:12:54 UTC
        

I get this same bug after upgrading to =sys-devel/gcc-4.4.3-r2 and rebuilding my system.

Here's seamonkey strace:
open("/lib/libxpcom_core.so", O_RDONLY) = -1 ENOENT (No such file or directory)
stat64("/lib", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
open("/usr/lib/libxpcom_core.so", O_RDONLY) = -1 ENOENT (No such file or directory)
writev(2, [{"/usr/lib/seamonkey/seamonkey-bin", 32}, {": ", 2}, {"error while loading shared libra"..., 36}, {": ", 2}, {"libxpcom_core.so", 16}, {": ", 2}, {"cannot open shared object file", 30}, {": ", 2}, {"No such file or directory", 25}, {"\n", 1}], 10/usr/lib/seamonkey/seamonkey-bin: error while loading shared libraries: libxpcom_core.so: cannot open shared object file: No such file or directory
) = 148
exit_group(127) 

$ ls -alh /usr/lib/seamonkey/libxpcom_core.so
-rwxr-xr-x 1 root root 649K Jun 11 01:13 /usr/lib/seamonkey/libxpcom_core.so

Before a day or so ago just prior to syncing portage today, I was getting this same error but with a file:
/usr/lib/seamonkey/libmozjs.so

Which still gives me a segfault on execution too:
$ strace /usr/lib/seamonkey/libmozjs.so
execve("/usr/lib/seamonkey/libmozjs.so", ["/usr/lib/seamonkey/libmozjs.so"], [/* 42 vars */]) = 0
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV +++
Segmentation fault

(...oh yea, but the file is there and *is* executable!)

And here's icecat (Debian's Firefox build):
gettimeofday({1276329815, 727550}, NULL) = 0
_llseek(18, 0, [0], SEEK_SET)           = 0
read(18, "\211PNG\r\n\32\n\0\0\0\rIHDR\0\0\0\20\0\0\0\20\10\6\0\0\0\37\363\377"..., 4096) = 3763
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
unlink("/home/roger/.gnuzilla/icecat/blahblah.default/lock") = 0
rt_sigaction(SIGSEGV, {SIG_DFL, [], 0}, NULL, 8) = 0
rt_sigprocmask(SIG_UNBLOCK, [SEGV], NULL, 8) = 0
tgkill(14262, 14262, SIGSEGV)           = 0
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV +++
Segmentation faul

This appears after trying to find some *.png files.

I believe one version of libpng did have issues in the past, but to my knowledge, that had resolved itself(?)


Anyways, all this stuff seems to have been the result of a recent gcc upgrade.

I'm tempted to reopen this bug.




Comment 50


Michael Weber (RETIRED)






          2010-06-12 15:28:42 UTC
        

I think there's an issue left ...




Comment 51


Roger





          2010-06-12 23:07:43 UTC
        

Compiled Seamonkey & Icecat using the old stable =sys-devel/gcc-4.3.4 and I still get the same segfaults on all GUI browsers.

One thing I might have forgotten, need to compile with "custom-optimization" USE Flag to enable debug flags.(?)  (This may have been why some found this option worked in the past.)  Also noticing a new linguas_en_US flag.

Whatever package I upgraded in the past one to two weeks, has totally broken GUI Mozilla browsers here.  Really, the past week during the GCC upgrade.  I'm lucky I didn't sync any of my clients.

Using almost entirely stable here and have limited the number of packages I have installed (avoiding GNOME/KDE and using DWM... etc).  Elinks works like a charm though. ;-)




Comment 52


Roger





          2010-06-13 01:55:57 UTC
        

After recompiling zlib-1.2.3-r1 using debug flags, I've found Bug 270120 is causing my unexplained segfaults.

Reclosing this one.  After reading the entire thread, think I'll mark it as "worksforme" as this bug has had little activity and most seem to have resolved the issue?  ... feel free to correct if I'm wrong. ... I do have x86 too.




Comment 53


lumbrius





          2010-07-18 08:31:07 UTC
        

I'm experiencing this problem again and nothing helps me :( (tried build with and without costom optimization flag, remove profile etc)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

