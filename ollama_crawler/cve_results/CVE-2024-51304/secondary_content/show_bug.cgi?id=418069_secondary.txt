Title: 418069 – emerge net-mail/courier-imap-4.5.0 fails from automake version mismatch
URL: https://bugs.gentoo.org/show_bug.cgi?id=418069

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 418069
emerge net-mail/courier-imap-4.5.0 fails from automake version mismatch
Last modified: 2012-06-08 16:33:31 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 418069 
      - emerge net-mail/courier-imap-4.5.0 fails from automake version mismatch


Summary:
emerge net-mail/courier-imap-4.5.0 fails from automake version mismatch
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Hardened

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-05-29 00:38 UTC by Heavenly Avenger





      Modified:
    
2012-06-08 16:33 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Automake.out

              (automake-out.txt,493 bytes,
                text/plain)

            
2012-05-29 00:38 UTC,

            Heavenly Avenger




Details





Full build log

              (build-log.txt,10.63 KB,
                text/plain)

            
2012-05-29 00:39 UTC,

            Heavenly Avenger




Details





Environment data

              (environment.txt,98.51 KB,
                text/plain)

            
2012-05-29 00:40 UTC,

            Heavenly Avenger




Details





Emerge --debug as requested by Spanky

              (courier-imap-4.5.0-emerge2.log.bz2,48.12 KB,
                application/octet-stream)

            
2012-06-08 16:17 UTC,

            Heavenly Avenger




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Heavenly Avenger





          2012-05-29 00:38:25 UTC
        

Created attachment 313453 [details]
Automake.out

net-mail/courier-imap-4.5.0 fails to build with the error below on the related logfile:
---
***** automake *****
***** PWD: /var/tmp/portage/net-mail/courier-imap-4.5.0/work/courier-imap-4.5.0/rootcerts
***** automake --add-missing --copy --foreign

configure.in:11: version mismatch.  This is Automake 1.11.1,
configure.in:11: but the definition used by this AM_INIT_AUTOMAKE
configure.in:11: comes from Automake 1.10.1.  You should recreate
configure.in:11: aclocal.m4 with aclocal and run automake again.
---

It seems to be an error documented here: http://www.gentoo.org/proj/en/qa/autofailure.xml at "automake version mismatch when running eautoreconf" and suggests this is an unexpected and actual bug on the ebuild.

I am using the hardened profile
---
 eselect profile list
Available profile symlink targets:
  [1]   default/linux/amd64/10.0
  [2]   default/linux/amd64/10.0/selinux
  [3]   default/linux/amd64/10.0/desktop
  [4]   default/linux/amd64/10.0/desktop/gnome
  [5]   default/linux/amd64/10.0/desktop/kde
  [6]   default/linux/amd64/10.0/developer
  [7]   default/linux/amd64/10.0/no-multilib
  [8]   default/linux/amd64/10.0/server
  [9]   hardened/linux/amd64 *
  [10]  hardened/linux/amd64/selinux
  [11]  hardened/linux/amd64/no-multilib
  [12]  hardened/linux/amd64/no-multilib/selinux
---

My uname -a is:
---
 uname -a
Linux ethereal 3.2.12-gentoo-avenger #4 SMP Sat May 26 17:03:51 BRT 2012 x86_64 Intel(R) Xeon(R) CPU L5420 @ 2.50GHz GenuineIntel GNU/Linux
---

emerge log of the moment of the error:
--- * Running eautoreconf in '/var/tmp/portage/net-mail/courier-imap-4.5.0/work/courier-imap-4.5.0/rootcerts' ...
 * Running aclocal ...                                                   [ ok ]
 * Running autoconf ...                                                  [ ok ]
 * Running automake --add-missing --copy --foreign ...                   [ !! ]

 * Failed Running automake !
 *
 * Include in your bugreport the contents of:
 *
 *   /var/tmp/portage/net-mail/courier-imap-4.5.0/temp/automake-17.out

 * ERROR: net-mail/courier-imap-4.5.0 failed (unpack phase):
 *   Failed Running automake !
 *
 * Call stack:
 *     ebuild.sh, line   85:  Called src_unpack
 *   environment, line 2669:  Called eautoreconf
 *   environment, line  686:  Called eautoreconf
 *   environment, line  714:  Called eautomake
 *   environment, line  672:  Called autotools_run_tool 'automake' '--add-missing' '--copy' '--foreign'
 *   environment, line  466:  Called die
 * The specific snippet of code:
 *           die "Failed Running $1 !";
 *
 * If you need support, post the output of 'emerge --info =net-mail/courier-imap-4.5.0',
 * the complete build log and the output of 'emerge -pqv =net-mail/courier-imap-4.5.0'.
 * The complete build log is located at '/var/tmp/portage/net-mail/courier-imap-4.5.0/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/net-mail/courier-imap-4.5.0/temp/environment'.
 * S: '/var/tmp/portage/net-mail/courier-imap-4.5.0/work/courier-imap-4.5.0'
---

emerge -pqv:
---
 emerge -pqv =net-mail/courier-imap-4.5.0
[ebuild  N    ] net-mail/courier-imap-4.5.0  USE="berkdb gdbm gnutls ipv6 nls -debug -fam (-selinux)"
---

I hope I provided enough information for the bug to be fixed, please understand I could have misunderstood the error and filed the bug in mistake. It does not look like a compiler error or such nor caused by the compiler but a 'trick' not well done on the ebuild for the given package.

Thanks




Comment 1


Heavenly Avenger





          2012-05-29 00:39:25 UTC
        

Created attachment 313455 [details]
Full build log




Comment 2


Heavenly Avenger





          2012-05-29 00:40:15 UTC
        

Created attachment 313457 [details]
Environment data




Comment 3


Heavenly Avenger





          2012-05-29 00:40:56 UTC
        

emerge --info =net-mail/courier-imap-4.5.0                         Portage 2.1.10.49 (hardened/linux/amd64, gcc-4.5.3, glibc-2.14.1-r3, 3.2.12-gentoo-avenger x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-3.2.12-gentoo-avenger-x86_64-Intel-R-_Xeon-R-_CPU_L5420_@_2.50GHz-with-gentoo-2.1
Timestamp of tree: Sat, 26 May 2012 03:15:01 +0000
app-shells/bash:          4.2_p20
dev-lang/python:          2.7.3-r1, 3.2.3
dev-util/cmake:           2.8.7-r5
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1-r1
sys-apps/openrc:          0.9.8.4
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.68
sys-devel/automake:       1.11.1
sys-devel/binutils:       2.21.1-r1
sys-devel/gcc:            4.5.3-r2
sys-devel/gcc-config:     1.5-r2
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82-r1
sys-kernel/linux-headers: 3.1 (virtual/os-headers)
sys-libs/glibc:           2.14.1-r3
Repositories: gentoo
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O3 -march=native -pipe -mfpmath=sse -floop-interchange -floop-strip-mine -floop-block"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/gconf /etc/gentoo-release /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O3 -march=native -pipe -mfpmath=sse -floop-interchange -floop-strip-mine -floop-block"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks ebuild-locks fixlafiles news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://mirror.mcs.anl.gov/pub/gentoo/ rsync://mirror.mcs.anl.gov/gentoo/ ftp://mirror.mcs.anl.gov/pub/gentoo/ ftp://gentoo.chem.wisc.edu/gentoo/ rsync://gentoo.chem.wisc.edu/gentoo/ http://gentoo.chem.wisc.edu/gentoo/ http://www.cyberuse.com/gentoo/ http://gentoo.mirrors.easynews.com/linux/gentoo/ http://chi-10g-1-mirror.fastsoft.net/pub/linux/gentoo/gentoo-distfiles/ ftp://chi-10g-1-mirror.fastsoft.net/pub/linux/gentoo/gentoo-distfiles/ ftp://ftp.ussg.iu.edu/pub/linux/gentoo ftp://gentoo.mirrors.tds.net/gentoo rsync://gentoo.mirrors.tds.net/gentoo http://gentoo.mirrors.tds.net/gentoo ftp://ftp.lug.udel.edu/pub/gentoo/ http://mirror.lug.udel.edu/pub/gentoo/ rsync://gentoo.cs.uni.edu/gentoo-distfiles http://gentoo.cs.uni.edu/"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,--as-needed"
MAKEOPTS="-j9"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY=""
SYNC="rsync://rsync.us.gentoo.org/gentoo-portage"
USE="acl acpi amd64 apache2 bash-completion bcmath berkdb bittorrent bugzilla bzip2 bzlib cgi cli cracklib crypt curl curlwrappers cxx dap dri fortran ftp gd gdbm gmp gnutls gpg gpm graphite hardened hdf5 iconv imap ipv6 ithreads jpeg jpeg2k justify libwww lzma lzo maildir mmx modules mudflap multilib multiuser mysql ncurses net network nls nptl openmp pam pax_kernel pcre perl png pppd python readline ruby sasl session snmp sse sse2 sse3 ssl suexec szip tcl tcpd threads unicode urandom vim-pager xml xorg zip zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" PHP_TARGETS="php5-3" PYTHON_TARGETS="python3_2 python2_7" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="fbdev glint intel mach64 mga neomagic nouveau nv r128 radeon savage sis tdfx trident vesa via vmware dummy v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, LINGUAS, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON




Comment 4


Heavenly Avenger





          2012-05-29 01:07:31 UTC
        

Unmasking =net-misc/courier-imap-4.8.0 installs correctly (though it is no longer part of the hardened project I guess).

Did I make a mistake by switching to the hardened profile? :/




Comment 5


SpanKY






          2012-05-30 22:00:40 UTC
        

i can't reproduce here.  is your tree up to date ?




Comment 6


Heavenly Avenger





          2012-06-04 04:04:44 UTC
        

Yes it is, its a fresh gentoo installation. Once I switched to profile hardened/amd64, I've emerged --sync (it did not complain about timestamps and synced everything), and then done that whole rebuild of the system.

Only this courier-imap-4.5.0 gave me trouble. I've just switched (unmasked) to 4.8.0, everything worked. Maybe you are using automake 1.10.1 on your hardened branch. Here, upon a whole rebuild, automake did not revert from 1.11 to 1.10, that could have been the reason of the failure, but yet hardened courier-imap-4.5.0 might only compile if you have automake 1.10.1 installed, as it is (supposedly) not updating aclocal.m4 on the build process which, according to the 'autofailure' cited on the first comment, should have been.

Well, I've already switched to another version of courier that works. If you are using there automake 1.11 or anything different than 1.10.1 and can emerge hardened's courier-imap-4.5.0, then you may mark my bug report as 'invalid' until someone else raises the matter (which could be never).

Thank you.




Comment 7


SpanKY






          2012-06-08 05:06:43 UTC
        

does it fail every time ?  if so, can you run:
# emerge --debug courier-imap >& log

and post the log as an attachment




Comment 8


Heavenly Avenger





          2012-06-08 15:21:49 UTC
        

How could I do it without affecting the already installed 4.8.0?

emerge --buildpkgonly would suffice?




Comment 9


Heavenly Avenger





          2012-06-08 16:17:26 UTC
        

Created attachment 314699 [details]
Emerge --debug as requested by Spanky

I can't really see if this thing failed or not in the end, too much output! Anyway, I've done a plain:
emerge --buildpkgonly -a =courier-imap-4.5.0

And it erroes.

emerge --buildpkgonly --debug -a =courier-imap-4.5.0
does all that stuff on the log file.

I have redirected the output with

emerge --buildpkgonly --debug -a =courier-imap-4.5.0 | tee courier-imap-4.5.0-build.log




Comment 10


Heavenly Avenger





          2012-06-08 16:33:31 UTC
        

Yeah... allright. This is definetly weird.

Just before running the --debug emerge, I've run it without --debug to see if the error happens. It happened, looking thru the debug I couldn't find any error, and running again the emerge without --debug worked. This is definetly strange, as a 'neutral' option like --debug could have fixed the isse.

emerge --buildpkgonly -a =courier-imap-4.5.0
==> automake error

emerge --buildpkgonly --debug -a =courier-imap-4.5.0
==> sent you output -- seemed not to have an error

emerge --buildpkgonly -a =courier-imap-4.5.0
==> the process goes until its end.

I SWEAR I've done these three commands today in that order. First confirmed the problem was still there, then ran the suggested command, and then run it again to test if the issue was still.

The --debug switch might have enabled in some way automake/autoconf to recreate (for example with additional flags) the aclocal.m4 file, which was not being re-generated in the past maybe because it did not have any special flags and it assumed it was not needed to recreate the file.

I wonder if this would happen on new gentoo installations using the hardened profile. Soon I will be installing another gentoo from the scratch and I will keep an eye for that problem.

In the end, there was one solution for the problem: running emerge --debug. heh









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

