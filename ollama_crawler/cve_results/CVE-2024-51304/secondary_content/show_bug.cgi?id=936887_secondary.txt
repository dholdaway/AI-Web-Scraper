Title: 936887 – dev-libs/libclc-18.1.8: cannot find libLLVMSPIRVLib.so.18.1
URL: https://bugs.gentoo.org/show_bug.cgi?id=936887

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 936887
dev-libs/libclc-18.1.8: cannot find libLLVMSPIRVLib.so.18.1
Last modified: 2024-08-03 21:19:53 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 936887 
      - dev-libs/libclc-18.1.8: cannot find libLLVMSPIRVLib.so.18.1


Summary:
dev-libs/libclc-18.1.8: cannot find libLLVMSPIRVLib.so.18.1
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2024-07-29 13:04 UTC by Terin Stock





      Modified:
    
2024-08-03 21:19 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



mattst88
terinjokes









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Terin Stock





          2024-07-29 13:04:11 UTC
        

libclc cannot be upgraded from 17.0.6 due to a linking error on Prefix:

FAILED: spirv-mesa3d-.spv /home/terin/gentoo/var/tmp/portage/dev-libs/libclc-18.1.8/work/libclc_build/spirv-mesa3d-.spv
/home/terin/gentoo/usr/lib/llvm/18/bin/llvm-spirv: error while loading shared libraries: libLLVMSPIRVLib.so.18.1: cannot open shared object file: No such file or directory

However, this library has already been built by dev-util/spirv-llvm-translator without issue:

$ equery f dev-util/spirv-llvm-translator | rg libLLVMSPIRVLib.so.18.1
/home/terin/gentoo/usr/lib/llvm/18/lib64/libLLVMSPIRVLib.so.18.1
$ file /home/terin/gentoo/usr/lib/llvm/18/lib64/libLLVMSPIRVLib.so.18.1
/home/terin/gentoo/usr/lib/llvm/18/lib64/libLLVMSPIRVLib.so.18.1: ELF 64-bit LSB shared object, x86-64, version 1 (GNU/Linux), dynamically linked, stripped




Comment 1


Mike Gilbert






          2024-07-29 17:05:42 UTC
        

Please attach a build log showing the failure and provide emerge --info in a comment.




Comment 2


Matt Turner






          2024-07-31 16:57:09 UTC
        

I'm guessing that this happened during an update that installed llvm:18 and spirv-llvm-translator:18.

There's an /etc/env.d/*llvm* file that sets some paths and is responsible for adding the path containing libLLVMSPIRVLib.so to LDPATH.

I'd try running `env-update && source /etc/profile` and try emerging libclc again.




Comment 3


Terin Stock





          2024-07-31 17:20:00 UTC
        

Yes, LLVM was updated at the same time. Updating and re-sourcing the environment seems to have worked.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

