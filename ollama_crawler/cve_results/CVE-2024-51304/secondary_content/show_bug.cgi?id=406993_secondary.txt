Title: 406993 – sys-apps/portage-2.2.0_alpha90: emerge failure on update/reinstall action
URL: https://bugs.gentoo.org/show_bug.cgi?id=406993

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 406993
sys-apps/portage-2.2.0_alpha90: emerge failure on update/reinstall action
Last modified: 2012-03-05 16:44:55 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 406993 
      - sys-apps/portage-2.2.0_alpha90: emerge failure on update/reinstall action


Summary:
sys-apps/portage-2.2.0_alpha90: emerge failure on update/reinstall action
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core - Interface (emerge)

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       blocker
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-03-05 13:28 UTC by Andrew Savchenko





      Modified:
    
2012-03-05 16:44 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



bircoph









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge.info,8.10 KB,
                text/plain)

            
2012-03-05 13:31 UTC,

            Andrew Savchenko




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andrew Savchenko






          2012-03-05 13:28:21 UTC
        

Just synced my tree and updated portage from 2.2.0_alpha89 to 2.2.0_alpha90.

After this and only this change system is a complete screw-up. I can't update or reinstall any package. Emerge fails as follows:

# emerge portage
Calculating dependencies     ... done!                        

>>> Verifying ebuild manifests
Traceback (most recent call last):
  File "/usr/bin/emerge", line 43, in <module>
    retval = emerge_main()
  File "/usr/lib/portage/pym/_emerge/main.py", line 2030, in emerge_main
    myopts, myaction, myfiles, spinner)
  File "/usr/lib/portage/pym/_emerge/actions.py", line 442, in action_build
    retval = mergetask.merge()
  File "/usr/lib/portage/pym/_emerge/Scheduler.py", line 1002, in merge
    rval = self._merge()
  File "/usr/lib/portage/pym/_emerge/Scheduler.py", line 1352, in _merge
    self._main_loop()
  File "/usr/lib/portage/pym/_emerge/PollScheduler.py", line 144, in _main_loop
    self._schedule()
  File "/usr/lib/portage/pym/_emerge/PollScheduler.py", line 134, in _schedule
    self._schedule_tasks()
  File "/usr/lib/portage/pym/_emerge/Scheduler.py", line 1516, in _schedule_tasks
    if self._schedule_tasks_imp():
  File "/usr/lib/portage/pym/_emerge/Scheduler.py", line 1582, in _schedule_tasks_imp
    task = self._task(pkg)
  File "/usr/lib/portage/pym/_emerge/Scheduler.py", line 1646, in _task
    mtimedb=self._mtimedb, pkg=pkg, pkg_count=self._pkg_count.copy(),
  File "/usr/lib/portage/pym/portage/util/SlotObject.py", line 36, in copy
    obj = celf.__class__()
NameError: global name 'celf' is not defined

I got this on ~x86, can't reproduce on ~amd64. Though ~x86 system haven't undergone full world update for a rather long time (~8 month).




Comment 1


Andrew Savchenko






          2012-03-05 13:31:18 UTC
        

Created attachment 304305 [details]
emerge --info

Well, at least I was able to get emerge --info.




Comment 2


Andrew Savchenko






          2012-03-05 13:40:21 UTC
        

If the file /usr/lib/portage/pym/portage/util/SlotObject.py on the line 36 I replaced

obj = celf.__class__()
with
obj = self.__class__()

Looks like a typo.




Comment 3


Zac Medico






          2012-03-05 16:44:55 UTC
        

It seems that the file got corrupted somehow. Apparently it's not reproducible, so I'll close the bug.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

