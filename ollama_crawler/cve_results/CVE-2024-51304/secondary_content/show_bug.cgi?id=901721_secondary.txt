Title: 901721 – sys-libs/glibc-2.36-r7 fail to build (makeinfo is /dev/null)
URL: https://bugs.gentoo.org/show_bug.cgi?id=901721

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 901721
sys-libs/glibc-2.36-r7 fail to build (makeinfo is /dev/null)
Last modified: 2023-03-20 12:00:51 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 901721 
      - sys-libs/glibc-2.36-r7 fail to build (makeinfo is /dev/null)


Summary:
sys-libs/glibc-2.36-r7 fail to build (makeinfo is /dev/null)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2023-03-17 01:10 UTC by Sheng Yu





      Modified:
    
2023-03-20 12:00 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




glibc log

              (glibc.log,17.61 KB,
                text/x-log)

            
2023-03-17 01:10 UTC,

            Sheng Yu




Details





portage --info

              (portage.log,7.33 KB,
                text/x-log)

            
2023-03-17 01:12 UTC,

            Sheng Yu




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Sheng Yu





          2023-03-17 01:10:11 UTC
        

I got a weird error that says makeinfo is null during glibc building:

MAKEINFO:   /dev/null

checking for makeinfo... /dev/null
checking version of /dev/null... v. ?.??, bad

This is a desktop mixed hardened, with some LLVM/Clang.
sys-libs/glibc-2.36-r5 works fine.

Reproducible: Always




Comment 1


Sheng Yu





          2023-03-17 01:10:48 UTC
        

Created attachment 858037 [details]
glibc log




Comment 2


Sheng Yu





          2023-03-17 01:12:21 UTC
        

Created attachment 858039 [details]
portage --info




Comment 3


Sam James









          2023-03-17 01:18:12 UTC
        

That's not the actual error. This is:


checking linker support for INSERT in linker script... no
checking for broken __attribute__((alias()))... yes
configure: error: working alias attribute support required
 * ERROR: sys-libs/glibc-2.36-r7::gentoo failed (configure phase):
 *   failed to configure glibc




Comment 4


Sheng Yu





          2023-03-17 01:23:48 UTC
        

OK, my bad. I found what happened:

configure:5849: checking for broken __attribute__((alias()))
configure:5864: gcc -m32 -mfpmath=sse -mstackrealign -fPIC -D_FORTIFY_SOURCE=2 -fstack-clash-protection -fcf-protection=full -O2  -Werror -S conftest.c -o conftest.s 1>&5
<command-line>: error: "_FORTIFY_SOURCE" redefined [-Werror]
<built-in>: note: this is the location of the previous definition
cc1: all warnings being treated as errors
configure:5867: $? = 1
configure:5877: result: yes
configure:5880: error: working alias attribute support required




Comment 5


Sam James









          2023-03-17 01:24:25 UTC
        

>CFLAGS="-march=znver3 -O2 -pipe -fPIC -fstack-protector-strong -D_FORTIFY_SOURCE=2"

You can drop -D_FORTIFY_SOURCE (and -fstack-protector*, -fPIC) from make.conf now, as we do it for clang as well via /etc/clang.




Comment 6


Sheng Yu





          2023-03-17 01:33:19 UTC
        

Then I run into #901363 lol. I cannot close this one.




Comment 7


Sam James









          2023-03-20 12:00:51 UTC
        

(In reply to Sheng Yu from comment #6)
> Then I run into #901363 lol. I cannot close this one.

All OK now?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

