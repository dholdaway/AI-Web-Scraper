Title: 499856 – app-office/abiword-3.0.0-r1 - segmentation fault in ?? () from /usr/lib64/libdrm.so.2
URL: https://bugs.gentoo.org/show_bug.cgi?id=499856

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 499856
app-office/abiword-3.0.0-r1 - segmentation fault in ?? () from /usr/lib64/libdrm.so.2
Last modified: 2014-02-03 15:26:41 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 499856 
      - app-office/abiword-3.0.0-r1 - segmentation fault in ?? () from /usr/lib64/libdrm.so.2


Summary:
app-office/abiword-3.0.0-r1 - segmentation fault in ?? () from /usr/lib64/lib...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

GNOME Office (OBSOLETE)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-01-31 00:29 UTC by Toni Ballesta





      Modified:
    
2014-02-03 15:26 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Full backtrace

              (file_499856.txt,3.34 KB,
                text/plain)

            
2014-01-31 00:29 UTC,

            Toni Ballesta




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Toni Ballesta





          2014-01-31 00:29:18 UTC
        

Created attachment 369182 [details]
Full backtrace

The application is compiled ok with clang and gcc.

But I run it, message: Segmentation fault.

=============
DEBUG: AP_SemanticItemFactoryGTK()
DEBUG: ZZZZZZZZZZZZZZZZZZZZZZZaaaaaaaaaaaaaaAbiSuite Home |/usr/share/abiword-3.0|
DEBUG: SEVIOR: Building menus and toolbars 
DEBUG: Created LayoutFontMap 0x63e150 Layout Context 0x645a40 resolution 1440 device resolution 96 

Program received signal SIGSEGV, Segmentation fault.
=============

I compile for debug with 4 direct dependencies:

#0  0x00007fffe592e364 in ?? () from /usr/lib64/libdrm.so.2
#1  0x00007ffff2f181e3 in _cogl_context_get_gl_extensions (context=0x75b020) at ./cogl-context.c:679
#2  0x00007ffff2f090d8 in _cogl_driver_update_features (ctx=0x75b020, error=0x7fffffffd808) at ./driver/gl/gl/cogl-driver-gl.c:380
#3  0x00007ffff2f18072 in _cogl_context_update_features (context=0x75b020, error=0x7fffffffd808) at ./cogl-context.c:627
#4  0x00007ffff2f73abb in update_winsys_features (context=0x75b020, error=0x7fffffffd808) at ./winsys/cogl-winsys-glx.c:688
#5  0x00007ffff2f74a10 in _cogl_winsys_context_init (context=0x75b020, error=0x7fffffffd808) at ./winsys/cogl-winsys-glx.c:1099
#6  0x00007ffff2f170d8 in cogl_context_new (display=0x6ad840, error=0x7fffffffd808) at ./cogl-context.c:220
#7  0x00007ffff342787a in clutter_backend_real_create_context (backend=0x6ac0a0, error=0x7fffffffda68) at ./clutter-backend.c:344
#8  0x00007ffff342847c in _clutter_backend_create_context (backend=0x6ac0a0, error=0x7fffffffda68) at ./clutter-backend.c:751
#9  0x00007ffff3447c0d in _clutter_feature_init (error=0x7fffffffda68) at ./clutter-feature.c:107
#10 0x00007ffff345f9f3 in clutter_init_real (error=0x7fffffffda68) at ./clutter-main.c:1630
#11 0x00007ffff345fe31 in post_parse_hook (context=0x6aeb30, group=0x6aecd0, data=0x0, error=0x7fffffffda68) at ./clutter-main.c:1841
#12 0x00007fffef96e567 in g_option_context_parse () from /usr/lib64/libglib-2.0.so.0
#13 0x00007ffff346011b in clutter_parse_args (argc=0x7fffffffdb14, argv=0x7fffffffdb08, error=0x7fffffffdab8) at ./clutter-main.c:2077
#14 0x00007ffff34601ad in clutter_init (argc=0x7fffffffdb14, argv=0x7fffffffdb08) at ./clutter-main.c:2139
#15 0x00007ffff3987e6b in gtk_clutter_init (argc=0x7fffffffdb14, argv=0x7fffffffdb08) at ./gtk-clutter-util.c:210
#16 0x00007ffff76808a9 in AP_UnixApp::main (szAppName=0x400834 "abiword", argc=1, argv=0x7fffffffdd28) at ap_UnixApp.cpp:1301
#17 0x000000000040078e in main (argc=1, argv=0x7fffffffdd28) at ../src/wp/main/gtk/UnixMain.cpp:30




Comment 1


Toni Ballesta





          2014-01-31 00:32:41 UTC
        

INFO:

Portage 2.2.7 (default/linux/amd64/13.0, gcc-4.7.3, glibc-2.17, 3.10.27-gentoo x86_64)
=================================================================
System uname: Linux-3.10.27-gentoo-x86_64-AMD_Phenom-tm-_II_X6_1090T_Processor-with-gentoo-2.2
KiB Mem:     4054188 total,   3023816 free
KiB Swap:    2097148 total,   2097148 free
Timestamp of tree: Tue, 21 Jan 2014 11:45:01 +0000
ld GNU ld (GNU Binutils) 2.23.2
distcc[3977] (dcc_mkdir) ERROR: mkdir '/var/tmp/portage/.distcc/state' failed: No such file or directory [disabled]
ccache version 3.1.9 [disabled]
app-shells/bash:          4.2_p45
dev-java/java-config:     2.1.12-r1
dev-lang/python:          2.7.5-r3, 3.3.3
dev-util/ccache:          3.1.9-r3
dev-util/cmake:           2.8.11.2
dev-util/pkgconfig:       0.28
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.12.4
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.9.6-r3, 1.10.3, 1.11.6, 1.12.6, 1.13.4
sys-devel/binutils:       2.23.2
sys-devel/gcc:            4.7.3-r1
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.9 (virtual/os-headers)
sys-libs/glibc:           2.17
Repositories: gentoo x-portage
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=amdfam10 -O3 -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=amdfam10 -O3 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="ftp://ftp.free.fr/mirrors/ftp.gentoo.org/ http://91.121.125.139/gentoo-distfiles/ http://gentoo.mirror.dkm.cz/pub/gentoo/"
LANG="es_ES.UTF-8"
LC_ALL="es_ES.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j8"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.fr.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac aacplus aalib acl acpi ads aiglx alac alsa amd64 apache2 apng audacious automount berkdb bzip2 cairo caps cdda cddax cddb cdr cgi cli cracklib crypt cups curl cxx dbus declarative device-mapper directfb dri dvb dvd dvdr encode examples exif extras faac fbcon ffmpeg flac fortran freerdp ftp fuse gbm gd gdbm geoip gif gnutls gphoto2 gpm gtk gudev hddtemp hwdb iconv id3tag ipv6 jpeg jpeg2k kdrive kerberos krb5 lame ldap libcanberra libmad libnotify libsamplerate lm_sensors lua lzma lzo mad matroska md5sum mdnsresponder-compat midi mikmod minizip mjpeg mmx mmxext mng mod modplug modules mp3 mp4 mpeg mplayer multilib mysql ncurses nls nptl nsplugin ntfs odbc ogg oggvorbis openal opengl openmp openvg pam pango pcre pdf php php5 png postgres postgresql ppds python qt3support quicktime quota rdesktop rdp readline reiserfs samba scanner scsi sdl sensord server session shout slp sndfile snmp soap sqlite sse sse2 ssh ssl static-libs subtitles svg syslog system-libvncserver tcl tcpd theora threads thunar tidy tiff timidity tk toolbar truetype udev udisks unicode usb v4l v4l2 vboxwebsrv vcd vcdinfo vcdx virtualbox vnc vorbis wavpack winbind wma x264 xcomposite xend xinerama xml xmlreader xmlwriter xrandr xsl xvid zip zlib" ABI_X86="64" ALSA_CARDS="emu10k1 ice1712" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="panasonic" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" GRUB_PLATFORMS="efi-32 efi-64" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer pdfimport" LINGUAS="es es_ES ca ca_ES" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-5" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_3" QEMU_SOFTMMU_TARGETS="*" QEMU_USER_TARGETS="*" RUBY_TARGETS="ruby19 ruby18" SANE_BACKENDS="epson epson2" USERLAND="GNU" VIDEO_CARDS="nvidia fbdev nv nouveau" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON




Comment 2


Toni Ballesta





          2014-01-31 00:34:48 UTC
        

USE variable applied:
+calendar
+collab
+cups
+debug
-eds
+goffice
-grammar
+introspection
+latex
+map
+math
+ots
+plugins
+readline
+redland
-spell
-thesaurus
-wmf
-wordperfect




Comment 3


Pacho Ramos






          2014-02-01 08:55:04 UTC
        

Please provide a backtrace when libdrm is compiled with debugging symbols too. Also, I am unsure if using -O3 as you are doing is safe enough :/




Comment 4


Toni Ballesta





          2014-02-01 15:00:13 UTC
        

Yes, the curious is that the libdrm is compiled with symbols and -O0 like the rest, including abiword...

-O3 is for use with clang, not showed on emerge --info. For debug, I force to -O0.




Comment 5


Toni Ballesta





          2014-02-01 15:01:25 UTC
        

libdrm:

x11-libs/libdrm-2.4.46 was built with the following:
USE="static-libs -libkms" VIDEO_CARDS="nouveau -exynos -freedreno -intel -omap -radeon -vmware"
CFLAGS="-march=amdfam10 -O0 -pipe -ggdb"
CXXFLAGS="-march=amdfam10 -O0 -pipe -ggdb"




Comment 6


Pacho Ramos






          2014-02-01 17:42:09 UTC
        

I would report to upstream -> bugzilla.gnome.org (component "clutter"), also, upstream bugzilla will find any duplicated/similar backtrace that could have been reported already




Comment 7


Toni Ballesta





          2014-02-03 12:31:48 UTC
        

Solved compiling media-libs/mesa with gcc. Before this, I've compiled with clang 3.4/3.3. Then, the bug is for mesa?

===============
DEBUG: AP_SemanticItemFactoryGTK()
DEBUG: ZZZZZZZZZZZZZZZZZZZZZZZaaaaaaaaaaaaaaAbiSuite Home |/usr/share/abiword-3.0|
DEBUG: SEVIOR: Building menus and toolbars 
DEBUG: Created LayoutFontMap 0x1554150 Layout Context 0x155ba40 resolution 1440 device resolution 96
(...)
===============

Other applications cause segmentation faults on libgl (mesa) directly, like games-action/btanks, only when mesa is compiled with clang.




Comment 8


Gilles Dartiguelongue (RETIRED)






          2014-02-03 14:48:32 UTC
        

Please note that compiling with -O0 is just as bad as compiling with -O3.
On one side you will prevent the code for doing simple optimizations like removing dead code that some libs rely on, on the other you force it to apply not always safe transformations.

In both cases you may end up with broken packages.

The recommended setting of -O2 is what is used, even for debugging, by Gnome upstream and that is what is also recommended for Gentoo.

You are free to use other settings but it will generally not be supported.




Comment 9


Toni Ballesta





          2014-02-03 15:26:41 UTC
        

Yes Gilles. I compile with O0 only for debug. With clang, result in segfault for this tools/games using -O3, -O2 and -Os on mesa.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

