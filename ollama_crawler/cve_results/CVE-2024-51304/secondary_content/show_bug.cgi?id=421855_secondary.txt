Title: 421855 – net-misc/unison-2.45.4 - archive format has changed
URL: https://bugs.gentoo.org/show_bug.cgi?id=421855

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 421855
net-misc/unison-2.45.4 - archive format has changed
Last modified: 2016-05-06 10:12:07 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 421855 
      - net-misc/unison-2.45.4 - archive format has changed


Summary:
net-misc/unison-2.45.4 - archive format has changed
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Team for the ML programming language family








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-06-18 21:14 UTC by Juergen Rose





      Modified:
    
2016-05-06 10:12 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Juergen Rose





          2012-06-18 21:14:32 UTC
        

After upgrade the old archive files are not recognized, I get Fatal error, if I try to sync:

Warning: inconsistent state.  
The archive file is missing on some hosts.
For safety, the remaining copies should be deleted.
  Archive ar0b683dcf8986d5dceb9d0d98edc7e2e5 on host lynx should be DELETED
  Archive ardddb6096ff9651acfdb8ffd1ed1a61f0 on host lynx is MISSING
Please delete archive files as appropriate and try again

Deleting old archives works, but then the history of syncing ist lost. Is this a bug or a feature?




Comment 1


Benda Xu






          2012-06-20 21:52:40 UTC
        

It is documented in the upstream release note,

http://tech.groups.yahoo.com/group/unison-announce/message/55


to quote,

* Ignore one-second differences when synchronizing modification
time. (Technically, this is an incompatible archive format change,
but it is backward compatible. To trigger a problem, a user would
have to synchronize modification times on a filesystem with a
two-second granularity and then downgrade to a previous version of
Unison, which does not work well in such a case. Thus, it does not
seem worthwhile to increment the archive format number, which
would impact all users.)

is this what you need?




Comment 2


Juergen Rose





          2012-06-21 14:19:03 UTC
        

I don't know, what should I do. I have "lynx" and "condor" unison-2.45
selected. I try to synchronize from lynx with Multimedia_condor.prf

Unison says:

Warning: inconsistent state.  
The archive file is missing on some hosts.
For safety, the remaining copies should be deleted.
  Archive ar205571af182abaeea21e63837d070763 on host lynx should be DELETED
  Archive ar9be7480edb7c3d06edbb8824bb1bd546 on host lynx is MISSING

I have at lynx ar205571af182abaeea21e63837d070763 and not ar9be7480edb7c3d06edbb8824bb1bd546:

rose@lynx:/home/rose(5)$ ll .unison/ardd*
-rw------- 1 rose rose 1122978 11. Feb 2011  .unison/arddadfac2331f67e07fecd2c289251526
rose@lynx:/home/rose(6)$ ll .unison/ar2055*
-rw------- 1 rose rose 395419 10. Jun 18:40 .unison/ar205571af182abaeea21e63837d070763

If I delete ar205571af182abaeea21e63837d070763, the synchronization history is lost.


I switch on "lynx" and "condor" back to unison-2.40. Now I can succesfully synchronize with the profile Multimedia_condor.prf.


I switch on "lynx" and "condor" again to unison-2.45 and the synchronisation fails again exactly with the old error.




Comment 3


Benda Xu






          2012-06-21 17:22:12 UTC
        

Hi, Juergen,

The bottom line is, unison-2.45 breaks the archive compatibility intentionally, and is in beta. 

You can just use unison-2.40 if you do not care about the new features in 2.45. It's perfectly OK.




Comment 4


Juergen Rose





          2012-06-21 18:01:24 UTC
        

unison-2.45 is the default for ~amd64, ~x86 and ~ppc systems and 'emerge -p --depclean' wants to delete unison-2.40.65. Would it not be good to have an converter, which converts the old into the new archive format?

Elsewise I have to mask >unison-2.40.




Comment 5


Benda Xu






          2012-06-25 09:13:06 UTC
        

Hi, Juergen,

To prevent unison:2.40 to be unmerged upon depclean, you can add net-misc/unison:2.40 in to your portage world file (/var/lib/portage/world) manually.

Benda









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

