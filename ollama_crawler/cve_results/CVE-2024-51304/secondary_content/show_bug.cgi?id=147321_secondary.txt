Title: 147321 – kdepim-kioslaves-3.5.4 requires openssl-0.9.7
URL: https://bugs.gentoo.org/show_bug.cgi?id=147321

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 147321
kdepim-kioslaves-3.5.4 requires openssl-0.9.7
Last modified: 2006-09-15 03:15:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 147321 
      - kdepim-kioslaves-3.5.4 requires openssl-0.9.7


Summary:
kdepim-kioslaves-3.5.4 requires openssl-0.9.7
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-09-12 07:05 UTC by Nils Ohlmeier





      Modified:
    
2006-09-15 03:15 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



gentoo+bugs









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Nils Ohlmeier





          2006-09-12 07:05:53 UTC
        

When I try to follow the intructions on openssl-0.9.8* to remove the 0.9.7 libs (run revdep-rebuild with libssl and libcrypto and afterwards remove the 0.9.7 libs) then my kio_imap4 processes are segfaulting.

I'm using IMAP over secured connections.
A 'revdep-rebuild --library libssl.so.0.9.7 -p' run without any arguments shows the following:

Calculating dependencies... done!
[ebuild   R   ] app-emulation/emul-linux-x86-baselibs-2.5.2

I assume this is unrelated to the problem.

But if I do the following command on a running kio_imap4 process (note: with the openssl 0.9.7 libs still in place):

grep ssl /proc/14837/maps
3061a00000-3061a31000 r-xp 00000000 08:06 40021                          /usr/lib64/libssl.so.0.9.7
3061a31000-3061b30000 ---p 00031000 08:06 40021                          /usr/lib64/libssl.so.0.9.7
3061b30000-3061b35000 rw-p 00030000 08:06 40021                          /usr/lib64/libssl.so.0.9.7
3470200000-347023f000 r-xp 00000000 08:06 1147420                        /usr/lib64/libssl.so.0.9.8
347023f000-347033f000 ---p 0003f000 08:06 1147420                        /usr/lib64/libssl.so.0.9.8
347033f000-3470345000 rw-p 0003f000 08:06 1147420                        /usr/lib64/libssl.so.0.9.8

So somehow kio_imap4 uses both the old 0.9.7 and the new 0.9.8 openssl libs. Thus if I remove the old libs it crashes.

One more note: on my 32bit system I was able to remove the 0.9.7 libs without having a problem afterwards.

Any input on how to debug this problem futher is appreciated.

emerge --info
Portage 2.1.1 (default-linux/amd64/2006.1, gcc-4.1.1, glibc-2.4-r3, 2.6.17-gentoo-r5 x86_64)
=================================================================
System uname: 2.6.17-gentoo-r5 x86_64 Intel(R) Xeon(TM) CPU 2.80GHz
Gentoo Base System version 1.12.4
Last Sync: Tue, 12 Sep 2006 06:50:01 +0000
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
ccache version 2.4 [disabled]
app-admin/eselect-compiler: [Not Present]
dev-lang/python:     2.2.3-r6, 2.3.5-r2, 2.4.3-r3
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r2
dev-util/confcache:  0.4.2-r1
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.17
sys-devel/gcc-config: 2.0.0_rc1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.16
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=nocona -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib64/mozilla/defaults/pref /usr/share/X11/xkb /usr/share/config /var/bind"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O2 -march=nocona -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distcc distlocks fixpackages metadata-transfer parallel-fetch sandbox sfperms strict"
GENTOO_MIRRORS="http://mirrors.sec.informatik.tu-darmstadt.de/gentoo/ http://gentoo.ITDNet.net/gentoo http://ftp.du.se/pub/os/gentoo"
LINGUAS="en en_GB de"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.de.gentoo.org/gentoo-portage"
USE="amd64 X509 aalib aim apache2 arts artswrappersuid bash-completion berkdb bitmap-fonts bonjour bzip2 cdr cli cpudetection crosscompile crypt cscope ctype cups curl cvs dga dlloader dri dvd dvdr dvdread elibc_glibc emul-linux-x86 expat fat ffmpeg firefox flac fortran gaim gdbm gnutls gphoto2 gpm gvim gzip hddtemp icq ident ieee1394 imagemagick imap imlib2 innodb input_devices_keyboard input_devices_mouse ipod iproute2 ipsec ipv6 jpeg2k kdepim kernel_linux libg++ linguas_de linguas_en linguas_en_GB lm_sensors logitech-mouse mad maildir mime mjpeg mmx mozilla mplayer mysql ncurses nis nls nptl nptlonly nsplugin nvidia ogg oggvorbis openexr oscar pam pcre pdf perl pic ppds pppd python rdesktop readline reflection reiser4 reiserfs rrdtool samba sasl scanner session slp smime speex spl sqlite sse sse2 ssl subversion svg svgz tcltk tcpd tetex truetype truetype-fonts type1 type1-fonts udev unicode unzip userland_GNU vcd vfat video_cards_fbdev video_cards_nv video_cards_nvidia video_cards_vesa video_cards_vga vim vim-pager vim-with-x vorbis wmf xcomposite xine xml xml2 xmlrpc xmms xorg xscreensaver yahoo zeroconf zip zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Jakub Moc (RETIRED)






          2006-09-12 08:23:50 UTC
        

Tried to re-emerge kdelibs?





Comment 2


Nils Ohlmeier





          2006-09-12 09:37:25 UTC
        

I just re-emerged kdelibs and afterwards kdepim-kioslaves. No change. kio_imap4 still uses both versions of openssl.




Comment 3


Jakub Moc (RETIRED)






          2006-09-12 14:01:37 UTC
        

Well, this is dupe of Bug 41495, good luck hunting which one needs to be rebuilt first.




Comment 4


Nils Ohlmeier





          2006-09-12 15:14:30 UTC
        

I guess it might be related. But in fact I think my problem breaks up into two problems:
- kio_imap4 gets broken as soon as I remove the 0.9.7 openssl libs (allthough it is already compiled against the 0.9.8 version)
- why does revdep-rebuild does not detect this problem? I guess this is related to the fact that ldd does not show libssl as a required lib for kio_imap4. But the maps file in the proc filesystem shows that kio_imap4 in fact loads this lib. So where is this libssl dependency coming from? If this question is answer maybe there would be a chance to teach this revdep-rebuild for the future.




Comment 5


Harm Geerts





          2006-09-13 06:48:21 UTC
        

I've had the same problem on my system but gave up after a few rebuilds.
Then I found this bug and started digging again, and to my suprise imap4-ssl is working again.

Looking back at my emerge history I think it might be kde-base/libkmime that caused this (even though this does not link to libssl).

So to save some time you might want to try this first.
emerge --oneshot kde-base/libkmime kde-base/kdepim-kioslaves

And if that doesn't work, here is my kde emerge history since I emerge openssl-0.9.8 ;)

     Sat Sep  2 22:44:56 2006 >>> kde-base/kcontrol-3.5.4
     Sun Sep  3 00:06:40 2006 >>> kde-base/kdesdk-3.5.4
     Sun Sep  3 17:08:53 2006 >>> kde-base/kdepim-kioslaves-3.5.4
     Sun Sep  3 19:12:20 2006 >>> kde-base/kmail-3.5.4-r1
     Sun Sep  3 19:29:31 2006 >>> kde-base/kdepim-kioslaves-3.5.4
     Sun Sep  3 20:34:07 2006 >>> kde-base/kdelibs-3.5.4-r1
     Sun Sep  3 20:36:10 2006 >>> kde-base/kdeaddons-kfile-plugins-3.5.0
     Sun Sep  3 20:49:33 2006 >>> kde-base/kde-env-3-r4
     Sun Sep  3 20:58:43 2006 >>> kde-base/kdialog-3.5.4
     Sun Sep  3 22:09:33 2006 >>> kde-base/kdebase-kioslaves-3.5.4
     Sun Sep  3 22:11:07 2006 >>> kde-base/kmailcvt-3.5.1
     Sun Sep  3 22:13:56 2006 >>> kde-base/khotkeys-3.5.4
     Sun Sep  3 22:16:32 2006 >>> kde-base/kdebase-data-3.5.4
     Sun Sep  3 22:18:12 2006 >>> kde-base/libkonq-3.5.4
     Sun Sep  3 22:26:38 2006 >>> kde-base/kicker-3.5.4
     Sun Sep  3 22:28:03 2006 >>> kde-base/kdesu-3.5.3
     Sun Sep  3 22:29:53 2006 >>> kde-base/kcminit-3.5.3
     Sun Sep  3 22:31:13 2006 >>> kde-base/ktnef-3.5.4
     Sun Sep  3 22:33:49 2006 >>> kde-base/libkcal-3.5.4
     Sun Sep  3 22:36:07 2006 >>> kde-base/libkdepim-3.5.4
     Sun Sep  3 22:37:16 2006 >>> kde-base/libkpgp-3.5.4
     Sun Sep  3 22:38:36 2006 >>> kde-base/libkdenetwork-3.5.4
     Sun Sep  3 22:40:55 2006 >>> kde-base/certmanager-3.5.4
     Sun Sep  3 22:42:24 2006 >>> kde-base/libkpimidentities-3.5.4
     Sun Sep  3 22:43:38 2006 >>> kde-base/libkmime-3.5.3
     Sun Sep  3 22:45:03 2006 >>> kde-base/kdepim-kioslaves-3.5.4
     Sun Sep  3 22:46:12 2006 >>> kde-base/mimelib-3.5.4
     Sun Sep  3 22:50:45 2006 >>> kde-base/kontact-3.5.4
     Sun Sep  3 23:04:12 2006 >>> kde-base/libksieve-3.5.0
     Sun Sep  3 23:40:52 2006 >>> kde-base/kdepim-kioslaves-3.5.4
     Sun Sep  3 23:51:30 2006 >>> kde-base/kmail-3.5.4-r1





Comment 6


Harm Geerts





          2006-09-14 11:10:18 UTC
        

I usually leave my computer running so kde doesn't restart that often.
Is it possible the kioslave used the old kdelibs that was linked to openssl-0.9.7 and loaded in memory?
In that case a simple kde restart should fix this problem.




Comment 7


Nils Ohlmeier





          2006-09-14 11:36:10 UTC
        

Thanks for the list. Unfortunately it was no help, because meanwhile I re-compiled all the packages from the list too. But kio_imap4 still uses the 0.9.7 libs.
In my case it also a workstation which runs 24h a day. But to be safe about this problem I always closed kmail, killed the kio_imap4 processes and then restarted kmail (and then checked again).
Tomorrow I'll try to log out from KDE and log in. If that does not help I will recompile all packages which contain files which are loaded into the memory of my kio_imap4 processes. Hopefully that will help finally. Otherwise I'm running out of ideas...




Comment 8


Nils Ohlmeier





          2006-09-15 03:15:16 UTC
        

Ok, logging out from and start a fresh KDE session by logging in again finally solved the problem.
Thanks Harm for time and help.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

