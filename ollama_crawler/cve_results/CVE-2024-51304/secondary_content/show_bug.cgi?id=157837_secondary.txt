Title: 157837 – x11-misc/xkeyboard-config-0.9 breaks VT switching
URL: https://bugs.gentoo.org/show_bug.cgi?id=157837

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 157837
x11-misc/xkeyboard-config-0.9 breaks VT switching
Last modified: 2008-03-18 14:39:50 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 157837 
      - x11-misc/xkeyboard-config-0.9 breaks VT switching


Summary:
x11-misc/xkeyboard-config-0.9 breaks VT switching
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-12-11 08:09 UTC by Honza Macháček





      Modified:
    
2008-03-18 14:39 UTC
      (History)
    




          CC List:
        

6 
          users
          
            (show)
          



algardas
cam
jakub
ondrej
ps
stuart









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




revert_bz8572.diff

              (revert_bz8572.diff,1.79 KB,
                patch)

            
2006-12-12 14:31 UTC,

            Joshua Baergen (RETIRED)




Details
            | Diff





xkeyboard-config-1.1.ebuild-r1.diff

              (xkeyboard-config-1.1.ebuild.patch,405 bytes,
                patch)

            
2007-10-07 18:10 UTC,

            Honza Macháček




Details
            | Diff





xkeyboard-config-1.1-VTswitch.patch

              (xkeyboard-config-1.1-VTswitch.patch,421 bytes,
                patch)

            
2007-10-07 18:12 UTC,

            Honza Macháček




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Honza Macháček





          2006-12-11 08:09:53 UTC
        

Ctrl-Alt-Fn VT switching works with x11-misc/xkeyboard-config-0.8-r1, as well as with x11-misc/xkbdata, but not with x11-misc/xkeyboard-config-0.9.
Found and solved already in Debian http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=392911 -- ``debian/patches/revert_bz8572.diff: New patch to revert changes introduced in BZ8572, they cause trouble with Ctrl-Alt-F* combinations.''




Comment 1


Jakub Moc (RETIRED)






          2006-12-11 14:13:45 UTC
        

Also breaks Alt+arrow windows switching in irssi and bunch of other stuff. This version is heavily broken :/





Comment 2


Joshua Baergen (RETIRED)






          2006-12-11 14:45:47 UTC
        

(In reply to comment #1)
> Also breaks Alt+arrow windows switching in irssi and bunch of other stuff. This
> version is heavily broken :/
> 

Care to elaborate?  I haven't run into any serious issues - it's likely layout-dependent.




Comment 3


Honza Macháček





          2006-12-12 12:31:07 UTC
        

(In reply to comment #2)
> 
> Care to elaborate?  I haven't run into any serious issues - it's likely
> layout-dependent.

  Looks like one layout works, two layouts fail.
  I use layouts us and cz as switchable. VT switching fails. 'setxkbmap us' turns VT switching on. 'setxkbmap cz' does the same. 'setxkbmap "us,us" -variant ",intl"' turns VT switching off. 

  Haven't tried the Debian patch yet.




Comment 4


Jakub Moc (RETIRED)






          2006-12-12 12:41:44 UTC
        

(In reply to comment #2)
> Care to elaborate?  I haven't run into any serious issues - it's likely
> layout-dependent.

Section "InputDevice"
    Identifier	"Logitech Internet Keyboard"
    Driver	"kbd"
    Option "AutoRepeat" "500 30"
    Option "XkbRules"	"xorg"
    Option "XkbModel"	"logiik"
    Option "XkbLayout"	"us,cz"
    Option "XkbVariant" ",qwerty"
    Option "XkbOptions"	"grp:alt_shift_toggle,grp_led:scroll,caps:shift_nocancel"
EndSection

0.9 - broken LAlt+arrow; downgrade to 0.8 -> everything works (with standard US layout, see above). Basically, left alt key becomes completely useless w/ 0.9; right alt works.





Comment 5


Joshua Baergen (RETIRED)






          2006-12-12 14:31:40 UTC
        

Created attachment 103892 [details, diff]
revert_bz8572.diff

Here's the patch from the Debian bug.  Please apply it and see if it fixes any of your issues.  While I expect it may fix the VT switch issue, I'm not so optimistic about the left alt key.




Comment 6


Jakub Moc (RETIRED)






          2007-05-29 20:53:34 UTC
        

(In reply to comment #5)
> While I expect it may fix the VT switch issue, I'm not so
> optimistic about the left alt key.

Yeah, doesn't fix LAlt indeed...






Comment 7


Matthias Schwarzott






          2007-10-01 09:22:30 UTC
        

For me it was also broken. And I guess it was because of the missing symlink /usr/share/X11/xkb/compiled. xkbdata creates it and it works. Installing xkeyboard-config and creating the symlink by hand also works:

Please add this to src_install:
# dosym ../../../../var/lib/xkb /usr/share/X11/xkb/compiled





Comment 8


Jakub Moc (RETIRED)






          2007-10-01 09:31:24 UTC
        

(In reply to comment #7)
Hmm, that's just weird. No idea how did the symlink went missing for you.

# readlink /usr/share/X11/xkb/compiled
/var/lib/xkb

$ qfile /usr/share/X11/xkb/compiled
x11-base/xorg-server (/usr/share/X11/xkb/compiled)
x11-misc/xkeyboard-config (/usr/share/X11/xkb/compiled)

BTW, you mean the VT issue, or the left Alt key, or both?





Comment 9


Honza Macháček





          2007-10-07 18:10:47 UTC
        

Created attachment 132846 [details, diff]
xkeyboard-config-1.1.ebuild-r1.diff

This patch changes xkeyboard-config-1.1.ebuild to apply a small patch enabling VT swiching.




Comment 10


Honza Macháček





          2007-10-07 18:12:41 UTC
        

Created attachment 132847 [details, diff]
xkeyboard-config-1.1-VTswitch.patch

Patch for xkeyboard-config-1.1 to enable VT switching. Changes handling of LAlt, so LAlt problem may be solved too (untested).




Comment 11


Donnie Berkholz (RETIRED)






          2007-10-07 18:57:16 UTC
        

Is that patch applied upstream? Is there an upstream bug open on bugs.freedesktop.org?





Comment 12


Algardas Pelakauskas





          2007-10-08 22:06:40 UTC
        

Both, LALT and VT switching works with the patch by Honza Macháček.

How come  x11-misc/xkeyboard-config-0.9 has been stabilized with this bug still open?




Comment 13


Honza Macháček





          2007-10-10 19:04:24 UTC
        

(In reply to comment #11)
> Is that patch applied upstream? Is there an upstream bug open on
> bugs.freedesktop.org?

Finally I've overcome my laziness and filed https://bugs.freedesktop.org/show_bug.cgi?id=12775




Comment 14


pavel sanda





          2007-11-02 21:04:45 UTC
        

i spent half of the day hunting why switching between keyboard layouts does not 
work and borkage console switching. 

its bit frustrating to spent time on already solved bug, which is not properly 
handled by masking in portage tree.

wouldnt be better idea to unmask 1.1 or mask 0.9 ?




Comment 15


Donnie Berkholz (RETIRED)






          2007-11-02 21:52:37 UTC
        

Yeah we're probably going to stabilize 1.1 in conjunction with xorg-server 1.3-r2.




Comment 16


Jakub Moc (RETIRED)






          2007-11-02 21:56:17 UTC
        

(In reply to comment #14)
> wouldnt be better idea to unmask 1.1 or mask 0.9 ?

Well I'm not sure how's 1.1 stabilization relevant here - simply because it's exact same broken wrt the issues mentioned here as Comment #10 suggests (not to mention other 1.1 borkage reported on other bugs).





Comment 17


pavel sanda





          2007-11-02 22:11:54 UTC
        

(In reply to comment #16)
> Well I'm not sure how's 1.1 stabilization relevant here - simply because it's
> exact same broken wrt the issues mentioned here as Comment #10 suggests (not to
> mention other 1.1 borkage reported on other bugs).

just for the record - the current 1.1 in portage solved my problem. that of course
doesnt say anything about other bugs reported on 1.1.





Comment 18


Donnie Berkholz (RETIRED)






          2007-11-02 22:20:48 UTC
        

There's always bugs on this stuff, every version, so we just kinda have to keep stabilizing anyway.




Comment 19


Jakub Moc (RETIRED)






          2008-02-02 01:03:47 UTC
        

As noted on https://bugs.freedesktop.org/show_bug.cgi?id=12775#c8; can't reproduce any more, nor can the reporter. Closing this.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

