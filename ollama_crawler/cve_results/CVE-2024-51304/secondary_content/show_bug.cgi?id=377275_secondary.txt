Title: 377275 – app-emulation/xen[-tools]-4.1.1: switch back from xl to xm
URL: https://bugs.gentoo.org/show_bug.cgi?id=377275

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 377275
app-emulation/xen[-tools]-4.1.1: switch back from xl to xm
Last modified: 2011-09-08 06:47:06 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 377275 
      - app-emulation/xen[-tools]-4.1.1: switch back from xl to xm


Summary:
app-emulation/xen[-tools]-4.1.1: switch back from xl to xm
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Xen Devs








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-08-01 12:37 UTC by Sven





      Modified:
    
2011-09-08 06:47 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:


365453

380343





Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Sven





          2011-08-01 12:37:15 UTC
        

Hi,

so here's a clear mistake from the /etc/init.d/xend script:
it says "xl shutdown --all --wait". This command is not supported. xl complain that the options "-", "a", "l", etc. are not supported. "xm shutdown --all --wait" works fine though. Shutting down the domain before a reboot is pretty essential.

Seconds, the /etc/init.d/xendomains script swicthed from xm to xl. xl can't start my domains while xm works just fine.

My config file is as simple as this.
kernel = "/usr/src/linux-domU/_domU/vmlinux"
memory = 2048
vcpus = 8

root = "/dev/xvda1"
extra = "ro"

disk = [
        "phy:md2,xvda1,w",
        "phy:md5,xvda2,w",
]
vif = [
        "bridge=xenbr0,mac=00:16:3E:00:00:01",
        "bridge=xenbr1,mac=00:16:3E:00:01:01",
]

So first xl complains that it cannot stat md2, then I change md2 to /dev/md2 and it can apperently stat that, might another error pops up. xm works just fine with the very same config file.

I don't think xl is ready yet. I should probably mention those errors on the xen list. But first I'd like to switch back from the kind of problematic xl to a more solid xm based script.

Reproducible: Always




Comment 1


Sven





          2011-08-02 13:06:01 UTC
        

(repost of original comment, but with most language mistakes fixed)

So here's a clear mistake from the /etc/init.d/xend script:
It uses the command "xl shutdown --all --wait". This command is not supported. xl complains that the options "-", "a", "l", etc. are not supported. "xm shutdown --all --wait" works fine though. Shutting down the domain before a reboot is pretty essential.

Second, the /etc/init.d/xendomains script swiched from xm to xl. But xl can't
start any of my domains while xm works just fine. xl seems to have serious troubles with my config files.

My config file is as simple as this:
(see initial comment)

First xl complains that it cannot stat md2. So I changed "phy:md2" to "phy:/dev/md2" and xl can apperently stat that. However, now xl was returning another error. xm works just fine with the very same config file.

I don't think that xl is ready yet. I should probably report those errors on the
xen mailing list. But I'd like to see init.d scripts based on the more solid xm instead of the problematic xl.




Comment 2


Ian Delaney (RETIRED)






          2011-08-06 21:36:13 UTC
        

as far as I can tell the init scripts are installed & replaced by the source package.  That is by all appearances an upstream issue, not a local one




Comment 3


Sven





          2011-08-06 22:15:47 UTC
        

(In reply to comment #2)
> as far as I can tell the init scripts are installed & replaced by the source
> package.  That is by all appearances an upstream issue, not a local one

The init.d scripts are gentoo specific:
http://sources.gentoo.org/cgi-bin/viewvc.cgi/gentoo-x86/app-emulation/xen-tools/files/




Comment 4


Ian Delaney (RETIRED)






          2011-09-07 19:13:22 UTC
        

But xl can't
start any of my domains while xm works just fine. xl seems to have serious
troubles with my config files.

I just figure it out.  And it wasn't easy since xl appears to have no documentation.

Here is the culprit

/etc/xen/xl.conf

It has 3 settings, all of which by default are commented out.
The plan is to rewrite the scripts towards fitting xl, not reverting to xm. 

UNCOMMENT THE SETTINGS AND TRY AGAIN.




Comment 5


Sven





          2011-09-07 19:24:28 UTC
        

"xl shutdown --all --wait" doesn't work, no matter whether the settings in /etc/xen/xl.conf are commented or not.

You shouldn't close this bug unless the init script has been fixed. (I'm afraid, xl doesn't support anything similar to xm shutdown --all --wait yet.)


xl cannot handle the config file I posted in the initial comment (cannot stat md2) no matter whether the settings in /etc/xen/xl.conf are commented or not. I'd really love to know how to resolve that. I will ask on the xen mailing lists, why that is failing. I will report back, whether this is a bug in xl or not. (However, not sure why you want to continue moving towards buggy xl instead of keeping stable xm).




Comment 6


Sven





          2011-09-07 19:27:32 UTC
        

Didn't notice the links to the other bugs report. Will close this bug again.




Comment 7


Ian Delaney (RETIRED)






          2011-09-08 06:47:06 UTC
        

sven;

perhaps I rushed closing it, but today I now re-write the init scripts.  I only added the links yesterday .

However, not sure why you want to continue moving towards buggy xl
instead of keeping stable xm.

Decision made by one higher, mainly looking to the future seeing xl to superceede xm.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

