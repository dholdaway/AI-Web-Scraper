Title: 247826 – media-video/mpeg4ip-1.5.0.1-r1 - mpeg4ip-1.5.0.1-x264.patch fails
URL: https://bugs.gentoo.org/show_bug.cgi?id=247826

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 247826
media-video/mpeg4ip-1.5.0.1-r1 - mpeg4ip-1.5.0.1-x264.patch fails
Last modified: 2008-12-12 05:09:42 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 247826 
      - media-video/mpeg4ip-1.5.0.1-r1 - mpeg4ip-1.5.0.1-x264.patch fails


Summary:
media-video/mpeg4ip-1.5.0.1-r1 - mpeg4ip-1.5.0.1-x264.patch fails
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Olivier Crete (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-11-20 21:10 UTC by noybman





      Modified:
    
2008-12-12 05:09 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




The ebuild environment file

              (bug1.txt,97.05 KB,
                text/plain)

            
2008-11-20 21:23 UTC,

            noybman




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


noybman





          2008-11-20 21:10:17 UTC
        

***** mpeg4ip-1.5.0.1-x264.patch *****
 
======================================
 
PATCH COMMAND:	 patch -p0 -g0 -E --no-backup-if-mismatch < /usr/portage/media-video/mpeg4ip/files/mpeg4ip-1.5.0.1-x264.patch
 
======================================
can't find file to patch at input line 3
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|--- mpeg4ip-1.5.0.1/server/mp4live/video_x264.cpp	2006-05-11 22:23:19.000000000 +0200
|+++ mpeg4ip/server/mp4live/video_x264.cpp	2006-09-29 21:55:42.000000000 +0200
--------------------------
No file to patch.  Skipping patch.
5 out of 5 hunks ignored
can't find file to patch at input line 57
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|--- a/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h.old	2006-11-11 20:56:48.000000000 +0100
|+++ b/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h	2006-11-11 20:57:49.000000000 +0100
--------------------------
No file to patch.  Skipping patch.
1 out of 1 hunk ignored
======================================
 
PATCH COMMAND:	 patch -p1 -g0 -E --no-backup-if-mismatch < /usr/portage/media-video/mpeg4ip/files/mpeg4ip-1.5.0.1-x264.patch
 
======================================
patching file server/mp4live/video_x264.cpp
can't find file to patch at input line 57
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|--- a/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h.old	2006-11-11 20:56:48.000000000 +0100
|+++ b/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h	2006-11-11 20:57:49.000000000 +0100
--------------------------
No file to patch.  Skipping patch.
1 out of 1 hunk ignored
======================================
 
PATCH COMMAND:	 patch -p2 -g0 -E --no-backup-if-mismatch < /usr/portage/media-video/mpeg4ip/files/mpeg4ip-1.5.0.1-x264.patch
 
======================================
can't find file to patch at input line 3
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|--- mpeg4ip-1.5.0.1/server/mp4live/video_x264.cpp	2006-05-11 22:23:19.000000000 +0200
|+++ mpeg4ip/server/mp4live/video_x264.cpp	2006-09-29 21:55:42.000000000 +0200
--------------------------
No file to patch.  Skipping patch.
5 out of 5 hunks ignored
patching file server/mp4live/video_x264.h
======================================
 
PATCH COMMAND:	 patch -p3 -g0 -E --no-backup-if-mismatch < /usr/portage/media-video/mpeg4ip/files/mpeg4ip-1.5.0.1-x264.patch
 
======================================
can't find file to patch at input line 3
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|--- mpeg4ip-1.5.0.1/server/mp4live/video_x264.cpp	2006-05-11 22:23:19.000000000 +0200
|+++ mpeg4ip/server/mp4live/video_x264.cpp	2006-09-29 21:55:42.000000000 +0200
--------------------------
No file to patch.  Skipping patch.
5 out of 5 hunks ignored
can't find file to patch at input line 57
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|--- a/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h.old	2006-11-11 20:56:48.000000000 +0100
|+++ b/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h	2006-11-11 20:57:49.000000000 +0100
--------------------------
No file to patch.  Skipping patch.
1 out of 1 hunk ignored
======================================
 
PATCH COMMAND:	 patch -p4 -g0 -E --no-backup-if-mismatch < /usr/portage/media-video/mpeg4ip/files/mpeg4ip-1.5.0.1-x264.patch
 
======================================
missing header for unified diff at line 3 of patch
can't find file to patch at input line 3
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|--- mpeg4ip-1.5.0.1/server/mp4live/video_x264.cpp	2006-05-11 22:23:19.000000000 +0200
|+++ mpeg4ip/server/mp4live/video_x264.cpp	2006-09-29 21:55:42.000000000 +0200
--------------------------
No file to patch.  Skipping patch.
5 out of 5 hunks ignored
can't find file to patch at input line 57
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
|--- a/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h.old	2006-11-11 20:56:48.000000000 +0100
|+++ b/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h	2006-11-11 20:57:49.000000000 +0100
--------------------------
No file to patch.  Skipping patch.
1 out of 1 hunk ignored

Reproducible: Always

Steps to Reproduce:
1. Emerge mpeg4ip -uvDN

here's "my" use flags atm:
USE="hal 7zip X aac avahi aalib acpi alsa apm automount bash-completion 
     bittorrent calendar catalogs cdaudio cdda cdparanoia cdr cpufreq
     css ctype cxx disk-partition divx     dvd dvdr dvdread esd ffmpeg 
     firefox ftp gd gnome gtk imagemagick id3 ipod java6 javascript jpeg 
     libnotify lm_sensors mbox mmap mmx mp3 mp4live mpeg mpeg2 mplayer 
     nas pcmcia player posix png quicktime radeon rdesktop rss samba 
     sockets svga threads truetype usb wifi win32codecs wmf xvid qt3 dbus"




Comment 1


noybman





          2008-11-20 21:23:13 UTC
        

Created attachment 172561 [details]
The ebuild environment file




Comment 2


nanikata15





          2008-11-24 03:26:54 UTC
        

Got the same error.

x264 patch patches video_x264.h and video_x264.cpp files.
The problem was that paths to each file inside 
the patch are of different depth:

mpeg4ip-1.5.0.1/server/mp4live/video_x264.cpp
mpeg4ip/server/mp4live/video_x264.cpp

and

a/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h.old
b/mpeg4ip-1.5.0.1/server/mp4live/video_x264.h

thus  they require different -p options to patch correctly.

Can be made to emerge correctly by editing paths
inside mpeg4ip-1.5.0.1-x264.patch
(for example removing "a/" and "b/")
Not really sure if it's OK to do this though.

Still, don't think I've had this problem before...
Recently upgraded to portage-2.2-rc15, maybe that's
the reason?







Comment 3


Andrey Korolyov





          2008-11-25 22:17:56 UTC
        

>Can be made to emerge correctly by editing paths
>inside mpeg4ip-1.5.0.1-x264.patch
>(for example removing "a/" and "b/"

Surely no. Simply put a/ and b/ at begin of first two lines then patch will be applied correctly. 




Comment 4


Robert Buchholz (RETIRED)






          2008-11-30 17:37:13 UTC
        

Thanks for the bug report.

+  30 Nov 2008; Robert Buchholz <rbu@gentoo.org>
+  files/mpeg4ip-1.5.0.1-x264.patch:
+  Fix wrong path levels in patch, bug #247826






Comment 5


noybman





          2008-11-30 18:18:15 UTC
        

I tested this just moments ago by re-downloading the package and it still fails (oob)




Comment 6


nanikata15





          2008-12-02 13:28:28 UTC
        

(In reply to comment #5)
> I tested this just moments ago by re-downloading the package and it still fails
> (oob)
> 

Worked fine here, the patch seems to have been fixed properly.
Maybe you should try to sync once more?




Comment 7


Samuli Suominen (RETIRED)






          2008-12-12 05:09:42 UTC
        

This package has moved back to unstable because upstream is gone, try -r6.

>>> Emerging (1 of 1) media-video/mpeg4ip-1.5.0.1-r6
 * mpeg4ip-1.5.0.1.tar.gz RMD160 SHA1 SHA256 size ;-) ...                [ ok ]
 * checking ebuild checksums ;-) ...                                     [ ok ]
 * checking auxfile checksums ;-) ...                                    [ ok ]
 * checking miscfile checksums ;-) ...                                   [ ok ]
>>> Unpacking source...
>>> Unpacking mpeg4ip-1.5.0.1.tar.gz to /var/tmp/portage/media-video/mpeg4ip-1.5.0.1-r6/work
 * Applying mpeg4ip-1.4.1-disable-faac-test.patch ...                     [ ok ]
 * Applying mpeg4ip-1.5.0.1-x264.patch ...                                [ ok ]
 * Applying mpeg4ip-1.5.0.1-newffmpeg.patch ...                           [ ok ]
 * Applying mpeg4ip-1.5.0.1-ffmpeg-headers.patch ...                      [ ok ]
 * Applying mpeg4ip-1.5.0.1-lX11.patch ...                                [ ok ]
 * Applying mpeg4ip-1.5.0.1-as-needed.patch ...                           [ ok ]
 * Applying mpeg4ip-1.5.0.1-gcc42.patch ...                               [ ok ]
 * Applying mpeg4ip-1.5.0.1-nasm-r.patch ...                              [ ok ]
 * Applying mpeg4ip-1.5.0.1-avcodec_extern_c-2.patch ...                  [ ok ]
 * Applying mpeg4ip-1.5.0.1+gcc-4.3.patch ...                             [ ok ]
 * Applying mpeg4ip-1.5.0.1-swscale_and_lavc.patch ...                    [ ok 









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

