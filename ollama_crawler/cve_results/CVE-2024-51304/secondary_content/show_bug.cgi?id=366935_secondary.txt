Title: 366935 – net-analyzer/macchanger-1.5.0-r2 build failure (src/main.c VERSION undefined)
URL: https://bugs.gentoo.org/show_bug.cgi?id=366935

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 366935
net-analyzer/macchanger-1.5.0-r2 build failure (src/main.c VERSION undefined)
Last modified: 2013-12-28 00:41:40 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 366935 
      - net-analyzer/macchanger-1.5.0-r2 build failure (src/main.c VERSION undefined)


Summary:
net-analyzer/macchanger-1.5.0-r2 build failure (src/main.c VERSION undefined)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Robin Johnson








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-05-11 22:51 UTC by Michael Weber (RETIRED)





      Modified:
    
2013-12-28 00:41 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



netmon









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,5.57 KB,
                text/plain)

            
2011-05-11 22:54 UTC,

            Michael Weber (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michael Weber (RETIRED)






          2011-05-11 22:51:33 UTC
        

$subject, build.log & fix follows




Comment 1


Michael Weber (RETIRED)






          2011-05-11 22:54:29 UTC
        

Created attachment 272907 [details]
build.log

Portage 2.1.9.42 (default/linux/amd64/10.0/developer, gcc-4.5.2, libc-0-r0, 2.6.38-gentoo-r5-io.0 x86_64)
=================================================================
System uname: Linux-2.6.38-gentoo-r5-io.0-x86_64-Intel-R-_Core-TM-2_Duo_CPU_T7300_@_2.00GHz-with-gentoo-2.0.2
Timestamp of tree: Unknown
ccache version 2.4 [disabled]
app-shells/bash:     4.1_p9
dev-java/java-config: 2.1.11-r3
dev-lang/python:     2.4.6, 2.5.4-r4, 2.6.6-r2, 2.7.1-r1, 3.1.3-r1, 3.2
dev-util/ccache:     2.4-r9
dev-util/cmake:      2.8.4-r1
sys-apps/baselayout: 2.0.2
sys-apps/openrc:     0.8.2-r1
sys-apps/sandbox:    2.4
sys-devel/autoconf:  2.13, 2.65-r1
sys-devel/automake:  1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.5.2, 4.6.0
sys-devel/gcc-config: 1.4.1-r1
sys-devel/libtool:   2.2.10
sys-devel/make:      3.81-r2
sys-kernel/linux-headers: 2.6.38
sys-libs/glibc:      2.13-r2
virtual/os-headers:  0
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -mcx16 -msahf --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=4096 -mtune=core2 -mfpmath=sse -O2 -pipe -ggdb"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=core2 -mcx16 -msahf --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=4096 -mtune=core2 -mfpmath=sse -O2 -pipe -ggdb"
DISTDIR="/var/cache/distfiles"
FEATURES="assume-digests binpkg-logs collision-protect distlocks fixlafiles fixpackages multilib-strict news parallel-fetch protect-owned sandbox sfperms sign splitdebug strict test-fail-continue unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox"
FFLAGS=""
GENTOO_MIRRORS="http://ftp.uni-erlangen.de/pub/mirrors/gentoo/"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,--hash-style=gnu -Wl,-O1 -Wl,--as-needed"
LINGUAS="de en en_US en_GB"
MAKEOPTS="-j2"
PKGDIR="/var/cache/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /var/lib/xmw-overlay /var/lib/layman/science /var/lib/layman/sunrise /var/lib/layman/java-overlay /var/lib/layman/gnome /var/lib/layman/gamerlay /var/lib/layman/x11 /var/lib/layman/mozilla /usr/local/portage /var/lib/xmw-overlay /var/lib/layman/science /var/lib/layman/sunrise /var/lib/layman/java-overlay /var/lib/layman/gnome /var/lib/layman/gamerlay /var/lib/layman/x11 /var/lib/layman/mozilla"
SYNC="cvs://xmw@cvs.gentoo.org:/var/cvsroot"
USE="X a52 aac aalib acl alsa amd64 ao bash-completion berkdb bluetooth bzip2 cairo cdda cddb cdparanoia cdr cli consolekit cracklib crypt cups curl cxx dbus dga djvu dri dts dv dvd dvdr emboss encode exif faac faad fam fbcon ffmpeg fftw firefox flac fontconfig fortran gdbm gdu gif gimp git glut gnutls gphoto2 gpm gs gstreamer gtk iconv id3tag imagemagick ipv6 java jbig jpeg jpeg2k lame latex lcms libsamplerate lzma lzo mad mmx mng modules mp3 mp4 mpeg mplayer mudflap multilib nas nautilus ncurses nls nptl nptlonly nsplugin ogg openal openexr opengl openmp pam pango pch pcmcia pcre pdf perl png policykit ppds pppd python qt3support qt4 quicktime raw readline rle scanner sdl session smp speex spell sqlite sqlite3 sse sse2 ssl startup-notification subversion svg symlink sysfs taglib tcl tcpd theora threads tiff tk truetype udev unicode upnp usb vim-syntax vorbis wavpack webkit x264 xcb xine xinerama xml xorg xscreensaver xulrunner xv xvid zlib zsh-completion" ALSA_CARDS="intel-hda" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de en en_US en_GB" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="intel" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 2


Michael Weber (RETIRED)






          2011-05-11 22:59:31 UTC
        

simple fix

Index: macchanger-1.5.0-r2.ebuild
===================================================================
RCS file: /var/cvsroot/gentoo-x86/net-analyzer/macchanger/macchanger-1.5.0-r2.ebuild,v
retrieving revision 1.1
diff -u -B -r1.1 macchanger-1.5.0-r2.ebuild
--- macchanger-1.5.0-r2.ebuild  29 Oct 2009 09:02:47 -0000      1.1
+++ macchanger-1.5.0-r2.ebuild  11 May 2011 22:59:06 -0000
@@ -2,6 +2,8 @@
 # Distributed under the terms of the GNU General Public License v2
 # $Header: /var/cvsroot/gentoo-x86/net-analyzer/macchanger/macchanger-1.5.0-r2.ebuild,v 1.1 2009/10/29 09:02:47 robbat2 Exp $
 
+inherit flag-o-matic
+
 DESCRIPTION="Utility for viewing/manipulating the MAC address of network interfaces"
 OUI_DATE="20091029" # Generated with tools/IEEE_OUI.py in the source
 OUI_FILE="OUI.list-${OUI_DATE}"
@@ -21,6 +23,7 @@
 }
 
 src_compile() {
+       append-cflags '-DVERSION=\"${PV}\"'
        # Shared data is installed below /lib, see Bug #57046
        econf \
                --bindir=/sbin \




Comment 3


Michael Weber (RETIRED)






          2011-05-11 23:02:12 UTC
        

the program istself works (macchanger -m ... wlan0) with wlan0 being down,
ut it fails with "RF-kill state" if used via mac_wlan="..." in conf.d/net

i've reverted my setup to 

preup() {
        if [ ${IFACE} == "wlan0" ]; then
                einfo setting MAC to ...
                ip link set wlan0 address ...;
                eend $?;
        fi
        return 0;
}




Comment 4


Michael Weber (RETIRED)






          2011-05-11 23:08:50 UTC
        

config_wlan0="noop"
mac_wlan0="00:11:22:33:44:55"
wpa_supplicant_wlan0="-c /etc/wpa_supplicant/wpa_supplicant.conf -D wext -P /var/run/wpa_supplicant.pid"


io macchanger # /etc/init.d/net.wlan0 restart
 * Caching service dependencies ...                                       [ ok ]
 * Bringing down interface wlan0
 *   Stopping wpa_cli on wlan0 ...                                        [ ok ]
 *   Stopping wpa_supplicant on wlan0 ...                                 [ ok ]
 *   Running postdown ...
 * Bringing up interface wlan0
 *   Running preup ...
 *   Changing MAC address of wlan0 ...
*** buffer overflow detected ***: /sbin/macchanger terminated
======= Backtrace: =========
/lib64/libc.so.6(__fortify_fail+0x37)[0x7f88ef567ec7]
/lib64/libc.so.6(+0xead20)[0x7f88ef565d20]
/sbin/macchanger[0x4014ae]
/sbin/macchanger[0x4017e2]
/lib64/libc.so.6(__libc_start_main+0xfd)[0x7f88ef499ebd]
/sbin/macchanger[0x400bc9]
======= Memory map: ========
00400000-00403000 r-xp 00000000 fe:02 403346656                          /sbin/macchanger
00602000-00603000 r--p 00002000 fe:02 403346656                          /sbin/macchanger
00603000-00604000 rw-p 00003000 fe:02 403346656                          /sbin/macchanger
01adb000-01b5f000 rw-p 00000000 00:00 0                                  [heap]
7f88ef265000-7f88ef27a000 r-xp 00000000 fe:02 1387586                    /lib64/libgcc_s.so.1
7f88ef27a000-7f88ef479000 ---p 00015000 fe:02 1387586                    /lib64/libgcc_s.so.1
7f88ef479000-7f88ef47a000 r--p 00014000 fe:02 1387586                    /lib64/libgcc_s.so.1
7f88ef47a000-7f88ef47b000 rw-p 00015000 fe:02 1387586                    /lib64/libgcc_s.so.1
7f88ef47b000-7f88ef5fd000 r-xp 00000000 fe:02 313195526                  /lib64/libc-2.13.so
7f88ef5fd000-7f88ef7fc000 ---p 00182000 fe:02 313195526                  /lib64/libc-2.13.so
7f88ef7fc000-7f88ef800000 r--p 00181000 fe:02 313195526                  /lib64/libc-2.13.so
7f88ef800000-7f88ef801000 rw-p 00185000 fe:02 313195526                  /lib64/libc-2.13.so
7f88ef801000-7f88ef806000 rw-p 00000000 00:00 0
7f88ef806000-7f88ef825000 r-xp 00000000 fe:02 313192680                  /lib64/ld-2.13.so
7f88ef9be000-7f88ef9f4000 rw-p 00000000 00:00 0
7f88efa24000-7f88efa25000 rw-p 00000000 00:00 0
7f88efa25000-7f88efa26000 r--p 0001f000 fe:02 313192680                  /lib64/ld-2.13.so
7f88efa26000-7f88efa27000 rw-p 00020000 fe:02 313192680                  /lib64/ld-2.13.so
7f88efa27000-7f88efa28000 rw-p 00000000 00:00 0
7fffeb86d000-7fffeb88e000 rw-p 00000000 00:00 0                          [stack]
7fffeb9ff000-7fffeba00000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
RTNETLINK answers: Operation not possible due to RF-kill
*** buffer overflow detected ***: /sbin/macchanger terminated
======= Backtrace: =========
/lib64/libc.so.6(__fortify_fail+0x37)[0x7f232e27fec7]
/lib64/libc.so.6(+0xead20)[0x7f232e27dd20]
/sbin/macchanger[0x4014ae]
/sbin/macchanger[0x4017e2]
/lib64/libc.so.6(__libc_start_main+0xfd)[0x7f232e1b1ebd]
/sbin/macchanger[0x400bc9]
======= Memory map: ========
00400000-00403000 r-xp 00000000 fe:02 403346656                          /sbin/macchanger
00602000-00603000 r--p 00002000 fe:02 403346656                          /sbin/macchanger
00603000-00604000 rw-p 00003000 fe:02 403346656                          /sbin/macchanger
01fa9000-0202d000 rw-p 00000000 00:00 0                                  [heap]
7f232df7d000-7f232df92000 r-xp 00000000 fe:02 1387586                    /lib64/libgcc_s.so.1
7f232df92000-7f232e191000 ---p 00015000 fe:02 1387586                    /lib64/libgcc_s.so.1
7f232e191000-7f232e192000 r--p 00014000 fe:02 1387586                    /lib64/libgcc_s.so.1
7f232e192000-7f232e193000 rw-p 00015000 fe:02 1387586                    /lib64/libgcc_s.so.1
7f232e193000-7f232e315000 r-xp 00000000 fe:02 313195526                  /lib64/libc-2.13.so
7f232e315000-7f232e514000 ---p 00182000 fe:02 313195526                  /lib64/libc-2.13.so
7f232e514000-7f232e518000 r--p 00181000 fe:02 313195526                  /lib64/libc-2.13.so
7f232e518000-7f232e519000 rw-p 00185000 fe:02 313195526                  /lib64/libc-2.13.so
7f232e519000-7f232e51e000 rw-p 00000000 00:00 0
7f232e51e000-7f232e53d000 r-xp 00000000 fe:02 313192680                  /lib64/ld-2.13.so
7f232e6d6000-7f232e70c000 rw-p 00000000 00:00 0
7f232e73c000-7f232e73d000 rw-p 00000000 00:00 0
7f232e73d000-7f232e73e000 r--p 0001f000 fe:02 313192680                  /lib64/ld-2.13.so
7f232e73e000-7f232e73f000 rw-p 00020000 fe:02 313192680                  /lib64/ld-2.13.so
7f232e73f000-7f232e740000 rw-p 00000000 00:00 0
7fffdf405000-7fffdf426000 rw-p 00000000 00:00 0                          [stack]
7fffdf529000-7fffdf52a000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
 *   Failed to set MAC address                                            [ !! ]
 * ERROR: net.wlan0 failed to start
io macchanger 1 # ip link
...
3: wlan0: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether <real> brd ff:ff:ff:ff:ff:ff
...
io macchanger # macchanger -m 00:11:22:33:44:55 wlan0    
Current MAC: <real> (Foxconn)
Faked MAC:   00:11:22:33:44:55 (Cimsys Inc)
io macchanger # ip link                              
...
3: wlan0: <BROADCAST,MULTICAST> mtu 1500 qdisc mq state DOWN qlen 1000
    link/ether 00:11:22:33:44:55 brd ff:ff:ff:ff:ff:ff
...
io macchanger #




Comment 5


Robin Johnson









          2013-12-28 00:41:40 UTC
        

1.6.0 is already fixed









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

