Title: 175751 – net-nntp/inn-2.4.3 init script issue
URL: https://bugs.gentoo.org/show_bug.cgi?id=175751

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 175751
net-nntp/inn-2.4.3 init script issue
Last modified: 2007-05-12 13:06:07 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 175751 
      - net-nntp/inn-2.4.3 init script issue


Summary:
net-nntp/inn-2.4.3 init script issue
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Net-news project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-04-23 19:29 UTC by Christophe PEREZ





      Modified:
    
2007-05-12 13:06 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




innd.start.log

              (innd.start.log,44.28 KB,
                text/plain)

            
2007-04-27 21:44 UTC,

            Christophe PEREZ




Details





innd.start.log

              (innd.start.log,63.28 KB,
                text/plain)

            
2007-04-30 19:45 UTC,

            Christophe PEREZ




Details





emerge --info

              (emerge.info,3.42 KB,
                text/plain)

            
2007-04-30 20:40 UTC,

            Christophe PEREZ




Details





emerge 
emerge -pv =net-nntp/inn-2.4.3

              (emerge.pv,285 bytes,
                text/plain)

            
2007-04-30 20:41 UTC,

            Christophe PEREZ




Details





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Christophe PEREZ





          2007-04-23 19:29:02 UTC
        

I have upgraded inn today, and I have problem with init script.

# /etc/init.d/innd start
 * Starting innd ...
Starting innd.                                                 [ !! ]

But, it is running :
# ps axf | grep inn
 6426 ?        Ss     0:00 /usr/lib/news/bin/innd -p 4

and I can use/access to it.




Comment 1


Wulf Krueger (RETIRED)






          2007-04-27 20:24:07 UTC
        

Does this always happen when you start Inn? If so, please use the --debug 
option:

/etc/init.d/innd --debug status >innd.start.log 2>&1

Then attach innd.start.log to this bug. Thanks!




Comment 2


Christophe PEREZ





          2007-04-27 21:44:49 UTC
        

Created attachment 117451 [details]
innd.start.log

when innd is not running (after /usr/lib/news/bin/rc.news stop)




Comment 3


Wulf Krueger (RETIRED)






          2007-04-30 19:36:17 UTC
        

I just realised I wrote "status" instead of "start":

/etc/init.d/innd --debug start >innd.start.log 2>&1

Please attach the log resulting from that. I apologize for the inconvenience. 
(And please use "/etc/init.d/innd stop" to stop Inn instead of running rc.news 
directly.)




Comment 4


Christophe PEREZ





          2007-04-30 19:40:16 UTC
        

(In reply to comment #3)
> I just realised I wrote "status" instead of "start":
> 
> /etc/init.d/innd --debug start >innd.start.log 2>&1

I'll do it.

> Please attach the log resulting from that. I apologize for the inconvenience. 
> (And please use "/etc/init.d/innd stop" to stop Inn instead of running rc.news 
> directly.)
 
How can I stop a service never started ?
# /etc/init.d/innd stop
 * WARNING:  innd has not yet been started.

Did you really understand my problem ? I know my english is not really good.





Comment 5


Christophe PEREZ





          2007-04-30 19:45:02 UTC
        

Created attachment 117761 [details]
innd.start.log

/etc/init.d/innd --debug start >innd.start.log 2>&1




Comment 6


Wulf Krueger (RETIRED)






          2007-04-30 19:52:27 UTC
        

Yes, I really understood your problem. :-) (Your English is fine, btw. Way 
better than my French. :) )

As long as this problem persists, you can't stop Inn regularly, of course. I 
just wanted to make sure that you generally use the init script (if it works... 
;-) ).




Comment 7


Christophe PEREZ





          2007-04-30 19:56:33 UTC
        

(In reply to comment #6)
> Yes, I really understood your problem. :-) (Your English is fine, btw. Way 
> better than my French. :) )

Then, your French must be very bad :-)

> As long as this problem persists, you can't stop Inn regularly, of course.

You get it ! ;-)

> I just wanted to make sure that you generally use the init script (if it 
> works...  ;-) ).

Of course I do. I use Gentoo only (almost) for its init scripts :-D





Comment 8


Wulf Krueger (RETIRED)






          2007-04-30 20:37:26 UTC
        

Oh, yes, my French was barely good enough to get to Airbus in Toulouse in a 
cab. :)

Anyway, this is a very strange issue. I'm going to set up a dedicated testing 
environment. Please post both your "emerge --info" and the output from "emerge 
-pv =net-nntp/inn-2.4.3".




Comment 9


Christophe PEREZ





          2007-04-30 20:40:33 UTC
        

Created attachment 117768 [details]
emerge --info




Comment 10


Christophe PEREZ





          2007-04-30 20:41:01 UTC
        

Created attachment 117769 [details]
emerge 
emerge -pv =net-nntp/inn-2.4.3




Comment 11


Christophe PEREZ





          2007-04-30 20:43:18 UTC
        

It seems that init script is looking for /usr/lib/news/bin/rc.news running. But this script just launch innd and is not running after (if I understand well).
So it won't never find pidof /usr/lib/news/bin/rc.news.

But may be I'm very wrong.




Comment 12


Christophe PEREZ





          2007-04-30 20:49:24 UTC
        

May be I'm not wrong at all :-)
this modification is surely the cause :
http://sources.gentoo.org/viewcvs.py/gentoo-x86/net-nntp/inn/files/innd?r1=text&tr1=1.1.1.1&r2=text&tr2=1.2&diff_format=h




Comment 13


Wulf Krueger (RETIRED)






          2007-05-12 13:06:07 UTC
        

Actually, it *does* find the pid:

+++ /bin/pidof -x /usr/lib/news/bin/rc.news
+ pids=26011
+ [[ -z 26011 ]]
+ [[ -s '' ]]
+ return 0

(Excerpt from the log you posted.)

I couldn't reproduce this problem at all. With any combination of USE flags 
(including your own, of course) it just works for me both in my testing 
environment as well as on two production servers I'm running.

The change you've noticed in the init script is absolutely correct and should 
just as it is. I'm sorry but this must be some strange local issue.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

