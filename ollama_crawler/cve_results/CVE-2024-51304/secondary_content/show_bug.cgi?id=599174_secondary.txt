Title: 599174 – app-shells/bash-4.4-r1.ebuild: can't find hprefixify() in RAP installation
URL: https://bugs.gentoo.org/show_bug.cgi?id=599174

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 599174
app-shells/bash-4.4-r1.ebuild: can't find hprefixify() in RAP installation
Last modified: 2016-11-09 10:15:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 599174 
      - app-shells/bash-4.4-r1.ebuild: can't find hprefixify() in RAP installation


Summary:
app-shells/bash-4.4-r1.ebuild: can't find hprefixify() in RAP installation
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2016-11-08 07:42 UTC by Gábor VIDA





      Modified:
    
2016-11-09 10:15 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Gábor VIDA





          2016-11-08 07:42:48 UTC
        

Hi!

After emerge --sync I can't install bash:

 * QA Notice: command not found:
 * 
 *     /home/vidagabor/usr/roots/gentoo/var/tmp/portage/app-shells/bash-4.4-r1/temp/environment: line 2499: hprefixify: command not found
 *     /home/vidagabor/usr/roots/gentoo/var/tmp/portage/app-shells/bash-4.4-r1/temp/environment: line 2469: prefixify_ro: command not found
 * QA Notice: file does not exist:
 * 
 *     doins:  does not exist

After looking around and adding some debug printout to __qa_source() in /home/vidagabor/usr/roots/gentoo/usr/lib64/portage/python3.5/ebuild.sh I see this:

UUUUUUUU __qa_source args: /home/vidagabor/usr/roots/gentoo/usr/portage-stage/eclass/prefix.eclass
UUUUUUUU declare -p hprefixify: /home/vidagabor/usr/roots/gentoo/usr/lib/portage/python3.5/ebuild.sh: line 105: declare: hprefixify: not found

You can see that prefix.eclass in usr/portage-stage/eclass is accessed instead of usr/portage/eclass, which is old, the files there are from the time when I installed my RAP.

In /home/vidagabor/usr/roots/gentoo/etc/portage/repos.conf:

[DEFAULT]
main-repo = gentoo
eclass-overrides = rap

[gentoo]
location = /home/vidagabor/usr/roots/gentoo/usr/portage
sync-type = rsync
sync-uri = rsync://rsync.gentoo.org/gentoo-portage

[rap]
location = /home/vidagabor/usr/roots/gentoo/usr/portage-stage
sync-type = git
sync-uri = https://anongit.gentoo.org/git/proj/android.git
auto-sync = no

How am I supposed to update the rap repo? I thought so far that all I have to do is emerge --sync to get the latest ebuilds.

Thank you in advance!

Reproducible: Always

Steps to Reproduce:
1. emerge -av bash
Actual Results:  

 * QA Notice: command not found:
 * 
 *     /home/vidagabor/usr/roots/gentoo/var/tmp/portage/app-shells/bash-4.4-r1/temp/environment: line 2499: hprefixify: command not found
 *     /home/vidagabor/usr/roots/gentoo/var/tmp/portage/app-shells/bash-4.4-r1/temp/environment: line 2469: prefixify_ro: command not found
 * QA Notice: file does not exist:
 * 
 *     doins:  does not exist

Expected Results:  
Merged new bash package.




Comment 1


Gábor VIDA





          2016-11-08 07:44:48 UTC
        

Portage 2.3.1 (python 3.5.2-final-0, prefix/linux-standalone/amd64, gcc-5.4.0, glibc-2.23-r2, 3.13.0-49-generic x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-3.13.0-49-generic-x86_64-Intel-R-_Core-TM-_i7-4610M_CPU_@_3.00GHz-with-debian-jessie-sid
KiB Mem:    16337988 total,    175888 free
KiB Swap:   18350076 total,  16916976 free
Timestamp of repository gentoo: Tue, 08 Nov 2016 06:30:01 +0000
sh bash 4.4-r1
ld GNU ld (Gentoo 2.26.1 p1.0) 2.26.1
ccache version 3.2.7 [enabled]
app-shells/bash:          4.4-r1::gentoo
dev-lang/perl:            5.24.0-r2::gentoo
dev-lang/python:          2.7.12::gentoo, 3.5.2::gentoo
dev-util/ccache:          3.2.7::gentoo
dev-util/cmake:           3.6.2::gentoo
dev-util/pkgconfig:       0.29.1::gentoo
sys-apps/baselayout:      2.3::gentoo
sys-apps/sandbox:         2.10-r2::gentoo
sys-devel/autoconf:       2.13::gentoo, 2.69-r2::gentoo
sys-devel/automake:       1.14.1-r1::gentoo, 1.15-r2::gentoo
sys-devel/binutils:       2.26.1::gentoo
sys-devel/gcc:            5.4.0::gentoo
sys-devel/gcc-config:     1.8_p20160608::rap
sys-devel/libtool:        2.4.6-r2::gentoo
sys-devel/make:           4.2.1::gentoo
sys-kernel/linux-headers: 4.7::gentoo (virtual/os-headers)
sys-libs/glibc:           2.23-r2::rap
Repositories:

gentoo
    location: /home/vidagabor/usr/roots/gentoo/usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    eclass-overrides: rap

rap
    location: /home/vidagabor/usr/roots/gentoo/usr/portage-stage
    sync-type: git
    sync-uri: https://anongit.gentoo.org/git/proj/android.git
    masters: gentoo
    eclass-overrides: rap

ACCEPT_KEYWORDS="amd64 ~amd64 ~amd64-linux"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe -O2 -pipe"
DISTDIR="/home/vidagabor/usr/roots/gentoo/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs ccache config-protect-if-modified distlocks ebuild-locks fixlafiles force-prefix merge-sync metadata-transfer news parallel-fetch preserve-libs protect-owned sfperms strict unknown-features-warn unmerge-logs unmerge-orphans unprivileged"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://mirror.mdfnet.se/gentoo"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j3"
PKGDIR="/home/vidagabor/usr/roots/gentoo/usr/portage/packages"
PORTAGE_CONFIGROOT="/home/vidagabor/usr/roots/gentoo/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/home/vidagabor/usr/roots/gentoo/var/tmp"
USE="X a52 aac aacplus acl alsa amd64 athena berkdb bluray bzip2 clang cli corefonts cpudetection cracklib crypt cxx dbus djvu dri dv dvb emacs faac fftw fontconfig fortran fuse gdbm gif gnutls googledrive graphviz gzip-el iconv imagemagick ipv6 jpeg jpeg2k libxml2 lzma mmx mmxext modplug modules mp3 ncurses nls nptl openmp pcre perl png prefix python readline rtc rtmp seccomp session source sse sse2 ssh ssl tcpd theora tiff toolkit-scroll-bars tools truetype unicode vorbis wide-int wmf xcb xinerama xlib-xcb xml zlib" ABI_X86="64" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext sse sse2 sse3 sse4_1 sse4_2 ssse3 avx avx2" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-6" PYTHON_SINGLE_TARGET="python3_5" PYTHON_TARGETS="python3_5 python2_7" RUBY_TARGETS="ruby20 ruby21" USERLAND="GNU" VIDEO_CARDS="amdgpu fbdev intel nouveau radeon radeonsi vesa dummy v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON

=================================================================
                        Package Settings
=================================================================

app-shells/bash-4.4-r1::gentoo was built with the following:
USE="net nls (prefix) (readline) -afs -bashlogger -examples -mem-scramble -plugins -vanilla"




Comment 2


Jonas Stein






          2016-11-08 17:14:38 UTC
        

Dear Gábor VIDA,

this bug tracker is just for bugs like broken ebuilds. 
I can not reproduce the described problem here and will close the bug therefore.

You will get the best support on the gentoo support channels.

https://www.gentoo.org/support/

If you have more details and think this is a general bug in gentoo, please reopen this or a new bug ticket.




Comment 3


Gábor VIDA





          2016-11-09 10:15:47 UTC
        

Yes, you're right. As I collected the details to report this "bug" that seemed to be a bug, I should have realized that it is not, and should not report it. I'm sorry.

Anyway, I updated the rap repo with "emaint sync --allrepos", and now the package works fine.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

