Title: 428218 – gnome-extra/nm-applet-0.9.2.0-r1 - nm-applet Failed to register as an agent / Not authorized to control networking
URL: https://bugs.gentoo.org/show_bug.cgi?id=428218

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 428218
gnome-extra/nm-applet-0.9.2.0-r1 - nm-applet Failed to register as an agent / Not authorized to control networking
Last modified: 2012-07-29 17:48:22 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 428218 
      - gnome-extra/nm-applet-0.9.2.0-r1 - nm-applet Failed to register as an agent / Not authorized to control networking


Summary:
gnome-extra/nm-applet-0.9.2.0-r1 - nm-applet Failed to register as an agent /...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Robert Piasek (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-07-26 19:30 UTC by Balint Dobai-Pataky





      Modified:
    
2012-07-29 17:48 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



freedesktop-bugs
nirbheek
qiaomuf
tetromino









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge.info,3.07 KB,
                text/plain)

            
2012-07-26 19:31 UTC,

            Balint Dobai-Pataky




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Balint Dobai-Pataky





          2012-07-26 19:30:40 UTC
        

I was going for networkmanager-openswan, s I upgraded networkmanager and friends like this:
=net-misc/networkmanager-openswan-0.9.2.0::gentoo	**
=net-misc/networkmanager-0.9.2.0-r5::gentoo		**
=net-misc/networkmanager-openvpn-0.9.2.0:0	**
=gnome-extra/nm-applet-0.9.2.0-r1:0	**

And when this error ocured I upgraded the followings packages too:

=sys-auth/polkit-0.107:0	**
=dev-libs/glib-2.32.4:2	**
=dev-lang/spidermonkey-1.8.5-r1:0	**
=dev-util/gdbus-codegen-2.32.4:0	**

But it did not do anything.
networkmanager works ok, I see it in syslog geting ip from dhcp on ethernet.
but nm-applet has disabled the 'Enable Networking' and 'Enable Wireless' checkboxes.
Also does not react for any connect/disconnect commands.
running it from a terminals shows the following:
on startup:
$ nm-applet
Gtk-Message: Failed to load module "gnomesegvhandler"
** Message: applet now removed from the notification area
** Message: applet now embedded in the notification area

** (nm-applet:2279): WARNING **: Failed to register as an agent: (32) No session found for uid 1000

when I click on a connection:


** (nm-applet:2279): WARNING **: Failed to add/activate connection: (32) Not authorized to control networking.

I googled around, they all lead to polkit stuff, but couldn't do it.

Reproducible: Always

Steps to Reproduce:
1. try to use nm-applet
2.
3.
Actual Results:  
nm-applet does not control networkmanager




Comment 1


Balint Dobai-Pataky





          2012-07-26 19:31:04 UTC
        

Created attachment 319326 [details]
emerge --info




Comment 2


Alexandre Rostovtsev (RETIRED)






          2012-07-27 00:48:45 UTC
        

The message "No session found for uid 1000" suggests that you have neither consolekit nor systemd working. Assuming that you don't to switch to systemd, make sure that an up-to-date version of consolkeit is running:

a. make sure that sys-auth/consolekit-0.4.5_p20120320 is installed;
b. rc-update add consolekit default
c. /etc/init.d/consolekit start
d. log out of your desktop session, and log back in.

Second, please update to networkmanager-0.9.4.0-r5 and nm-applet-0.9.4.1 (the latest ~arch versions) and check whether the problem persists.




Comment 3


Balint Dobai-Pataky





          2012-07-27 05:44:11 UTC
        

Thanks for the reply,
I checked consolekit, it was installed.

# qlist -Iv consolekit
sys-auth/consolekit-0.4.5_p20120320

# rc-status |grep consolekit
 consolekit                                                        [  started  ]

I'll investigate connecting to consolekit further.




Comment 4


Balint Dobai-Pataky





          2012-07-27 05:59:48 UTC
        

I upgraded to newest networkmanager and nm-applet, same results.
$ qlist -Iv networkmanager nm-applet
gnome-extra/nm-applet-0.9.4.1
net-misc/networkmanager-0.9.4.0-r5




Comment 5


Alexandre Rostovtsev (RETIRED)






          2012-07-27 06:53:34 UTC
        

What desktop session are you using (gnome2/gnome3/xfce/kde/...)?

How are you launching that session (gdm/kdm/...)? If you are using some sort of custom homemade script, make certain that the final session-launching command is called via the expected ck-launch-session wrapper (for example, "exec ck-launch-session dbus-launch --exit-with-session gnome-session").

Is your user account a member of the plugdev group? (If it's not, add it.)

Please provide the output from the following commands:

ck-list-sessions

pkcheck --action-id org.freedesktop.NetworkManager.settings.modify.system \
 --process $$ && echo "pkcheck passed"




Comment 6


Balint Dobai-Pataky





          2012-07-27 06:56:38 UTC
        

It's gdm.
My user is added to plugdev.

$ ck-list-sessions
returns nothing


$ pkcheck --action-id org.freedesktop.NetworkManager.settings.modify.system \
>  --process $$ && echo "pkcheck passed"
Not authorized.




Comment 7


Alexandre Rostovtsev (RETIRED)






          2012-07-27 07:03:31 UTC
        

(In reply to comment #6)
> $ ck-list-sessions
> returns nothing

That is a problem.

I'm adding consolekit maintainers to the CC list, hopefully they can figure out why consolekit is not registering your session.




Comment 8


Balint Dobai-Pataky





          2012-07-27 07:13:20 UTC
        

Running from root:
# pkcheck --action-id org.freedesktop.NetworkManager.settings.modify.system   --process $$ && echo "pkcheck passed"
pkcheck passed


# grep -i ck-launch-session -R /etc/
/etc/X11/xinit/xinitrc.d/90-consolekit:# Xsession.d script for ck-launch-session.
/etc/X11/xinit/xinitrc.d/90-consolekit:CK_LAUNCH_SESSION=/usr/bin/ck-launch-session

could this be related?
$ grep polkit .xsession-errors 
(polkit-gnome-authentication-agent-1:2026): polkit-gnome-1-WARNING **: Unable to determine the session we are in: GDBus.Error:org.freedesktop.ConsoleKit.Manager.GeneralError: Unable to lookup session information for process '2026'




Comment 9


Samuli Suominen (RETIRED)






          2012-07-27 16:45:15 UTC
        

(In reply to comment #7)
> (In reply to comment #6)
> > $ ck-list-sessions
> > returns nothing
> 
> That is a problem.
> 
> I'm adding consolekit maintainers to the CC list, hopefully they can figure
> out why consolekit is not registering your session.

bugzilla is not helpdesk, forums are more suitable.  

bugzilla can be used once the user has tracked down the reason why he doesn't have a session.

http://forums.gentoo.org/viewtopic-t-858965-start-0.html




Comment 10


Balint Dobai-Pataky





          2012-07-29 17:48:22 UTC
        

gdm was build without policykit.
The forum thread helped, 
I checked everything.
There was one comment: gdm has builtin consolekit support.

Sorry for the noise.
Thank you all for the support.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

