Title: 89267 – sandbox feature broken (was: gcc-3.4.3.20050110-r2 failed because of incomplete multilib)
URL: https://bugs.gentoo.org/show_bug.cgi?id=89267

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 89267
sandbox feature broken (was: gcc-3.4.3.20050110-r2 failed because of incomplete multilib)
Last modified: 2005-04-26 04:57:54 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 89267 
      - sandbox feature broken (was: gcc-3.4.3.20050110-r2 failed because of incomplete multilib)


Summary:
sandbox feature broken (was: gcc-3.4.3.20050110-r2 failed because of incomple...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       major
      


Assignee:

AMD64 Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-16 00:10 UTC by Marek Zachara





      Modified:
    
2005-04-26 04:57 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




logs of the failed build as requested (gcc/config.log)

              (config.log,119.52 KB,
                text/plain)

            
2005-04-16 04:43 UTC,

            Marek Zachara




Details





logs of the failed build as requested (intl/config.log)


              (config.log,8.45 KB,
                text/plain)

            
2005-04-16 04:43 UTC,

            Marek Zachara




Details





logs of the failed build as requested (libiberty/config.log)

              (config.log,84.03 KB,
                text/plain)

            
2005-04-16 04:44 UTC,

            Marek Zachara




Details





logs of the failed build as requested (x86_64-pc-linux-gnu/32/libstdc++-v3/config.log)


              (config.log,13.53 KB,
                text/plain)

            
2005-04-16 04:45 UTC,

            Marek Zachara




Details





logs of the failed build as requested (x86_64-pc-linux-gnu/libstdc++-v3/config.log)

              (config.log,337.38 KB,
                text/plain)

            
2005-04-16 04:46 UTC,

            Marek Zachara




Details





 logs of the failed build as requested (build/config.log)


              (config.log,1.38 KB,
                text/plain)

            
2005-04-16 04:47 UTC,

            Marek Zachara




Details





Show
              Obsolete (5)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Marek Zachara





          2005-04-16 00:10:49 UTC
        

When trying to emerge gcc-3.4.3.20050110-r2, it goes on for about half an hour , then fails during one of the configure stages on-the-way:
make[5]: Leaving directory `/var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build/gcc'
echo timestamp > stmp-multilib
make[4]: Leaving directory `/var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build/gcc'
echo timestamp > stagefeedback_build
echo stagefeedback_build > stage_last
make[3]: Leaving directory `/var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build/gcc'
make[2]: Leaving directory `/var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build/gcc'
Checking multilib configuration...
/bin/sh /var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/gcc-3.4.3/mkinstalldirs x86_64-pc-linux-gnu/libstdc++-v3 ; \
rm -f x86_64-pc-linux-gnu/libstdc++-v3/Makefile || : ; \
cp multilib.out x86_64-pc-linux-gnu/libstdc++-v3/multilib.out
mkdir -p -- x86_64-pc-linux-gnu/libstdc++-v3
Configuring in x86_64-pc-linux-gnu/libstdc++-v3
configure: creating cache ./config.cache
checking build system type... x86_64-pc-linux-gnu
.
.
.
.
config.status: executing default-1 commands
Adding multilib support to Makefile in /var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/gcc-3.4.3/libstdc++-v3
multidirs=32
with_multisubdir=
Running configure in multilib subdirs 32
pwd: /var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build/x86_64-pc-linux-gnu/libstdc++-v3
Running configure in multilib subdir 32
pwd: /var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build/x86_64-pc-linux-gnu
mkdir 32
configure: creating cache ./config.cache
checking build system type... x86_64-pc-linux-gnu
checking host system type... x86_64-pc-linux-gnu
checking target system type... x86_64-pc-linux-gnu
checking for a BSD-compatible install... /bin/install -c
checking whether build environment is sane... yes
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking for x86_64-pc-linux-gnu-gcc... /var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build/gcc/xgcc -B/var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build/gcc/ -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include  -m32
checking for C compiler default output file name... a.out
checking whether the C compiler works... configure: error: cannot run C compiled programs.
If you meant to cross compile, use `--host'.
See `config.log' for more details.
make[1]: *** [configure-target-libstdc++-v3] Error 1
make[1]: Leaving directory `/var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build'
make: *** [profiledbootstrap] Error 2

!!! ERROR: sys-devel/gcc-3.4.3.20050110-r2 failed.
!!! Function gcc_do_make, Line 1133, Exitcode 2
!!! emake failed with profiledbootstrap
!!! If you need support, post the topmost build error, NOT this status message.



Reproducible: Always
Steps to Reproduce:
1. emerge -u gcc
2.
3.

Actual Results:  
gcc fails to compile (previous version 3.4.3.20050110-r1 builded without 
problems) 

Expected Results:  
well gcc should compile :) 

Portage 2.0.51.19 (default-linux/amd64/2004.3, gcc-3.4.3-20050110, 
glibc-2.3.4.20050125-r1, 2.6.11.2 x86_64) 
================================================================= 
System uname: 2.6.11.2 x86_64 AMD Athlon(tm) 64 Processor 2800+ 
Gentoo Base System version 1.6.10 
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Feb 20 2005, 20:52:47)] 
dev-lang/python:     2.3.5 
sys-devel/autoconf:  2.59-r6, 2.13 
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.5 
sys-devel/binutils:  2.15.92.0.2-r8 
sys-devel/libtool:   1.5.14 
virtual/os-headers:  2.6.11 
ACCEPT_KEYWORDS="amd64 ~amd64" 
AUTOCLEAN="yes" 
CFLAGS="-march=athlon64 -O2 -msse -msse2 -mmmx -m3dnow -mfpmath=sse -pipe 
-funroll-loops -fomit-frame-pointer -frerun-loop-opt -falign-functions=8 
-feliminate-unused-debug-types" 
CHOST="x86_64-pc-linux-gnu" 
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/share/config /var/qmail/control" 
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d" 
CXXFLAGS="-march=athlon64 -O2 -msse -msse2 -mmmx -m3dnow -mfpmath=sse -pipe 
-funroll-loops -fomit-frame-pointer -frerun-loop-opt -falign-functions=8 
-feliminate-unused-debug-types" 
DISTDIR="/var/ext/portage/distfiles" 
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox" 
GENTOO_MIRRORS="http://distfiles.gentoo.org 
http://distro.ibiblio.org/pub/Linux/distributions/gentoo" 
MAKEOPTS="-j2" 
PKGDIR="/usr/portage/packages" 
PORTAGE_TMPDIR="/var/ext/portage/tmp" 
PORTDIR="/var/ext/portage/tree" 
PORTDIR_OVERLAY="/var/ext/portage/local" 
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage" 
USE="X aalib acpi alsa amd64 arts avi berkdb bidi bitmap-fonts bluetooth bzlib 
calendar cdr crypt cups curl dga divx4linux dvd dvdr emacs encode fam flac 
font-server foomaticdb fortran gd gdbm gif gimpprint gnokii gpm gtk gtk2 
imagemagick java jikes jp2 jpeg kde lzw lzw-tiff maildir mime motif mozilla 
mp3 mpeg msn multilib ncurses nls nptl ogg opengl pam pda pdflib perl png 
posix python qt quicktime readline sdl spell ssl tcpd tiff truetype 
truetype-fonts type1-fonts unicode usb userlocales vorbis xine xml2 xpm xrandr 
xv xvid zlib" 
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS




Comment 1


SpanKY






          2005-04-16 01:26:49 UTC
        

post the config.log files from the builddir as attachments

find /var/ext/portage/tmp/portage/gcc-3.4.3.20050110-r2/work/build -name config.log




Comment 2


Marek Zachara





          2005-04-16 04:43:01 UTC
        

Created attachment 56437 [details]
logs of the failed build as requested (gcc/config.log)




Comment 3


Marek Zachara





          2005-04-16 04:43:59 UTC
        

Created attachment 56438 [details]
logs of the failed build as requested (intl/config.log)




Comment 4


Marek Zachara





          2005-04-16 04:44:54 UTC
        

Created attachment 56440 [details]
logs of the failed build as requested (libiberty/config.log)




Comment 5


Marek Zachara





          2005-04-16 04:45:58 UTC
        

Created attachment 56441 [details]
logs of the failed build as requested (x86_64-pc-linux-gnu/32/libstdc++-v3/config.log)




Comment 6


Marek Zachara





          2005-04-16 04:46:47 UTC
        

Created attachment 56442 [details]
logs of the failed build as requested (x86_64-pc-linux-gnu/libstdc++-v3/config.log)




Comment 7


Marek Zachara





          2005-04-16 04:47:23 UTC
        

Created attachment 56443 [details]
 logs of the failed build as requested (build/config.log)




Comment 8


Jakub Moc (RETIRED)






          2005-04-16 07:48:16 UTC
        

Marek, you probably forgot to reopen this one. ;-)




Comment 9


Marek Zachara





          2005-04-16 10:00:09 UTC
        

oops, yes :) just a busy day ...




Comment 10


SpanKY






          2005-04-16 15:50:29 UTC
        

x86_64-pc-linux-gnu/32/libstdc++-v3/config.log:
./a.out: error while loading shared libraries: /lib/libsandbox.so: cannot open shared object file: No such file or directory

your multilib isnt setup properly, the amd64 can dupe/invalid this bug as they see fit




Comment 11


Marek Zachara





          2005-04-16 22:22:03 UTC
        

well, libsandbox.so is right there:
localhost ~ # ls -la /lib/libsandbox.so
-rwxr-xr-x  1 root root 33448 Mar  9 22:18 /lib/libsandbox.so

(ELF 64-bit LSB shared object, AMD x86-64, version 1 (SYSV), stripped

# ld.so.conf autogenerated by env-update; make all changes to
# contents of /etc/env.d directory
/usr/local/lib
/usr/lib32/opengl/ati/lib
/usr/lib/opengl/ati/lib
/lib
/usr/lib
/usr/local/lib
/lib32
/usr/lib32
/usr/local/lib32
/usr/x86_64-pc-linux-gnu/lib
/usr/lib/gcc/x86_64-pc-linux-gnu/3.4.3-20050110
/usr/lib/gcc-lib/x86_64-pc-linux-gnu/3.4.2
/usr/lib/gcc-lib/x86_64-pc-linux-gnu/3.4.2/32
/usr/lib/MozillaFirefox
/usr/lib
/usr/lib/openmotif-2.2
/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/
/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/native_threads/
/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/classic/
/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/server/
/emul/linux/x86/lib
/emul/linux/x86/usr/lib
/emul/linux/x86/usr/qt/2/lib
/emul/linux/x86/usr/qt/3/lib
/usr/qt/3/lib
/usr/qt/3/lib32
/usr/kde/3.4/lib
/emul/linux/x86/lib
/emul/linux/x86/usr/lib
/usr/lib/libstdc++-v3





Comment 12


Marek Zachara





          2005-04-17 01:46:02 UTC
        

noticing on the web a lot of problems with sandbox, i tried
FEATURES="-sandbox" emerge -u gcc  
and it worked fine - gcc compiled cleanly. I have also check other packages and e.g. openoffice-bin-1.1.4-r1 also doesn't build complaining about missing libsandbox.so





Comment 13


Jeremy Huddleston (RETIRED)






          2005-04-24 11:40:18 UTC
        

Marek, please try sys-apps/sandbox-1.2.1-r3




Comment 14


Marek Zachara





          2005-04-25 12:18:03 UTC
        

just a quick comment as as i dont have sound info yet - i emerged sandbox, then i have noticed there is new glibc available. I started the build process.
It took unusually long time. My jaw dropped completely when after 20hrs of build, the glibc has not yet finished even the first half - linuxthreads. I tried FEATURES="-sandbox" emerge -u glibc, and after 2 hours the build is much futher then after 20hrs before with sandbox (just completing linuxthreads part). I'll try to comile gcc again after glibc with sandbox enabled and let you know if it behaves the same way. (I'm using AMD64 2800)





Comment 15


Marek Zachara





          2005-04-26 04:57:54 UTC
        

the gcc seems to build. When I have some time i'll build it twice to measure if there is build time difference with sandbox enabled. The slowdown when compiling glibc with sandbox is however repeateable. I just watched first few minutes of build with and w/o sandbox and the difference is noticeable (the slowdown is like 3-5x) dunno if this is directly related to sandbox lib or is it just my setup somewhere screwed up.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

