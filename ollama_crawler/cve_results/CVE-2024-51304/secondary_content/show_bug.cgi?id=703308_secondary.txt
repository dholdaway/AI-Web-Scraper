Title: 703308 – emerge fails for all packages since latest kde-frameworks update
URL: https://bugs.gentoo.org/show_bug.cgi?id=703308

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 703308
emerge fails for all packages since latest kde-frameworks update
Last modified: 2019-12-19 19:20:50 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 703308 
      - emerge fails for all packages since latest kde-frameworks update


Summary:
emerge fails for all packages since latest kde-frameworks update
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2019-12-18 17:32 UTC by contactopublico57





      Modified:
    
2019-12-19 19:20 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



grknight
jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


contactopublico57





          2019-12-18 17:32:49 UTC
        

This was not an issue before the most recent kde-frameworks update.

typical log excerpt for all fail-to-emerge packages:

Call stack:
 *            ebuild.sh, line  125:  Called src_unpack
 *          environment, line 2591:  Called default
 *   phase-functions.sh, line  855:  Called default_src_unpack
 *   phase-functions.sh, line  882:  Called __eapi0_src_unpack
 *     phase-helpers.sh, line  755:  Called unpack 'talloc-2.3.1.tar.gz'
 *     phase-helpers.sh, line  350:  Called die
 * The specific snippet of code:
 *   		[[ ! -s ${srcdir}${x} ]] && die "unpack: ${x} does not exist"

Behaviorn continues after re-sync.  Downloaded source files are in /etc/portage/distfiles directory but it appears that emerge/portage can not find them.

/etc/portage/make.conf shows:
PORTDIR="/usr/portage"
DISTDIR="${PORTDIR}/distfiles"
PKGDIR="${PORTDIR}/packages"

sys-apps/portage-2.3.82::gentoo was built with the following:
USE="build (ipc) native-extensions rsync-verify xattr -doc -epydoc -gentoo-dev (-selinux)" ABI_X86="(64)" PYTHON_TARGETS="python2_7 python3_5 python3_6 -pypy -python3_7 -python3_8"

--EOF--




Comment 1


Brian Evans (RETIRED)






          2019-12-18 17:53:57 UTC
        

Please provide a full build.log attached and 'emerge --info'.

Initial thoughts point to permission issues/full disk.




Comment 2


contactopublico57





          2019-12-18 18:33:23 UTC
        

More than 5 gigs available on disk.

/usr/portage/distfiles is portage:portage

log details for talloc typical of all ebuilds failing:

[32;01m * [39;49;00mPackage:    sys-libs/talloc-2.3.1
[32;01m * [39;49;00mRepository: gentoo
[32;01m * [39;49;00mMaintainer: patrick@gentoo.org samba@gentoo.org
[32;01m * [39;49;00mUSE:        abi_x86_64 amd64 elibc_glibc kernel_linux python python_single_target_python3_6 python_targets_python3_5 python_targets_python3_6 userland_GNU
[32;01m * [39;49;00mFEATURES:   network-sandbox preserve-libs sandbox userpriv usersandbox
>>> Unpacking source...
>>> Unpacking talloc-2.3.1.tar.gz to /var/tmp/portage/sys-libs/talloc-2.3.1/work
 [31;01m*[0m ERROR: sys-libs/talloc-2.3.1::gentoo failed (unpack phase):
 [31;01m*[0m   unpack: talloc-2.3.1.tar.gz does not exist
 [31;01m*[0m 
 [31;01m*[0m Call stack:
 [31;01m*[0m            ebuild.sh, line  125:  Called src_unpack
 [31;01m*[0m          environment, line 2591:  Called default
 [31;01m*[0m   phase-functions.sh, line  855:  Called default_src_unpack
 [31;01m*[0m   phase-functions.sh, line  882:  Called __eapi0_src_unpack
 [31;01m*[0m     phase-helpers.sh, line  755:  Called unpack 'talloc-2.3.1.tar.gz'
 [31;01m*[0m     phase-helpers.sh, line  350:  Called die
 [31;01m*[0m The specific snippet of code:
 [31;01m*[0m   		[[ ! -s ${srcdir}${x} ]] && die "unpack: ${x} does not exist"
 [31;01m*[0m 
 [31;01m*[0m If you need support, post the output of `emerge --info '=sys-libs/talloc-2.3.1::gentoo'`,
 [31;01m*[0m the complete build log and the output of `emerge -pqv '=sys-libs/talloc-2.3.1::gentoo'`.
 [31;01m*[0m The complete build log is located at '/usr/portage/logs/sys-libs:talloc-2.3.1:20191218-170304.log'.
 [31;01m*[0m For convenience, a symlink to the build log is located at '/var/tmp/portage/sys-libs/talloc-2.3.1/temp/build.log'.
 [31;01m*[0m The ebuild environment file is located at '/var/tmp/portage/sys-libs/talloc-2.3.1/temp/environment'.
 [31;01m*[0m Working directory: '/var/tmp/portage/sys-libs/talloc-2.3.1/work'
 [31;01m*[0m S: '/var/tmp/portage/sys-libs/talloc-2.3.1/work/talloc-2.3.1'




Comment 3


Jonas Stein






          2019-12-18 18:36:10 UTC
        

Thank you for the report. Please recompile and 
*attach* the logfiles and 
paste the emerge info as described on
https://wiki.gentoo.org/wiki/Attach_the_logs_to_the_bug_ticket
We need to have all information at hand before ticket assignment, so that the maintainer can look after it in one session with minimal number of callbacks.
Please reopen this ticket (Status:unconfirmed) afterwards.




Comment 4


Brian Evans (RETIRED)






          2019-12-18 18:42:01 UTC
        

(In reply to contactopublico57 from comment #2)
> More than 5 gigs available on disk.
> 
> /usr/portage/distfiles is portage:portage
> 
But this says nothing about the *file*.

Ensure that /usr/portage/distfiles/talloc-2.3.1.tar.gz has good permissions and is not a broken symlink.




Comment 5


contactopublico57





          2019-12-19 16:52:41 UTC
        

Due to the nature of this problem preventing the emerge of any further packages I reverted to a backup, re-synced the repository and re-emerged/updated WITH THE EXCEPTION OF PORTAGE.  This resolved the issue as I was once again able to emerge without issue.

Hence you may wish to examine the most recent portage ebuild in relation to this issue.

Since the prior build environment no longer exists I can not provide the log(s) nor emerge info.




Comment 6


Jonas Stein






          2019-12-19 19:20:50 UTC
        

cannot do anything without logs. -> Closing.
You are the only user with this report. If kde/portage would have been that kind of broken, we would have some more noise here.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

