Title: 83437 – checkfs : failure running cryptsetup
URL: https://bugs.gentoo.org/show_bug.cgi?id=83437

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 83437
checkfs : failure running cryptsetup
Last modified: 2005-05-15 12:52:56 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 83437 
      - checkfs : failure running cryptsetup


Summary:
checkfs : failure running cryptsetup
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-02-26 23:21 UTC by Pascal Roussel





      Modified:
    
2005-05-15 12:52 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



absinthe
gentoo
tigger









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Pascal Roussel





          2005-02-26 23:21:21 UTC
        

baselayout-1.11.9-r1

"failure running cryptsetup" "crypsetup : invalid argument" messages on boot.

/etc/conf.d/cryptsetup :
swap=crypt-swap
source='/dev/hda2'

dm-crypt and aes modules loaded.

works fine from command line. but not from init script.

Reproducible: Always
Steps to Reproduce:
1.
2.
3.



Portage 2.0.51-r15 (default-linux/x86/2004.0, gcc-3.3.4,
glibc-2.3.4.20040808-r1, 2.6.10-gentoo-r6 i686)
=================================================================
System uname: 2.6.10-gentoo-r6 i686 AMD Athlon(tm) XP 2100+
Gentoo Base System version 1.6.9
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb 27 2005, 06:45:45)]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r5
sys-devel/automake:  1.8.5-r1
sys-devel/binutils:  2.15.90.0.1.1-r3
sys-devel/libtool:   1.5.2-r7
virtual/os-headers:  2.6.8.1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-march=athlon-xp -O3 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/NX/etc /usr/X11R6/lib/X11/xkb /usr/kde/2/share/config
/usr/kde/3.1/share/config /usr/kde/3/share/config /usr/lib/mozilla/defaults/pref
/usr/share/config /usr/share/texmf/tex/generic/config/
/usr/share/texmf/tex/platex/config/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=athlon-xp -O3 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms"
GENTOO_MIRRORS="http://mir.zyrianes.net/gentoo/"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow X alsa apm avi bash-completion berkdb bitmap-fonts bonobo cdr
crypt cscope cups curl dvdr emboss encode esd f77 fam flac font-server
foomaticdb fortran gdbm gif gnome gphoto2 gpm gstreamer gtk gtk2 gtkhtml guile
imagemagick imlib ipv6 java jpeg junit ldap libg++ libwww mad mikmod mmx motif
mozilla mpeg ncurses nls nptl oggvorbis opengl oss pam pdflib perl png python qt
quicktime readline samba sdl slang spell sqlite sse ssl svga tcltk tcpd tetex
tiff truetype truetype-fonts type1-fonts xft xml xml2 xmms xv zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, PORTDIR_OVERLAY




Comment 1


Pascal Roussel





          2005-02-27 18:20:14 UTC
        

and if I run

/etc/init.d/checkfs restart

after boot is complete, dm mappings are correctly created.
It only fails during boot sequence.




Comment 2


Pascal Roussel





          2005-02-27 21:24:57 UTC
        

probably udev being too slow

well... that's still a bug...




Comment 3


Peter Gantner (a.k.a. nephros)





          2005-03-28 03:55:07 UTC
        

Hmm, it seems to work if you have all the options on the same line.
swap=crypt-swap source='/dev/hda2'

I fell into the same trap; the documentation in the file and on the cryptfs guide is not clear on this..






Comment 4


SpanKY






          2005-05-14 13:53:08 UTC
        

it should work as provided in the example

tigger/absinthe: ideas ?




Comment 5


rob holland (RETIRED)






          2005-05-15 03:55:11 UTC
        

It works fine for me with options on more than one line. The only time I've seen the invalid argument problem is when the wrong AES module was loaded, or when it was missing entirely (generally after a kernel upgrade).

If its working by hand for you, I don't know what the problem is I'm afraid.




Comment 6


Peter Gantner (a.k.a. nephros)





          2005-05-15 04:18:54 UTC
        

Just checked with more lines: it is working here too now. (sys-apps/baselayout-1.11.11-r3)




Comment 7


SpanKY






          2005-05-15 12:52:56 UTC
        

well then ...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

