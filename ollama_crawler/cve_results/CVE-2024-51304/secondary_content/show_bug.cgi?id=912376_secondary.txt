Title: 912376 – sys-apps/hwinfo (22.2, 23.1) doesn't compile (hangs)
URL: https://bugs.gentoo.org/show_bug.cgi?id=912376

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 912376
sys-apps/hwinfo (22.2, 23.1) doesn't compile (hangs)
Last modified: 2023-08-18 15:10:25 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 912376 
      - sys-apps/hwinfo (22.2, 23.1) doesn't compile (hangs)


Summary:
sys-apps/hwinfo (22.2, 23.1) doesn't compile (hangs)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Ben Kohler








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2023-08-17 05:18 UTC by vyp08





      Modified:
    
2023-08-18 15:10 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



bkohler









See Also:


656538





Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,30.99 KB,
                text/plain)

            
2023-08-17 10:56 UTC,

            vyp08




Details





ps_faux.log

              (ps_faux.log,33.51 KB,
                text/plain)

            
2023-08-17 10:56 UTC,

            vyp08




Details





time e1 hwinfo

              (time_e1_hwinfo.txt,33.26 KB,
                text/plain)

            
2023-08-18 05:18 UTC,

            vyp08




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


vyp08





          2023-08-17 05:18:03 UTC
        

hwinfo-22.2.ebuild and hwinfo-23.1.ebuild fail emerge.

Hangs at point
./check_hd --check --sort --cfile hd_ids.h src/bus src/class src/extra src/special src/scanner src/network src/usb src/usb2 src/isapnp src/monitor src/camera src/tv2 src/tv src/dvb2 src/dvb src/chipcard src/modem src/pcmcia src/s390 src/sd
io src/x11.amd64 src/pci src/storage src/sound src/mouse src/braille

but without the "src/usb" and "src/pci" it passes...


Although, maybe this is due to my old system (220808).

Reproducible: Always

Steps to Reproduce:
1. emerge =sys-apps/hwinfo-22.2 or emerge =sys-apps/hwinfo-23.1

2. Work, work, work, then it hangs at point
./check_hd --check --sort --cfile hd_ids.h src/bus src/class src/extra src/special src/scanner src/network src/usb src/usb2 src/isapnp src/monitor src/camera src/tv2 src/tv src/dvb2 src/dvb src/chipcard src/modem src/pcmcia src/s390 src/sd
io src/x11.amd64 src/pci src/storage src/sound src/mouse src/braille

3. cd /var/tmp/portage/sys-apps/hwinfo-22.2/work/hwinfo-22.2/src/ids

4. run (without "src/usb" and "src/pci")
./check_hd --check --sort --cfile hd_ids.h src/bus src/class src/extra src/special src/scanner src/network src/usb2 src/isapnp src/monitor src/camera src/tv2 src/tv src/dvb2 src/dvb src/chipcard src/modem src/pcmcia src/s390 src/sd
io src/x11.amd64 src/storage src/sound src/mouse src/braille

5. cd /home/DATA/gentoo220808/portage.vjp/sys-apps/hwinfo

6. ebuild hwinfo-22.2.ebuild merge

7. Voila. 



emerge --info:

Portage 3.0.30 (python 3.10.5-final-0, default/linux/amd64/17.1, gcc-11.3.0, glibc-2.35-r8, 5.15.59-gentoo-runit-core2-64 x86_64)
=================================================================
System uname: Linux-5.15.59-gentoo-runit-core2-64-x86_64-Intel-R-_Core-TM-_i7-3770_CPU_@_3.40GHz-with-glibc2.35
KiB Mem:    16351948 total,  10828616 free
KiB Swap:          0 total,         0 free
Timestamp of repository gentoo: Tue, 09 Aug 2022 00:45:01 +0000
Head commit of repository gentoo: f23a1058da70a7005c5a164c1388e76d1a07427d
sh bash 5.1_p16-r1
ld GNU ld (Gentoo 2.38 p4) 2.38
distcc 3.4 x86_64-pc-linux-gnu [disabled]
ccache version 4.5.1 [disabled]
app-misc/pax-utils:        1.3.4::gentoo
app-shells/bash:           5.1_p16-r1::gentoo
dev-java/java-config:      2.3.1::gentoo
dev-lang/perl:             5.34.1-r3::gentoo
dev-lang/python:           3.10.5::gentoo
dev-lang/rust:             1.62.1::gentoo
dev-util/ccache:           4.5.1::gentoo
dev-util/cmake:            3.22.4::gentoo
dev-util/meson:            0.62.2::gentoo
sys-apps/baselayout:       2.8::gentoo
sys-apps/openrc:           0.44.10::gentoo
sys-apps/sandbox:          2.29::gentoo
sys-devel/autoconf:        2.71-r1::gentoo
sys-devel/automake:        1.16.5::gentoo
sys-devel/binutils:        2.38-r2::gentoo
sys-devel/binutils-config: 5.4.1::gentoo
sys-devel/clang:           13.0.1::gentoo, 14.0.6-r1::gentoo
sys-devel/gcc:             11.3.0::gentoo
sys-devel/gcc-config:      2.5-r1::gentoo
sys-devel/libtool:         2.4.7::gentoo
sys-devel/llvm:            13.0.1::gentoo, 14.0.6-r2::gentoo
sys-devel/make:            4.3::gentoo
sys-kernel/linux-headers:  5.15-r3::gentoo (virtual/os-headers)
sys-libs/glibc:            2.35-r8::gentoo
Repositories:

gentoo
    location: /home/DATA/gentoo220808/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-metamanifest: yes
    sync-rsync-extra-opts: 
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-jobs: 1

vjp
    location: /home/DATA/gentoo220808/portage.vjp
    masters: gentoo
    priority: 0

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="@FREE"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -O2"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /etc/stunnel/stunnel.conf /usr/share/config /usr/share/gnupg/qualified.txt /var/bind"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php8.1/ext-active/ /etc/php/cgi-php8.1/ext-active/ /etc/php/cli-php8.1/ext-active/ /etc/php/fpm-php8.1/ext-active/ /etc/php/phpdbg-php8.1/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=core2 -O2"
DISTDIR="/home/DATA/gentoo220808/distfiles"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-march=core2 -O2"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs buildpkg-live config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-march=core2 -O2"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.UTF-8"
LC_ALL="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en ru"
MAKEOPTS="-j4"
PKGDIR="/home/DATA/gentoo220808/packages.x64"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
SHELL="/bin/bash"
USE="acl acpi alsa amd64 berkdb bzip2 cairo cli cpudetection crypt cups curl cxx dbus dri elogind exif fam flac fortran gdbm gif glib gnutls gzip iconv ipv6 jpeg jpeg2k libglvnd libnotify libtirpc lua lzma lzo mad mbox memlimit mmx mmxext mng mp3 mp4 mpeg mtp multilib ncurses nls nptl ogg opengl openh264 openmp oss pam pcmcia pcre pdf png policykit posix pulseaudio quicktime raw readline recode sasl seccomp smp split-usr sqlite sqlite3 sse sse2 sse3 ssh ssl ssse3 startup-notification svg tcpd threads tiff truetype udev udisks unicode usb v4l v4l2 vim-syntax vorbis wifi wmf xattr xcb xinerama xinetd xv zlib zstd" ABI_X86="64" ADA_TARGET="gnat_2020" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext sse sse2" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput" KERNEL="linux" L10N="ru en-US ru ru-RU" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-4 php8-0" POSTGRES_TARGETS="postgres12 postgres13" PYTHON_SINGLE_TARGET="python3_10" PYTHON_TARGETS="python3_10" QEMU_USER_TARGETS="i386 x86_64 arm armeb" RUBY_TARGETS="ruby27" USERLAND="GNU" VIDEO_CARDS="amdgpu fbdev intel nouveau radeon radeonsi vesa dummy v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq proto steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  ADDR2LINE, AR, ARFLAGS, AS, ASFLAGS, CC, CCLD, CONFIG_SHELL, CPP, CPPFLAGS, CTARGET, CXX, CXXFILT, ELFEDIT, EMERGE_DEFAULT_OPTS, EXTRA_ECONF, F77FLAGS, FC, GCOV, GPROF, INSTALL_MASK, LD, LEX, LFLAGS, LIBTOOL, MAKE, MAKEFLAGS, NM, OBJCOPY, OBJDUMP, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, RANLIB, READELF, RUSTFLAGS, SIZE, STRINGS, STRIP, YACC, YFLAGS




Comment 1


Sam James









          2023-08-17 05:22:11 UTC
        

Could you:
1. include the build.log up to the point you kill it
2. include `ps faux` output before you kill it, when it's hanging?

Thanks!




Comment 2


vyp08





          2023-08-17 10:56:18 UTC
        

Created attachment 868080 [details]
build.log




Comment 3


vyp08





          2023-08-17 10:56:43 UTC
        

Created attachment 868081 [details]
ps_faux.log




Comment 4


Ben Kohler






          2023-08-17 15:03:41 UTC
        

How long are you letting that run?  It's single threaded and on my i5-3570 it runs for about 6 minutes on that check_hd call.




Comment 5


vyp08





          2023-08-18 05:18:50 UTC
        

Created attachment 868097 [details]
time e1 hwinfo

On my i7-3770 8m22s (see time_e1_info.txt).
I'm sorry I was so impatient.
Thank you very much for your help.
Issue is resolved.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

