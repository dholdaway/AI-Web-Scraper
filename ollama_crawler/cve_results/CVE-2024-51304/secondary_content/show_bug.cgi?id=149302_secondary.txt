Title: 149302 – wxGTK-2.6.3.3 fails with MAKEOPTS too high
URL: https://bugs.gentoo.org/show_bug.cgi?id=149302

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 149302
wxGTK-2.6.3.3 fails with MAKEOPTS too high
Last modified: 2007-01-14 05:49:48 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 149302 
      - wxGTK-2.6.3.3 fails with MAKEOPTS too high


Summary:
wxGTK-2.6.3.3 fails with MAKEOPTS too high
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

PPC
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo wxWidgets project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-09-27 07:02 UTC by David Gurvich





      Modified:
    
2007-01-14 05:49 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



brihall









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


David Gurvich





          2006-09-27 07:02:26 UTC
        

Emerging with MAKEOPTS="-j5" would cause a failure due to an expected file being missing or a hard lock on my system.  Changing to -j3 worked.  I'm using a dual-processor G4 system and connected to an x86 machine with distcc, 3 jobs on local and 2 on x86.  Suggest a note in the ebuild about MAKEOPTS.
-----------------------------------------------------------
Portage 2.1.2_pre1-r3 (default-linux/ppc/ppc32/2006.0/G4, gcc-4.1.1/vanilla, glibc-2.4-r3, 2.6.18 ppc)
=================================================================
System uname: 2.6.18 ppc 7455, altivec supported
Gentoo Base System version 1.12.4
Last Sync: Wed, 27 Sep 2006 11:30:01 +0000
distcc 2.18.3 powerpc-unknown-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
app-admin/eselect-compiler: 2.0.0_rc2-r1
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.16
ACCEPT_KEYWORDS="ppc ~ppc"
AUTOCLEAN="yes"
CBUILD="powerpc-unknown-linux-gnu"
CFLAGS="-Os -mcpu=G4 -maltivec -mabi=altivec -fno-strict-aliasing -pipe -mlong-double-128"
CHOST="powerpc-unknown-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/eselect/compiler /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-Os -mcpu=G4 -maltivec -mabi=altivec -fno-strict-aliasing -pipe -mlong-double-128"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distcc distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LINGUAS="en_US"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /usr/local/overlays/migrated-java-experimental-overlay /usr/local/overlays/gcj-overlay"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="ppc X alsa altivec apache2 apm berkdb bitmap-fonts bogofilter bonobo cairo cdr cli crypt cups dbus dlloader dri dvd dvdr eds elibc_glibc emboss encode esd foomaticdb fortran gcj gdbm gif glitz gnome gpm gstreamer gtk gtkhtml hal imlib input_devices_evdev input_devices_keyboard input_devices_mouse ipv6 isdnlog java jpeg kde kdehiddenvisibility kernel_linux ldap libg++ libwww linguas_en_US mad mikmod motif mozilla mp3 mpeg ncurses nls nptl nptlonly ogg opengl pam pcre pdflib perl png pppd python qt qt3 qt4 quicktime readline reflection ruby sdl seamonkey session spell spl ssl svg tcpd tetex tiff truetype truetype-fonts type1-fonts udev unicode userland_GNU video_cards_ati video_cards_radeon vorbis xfs xml xmms xorg xprint xv zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Mart Raudsepp






          2006-09-27 12:58:44 UTC
        

Are there any specific cases in the build routine where it tends to fail?
I re-enabled parallel building for wxGTK-2.6.3.3 because I had no reason to believe it doesn't work and it was introduced without a note of the reason. I guess we now know the reason ;)

I would like to solve this by fixing the build system to work with a larger amount of build processes, rather than limiting it, but as I haven't been able to reproduce problems with MAKEOPTS over the course of 3 years here (albeit usually just -j2 or -j3, but occasionally more) I don't know exactly where the problem could be. I haven't heard any reports upstream (of which I'm part of) about this either, but it's a fair estimation that not many people compile from source with high -j setting other than us ;)

Can you please provide some build logs of the parts where it fails. Is it somewhat in consistent places, etc?

Thanks!




Comment 2


Mart Raudsepp






          2006-10-03 09:51:01 UTC
        

Based on a private e-mail to me from David, I conclude that his system is unstable, probably from hardware side :(
Other builds failing with kernel preemption on and while under high load, etc.
Please re-open if my conclusion is wrong.





Comment 3


Brian Hall





          2006-11-16 19:06:09 UTC
        

I was unable to emerge with MAKEOPTS=-j4, but -j1 worked fine. My hardware is quite stable, I've emerged several hundred packages in the last two days (accidentally deleted part of /usr/lib!)

Portage 2.1.2_rc1-r7 (default-linux/amd64/2006.0, gcc-4.1.1, glibc-2.5-r0, 2.6.16.31 x86_64)
=================================================================
System uname: 2.6.16.31 x86_64 Dual Core AMD Opteron(tm) Processor 165
Gentoo Base System version 1.12.6
Last Sync: Thu, 16 Nov 2006 09:50:01 +0000
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O3 -march=k8 -msse3 -fomit-frame-pointer -funit-at-a-time -frename-registers -mtune=athlon64 -fno-ident -pipe -ftree-vectorize -fweb -ftracer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-O3 -march=k8 -msse3 -fomit-frame-pointer -funit-at-a-time -frename-registers -mtune=athlon64 -fno-ident -pipe -ftree-vectorize -fweb -ftracer"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--nospinner"
FEATURES="autoconfig ccache digest distlocks metadata-transfer noinfo parallel-fetch strict"
GENTOO_MIRRORS="ftp://daisy/ http://gentoo.mirrors.pair.com/ http://mirror.datapipe.net/gentoo http://gentoo.osuosl.org/ http://gentoo.llarian.net/ http://distfiles.larrythecow.com/"
LANG="en_US"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive  --links  --safe-links  --perms  --times --compress --force --whole-file 		   --delete   --delete-after   --stats   --timeout=180    --exclude=/distfiles 		   --exclude=/local --exclude=/packages 		   --exclude-from=/etc/portage/rsync_excludes --delete-excluded"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="amd64 7zip X a52 aac abook acpi allegro alsa apm artworkextra asf bash-completion bitmap-fonts bzip2 ccache cdda cddb cdinstall cdio cdparanoia chroot cli cracklib crypt cups dedicated dga dillo dio dlloader dnd dri dvd dvdr dvdread effects elibc_glibc emboss emul-linux-x86 encode ext-png ext-zlib extensions fam fame fat ffmpeg firefox flac flatfile foomaticdb fortran gb gcj gd gdbm gif ginac glut glx gmail gmailtimestamps gpgme gpm gs gstreamer gtk gtk2 gzip hpn iconv imlib imlib2 inkjar input_devices_keyboard input_devices_mouse ipod isdnlog java jikes joystick jpeg jpeg2k kde kdehiddenvisibility kernel_linux keyscrub lame lcd lcms lesstif libdsk lm_sensors lynxkeymap lzo lzw lzw-tiff mad maildir matroska matrox mbox mcal md5sum mikmod mimencode mixer mmap mng mod moznocompose moznoirc moznomail mozsvg mozxmlterm mp3 mpeg mpeg2 mplayer musepack music ncurses net network nfs nptl nptlonly offensive ofx ogg oggvorbis on-the-fly-crypt opengl pam pam_chroot pam_console pam_timestamp parse-clocks pcre pdf perl physfs pic png ppds pppd python qt3 qt4 quicktime rar rdesktop readline reflection reiserfs rogue rtc sblive screen sdl seamless-hbars server session shorten skins sounds sox spell spl sse-filters ssl stream svg sysfs szip tcltk tcpd tga theora threads tiff transcode truetype truetype-fonts type1 type1-fonts ula200 usb userland_GNU uudeview v4l v4l2 vcd vfat video_cards_ati video_cards_mga video_cards_nv video_cards_radeon videos vlm vnc vorbis x11vnc xatrix xface xml xorg xosd xpm xscreensaver xv xvid xvmc yv12 zip zlib"
Unset:  CTARGET, INSTALL_MASK, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 4


Mart Raudsepp






          2006-11-17 03:51:15 UTC
        

(In reply to comment #3)
> I was unable to emerge with MAKEOPTS=-j4, but -j1 worked fine. My hardware is
> quite stable, I've emerged several hundred packages in the last two days
> (accidentally deleted part of /usr/lib!)

Please attach logs or I can't do anything about it, and check if the errors are the same or different in consequent tries (might want to check if they are the same or different with a bit higher MAKEOPTS too). If they are different, then the different logs could be of value as well.




Comment 5


Brian Hall





          2006-11-18 17:36:16 UTC
        

Well, I just emerged it again with MAKEOPTS=-j4, and it works fine this time.
Not sure why it failed the first time with j4, then worked with j1, and now works again with j4, unless it was ccache. Cleared the cache completely with "ccache -C", rebuilding w/ -j4...

Ack. Works fine.

I've had trouble building this package in the past as well. I think the ebuild should force MAKEOPTS=-j1, or at least suggest it.
 




Comment 6


Ryan Hill (RETIRED)






          2007-01-14 05:49:48 UTC
        

actually, i would rebuild my system with some sane C{XX}FLAGS first.

i can't reproduce this at all on x86 or amd64 with -j[2-5].  if you have a log of the failure, please attach it and reopen.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

