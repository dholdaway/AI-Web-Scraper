Title: 486356 – Hidden symbol reference breaks Solaris 11.1 bootstrap
URL: https://bugs.gentoo.org/show_bug.cgi?id=486356

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 486356
Hidden symbol reference breaks Solaris 11.1 bootstrap
Last modified: 2021-01-06 20:03:23 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 486356 
      - Hidden symbol reference breaks Solaris 11.1 bootstrap


Summary:
Hidden symbol reference breaks Solaris 11.1 bootstrap
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

Prefix Support

  (show other bugs)



Hardware:

All
        Solaris
      







Importance:
      
Normal
       major
      


Assignee:

Gentoo Prefix








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-09-28 19:03 UTC by Richard Yao (RETIRED)





      Modified:
    
2021-01-06 20:03 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Richard Yao (RETIRED)






          2013-09-28 19:03:56 UTC
        

__emutls_get_address is a hidden symbol and for some reason, recent mpfr ebuilds contain a reference to it, which breaks the rebuild of mpc during `emerge -e system`. I worked around this by installing dev-libs/mpfr-3.0.1_p4-r1 (with some minor changes to make the ebuild support prefix) during a manual bootstrap.

I subsequently found the same issue to break breaks x11-libs/pixman-0.30.2 when trying to build firefox. I tried fiddling with this manually, but I have not nailed down what is causing this to break yet.

$ x86_64-pc-solaris2.11-gcc -O2 -pipe -Wall -fno-strict-aliasing -fvisibility=hidden -o .libs/prng-test prng-test.o  ./.libs/libutils.a ../pixman/.libs/libpixman-1.so -lm -Wl,-rpath -Wl,/home/richard/gentoo/usr/lib
/home/richard/gentoo/usr/lib/gcc/x86_64-pc-solaris2.11/4.7.2/../../../../x86_64-pc-solaris2.11/bin/ld: .libs/prng-test: hidden symbol `__emutls_get_address' in /home/richard/gentoo/usr/lib/gcc/x86_64-pc-solaris2.11/4.7.2/libgcc_eh.a(emutls.o) is referenced by DSO
/home/richard/gentoo/usr/lib/gcc/x86_64-pc-solaris2.11/4.7.2/../../../../x86_64-pc-solaris2.11/bin/ld: final link failed: Bad value
collect2: error: ld returned 1 exit status

There is some very subtle thing wrong with the toolchain. I did not spot any significant difference upon a cursory comparisonw ith Linux.




Comment 1


Fabian Groffen






          2014-02-11 20:47:55 UTC
        

I wonder if this is solved by the care that the bootstrap takes to build some compilers to understand the symbols.




Comment 2


Fabian Groffen






          2021-01-06 20:03:23 UTC
        

I believe this has been fixed by a commit to binutils that made symbol versioning working again









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

