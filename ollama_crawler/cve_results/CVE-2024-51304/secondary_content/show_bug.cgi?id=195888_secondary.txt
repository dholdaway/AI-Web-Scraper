Title: 195888 – mail-filter/spamassassin-3.2.x spamd dies on 'check_main' module
URL: https://bugs.gentoo.org/show_bug.cgi?id=195888

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 195888
mail-filter/spamassassin-3.2.x spamd dies on 'check_main' module
Last modified: 2009-11-04 22:20:31 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 195888 
      - mail-filter/spamassassin-3.2.x spamd dies on 'check_main' module


Summary:
mail-filter/spamassassin-3.2.x spamd dies on 'check_main' module
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Gentoo Perl team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-10-14 20:25 UTC by Karel Hala





      Modified:
    
2009-11-04 22:20 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



mail









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Karel Hala





          2007-10-14 20:25:00 UTC
        

All of tested versions of sa 3.2 branch cannot run spamd process. Tested with these options: -u qscand -d -m 5 -H -x --siteconfigpath=/etc/spamassassin/local.cf -D

Process dies immidiately on this failure in logs:

check: no loaded plugin implements 'check_main': cannot scan! at /usr/lib/perl5/vendor_per
l/5.8.8/Mail/SpamAssassin/PerMsgStatus.pm line 164.

spamassassin -D --lint however does not report this error. It does not happen on 3.1 branch of SA. Have been googlin whole day however not have found any resolution out there...

Reproducible: Always

Steps to Reproduce:
1. tried to run as root
2. tried CPAN spamassassin version - same result
3. got back to 3.1.8 version

Actual Results:  
spamassassin 3.1.x spamd process runs ok.
spamassassin 3.2.x spamd process dies all the time

Expected Results:  
I expect get the process running.

Portage 2.1.3.9 (default-linux/x86/vserver, gcc-4.1.2, glibc-2.5-r4, 2.6.20-vs2.2.0-gentoo i686)
=================================================================
System uname: 2.6.20-vs2.2.0-gentoo i686 Intel(R) Xeon(R) CPU 3060 @ 2.40GHz
Timestamp of tree: Sat, 13 Oct 2007 23:50:01 +0000
app-shells/bash:     3.2_p17
dev-lang/python:     2.4.4-r5
dev-python/pycrypto: 2.0.1-r6
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1, 1.10
sys-devel/binutils:  2.17-r1
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r2
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=i686 -O2 -pipe -ftracer -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /var/bind /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-march=i686 -O2 -pipe -ftracer -fomit-frame-pointer"
DISTDIR="/usr/distfiles"
FEATURES="buildpkg ccache distlocks metadata-transfer notitles sandbox sfperms strict unmerge-orphans userfetch usersandbox"
GENTOO_MIRRORS="ftp://ftp.sh.cvut.cz/MIRRORS/gentoo http://gentoo.oregonstate.edu http://gentoo.inode.at http://www.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j1"
PKGDIR="/usr/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="acl bash-completion berkdb bitmap-fonts bzip2 bzlib caps cli cracklib crypt foomaticdb fortran gif iconv isdnlog logrotate midi mmx mrtg mudflap ncurses nls nptl nptlonly openmp pam pcre perl pie png pppd pwdb python qmail readline reflection session slang snmp sockets spamassassin spl sse ssl tcpd truetype-fonts type1-fonts unicode usb x86 xorg zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="apm ark chips cirrus cyrix dummy fbdev glint i128 i740 i810 imstt mach64 mga neomagic nsc nv r128 radeon rendition s3 s3virge savage siliconmotion sis sisusb tdfx tga trident tseng v4l vesa vga via vmware voodoo"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Kai Dietrich





          2009-03-08 15:51:00 UTC
        

I have that, too

maybe it has something to do with the emerge process, I get an error there:

...
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/share/man/man1/spamd.1
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/share/man/man1/spamc.1
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/share/man/man1/sa-update.1
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/bin/sa-compile
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/bin/spamc
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/bin/sa-learn
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/bin/spamassassin
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/bin/spamd
Installing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/usr/bin/sa-update
Writing /var/tmp/portage/mail-filter/spamassassin-3.2.5/image//usr/lib/perl5/vendor_perl/5.8.8/i686-linux/auto/Mail/SpamAssassin/.packlist
sed: can't read /var/tmp/portage/mail-filter/spamassassin-3.2.5/image//etc/mail/spamassassin/init.pre: No such file or directory
cp: cannot create regular file `/var/tmp/portage/mail-filter/spamassassin-3.2.5/image//etc/mail/spamassassin/secrets.cf.example': No such file or directory
chmod: cannot access `/var/tmp/portage/mail-filter/spamassassin-3.2.5/image//etc/mail/spamassassin/secrets.cf.example': No such file or directory
/var/tmp/portage/mail-filter/spamassassin-3.2.5/temp/environment: line 2510: /var/tmp/portage/mail-filter/spamassassin-3.2.5/image//etc/mail/spamassassin/local.cf.example: No such file or directory
/var/tmp/portage/mail-filter/spamassassin-3.2.5/temp/environment: line 2511: /var/tmp/portage/mail-filter/spamassassin-3.2.5/image//etc/mail/spamassassin/local.cf.example: No such file or directory
/var/tmp/portage/mail-filter/spamassassin-3.2.5/temp/environment: line 2512: /var/tmp/portage/mail-filter/spamassassin-3.2.5/image//etc/mail/spamassassin/local.cf.example: No such file or directory
/var/tmp/portage/mail-filter/spamassassin-3.2.5/temp/environment: line 2513: /var/tmp/portage/mail-filter/spamassassin-3.2.5/image//etc/mail/spamassassin/local.cf.example: No such file or directory
>>> Completed installing spamassassin-3.2.5 into /var/tmp/portage/mail-filter/spamassassin-3.2.5/image/

strip: i686-pc-linux-gnu-strip --strip-unneeded -R .comment
   usr/bin/spamc
ecompressdir: bzip2 -9 /usr/share/man

>>> Installing mail-filter/spamassassin-3.2.5
 * checking 110 files for package collisions
--- /usr/
--- /usr/lib/
--- /usr/lib/perl5/
--- /usr/lib/perl5/vendor_perl/
--- /usr/lib/perl5/vendor_perl/5.8.8/
>>> /usr/lib/perl5/vendor_perl/5.8.8/spamassassin-run.pod
--- /usr/lib/perl5/vendor_perl/5.8.8/Mail/
>>> /usr/lib/perl5/vendor_perl/5.8.8/Mail/SpamAssassin.pm
--- /usr/lib/perl5/vendor_perl/5.8.8/Mail/SpamAssassin/
>>> /usr/lib/perl5/vendor_perl/5.8.8/Mail/SpamAssassin/AutoWhitelist.pm
>>> /usr/lib/perl5/vendor_perl/5.8.8/Mail/SpamAssassin/BayesStore.pm
...





Comment 2


Kai Dietrich





          2009-03-08 16:01:48 UTC
        

I can also reproduce this with spamassassin-3.1.8-r1. 

$ perl --version
This is perl, v5.8.8 built for i686-linux

It seems to have something to do with the UTF8 thing in the merge message. When I call:
$ echo $LANG
en_US.utf8
$ LANG=en_US spamassassin -D --lint

it works




Comment 3


Kai Dietrich





          2009-03-10 07:27:41 UTC
        

So, now I have it fixed and my spamassassin 3.2.1-r1 (patched ebuild) working. The problem for me was, that the ebuild didn't install the sys rules in /etc/mail/spamassassin/. With the proposed patch from:
http://forums.gentoo.org/viewtopic-t-744239.html
I got it working.




Comment 4


David Abbott (RETIRED)






          2009-11-04 22:20:31 UTC
        

Is this still a problem? 3.2.5-r1 seems to work fine here for me. I am going to close the bug but please reopen if needed.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

