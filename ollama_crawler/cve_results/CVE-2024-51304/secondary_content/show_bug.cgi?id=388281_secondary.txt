Title: 388281 – app-text/djvu-3.5.24 build failed, missing hi22-djvu.png, and others too
URL: https://bugs.gentoo.org/show_bug.cgi?id=388281

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 388281
app-text/djvu-3.5.24 build failed, missing hi22-djvu.png, and others too
Last modified: 2011-11-28 18:26:33 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 388281 
      - app-text/djvu-3.5.24 build failed, missing hi22-djvu.png, and others too


Summary:
app-text/djvu-3.5.24 build failed, missing hi22-djvu.png, and others too
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Peter Volkov (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-10-23 22:15 UTC by Łukasz Stelmach





      Modified:
    
2011-11-28 18:26 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



tex









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Łukasz Stelmach





          2011-10-23 22:15:39 UTC
        

src_install assumes hiXX-djvu.png files are present in the desktopfiles directory while the files are actually named prebuild-hiXX-djvu.png

Reproducible: Always

Steps to Reproduce:
emerge -1 =app-text/djvu-3.5.24
Actual Results:  
fail.

Expected Results:  
success.




Comment 1


Rafał Mużyło





          2011-10-23 22:42:58 UTC
        

That's wrong.
Those files should be built by 'rsvg' (from librsvg) and 'convert' (from imagemagick).

On the other hand though, if either of those programs failed, the prebuilt-* files should be copied to those names...at least if it were not for '--disable-desktopfiles'.

So it seems the build hack in the ebuild should be modified.




Comment 2


Peter Volkov (RETIRED)






          2011-10-24 13:20:02 UTC
        

Thank you for report Łukasz. This is duplicate of bug 378547 but... really I wonder how this could fail:

s=`echo hi22-djvu.png | sed -e 's/[a-z]*\([0-9]*\).*/\1/'`; \
  /usr/bin/rsvg -w ${s} -h ${s} djvu.svg hi22-djvu.png \
          || /usr/bin/convert -geometry ${s}x${s} -depth 8 -background none djvu.svg hi22-djvu.png \
  || cp ./prebuilt-hi22-djvu.png hi22-djvu.png

Could you in the /var/tmp/portage/app-text/djvu-3.5.24/work/djvulibre-3.5.24/desktopfiles catalog run the following commands and show me output:

/usr/bin/rsvg -w 22 -h 22 djvu.svg hi22-djvu.png  && echo true
/usr/bin/convert -geometry 22x22 -depth 8 -background none djvu.svg hi22-djvu.png && echo true
cp ./prebuilt-hi22-djvu.png hi22-djvu.png && echo true




Comment 3


Łukasz Stelmach





          2011-10-25 23:29:48 UTC
        

All the commands say "true", and the package merges just fine. Today. It looks like there was something wrong with my environment yesterday. It is quite probable explanation because I was doing massive upgrade and something might have been wrong.

On the other hand it was the installation function that failed and not the one that is supposed to create those files. Might this be considered a bug too?




Comment 4


Samuli Suominen (RETIRED)






          2011-11-28 18:26:33 UTC
        

(In reply to comment #3)
> All the commands say "true", and the package merges just fine. Today. It looks
> like there was something wrong with my environment yesterday. It is quite
> probable explanation because I was doing massive upgrade and something might
> have been wrong.

closing as worksforme then.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

