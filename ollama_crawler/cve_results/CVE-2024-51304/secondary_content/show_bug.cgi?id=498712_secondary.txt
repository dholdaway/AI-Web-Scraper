Title: 498712 – [gentoo-haskell overlay] =dev-haskell/missingh-1.2.0.2 -  Dependency issues
URL: https://bugs.gentoo.org/show_bug.cgi?id=498712

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 498712
[gentoo-haskell overlay] =dev-haskell/missingh-1.2.0.2 -  Dependency issues
Last modified: 2014-01-21 19:47:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 498712 
      - [gentoo-haskell overlay] =dev-haskell/missingh-1.2.0.2 -  Dependency issues


Summary:
[gentoo-haskell overlay] =dev-haskell/missingh-1.2.0.2 -  Dependency issues
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Development

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo's Haskell Language team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-01-20 17:43 UTC by Jason Mours





      Modified:
    
2014-01-21 19:47 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (missingh-1.2.0.2-build.log,7.26 KB,
                text/plain)

            
2014-01-20 17:44 UTC,

            Jason Mours




Details





emerge-info

              (missingh-1.2.0.2-emerge.info,17.88 KB,
                text/plain)

            
2014-01-20 17:44 UTC,

            Jason Mours




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jason Mours





          2014-01-20 17:43:54 UTC
        

Having problems getting dev-haskell/missingh-1.2.0.2 [gentoo-haskell] to emerge. It's complaining about the following missing dependencies. :

setup: The following installed packages are broken because other packages they
depend on are missing. These broken packages must be rebuilt before they can
be used.
package hslogger-1.2.3 is broken due to missing package
network-2.4.2.2-e813f669dccdc08a1bbf5734308a31f6
There are problems in package texmath-0.6.5.2:
  Warning: haddock-interfaces: /usr/share/doc/texmath-0.6.5.2/html/texmath.haddock doesn't exist or isn't a file
  Warning: haddock-html: /usr/share/doc/texmath-0.6.5.2/html doesn't exist or isn't a directory
  dependency "parsec-3.1.4-be9175971fa77db921dcca4865fcda3d" doesn't exist
There are problems in package MissingH-1.2.0.2:
  Warning: haddock-interfaces: /usr/share/doc/missingh-1.2.0.2/html/MissingH.haddock doesn't exist or isn't a file
  Warning: haddock-html: /usr/share/doc/missingh-1.2.0.2/html doesn't exist or isn't a directory
  dependency "network-2.4.2.2-e813f669dccdc08a1bbf5734308a31f6" doesn't exist
  dependency "parsec-3.1.4-be9175971fa77db921dcca4865fcda3d" doesn't exist
There are problems in package hslogger-1.2.3:
  Warning: haddock-interfaces: /usr/share/doc/hslogger-1.2.3/html/hslogger.haddock doesn't exist or isn't a file
  Warning: haddock-html: /usr/share/doc/hslogger-1.2.3/html doesn't exist or isn't a directory
  dependency "network-2.4.2.2-e813f669dccdc08a1bbf5734308a31f6" doesn't exist
There are problems in package hS3-0.5.8:
  Warning: haddock-interfaces: /usr/share/doc/hs3-0.5.8/html/hS3.haddock doesn't exist or isn't a file
  Warning: haddock-html: /usr/share/doc/hs3-0.5.8/html doesn't exist or isn't a directory
  dependency "HTTP-4000.2.10-6937df1ba5b35c02b3dfcb5b864eea4b" doesn't exist
  dependency "hxt-9.3.1.2-90ba7bcac9f83e9fecfa81ddc2586598" doesn't exist
  dependency "network-2.4.2.2-e813f669dccdc08a1bbf5734308a31f6" doesn't exist
There are problems in package fastcgi-3001.0.2.4:
  Warning: haddock-interfaces: /usr/share/doc/fastcgi-3001.0.2.4/html/fastcgi.haddock doesn't exist or isn't a file
  Warning: haddock-html: /usr/share/doc/fastcgi-3001.0.2.4/html doesn't exist or isn't a directory
  dependency "cgi-3001.1.8.4-7f796c0f5ac0cd3805d8295e746794f7" doesn't exist
There are problems in package ConfigFile-1.1.1:
  Warning: haddock-interfaces: /usr/share/doc/configfile-1.1.1/html/ConfigFile.haddock doesn't exist or isn't a file
  Warning: haddock-html: /usr/share/doc/configfile-1.1.1/html doesn't exist or isn't a directory
  dependency "parsec-3.1.4-be9175971fa77db921dcca4865fcda3d" doesn't exist
There are problems in package aeson-lens-0.5.0.0:
  Warning: haddock-interfaces: /usr/share/doc/aeson-lens-0.5.0.0/html/aeson-lens.haddock doesn't exist or isn't a file
  Warning: haddock-html: /usr/share/doc/aeson-lens-0.5.0.0/html doesn't exist or isn't a directory
  dependency "lens-3.10.1-f2a1a688ae9f513de42ca8fd2b5e920f" doesn't exist

The following packages are broken, either because they have a problem
listed above, or because they depend on a broken package.
texmath-0.6.5.2
MissingH-1.2.0.2
hslogger-1.2.3
hS3-0.5.8
fastcgi-3001.0.2.4
ConfigFile-1.1.1
aeson-lens-0.5.0.0

: It may be my system, I haven't had time to work with it. But it is out of the overlay and I saw a stabilization request. Hope this helps.

Posting build.log

Reproducible: Always




Comment 1


Jason Mours





          2014-01-20 17:44:31 UTC
        

Created attachment 368270 [details]
build.log




Comment 2


Jason Mours





          2014-01-20 17:44:45 UTC
        

Created attachment 368272 [details]
emerge-info




Comment 3


Michael Orlitzky






          2014-01-21 00:56:47 UTC
        

Please run haskell-updater, that should fix all of the broken packages. (If not, you can nuke it from outer space with haskell-updater --all)

Most haskell packages need to be rebuilt when any of their dependencies change. This is unfortunate but getting better with slot deps. When those don't work for whatever reason, you see stuff like:

  setup: The following installed packages are broken because other packages they
  depend on are missing. These broken packages must be rebuilt before they can
  be used.

That's your cue to run haskell-updater.




Comment 4


Sergei Trofimovich (RETIRED)






          2014-01-21 07:23:47 UTC
        

Yeah. I've added a notice right to the build log a while ago:

> Detected broken packages: aeson-lens-0.5.0.0 hS3-0.5.8 texmath-0.6.5.2 ConfigFile-1.1.1 MissingH-1.2.0.2 hslogger-1.2.3 fastcgi-3001.0.2.4
> ERROR: dev-haskell/missingh-1.2.0.2::gentoo-haskell failed (configure phase):
>    //==-- Please, run 'haskell-updater' to fix broken packages --==//

Looks like we need something more clear :]




Comment 5


Jason Mours





          2014-01-21 15:42:33 UTC
        

(In reply to Sergei Trofimovich from comment #4)
> Yeah. I've added a notice right to the build log a while ago:
> 
> > Detected broken packages: aeson-lens-0.5.0.0 hS3-0.5.8 texmath-0.6.5.2 ConfigFile-1.1.1 MissingH-1.2.0.2 hslogger-1.2.3 fastcgi-3001.0.2.4
> > ERROR: dev-haskell/missingh-1.2.0.2::gentoo-haskell failed (configure phase):
> >    //==-- Please, run 'haskell-updater' to fix broken packages --==//
> 
> Looks like we need something more clear :]

So Ok haskell hound... I did rebuild all my haskell, but with a collection of installed haskell located in a file but outside of /var/tmp/portage/world. i.e. I used emerge and not haskell-updater

WHY? Let me try and explain the state of the machine. 

I have the graphite polyhedral for gcc i.e. ppl [cloog-ppl] built with linear programming [lpsol]. Recently they made glpk-4.48 a dependency for linear programming in ppl. I had it built withOUT this added dependency. Why is this a problem? Because I had already installed glpk.4.50, and cooked it into the system. glpk-4.50 is very different than glpk-4.48 and GHC being one of the programs that soak in glpk. If I downgrade I loose something that I'm building deep in the machine. GHC, COQ, python, scipy, sci-kits... this !would! /*/not could/*/ break some fragile things that are in place for when I MLTON, which was just released.

So! I had to remove ppl from my /var/tmp/portage/world and change it's USE= to USE=-lpsol, This is only to make portage happy, and because it WOULD remove linear programming from the polyhedral, I refuse to rebuild it. ARRRGGGHH!! No!... I will wait for someone to figure out glpk-4.51 and implement proper linear programming for the ppl. The polyhedral for graphite (not lto) is still used in linking as binutils uses it extensively thru-out. I trace and profile so the machine has learned alot and I can't throw 18 months of compile away.

Long story short (too late) , Any update from emerge -uDN or haskell-updater or revdep-rebuild demands that I rebuild ppl...So I have to work around it.

I'm in the process of porting this system to a new machine, where it was necessary to break the polyhedral, but I can't get to the haskell on it currently.

Sorry if it's a waste of time ;/ -- but I saw the stabilization request and running emerge @world created this error, but I know haskell-updater calculates dependencies differently.

Anyways... layover should have better metadata like mainstream portage, so portage can think about the [overlays] once and awhile...mine wants to go there all the time. After they hacked all the stamps out, a couple people said they lobotomized portage with portage-2.2 amputation of 2.1. Alot of learned metadata was pruned, stuff from packages not around anymore. GCC/GLIBC went C++...sigh... it was C89....Every play Alpha Centuri? Planet? The Fungus was a brain... portage metadata was looking like one too.




Comment 6


Sergei Trofimovich (RETIRED)






          2014-01-21 18:25:16 UTC
        

> Long story short (too late) , Any update from emerge -uDN or haskell-updater
> or revdep-rebuild demands that I rebuild ppl...So I have to work around it.

Hm, I can think of may ways fo trying to make portage forget about the
upgrade of precious packages:
1. simples one: '--exclude=ppl' option in emerge
   (can be used with haskell-updater like that: haskell-updater -- --exclude=ppl)
2. More hardcode one is to mask all the other ppl versions
   in /etc/portage/package.mask:
   <dev-libs/ppl-your-version
   >dev-libs/ppl-your-version

3. By default haskell-updater tries to traverse and update quite a
   lot of depends (it's usually a good thing), but to achieve minimal
  rebuild case you can drop every option from emerge like that:

    # emerge -av1 `haskell-updater -q -l` --keep-going

  I'd expect runnig it a few times should fix everything
  and not upgrade anything unrelated.

  Subslot changes try quite hard to trigger deep dependency
  traversals once occured, but when we ask to "just rebuld"
  packages it should not trigger.

Does that help?




Comment 7


Jason Mours





          2014-01-21 19:47:16 UTC
        

(In reply to Sergei Trofimovich from comment #6)
> > Long story short (too late) , Any update from emerge -uDN or haskell-updater
> > or revdep-rebuild demands that I rebuild ppl...So I have to work around it.
> 
> Hm, I can think of may ways fo trying to make portage forget about the
> upgrade of precious packages:
> 1. simples one: '--exclude=ppl' option in emerge
>    (can be used with haskell-updater like that: haskell-updater --
> --exclude=ppl)
> 2. More hardcode one is to mask all the other ppl versions
>    in /etc/portage/package.mask:
>    <dev-libs/ppl-your-version
>    >dev-libs/ppl-your-version
> 
> 3. By default haskell-updater tries to traverse and update quite a
>    lot of depends (it's usually a good thing), but to achieve minimal
>   rebuild case you can drop every option from emerge like that:
> 
>     # emerge -av1 `haskell-updater -q -l` --keep-going
> 
>   I'd expect runnig it a few times should fix everything
>   and not upgrade anything unrelated.
> 
>   Subslot changes try quite hard to trigger deep dependency
>   traversals once occured, but when we ask to "just rebuld"
>   packages it should not trigger.
> 
> Does that help?

Yes! haskell-updater showed that (just like the build.log ;/)dev-haskell/hslogger needed rebuilt before dev-haskell/missingh. So this bug can be closed. I apologize, I've been running into these problems as I follow you guys in the overlay, and I thought I had already rebuilt hslogger and hit a wall. I'm on alot of boxes lately, I'm getting lost.

However, as to your advise to usable portage build trees...my portage still wants to downgrade my sci-libs/glpk-4.50 to sci-libs/glpk-4.48 and break my GNU linear programming. No matter what,

# haskell-updater -- --exclude=ppl --exclude=glpk 

Shows that I still have the <=sci-libs/glpk-4.48 masked and requests and unmask. The problem is in the USE=lpsol flag for ppl. It's built in and has a dependency, there is no way to get portage to look around it. No matter what agent is used, and esepecically the 'updaters' revdep-rebuld and haskell-updater.

Anyways, I digress... The package to be rebuilt is on the top of the list. Updater or no, sorry for wasting your time.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

