Title: 177708 – sys-apps/busybox-1.4.1-r2 ebuild fails
URL: https://bugs.gentoo.org/show_bug.cgi?id=177708

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 177708
sys-apps/busybox-1.4.1-r2 ebuild fails
Last modified: 2007-08-30 15:17:19 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 177708 
      - sys-apps/busybox-1.4.1-r2 ebuild fails


Summary:
sys-apps/busybox-1.4.1-r2 ebuild fails
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

PPC
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Embedded Gentoo Team








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

190779

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2007-05-08 20:00 UTC by Tom Lloyd





      Modified:
    
2007-08-30 15:17 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



isit81
james.barford









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Tom Lloyd





          2007-05-08 20:00:58 UTC
        

busybox-1.4.1-r2 ebuild fails on powerpc-gentoo-linux-uclibc with the following messages:


<-- SNIP -->
  CC      miscutils/nmeter.o
  CC      miscutils/raidautorun.o
  CC      miscutils/readahead.o
miscutils/readahead.c: In function 'readahead_main':
miscutils/readahead.c:26: warning: implicit declaration of function 'readahead'
  CC      miscutils/runlevel.o
  CC      miscutils/rx.o
  CC      miscutils/setsid.o
<-- SNIP -->
  CC      util-linux/switch_root.o
  CC      util-linux/umount.o
  AR      util-linux/lib.a
  LINK    busybox_unstripped
miscutils/lib.a(readahead.o): In function `readahead_main':
readahead.c:(.text.readahead_main+0x58): undefined reference to `readahead'
collect2: ld returned 1 exit status
make: *** [busybox_unstripped] Error 1

!!! ERROR: sys-apps/busybox-1.4.1-r2 failed.
Call stack:
  ebuild.sh, line 1614:   Called dyn_compile
  ebuild.sh, line 971:   Called qa_call 'src_compile'
  environment, line 3330:   Called src_compile
  busybox-1.4.1-r2.ebuild, line 173:   Called die

!!! build failed
!!! If you need support, post the topmost build error, and the call stack if relevant.
!!! A complete build log is located at '/var/tmp/portage/sys-apps/busybox-1.4.1-r2/temp/build.log'.


I can attach the whole lot if it'll be useful.

Reproducible: Always

Steps to Reproduce:
1.emerge sys-apps/busybox



emerge --info:
Portage 2.1.2.2 (uclibc/ppc/2.4, gcc-4.1.1, uclibc-0.9.28-r1, 2.6.19-efika ppc)
=================================================================
System uname: 2.6.19-efika ppc G2_LE
Gentoo Base System release 1.12.9
Timestamp of tree: Tue, 08 May 2007 14:50:01 +0000
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.61
sys-devel/automake:  1.6.3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.4.26-r1
ACCEPT_KEYWORDS="ppc"
AUTOCLEAN="yes"
CBUILD="powerpc-gentoo-linux-uclibc"
CFLAGS="-Os -pipe"
CHOST="powerpc-gentoo-linux-uclibc"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/terminfo"
CXXFLAGS="-Os -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer nodoc noinfo noman sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LDFLAGS="-Wl,-z,relro"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://10.0.0.2/gentoo-portage"
USE="bitmap-fonts bzip2 cli cracklib dri embedded fastcgi gd ipv6 midi mysql ncurses pcre php ppc readline reflection session spl ssl truetype-fonts type1-fonts uclibc uclibc-compat xorg zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="uclibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="dummy fbdev v4l"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LINGUAS, MAKEOPTS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY


...and with any luck, this won't be a dupe.  Filed a bug earlier today, and it was marked as dupe - even though the bug it was duping never showed up in a search for the name of the package in question.  I'll file a "meta-bug" if that happens again.




Comment 1


James Barford





          2007-05-21 06:47:56 UTC
        

same build error, different arch:

LINK    busybox_unstripped
miscutils/lib.a(readahead.o): In function `readahead_main':
readahead.c:(.text.readahead_main+0x50): undefined reference to `readahead'
collect2: ld returned 1 exit status
make: *** [busybox_unstripped] Error 1

emerge --info
Portage 2.1.2.7 (uclibc/arm, gcc-3.4.6, uclibc-0.9.28-r0, 2.6.14-rc2 armv5teb)
=================================================================
System uname: 2.6.14-rc2 armv5teb XScale-IXP42x Family rev 1 (v5b)
Gentoo Base System version 1.12.5
Timestamp of tree: Sun, 20 May 2007 09:00:01 +0000
distcc 2.18.3 armeb-softfloat-linux-uclibc (protocols 1 and 2) (default port 3632) [disabled]
dev-lang/python:     2.3.5, 2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/confcache:  0.4.2-r1
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.13-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.20-r2
ACCEPT_KEYWORDS="arm"
AUTOCLEAN="yes"
CBUILD="armeb-softfloat-linux-uclibc"
CFLAGS="-march=armv5t -mtune=xscale -Os"
CHOST="armeb-softfloat-linux-uclibc"
CONFIG_PROTECT="/etc /var/bind"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-march=armv5t -mtune=xscale -Os"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg distlocks metadata-transfer nodoc noinfo noman sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="apache2 arm bitmap-fonts cli cracklib dri ithreads jpeg midi mudflap mysql ncurses openmp pcre php readline reflection samba session snmp spl truetype-fonts type1-fonts uclibc usb xorg zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="uclibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="dummy fbdev v4l"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY






Comment 2


James Barford





          2007-05-22 06:49:57 UTC
        

Found this bug report:

http://bugs.uclibc.org/view.php?id=1145

Not an exact match, the last post sugested disabling the readahead applet. Not a great solution but it builds once that is done.

.config
<snip>
# CONFIG_READAHEAD=y
</snip>

Is the readahead applet needed?

I couldnt find the missing readahead() function in my system includes (/usr/include), from a quick google its meant to be defined in fcntl.h. Maybe the uclibc install is missing this function ?




Comment 3


solar (RETIRED)






          2007-05-22 14:22:32 UTC
        

(In reply to comment #2)

Upgrade your uclibc.




Comment 4


Jakub Moc (RETIRED)






          2007-08-30 13:52:38 UTC
        

*** Bug 190779 has been marked as a duplicate of this bug. ***




Comment 5


Alfonso Tarantini





          2007-08-30 15:17:19 UTC
        

(In reply to comment #3)
> (In reply to comment #2)
> 
> Upgrade your uclibc.
> 

I confirm upgrading to uclibc version 0.9.28.3 resolved the issue.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

