Title: 275934 – net-mail/dovecot: inotify ebuild patch
URL: https://bugs.gentoo.org/show_bug.cgi?id=275934

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 275934
net-mail/dovecot: inotify ebuild patch
Last modified: 2009-10-06 14:52:04 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 275934 
      - net-mail/dovecot: inotify ebuild patch


Summary:
net-mail/dovecot: inotify ebuild patch
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Wolfram Schlich (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-06-30 11:49 UTC by p0





      Modified:
    
2009-10-06 14:52 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



H4xX0Rz1sT
net-mail+disabled









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


p0





          2009-06-30 11:49:08 UTC
        

Dovecot comes with inotify support, but this is not enabled by ebuild by default. this patch adds support for the inotify use-flag and enables inotify support during configuration.

------------

--- /usr/portage/net-mail/dovecot/dovecot-1.1.16.ebuild	2009-06-09 09:01:35.000000000 +0200
+++ dovecot-1.1.16-r99.ebuild	2009-06-30 13:41:52.000000000 +0200
@@ -25,7 +25,7 @@
 LICENSE="LGPL-2.1"
 KEYWORDS="~alpha ~amd64 ~ppc ~sparc ~x86 ~x86-fbsd"
 
-IUSE="berkdb debug doc ipv6 kerberos ldap managesieve mbox mysql pop3d pam postgres sieve sqlite3 ssl suid vpopmail"
+IUSE="berkdb debug doc inotify ipv6 kerberos ldap managesieve mbox mysql pop3d pam postgres sieve sqlite3 ssl suid vpopmail"
 
 # Developer documentation, controlled by the doc USE flag
 DEVDOCS="auth-protocol index multiaccess securecoding"
@@ -76,6 +76,7 @@
 		--with-poll=best \
 		$(use_with berkdb db) \
 		$(use_enable debug) \
+		$(use_with inotify notify=inotify) \
 		$(use_enable ipv6) \
 		$(use_with kerberos gssapi) \
 		$(use_with ldap) \


Reproducible: Always

Steps to Reproduce:




Comment 1


Oliver Sucker





          2009-07-03 21:00:41 UTC
        

(In reply to comment #0)
> Dovecot comes with inotify support, but this is not enabled by ebuild by
> default. this patch adds support for the inotify use-flag and enables inotify
> support during configuration.
> 
> ------------
> 
> --- /usr/portage/net-mail/dovecot/dovecot-1.1.16.ebuild 2009-06-09
> 09:01:35.000000000 +0200
> +++ dovecot-1.1.16-r99.ebuild   2009-06-30 13:41:52.000000000 +0200
> @@ -25,7 +25,7 @@
>  LICENSE="LGPL-2.1"
>  KEYWORDS="~alpha ~amd64 ~ppc ~sparc ~x86 ~x86-fbsd"
> 
> -IUSE="berkdb debug doc ipv6 kerberos ldap managesieve mbox mysql pop3d pam
> postgres sieve sqlite3 ssl suid vpopmail"
> +IUSE="berkdb debug doc inotify ipv6 kerberos ldap managesieve mbox mysql pop3d
> pam postgres sieve sqlite3 ssl suid vpopmail"
> 
>  # Developer documentation, controlled by the doc USE flag
>  DEVDOCS="auth-protocol index multiaccess securecoding"
> @@ -76,6 +76,7 @@
>                 --with-poll=best \
>                 $(use_with berkdb db) \
>                 $(use_enable debug) \
> +               $(use_with inotify notify=inotify) \
>                 $(use_enable ipv6) \
>                 $(use_with kerberos gssapi) \
>                 $(use_with ldap) \
> 
> 
> Reproducible: Always
> 
> Steps to Reproduce:
> 

this patch is obsolete. configure defaults to 'best' notify, which is inotify.
also, setting flag 'inotify' is not very friendly to portability.

---configure --help
[...]
  --with-notify=NOTIFY    Specify the file system notification method to use
                          (inotify, kqueue, dnotify, none;
                           default is detected in the above order)
[...]
----

---output on configuring
[...]
checking whether we can use inotify... yes
[...]
File change notification method ..... : inotify
[...]
---

probably your kernel is outdated or misses inotify support or is missing inotify.h somehow?

saturn distfiles $ cat /usr/src/linux/.config|grep -i inotify
CONFIG_INOTIFY=y
CONFIG_INOTIFY_USER=y

saturn distfiles $ find /usr/src/linux -name 'inotify.h'
/usr/src/linux/include/linux/inotify.h
/usr/src/linux/include/config/inotify.h


HTH,
Oliver

@devs, please close.





Comment 2


Tomáš Chvátal (RETIRED)






          2009-10-06 14:52:04 UTC
        

(In reply to comment #1)

> this patch is obsolete. configure defaults to 'best' notify, which is inotify.
> also, setting flag 'inotify' is not very friendly to portability.
ACK
> 
> @devs, please close.
> 

As you wish :P

Closing per comment #1. Works here and should work perfecly for everyone.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

