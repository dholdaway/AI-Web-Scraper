Title: 176617 – gentoo-sources-2.6.20-r4: skb_over_panic when initializing ipw2200
URL: https://bugs.gentoo.org/show_bug.cgi?id=176617

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 176617
gentoo-sources-2.6.20-r4: skb_over_panic when initializing ipw2200
Last modified: 2007-04-30 20:46:35 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 176617 
      - gentoo-sources-2.6.20-r4: skb_over_panic when initializing ipw2200


Summary:
gentoo-sources-2.6.20-r4: skb_over_panic when initializing ipw2200
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo Kernel Bug Wranglers and Kernel Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-04-30 19:11 UTC by Martin von Gagern





      Modified:
    
2007-04-30 20:46 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



leopold









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Kernel panic screen

              (176617.1.txt,2.31 KB,
                text/plain)

            
2007-04-30 19:14 UTC,

            Martin von Gagern




Details





emerge --info

              (emerge--info.txt,2.94 KB,
                text/plain)

            
2007-04-30 19:47 UTC,

            Christopher Leopold




Details





lspci

              (lspci.txt,1.50 KB,
                text/plain)

            
2007-04-30 19:48 UTC,

            Christopher Leopold




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin von Gagern





          2007-04-30 19:11:33 UTC
        

I'm posting this bug here on behalf of a friend of mine. I'm posting here because the kernel guys don't want bug reports for patched kernels in their bugzilla, and so far we haven't tried this with vanilla sources.

The symptom was a system freeze during boot with caps lock and scroll lock blinking. Booting into single user mode worked fine, stepwise booting from there on localized the problem in the net.eth1 startup for an Intel PRO/Wireless 2200 WLAN controller causing a kernel panic. He took a picture of the screen using his digicam and copied the message from there, so there might be typos. The message started with "kernel BUG at net/core/skbuff.c:94!", I will attach it in full later on.

It is remarkable that the issue only occurred after compiling some additional modules for iptables, none of which were loaded when this error occurred. Strange coincidence or some weird interconnection between modules?

The problem went away when switching to the previous kernel.

It might be related with some other issue that caused the keyboard to lock up occasionally when the WLAN radio was switched on using a switch in the hardware. However in these situations the system did not freeze but stayed usable with mouse input only, and no blinking keyboard LEDs either.




Comment 1


Martin von Gagern





          2007-04-30 19:14:07 UTC
        

Created attachment 117757 [details]
Kernel panic screen

This is the kernel panic message, copied manually from a photo.




Comment 2


Jorge Manuel B. S. Vicetto (RETIRED)






          2007-04-30 19:24:03 UTC
        

Please add your friends' emerge --info.

Try cleaning the kernel tree and creating the same config. If the problem persists, try disabling/enabling options in the kernel config.




Comment 3


Bruno





          2007-04-30 19:30:18 UTC
        

(In reply to comment #0)
> It is remarkable that the issue only occurred after compiling some additional
> modules for iptables, none of which were loaded when this error occurred.
> Strange coincidence or some weird interconnection between modules?

Could you detail what you mean by this?

Is it recompiling with changed config and booting with updated kernel, or just make modules_install but not refreshing kernel image used for boot?

You should check if it still happens starting from a clean kernel source:
  make clean
  make
  make modules_install
  copy kernel and upate bootloader

Question: which ipw2200 driver is being used, in-kernel version or ebuild?




Comment 4


Martin von Gagern





          2007-04-30 19:35:39 UTC
        

(In reply to comment #3)
> (In reply to comment #0)
> > It is remarkable that the issue only occurred after compiling some additional
> > modules for iptables, none of which were loaded when this error occurred.
> > Strange coincidence or some weird interconnection between modules?
> 
> Could you detail what you mean by this?
> 
> Is it recompiling with changed config and booting with updated kernel, or just
> make modules_install but not refreshing kernel image used for boot?

What we were doing was this: Trying to get --status matches for iptables to work properly, we compiled the generic and IPv4 specific conntrac module as well as LOG and ULOG modules. We installed them using make modules_install, without touching the kernel image used for boot. That's why it seems so weird to me.

For your other questions I'm waiting for my friend to comment here himself.




Comment 5


Christopher Leopold





          2007-04-30 19:47:21 UTC
        

Created attachment 117763 [details]
emerge --info




Comment 6


Christopher Leopold





          2007-04-30 19:48:48 UTC
        

Created attachment 117765 [details]
lspci

And here the lspci if needed




Comment 7


Christopher Leopold





          2007-04-30 19:53:03 UTC
        

(In reply to comment #3)
> Question: which ipw2200 driver is being used, in-kernel version or ebuild?

the in-kernel with the ipw2200-firmware as ebuild.





Comment 8


Martin von Gagern





          2007-04-30 20:25:22 UTC
        

(In reply to comment #3)
> You should check if it still happens starting from a clean kernel source:
>   make clean
>   make
>   make modules_install
>   copy kernel and upate bootloader

This seems to have solved it. Strange! Thanks anyway!




Comment 9


Bruno





          2007-04-30 20:46:35 UTC
        

I assume the reason is incompatibility between "new" modules and "old" kernel due to built-in code that comes with the iptables modules you added.

In nearly all cases (to be on the safe side assume all cases) a reboot with new kernel image is required when recompiling to add/remove modules.

Often modules include some generic code inside of kernal image that does auto-loading of module or even add some fields to a few kernel memory structures (can cause corruption as meaning of bits change and there is risk of overflow)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

