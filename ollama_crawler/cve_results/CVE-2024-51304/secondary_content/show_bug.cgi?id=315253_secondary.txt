Title: 315253 – games-puzzle/enigma-1.01 crashes in ecl_video.cc with "Assertion `src !=0' failed" on startup
URL: https://bugs.gentoo.org/show_bug.cgi?id=315253

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 315253
games-puzzle/enigma-1.01 crashes in ecl_video.cc with "Assertion `src !=0' failed" on startup
Last modified: 2010-04-17 09:11:32 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 315253 
      - games-puzzle/enigma-1.01 crashes in ecl_video.cc with "Assertion `src !=0' failed" on startup


Summary:
games-puzzle/enigma-1.01 crashes in ecl_video.cc with "Assertion `src !=0' fa...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       major
      


Assignee:

Gentoo Games








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-04-14 11:17 UTC by Markus Walter





      Modified:
    
2010-04-17 09:11 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



bog









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Markus Walter





          2010-04-14 11:17:04 UTC
        

If I start enigma it crashes with the output

enigma: ecl_video.cc:313: virtual void ecl::Surface::blit(const ecl::GS&, int, int, const ecl::Surface*): Assertion `src != 0' failed.

I did a backtrace with gdb:

#0  0x00007ffff5c56315 in raise () from /lib/libc.so.6
#1  0x00007ffff5c57811 in abort () from /lib/libc.so.6
#2  0x00007ffff5c4f509 in __assert_fail () from /lib/libc.so.6
#3  0x000000000054642b in ecl::Surface::blit(ecl::GraphicsState const&, int, int, ecl::Surface const*) ()
#4  0x0000000000459aca in tolua_px_ecl_Drawable_blit00(lua_State*) ()
#5  0x0000000000459b15 in tolua_px_ecl_Drawable_blit01(lua_State*) ()
#6  0x00000000005547d6 in luaD_precall(lua_State*, lua_TValue*, int) ()
#7  0x00000000005636f1 in luaV_execute(lua_State*, int) ()
#8  0x0000000000554d35 in luaD_call(lua_State*, lua_TValue*, int) ()
#9  0x0000000000550956 in lua_call(lua_State*, int, int) ()
#10 0x0000000000568288 in luaB_dofile(lua_State*) ()
#11 0x00000000005547d6 in luaD_precall(lua_State*, lua_TValue*, int) ()
#12 0x00000000005636f1 in luaV_execute(lua_State*, int) ()
#13 0x0000000000554d35 in luaD_call(lua_State*, lua_TValue*, int) ()
#14 0x00000000005543ba in luaD_rawrunprotected(lua_State*, void (*)(lua_State*, void*), void*) ()
#15 0x0000000000554455 in luaD_pcall(lua_State*, void (*)(lua_State*, void*), void*, long, long) ()
#16 0x0000000000550772 in lua_pcall(lua_State*, int, int, int) ()
#17 0x00000000004520f0 in lua::DoAbsoluteFile(lua_State*, std::string const&) ()
#18 0x00000000004529fe in lua::DoGeneralFile(lua_State*, enigma::GameFS*, std::string const&) ()
#19 0x000000000041d17b in display::InitModels() ()
#20 0x0000000000424313 in display::Init() ()
#21 0x000000000045f015 in enigma::Application::init(int, char**) ()
#22 0x000000000045ffcf in main ()

The only thing on the internet I found related to this is the following gentoo-forum entry, where the problem simply vanishes after some time:

http://forums.gentoo.org/viewtopic-t-643427-start-0.html

Here now my emerge --info (I'm using a mostly stable system):

Portage 2.1.8.3 (default/linux/amd64/10.0/desktop, gcc-4.3.4, glibc-2.10.1-r1, 2.6.32-gentoo-r6 x86_64)
=================================================================
System uname: Linux-2.6.32-gentoo-r6-x86_64-Intel-R-_Core-TM-2_Quad_CPU_Q9400_@_2.66GHz-with-gentoo-2.0.1
Timestamp of tree: Wed, 14 Apr 2010 08:30:02 +0000
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p37
dev-java/java-config: 2.1.10
dev-lang/python:     2.6.4-r1
dev-util/ccache:     2.4-r7
dev-util/cmake:      2.6.4-r3
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.1-r1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.18-r3
sys-devel/gcc:       4.3.4
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.33
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=native"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe -march=native"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests ccache distlocks fixpackages news parallel-fetch protect-owned sandbox sfperms splitdebug strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="http://de-mirror.org/distro/gentoo/ http://gentoo.mneisen.org/ http://gentoo.supp.name/ http://gentoo.wheel.sk/ http://gentoo.mirror.pw.edu.pl/ http://mirror.mdfnet.se/mirror/gentoo http://gentoo.virginmedia.com/"
LDFLAGS="-Wl,-O1"
LINGUAS="de en"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi alsa amd64 bash-completion berkdb bluetooth branding bzip2 cairo cdr cli consolekit cracklib crypt css cups cxx dbus dri dts dvd dvdr emacs emboss encode exif fam ffmpeg firefox flac fortran gdbm gif gpm gtk hal iconv imagemagick ipv6 jpeg lcms ldap libnotify lock mad mikmod mmx mng modules mp3 mp4 mpeg mudflap multilib ncurses nls nptl nptlonly ogg opengl openmp pam pango pcre pdf perl png ppds pppd python qt3support readline reflection sdl session smp spell spl sse sse2 ssl ssse3 startup-notification svg sysfs tcpd theora threads thunar tiff truetype unicode usb vorbis x264 xcb xml xorg xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de en" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="fglrx" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

If I can provide any further information, let me know.




Comment 1


Markus Walter





          2010-04-16 19:19:10 UTC
        

I upgraded my system to current unstable and the crash went away (albeit it did not go away after only upgrading glibc to unstable, where the crash occured). Quite strange, but I can't reproduce the crash anymore :(




Comment 2


Khumba





          2010-04-17 09:11:32 UTC
        

Hello,

I was experiencing this bug too, also on amd64.  I discovered (via pygame) that media-libs/sdl-image was failing to link with the old, removed /usr/lib64/libjpeg.so.7.  Rebuilding sdl-image caused pygame to start working again (after rebuilding pygame, which probably did nothing).

After rebuilding both, enigma was working again.  Perhaps sdl-image is muffling a linking error message at runtime?

Furthermore, should enigma not depend on media-libs/sdl-image[jpeg] as well as [png]?  qlist shows /usr/share/games/enigma/gfx{32,40,48}/{inventory,menu_bg}.jpg, which enigma requires in-game.

(I am running stable of all relevant packages, as far as I know, the exception being =dev-libs/xerces-c-3.0.1-r1 ~amd64.)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

