Title: 166948 – unmerging app-text/libpaper breaks kde-base/kdegraphics
URL: https://bugs.gentoo.org/show_bug.cgi?id=166948

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 166948
unmerging app-text/libpaper breaks kde-base/kdegraphics
Last modified: 2007-02-15 11:07:15 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 166948 
      - unmerging app-text/libpaper breaks kde-base/kdegraphics


Summary:
unmerging app-text/libpaper breaks kde-base/kdegraphics
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       minor
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-02-15 02:26 UTC by Daiajo Tibdixious





      Modified:
    
2007-02-15 11:07 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --depclean

              (bug-depclean,3.40 KB,
                text/plain)

            
2007-02-15 09:59 UTC,

            Daiajo Tibdixious




Details





revdep-rebuild output

              (bug-revdep,1.09 KB,
                text/plain)

            
2007-02-15 10:03 UTC,

            Daiajo Tibdixious




Details





emerge -a1 kde-base/kdegraphics # first attempt

              (bug-kdegraphics-1,268.85 KB,
                text/plain)

            
2007-02-15 10:49 UTC,

            Daiajo Tibdixious




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Daiajo Tibdixious





          2007-02-15 02:26:41 UTC
        

# emerge --depclean -a
    :
>>> These are the packages that would be unmerged:

 app-text/libpaper
    selected: 1.1.20
   protected: none
     omitted: none

>>> 'Selected' packages are slated for removal.
>>> 'Protected' and 'omitted' packages will not be removed.

Would you like to unmerge these packages? [Yes/No] n

Quitting.

Packages installed:   431
Packages in world:    34
Packages in system:   57
Unique package names: 431
Required packages:    430
Number to remove:     1

I initially allowed libpaper to be removed.
revdep-rebuild then wanted to rebuild kde-base/kdegraphics which failed in compilation on libpaper (I don't have the exact error).
I restored libpaper via --usepkg however revdep-rebuild still complained.
Rebuilding libpaper from source THEN kdegraphics from source was the only procedure that got revdep-rebuild happy, however --depclean still wants to remove libpaper.

The workaround is to ignore --depclean.

Reproducible: Didn't try



Expected Results:  
--depclean should not try to remove libpaper

[I] app-text/libpaper
     Available versions:  1.1.20 ~1.1.21
     Installed:           1.1.20(11:48:59 AM 02/15/2007)
     Homepage:            http://packages.debian.org/unstable/source/libpaper
     Description:         Library for handling paper characteristics
[I] kde-base/kdegraphics
     Available versions:  (3.5)  3.5.5 3.5.5-r1 3.5.5-r2 ~3.5.6 ~3.5.6-r1
     Installed:           3.5.5-r2(3.5)(12:35:52 PM 02/15/2007)(-arts -debug -elibc_FreeBSD -gphoto2 -imlib -kdeenablefinal -openexr opengl pdf -povray -scanner -tetex xinerama)
     Homepage:            http://www.kde.org/
     Description:         KDE graphics-related apps
# emerge --info
Portage 2.1.2-r9 (default-linux/amd64/2006.1/desktop, gcc-4.1.1, glibc-2.5-r0, 2.6.18-gentoo-r6 x86_64)
=================================================================
System uname: 2.6.18-gentoo-r6 x86_64 AMD Athlon(tm) 64 Processor 3000+
Gentoo Base System release 1.12.9
Timestamp of tree: Wed, 14 Feb 2007 01:28:01 +0000
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-O2"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg distlocks fixpackages metadata-transfer parallel-fetch sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="en_US"
LC_ALL="en_US"
LINGUAS="en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X Xaw3d alsa amd64 avi berkdb bitmap-fonts cairo cdr cli cracklib crypt dbus directfb dlloader dri dts dvd dvdr dvdread eds emboss encode esd fam fbcon firefox fortran gdbm gif gpm gstreamer gtk gtk2 hal iconv ipv6 isdnlog javascript jpeg kde lesstif libg++ live livecd mad matroska midi mikmod mmx2 motif mp3 mpeg multislot musepack musicbrainz ncurses nls nptl nptlonly ogg oggvorbis opengl pam pcre pdf perl png ppds pppd python qt qt3 qt4 quicktime readline reflection sdl session spell spl ssl tcpd theora truetype truetype-fonts type1-fonts unicode usb vcd vim-with-x vorbis xanim xinerama xml xorg xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en" USERLAND="GNU" VIDEO_CARDS="radeon vesa fbdev"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


Jakub Moc (RETIRED)






          2007-02-15 07:42:27 UTC
        

app-text/libpaper is not a kdegraphics dependency at all, there's nothing wrong with --depclean.





Comment 2


Daiajo Tibdixious





          2007-02-15 09:59:16 UTC
        

Created attachment 110236 [details]
emerge --depclean

One of several attachements to reproduce the problem with details.
This has the depclean showing removal of app-text/libpaper-1.1.20




Comment 3


Daiajo Tibdixious





          2007-02-15 10:03:13 UTC
        

Created attachment 110238 [details]
revdep-rebuild output

This shows the revdep-rebuild output, showing that app-text/libpaper IS a dependency of kde-base/kdegraphics-3.5.5-r2 via /usr/kde/3.5/lib64/kde3/libkpdfpart.so
# equery belongs libkpdfpart.so
[ Searching for file(s) libkpdfpart.so in *... ]
kde-base/kdegraphics-3.5.5-r2 (/usr/kde/3.5/lib64/kde3/libkpdfpart.so)




Comment 4


Daiajo Tibdixious





          2007-02-15 10:49:13 UTC
        

Created attachment 110252 [details]
emerge -a1 kde-base/kdegraphics # first attempt

I thought I had lost the original kdegraphics rebuild error, however I had forgotted about /var/log/portage.
The attachment is /var/log/portage/kde-base:kdegraphics-3.5.5-r2:20070215-003419.log
which is my fist attempt to rebuild kdegraphics after revdep-rebuild reported it broken.
The actual error message is:
/usr/lib/libpaper.so: could not read symbols: File in wrong format
this seems to be a very bad error message as:
# ls -l /usr/lib/libpaper.so
ls: cannot access /usr/lib/libpaper.so: No such file or directory
the file is not there, so "file not found" would be more appropriate.




Comment 5


Daiajo Tibdixious





          2007-02-15 11:07:15 UTC
        

Trying to reproduce the problem I did
1. emerge --depclean
which removed libpaper
2. revdep-rebuild -p
which showed a kdegraphics rebuild required
3. emerge -a1 kdegraphics
which WORKED.
revdep-rebuild now shows no broken linkage.

I think when I first saw that kdegraphics was broken, I restored libpaper via --usepkg, which must have put back a corrupt /usr/lib/libpaper.so
and then got very confused.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

