Title: 100107 – emerge of blas-atlas-3.6.0 fails because em64t-enabled Pentium-4 is not detected correctly
URL: https://bugs.gentoo.org/show_bug.cgi?id=100107

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 100107
emerge of blas-atlas-3.6.0 fails because em64t-enabled Pentium-4 is not detected correctly
Last modified: 2005-07-24 07:20:19 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 100107 
      - emerge of blas-atlas-3.6.0 fails because em64t-enabled Pentium-4 is not detected correctly


Summary:
emerge of blas-atlas-3.6.0 fails because em64t-enabled Pentium-4 is not detec...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Science Related Packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-07-24 04:05 UTC by Shigeru Akiyama





      Modified:
    
2005-07-24 07:20 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



amd64









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Shigeru Akiyama





          2005-07-24 04:05:41 UTC
        

emerge of blas-atlas-3.6.0 on Gentoo x86_64 platform based on Pentium-4 630
fails. Compilation of ATLAS proceeds with strange compilation flags, like P4SSE2
and cache size 512KB, and it terminates with error messages.

Pentium 4 6XX-series has 2MB of L2 cache.

I found that ATLAS version 3.7.0 started to support EM64T and introduced a new
architecture name "P4E64SSE3" for Pentium 4 with 64-bit extension.

ATLAS 3.7.0 compiles successfully on my 64-bit Gentoo platform when parameters
are supplied manually.


Reproducible: Always
Steps to Reproduce:
1.emerge blas-atlas
2.
3.

Actual Results:  
1. CPU architecture is incorrectly detected as P4SSE2.
2. cache flush size 512KB is used instead of 4096KB, which is twice the size of
L2 cache size of Pentium 4 6XX-series.
3. compilation of ATLAS exits with error.


Expected Results:  
an ebuild of blas-atlas needs to check whether CFLAGS contains reference to
"nocona" option, and should exit immediately if yes. ATLAS version before 3.7.10
doesn't support EM64T. Also, L2 cache size must be supplied to ATLAS make file.

Portage 2.0.51.22-r2 (default-linux/amd64/2005.0, gcc-3.4.3, glibc-2.3.5-r0,
2.6.12-gentoo-r6 x86_64)
=================================================================
System uname: 2.6.12-gentoo-r6 x86_64 Intel(R) Pentium(R) 4 CPU 3.00GHz
Gentoo Base System version 1.6.13
dev-lang/python:     2.3.5
sys-apps/sandbox:    1.2.11
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.5
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.18-r1
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=nocona -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.4/env
/usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/
/usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/
/usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=nocona -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.ecc.u-tokyo.ac.jp/GENTOO http://mirror.gentoo.gr.jp
http://gentoo.gg3.net/ http://mirror.averse.net/pub/gentoo/
http://gentoo.channelx.biz/ http://gentoo.arcticnetwork.ca/
http://cudlug.cudenver.edu/gentoo/ http://ftp.gentoo.or.kr/
ftp://gg3.net/pub/linux/gentoo/ http://gentoo.mirrors.easynews.com/linux/gentoo/"
LINGUAS="en ja"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X alsa avi berkdb bitmap-fonts cdr crypt cups curl encode esd fam
foomaticdb fortran gdbm gif gnome gpm gtk gtk2 imagemagick imlib ipv6 java jpeg
kde libwww lzw lzw-tiff mp3 mpeg mysql ncurses nls opengl pam pdflib perl png
python qt quicktime readline ruby sdl slang spell ssl tcltk tcpd tetex tiff
truetype-fonts type1-fonts usb userlocales xine xml2 xmms xpm xv zlib linguas_en
linguas_ja userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, PORTDIR_OVERLAY




Comment 1


Danny van Dyk (RETIRED)






          2005-07-24 07:20:19 UTC
        

it's no possible to configure ATLAS automatically for each and every architecture.
However, you can always run:

interactive=1 emerge blas-atlas

which will allow you to configure everything manually.

Re a broken compilation: If you still can't compile atlas w/ your own
configuration, please reopen this bug.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

