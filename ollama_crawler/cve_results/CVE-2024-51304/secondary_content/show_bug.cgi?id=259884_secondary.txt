Title: 259884 – net-p2p/vuze crashes with sun-jdk-1.6 or icedtea6-bin
URL: https://bugs.gentoo.org/show_bug.cgi?id=259884

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 259884
net-p2p/vuze crashes with sun-jdk-1.6 or icedtea6-bin
Last modified: 2010-04-21 17:43:18 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 259884 
      - net-p2p/vuze crashes with sun-jdk-1.6 or icedtea6-bin


Summary:
net-p2p/vuze crashes with sun-jdk-1.6 or icedtea6-bin
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Java

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Java team








URL:



http://icedtea.classpath.org/bugzilla...
        




Whiteboard:




Keywords:









Duplicates (1):
    

285788

      (view as bug list)
    


Depends on:




307567 307973



Blocks:




icedtea-tracker



 

        Show dependency tree





 





      Reported:
    
2009-02-22 10:21 UTC by georgi





      Modified:
    
2010-04-21 17:43 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



darxus
gentoo-bugzilla
gnu_andrew









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Crash error log

              (hs_err_pid21878.log,55.02 KB,
                text/plain)

            
2009-02-22 10:22 UTC,

            georgi




Details





Crash error log 2

              (hs_err_pid2955.log,57.75 KB,
                text/plain)

            
2009-03-08 13:24 UTC,

            georgi




Details





icedtea6-1.5 crash log

              (hs_err_pid2868.log,56.36 KB,
                text/plain)

            
2009-06-28 13:01 UTC,

            georgi




Details





sun-jdk-1.6.0.14 crash log

              (hs_err_pid5421.log,55.31 KB,
                text/plain)

            
2009-06-29 05:33 UTC,

            georgi




Details





Show
              Obsolete (2)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


georgi





          2009-02-22 10:21:20 UTC
        

With icedtea6-bin-1.3.1-r1, Vuze is very stable for days. But with 1.4, after several hours (1-3 usually) it invariably disappears, even without heavy load. As far as I can tell from the error log, the JVM itself crashes, not Vuze, which I consider a very serious problem.

Attached is the error output, which I admittedly cannot quite understand.

I understand that 1.4 fixes security issues so using 1.3.1-r1 is not a good workaround.

emerge --info:

Portage 2.1.6.7 (default/linux/amd64/2008.0, gcc-4.3.3, glibc-2.9_p20081201-r2, 2.6.28-gentoo-r1 x86_64)
=================================================================                                       
System uname: Linux-2.6.28-gentoo-r1-x86_64-Intel-R-_Core-TM-2_CPU_6700_@_2.66GHz-with-glibc2.2.5       
Timestamp of tree: Sat, 21 Feb 2009 23:30:02 +0000                                                      
app-shells/bash:     3.2_p48-r1                                                                         
dev-java/java-config: 2.1.7                                                                             
dev-lang/python:     2.5.4-r2                                                                           
dev-util/cmake:      2.6.2-r1                                                                           
sys-apps/baselayout: 2.0.0                                                                              
sys-apps/openrc:     0.4.3-r1                                                                           
sys-apps/sandbox:    1.3.8                                                                              
sys-devel/autoconf:  2.13, 2.63                                                                         
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2                                          
sys-devel/binutils:  2.19.1                                                                             
sys-devel/gcc-config: 1.4.1                                                                             
sys-devel/libtool:   2.2.6a                                                                             
virtual/os-headers:  2.6.28-r1                                                                          
ACCEPT_KEYWORDS="amd64 ~amd64"                                                                          
CBUILD="x86_64-pc-linux-gnu"                                                                            
CFLAGS="-march=core2 -O2 -pipe"                                                                         
CHOST="x86_64-pc-linux-gnu"                                                                             
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/eselect/postgresql /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"                                        
CXXFLAGS="-march=core2 -O2 -pipe"                                                                                       
DISTDIR="/distfiles"                                                                                                    
EMERGE_DEFAULT_OPTS="--nospinner --with-bdeps y --alphabetical"                                                         
FEATURES="distlocks fixpackages protect-owned sandbox sfperms strict unmerge-orphans userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="en_US.UTF-8"
LC_ALL="en_US.UTF-8"
LDFLAGS="-Wl,-O1"
LINGUAS="en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac accessibility acpi alisp alsa amd64 amr amrnb amrwb ao archive asyncns audiofile bash-completion bios bluetooth boost branding bzip2 cairo calendar captury cdda cdio cgraph chm cli context cracklib crypt css curl cyrillic dbus dhcp dirac djbfft djvu doc dri dts dvd dvdr dvdread dynamic eap-tls emovix encode exif extra extrafilters fam fame fbcondecor ffmpeg fftw firefox fits flac fluidsynth fontconfig fpx games gd gdbm gif git glitz gnuplot gnutls graphics graphviz gs gtk hal hdri hpn htmlhandbook humanities hyperestraier ical iconv icu id3tag idea idn imagemagick inotify ipv6 isdnlog ithreads java java6 javascript jbig jce joystick jpeg jpeg2k jsapi kde kig-scripting kipi kpathsea ktts ladspa lame latex lcms libass libedit libffi libgcrypt libnotify libssh2 libwww lm_sensors lzo mad matroska mbrola midi mjpeg mmap mmx mmxext mng mod modplug mp3 mp4 mpeg mudflap multilib musepack music mysql ncurses network network-cron nls nptl nptlonly nuv odbc offensive ogg omega openal openexr opengl openmp oscar pam pango paste64 pcre pdf pg-intdatetime plotutils png portaudio postgres ppds pppd pstricks pth publishers pulseaudio python qemu qt3support qt4 quicktime rdesktop readline redland reflection rle rtsp sasl schroedinger science sdl sdl-image session slang smp sndfile sound soundtouch speex spell spl sql sqlite sqlite3 sse sse2 ssl ssse3 startup-notification stream subversion svg symlink sysfs theora threads tiff toolbar truetype unicode usb utempter vamp vcd vlc vlm vnc vorbis vorbis-psy wavpack webkit wideband wifi wmf x264 xcb xcomposite xetex xforms xml xmp xorg xscreensaver xulrunner xv xvid xvmc zip zlib zrtp" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en" USERLAND="GNU" VIDEO_CARDS="nvidia"
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


georgi





          2009-02-22 10:22:13 UTC
        

Created attachment 182769 [details]
Crash error log

Here is the error log.




Comment 2


Alistair Bush (RETIRED)






          2009-02-22 11:08:07 UTC
        

(In reply to comment #0)

> I understand that 1.4 fixes security issues so using 1.3.1-r1 is not a good
> workaround.

can you reproduce this with sun-jdk?




Comment 3


georgi





          2009-02-24 05:57:23 UTC
        

With sun-jdk-1.6.0.12 it works well and doesn't crash.




Comment 4


Vlastimil Babka (Caster) (RETIRED)






          2009-03-04 19:22:56 UTC
        

(In reply to comment #0)
> I understand that 1.4 fixes security issues so using 1.3.1-r1 is not a good
> workaround.

icedtea-bin-1.3.1-r1 has the security fixes backported so that's fine, but still not great

could you try building icedtea6-1.4 (not bin) from java-overlay and see if it's any difference?




Comment 5


georgi





          2009-03-06 05:47:24 UTC
        

I'd love to help, but I'm missing something. I added the java-overlay, but then:

$ sudo layman -S
* Running command "/usr/bin/svn up "/usr/local/portage/layman/java-overlay""...
At revision 7595.
*
* Success:
* ------
*
* Successfully synchronized overlay "java-overlay".
$ sudo emerge -s icedtea
Searching...
[ Results for search key : icedtea ]
[ Applications found : 1 ]

*  dev-java/icedtea6-bin
      Latest version available: 1.4
      Latest version installed: [ Not Installed ]
      Size of files: 110,676 kB
      Homepage:      http://icedtea.classpath.org
      Description:   A Gentoo-made binary build of the icedtea6 JDK
      License:       GPL-2-with-linking-exception

Where's icedtea?




Comment 6


Petteri Räty (RETIRED)






          2009-03-06 06:30:00 UTC
        

(In reply to comment #5)
> 
> Where's icedtea?
> 

It's icedtea6




Comment 7


georgi





          2009-03-06 18:10:24 UTC
        

emerge -s does substring search, and it catches icedtea6-bin. There really is no icedtea6.

emerge -s icedtea6 didn't do better either.




Comment 8


Alistair Bush (RETIRED)






          2009-03-06 18:57:02 UTC
        

(In reply to comment #7)
> emerge -s does substring search, and it catches icedtea6-bin. There really is
> no icedtea6.
> 
> emerge -s icedtea6 didn't do better either.
> 

~/gentoo/overlays/java-overlay/dev-java/icedtea6 $ ls
ChangeLog  files  icedtea6-1.2-r1.ebuild  icedtea6-1.3.1-r2.ebuild  icedtea6-1.4.ebuild  Manifest  metadata.xml

what about

emerge -av dev-java/icedtea6




Comment 9


georgi





          2009-03-06 22:39:04 UTC
        

Oh, I had a layman configuration issue. It is fixed now. I will build icedtea6 and report, probably on Sunday.




Comment 10


georgi





          2009-03-08 13:24:01 UTC
        

Created attachment 184330 [details]
Crash error log 2

The crash also happens with icedtea6. Here is the error log.




Comment 11


Vlastimil Babka (Caster) (RETIRED)






          2009-04-02 21:28:27 UTC
        

Looks like it occurs on Fedora too, adding upstream bug.




Comment 12


georgi





          2009-04-05 09:07:19 UTC
        

Do you have the link to the upstream bug?




Comment 13


Alistair Bush (RETIRED)






          2009-04-05 09:41:42 UTC
        

(In reply to comment #12)
> Do you have the link to the upstream bug?
> 

see the URL field.




Comment 14


Vlastimil Babka (Caster) (RETIRED)






          2009-05-03 09:14:22 UTC
        

Try changing the last line in ~/.azureus/gentoo.config to this:
JAVA_OPTIONS='-XX:CompileCommand=exclude,com/aelitis/net/udp/uc/impl/PRUDPPacketHandlerImpl$5,runSupport'

Note the single quotes, so that $5 is not interpreted as variable.
When run from terminal window, you should see this:

CompilerOracle: exclude com/aelitis/net/udp/uc/impl/PRUDPPacketHandlerImpl$5.runSupport

And it should stop crashing? Please report.




Comment 15


georgi





          2009-05-03 10:35:12 UTC
        

I'd have to downgrade to that version of Azureus and find that particular torrent which caused this. It will take me a few days.




Comment 16


Vlastimil Babka (Caster) (RETIRED)






          2009-05-03 10:51:29 UTC
        

(In reply to comment #15)
> I'd have to downgrade to that version of Azureus and find that particular
> torrent which caused this. It will take me a few days.

If you say that a newer vuze (which?) works, then I guess it's solved anyway, so no need to try :)






Comment 17


georgi





          2009-05-03 11:22:14 UTC
        

I'm not saying it works, it's just that testing takes a while, because the crash is rare. I will actually try crashing the latest Vuze without this workaround, and then with, to see if it makes a difference.

But even if it were solved with the latest Vuze, a crash in a buggy application should never bring the while virtual machine down, so there must be a bug in icedtea as well.




Comment 18


georgi





          2009-05-03 11:23:10 UTC
        

The *whole* virtual machine, sorry for the typo.




Comment 19


georgi





          2009-05-04 20:06:08 UTC
        

Without this fix, the latest Vuze crashes just like the old one.

Without the fix, it has been stable all day today, so I assume it works.

What does this line do?




Comment 20


Vlastimil Babka (Caster) (RETIRED)






          2009-05-04 20:23:32 UTC
        

(In reply to comment #17)
> But even if it were solved with the latest Vuze, a crash in a buggy application
> should never bring the while virtual machine down, so there must be a bug in
> icedtea as well.

Yep, the bug is solely in Icedtea, vuze just happens to trigger it and itself is not buggy.

(In reply to comment #19)
> Without this fix, the latest Vuze crashes just like the old one.
> 
> Without the fix, it has been stable all day today, so I assume it works.
> 
> What does this line do?
 
It disables runtime compilation of the method that was in the bug reports. Because icedtea is crashing in a compiler thread on this method. With this line, the method is interpreted, which is slower, but the method is not probably called often anyway, if the bug is so rare.
So there's a bug in the icedtea that has to be fixed upstream. Users can apply this workaround (not really a fix) to vuze's config meanwhile.




Comment 21


Andrew John Hughes





          2009-05-28 21:27:10 UTC
        

IcedTea6 1.4 has a newer version of HotSpot (14b08) than the sun-jdk releases.  1.5 will be out within the next week with an updated HotSpot (14b13 IIRC) so please try this and report back once the ebuild is available.




Comment 22


georgi





          2009-05-28 21:46:32 UTC
        

I am currently using sun-jdk, so I won't notice when the new ebuild is here. If you can, please reply to this bug report once it is out, and I will test.




Comment 23


Vlastimil Babka (Caster) (RETIRED)






          2009-06-24 12:34:22 UTC
        

(In reply to comment #22)
> I am currently using sun-jdk, so I won't notice when the new ebuild is here. If
> you can, please reply to this bug report once it is out, and I will test.

icedtea6-1.5 is out for some time. icedtea6-bin not yet, could you test?




Comment 24


georgi





          2009-06-28 13:01:56 UTC
        

Created attachment 195946 [details]
icedtea6-1.5 crash log

I tested with dev-java/icedtea6-1.5 and got the crash.




Comment 25


georgi





          2009-06-29 05:33:50 UTC
        

Created attachment 196034 [details]
sun-jdk-1.6.0.14 crash log

Now it seems the problem also happens with sun-jdk-1.6.0.14 (and maybe earlier versions too).




Comment 26


darxus





          2009-09-22 01:05:07 UTC
        

This java implementation bug can be avoided by adding this command line option to the java command:

-XX:CompileCommand=exclude,com/aelitis/net/udp/uc/impl/PRUDPPacketHandlerImpl\$5,runSupport

See: https://bugs.launchpad.net/ubuntu/+source/azureus/+bug/428514




Comment 27


georgi





          2009-10-05 11:34:30 UTC
        

I'm wondering if anyone has filed a bug with Sun to fix the JVM?




Comment 28


Vlastimil Babka (Caster) (RETIRED)






          2009-10-05 12:48:41 UTC
        

(In reply to comment #26)
> This java implementation bug can be avoided by adding this command line option
> to the java command:
> 
> -XX:CompileCommand=exclude,com/aelitis/net/udp/uc/impl/PRUDPPacketHandlerImpl\$5,runSupport
> 
> See: https://bugs.launchpad.net/ubuntu/+source/azureus/+bug/428514

Yes, see comment 14 






Comment 29


Vlastimil Babka (Caster) (RETIRED)






          2009-11-02 20:38:13 UTC
        

I'm adding an elog message to 4.2.0.8




Comment 30


Vlastimil Babka (Caster) (RETIRED)






          2009-11-02 20:43:02 UTC
        

*** Bug 285788 has been marked as a duplicate of this bug. ***




Comment 31


Vlastimil Babka (Caster) (RETIRED)






          2010-01-28 12:22:14 UTC
        

Any difference with sun-jdk-1.6.0.18 or icedtea6-1.7?




Comment 32


georgi





          2010-02-01 06:33:06 UTC
        

I have no crashes with 1.6.0.18 in over 24 hours, so maybe this bug has finally been fixed. Could anyone else confirm?




Comment 33


Serge Koksharov





          2010-02-02 21:08:55 UTC
        

I can confirm. With sun-jdk-1.0.6.18 vuze-4.2.0.8 is stable and no longer crashes on my system.




Comment 34


Nick Soveiko





          2010-02-05 02:09:28 UTC
        

(In reply to comment #31)
> Any difference with sun-jdk-1.6.0.18 or icedtea6-1.7?

dev-java/icedtea6-bin-1.7 seems to be working fine (3 days and counting)




Comment 35


Vlastimil Babka (Caster) (RETIRED)






          2010-04-21 17:43:18 UTC
        

OK, all versions that seemed to be affected are now gone.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

