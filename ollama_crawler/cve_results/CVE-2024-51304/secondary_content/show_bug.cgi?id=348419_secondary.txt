Title: 348419 – x11-libs/libdrm-2.4.23[video_cards_nouveau] breaks <=x11-drivers/xf86-video-nouveau-0.0.16_pre20101010
URL: https://bugs.gentoo.org/show_bug.cgi?id=348419

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 348419
x11-libs/libdrm-2.4.23[video_cards_nouveau] breaks <=x11-drivers/xf86-video-nouveau-0.0.16_pre20101010
Last modified: 2011-03-08 09:24:37 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 348419 
      - x11-libs/libdrm-2.4.23[video_cards_nouveau] breaks <=x11-drivers/xf86-video-nouveau-0.0.16_pre20101010


Summary:
x11-libs/libdrm-2.4.23[video_cards_nouveau] breaks <=x11-drivers/xf86-video-n...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-12-11 12:54 UTC by Charles Nérot





      Modified:
    
2011-03-08 09:24 UTC
      (History)
    




          CC List:
        

5 
          users
          
            (show)
          



Adrian.Bassett
ag
esigra
john
patrizio.bassi









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Charles Nérot





          2010-12-11 12:54:50 UTC
        

x11-libs/libdrm-2.4.23[video_cards_nouveau] breaks <=x11-drivers/xf86-video-nouveau-0.0.16_pre20101010.

Because it deploys a /usr/include/nouveau/nouveau_channel.h that is not compatible with <=x11-drivers/xf86-video-nouveau-0.0.16_pre20101010



Reproducible: Always

Steps to Reproduce:
1.emerge =x11-libs/libdrm-2.4.23
2.emerge =x11-drivers/xf86-video-nouveau-0.0.16_pre20101010
3.

Actual Results:  
compilation fail
=> X does not launch any more

Expected Results:  
emerge ok 

works fine with =x11-libs/libdrm-2.4.22




Comment 1


Patrizio Bassi





          2010-12-11 14:15:03 UTC
        

plus: mesa doesn't compile either

x86_64-pc-linux-gnu-gcc -c -I. -I../../../../../src/mesa/drivers/dri/common -Iserver -I../../../../../include -I../../../../../src/mapi -I../../../../../src/mesa -I../../../../../src/egl/main -I../../../../../src/egl/drivers/dri -I/usr/include/libdrm    -O2 -pipe -mtune=core2 -march=core2 -fomit-frame-pointer -mmmx -msse -msse2 -msse3 -mfpmath=sse -ffast-math -Wall -Wmissing-prototypes -std=c99 -ffast-math -fvisibility=hidden -fno-strict-aliasing  -fPIC  -DUSE_X86_64_ASM -D_GNU_SOURCE -DPTHREADS -DHAVE_POSIX_MEMALIGN -DUSE_XCB -DGLX_USE_TLS -DPTHREADS -DUSE_EXTERNAL_DXTN_LIB=1 -DIN_DRI_DRIVER -DGLX_DIRECT_RENDERING -DGLX_INDIRECT_RENDERING -DHAVE_ALIAS -DHAVE_XCB_DRI2 -DHAVE_LIBUDEV -I/usr/include/libdrm -I/usr/include/nouveau   -DFEATURE_GL=1  nouveau_driver.c -o nouveau_driver.o
nouveau_context.c: In function ‘nouveau_context_init’:
nouveau_context.c:132:9: warning: passing argument 4 of ‘nouveau_channel_alloc’ makes integer from pointer without a cast
/usr/include/nouveau/nouveau_channel.h:51:1: note: expected ‘int’ but argument is of type ‘struct nouveau_channel **’
nouveau_context.c:132:9: error: too few arguments to function ‘nouveau_channel_alloc’
/usr/include/nouveau/nouveau_channel.h:51:1: note: declared here


using a mesa lib compiled against libdrm 2.4.22 makes X crash

Backtrace:
[ 13683.610] 0: /usr/bin/X (xorg_backtrace+0x28) [0x49eef8]
[ 13683.610] 1: /usr/bin/X (0x400000+0x60269) [0x460269]
[ 13683.610] 2: /lib/libpthread.so.0 (0x7fec5a2cc000+0xfbb0) [0x7fec5a2dbbb0]
[ 13683.610] 3: /usr/lib/libdrm_nouveau.so.1 (nouveau_channel_alloc+0x4d) [0x7fec574aed7d]
[ 13683.610] 4: /usr/lib64/dri/nouveau_dri.so (0x7fec564c2000+0x7e54d) [0x7fec5654054d]
[ 13683.610] 5: /usr/lib64/dri/nouveau_dri.so (0x7fec564c2000+0x3a92d) [0x7fec564fc92d]
[ 13683.610] 6: /usr/lib64/dri/nouveau_dri.so (0x7fec564c2000+0x30742) [0x7fec564f2742]
[ 13683.610] 7: /usr/lib64/dri/nouveau_dri.so (0x7fec564c2000+0x2a309) [0x7fec564ec309]
[ 13683.610] 8: /usr/lib64/dri/nouveau_dri.so (0x7fec564c2000+0x2ed12) [0x7fec564f0d12]
[ 13683.610] 9: /usr/lib64/dri/nouveau_dri.so (0x7fec564c2000+0x2bec0) [0x7fec564edec0]
[ 13683.610] 10: /usr/lib64/xorg/modules/extensions/libglx.so (0x7fec57cf4000+0x42a02) [0x7fec57d36a02]
[ 13683.610] 11: /usr/lib64/xorg/modules/extensions/libglx.so (0x7fec57cf4000+0x38c1b) [0x7fec57d2cc1b]
[ 13683.610] 12: /usr/bin/X (InitExtensions+0x91) [0x484811]
[ 13683.610] 13: /usr/bin/X (0x400000+0x213de) [0x4213de]
[ 13683.610] 14: /lib/libc.so.6 (__libc_start_main+0xfd) [0x7fec59497d2d]
[ 13683.610] 15: /usr/bin/X (0x400000+0x21129) [0x421129]
[ 13683.610] Segmentation fault at address 0x48





Comment 2


Chí-Thanh Christopher Nguyễn






          2010-12-11 16:04:10 UTC
        

Worksforme with xf86-video-nouveau-0.0.16_pre20101130

The mesa issue (which should have been reported in a different bug) is presently being looked into.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

