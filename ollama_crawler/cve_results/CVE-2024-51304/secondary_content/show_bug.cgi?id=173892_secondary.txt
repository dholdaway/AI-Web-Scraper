Title: 173892 – sys-apps/hal-0.5.9 - KDE device mounting doesn't work anymore
URL: https://bugs.gentoo.org/show_bug.cgi?id=173892

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 173892
sys-apps/hal-0.5.9 - KDE device mounting doesn't work anymore
Last modified: 2008-09-06 18:35:08 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 173892 
      - sys-apps/hal-0.5.9 - KDE device mounting doesn't work anymore


Summary:
sys-apps/hal-0.5.9 - KDE device mounting doesn't work anymore
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

Project Gentopia








URL:



https://bugzilla.redhat.com/bugzilla/...
        




Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-04-09 11:37 UTC by Elias Probst





      Modified:
    
2008-09-06 18:35 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



gengor
mail









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Elias Probst





          2007-04-09 11:37:00 UTC
        

After upgrading to sys-apps/hal-0.5.9 KDE device mounting doesn't work anymore.
When clicking on a device for mounting it, this error pops up:
  Permission denied: Not in active session

There are two bugs in the RedHat bugzilla about this problem too:
https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=229465
https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=232674

Currently I'm trying to track down what causes this and implement a solution to make sys-apps/hal-0.5.9 go stable ASAP.

Reproducible: Always

Steps to Reproduce:
1. Update to sys-apps/hal-0.5.9 (masked, ~x86)
2. Add consolekit to default runlevel
3. Restart hal, dbus, xdm
4. Insert a new medium (CD-ROM, USB stick, etc.)
5. Click the icon to mount the new medium


Actual Results:  
A message telling "Permission denied: Not in active session" pops up and the device can't be mounted.

Expected Results:  
The device should have been mounted

I know, there are some overlays active containing >=sys-apps/hal-0.5.9 too, but none of them was used for emerging sys-apps/hal-0.5.9. It's the plain portage version.

emerge --info
Portage 2.1.2.2 (default-linux/x86/2006.1, gcc-4.1.1, glibc-2.5-r0, 2.6.19-suspend2-r3 i686)
=================================================================
System uname: 2.6.19-suspend2-r3 i686 Intel(R) Core(TM)2 CPU         T7400  @ 2.16GHz
Gentoo Base System release 1.12.9
Timestamp of tree: Sat, 07 Apr 2007 10:50:01 +0000
ccache version 2.4 [enabled]
dev-java/java-config: 1.3.7, 2.0.31
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=nocona -msse3 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/php/apache1-php5/ext-active/ /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O2 -march=nocona -msse3 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="ccache distlocks metadata-transfer parallel-fetch sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.mneisen.org/gentoo ftp://mirror.datapipe.net/gentoo http://mirror.datapipe.net/gentoo http://gentoo.mneisen.org/ ftp://213.186.33.38/gentoo-distfiles/"
LANG="de_DE.utf8"
LC_ALL="C"
LINGUAS="de_DE de"
MAKEOPTS="-j12"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /usr/portage/local/minext /usr/portage/local/layman/xeffects /usr/portage/local/layman/sabayon /usr/portage/local/layman/gentopia /usr/portage/local/layman/vmware /usr/portage/local/layman/xeffects-experimental /usr/portage/local/layman/zugaina /usr/portage/local/layman/aross /usr/portage/local/layman/voip /usr/portage/local/layman/WTK-Testing /usr/portage/local/layman/moonitor /usr/portage/local/layman/flameeyes-overlay"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="S3TC X a52 aac acl acpi aiglx alsa apache2 asf async automount bash-completion berkdb bluetooth bogofilter bzip2 cairo cardbus cdda cddb cdinstall cdparanoia cdr chardet cisco cli colordiff connectionstatus contactnotes cpudetection cracklib crypt css cups daap dbus dcraw dga disk-partition divx djbfft djvu dmi dmx dri dts dvd dvdr dvdread effects emovix encode exif extensions fam fame fat fbsplash ffmpeg firefox flac foomaticdb ftp fuse gd gdbm geoip gif gimp gimpprint glitz glut gmedia gphoto2 gpm graphviz gsm gstreamer gtk2 h323 hal hbci hdaps hddtemp highlight history howl http httpd ibam iconv icq idea ieee1394 ifp imagemagick imap imlib inkjar ipod ipv6 irc irmc jabber java javascript john jpeg jpeg2k kde kdepim kdrive kerberos kipi kqemu l7filter latex lcms ldap libnotify libsamplerate libvisual lm_sensors logitech-mouse lzo lzw mad matroska midi mikmod mime mjpeg mmap mmx mmxext mng modplug module mozbranding mozsvg mp3 mp4 mpeg mplayer mtp musicbrainz mysql ncurses network njb nls nptl nptlonly nsplugin ntfs ntlm ntlm_unsupported_patch obex offensive ofx ogg on-the-fly-crypt openal opengl oscar oss pam pcmcia pcre pda pdf perl php plotutils plugin pmount pmu png ppds pppd print python qa qt3 qt4 quicktime radius rdesktop readline real realmedia rtc rtsp ruby samba scanner screen sdl sensord session sharedext smartcard smp snmp sockets sound spell spl sql sqlite sqlite3 sse sse2 ssl stream subtitles svg svga swat symlink szip tagwriting tcpd tetex texteffect textures theora tidy tiff transcode truetype truetype-fonts trusted type1-fonts unicode usb userlocales utempter vcd videos vidix vim visualization vlm vnc vncviewer vorbis webdav webpresence wifi win32codecs wireshark wma wmp x264 x86 xanim xattr xcomposite xine xinerama xml xorg xpm xrandr xscreensaver xv xvid xvmc xvnc yv12 zeroconf zlib" ALSA_CARDS="hda-intel usb-audio" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de_DE de" USERLAND="GNU" VIDEO_CARDS="vga radeon fglrx vesa fbdev"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Steev Klimaszewski (RETIRED)






          2007-04-09 13:36:34 UTC
        

This makes sense (and we will leave the bug open) because as far as I know, KDM isn't patched to use ConsoleKit (yet) - Could you try with GDM?  Or are you using GDM and it still isn't getting set?




Comment 2


Doug Goldstein (RETIRED)






          2007-04-09 13:48:13 UTC
        

Disable the "pam" USE flag for HAL and re-compile. It should work for you.




Comment 3


Elias Probst





          2007-04-09 23:51:31 UTC
        

Disabling the "pam" USE flag for sys-apps/hal-0.5.9 and restarting /etc/init.d/hald helped.

Mounting is now working again.

I think this bug should be left open, until there are patches for KDM available.
I've already did some Googling and searching on bugs.kde.org, but couldn't find a patch yet.

I'll ask at the hal mailinglist for it.




Comment 4


Doug Goldstein (RETIRED)






          2007-04-09 23:57:45 UTC
        

Why? It's a known issue when using ConsoleKit. And no, no one from the KDE world has created any patches or anything for KDE. KDM developers said they're focusing on KDE 4 right now and not on this bits.

The fix is not to install hal 0.5.9 with USE=pam in KDE currently.




Comment 5


Doug Goldstein (RETIRED)






          2007-04-10 00:01:15 UTC
        

Reference the proper Red Hat bug with regard to this.




Comment 6


Elias Probst





          2007-04-10 00:06:23 UTC
        

Ok, from the hal POV you're right.
So maybe a ewarn about this issue should be added to hal for KDE users.
Then, I think we can close this bug.

Thanks!

if [[ use kde && use pam ]] ; then
	ewarn "To make device mounting in KDE working again,\
		disable the pam USE flag and re-emerge sys-apps/hal"
fi




Comment 7


Doug Goldstein (RETIRED)






          2007-04-10 00:10:08 UTC
        

This is a masked ebuild that's a work in progress. It will not be unmasked until such issues are resolved.




Comment 8


Doug Goldstein (RETIRED)






          2007-04-10 00:13:29 UTC
        

If you want to help with issues such as this and testing, please come on IRC to  #gentoo-desktop.




Comment 9


Elias Probst





          2007-04-10 00:27:57 UTC
        

Closing it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

