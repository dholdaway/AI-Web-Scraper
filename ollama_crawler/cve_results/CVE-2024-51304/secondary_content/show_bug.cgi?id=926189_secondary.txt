Title: 926189 – sys-boot/grub use=-fonts breaks efi system
URL: https://bugs.gentoo.org/show_bug.cgi?id=926189

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 926189
sys-boot/grub use=-fonts breaks efi system
Last modified: 2024-03-07 16:14:52 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 926189 
      - sys-boot/grub use=-fonts breaks efi system


Summary:
sys-boot/grub use=-fonts breaks efi system
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Mike Gilbert








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2024-03-05 10:46 UTC by Stefan de Konink





      Modified:
    
2024-03-07 16:14 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



base-system
pacho
stefan









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Grub screenshot

              (grub.png,247.91 KB,
                image/png)

            
2024-03-05 10:46 UTC,

            Stefan de Konink




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Stefan de Konink





          2024-03-05 10:46:25 UTC
        

Created attachment 886733 [details]
Grub screenshot

When grub is merged without use=fonts, an EFI enabled system seems unable to boot. Other than updating my system and running grub-mkconfig I ended up in a state where I couldn't read any error message without using a camera recording and stepping through it frame by frame.

The missing unicode.pf2 is recovered when installing grub with USE=fonts.

Adding a timeout would be convenient with these kind of 'reboot directly' errors.




Comment 1


Mike Gilbert






          2024-03-06 17:14:55 UTC
        

What version of grub?




Comment 2


Mike Gilbert






          2024-03-06 17:21:36 UTC
        

Anyway, it should be technically possible to boot without a font on an EFI system, assuming nothing else goes wrong.

The USE flag is enabled by default, so I'm not too concerned about this being an issue.




Comment 3


Stefan de Konink





          2024-03-06 18:47:52 UTC
        

sys-boot/grub-2.12-r2:2




Comment 4


Mike Gilbert






          2024-03-07 02:28:55 UTC
        

I just confirmed that I was able to boot a qemu-based VM with OVMF (UEFI) using sys-boot/grub[-fonts]. The boot menu appeared and worked as expected.




Comment 5


Stefan de Konink





          2024-03-07 07:51:32 UTC
        

If you would remove bli.mod, would it still boot?




Comment 6


Mike Gilbert






          2024-03-07 14:51:22 UTC
        

Why would I remove bli.mod?




Comment 7


Stefan de Konink





          2024-03-07 15:47:57 UTC
        

Because that is what the screenshot suggests.




Comment 8


Sam James









          2024-03-07 15:54:05 UTC
        

It's not clear why it's missing, though. Obviously removing it is going to break it, but why was it missing to begin with?




Comment 9


Stefan de Konink





          2024-03-07 16:01:48 UTC
        

It is also not clear to me why an upgrade without any issues suddenly breaks while only a use flag is different. But to be honest, I don't find it very obviously that it would break without that file at all. It I can make a video recording of the screen, it obviously has output...




Comment 10


Mike Gilbert






          2024-03-07 16:14:52 UTC
        

I would guess that you upgraded from grub-2.06 to grub-2.12 without running grub-install afterward.

The "bli" module was added in grub-2.12. If you didn't run grub-install, it would not exist in /boot/grub.

Regardless, I don't think a failure to load the bli module would cause a boot failure. Something else probably went wrong.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

