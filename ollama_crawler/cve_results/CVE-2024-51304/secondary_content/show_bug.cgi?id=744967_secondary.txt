Title: 744967 – www-client/chromium-85.0.4183.121: segfault whilst compiling
URL: https://bugs.gentoo.org/show_bug.cgi?id=744967

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 744967
www-client/chromium-85.0.4183.121: segfault whilst compiling
Last modified: 2020-09-30 18:07:31 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 744967 
      - www-client/chromium-85.0.4183.121: segfault whilst compiling


Summary:
www-client/chromium-85.0.4183.121: segfault whilst compiling
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       major
      


Assignee:

Chromium Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-09-27 18:57 UTC by Davyd McColl





      Modified:
    
2020-09-30 18:07 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



jstein
sam
toolchain









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build log

              (build.log.xz,540.92 KB,
                application/x-xz)

            
2020-09-27 19:00 UTC,

            Davyd McColl




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Davyd McColl





          2020-09-27 18:57:27 UTC
        

Whilst attempting to build chromium-85.0.4183.121, the build errors and fails. The last error I see in logs is:

../../cc/paint/transfer_cache_entry.h:76:41: internal compiler error: Segmentation fault
   76 |   virtual ~ServiceTransferCacheEntry() {}
      |                                         ^
Please submit a full bug report,
with preprocessed source if appropriate.
See <https://bugs.gentoo.org/> for instructions.


Reproducible: Always

Steps to Reproduce:
1. attempt to emerge chromium-85.0.4183.121
2. wait a long time
3. build fails, apparently g++ segfaults
Actual Results:  
Build fails

Expected Results:  
Build should not fail

- This is the only package on my system which is encountering this error
- This is the first time I've seen this error with Chromium

I'm quite sure there's more information I can furnish, but I'll need some guidance as to what, to avoid fire-hosing too much useless info.




Comment 1


Davyd McColl





          2020-09-27 19:00:49 UTC
        

Created attachment 662695 [details]
build log




Comment 2


Jonas Stein






          2020-09-27 19:18:45 UTC
        

please paste your emerge info.




Comment 3


Sam James









          2020-09-27 19:55:22 UTC
        

It's important that you follow https://wiki.gentoo.org/wiki/Gcc-ICE-reporting-guide and provide the full information requested there.




Comment 4


Davyd McColl





          2020-09-28 06:03:45 UTC
        

emerge --info:

Portage 3.0.4 (python 3.7.8-final-0, default/linux/amd64/17.1/desktop/plasma, gcc-9.3.0, glibc-2.31-r6, 5.4.66-gentoo-x86_64 x86_64)
=================================================================
System uname: Linux-5.4.66-gentoo-x86_64-x86_64-Intel-R-_Core-TM-_i7-3770K_CPU_@_3.50GHz-with-gentoo-2.7
KiB Mem:    16352828 total,   4282184 free
KiB Swap:    6428500 total,   6427476 free
Timestamp of repository gentoo: Sun, 27 Sep 2020 18:30:01 +0000
Head commit of repository gentoo: d2800745667ec37b551fd204c119faf44828888b
Head commit of repository dotnet: f1724b1b788c93a35a29164988abfac13df14c02

Head commit of repository jorgicio: 7ebe6a1f5cc870475607027063e23966ec24bd3b

Head commit of repository bobwya: 341c8192999e130cab12e1bb2e5a3225fa78d61a

Head commit of repository cg: 27f5d5a55135a6c2c7bea2ce9ba992dc9ddb1c71

Head commit of repository flatpak-overlay: 85b574e89510f6422e0e5177de99f8893eec6608

Head commit of repository steam-overlay: 9b344386364381390a2418299779ba7fea9225c3

sh bash 5.0_p18
ld GNU ld (Gentoo 2.34 p6) 2.34.0
ccache version 3.7.11 [enabled]
app-shells/bash:          5.0_p18::gentoo
dev-java/java-config:     2.3.1::gentoo
dev-lang/perl:            5.30.3::gentoo
dev-lang/python:          2.7.18-r2::gentoo, 3.7.8-r2::gentoo, 3.8.5::gentoo
dev-util/ccache:          3.7.11::gentoo
dev-util/cmake:           3.16.5::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.7::gentoo
sys-apps/openrc:          0.42.1::gentoo
sys-apps/sandbox:         2.18::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r5::gentoo
sys-devel/automake:       1.16.1-r1::gentoo
sys-devel/binutils:       2.34-r2::gentoo
sys-devel/gcc:            9.3.0-r1::gentoo
sys-devel/gcc-config:     2.3.1::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 5.8::gentoo (virtual/os-headers)
sys-libs/glibc:           2.31-r6::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-max-age: 24
    sync-rsync-extra-opts: 
    sync-rsync-verify-jobs: 1
    sync-rsync-verify-metamanifest: yes

dotnet
    location: /var/db/repos/dotnet
    sync-type: git
    sync-uri: https://github.com/gentoo/dotnet.git
    masters: gentoo

jorgicio
    location: /var/db/repos/jorgicio
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/jorgicio.git
    masters: gentoo

bobwya
    location: /var/db/repos/bobwya
    sync-type: git
    sync-uri: https://github.com/bobwya/bobwya.git
    masters: gentoo
    priority: 50

cg
    location: /var/db/repos/cg
    sync-type: git
    sync-uri: https://github.com/brothermechanic/cg.git
    masters: gentoo
    priority: 50

flatpak-overlay
    location: /var/db/repos/flatpak
    sync-type: git
    sync-uri: https://github.com/fosero/flatpak-overlay
    masters: gentoo
    priority: 50

steam-overlay
    location: /var/db/repos/steam-overlay
    sync-type: git
    sync-uri: git://github.com/anyc/steam-overlay.git
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="@FREE"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=native -O2"
DISTDIR="/usr/portage/distfiles"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs ccache config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="ftp://mirror.csclub.uwaterloo.ca/gentoo-distfiles/ rsync://ftp-stud.hs-esslingen.de/gentoo/"
LANG="en_US.utf8"
LC_ALL="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j5 -l4"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="X a52 aac acl acpi activities alsa amd64 berkdb bluetooth branding bzip2 cairo cdda cdr cli crypt cups dbus declarative dri dts dvd dvdr elogind emboss encode exif flac fortran gdbm gif gpm gtk gui iconv icu ipv6 jpeg kde kipi kwallet lcms libglvnd libnotify libtirpc mad mng mp3 mp4 mpeg multilib ncurses nls nptl ogg opengl openmp pam pango pcre pdf phonon plasma png policykit ppds pulseaudio qml qt5 readline sdl seccomp semantic-desktop spell split-usr ssl startup-notification svg tcpd threads tiff truetype udev udisks unicode upower usb vorbis widgets wxwidgets x264 xattr xcb xml xv xvid zlib" ABI_X86="64 32" ADA_TARGET="gnat_2018" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="aes avx f16c mmx mmxext pclmul popcnt sse sse2 sse3 sse4_1 sse4_2 ssse3" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-2 php7-3 php7-4" POSTGRES_TARGETS="postgres10 postgres11" PYTHON_SINGLE_TARGET="python3_7" PYTHON_TARGETS="python2_7 python3_7" RUBY_TARGETS="ruby25 ruby26" USERLAND="GNU" VIDEO_CARDS="radeonsi amdgpu" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LINGUAS, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 5


Davyd McColl





          2020-09-28 06:22:18 UTC
        

❯ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-pc-linux-gnu/9.3.0/lto-wrapper
Target: x86_64-pc-linux-gnu
Configured with: /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/configure --host=x86_64-pc-linux-gnu --build=x86_64-pc-linux-gnu --prefix=/usr --bindir=/usr/x86_64-pc-linux-gnu/gcc-bin/9.3.0 --includedir=/usr/lib/gcc/x86_64-pc-linux-gnu/9.3.0/include --datadir=/usr/share/gcc-data/x86_64-pc-linux-gnu/9.3.0 --mandir=/usr/share/gcc-data/x86_64-pc-linux-gnu/9.3.0/man --infodir=/usr/share/gcc-data/x86_64-pc-linux-gnu/9.3.0/info --with-gxx-include-dir=/usr/lib/gcc/x86_64-pc-linux-gnu/9.3.0/include/g++-v9 --with-python-dir=/share/gcc-data/x86_64-pc-linux-gnu/9.3.0/python --enable-languages=c,c++,fortran --enable-obsolete --enable-secureplt --disable-werror --with-system-zlib --enable-nls --without-included-gettext --enable-checking=release --with-bugurl=https://bugs.gentoo.org/ --with-pkgversion='Gentoo 9.3.0-r1 p3' --disable-esp --enable-libstdcxx-time --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-clocale=gnu --enable-multilib --with-multilib-list=m32,m64 --disable-fixed-point --enable-targets=all --enable-libgomp --disable-libssp --disable-libada --disable-systemtap --enable-vtable-verify --enable-lto --without-isl --enable-default-pie --enable-default-ssp
Thread model: posix
gcc version 9.3.0 (Gentoo 9.3.0-r1 p3)




Comment 6


Davyd McColl





          2020-09-28 06:27:53 UTC
        

I'm having trouble getting the .i file that is requested by https://wiki.gentoo.org/wiki/Gcc-ICE-reporting-guide -- I've traveled up through the log, executing commands I see in there one-for one, about 8 back (and my default -j in make.conf is 5 (with additional limiter -l4) and I'm not getting any of them to segfault for me. Just in case logs are more entagled than I'd expect, I'm re-running the build with MAKEOPTS="-j1". This will take a while -- without ccache (which I disabled before filing this report), a typical build of chromium takes my machine around 6-8 hours. Apologies for the delay.




Comment 7


Davyd McColl





          2020-09-28 17:15:12 UTC
        

(update: still building; perhaps I'll have something by tomorrow some time)




Comment 8


Davyd McColl





          2020-09-29 17:06:16 UTC
        

ok, so build has completed now, without error :/

what does that mean?




Comment 9


gentoo_bugs





          2020-09-30 11:57:19 UTC
        

I had the same issue (www-client/chromium-85.0.4183.121 causing "internal compiler error: Segmentation fault" with gcc-9.3.0-r1).
Issue is reproducible in the sense that it happened trice in succession, but every time with a different source file.

After upgrading and switching to gcc 10 it compiled at first tentative.

I'm using -j8 (8 core FX8320 with 32GB of RAM).




Comment 10


Davyd McColl





          2020-09-30 17:20:00 UTC
        

I also had three failing builds with segfaults before raising this issue.

I've just rebuilt again twice, once with ccache and once without. Since the first build that completed (with -j1, no ccache), these other two have completed fine too.

So it seems that I can't provide the really useful information ):




Comment 11


Sergei Trofimovich (RETIRED)






          2020-09-30 18:07:31 UTC
        

Intermittent compiler failures on heaviweight sources are frequently the sign of hardware problems (overheat or just bugs). You might have some chance running sys-apps/memtest86+ or equivalent to make sure there are no trivial ovservable failures.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

