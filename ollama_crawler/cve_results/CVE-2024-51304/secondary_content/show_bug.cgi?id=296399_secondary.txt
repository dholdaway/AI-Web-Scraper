Title: 296399 – emerge --fetch does not fetch source when masked
URL: https://bugs.gentoo.org/show_bug.cgi?id=296399

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 296399
emerge --fetch does not fetch source when masked
Last modified: 2010-01-30 12:17:17 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 296399 
      - emerge --fetch does not fetch source when masked


Summary:
emerge --fetch does not fetch source when masked
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Enhancement/Feature Requests

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       enhancement
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-12-10 13:33 UTC by John (EBo) David





      Modified:
    
2010-01-30 12:17 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



divanorama









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


John (EBo) David





          2009-12-10 13:33:26 UTC
        

I have a gentoo box which is not connected to the net, which I keep updated via sneaker-net.

Since that box has an AMD, while my laptop has an Intel, from time to time there are packages where one needs and the other does not.  Recently my home cluster head started asking for kde-base/kde*-4.3.3 updates.  These have been stabilized for AMD64, but not for X86.  

When I try to fetch these files via "emerge -f kde-base/kdelibs-4.3.3-r1", for example, it complains that the package is masked on the Intel box and will not do a fetch only.  Also when I try to fetch only directly from the ebuild it trips over the dependencies.  I am requesting a feature update, if reasonable, that --fetch and --fetch-all-uri allow fetches of the source even if they are masked.  If this breaks some internal dependency, maybe a --fetch-src-only argument can be added to bypass the masks for fetching the source.

  Best regards,

  EBo --




Comment 1


Zac Medico






          2009-12-10 20:35:34 UTC
        

I guess we can add a --no-mask option for this (you probably also want to use --nodeps). We can't disregard masks by default because people rely on --fetchonly to account for masks when resolving dependencies.




Comment 2


Dmitry Ivankov





          2009-12-11 08:59:16 UTC
        

(In reply to comment #0)

I don't know much of emerge internals, but can't you just do something like
ACCEPT_KEYWORDS="x86" emerge -f whatever
maybe there will still be a problem with different profile, isn't there an argument to emerge to use foreign profile and whatever other settings?
If not, afaik, you can still hack it by making conditional bash wraps around profiles and do some HACK_SETTINGS=laptop emerge -f whatever.






Comment 3


John (EBo) David





          2009-12-11 10:02:24 UTC
        

Actually, the "ACCEPT_KEYWORDS="x86" emerge -f ..." seems to work.  For some reason it did not work when I just set ACCEPT_KEYWORDS="x86" in the bash shell and then an emerge separately.  Hmmm... odd...

Thanks Dmitry, for pointing me to the obvious solution ;-)

In light of this it would probably be easier to not bother with adding a new cmdl argument, but simply add an example to the documentation regarding circumventing the mask using ACCEPT_KEYWORDS, and probably add a warning or two about using this for fetches vs. builds as this could seriously bork your system.

Thanks again,

  EBo --

ps: should I/we set this as resolved?




Comment 4


Zac Medico






          2010-01-30 12:17:17 UTC
        

Note that you can use the ebild(1) command to fetch a specific ebuild, regardless of masking.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

