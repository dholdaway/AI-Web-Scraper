Title: 657792 – media-tv/plex-media-server-1.12.3: Cannot start media server on another machine
URL: https://bugs.gentoo.org/show_bug.cgi?id=657792

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 657792
media-tv/plex-media-server-1.12.3: Cannot start media server on another machine
Last modified: 2018-06-25 12:06:36 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 657792 
      - media-tv/plex-media-server-1.12.3: Cannot start media server on another machine


Summary:
media-tv/plex-media-server-1.12.3: Cannot start media server on another machine
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Jonathan Vasquez (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2018-06-11 07:29 UTC by Andrew Udvare





      Modified:
    
2018-06-25 12:06 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Plex media server logs

              (plex-logs.tar.bz2,140.98 KB,
                application/x-bzip2)

            
2018-06-11 07:31 UTC,

            Andrew Udvare




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andrew Udvare





          2018-06-11 07:29:34 UTC
        

I am trying to install the server on another machine than my client machine. It is a headless machine so I need to enable it for first run then enable remote access.

I have opened up the relevant ports:

-A INPUT -p tcp -m tcp --dport 32400 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport 32401 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport 34301 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport 32469 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport 32600 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p tcp -m tcp --dport 1032 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p udp -m udp --dport 32410 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p udp -m udp --dport 32412 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p udp -m udp --dport 32413 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT
-A INPUT -p udp -m udp --dport 32414 -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT

I followed the guide here ('On a Different Network' because 'On the Same Local Network' also did not work): https://support.plex.tv/articles/200288586-installation/

I can go to http://localhost:8888/web on my system and it connects, I can sign in, but it never finds the media server.

I did try the latest version of Plex (1.13) and ran it much the same way as the current version (new version does not have a virtualenv). Had no luck with that.

I would very much like this use case to be supported.

Reproducible: Always

Steps to Reproduce:
1. emerge plex-media-server
2. systemctl start plex-media-server
3. On another machine: ssh server-machine -L 8888:localhost:32400
4. Open browser to localhost:8888/web
5. Sign in.
6. Try to configure a server.
Actual Results:  
Does not find a server running.

Expected Results:  
Should find a server.

emerge --info
Portage 2.3.40 (python 3.6.5-final-0, default/linux/amd64/17.0/no-multilib, gcc-6.4.0, glibc-2.26-r7, 4.16.13-gentoo x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-4.16.13-gentoo-x86_64-AMD_FX-tm-8150_Eight-Core_Processor-with-gentoo-2.4.1
KiB Mem:    16351528 total,   1076960 free
KiB Swap:          0 total,         0 free
Timestamp of repository gentoo: Mon, 11 Jun 2018 06:15:01 +0000
Head commit of repository gentoo: 689e16682357ad63d26f324558aca005df091d86
sh bash 4.4_p12
ld GNU ld (Gentoo 2.30 p2) 2.30.0
app-shells/bash:          4.4_p12::gentoo
dev-lang/perl:            5.24.3-r1::gentoo
dev-lang/python:          2.7.14-r1::gentoo, 3.6.5::gentoo
dev-util/cmake:           3.9.6::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.4.1-r2::gentoo
sys-apps/sandbox:         2.13::gentoo
sys-devel/autoconf:       2.69-r4::gentoo
sys-devel/automake:       1.11.6-r3::gentoo, 1.15.1-r2::gentoo
sys-devel/binutils:       2.30-r2::gentoo
sys-devel/gcc:            6.4.0-r1::gentoo
sys-devel/gcc-config:     1.8-r1::gentoo
sys-devel/libtool:        2.4.6-r3::gentoo
sys-devel/make:           4.2.1::gentoo
sys-kernel/linux-headers: 4.13::gentoo (virtual/os-headers)
sys-libs/glibc:           2.26-r7::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.namerica.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-metamanifest: yes
    sync-rsync-extra-opts: 
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-jobs: 1

jamiel-gentoo-overlay
    location: /var/lib/layman/jamiel-gentoo-overlay
    masters: gentoo
    priority: 50

java
    location: /var/lib/layman/java
    masters: gentoo
    priority: 50

srcshelton
    location: /var/lib/layman/srcshelton
    masters: gentoo
    priority: 50

tatsh-overlay
    location: /var/lib/layman/tatsh-overlay
    masters: gentoo
    priority: 50

vortex
    location: /var/lib/layman/vortex
    masters: gentoo
    priority: 50

Installed sets: @admin, @ansible, @bashcomp, @bloodhound, @cgit, @cups, @docker, @git, @grub, @kernel, @logrotate, @media, @misc, @mlocate, @portage-utilities, @python, @rar, @samba, @ssh, @tatshnet, @tmux, @uwsgi, @vim, @zfs
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=native"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /etc/gcruft /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php7.1/ext-active/ /etc/php/cgi-php7.1/ext-active/ /etc/php/cli-php7.1/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe -march=native"
DISTDIR="/usr/portage/distfiles"
ENV_UNSET="DBUS_SESSION_BUS_ADDRESS DISPLAY PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs buildpkg clean-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync multilib-strict news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans unprivileged userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://gentoo.osuosl.org/ http://gentoo.mirrors.pair.com/ rsync://mirrors.rit.edu/gentoo/ http://mirrors.rit.edu/gentoo/ rsync://gentoo.mirrors.tds.net/gentoo http://ftp.ucsb.edu/pub/mirrors/linux/gentoo/ http://gentoo.cites.uiuc.edu/pub/gentoo/"
LANG="en_GB.utf8"
LDFLAGS="-Wl,--as-needed"
LINGUAS="en_GB en"
MAKEOPTS="-j9"
PKGDIR="/usr/portage/packages"
PORTAGE_BINHOST="ssh://tatsh@192.168.1.100/mnt/spare/portage-root/tatsh/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="acl aes amd64 avx bash-completion bzip2 cjk cli crypt cxx dri ffmpeg fma4 gdbm gif gpm iconv idn ipv6 jemalloc jpeg libtirpc mmx mmxext modules ncurses nls nptl openmp pam pcre peer_perms png popcnt readline seccomp sse sse2 sse3 sse4_1 sse4_2 sse4a ssl ssse3 svg syslog systemd tcpd tiff unicode vim-syntax xattr xop zlib" ABI_X86="64" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon plan sheets stage words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="aes avx fma4 mmx mmxext popcnt sse sse2 sse3 sse4_1 sse4_2 sse4a ssse3 xop" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" GRUB_PLATFORMS="pc" INPUT_DEVICES="evdev joystick keyboard mouse" KERNEL="linux" L10N="en-GB en" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-1" POSTGRES_TARGETS="postgres9_5" PYTHON_SINGLE_TARGET="python3_6" PYTHON_TARGETS="python2_7 python3_6" RUBY_TARGETS="ruby23" USERLAND="GNU" VIDEO_CARDS="nvidia v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

media-tv/plex-media-server-1.12.3::gentoo was built with the following:
USE="" PYTHON_TARGETS="python2_7"




Comment 1


Andrew Udvare





          2018-06-11 07:31:44 UTC
        

Created attachment 535630 [details]
Plex media server logs




Comment 2


Andrew Udvare





          2018-06-11 07:33:07 UTC
        

systemctl status output:

● plex-media-server.service - Plex Media Server
   Loaded: loaded (/lib/systemd/system/plex-media-server.service; disabled; vendor preset: disabled)
   Active: inactive (dead)

Jun 11 00:01:20 tatsh start_pms[26776]: 8 3000 /var/lib/plexmediaserver
Jun 11 00:01:20 tatsh start_pms[26776]: 8192
Jun 11 00:01:28 tatsh start_pms[26776]: Error starting framework core for /usr/lib/plexmediaserver/Resources/Plug-ins-215c28d86/PlexThemeMusic.bundle.
Jun 11 00:01:28 tatsh start_pms[26776]: Error starting framework core for /usr/lib/plexmediaserver/Resources/Plug-ins-215c28d86/PlexMusic.bundle.
Jun 11 00:01:28 tatsh start_pms[26776]: Error starting framework core for /usr/lib/plexmediaserver/Resources/Plug-ins-215c28d86/LocalMedia.bundle.
Jun 11 00:04:28 tatsh start_pms[26776]: Error starting framework core for /usr/lib/plexmediaserver/Resources/Plug-ins-215c28d86/OpenSubtitles.bundle.
Jun 11 00:04:28 tatsh start_pms[26776]: Error starting framework core for /usr/lib/plexmediaserver/Resources/Plug-ins-215c28d86/HTbackdrops.bundle.
Jun 11 00:04:29 tatsh start_pms[26776]: Error starting framework core for /usr/lib/plexmediaserver/Resources/Plug-ins-215c28d86/PlexMovie.bundle.

Jun 11 00:05:05 tatsh systemd[1]: Stopping Plex Media Server...
Jun 11 00:05:05 tatsh systemd[1]: Stopped Plex Media Server.




Comment 3


Jonathan Vasquez (RETIRED)






          2018-06-16 14:29:45 UTC
        

This doesn't seem like it's a problem with plex specifically, it's been working for me and others for years at this point so it's probably network configuration related. If you find the root cause of this (and if it is related to changes that we could make to out plex ebuilds, feel free to post here again, and we can discuss merging your changes. Closing for now.




Comment 4


Andrew Udvare





          2018-06-25 12:04:32 UTC
        

This is how to do it for a headless machine to stop confusion:

1. Use a non-headless machine and install plex-media-server.
2. Configure the server (/etc/).
3. Start the service.
4. Configure the server as normal at https://localhost:32400/web
5. Ensure expected things work.
6. Stop the service.
7. rsync /var/lib/plexmediaserver/ headless-server:/var/lib/plexmediaserver
8. Fix permissions in case: chown -R plex. /var/lib/plexmediaserver
9. On headless server, start the service. Open port 32400 if necessary.
10. On the non-headless machine create an SSH tunnel: ssh headless-server -L 8888:localhost:32400
11. Go to http://localhost:8888 and configure. Since the configuration was copied over, it will most likely start working immediately.

Maybe you want to add this information to the post-install notes?

The server is nearly impossible to install on a headless machine it seems, even when using local IP addresses (the guide says they should work). The best way is to configure/copy from a user machine (even a macOS one should work).




Comment 5


Jonathan Vasquez (RETIRED)






          2018-06-25 12:06:36 UTC
        

These steps seem better part of the plex wiki rather than adding more post installation notes (That most people won't need since this is a particular use case) to the end of the ebuild.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

