Title: 221903 – net.ppp0 inactive after baselayout upgrade to 2.0.0
URL: https://bugs.gentoo.org/show_bug.cgi?id=221903

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 221903
net.ppp0 inactive after baselayout upgrade to 2.0.0
Last modified: 2011-05-21 12:28:00 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 221903 
      - net.ppp0 inactive after baselayout upgrade to 2.0.0


Summary:
net.ppp0 inactive after baselayout upgrade to 2.0.0
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       major
      


Assignee:

OpenRC Team








URL:



http://forums.gentoo.org/viewtopic-p-...
        




Whiteboard:
openrc:oldnet:pppd  
  


Keywords:








Depends on:







Blocks:




295613



 

        Show dependency tree





 





      Reported:
    
2008-05-13 07:42 UTC by Jakub Bomba





      Modified:
    
2011-05-21 12:28 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



bug
net-dialup
srcv









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jakub Bomba





          2008-05-13 07:42:07 UTC
        

After update baselayout to to 2.0 (using this http://www.gentoo.org/doc/en/openrc-migration.xml) I the net.ppp0 doesn't work. I have no Internet connection. When i type /etc/init.d/net.ppp0 start I see a warning like:
net.ppp0 has started, but is inactive

Trying to restart I see:
error fetching interface information: Device not found

I've updated all config files to baselayout-2 type. All modules are loadet. Lsusb shows this device. So why does it not work?

Reproducible: Always

Steps to Reproduce:
1baselayout update to 2.0
2.run /etc/init.d/net.ppp0
3.

Actual Results:  
When I type /etc/init.d/net.ppp0 start I see a warning like:
net.ppp0 has started, but is inactive

Trying to restart I see:
error fetching interface information: Device not found

Expected Results:  
It should be no warnings and I should have a Internet connection.




Comment 1


Jakub Bomba





          2008-05-13 08:40:13 UTC
        

(In reply to comment #0)
> After update baselayout to to 2.0 (using this
> http://www.gentoo.org/doc/en/openrc-migration.xml) I the net.ppp0 doesn't work.
> I have no Internet connection. When i type /etc/init.d/net.ppp0 start I see a
> warning like:
> net.ppp0 has started, but is inactive
> 
> Trying to restart I see:
> error fetching interface information: Device not found
> 
> I've updated all config files to baselayout-2 type. All modules are loadet.
> Lsusb shows this device. So why does it not work?
> 
> Reproducible: Always
> 
> Steps to Reproduce:
> 1baselayout update to 2.0
> 2.run /etc/init.d/net.ppp0
> 3.
> 
> Actual Results:  
> When I type /etc/init.d/net.ppp0 start I see a warning like:
> net.ppp0 has started, but is inactive
> 
> Trying to restart I see:
> error fetching interface information: Device not found
> 
> Expected Results:  
> It should be no warnings and I should have a Internet connection.
> 

Internet works after little config changes. Now it is:
config_ppp0=( ppp ) # Runs /lib/rcscripts/net/pppd.sh
plugins_ppp0=( 'pppoa' )
link_ppp0='0.35' 
pppd_ppp0=( updetach noauth debug defaultroute noaccomp nobsdcomp noccp nodeflate nopcomp novj novjccomp child-timeout 60 )
username_ppp0='myusername@neostrada.pl'
password_ppp0='passwordabcd'

# If the kernel modules are not built-in, then they must be loaded
# before starting the PPP daemon:
function preup() {
if [[ "$1" = "ppp0" ]] ; then
mknod /dev/ppp c 108 0
modprobe -q ueagle-atm # lub 'modprobe -q speedtch' je<9c>li mamy Thompsona
return 0
fi
}

And now when I try to connect I see warnings:
 /etc/init.d/net.ppp0 restart
 * Caching service dependencies ...                                      [ ok ]
 * Bringing down interface ppp0
 *   Stopping pppd on ppp0                                               [ ok ]
 *   Removing addresses
ppp0: error fetching interface information: Device not found
ppp0: error fetching interface information: Device not found
 * Bringing up interface ppp0
 *   Running preup ...
 *   Starting pppd in ppp0 ...                                           [ ok ]
 *   received address 83.30.231.186/32
 * WARNING: net.ppp0 not under our control, aborting

any solution? 




Comment 2


Steve Yin





          2008-07-10 08:22:05 UTC
        

I have this problem too, but I also found this, if I add show-password option, then the log shows there is no password was set during the dail, so the connection simply says password error.

but if I set 'password realpassword' in the option, then there is no problem.

so I think the real problem is the /lib/rc/net/pppd.sh didn't use the password set in /etc/conf.d/net. it always uses a blank password when auth to your isp.

I have not tested put username and password into /etc/ppp/*-secrects file.




Comment 3


Alin Năstac (RETIRED)






          2009-05-10 14:05:09 UTC
        

The password bug should be solved by now. 
However, you should know that bash arrays are no longer supported in baselayout-2 /etc/conf.d/net. Instead you should use something like that:
pppd_ppp0=" option 1 ..." 
chat_ppp0="
ABORT 'NO DIALTONE'
...
"

If one parameter has " in it, you need to escape it like this: \\\"




Comment 4


Robin Johnson









          2011-03-30 09:01:41 UTC
        

No input from user in 18 months since developer commented.
If this is still a problem, please reopen.

I know this functionality works, as I rely on it to connect from home.




Comment 5


Lorenzo Raschi





          2011-05-12 21:19:33 UTC
        

(In reply to comment #4)
> No input from user in 18 months since developer commented.
> If this is still a problem, please reopen.
> 
> I know this functionality works, as I rely on it to connect from home.

Hello,

I've just updated to baselayout 2.0. Since them, when I start net.ppp0 I get the warning:

# WARNING: net.ppp0 has started, but is inactive 

In addition, none of the services which requires net at boot starts:
* WARNING: noip is scheduled to started when net.ppp0 has started
* WARNING: sshd is scheduled to started when net.ppp0 has started
* WARNING: dnsmasq is scheduled to started when net.ppp0 has started

Despite the message none of them starts, even waiting a long time.

The ppp0 part in /etc/conf.d/net is:

config_ppp0="ppp"
link_ppp0="8.35"                # PPPoA requires the ATM VC's address
plugins_ppp0="pppoa vc-encaps"  # Required plugin for PPPoA with an option

username_ppp0="xxxxx"
password_ppp0="yyyyy"
pppd_ppp0="+ipv6
        debug
        noipdefault
        defaultroute
        user xxxxx
        password yyyyy
        usepeerdns"

routes_ppp0="::/0"

Any clue?
Thanks to all,

Lorenzo


emerge --info:

Portage 2.1.9.42 (default/linux/amd64/10.0/no-multilib, gcc-4.4.5, libc-0-r0, 2.6.38.6 x86_64)
=================================================================
System uname: Linux-2.6.38.6-x86_64-Intel-R-_Core-TM-2_Duo_CPU_E8400_@_3.00GHz-with-gentoo-2.0.2
Timestamp of tree: Thu, 12 May 2011 20:15:01 +0000
app-shells/bash:     4.1_p9
dev-lang/python:     2.7.1-r1, 3.1.3-r1
sys-apps/baselayout: 2.0.2
sys-apps/openrc:     0.8.2-r1
sys-apps/sandbox:    2.4     
sys-devel/autoconf:  2.65-r1
sys-devel/automake:  1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.4.5
sys-devel/gcc-config: 1.4.1-r1
sys-devel/libtool:   2.2.10
sys-devel/make:      3.81-r2
sys-kernel/linux-headers: 2.6.36.1
sys-libs/glibc:      2.11.3
virtual/os-headers:  0
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O3 -march=core2 -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /var/qmail/alias /var/qmail/control /var/vpopmail/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O3 -march=core2 -pipe -fomit-frame-pointer"
DISTDIR="/tmp"
FEATURES="assume-digests binpkg-logs distlocks fixlafiles fixpackages news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="ftp://de-mirror.org/distro/gentoo/"
LANG="en_US.ISO-8859-1"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file
 --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.fr.gentoo.org/gentoo-portage"
USE="acl acpi activefilter afpacket alaw alsa amd64 amuled async atm audiofile authfile bzip2 caps cgi clamav cli cpudetection cracklib crypt curl cxx daemon deprecated dhcp digitalradio dump dynamicplugin eap-tls faac flac ftp g722 g729 gd gdbm h323 hpn iconv ipv6 javascript jpeg jpeg2k libedit lids lighttpd lm_sensors logmail mad mhash mmx modules mp3 mudflap ncurses network nls nptl nptlonly ogg openmp openssh padlock pcap pcre php pmu png pop3d python remote samba schroedinger sensord session softquota sqlite sse sse2 sse3 ssl subversion svg swat sysfs syslog sysvipc tcpd theora threads tiff truetype ulaw unicode urandom usb vhosts vorbis vpopmail x264 xinetd xml zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip
 navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="fbdev glint intel mach64 mga neomagic nouveau nv r128 radeon savage sis tdfx trident vesa via vmware dummy v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, LINGUAS, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 6


email200202





          2011-05-16 23:59:03 UTC
        

I have this problem too after updating to baselayout 2.0




Comment 7


Sr. Cv.





          2011-05-21 09:29:45 UTC
        

The same situation here...

### Net over BT ###

config_ppp0="ppp"
link_ppp0="/dev/rfcomm0"
phone_number_ppp0="*99***1#"
username_ppp0=''
password_ppp0=''
pppd_ppp0="
        maxfail 10
        noauth
        lcp-echo-interval 5
        lcp-echo-failure 12
        noipdefault
        defaultroute
        usepeerdns
        ipcp-accept-remote
        ipcp-accept-local
        holdoff 3
        noaccomp noccp nobsdcomp nodeflate nopcomp novj novjccomp
        912600
        lock
        nocrtscts"

chat_ppp0="
        'ABORT' 'BUSY'
        'ABORT' 'ERROR'
        'ABORT' 'NO ANSWER'
        'ABORT' 'NO CARRIER'
        'ABORT' 'NO DIALTONE'
        'ABORT' 'Invalid Login'
        'ABORT' 'Login incorrect'
        'TIMEOUT' '5'
        '' 'ATZ'
        'OK' 'ATM0'
        'OK' 'ATDT\T'
        'TIMEOUT' '60'
        'CONNECT' ''
        'TIMEOUT' '5'
        '~--' ''"




Comment 8


David Abbott (RETIRED)






          2011-05-21 12:28:00 UTC
        

srcv@zagorz.net No need to cc arches.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

