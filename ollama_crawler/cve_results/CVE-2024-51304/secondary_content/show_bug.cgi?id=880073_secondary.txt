Title: 880073 – sys-devel/gcc: ICE when building sys-devel/llvm-15.0.3 (type_traits:456:25: internal compiler error: Segmentation fault, in iterative_hash)
URL: https://bugs.gentoo.org/show_bug.cgi?id=880073

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 880073
sys-devel/gcc: ICE when building sys-devel/llvm-15.0.3 (type_traits:456:25: internal compiler error: Segmentation fault, in iterative_hash)
Last modified: 2022-11-08 16:53:36 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 880073 
      - sys-devel/gcc: ICE when building sys-devel/llvm-15.0.3 (type_traits:456:25: internal compiler error: Segmentation fault, in iterative_hash)


Summary:
sys-devel/gcc: ICE when building sys-devel/llvm-15.0.3 (type_traits:456:25: i...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2022-11-06 17:28 UTC by William Rabbermann





      Modified:
    
2022-11-08 16:53 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



herrtimson
jstein
llvm
sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info output

              (emergeinfo,6.40 KB,
                text/plain)

            
2022-11-06 17:28 UTC,

            William Rabbermann




Details





ANSI filtered build.log

              (buildlog.tar.gz,39.97 KB,
                application/gzip)

            
2022-11-06 17:31 UTC,

            William Rabbermann




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


William Rabbermann





          2022-11-06 17:28:18 UTC
        

Created attachment 828131 [details]
emerge --info output

Getting internal compiler error: Segmentation Fault when building latest LLVM on znver1 architecture.
No reported Out Of Memory errors, machine ran memtest and passed.

Full ANSI-filtered build.log is attached along with emerge --info. 


stack trace:

In file included from /usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/bits/move.h:57,
                 from /usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/bits/stl_pair.h:59,
                 from /usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/utility:70,
                 from /usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/tuple:38,
                 from /var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/ADT/DenseMapInfo.h:20,
                 from /var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/ADT/DenseMap.h:17,
                 from /var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/IR/PassManager.h:40,
                 from /var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/Analysis/LoopAnalysisManager.h:32,
                 from /var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/Transforms/Scalar/GuardWidening.h:18,
                 from /var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/lib/Transforms/Scalar/GuardWidening.cpp:41:
/usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/type_traits: In instantiation of ‘struct std::is_lvalue_reference<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> >’:
/usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/type_traits:129:12:   required from ‘struct std::__or_<std::is_lvalue_reference<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> >, std::is_rvalue_reference<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> > >’
/usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/type_traits:557:12:   required from ‘struct std::is_reference<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> >’
/usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/type_traits:134:12:   required from ‘struct std::__or_<std::is_reference<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> >, std::is_function<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> >, std::is_void<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> >, std::__is_array_unknown_bounds<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> > >’
/usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/type_traits:238:13:   required by substitution of ‘template<class _TypeIdentity, class _NestedType> constexpr typename std::__or_<std::is_reference<_NestedType>, std::is_function<_NestedType>, std::is_void<_NestedType>, std::__is_array_unknown_bounds<_NestedType> >::type std::__is_complete_or_unbounded(_TypeIdentity) [with _TypeIdentity = std::__type_identity<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> >; _NestedType = llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup>]’
/usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/type_traits:987:52:   required from ‘struct std::is_copy_constructible<llvm::detail::copy_construction_triviality_helper<llvm::RuntimeCheckingPtrGroup> >’
/var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/Support/type_traits.h:98:8:   required from ‘struct llvm::is_trivially_copy_constructible<llvm::RuntimeCheckingPtrGroup>’
/var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/ADT/SmallVector.h:308:74:   required from ‘class llvm::SmallVectorImpl<llvm::RuntimeCheckingPtrGroup>’
/var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/ADT/SmallVector.h:1185:22:   required from ‘class llvm::SmallVector<llvm::RuntimeCheckingPtrGroup, 2>’
/var/tmp/portage/sys-devel/llvm-15.0.3/work/llvm/include/llvm/Analysis/LoopAccessAnalysis.h:485:43:   required from here
/usr/lib/gcc/x86_64-pc-linux-gnu/11.3.0/include/g++-v11/type_traits:456:25: internal compiler error: Segmentation fault
  456 |     : public false_type { };
      |                         ^
0x179031f internal_error(char const*, ...)
	???:0
0x1804845 iterative_hash
	???:0
0x797f64 iterative_hash_template_arg(tree_node*, unsigned int)
	???:0
0x797eb7 iterative_hash_template_arg(tree_node*, unsigned int)
	???:0
0x797eb7 iterative_hash_template_arg(tree_node*, unsigned int)
	???:0
0x7cbee7 hash_table<spec_hasher, false, xcallocator>::expand()
	???:0
0x7cc1e9 hash_table<spec_hasher, false, xcallocator>::find_slot_with_hash(spec_entry* const&, unsigned int, insert_option)
	???:0
0x7c8d52 instantiate_class_template(tree_node*)
	???:0
0x7fdbcb complete_type(tree_node*)
	???:0
0x7d22b6 lookup_member(tree_node*, tree_node*, int, bool, int, access_failure_info*)
	???:0
0x7412d1 lookup_qualified_name(tree_node*, tree_node*, LOOK_want, bool)
	???:0
0x7b5233 tsubst_template_arg(tree_node*, tree_node*, int, tree_node*)
	???:0
0x7b5f03 tsubst_template_args(tree_node*, tree_node*, int, tree_node*)
	???:0
0x7aa6fb tsubst(tree_node*, tree_node*, int, tree_node*)
	???:0
0x7c8d52 instantiate_class_template(tree_node*)
	???:0
0x7fdbcb complete_type(tree_node*)
	???:0
0x7fdc6d complete_type_or_maybe_complain(tree_node*, tree_node*, int)
	???:0
0x7aac0a tsubst(tree_node*, tree_node*, int, tree_node*)
	???:0
0x7c8d52 instantiate_class_template(tree_node*)
	???:0
0x7fdbcb complete_type(tree_node*)
	???:0
Please submit a full bug report,
with preprocessed source if appropriate.
Please include the complete backtrace with any bug report.
See <https://bugs.gentoo.org/> for instructions.




Comment 1


William Rabbermann





          2022-11-06 17:31:35 UTC
        

Created attachment 828133 [details]
ANSI filtered build.log




Comment 2


Sam James









          2022-11-06 19:43:43 UTC
        

This would be a GCC bug. Please follow https://wiki.gentoo.org/wiki/Gcc-ICE-reporting-guide.




Comment 3


William Rabbermann





          2022-11-08 16:53:36 UTC
        

I looped 'emerge --nospinner -uND @world' until grep for 'internal compiler error: Segmentation fault' was null. Basically brute forced the compile because znver1 architecture is so spastic in tandem with gcc. Issue resolved.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

