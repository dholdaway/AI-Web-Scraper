Title: 114098 – OpenOffice 2 conflicts with xalan, fails during ANTBUILD: "invalid LOC header (bad signature)"
URL: https://bugs.gentoo.org/show_bug.cgi?id=114098

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 114098
OpenOffice 2 conflicts with xalan, fails during ANTBUILD: "invalid LOC header (bad signature)"
Last modified: 2006-02-02 11:07:52 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 114098 
      - OpenOffice 2 conflicts with xalan, fails during ANTBUILD: "invalid LOC header (bad signature)"


Summary:
OpenOffice 2 conflicts with xalan, fails during ANTBUILD: "invalid LOC header...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Office Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-11-30 19:21 UTC by Ben McIlwain





      Modified:
    
2006-02-02 11:07 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ben McIlwain





          2005-11-30 19:21:46 UTC
        

Compilation of OpenOffice 2 fails during ANTBUILD, giving some message about
"invalid LOC header (bad signature)"

Reproducible: Always
Steps to Reproduce:
Try compiling OpenOffice 2.
Actual Results:  
/usr/bin/ant -Dprj=../../../.. -Dprjname=ooo_beanshell -Ddebug=off -Doptimize=on
 -Dtarget=jarall -Dsolar.update=on -Dout=../../../../unxlngi4.pro
-Dinpath=unxlngi4.pro -Dproext=".pro" 
-Dsolar.bin=/var/tmp/portage/openoffice-2.0.0/work/ooo-build-2.0.0.1/build/ooo680-m3/solver/680/unxlngi4.pro/bin
-Dsolar.jar=/var/tmp/portage/openoffice-2.0.0/work/ooo-build-2.0.0.1/build/ooo680-m3/solver/680/unxlngi4.pro/bin
-Dsolar.doc=/var/tmp/portage/openoffice-2.0.0/work/ooo-build-2.0.0.1/build/ooo680-m3/solver/680/unxlngi4.pro/doc
 -Dcommon.jar=/var/tmp/portage/openoffice-2.0.0/work/ooo-build-2.0.0.1/build/ooo680-m3/solver/680/common.pro/bin
-Dcommon.doc=/var/tmp/portage/openoffice-2.0.0/work/ooo-build-2.0.0.1/build/ooo680-m3/solver/680/common.pro/doc
 -f build.xml  -emacs
Buildfile: build.xml

checkjjt:

jjtree:

checkjj:

javacc:

builddir:

compile:
Compiling 143 source files to
/var/tmp/portage/openoffice-2.0.0/work/ooo-build-2.0.0.1/build/ooo680-m3/beanshell/unxlngi4.pro/misc/build/BeanShell/classes
An exception has occurred in the compiler (1.4.2-02). Please file a bug at the
Java Developer Connection (http://java.sun.com/cgi-bin/bugreport.cgi)  after
checking the Bug Parade for duplicates. Include your program and the following
diagnostic in your report.  Thank you.
java.lang.InternalError: jzentry == 0,
 jzfile = 135844208,
 total = 1666,
 name = /usr/share/xalan/lib/xalan.jar,
 i = 983,
 message = invalid LOC header (bad signature)
        at java.util.zip.ZipFile$2.nextElement(ZipFile.java:323)
        at com.sun.tools.javac.v8.code.ClassReader.openArchive(ClassReader.java:975)
        at com.sun.tools.javac.v8.code.ClassReader.list(ClassReader.java:1218)
        at com.sun.tools.javac.v8.code.ClassReader.listAll(ClassReader.java:1339)
        at com.sun.tools.javac.v8.code.ClassReader.fillIn(ClassReader.java:1361)
        at com.sun.tools.javac.v8.code.ClassReader.complete(ClassReader.java:1052)
        at com.sun.tools.javac.v8.code.Symbol.complete(Symbol.java:372)
        at com.sun.tools.javac.v8.comp.Enter.visitTopLevel(Enter.java:467)
        at com.sun.tools.javac.v8.tree.Tree$TopLevel.accept(Tree.java:390)
        at com.sun.tools.javac.v8.comp.Enter.classEnter(Enter.java:442)
        at com.sun.tools.javac.v8.comp.Enter.classEnter(Enter.java:456)
        at com.sun.tools.javac.v8.comp.Enter.complete(Enter.java:596)
        at com.sun.tools.javac.v8.comp.Enter.main(Enter.java:582)
        at com.sun.tools.javac.v8.JavaCompiler.compile(JavaCompiler.java:331)
        at com.sun.tools.javac.v8.Main.compile(Main.java:569)
        at com.sun.tools.javac.Main.compile(Main.java:36)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:324)
        at org.apache.tools.ant.taskdefs.compilers.Javac13.execute(Javac13.java:55)
        at org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:936)
        at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:758)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)
        at org.apache.tools.ant.Task.perform(Task.java:364)
        at org.apache.tools.ant.Target.execute(Target.java:341)
        at org.apache.tools.ant.Target.performTasks(Target.java:369)
        at org.apache.tools.ant.Project.executeTarget(Project.java:1214)
        at org.apache.tools.ant.Project.executeTargets(Project.java:1062)
        at org.apache.tools.ant.Main.runBuild(Main.java:673)
        at org.apache.tools.ant.Main.startAnt(Main.java:188)
        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:196)
        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:55)

BUILD FAILED
/var/tmp/portage/openoffice-2.0.0/work/ooo-build-2.0.0.1/build/ooo680-m3/beanshell/unxlngi4.pro/misc/build/BeanShell/build.xml:176:
Compile failed; see the compiler error output for details.

Total time: 3 seconds
dmake:  Error code 1, while making 'ANTBUILD'
'---* tg_merge.mk *---'
dmake:  Error code 255, while making
'./unxlngi4.pro/misc/build/so_built_ooo_beanshell'
'---* tg_merge.mk *---'

ERROR: Error 65280 occurred while making
/var/tmp/portage/openoffice-2.0.0/work/ooo-build-2.0.0.1/build/ooo680-m3/beanshell
make: *** [stamp/build] Error 1

!!! ERROR: app-office/openoffice-2.0.0 failed.
!!! Function src_compile, Line 204, Exitcode 2
!!! Build failed
!!! If you need support, post the topmost build error, NOT this status message.


Expected Results:  
Installed successfully.

Portage 2.0.51.22-r3 (default-linux/x86/2005.0, gcc-3.3.6, glibc-2.3.5-r2,
2.6.13-gentoo-r3 i686)
=================================================================
System uname: 2.6.13-gentoo-r3 i686 AMD Athlon(tm)
Gentoo Base System version 1.6.13
dev-lang/python:     2.3.5-r2, 2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.20
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=athlon-xp -pipe -O2"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env
/usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config
/var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=athlon-xp -pipe -O2"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://distro.ibiblio.org/pub/linux/distributions/gentoo/
http://gentoo.cs.lewisu.edu/gentoo/ http://mirrors.acm.cs.rpi.edu/gentoo/"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X alsa apache2 apm arts audiofile avi berkdb bitmap-fonts bzip2 cdr crypt
cups curl dvd eds emboss encode esd ethereal exif expat fam ffmpeg foomaticdb
fortran ftp gd gdbm gif glut gnome gphoto2 gpm gstreamer gtk gtk2 idn
imagemagick imlib innodb ipv6 java jikes jpeg junit kde lcms libg++ libwww lua
mad mhash mikmod mng motif mozilla mp3 mpeg mysql ncurses nls ogg oggvorbis
openal opengl oss pam pcre pdflib perl png python qt quicktime readline recode
sdl slang spell ssl svga tcltk tcpd tetex tiff truetype truetype-fonts
type1-fonts udev usb vorbis win32codecs x86 xine xml xml2 xmms xv xvid zlib
userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


Andreas Proschofsky (RETIRED)






          2005-12-03 16:04:13 UTC
        

Looks like something in your java / ant-chain is broken. You could try to
rebuild ant-core and see if that helps. Also: Do you have xalan installed (you
don't need it, just asking)




Comment 2


Ben McIlwain





          2005-12-05 12:39:14 UTC
        

(In reply to comment #1)
> Looks like something in your java / ant-chain is broken. You could try to
> rebuild ant-core and see if that helps. Also: Do you have xalan installed (you
> don't need it, just asking)

I have recompiled ant-core to no avail.  And yes, I do have xalan.  Are you
thinking this bug is because of something wrong on my specific system or are you
thinking it's a bug with OpenOffice?




Comment 3


Andreas Proschofsky (RETIRED)






          2005-12-05 13:26:59 UTC
        

(In reply to comment #2)
> I have recompiled ant-core to no avail.  And yes, I do have xalan.  Are you
> thinking this bug is because of something wrong on my specific system or are you
> thinking it's a bug with OpenOffice?

As the ebuild is in portage for 6 weeks now and you are the first one to report
this, it is very likely that it is something on your system. But there is always
a slight chance that something really is wrong ;)

Most likely there is something wrong in you java / ant-parts.






Comment 4


Ben McIlwain





          2005-12-05 17:17:52 UTC
        

(In reply to comment #3)
> As the ebuild is in portage for 6 weeks now and you are the first one to report
> this, it is very likely that it is something on your system. But there is always
> a slight chance that something really is wrong ;)
> 
> Most likely there is something wrong in you java / ant-parts.

I'm willing to try recompiling pretty much anything to get this working, so what
should I do?  I've already recompiled ant-core, any other ideas?






Comment 5


Paul de Vrieze (RETIRED)






          2005-12-06 01:13:06 UTC
        

I would try to get a newer point release of the jdk. It's very possible that the
(INSECURE) jdk you are using has bugs in it's compiler too. The current version
is 1.4.2.10.




Comment 6


Ben McIlwain





          2005-12-07 17:03:14 UTC
        

(In reply to comment #5)
> I would try to get a newer point release of the jdk. It's very possible that the
> (INSECURE) jdk you are using has bugs in it's compiler too. The current version
> is 1.4.2.10.

I updated to the latest version of Java and I still got the error.  Then I went
ahead and unmerged xalan and OpenOffice has successfully been compiling for
hours now (it got way past that part where it was first failing).  So it seems
to me that there is some sort of conflict between xalan and openoffice.  I'll
change this bug's status appropriately.




Comment 7


Andreas Proschofsky (RETIRED)






          2006-01-15 11:36:54 UTC
        

Could you please try one more thing:

Add 

echo "--without-system-xalan" >> ${CONFFILE}

to the Use Flag checks section in the ebuild and see if that helps. Could be that OOo automatically finds the system-xalan and uses this if not explicitely disabled.




Comment 8


Andreas Proschofsky (RETIRED)






          2006-01-15 23:12:21 UTC
        

Forget what I said before, the current version doesn't even allow to build with system-xalan, so this shouldn't be the problem here...




Comment 9


Andreas Proschofsky (RETIRED)






          2006-01-29 04:53:47 UTC
        

(In reply to comment #6)

> I updated to the latest version of Java and I still got the error.  Then I went
> ahead and unmerged xalan and OpenOffice has successfully been compiling for
> hours now (it got way past that part where it was first failing).  So it seems
> to me that there is some sort of conflict between xalan and openoffice.  I'll
> change this bug's status appropriately.

Can't reproduce this, OOo builds fine even with xalan installed here. So it has to be something special about your java/xalan/ant-core-install






Comment 10


Andreas Proschofsky (RETIRED)






          2006-02-02 11:07:52 UTC
        

I'm closing this, can't reproduce and as long as you are the only one getting this, I'm sure it is something else wrong on your system. Still nothing we can do here, sorry...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

