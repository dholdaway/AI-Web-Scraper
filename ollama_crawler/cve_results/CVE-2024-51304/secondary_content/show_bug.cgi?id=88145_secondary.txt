Title: 88145 – rsync --delete-after cannot replace directory with file or symbolic link.
URL: https://bugs.gentoo.org/show_bug.cgi?id=88145

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 88145
rsync --delete-after cannot replace directory with file or symbolic link.
Last modified: 2006-05-11 20:42:00 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 88145 
      - rsync --delete-after cannot replace directory with file or symbolic link.


Summary:
rsync --delete-after cannot replace directory with file or symbolic link.
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Unspecified

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-06 04:00 UTC by Jakob Schiotz





      Modified:
    
2006-05-11 20:42 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jakob Schiotz





          2005-04-06 04:00:54 UTC
        

I use rsync to backup my laptop to a large USB harddisk, using the command 

rsync -axH --delete-after --exclude=/tmp --exclude=/var/tmp --exclude=/usr/portage --exclude=/scratch / /mnt/usb_backup/A

Sometimes I get an error if a directory has been replaced by a file or a symbolic link with the same name.  At the end, rsync will delete the directory, so the next rsync will be succesful.

In my opinion, rsync should have deleted the directory as soon as it became necessary to replace it with another object with the same name, in the same way as it deletes a file or a symbolic link to replace it with something else.  The current behaviour results in a copy that is not up to date.



Reproducible: Always
Steps to Reproduce:
1.
2.
3.




# equery belongs /usr/bin/rsync
[ Searching for file(s) /usr/bin/rsync in *... ]
net-misc/rsync-2.6.0-r4 (/usr/bin/rsync)

# emerge info
Portage 2.0.51.19 (default-linux/x86/2004.3, gcc-3.3.5, glibc-2.3.4.20041102-r1,
2.6.11-gentoo-r5i686)
=================================================================
System uname: 2.6.11-gentoo-r5 i686 Mobile Intel(R) Pentium(R) 4 - M CPU 2.00GHz
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb  9 2005, 12:08:49)]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r7
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-O2 -march=pentium4 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config
/usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/
/usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/
/usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=pentium4 -fomit-frame-pointer -pipe"
DISTDIR="/var/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms"
GENTOO_MIRRORS="http://trumpetti.atm.tut.fi/gentoo/
ftp://trumpetti.atm.tut.fi/gentoo/ ftp://ftp.rhnet.is/pub/gentoo/
ftp://gd.tuwien.ac.at/opsys/linux/gentoo/"
MAKEOPTS="-j2"
PKGDIR="/var/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 X Xaw3d acpi alsa arts atlas avi berkdb bitmap-fonts cdr crypt cups
curl dga dvd emacs emboss encode fam flac font-server foomaticdb fortran gdbm
gif gpm gtk gtk2 imagemagick imap imlib java jpeg kde libg++ libwww mad maildir
mbox mikmod mime motif mozilla mp3 mpeg mule ncurses netcdf nls nptl oggvobis
oggvorbis opengl oss pam pcmcia pdflib perl plotutils png pnp ppds python qt
quicktime readline scanner sdl slang smime spell sse ssl svga tcltk tcpd tetex
tiff truetype truetype-fonts trusted type1-fonts usb wxwindows xml2 xmms xv xvid
zlib linguas_dk"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS




Comment 1


SpanKY






          2005-04-06 05:30:51 UTC
        

does rsync-2.6.4 work any better ?




Comment 2


SpanKY






          2006-05-11 20:42:00 UTC
        

re-open if 2.6.8 still breaks









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

