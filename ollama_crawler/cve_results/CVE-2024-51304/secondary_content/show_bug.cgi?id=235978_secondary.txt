Title: 235978 – net-firewall/iptables-1.4.0-r1 build fails with USE=ipv6
URL: https://bugs.gentoo.org/show_bug.cgi?id=235978

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 235978
net-firewall/iptables-1.4.0-r1 build fails with USE=ipv6
Last modified: 2008-08-29 05:00:46 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 235978 
      - net-firewall/iptables-1.4.0-r1 build fails with USE=ipv6


Summary:
net-firewall/iptables-1.4.0-r1 build fails with USE=ipv6
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-08-28 05:09 UTC by Dustin J. Mitchell





      Modified:
    
2008-08-29 05:00 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Dustin J. Mitchell





          2008-08-28 05:09:18 UTC
        

x86_64-pc-linux-gnu-gcc -O2 -pipe -march=athlon64 -Wall -Wunused -I/usr/include -I/usr/include -Iinclude/ -DIPTABLES_VERSION=\"1.4.0\"  -DIP6T_LIB_DIR=\"/lib64/iptables\" -rdynamic -o ip6tables-restore ip6tables-restore.c ip6tables.o xtables.o libiptc/libiptc.a -ldl
/var/tmp/portage/net-firewall/iptables-1.4.0-r1/temp/ccZfUely.o: In function `main':
ip6tables-standalone.c:(.text+0x81): undefined reference to `ip6tc_strerror'
ip6tables-standalone.c:(.text+0xa8): undefined reference to `ip6tc_commit'
ip6tables.o: In function `mask_to_numeric':
ip6tables.c:(.text+0x5f5): undefined reference /var/tmp/portage/net-firewall/iptables-1.4.0-r1/temp/cct3GZvN.o: In function `print_ip':
ip6tables-save.c:(.text+0xc1): undefined reference to `ipv6_prefix_length'
/var/tmp/portage/net-firewall/iptables-1.4.0-r1/temp/cct3GZvN.o: In function `do_output':
ip6tables-save.c:(.text+0x18b): undefined reference to `ip6tc_init'
ip6tables-save.c:(.text+0x1ed): undefined reference to `ip6tc_first_chain'
ip6tables-save.c:(.text+0x20a): undefined reference to `ip6tc_get_policy'
ip6tables-save.c:(.text+0x237): undefined reference to `ip6tc_next_chain'
ip6tables-save.c:(.text+0x25b): undefined reference to `ip6tc_builtin'
ip6tables-save.c:(.text+0x273): undefined reference to `ip6tc_first_chain'
ip6tables-save.c:(.text+0x28e): undefined reference to `ip6tc_first_rule'
ip6tables-save.c:(.text+0x458): undefined reference to `ip6tc_get_target'
ip6tables-save.c:(.text+0x4bc): undefined reference to `ip6tc_next_rule'
ip6tables-save.c:(.text+0x4d0): undefined reference to `ip6tc_next_chain'
ip6tables-save.c:(.text+0x51a): undefined reference to `ip6tc_free'
ip6tables-save.c:(.text+0x6a8): undefined reference to `ip6tc_strerror'
ip6tables.o: In function `mask_to_numeric':
ip6tables.c:(.text+0x5f5): undefined reference to `ipv6_prefix_length'
ip6tables.o: In function `print_firewall':

(and lots more undefined references to ip6tc_* and ipv6_*)

Portage 2.1.4.4 (default-linux/amd64/2007.0, gcc-4.1.2, glibc-2.6.1-r0, 2.6.22-gentoo-r9-2007122801 x86_64)
=================================================================
System uname: 2.6.22-gentoo-r9-2007122801 x86_64 AMD Athlon(tm) 64 X2 Dual Core Processor 4800+
Timestamp of tree: Thu, 21 Aug 2008 13:45:01 +0000
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [disabled]
app-shells/bash:     3.2_p33
dev-lang/python:     2.4.4-r13, 2.5.2-r4
dev-python/pycrypto: 2.0.1-r6
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r2
sys-devel/automake:  1.5, 1.7.9-r1, 1.10.1
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=athlon64"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O2 -pipe -march=athlon64"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig collision-detect digest distlocks metadata-transfer nostrip sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://gentoo.mirrors.easynews.com/linux/gentoo/ http://mirror.mcs.anl.gov/pub/gentoo/ http://prometheus.cs.wmich.edu/gentoo "
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.us.gentoo.org/gentoo-portage"
USE="acl amd64 apache2 berkdb cli cracklib crypt cups dri fortran gdbm gpm iconv ipv6 isdnlog midi mmx mudflap mysql ncurses nls nptl nptlonly openmp pam pcre perl postgres postgresql pppd python readline reflection session spl sse sse2 ssl tcpd threads unicode vhosts xml xml2 xorg zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="access auth auth_basic authn_file auth_dbm auth_anon auth_digest authz_host authz_user alias file-cache filter echo charset-lite cache disk-cache mem-cache ext-filter case_filter case-filter-in deflate mime-magic cern-meta expires headers unique-id proxy proxy_http proxy_connect info include cgi cgid dav dav-fs vhost-alias rewrite log_config logio env setenvif mime status autoindex asis negotiation dir imap actions userdir so" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="apm ark chips cirrus cyrix dummy fbdev glint i128 i810 mach64 mga neomagic nv r128 radeon rendition s3 s3virge savage siliconmotion sis sisusb tdfx tga trident tseng v4l vesa vga via vmware voodoo"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

A build without ipv6 works just fine, as suggested by the missing symbols.  The missing symbols are declared in a header file in the iptables source, but not defined.  Perhaps there's a missing dependency here?  I'm fairly clueless about the whole thing.




Comment 1


Jeroen Roovers (RETIRED)






          2008-08-28 07:45:53 UTC
        

Please attach the entire build log to this bug report.




Comment 2


Dustin J. Mitchell





          2008-08-29 05:00:46 UTC
        

ugh! It works fine now.  I haven't re-sync'd portage since then, but I did compile iptables with USE=-ipv6 just to get the rest of my 'emerge world' finished.  The packages built in the interim are:

1219900265:  >>> emerge (1 of 29) dev-libs/glib-2.16.3-r1 to /
1219900464:  >>> emerge (2 of 29) dev-libs/openssl-0.9.8g-r2 to /
1219900710:  >>> emerge (3 of 29) dev-lang/python-2.5.2-r7 to /
1219900878:  >>> emerge (4 of 29) app-misc/ca-certificates-20080514-r2 to /
1219900888:  >>> emerge (5 of 29) dev-perl/Net-SSLeay-1.30 to /
1219900900:  >>> emerge (6 of 29) dev-lang/python-2.4.4-r14 to /
1219901049:  >>> emerge (1 of 24) dev-lang/python-2.4.4-r14 to /
1219901179:  >>> emerge (2 of 24) net-nds/openldap-2.3.43 to /
1219901546:  >>> emerge (3 of 24) net-analyzer/tcpdump-3.9.8-r1 to /
1219901590:  >>> emerge (4 of 24) dev-libs/libxml2-2.6.32 to /
1219901726:  >>> emerge (5 of 24) net-misc/curl-7.18.2 to /
1219901851:  >>> emerge (6 of 24) dev-python/setuptools-0.6_rc8-r1 to /
1219929970:  >>> emerge (1 of 19) dev-python/setuptools-0.6_rc8-r1 to /
1219929986:  >>> emerge (2 of 19) dev-perl/IO-Socket-SSL-1.12 to /
1219929998:  >>> emerge (3 of 19) dev-python/twisted-8.1.0 to /
1219930023:  >>> emerge (4 of 19) dev-libs/libxslt-1.1.24-r1 to /
1219930099:  >>> emerge (5 of 19) dev-perl/Net-SMTP-SSL-1.01 to /
1219930106:  >>> emerge (6 of 19) dev-python/twisted-names-8.1.0 to /
1219930124:  >>> emerge (7 of 19) dev-python/twisted-web-8.1.0 to /
1219930139:  >>> emerge (8 of 19) dev-util/git-1.5.6.4 to /
1219930199:  >>> emerge (9 of 19) dev-python/twisted-mail-8.1.0 to /
1219930219:  >>> emerge (10 of 19) dev-python/twisted-words-8.1.0 to /
1219930238:  >>> emerge (11 of 19) dev-db/mysql-5.0.60-r1 to /
1219930774:  >>> emerge (12 of 19) dev-libs/apr-util-1.3.2 to /
1219930816:  >>> emerge (13 of 19) app-admin/apache-tools-2.2.9 to /
1219930852:  >>> emerge (14 of 19) www-servers/apache-2.2.9 to /
1219930971:  >>> emerge (15 of 19) mail-mta/postfix-2.5.3-r1 to /
1219932242:  >>> emerge (1 of 5) mail-mta/postfix-2.5.3-r1 to /
1219932305:  >>> emerge (2 of 5) sys-libs/pam-1.0.1 to /
1219932445:  >>> emerge (3 of 5) sys-auth/pambase-20080318 to /
1219932451:  >>> emerge (4 of 5) sys-apps/man-pages-3.05 to /
1219932465:  >>> emerge (5 of 5) sys-apps/man-pages-posix-2003a to /

none of which seems a likely candidate for changing the way iptables would build (gcc, glib, or kernel headers would raise my suspicion, but I don't see them here).

I'm closing as WORKSFORME.  If there's some hidden dependency you'd like me to dig for, though, please reopen and post more instructions.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

