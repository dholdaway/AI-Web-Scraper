Title: 98778 – menuconfig is garbled when using splashutils-1.1.9.6-r1 and newer
URL: https://bugs.gentoo.org/show_bug.cgi?id=98778

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 98778
menuconfig is garbled when using splashutils-1.1.9.6-r1 and newer
Last modified: 2006-07-12 03:39:08 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 98778 
      - menuconfig is garbled when using splashutils-1.1.9.6-r1 and newer


Summary:
menuconfig is garbled when using splashutils-1.1.9.6-r1 and newer
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       minor
      


Assignee:

Michal Januszewski (RETIRED)








URL:



http://homepage.mac.com/jochs/files/s...
        




Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-07-12 07:58 UTC by Joshua Ochs





      Modified:
    
2006-07-12 03:39 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Custom livecd fbsplash

              (livecd-custom.tar.bz2,1.27 MB,
                application/octet-stream)

            
2005-07-12 12:37 UTC,

            Joshua Ochs




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Joshua Ochs





          2005-07-12 07:58:12 UTC
        

After updating my system ( including an update from splashutils 1.1.9.5 to 1.1.9.6-r1/1.1.9.7), running 
"make menuconfig" for kernel configuration is horribly garbled, with text artifacts appearing on the 
screen; mostly on the lefthand side. The program is still functional, but this makes it very hard to use, and 
completely obscures the help screens.

Reproducible: Always
Steps to Reproduce:
1. Set up a kernel for fbsplash
2. emerge splashutils-1.1.9.6-r1 or newer
3. Boot with a properly configured fbsplash
4. Enter a kernel source tree (clean or otherwise - I used gentoo-sources) and "make menuconfig"
Actual Results:  
The screen is garbled as shown above, with strange text covering large portions of the left side.

Expected Results:  
None of the artifacts should appear; indeed, they do not when fbsplash is not active.

First of all, this does not occur when fbsplash is not being used. I have disabled the splash rc item (rc-
update del splash), so fbsplash is only used when specified as a kernel argument in grub. This is my 
grub.conf for splash and non-splash:

title Gentoo Vanilla
	root (hd0,3)
	kernel /kernel/2.6.12-gentoo-r4/vmlinuz ro root=/dev/sda4
title Gentoo Splash
	root (hd0,3)
	kernel /kernel/2.6.12-gentoo-r4/vmlinuz ro root=/dev/sda4 quiet video=vesafb:ypan,mtrr,
1280x1024-32@85 CONSOLE=/dev/tty1 splash=verbose,theme:livecd-custom
	initrd /kernel/2.6.12-gentoo-r4/splash-livecd-custom

"Gentoo Vanilla" has no problems with menuconfig. "Gentoo Splash" exhibits errors as seen in the URL.


# emerge info
Portage 2.0.51.22-r1 (default-linux/x86/2005.0, gcc-3.3.5-20050130, glibc-2.3.4.20041102-r1, 
2.6.12-gentoo-r4 i686)
===============================================================
==
System uname: 2.6.12-gentoo-r4 i686 Pentium II (Deschutes)
Gentoo Base System version 1.6.12
dev-lang/python:     2.3.5
sys-apps/sandbox:    1.2.10
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.5
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.18-r1
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=i686 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/share/config /var/
qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/splash /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=i686 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/Linux/distributions/
gentoo"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 alsa apm avi berkdb crypt cups emboss encode foomaticdb fortran gdbm gif gpm imlib ipv6 
jpeg libg++ libwww mad mikmod mp3 mpeg ncurses nls ogg oggvorbis oss pam pdflib perl png 
python quicktime readline samba spell ssl svga tcpd tiff vorbis xml2 xv zlib userland_GNU kernel_linux 
elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


Michal Januszewski (RETIRED)






          2005-07-12 11:47:39 UTC
        

Does the problem occur in any other applications, or is it specific to 'make
menuconfig'? Could you please upload somewhere a tarball with the theme configs
and images? (I can see you're using some kind of modified gentoo-livecd-2005.0
theme)




Comment 2


Joshua Ochs





          2005-07-12 12:37:58 UTC
        

Created attachment 63261 [details]
Custom livecd fbsplash

This is the fbsplash I have been using when the problems occur. It's a modified
version of the 2005.0 LiveCD splash.




Comment 3


Joshua Ochs





          2005-07-12 12:39:56 UTC
        

I'm not sure what other applications I can test - I what other applications would be good candidates? 
Nothing else I use takes over the whole screen as "make menuconfig" does (this box is usually a home 
server, running things like NFS, samba, and bittorrent for new ISO's).




Comment 4


Michal Januszewski (RETIRED)






          2005-07-12 17:36:50 UTC
        

Nice theme, but I was unable to reproduce the problem with it, so probably the
bug is not theme-specific (you might want to check with some other themes, like
livecd-2005.0 or emergence just to be sure). Did fbsplash/splashutils work for
you before upgrading your system? If yes, which version of gentoo-sources were
using before?




Comment 5


Joshua Ochs





          2005-07-12 19:04:17 UTC
        

(In reply to comment #4)
> Nice theme, but I was unable to reproduce the problem with it, so probably the
> bug is not theme-specific (you might want to check with some other themes, like
> livecd-2005.0 or emergence just to be sure). Did fbsplash/splashutils work for
> you before upgrading your system? If yes, which version of gentoo-sources were
> using before?

I was previously using 2.6.11-gentoo-r6 with splashutils 1.1.9.5. I updated my system (an emerge 
world), and tried both splashutils 1.1.9.6-r1 and 1.1.9.7 and the current 2.6.12-gentoo-r4 kernel.

Just to try and clarify, this happens under any combination of splashutils 1.1.9.6-r1 or splashutils 
1.1.9.7, running under kernel 2.6.11-gentoo-r6 or 2.6.12-gentoo-r4, and when using make 
menuconfig on the source tree for 2.6.11-gentoo-r6 or 2.6.12-gentoo-r4. I have not attempted 
downgrading to splashutils 1.1.9.5 yet.

Now, obviously something else may have changed in the 50-odd packages that were updated. However, 
the fact remains that when the splash is off, it works. When it's on, it fails. Why, I have no clue - I know 
next to nothing about the issues surrounding the framebuffer, console text, and the like.




Comment 6


Daniel Perzynski





          2005-08-08 03:44:49 UTC
        

I can confirm that problem with splashutils 1.1.9.5 up to the newest version 
1.1.9.8 and with gentoo-sources 2.6.11 and 2.6.12 both newest versions. The 
same problem i have not only with make menuconfig but also for example with 
Midnight Commander.




Comment 7


Daniel Perzynski





          2005-08-09 04:02:49 UTC
        

I've done a test again today :) I didn't touch splashutils or kernel but I've 
looked and console setup. I've tried to solve that problem these was because 
when I was connecting to my machine via SSH remotely (Midnight Commander and 
make menuconfig) were looking fine :) The only thing which I've changed to have 
the MC and make menuconfig working fine was a change to /etc/rc.conf. I've 
changed UNICODE to no :)) Now everything is fine. 




Comment 8


Joshua Ochs





          2005-08-09 10:53:13 UTC
        

Sadly, UNICODE is set to "NO" on my system, and I don't have a custom consolefont set. I'm still seeing the 
garbled text in menuconfig.




Comment 9


Daniel Perzynski





          2005-08-10 03:27:31 UTC
        

I've checked a printscreen on your homepage and it looks for me as a problem 
with graphics card display. Do you have that problem only in make menuconfig ? 
What about Midnight Commander? What is your graphics card? and what is in your 
kernel .config file for video frame buffer ?




Comment 10


Joshua Ochs





          2005-08-14 13:19:28 UTC
        

I don't have Midnight Commander, so I don't know how it would work. My graphics card is an older ATI 
Rage 8MB card. Here's the requested kernel config section:

#
# Graphics support
#
CONFIG_FB=y
CONFIG_FB_CFB_FILLRECT=y
CONFIG_FB_CFB_COPYAREA=y
CONFIG_FB_CFB_IMAGEBLIT=y
CONFIG_FB_SOFT_CURSOR=y
# CONFIG_FB_MACMODES is not set
CONFIG_FB_MODE_HELPERS=y
# CONFIG_FB_TILEBLITTING is not set
# CONFIG_FB_CIRRUS is not set
# CONFIG_FB_PM2 is not set
# CONFIG_FB_CYBER2000 is not set
# CONFIG_FB_ASILIANT is not set
# CONFIG_FB_IMSTT is not set
# CONFIG_FB_VGA16 is not set
CONFIG_FB_VESA=y
# CONFIG_FB_VESA_STD is not set
CONFIG_FB_VESA_TNG=y
CONFIG_FB_VESA_DEFAULT_MODE="1280x1024-32@85"
CONFIG_VIDEO_SELECT=y
# CONFIG_FB_HGA is not set
# CONFIG_FB_NVIDIA is not set
# CONFIG_FB_RIVA is not set
# CONFIG_FB_I810 is not set
# CONFIG_FB_INTEL is not set
# CONFIG_FB_MATROX is not set
# CONFIG_FB_RADEON_OLD is not set
# CONFIG_FB_RADEON is not set
# CONFIG_FB_ATY128 is not set
CONFIG_FB_ATY=m
CONFIG_FB_ATY_CT=y
# CONFIG_FB_ATY_GENERIC_LCD is not set
# CONFIG_FB_ATY_XL_INIT is not set
CONFIG_FB_ATY_GX=y
# CONFIG_FB_SAVAGE is not set
# CONFIG_FB_SIS is not set
# CONFIG_FB_NEOMAGIC is not set
# CONFIG_FB_KYRO is not set
# CONFIG_FB_3DFX is not set
# CONFIG_FB_VOODOO1 is not set
# CONFIG_FB_TRIDENT is not set
# CONFIG_FB_GEODE is not set
# CONFIG_FB_S1D13XXX is not set
# CONFIG_FB_VIRTUAL is not set

#
# Console display driver support
#
CONFIG_VGA_CONSOLE=y
CONFIG_DUMMY_CONSOLE=y
CONFIG_FRAMEBUFFER_CONSOLE=y
# CONFIG_FONTS is not set
CONFIG_FONT_8x8=y
CONFIG_FONT_8x16=y

#
# Logo configuration
#
CONFIG_LOGO=y
# CONFIG_LOGO_LINUX_MONO is not set
# CONFIG_LOGO_LINUX_VGA16 is not set
CONFIG_LOGO_LINUX_CLUT224=y
# CONFIG_BACKLIGHT_LCD_SUPPORT is not set
CONFIG_FB_SPLASH=y





Comment 11


Daniel Perzynski





          2005-08-16 01:43:45 UTC
        

I would suggest to remove Ati Framebuffer support. I wonder why you have 
applied config logo ?

>CONFIG_LOGO=y
># CONFIG_LOGO_LINUX_MONO is not set
># CONFIG_LOGO_LINUX_VGA16 is not set
>CONFIG_LOGO_LINUX_CLUT224=y





Comment 12


Joshua Ochs





          2005-08-16 08:54:54 UTC
        

If I remove ATI support, how am I supposed to use my video card? I'll see what happens if I just remove 
boot logo - that's a leftover from a long time back.




Comment 13


Joshua Ochs





          2005-08-16 17:07:01 UTC
        

No dice. Tried removing ATI support, and it locked *very* early during boot (just after VESA 2.0). Removed 
Boot Logo; no change.




Comment 14


Joshua Ochs





          2005-09-08 13:20:22 UTC
        

I can't test at the moment (rebuilding my server), but could this be a problem
with ncurses? I'll try rebuilding that once I'm back up and running.

In other news, I also updated to the latest kernel (2.6.12-gentoo-r9) and
splashutils (1.1.9.9, I think) and no change.




Comment 15


Michal Januszewski (RETIRED)






          2005-09-18 18:00:23 UTC
        

The info provided in bug #105529 seems to indicate that the problem is actually
caused by the framebuffer driver, not by fbsplash itself. Could you please try
running with another graphics driver? (vesafb -- the standard driver, not
vesafb-tng, or the ATI driver (you'll have to set it to 'y', not to 'm')).




Comment 16


Joshua Ochs





          2005-09-21 16:23:12 UTC
        

My apologies for the delay - I was waiting on some replacement parts for my server before I could test 
this. I can verify that this bug disappears when using radeonfb, so this bug report can probably be closed.

Thanks!




Comment 17


Michal Januszewski (RETIRED)






          2006-07-12 03:39:08 UTC
        

OK, closing then.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

