Title: 269946 – x11-drivers/xf86-video-intel-2.7.1 hangs/crashes when logging into GNOME
URL: https://bugs.gentoo.org/show_bug.cgi?id=269946

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 269946
x11-drivers/xf86-video-intel-2.7.1 hangs/crashes when logging into GNOME
Last modified: 2009-05-15 17:17:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 269946 
      - x11-drivers/xf86-video-intel-2.7.1 hangs/crashes when logging into GNOME


Summary:
x11-drivers/xf86-video-intel-2.7.1 hangs/crashes when logging into GNOME
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Unspecified

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-05-15 13:43 UTC by Priit Laes (IRC: plaes)





      Modified:
    
2009-05-15 17:17 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



jlec
SebastianLuther









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Xorg.0.log

              (Xorg.0.log,27.27 KB,
                text/plain)

            
2009-05-15 13:45 UTC,

            Priit Laes (IRC: plaes)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Priit Laes (IRC: plaes)





          2009-05-15 13:43:39 UTC
        

Here's the backtrace I get:

__lll_lock_wait () at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:130
130	../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S: No such file or directory.
	in ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S
(gdb) bt
#0  __lll_lock_wait () at ../nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S:130
#1  0x00007f0b5300ec50 in _L_lock_102 () from /lib/libpthread.so.0
#2  0x00007f0b5300e53e in __pthread_mutex_lock (mutex=0x1b4df20) at pthread_mutex_lock.c:86
#3  0x00007f0b4ffe53ee in drm_intel_gem_bo_unmap (bo=0x499ffd0) at intel_bufmgr_gem.c:768
#4  0x00007f0b502095eb in intel_batch_flush (pScrn=0x1b466e0, flushed=128) at i830_batchbuffer.c:197
#5  0x00007f0b50208e84 in I830Sync (pScrn=0x1b466e0) at i830_accel.c:193
#6  0x00007f0b502158ab in I830LeaveVT (scrnIndex=<value optimized out>, flags=<value optimized out>) at i830_driver.c:3428
#7  0x0000000000460cc2 in AbortDDX () at xf86Init.c:1507
#8  0x00000000004e5795 in AbortServer () at log.c:407
#9  0x00000000004e5d52 in FatalError (f=0x5568b0 "Caught signal %d.  Server aborting\n") at log.c:553
#10 0x0000000000470bde in xf86SigHandler (signo=11) at xf86Events.c:593
#11 <signal handler called>
#12 0x00007f0b4ffe5a58 in drm_intel_gem_bo_unreference_locked (bo=0x4a2f480) at intel_bufmgr_gem.c:585
#13 0x00007f0b4ffe5988 in drm_intel_gem_bo_unreference_locked (bo=0x4a2f610) at intel_bufmgr_gem.c:561
#14 0x00007f0b4ffe5988 in drm_intel_gem_bo_unreference_locked (bo=0x4a2f6c0) at intel_bufmgr_gem.c:561
#15 0x00007f0b4ffe5e3a in drm_intel_gem_bo_unreference (bo=0x4a2f6c0) at intel_bufmgr_gem.c:599
#16 0x00007f0b5023b187 in i965_prepare_composite (op=3, pSrcPicture=0x49ee4f0, pMaskPicture=0x4a2f980, pDstPicture=0x4a2f200, pSrc=0x4a2fa30, 
    pMask=0x4a2fa30, pDst=0x49a8cb0) at i965_render.c:1350
#17 0x00007f0b5024898e in uxa_try_driver_composite (op=128 '\200', pSrc=0x49ee4f0, pMask=0x4a2f980, pDst=0x4a2f200, xSrc=0, ySrc=0, 
    xMask=<value optimized out>, yMask=<value optimized out>, xDst=11, yDst=0, width=<value optimized out>, height=<value optimized out>)
    at uxa-render.c:489
#18 0x00007f0b50249f4d in uxa_composite (op=3 '\003', pSrc=0x49ee4f0, pMask=0x4a2f980, pDst=0x4a2f200, xSrc=0, ySrc=0, xMask=0, yMask=0, xDst=11, 
    yDst=0, width=48, height=48) at uxa-render.c:747
#19 0x0000000000516e33 in damageComposite (op=128 '\200', pSrc=0x49ee4f0, pMask=0x4a2f980, pDst=0x4a2f200, xSrc=0, ySrc=0, xMask=-27536, 
    yMask=<value optimized out>, xDst=<value optimized out>, yDst=<value optimized out>, width=<value optimized out>, height=<value optimized out>)
    at damage.c:576
#20 0x00000000005078a7 in ProcRenderComposite (client=0x49bef80) at render.c:729
#21 0x0000000000447ff2 in Dispatch () at dispatch.c:454
#22 0x00000000004309fd in main (argc=9, argv=0x7fff73c48b08, envp=<value optimized out>) at main.c:438
Current language:  auto; currently asm




Comment 1


Priit Laes (IRC: plaes)





          2009-05-15 13:45:26 UTC
        

Created attachment 191369 [details]
Xorg.0.log




Comment 2


Sebastian Luther (few)





          2009-05-15 14:06:15 UTC
        

Please attach emerge --info, "emerge -pvq libdrm xf86-video-intel mesa xorg-server", xorg.conf and the full output of dmesg.




Comment 3


Priit Laes (IRC: plaes)





          2009-05-15 14:19:04 UTC
        

With xorg-server-1.6.1 things work fine.

[ebuild   R   ] x11-libs/libdrm-2.4.9  USE="-debug" 0 kB [0]
[ebuild   R   ] media-libs/mesa-7.4.1-r2  USE="nptl xcb -debug -doc -motif -pic" VIDEO_CARDS="intel -mach64 -mga -none -r128 -radeon -radeonhd -s3virge -savage -sis (-sunffb) -tdfx -trident -via" 0 kB [0]
[ebuild   R   ] x11-base/xorg-server-1.6.1  USE="hal ipv6 nptl sdl xorg (-3dfx) -debug -dmx -kdrive -minimal -tslib" INPUT_DEVICES="evdev keyboard mouse -acecad -aiptek -calcomp -citron -digitaledge -dmc -dynapro -elo2300 -elographics -fpit -hyperpen -jamstudio -joystick -magellan -microtouch -mutouch -palmax -penmount -spaceorb -summa -synaptics -tek4957 -tslib -ur98 -virtualbox -vmmouse -void -wacom" VIDEO_CARDS="intel -apm -ark -ast -chips -cirrus -dummy -epson -fbdev (-fglrx) (-geode) -glint -i128 (-i740) (-impact) (-imstt) -mach64 -mga -neomagic -nv -nvidia -r128 -radeon -radeonhd -rendition -s3 -s3virge -savage -siliconmotion -sis -sisusb (-sunbw2) (-suncg14) (-suncg3) (-suncg6) (-sunffb) (-sunleo) (-suntcx) -tdfx -tga -trident -tseng -v4l (-vermilion) -vesa -via -virtualbox -vmware -voodoo (-xgi)" 0 kB [1]
[ebuild   R   ] x11-drivers/xf86-video-intel-2.7.1  USE="dri -debug" 0 kB [0]





Comment 4


Priit Laes (IRC: plaes)





          2009-05-15 14:19:48 UTC
        

plaes@sol ~ $ emerge --info
Portage 2.2_rc33 (default/linux/amd64/2008.0/no-multilib, gcc-4.3.3, glibc-2.9_p20081201-r2, 2.6.30-rc5 x86_64)
=================================================================
System uname: Linux-2.6.30-rc5-x86_64-Intel-R-_Core-TM-2_CPU_6320_@_1.86GHz-with-gentoo-2.0.0
Timestamp of tree: Fri, 15 May 2009 13:30:01 +0000
app-shells/bash:     4.0_p17-r1
dev-java/java-config: 2.1.7
dev-lang/python:     2.6.2
dev-util/cmake:      2.6.4
sys-apps/baselayout: 2.0.0
sys-apps/openrc:     0.4.3-r2
sys-apps/sandbox:    1.9
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.19.1-r1
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   1.3.5, 2.2.6a
virtual/os-headers:  2.6.29
ACCEPT_KEYWORDS="amd64 ~amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=nocona -O2 -ggdb -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-march=nocona -O2 -ggdb -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="collision-protect distlocks fixpackages multilib-strict parallel-fetch preserve-libs protect-owned sandbox sfperms splitdebug strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LDFLAGS="-Wl,-O1,--as-needed"
LINGUAS="en et"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/home/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/x11 /opt/overlay"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acpi alsa amd64 apache2 automount avahi berkdb bzip2 cairo cdr cli consolekit cracklib crypt cups curl daap dbus dga dri dvd dvdr eds encode exif faac faad ffmpeg fftw flac fontconfig fortran gdbm gif gimp git glib glitz gmp gnome gnome-keyring gphoto2 gsl gstreamer gtk hal havekernel hdf5 hdri iconv idn ipv6 isdnlog jpeg jpeg2k kpathsea kqemu kvm lapack laptop latex lcms libnotify live lua lzma mad midi mmx mp3 mpeg mudflap nautilus ncurses network-cron nls nptl nptlonly nsplugin ogg openexr opengl openmp pam pch pcre pdf perl plotutils png pppd python qemu qt3support quicktime raw readline reflection sdl server session smp spl sse sse2 ssh ssl ssse3 startup-notification subversion svg sysfs tcpd tga theora threads tiff totem truetype unicode vim-syntax vorbis webdav x264 xcb xinerama xml xmp xorg xulrunner xv xvid xvmc zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en et" USERLAND="GNU" VIDEO_CARDS="intel"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 5


Priit Laes (IRC: plaes)





          2009-05-15 17:17:58 UTC
        

Marking WORKSFORME as it is.. :)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

