Title: 399145 – eautoreconf call from autotools-utils.eclass should respect AT_M4DIR and similar
URL: https://bugs.gentoo.org/show_bug.cgi?id=399145

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 399145
eautoreconf call from autotools-utils.eclass should respect AT_M4DIR and similar
Last modified: 2012-01-22 22:52:26 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 399145 
      - eautoreconf call from autotools-utils.eclass should respect AT_M4DIR and similar


Summary:
eautoreconf call from autotools-utils.eclass should respect AT_M4DIR and similar
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Michał Górny








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-01-17 09:29 UTC by Justin Lecher (RETIRED)





      Modified:
    
2012-01-22 22:52 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Justin Lecher (RETIRED)






          2012-01-17 09:29:15 UTC
        

autotools_src_prepare should respect other locations for file sepcified by AT_M4DIR and similar. I tried to port sci-libs/clipper but eautoreconf doesn't get called because the AT_M4DIR="config" isn'r reespected.




Comment 1


Michał Górny









          2012-01-17 09:45:20 UTC
        

That's weird. It seems that autotools.eclass handles that internally. I'll try to take a look at the specific package.




Comment 2


Michał Górny









          2012-01-17 09:48:58 UTC
        

 * Autoreconfiguring '/tmp/portage/sci-libs/clipper-20100511-r1/work/clipper-2.1' ...
 * Running libtoolize --copy --force --install --automake ...                             [ ok ]
 * Running aclocal -I config -I config ...                                                [ ok ]

with AT_M4DIR="config" autotools-utils_src_prepare.




Comment 3


Justin Lecher (RETIRED)






          2012-01-17 09:52:24 UTC
        

So please run the tests with and without the use of the eclass. There must be a difference. For me it seems that eautoreconf doesn't run.




Comment 4


Michał Górny









          2012-01-17 09:59:58 UTC
        

(In reply to comment #3)
> So please run the tests with and without the use of the eclass. There must be a
> difference. For me it seems that eautoreconf doesn't run.

Well, AFAICS the difference would be that we use default_src_test() which doesn't pass args. I guess that's the problem needing fixing. Could you attach your ebuild?




Comment 5


Justin Lecher (RETIRED)






          2012-01-17 10:03:44 UTC
        

http://dev.gentoo.org/~jlec/paste/clipper-20100511-r1.ebuild
http://dev.gentoo.org/~jlec/paste/20100511-makefile.patch




Comment 6


Justin Lecher (RETIRED)






          2012-01-17 10:04:38 UTC
        

> Well, AFAICS the difference would be that we use default_src_test() which
> doesn't pass args. 
somehow there is no check target anymore in the Makefiles after using the eclass.




Comment 7


Michał Górny









          2012-01-17 10:08:11 UTC
        

You gotta 'cd ${AUTOTOOLS_BUILD_DIR}' if you don't want to use autotools-utils_src_*(). I'll turn this bug into 'fixing autotools-utils_src_test() to support args' if you don't mind.

It is generally recommended to use 'autotools-utils_src_compile' instead of 'emake' as it jumps to the right directory.




Comment 8


Justin Lecher (RETIRED)






          2012-01-17 10:11:03 UTC
        

I don't use autotools-utils_src_test. also manually runing make check fails because the target is missing in the make file.




Comment 9


Justin Lecher (RETIRED)






          2012-01-17 10:17:23 UTC
        

>>> Source compiled.
make -j16 -l12 -C examples check 
make: Entering directory `/var/tmp/portage/sci-libs/clipper-20100511-r1/work/clipper-2.1/examples'
make: *** No rule to make target `check'.  Stop.
make: Leaving directory `/var/tmp/portage/sci-libs/clipper-20100511-r1/work/clipper-2.1/examples'
 * ERROR: sci-libs/clipper-20100511-r1 failed (test phase):
 *   emake failed




Comment 10


Justin Lecher (RETIRED)






          2012-01-17 10:19:04 UTC
        

Okay I got it :)
Please do what you think is best.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

