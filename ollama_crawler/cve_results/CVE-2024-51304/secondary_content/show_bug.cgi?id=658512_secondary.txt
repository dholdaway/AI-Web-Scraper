Title: 658512 – media-gfx/zbar-0.10_p20121015-r3  with imagemagick v4l USE flag - build fails - no such file
URL: https://bugs.gentoo.org/show_bug.cgi?id=658512

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 658512
media-gfx/zbar-0.10_p20121015-r3  with imagemagick v4l USE flag - build fails - no such file
Last modified: 2018-09-14 15:13:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 658512 
      - media-gfx/zbar-0.10_p20121015-r3  with imagemagick v4l USE flag - build fails - no such file


Summary:
media-gfx/zbar-0.10_p20121015-r3  with imagemagick v4l USE flag - build fails...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Michael Weber (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2018-06-19 17:29 UTC by Graham





      Modified:
    
2018-09-14 15:13 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



jstein
maxbritov









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Graham





          2018-06-19 17:29:13 UTC
        

When I tried to install media-gfx/zbar-0.10_p20121015-r3  
with USE="imagemagick v4l"
It fails with the errors 
/usr/bin/install: cannot stat '/var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/man/zbarimg.1': No such file or directory
/usr/bin/install: cannot stat '/var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/man/zbarcam.1': No such file or directory

the previous version i had (zbar-0.10) works fine with these flags. 



 





Reproducible: Always

Steps to Reproduce:
1. set use flag "imagemagick" and/or "v4l"
2. emerge media-gfx/zbar

Actual Results:  
Fails to build with error

/usr/bin/install: cannot stat '/var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/man/zbarimg.1': No such file or directory
/usr/bin/install: cannot stat '/var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/man/zbarcam.1': No such file or directory
make[3]: *** [Makefile:2316: install-man1] Error 1
make[3]: Leaving directory '/var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015-abi_x86_64.amd64'
make[2]: *** [Makefile:2776: install-am] Error 2
make[2]: Leaving directory '/var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015-abi_x86_64.amd64'
make[1]: *** [Makefile:2470: install-recursive] Error 1
make[1]: Leaving directory '/var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015-abi_x86_64.amd64'
make: *** [Makefile:2770: install] Error 2
 * ERROR: media-gfx/zbar-0.10_p20121015-r3::gentoo failed (install phase):
 *   emake failed


Expected Results:  
Should have installed zbar package

It seems that the 'man' folder is missing from the distfiles 'doc' folder. 
i.e 
zbar-0.10.tar.bz2 (old version - works) has :-

> du -a zbar-0.10/doc
4       zbar-0.10/doc/doxygen.conf.in
4       zbar-0.10/doc/Makefile.am.inc
8       zbar-0.10/doc/ref/commonoptions.xml
8       zbar-0.10/doc/ref/zbarimg.xml
8       zbar-0.10/doc/ref/zbarcam.xml
24      zbar-0.10/doc/ref
4       zbar-0.10/doc/api/footer.html
4       zbar-0.10/doc/api
0       zbar-0.10/doc/man/man.stamp
8       zbar-0.10/doc/man/zbarcam.1
8       zbar-0.10/doc/man/zbarimg.1
16      zbar-0.10/doc/man
4       zbar-0.10/doc/reldate.xml
4       zbar-0.10/doc/style.xsl
4       zbar-0.10/doc/version.xml
4       zbar-0.10/doc/manual.xml
68      zbar-0.10/doc

Whereas the new distfile zbar-0.10_p20121015.zip has 
 du -a zbarnew/doc
4       zbarnew/doc/Makefile.am.inc
4       zbarnew/doc/api/footer.html
4       zbarnew/doc/api
4       zbarnew/doc/style.xsl
4       zbarnew/doc/doxygen.conf.in
4       zbarnew/doc/manual.xml
8       zbarnew/doc/ref/commonoptions.xml
12      zbarnew/doc/ref/zbarimg.xml
8       zbarnew/doc/ref/zbarcam.xml
28      zbarnew/doc/ref
48      zbarnew/doc

It looks like the 'doc/man' folder is missing.




Comment 1


Graham





          2018-06-22 21:35:03 UTC
        

I confirmed this is the problem, copied the 'man' folder from an older distfiles tarball into the /var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc during the emerge - means it installs fine.




Comment 2


Graham





          2018-06-28 17:06:20 UTC
        

hmm strange - i cannot now recreated by unmerging and remerging the package

The man pages are now getting generated OK :-
xmlto --searchpath /var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015-abi_x86_64.amd64/doc -m /var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/style.xsl --skip-validation  -o doc/man man /var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/manual.xml
Note: Writing zbarcam.1
Note: Writing zbarimg.1

So it *now* installs OK. 

Unfortunately i didn't keep my logs :( so im not sure why they wern't getting generated like this the first time around.




Comment 3


Jonas Stein






          2018-06-28 17:57:21 UTC
        

I suggest, we close it here, and you reopen when you can reproduce it.
Please attach your logs then too.
https://wiki.gentoo.org/wiki/Attach_the_logs_to_the_bug_ticket




Comment 4


Maxim Britov





          2018-09-14 15:13:16 UTC
        

Same issue with: USEFLAG=imagemagick
ebuild should require app-text/xmlto if USE='imagemagick'


With USE='imagemagick' it builds zbarimg and zbarimg.1 man page.
xmlto using for convert ref/zbarimg.xml into zbarimg.1

$(man_stamp): $(DOCSOURCES)
        @$(mkdir_p) doc/man 2>/dev/null
        @rm -f $(man_stamp).tmp
        @touch $(man_stamp).tmp
        $(XMLTO) $(doc_path) $(XMLTOFLAGS) -o doc/man man $<
        @mv $(man_stamp).tmp $(man_stamp)

When package app-text/xmlto not installed variable XMLTO is:

XMLTO = :

as result:

: --searchpath /var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015-abi_x86_64.amd64/doc -m /var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/style.xsl --skip-validation  -o doc/man man /var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/manual.xml

and if fail then...

/usr/bin/install: cannot stat '/var/tmp/portage/media-gfx/zbar-0.10_p20121015-r3/work/zbar-0.10_p20121015/doc/man/zbarimg.1': Нет такого файла или каталога
make[3]: *** [Makefile:2316: install-man1] Error 1









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

