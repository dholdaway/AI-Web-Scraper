Title: 755245 – sys-devel/gcc-9.3.0-r1: basic_ios.h:282:22: internal compiler error: Segmentation fault (-march=btver1)
URL: https://bugs.gentoo.org/show_bug.cgi?id=755245

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 755245
sys-devel/gcc-9.3.0-r1: basic_ios.h:282:22: internal compiler error: Segmentation fault (-march=btver1)
Last modified: 2021-01-18 17:42:04 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 755245 
      - sys-devel/gcc-9.3.0-r1: basic_ios.h:282:22: internal compiler error: Segmentation fault (-march=btver1)


Summary:
sys-devel/gcc-9.3.0-r1: basic_ios.h:282:22: internal compiler error: Segmenta...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-11-18 08:51 UTC by Thomas Beutin





      Modified:
    
2021-01-18 17:42 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



herrtimson
sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log (gzipped)

              (gcc-9.3.0-r1-build.log.gz,250.71 KB,
                application/x-gzip)

            
2020-11-18 08:54 UTC,

            Thomas Beutin




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Thomas Beutin





          2020-11-18 08:51:07 UTC
        

[...]
/bin/bash ../../libtool --tag CXX --tag disable-shared   --mode=compile /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./gcc/xgcc -shared-libgcc -B/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./gcc -nostdinc++ -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src/.libs -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/libsupc++/.libs -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include   -fno-checking -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/../libgcc -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include/x86_64-pc-linux-gnu -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/libsupc++   -std=gnu++98 -prefer-pic -D_GLIBCXX_SHARED -fno-implicit-templates -fvtable-verify=std -Wl,-u_vtable_map_vars_start,-u_vtable_map_vars_end -Wall -Wextra -Wwrite-strings -Wcast-qual -Wabi=2  -fdiagnostics-show-location=once   -ffunction-sections -fdata-sections  -frandom-seed=ios_failure.lo -g -march=btver1 -pipe -O2 -D_GNU_SOURCE  -c -o ios_failure.lo /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/src/c++98/ios_failure.cc
libtool: compile:  /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./gcc/xgcc -shared-libgcc -B/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./gcc -nostdinc++ -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src/.libs -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/libsupc++/.libs -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include -fno-checking -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/../libgcc -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include/x86_64-pc-linux-gnu -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/libsupc++ -std=gnu++98 -D_GLIBCXX_SHARED -fno-implicit-templates -fvtable-verify=std -Wl,-u_vtable_map_vars_start,-u_vtable_map_vars_end -Wall -Wextra -Wwrite-strings -Wcast-qual -Wabi=2 -fdiagnostics-show-location=once -ffunction-sections -fdata-sections -frandom-seed=ios_failure.lo -g -march=btver1 -pipe -O2 -D_GNU_SOURCE -c /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/src/c++98/ios_failure.cc  -fPIC -DPIC -D_GLIBCXX_SHARED -o ios_failure.o
/bin/bash ../../libtool --tag CXX --tag disable-shared   --mode=compile /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./gcc/xgcc -shared-libgcc -B/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./gcc -nostdinc++ -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src/.libs -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/libsupc++/.libs -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include   -fno-checking -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/../libgcc -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include/x86_64-pc-linux-gnu -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/libsupc++   -std=gnu++98 -prefer-pic -D_GLIBCXX_SHARED -fno-implicit-templates -fvtable-verify=std -Wl,-u_vtable_map_vars_start,-u_vtable_map_vars_end -Wall -Wextra -Wwrite-strings -Wcast-qual -Wabi=2  -fdiagnostics-show-location=once   -ffunction-sections -fdata-sections  -frandom-seed=ios_init.lo -g -march=btver1 -pipe -O2 -D_GNU_SOURCE  -c -o ios_init.lo /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/src/c++98/ios_init.cc
libtool: compile:  /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./gcc/xgcc -shared-libgcc -B/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./gcc -nostdinc++ -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src/.libs -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/libsupc++/.libs -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include -fno-checking -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/../libgcc -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include/x86_64-pc-linux-gnu -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/libsupc++ -std=gnu++98 -D_GLIBCXX_SHARED -fno-implicit-templates -fvtable-verify=std -Wl,-u_vtable_map_vars_start,-u_vtable_map_vars_end -Wall -Wextra -Wwrite-strings -Wcast-qual -Wabi=2 -fdiagnostics-show-location=once -ffunction-sections -fdata-sections -frandom-seed=ios_init.lo -g -march=btver1 -pipe -O2 -D_GNU_SOURCE -c /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/src/c++98/ios_init.cc  -fPIC -DPIC -D_GLIBCXX_SHARED -o ios_init.o
In file included from /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include/ios:44,
                 from /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/src/c++98/ios_init.cc:29:
/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include/bits/basic_ios.h: In instantiation of 'std::basic_ios<_CharT, _Traits>::~basic_ios() [with _CharT = char; _Traits = std::char_traits<char>]':
/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include/ostream:85:7:   required from 'std::basic_ostream<_CharT, _Traits>::basic_ostream(std::basic_ostream<_CharT, _Traits>::__streambuf_type*) [with _CharT = char; _Traits = std::char_traits<char>; std::basic_ostream<_CharT, _Traits>::__streambuf_type = std::basic_streambuf<char>]'
/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/src/c++98/ios_init.cc:91:36:   required from here
/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/include/bits/basic_ios.h:282:22: internal compiler error: Segmentation fault
  282 |       ~basic_ios() { }
      |                      ^
0xb739d7 crash_signal
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/toplev.c:326
xgcc: internal compiler error: Segmentation fault signal terminated program cc1plus
Please submit a full bug report,
with preprocessed source if appropriate.
See <https://bugs.gentoo.org/> for instructions.
make[6]: *** [Makefile:645: ios_init.lo] Error 1
make[6]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src/c++98'
make[5]: *** [Makefile:729: all-recursive] Error 1
make[5]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3/src'
make[4]: *** [Makefile:562: all-recursive] Error 1
make[4]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3'
make[3]: *** [Makefile:487: all] Error 2
make[3]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/x86_64-pc-linux-gnu/libstdc++-v3'
make[2]: *** [Makefile:15181: all-stage2-target-libstdc++-v3] Error 2
make[2]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build'
make[1]: *** [Makefile:23258: stage2-bubble] Error 2
make[1]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build'
make: *** [Makefile:23473: bootstrap-lean] Error 2
 * ERROR: sys-devel/gcc-9.3.0-r1::gentoo failed (compile phase):
 *   emake failed

Reproducible: Always




Portage 3.0.8 (python 3.6.12-final-0, default/linux/amd64/17.0, gcc-8.2.0, glibc-2.32-r2, 4.19.37-gentoo x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-4.19.37-gentoo-x86_64-AMD_E-350_Processor-with-gentoo-2.6
KiB Mem:     7785208 total,    699988 free
KiB Swap:    4193264 total,   4193264 freeKiB Swap:    4193264 total,   4193264 free
Timestamp of repository gentoo: Sun, 15 Nov 2020 05:45:01 +0000
Head commit of repository gentoo: dc8adfc724c985fdba8dfc870cbf000374299e08
sh bash 4.4_p23-r1
ld GNU ld (Gentoo 2.34 p6) 2.34.0
app-shells/bash:          4.4_p23-r1::gentoo
dev-lang/perl:            5.26.2::gentoo
dev-lang/python:          2.7.18-r4::gentoo, 3.6.12::gentoo, 3.8.5::gentoo, 3.9.0::gentoo
dev-util/cmake:           3.9.6::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.6-r1::gentoo
sys-apps/openrc:          0.41.2::gentoo
sys-apps/sandbox:         2.13::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.13.4-r2::gentoo, 1.15.1-r2::gentoo, 1.16.1-r1::gentoo
sys-devel/binutils:       2.34-r2::gentoo
sys-devel/gcc:            8.2.0-r6::gentoo
sys-devel/gcc-config:     2.3.2::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 4.14-r1::gentoo (virtual/os-headers)
sys-libs/glibc:           2.32-r2::gentoo
Repositories:
                                                                                                                                                                                                                    gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://portage/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts:
    sync-rsync-verify-metamanifest: yes
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-jobs: 1
x-portage
    location: /usr/local/portage
    masters: gentoo
    priority: 0                                                                                                                                                                                                                                                                                                                                                                                                                         barzog-overlay
    location: /var/lib/layman/barzog-overlay
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=btver1 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/fax /usr/share/easy-rsa /usr/share/gnupg/qualified.txt /var/bind /var/spool/fax/etc /var/spool/munin-async/.ssh"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.6/ext-active/ /etc/php/apache2-php7.4/ext-active/ /etc/php/cgi-php5.6/ext-active/ /etc/php/cgi-php7.4/ext-active/ /etc/php/cli-php5.6/ext-active/ /etc/php/cli-php7.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /var/spool/fax/etc/xferfaxlog"
CXXFLAGS="-march=btver1 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="de en_IE en_GB en"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="aac alsa amd64 amr apache2 berkdb bzip2 caps cli corefonts cron crypt curl cvs device-mapper djvu dri exif expat ffmpeg fits flac fontconfig fortran ftp fusefs gdbm geoip gif gmp graphviz hdf5 http iconv idn imagemagick imap ipv6 jabber jbig jpeg jpeg2k json ldap libglvnd libtirpc logrotate logwatch lzma lzo memcache memcached mercurial midi milter mp4 mpeg multilib mysql mysqli ncurses nls nptl ogg openmp pam pcre pdf perl php png postgres postscript python raw readline sasl seccomp sendmail sharedext sharedmem sndfile snmp soap sockets spamassassin spatialite split-usr sqlite sqlite3 ssl subversion svg syslog tcpd tidy tiff tls truetype unicode uuid vhosts vim-syntax vorbis vpx webp x264 xattr xetex xinetd xls xml xmpp zip zlib" ABI_X86="64" ADA_TARGET="gnat_2018" ALSA_CARDS="hda-intel" APACHE2_MODULES="access auth auth_basic authn_dbm dbd ident imagemap authn_dbd authn_file authn_default authz_groupfile authn_alias authn_anon authz_dbm authz_owner authz_default authz_user auth_digest authz_host alias file_cache echo charset_lite cache disk_cache mem_cache ext_filter case_filter case-filter-in deflate filter mime_magic cern_meta proxy_ajp proxy_balancer expires headers usertrack proxy proxy_connect proxy_ftp proxy_http info include cgi cgid dav dav_lock dav_fs vhost_alias speling rewrite log_config logio env setenvif mime status substitute autoindex asis negotiation dir imap actions userdir so unique_id" APACHE2_MPMS="prefork" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext popcnt sse sse2 sse3 sse4a ssse3" ELIBC="glibc" FFTOOLS="aviocat ismindex" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" GRUB_PLATFORMS="pc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" L10N="de en_IE en_GB en" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-4" POSTGRES_TARGETS="postgres9_6 postgres11" PYTHON_SINGLE_TARGET="python3_6" PYTHON_TARGETS="python2_7 python3_6" USERLAND="GNU" VIDEO_CARDS="vesa" VOICEMAIL_STORAGE="imap" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Thomas Beutin





          2020-11-18 08:54:52 UTC
        

Created attachment 672124 [details]
build.log (gzipped)




Comment 2


Sam James









          2020-11-18 09:09:48 UTC
        

Could you follow https://wiki.gentoo.org/wiki/Gcc-ICE-reporting-guide?

Definitely include (but not limited to): expanded -march=native (using the command on that page) and possibly verify your RAM is OK?




Comment 3


Sergei Trofimovich (RETIRED)






          2020-11-21 09:56:29 UTC
        

Is it a deterministic failure for you? Does it crash in the same place every time you build gcc?




Comment 4


Thomas Beutin





          2020-11-23 15:47:54 UTC
        

(In reply to Sergei Trofimovich from comment #3)
> Is it a deterministic failure for you? Does it crash in the same place every
> time you build gcc?

It was deterministic for the first 5(?) times, but now it seems to change.

This system is an AMD E-350 Processor on an ASUS board with some problems right from the start. The errata was published from AMD soon after buying, and fixes were provided by both firmware update files and BIOS updates from ASUS.

I ordered new RAM, and i'll report back.




Comment 5


Sergei Trofimovich (RETIRED)






          2020-11-23 18:03:44 UTC
        

Sounds good. Also wort trying to run sys-apps/memtest86+ on your system if there is basic support for it. That should flag trivial CPU and RAM problems.




Comment 6


Thomas Beutin





          2020-11-25 14:51:47 UTC
        

(In reply to Sergei Trofimovich from comment #5)
> Sounds good. Also wort trying to run sys-apps/memtest86+ on your system if
> there is basic support for it. That should flag trivial CPU and RAM problems.

i changed the two RAM modules 2 times (currently running two brand new modules, recommended in the motherboard manual), but i'm stuck w/ the similar problem. it stops now here:

/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./prev-gcc/xg++ -B/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/./prev-gcc/ -B/usr/x86_64-pc-linux-gnu/bin/ -nostdinc++ -B/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/prev-x86_64-pc-linux-gnu/libstdc++-v3/src/.libs -B/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/prev-x86_64-pc-linux-gnu/libstdc++-v3/libsupc++/.libs  -isystem /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/prev-x86_64-pc-linux-gnu/libstdc++-v3/include/x86_64-pc-linux-gnu  -isystem /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/prev-x86_64-pc-linux-gnu/libstdc++-v3/include  -isystem /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/libstdc++-v3/libsupc++ -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/prev-x86_64-pc-linux-gnu/libstdc++-v3/src/.libs -L/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/prev-x86_64-pc-linux-gnu/libstdc++-v3/libsupc++/.libs -fno-PIE -c -fno-PIE    -m64 -march=btver1 -pipe -O2 -fchecking=1 -DIN_GCC     -fno-exceptions -fno-rtti -fasynchronous-unwind-tables -W -Wall -Wno-narrowing -Wwrite-strings -Wcast-qual -Wmissing-format-attribute -Woverloaded-virtual -pedantic -Wno-long-long -Wno-variadic-macros -Wno-overlength-strings   -DHAVE_CONFIG_H -I. -I. -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/. -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/../include -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/../libcpp/include  -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/../libdecnumber -I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/../libdecnumber/bid -I../libdecnumber
-I/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/../libbacktrace   -o builtins.o -MT builtins.o -MMD -MP -MF ./.deps/builtins.TPo /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/builtins.c
In file included from /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/coretypes.h:430,
                 from /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/builtins.c:26:
/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/poly-int.h: In instantiation of 'poly_int<N, T>::poly_int(const C0&) [with C0 = const tree_node*; unsigned int N = 1; C = generic_wide_int<wi::extended_tree<128> >]':
/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.h:5727:10:   required from here
/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/poly-int.h:673:1: internal compiler error: Segmentation fault
  673 | }
      | ^
0xb739d7 crash_signal
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/toplev.c:326
0xbe310a copy_tree_body_r(tree_node**, int*, void*)
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree-inline.c:1372
0xdcdf42 walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12156
0xdce2a2 walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12478
0xdce2a2 walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12478
0xdce2a2 walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12478
0xbe3542 copy_tree_body_r(tree_node**, int*, void*)
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree-inline.c:1440
0xdcdf42 walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12156
0xdce39d walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12388
0xdce39d walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12388
0xdce2a2 walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12478
0xdce2a2 walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12478
0xdce1ae walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12261
0xdce1ae walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12261
0xdce1ae walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12261
0xdce1ae walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12261
0xdce1ae walk_tree_1(tree_node**, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*, tree_node* (*)(tree_node**, int*, tree_node* (*)(tree_node**, int*, void*), void*, hash_set<tree_node*, false, default_hash_traits<tree_node*> >*))
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/tree.c:12261
0x67ae14 clone_body
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/cp/optimize.c:112
0x67ae14 maybe_clone_body(tree_node*)
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/cp/optimize.c:686
0x6f6c9b expand_or_defer_fn_1(tree_node*)
        /var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/gcc-9.3.0/gcc/cp/semantics.c:4363
Please submit a full bug report,
with preprocessed source if appropriate.
Please include the complete backtrace with any bug report.
See <https://bugs.gentoo.org/> for instructions.
make[3]: *** [Makefile:1118: builtins.o] Error 1
make[3]: *** Waiting for unfinished jobs....
rm gfortran.pod gcc.pod
make[3]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build/gcc'
make[2]: *** [Makefile:4750: all-stage3-gcc] Error 2
make[2]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build'
make[1]: *** [Makefile:23398: stage3-bubble] Error 2
make[1]: Leaving directory '/var/tmp/portage/sys-devel/gcc-9.3.0-r1/work/build'
make: *** [Makefile:23473: bootstrap-lean] Error 2
 * ERROR: sys-devel/gcc-9.3.0-r1::gentoo failed (compile phase):
 *   emake failed

A memtest86+ couldn't be performend by now - this is a primary DNS and mail server.

I'm somewhat desparated, but i'll keep you updated.

Is there a kernel command line parameter to disable all SPECTRE/MELTDOWN firmware patches and kernel mitigations?




Comment 7


Sergei Trofimovich (RETIRED)






          2020-11-27 07:51:12 UTC
        

To get a working system you can try to remove '-march=btver1' from CFLAGS/CXXFLAGS or try gcc-10. Chances are 9.3.0+-march=btver1 generates broken binaries for that target.




Comment 8


Thomas Beutin





          2020-11-27 09:36:35 UTC
        

(In reply to Sergei Trofimovich from comment #7)
> To get a working system you can try to remove '-march=btver1' from
> CFLAGS/CXXFLAGS or try gcc-10. Chances are 9.3.0+-march=btver1 generates
> broken binaries for that target.

i had the same problem w/ GCC v8.4.0 - v6.5.0 compiled well. Today i'll start a try of v7.5.0.

Bu: if 9.3.0+-march=btver1 generates broken binaries: it's IMHO a (serious?) bug that should be fixed. How can i help here?




Comment 9


Sergei Trofimovich (RETIRED)






          2020-11-27 11:00:19 UTC
        

(In reply to Thomas Beutin from comment #8)
> (In reply to Sergei Trofimovich from comment #7)
> > To get a working system you can try to remove '-march=btver1' from
> > CFLAGS/CXXFLAGS or try gcc-10. Chances are 9.3.0+-march=btver1 generates
> > broken binaries for that target.
> 
> i had the same problem w/ GCC v8.4.0 - v6.5.0 compiled well. Today i'll
> start a try of v7.5.0.
> 
> Bu: if 9.3.0+-march=btver1 generates broken binaries: it's IMHO a (serious?)
> bug that should be fixed. How can i help here?

We'll need to find why gcc generates invalid code (if that is the bug and not some other source of corruption).




Comment 10


Thomas Beutin





          2020-11-30 08:04:46 UTC
        

(In reply to Sergei Trofimovich from comment #7)
> To get a working system you can try to remove '-march=btver1' from
> CFLAGS/CXXFLAGS or try gcc-10. Chances are 9.3.0+-march=btver1 generates
> broken binaries for that target.

Sergei, i followed your advise and compiled GCC v9.3.0 w/ march CFLAG(S) successfully two times in a row: first run was niceness 19 and only one make job at a time (MAKEOPTS=-j1), the second runs was niceness -19 and 4 parallel make jobs - yeah! :)

But i refuse to close this issue unless w found a solution w/o fiddeling around in my CFLAGS in /etc/portage/make.conf ;)




Comment 11


Thomas Beutin





          2020-11-30 22:53:54 UTC
        

(In reply to Thomas Beutin from comment #10)
> (In reply to Sergei Trofimovich from comment #7)
> > To get a working system you can try to remove '-march=btver1' from
> > CFLAGS/CXXFLAGS or try gcc-10. Chances are 9.3.0+-march=btver1 generates
> > broken binaries for that target.
> 
> Sergei, i followed your advise and compiled GCC v9.3.0 w/ march CFLAG(S)
> successfully two times in a row: first run was niceness 19 and only one make
> job at a time (MAKEOPTS=-j1), the second runs was niceness -19 and 4
> parallel make jobs - yeah! :)
> 
> But i refuse to close this issue unless w found a solution w/o fiddeling
> around in my CFLAGS in /etc/portage/make.conf ;)

Oops, typo: i compiled _without_ march in CFLAGS




Comment 12


Sergei Trofimovich (RETIRED)






          2020-11-30 23:46:13 UTC
        

(In reply to Thomas Beutin from comment #10)
> (In reply to Sergei Trofimovich from comment #7)
> > To get a working system you can try to remove '-march=btver1' from
> > CFLAGS/CXXFLAGS or try gcc-10. Chances are 9.3.0+-march=btver1 generates
> > broken binaries for that target.
> 
> Sergei, i followed your advise and compiled GCC v9.3.0 w/ march CFLAG(S)
> successfully two times in a row: first run was niceness 19 and only one make
> job at a time (MAKEOPTS=-j1), the second runs was niceness -19 and 4
> parallel make jobs - yeah! :)

Woohoo! For completeness does building gcc-9 with gcc-9 -march= value brings the similar crash back?

> But i refuse to close this issue unless w found a solution w/o fiddeling
> around in my CFLAGS in /etc/portage/make.conf ;)

Yeah, I agree it needs to be debugged and fixed.




Comment 13


Thomas Beutin





          2020-12-07 09:30:27 UTC
        

(In reply to Sergei Trofimovich from comment #12)
> (In reply to Thomas Beutin from comment #10)
> > (In reply to Sergei Trofimovich from comment #7)
> > > To get a working system you can try to remove '-march=btver1' from
> > > CFLAGS/CXXFLAGS or try gcc-10. Chances are 9.3.0+-march=btver1 generates
> > > broken binaries for that target.
> > 
> > Sergei, i followed your advise and compiled GCC v9.3.0 w/ march CFLAG(S)
> > successfully two times in a row: first run was niceness 19 and only one make
> > job at a time (MAKEOPTS=-j1), the second runs was niceness -19 and 4
> > parallel make jobs - yeah! :)
> 
> Woohoo! For completeness does building gcc-9 with gcc-9 -march= value brings
> the similar crash back?

i'd love to give it a try, but for the moment i'm struggling on compiling a 4.19.152 kernel w/ gcc-9.3.0-r1 and gcc-8.4.0-r1 (both comipled w/o -march CFLAGS) . Both fail with the same " Segmentation fault" error on different source files :-/

I'll give gcc-6.5.0-r3 version a try on the kernel, and than i can continue on this bug. Sorry for the delay!




Comment 14


Sergei Trofimovich (RETIRED)






          2020-12-07 18:46:37 UTC
        

Non-deterministic failures is frequently a sign of corrupted hardware.

Perhaps sys-apps/memtester (userspace tool) could find memory (or CPU) issues.




Comment 15


Thomas Beutin





          2021-01-03 13:28:37 UTC
        

There's some progress in the meantime: i recompiled a lot of packages (i.e. perl & friends, python & friends, some other packages), and now i'm happy to report that everything is working again(*). gcc v9.3.0-r2(-march=btver1) compiled several times in different parallel jobs and nicness settings w/o problems, and gentoo-sources-4.19.152 as well.
The hardware wasn't changed at all after 2020-11-25 14:51:47 UTC, and i tried a couple of runs of sys-apps/memtester w/o any problem beside beeing the perfect victim for the oom_reaper ;)
After all i consider my hardware reliable again, but the next challenges are coming for sure (moving to python 3.7 as default, changing profile to 17.1), and all of them are time consuming on this little nice powersaving device.

*) if someone is interested i'm happy to provide the relevant part of my /var/log/emerge.log to dig further into it. And i'll leave the bug open for some more days - just in case.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

