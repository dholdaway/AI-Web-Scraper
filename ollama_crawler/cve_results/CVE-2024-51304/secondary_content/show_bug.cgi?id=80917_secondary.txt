Title: 80917 – dev-php/php-4.3.10 Fails on econf - amd64 pthreads broken
URL: https://bugs.gentoo.org/show_bug.cgi?id=80917

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 80917
dev-php/php-4.3.10 Fails on econf - amd64 pthreads broken
Last modified: 2005-11-04 08:10:55 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 80917 
      - dev-php/php-4.3.10 Fails on econf - amd64 pthreads broken


Summary:
dev-php/php-4.3.10 Fails on econf - amd64 pthreads broken
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

AMD64 Project








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

81018

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2005-02-05 14:59 UTC by Tony Harmelink





      Modified:
    
2005-11-04 08:10 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



lists
php-bugs









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




config.log

              (config.log,97.66 KB,
                text/plain)

            
2005-02-05 15:01 UTC,

            Tony Harmelink




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Tony Harmelink





          2005-02-05 14:59:59 UTC
        

I am trying to rebuild dev-php/php-4.3.10 with IPv6 support, but the config fails

checking whether the C++ compiler (c++ -O3 -march=athlon64 -ffast-math -funit-at-a-time -ftracer -pipe -L/usr/lib  -L/usr/X11R6/lib -ltiff -L/usr/lib -Wl,-rpath,/usr/X11R6/lib -L/usr/X11R6/lib -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/server -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/server -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/native_threads -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/native_threads -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64 -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64 -Wl,-rpath,/usr/qt/3/lib -L/usr/qt/3/lib) works... no
configure: error: installation or configuration problem: C++ compiler cannot create executables.

!!! Please attach the config.log to your bug report:
!!! /var/tmp/portage/php-4.3.10/work/php-4.3.10/config.log

!!! ERROR: dev-php/php-4.3.10 failed.
!!! Function econf, Line 485, Exitcode 0
!!! econf failed


Reproducible: Always
Steps to Reproduce:
1. Set use flags, configuration
2. emerge php
3. 

Actual Results:  
emerge fails

Expected Results:  
successful build

linux_64 ace # emerge info
Portage 2.0.51-r15 (default-linux/amd64/2004.3, gcc-3.4.3,
glibc-2.3.4.20041102-r0, 2.6.9-gentoo-r14 x86_64)
=================================================================
System uname: 2.6.9-gentoo-r14 x86_64 AMD Athlon(tm) 64 Processor 2800+
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4 [2.3.4 (#1, Dec 22 2004, 00:49:56)]
ccache version 2.3 [enabled]
dev-lang/python:     2.3.4
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r1
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-O3 -march=athlon64 -ffast-math -funit-at-a-time -ftracer -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config
/usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/env.d"
CXXFLAGS="-O3 -march=athlon64 -ffast-math -funit-at-a-time -ftracer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox"
GENTOO_MIRRORS="http://mirror.datapipe.net/gentoo http://gentoo.mirrors.pair.com
http://gentoo.seren.com/gentoo
http://www.zentek-international.com/mirrors/gentoo/
http://ftp.easynet.nl/mirror/gentoo/ http://gentoo.chem.wisc.edu/gentoo/
http://mirrors.tds.net/ http://mirror.datapipe.net/gentoo
http://gentoo.mirrors.pair.com/"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/gp"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X aac aalib acpi alsa apache2 arts avi berkdb bitmap-fonts cdparanoia
cdr clamav crypt cups divx4linux dvd encode esd f77 faad fam flac flash
font-server foomatic foomaticdb fortran gcj gd gdbm gif gimpprint gnome gpm gtk
gtk2 imagemagick imap imlib insults ipv6 jack java jp2 jpeg junit kde ldap
libwww lzw lzw-tiff mad maildir matroska mbox mikmod monkey motif mozilla mpeg
multilib mysql ncurses nls nptl objc offensive oggvorbis opengl oss pam pdflib
perl png povray ppds python qt readline samba sdl slang snmp speex spell ssl
tcltk tcpd theora tiff truetype truetype-fonts type1-fonts usb userlocales xine
xml2 xmms xpm xrandr xv xvid zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS




Comment 1


Tony Harmelink





          2005-02-05 15:01:59 UTC
        

Created attachment 50481 [details]
config.log




Comment 2


Robin Johnson









          2005-02-05 17:05:21 UTC
        

Your threads are broken. AMD64 should be able to tell you more.

configure:2562: checking flex version
configure:2706: gcc -o conftest -O3 -march=athlon64 -ffast-math -funit-at-a-time -ftracer -pipe   -L/usr/X11R6/lib -ltiff -L/usr/lib conftest.c  -lxmlparse -lxmltok 1>&5
/var/tmp/portage/php-4.3.10/temp/ccWcR8Ed.o(.text+0x22): In function `main':
: undefined reference to `pthread_mutexattr_init'
/var/tmp/portage/php-4.3.10/temp/ccWcR8Ed.o(.text+0x38): In function `main':
: undefined reference to `pthread_create'
collect2: ld returned 1 exit status
configure: failed program was:
#line 2688 "configure"
#include "confdefs.h"

#include <pthread.h>
#include <stddef.h>

void *thread_routine(void *data) {
    return data;
}

int main() {
    pthread_t thd;
    pthread_mutexattr_t mattr;
    int data = 1;
    pthread_mutexattr_init(&mattr);
    return pthread_create(&thd, NULL, thread_routine, &data);
}
configure:2726: checking for pthreads_cflags
...
configure:72218: checking whether the C++ compiler (c++ -O3 -march=athlon64 -ffast-math -funit-at-a-time -ftracer -pipe -L/usr/lib  -L/usr/X11R6/lib -ltiff -L/usr/lib -Wl,-rpath,/usr/X11R6/lib -L/usr/X11R6/lib -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/server -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/server -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/native_threads -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/native_threads -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64 -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64 -Wl,-rpath,/usr/qt/3/lib -L/usr/qt/3/lib) works
configure:72234: c++ -o conftest -O3 -march=athlon64 -ffast-math -funit-at-a-time -ftracer -pipe  -L/usr/lib  -L/usr/X11R6/lib -ltiff -L/usr/lib -Wl,-rpath,/usr/X11R6/lib -L/usr/X11R6/lib -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/server -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/server -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/native_threads -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64/native_threads -Wl,-rpath,/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64 -L/opt/blackdown-jdk-1.4.2.01/jre/lib/amd64 -Wl,-rpath,/usr/qt/3/lib -L/usr/qt/3/lib conftest.C -lqt -lpspell -lpdf -lz -ltiff -lpng -ljpeg -lpanel -lncurses -lmysqlclient -lming -lm -lmhash -lmcrypt -lltdl -lldap -llber -lcrypt -lpam -lt1 -lfreetype -lX11 -lXpm -lpng -lz -ljpeg -lexslt -lxml2 -lxslt -lz -ldb-4.1 -ldb-4.1 -lndbm -lgdbm -lcrack -lbz2 -lz -lssl -lcrypto -lresolv -lm  -lxmlparse -lxmltok -lxml2 -lz -lm 1>&5
/usr/qt/3/lib/libqt.so: undefined reference to `__pthread_register_cancel@GLIBC_2.3.3'
/usr/qt/3/lib/libqt.so: undefined reference to `__pthread_unregister_cancel@GLIBC_2.3.3'
collect2: ld returned 1 exit status
configure: failed program was:

#line 72229 "configure"
#include "confdefs.h"

int main(){return(0);}





Comment 3


Robin Johnson









          2005-02-06 15:11:46 UTC
        

*** Bug 81018 has been marked as a duplicate of this bug. ***




Comment 4


Simon Stelling (RETIRED)






          2005-05-04 02:49:39 UTC
        

is this still an issue after an upgrade to 2005.0?




Comment 5


Simon Stelling (RETIRED)






          2005-06-21 10:31:55 UTC
        

got no answer, assuming the problem has been fixed









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

