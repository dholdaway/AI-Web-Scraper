Title: 356163 – www-plugins/google-talkplugin-1.8.0.0 breaks www-client/chromium: Inconsistency detected by ld.so
URL: https://bugs.gentoo.org/show_bug.cgi?id=356163

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 356163
www-plugins/google-talkplugin-1.8.0.0 breaks www-client/chromium: Inconsistency detected by ld.so
Last modified: 2011-06-09 08:29:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 356163 
      - www-plugins/google-talkplugin-1.8.0.0 breaks www-client/chromium: Inconsistency detected by ld.so


Summary:
www-plugins/google-talkplugin-1.8.0.0 breaks www-client/chromium: Inconsisten...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Desktop Misc. Team








URL:



http://code.google.com/p/chromium/iss...
        




Whiteboard:




Keywords:









Duplicates (1):
    

370291

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2011-02-23 03:20 UTC by Denilson Sá Maia





      Modified:
    
2011-06-09 08:29 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



chromium
junghans
pavel.stratil-jun









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge-info.txt

              (emerge-info.txt,5.30 KB,
                text/plain)

            
2011-02-23 03:21 UTC,

            Denilson Sá Maia




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Denilson Sá Maia





          2011-02-23 03:20:37 UTC
        

So, google-talkplugin has been added to the portage tree. And then I tried installing it. And then Chrome stopped working.

[ebuild   R   ] www-plugins/google-talkplugin-1.8.0.0  USE="system-libCg" 0 kB
[ebuild   R   ] www-client/chromium-9.0.597.94  USE="cups -gecko-mediaplayer -gnome -gnome-keyring (-system-v8)" 0 kB


I'm trying to start chromium using a new empty user-dir:

 chromium --user-data-dir=$HOME/tmp

At first, it shows the google/yahoo/bing selector. After we select one of them, it crashes with the following message (as well as when we try to launch it again):

Inconsistency detected by ld.so: dl-open.c: 582: _dl_open: Assertion `_dl_debug_initialize (0, args.nsid)->r_state == RT_CONSISTENT' failed!

There are also messages about libffmpegsumo.so, but these are unrelated to this bug.

Uninstalling google-talkplugin makes chromium work again.

I'd attach a strace log, but chromium doesn't launch when strace is attached. I don't know why.




Comment 1


Denilson Sá Maia





          2011-02-23 03:21:38 UTC
        

Created attachment 263587 [details]
emerge-info.txt

emerge --info




Comment 2


Denilson Sá Maia





          2011-02-23 03:34:32 UTC
        

Related forum post:
http://forums.gentoo.org/viewtopic-p-6569199.html

Related upstream bug:
http://code.google.com/p/chromium/issues/detail?id=64761

Running:
 ldd /opt/google/talkplugin/*
Shows:
	libpng12.so.0 => not found

Then, re-emerging media-libs/libpng-1.2.44 fixes this issue, because it installs the missing libpng12.so.0 file. I feel it is weird, because I already had that package installed, even though the file was missing.

I have two solutions: either rev-bump libpng 1.2 and 1.4, adding some code to see if the libpng*.so* files are sane; or add such checking to the google-talkplugin.




Comment 3


Mike Gilbert






          2011-02-23 03:56:48 UTC
        

I can reproduce this by removing libpng12.so.0 on my system. I'm not sure why that file would be missing under normal circumstances, however.

Have you identified the exact sequence of events that led to this?

I must say that it is a bit strange for Chromium to crash when a plugin fails to load.




Comment 4


Paweł Hajdan, Jr. (RETIRED)






          2011-02-23 07:16:25 UTC
        

(In reply to comment #0)
> So, google-talkplugin has been added to the portage tree. And then I tried
> installing it. And then Chrome stopped working.

That sounds like a problem with the plugin, not the browser (which should handle it fine, but anyway the plugin is broken).




Comment 5


Christoph Junghans (RETIRED)






          2011-02-23 09:01:00 UTC
        

(In reply to comment #2)
> Then, re-emerging media-libs/libpng-1.2.44 fixes this issue, because it
> installs the missing libpng12.so.0 file. I feel it is weird, because I already
> had that package installed, even though the file was missing.
I remember having the same problem at a certain point after the update to libpng-1.4, which was due to the pkg_setup of the libpng-1.2.

 > I have two solutions: either rev-bump libpng 1.2 and 1.4, adding some code to
> see if the libpng*.so* files are sane; or add such checking to the
> google-talkplugin.
I can add a message saying "re-emerge libpng:1.2" in the case that no libpng12.so.0 was found. 








Comment 6


Denilson Sá Maia





          2011-02-23 18:51:40 UTC
        

Oh, one more thing!

revdep-rebuild should have noticed that google-talkplugin was broken, and at least should have warned me.




Comment 7


Christoph Junghans (RETIRED)






          2011-02-23 19:14:34 UTC
        

(In reply to comment #6)
> revdep-rebuild should have noticed that google-talkplugin was broken, and at
> least should have warned me.
That is strange, revdep-rebuild parses the output of ldd and looks for "not found".







Comment 8


Samuli Suominen (RETIRED)






          2011-02-23 19:23:42 UTC
        

(In reply to comment #7)
> (In reply to comment #6)
> > revdep-rebuild should have noticed that google-talkplugin was broken, and at
> > least should have warned me.
> That is strange, revdep-rebuild parses the output of ldd and looks for "not
> found".
> 

It doesn't search for /opt in purpose (it's for binary-only pkgs).




Comment 9


Denilson Sá Maia





          2011-02-23 19:24:19 UTC
        

(In reply to comment #3)
> I can reproduce this by removing libpng12.so.0 on my system. I'm not sure why
> that file would be missing under normal circumstances, however.
> 
> Have you identified the exact sequence of events that led to this?

I don't know what exactly caused this, but gentoo updates over time, somehow, has led to a system with libpng-1.2 installed but libpng12.so.0 missing.

MAYBE some ebuild message told me that file was left from previous versions and told me it was safe to delete it. MAYBE it was a conflict. I really don't know. But the fact is that my system was in such state, and (looking at other bug reports and forum posts) it seems other people also have the system in such state (libpng12.so.0 missing, but libpng-1.2 installed).




Comment 10


Samuli Suominen (RETIRED)






          2011-02-23 19:28:03 UTC
        

This is preserve_old_lib (from eutils.eclass) plus SLOT'd library problem where the old library gets owned by the package preserving it.

Solved in Portage 2.2 by preserved-libs feature.




Comment 11


Christoph Junghans (RETIRED)






          2011-06-09 08:29:16 UTC
        

*** Bug 370291 has been marked as a duplicate of this bug. ***









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

