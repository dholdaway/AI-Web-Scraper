Title: 146990 – mc-4.6.1 and 4.6.1-r2 don't display graphical lines on terminal anymore
URL: https://bugs.gentoo.org/show_bug.cgi?id=146990

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 146990
mc-4.6.1 and 4.6.1-r2 don't display graphical lines on terminal anymore
Last modified: 2006-09-10 06:22:56 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 146990 
      - mc-4.6.1 and 4.6.1-r2 don't display graphical lines on terminal anymore


Summary:
mc-4.6.1 and 4.6.1-r2 don't display graphical lines on terminal anymore
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-09-09 13:39 UTC by Peter Hyman





      Modified:
    
2006-09-10 06:22 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Peter Hyman





          2006-09-09 13:39:13 UTC
        

After
1) upgrade to gcc 4.1.1
2) upgrade to profile 2006.1
3) revdep-rebuild recompile for libstdc++ and for new profile uses (which
included mc)

Now, issuing mc at a terminal prompt (not inside X) shows no border
characters. Does this have something to do with unicode support? The only
way I can get any useful terminal output is to use the -a option for stick
characters. Inside an xterm or similar, mc shows graphical characters
fine. I re-emerged mc with -unicode, but the results are the same.

Everything seemed to work fine until I changed the profile. After gcc-4.1.1 update, all was fine. Now, I have this profile: default-linux/x86/2006.1/desktop

-----------------------
peter@mars ~ $ mc -V
GNU Midnight Commander 4.6.1
Virtual File System: tarfs, extfs, cpiofs, ftpfs, fish, smbfs, undelfs
With builtin Editor
Using system-installed S-Lang library with terminfo database With subshell
support as default
With support for background operations With mouse support on xterm and
Linux console With support for X11 events
With internationalization support
With multiple codepages support

peter@mars ~ $ emerge --info
Portage 2.1-r2 (default-linux/x86/2006.1/desktop, gcc-4.1.1, glibc-2.4-r3,
2.6.17-beyond4pre1-r1 i686)
================================================================= System
uname: 2.6.17-beyond4pre1-r1 i686 AMD Athlon(tm) 64 Processor 3500+ Gentoo
Base System version 1.12.4
app-admin/eselect-compiler: [Not Present] dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=i686 -fomit-frame-pointer" CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config
/usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config
/usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/
/usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/
/usr/share/texmf/xdvi/" CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf
/etc/revdep-rebuild /etc/splash /etc/terminfo" CXXFLAGS="-O2 -march=i686
-fomit-frame-pointer" DISTDIR="/mnt/src/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://mirror.datapipe.net/gentoo
ftp://gentoo.mirrors.tds.net/gentoo ftp://206.75.217.180/" MAKEOPTS="-j2"
PKGDIR="/mnt/src/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times
--compress --force --whole-file --delete --delete-after --stats
--timeout=180 --exclude='/distfiles' --exclude='/local'
--exclude='/packages'" PORTAGE_TMPDIR="/mnt/src/var/tmp"
PORTDIR="/mnt/src/portage"
PORTDIR_OVERLAY="/mnt/src/local/portage /mnt/src/local/overlays/bmg-main"
SYNC="rsync://rsync.gentoo.org/gentoo-portage" USE="x86 X alsa arts
artswrappersuid avi berkdb bitmap-fonts bzip2 cairo cdr cli crypt cups
dbus dlloader dri dvd dvdr eds emboss encode esd fam firefox flac fortran
gdbm gif glut gnome gpm gstreamer gtk hal ipv6 isdnlog java jpeg lcms ldap
libg++ mad mikmod mp3 mpeg mysql ncurses nls nptl nptlonly nsplugin
offensive ogg opengl oss pam pcre pdflib perl png ppds pppd python qt3 qt4
quicktime readline reflection samba sdl session slang spell spl ssl svga
tcltk tcpd tiff truetype truetype-fonts type1-fonts udev unicode vorbis
win32codecs xine xml xmms xorg xscreensaver xv zlib elibc_glibc
input_devices_keyboard input_devices_mouse input_devices_evdev
kernel_linux userland_GNU video_cards_nvidia video_cards_vesa
video_cards_fbdev" Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK,
LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS
----------
[ Found these USE variables for app-misc/mc-4.6.1-r2 ]
 U I
 - - 7zip    : add support for 7zip archives
 + + X       : Adds support for X11
 + + gpm     : Adds support for sys-libs/gpm (Console-based mouse driver)
 + + ncurses : Adds ncurses support (console display library)
 + + nls     : Adds Native Language Support (using gettext - GNU locale utilities)
 + + pam     : Adds support PAM (Pluggable Authentication Modules) - DANGEROUS to arbitrarily flip
 + + samba   : Adds support for SAMBA (Windows File and Printer sharing)
 + + slang   : Adds support for the slang text display library (it's like ncurses, but different)
 + + unicode : Adds support for Unicode
-------
BASH=/bin/bash
BASH_ARGC=()
BASH_ARGV=()
BASH_LINENO=()
BASH_SOURCE=()
BASH_VERSINFO=([0]="3" [1]="1" [2]="16" [3]="1" [4]="release" [5]="i686-pc-linux-gnu")
BASH_VERSION='3.1.16(1)-release'
CLASSPATH=.
COLUMNS=128
CONFIG_PROTECT='/usr/share/X11/xkb /usr/kde/3.5/share/config /usr/kde/3.5/env /usr/kde/3.5/shutdown /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/xdvi/ /usr/share/config'
CONFIG_PROTECT_MASK='/etc/gconf /etc/terminfo /etc/revdep-rebuild /etc/splash'
CVS_RSH=ssh
DIRSTACK=()
EDITOR=/bin/nano
EUID=0
FLTK_DOCDIR=/usr/share/doc/fltk-1.1.6/html
GCC_SPECS=
GDK_USE_XFT=1
GROUPS=()
G_BROKEN_FILENAMES=1
G_FILENAME_ENCODING=UTF-8
HISTFILE=/root/.bash_history
HISTFILESIZE=500
HISTSIZE=500
HOME=/root
HOSTNAME=mars
HOSTTYPE=i686
HUSHLOGIN=FALSE
IFS=$' \t\n'
INFOPATH=/usr/share/info:/usr/share/binutils-data/i686-pc-linux-gnu/2.16.1/info:/usr/share/gcc-data/i686-pc-linux-gnu/4.1.1/info
JAVAC=/opt/sun-jdk-1.4.2.10/bin/javac
JAVA_HOME=/opt/sun-jdk-1.4.2.10
JDK_HOME=/opt/sun-jdk-1.4.2.10
KDEDIRS=/usr
LESS='-R -M --shift 5'
LESSOPEN='|lesspipe.sh %s'
LINES=48
LOGNAME=root
MACHTYPE=i686-pc-linux-gnu
MAIL=/var/mail/root
MAILCHECK=60
MANPATH=/usr/local/share/man:/usr/share/man:/usr/share/binutils-data/i686-pc-linux-gnu/2.16.1/man:/usr/share/gcc-data/i686-pc-linux-gnu/4.1.1/man::/opt/sun-jdk-1.4.2.10/man:/usr/qt/3/doc/man:/opt/vmware/workstation/man
NS=--nospinner
OPENGL_PROFILE=nvidia
OPTERR=1
OPTIND=1
OSTYPE=linux-gnu
PAGER=/usr/bin/less
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/i686-pc-linux-gnu/gcc-bin/4.1.1:/opt/sun-jdk-1.4.2.10/bin:/opt/sun-jdk-1.4.2.10/jre/bin:/opt/sun-jdk-1.4.2.10/jre/javaws:/usr/kde/3.5/sbin:/usr/kde/3.5/bin:/usr/qt/3/bin:/opt/vmware/workstation/bin
PIPESTATUS=([0]="0")
PKG_CONFIG_PATH=/usr/qt/3/lib/pkgconfig
PPID=13196
PRELINK_PATH_MASK=/usr/lib/gstreamer-0.10:/usr/lib/gstreamer-0.8:/usr/lib/klibc
PS1='\[\033[01;31m\]\h\[\033[01;34m\] \W \$\[\033[00m\] '
PS2='> '
PS4='+ '
PWD=/root
PYTHONPATH=/usr/lib/portage/pym
QMAKESPEC=linux-g++
QTDIR=/usr/qt/3
SHELL=/bin/bash
SHELLOPTS=braceexpand:emacs:hashall:histexpand:history:interactive-comments:monitor
SHLVL=1
TERM=linux
UID=0
USER=root




Comment 1


Jakub Moc (RETIRED)






          2006-09-09 14:03:29 UTC
        

They display just fine when your consolefont/consoletranslation and locales are set correctly. You didn't post any kind of this information, so really hard to guess what's wrong on your side. Also please note that bugzilla is not a support forum.






Comment 2


Peter Hyman





          2006-09-09 15:44:17 UTC
        

so then, why did it work before 2006.1? I changed no /etc files.

# /etc/rc.conf: Global startup script configuration settings

# UNICODE specifies whether you want to have UNICODE support in the console.  
# If you set to yes, please make sure to set a UNICODE aware CONSOLEFONT and 
# KEYMAP in the /etc/conf.d/consolefont and /etc/conf.d/keymaps config files.

UNICODE="yes"

# /etc/conf.d/consolefont

# CONSOLEFONT specifies the default font that you'd like Linux to use on the
# console.  You can find a good selection of fonts in /usr/share/consolefonts;
# you shouldn't specify the trailing ".psf.gz", just the font name below.
# To use the default console font, comment out the CONSOLEFONT setting below.
# This setting is used by the /etc/init.d/consolefont script (NOTE: if you do
# not want to use it, run "rc-update del consolefont" as root).

CONSOLEFONT="default8x16"

# CONSOLETRANSLATION is the charset map file to use.  Leave commented to use
# the default one.  Have a look in /usr/share/consoletrans for a selection of
# map files you can use.

#CONSOLETRANSLATION="8859-1_to_uni"

# This file names the list of locales to be built when glibc is installed.
# The format is <locale>/<charmap>, where <locale> is a locale from the
# /usr/share/i18n/locales directory, and <charmap> is name of one of the files
# in /usr/share/i18n/charmaps/. All blank lines and lines starting with # are
# ignored. Here is an example:
# en_US/ISO-8859-1

en_US/ISO-8859-1
en_US.UTF-8/UTF-8
ja_JP.EUC-JP/EUC-JP
ja_JP.UTF-8/UTF-8
ja_JP/EUC-JP
en_HK/ISO-8859-1
en_PH/ISO-8859-1
de_DE/ISO-8859-1
de_DE@euro/ISO-8859-15
es_MX/ISO-8859-1
fa_IR/UTF-8
fr_FR/ISO-8859-1
fr_FR@euro/ISO-8859-15
it_IT/ISO-8859-1






Comment 3


Jakub Moc (RETIRED)






          2006-09-09 16:01:59 UTC
        

Sigh, post the output of locale command, not what you have built in glibc.





Comment 4


Peter Hyman





          2006-09-09 16:19:43 UTC
        

http://permalink.gmane.org/gmane.linux.gentoo.user/169818. This thread adds some color. 

For some reason, my locale is blank. Why would that be? When I recompiled glibc, it went through a lot of languages. 151 of them.

peter@mars ~ $ locale
LANG=
LC_CTYPE="POSIX"
LC_NUMERIC="POSIX"
LC_TIME="POSIX"
LC_COLLATE="POSIX"
LC_MONETARY="POSIX"
LC_MESSAGES="POSIX"
LC_PAPER="POSIX"
LC_NAME="POSIX"
LC_ADDRESS="POSIX"
LC_TELEPHONE="POSIX"
LC_MEASUREMENT="POSIX"
LC_IDENTIFICATION="POSIX"
LC_ALL=





Comment 5


Jakub Moc (RETIRED)






          2006-09-09 16:24:36 UTC
        

Wonderful. So why are you setting UNICODE="yes" if your locale is POSIX???

http://www.gentoo.org/doc/en/utf-8.xml




Comment 6


Jerry McBride





          2006-09-09 18:39:40 UTC
        

Hi Jakub,

I can add a "me too" here. Manually adding /etc/env.d/02locale with the lines suggested in the gentoo doc is pretty much what I had to do to fix things up for MC. Running env-update and source /etc/profile finished it up.

The thing that I don't understand is, why did it work correctly before my move to 2006.1? the 02locale file should have been created by... especially if localization is going to be the norm.

By the way, setting UNICODE to "no" had no effect on the way mc was being effected.






Comment 7


Jakub Moc (RETIRED)






          2006-09-10 00:14:00 UTC
        

(In reply to comment #6)
> the 02locale file should have been created by... 

By what? And how? Using some random guess? Sorry, setting up locales correctly is users' job. 





Comment 8


Peter Hyman





          2006-09-10 06:22:56 UTC
        

(In reply to comment #7)
> (In reply to comment #6)
> > the 02locale file should have been created by... 
> 
> By what? And how? Using some random guess? Sorry, setting up locales correctly
> is users' job. 
> 

Yes, it is. Unfortunately, for over two years, I was happily running without incident. So, by updating to the 2006.1 profile, this problem occured. So, on the one hand, I was ignorant, but on the other hand, it was working fine without any user intervention. So, at the least, there should be some information for users to set LANG and LC_? so that programs will function as expected at the console. JM2C.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

