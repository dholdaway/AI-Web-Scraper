Title: 408471 – dev-libs/soprano-2.7.5 segmentation fault in cmake in detecting dev-libs/redland[mysql]
URL: https://bugs.gentoo.org/show_bug.cgi?id=408471

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 408471
dev-libs/soprano-2.7.5 segmentation fault in cmake in detecting dev-libs/redland[mysql]
Last modified: 2012-07-13 21:43:51 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 408471 
      - dev-libs/soprano-2.7.5 segmentation fault in cmake in detecting dev-libs/redland[mysql]


Summary:
dev-libs/soprano-2.7.5 segmentation fault in cmake in detecting dev-libs/redl...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-03-16 08:10 UTC by Martin Jansa





      Modified:
    
2012-07-13 21:43 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



kripton









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin Jansa





          2012-03-16 08:10:53 UTC
        

With dev-libs/redland built with mysql support I see soprano failing to configure like this:

-- Found Threads: TRUE
-- Found Rasqal: /usr/lib64/librasqal.so
-- Found Rasqal 0.9.28: libs - /usr/lib64/librasqal.so; includes - /usr/include/rasqal
-- Found Raptor: /usr/lib64/libraptor2.so  (found version "2.0.6", required is "2.0.0")
-- Found Redland storage: /usr/lib64/redland/librdf_storage_mysql.so
-- Segmentation fault
CMake Error at cmake/modules/FindRedland.cmake:118 (message):
  Broken Redland detected, rebuild it now.  If problem persists, report bug
  at bugs.gentoo.org.
Call Stack (most recent call first):
  CMakeLists.txt:50 (find_package)


-- Could NOT find Redland  (missing:  _REDLAND_VERSION_OK)
-- Found iODBC 3.52.7: libs - /usr/lib64/libiodbc.so; includes - /usr/include/iodbc
-- Performing Test __SOPRANO_HAVE_GCC_VISIBILITY
-- Performing Test __SOPRANO_HAVE_GCC_VISIBILITY - Success
-- Performing Test __SOPRANO_HAVE_GCC_INLINE_VISIBILITY
-- Performing Test __SOPRANO_HAVE_GCC_INLINE_VISIBILITY - Success
-- Could NOT find Doxygen (missing:  DOXYGEN_EXECUTABLE)
---------------------------------------------------------------------------------------
-- Soprano Components that will be built:
   * Virtuoso storage backend (Run-time dependency: Virtuoso)
   * Raptor RDF parser
     (including TriG parser)
   * Raptor RDF serializer
   * D-Bus server/client support

-- Soprano Components that will NOT be built:
   * Redland storage backend (missing librdf/redland - http://librdf.org)
   * Sesame2 storage backend (java-based)
   * The CLucene-based full-text search index library
---------------------------------------------------------------------------------------
-- <<< Gentoo configuration >>>
Build type      Gentoo
Install path    /usr
Compiler flags:
C
C++              -Wnon-virtual-dtor -Wno-long-long -ansi -Wundef -Wcast-align -Wchar-subscripts -Wall -W -Wpointer-arith -Wformat-security -fno-check-new -fno-common -fvisibility=hidden -fvisibility-inlines-hidden
Linker flags:
Executable
Module
Shared

-- Configuring incomplete, errors occurred!
 * ERROR: dev-libs/soprano-2.7.5 failed (configure phase):
 *   cmake failed
 *
 * Call stack:
 *     ebuild.sh, line   85:  Called src_configure
 *   environment, line 2567:  Called cmake-utils_src_configure
 *   environment, line  644:  Called _execute_optionaly 'src_configure'
 *   environment, line  241:  Called enable_cmake-utils_src_configure
 *   environment, line  965:  Called die
 * The specific snippet of code:
 *       "${CMAKE_BINARY}" "${cmakeargs[@]}" "${CMAKE_USE_DIR}" || die "cmake failed";
 *
 * If you need support, post the output of 'emerge --info =dev-libs/soprano-2.7.5',
 * the complete build log and the output of 'emerge -pqv =dev-libs/soprano-2.7.5'.
 * The complete build log is located at '/tmp/tmpfs/portage/dev-libs/soprano-2.7.5/temp/build.log'.
 * The ebuild environment file is located at '/tmp/tmpfs/portage/dev-libs/soprano-2.7.5/temp/environment'.
 * S: '/tmp/tmpfs/portage/dev-libs/soprano-2.7.5/work/soprano-2.7.5'

and in dmesg:
cmTryCompileExe[30341]: segfault at 65b6 ip 00000000000065b6 sp 00007fff79b69618 error 14 in cmTryCompileExec[400000+1000]

Disabing mysql USE flag in dev-libs/redland makes soprano build happy (or disabling redland/raptor USE flags in soprano but those are needed for semantic-desktop from kdelibs).

I know I've unmasked glibc/gcc so if it cannot be reproduced with default toolchain then consider this bug report only as info for people in same situation as I'm :).

jama ~ # emerge --info
Portage 2.2.0_alpha90 (default/linux/amd64/10.0/desktop/kde, gcc-4.6.2, glibc-2.15, 3.3.0-rc7-00018-g58985bb x86_64)
=================================================================
System uname: Linux-3.3.0-rc7-00018-g58985bb-x86_64-AMD_Phenom-tm-_II_X4_965_Processor-with-gentoo-2.1
Timestamp of tree: Fri, 16 Mar 2012 07:30:01 +0000
ccache version 3.1.7 [disabled]
app-shells/bash:          4.2_p24
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.2-r3, 3.2.2
dev-util/ccache:          3.1.7
dev-util/cmake:           2.8.7-r5
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1
sys-apps/openrc:          0.9.9.3
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.9.6-r3, 1.11.3
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.6.2
sys-devel/gcc-config:     1.5.1-r1
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r3
sys-kernel/linux-headers: 3.2-r1 (virtual/os-headers)
sys-libs/glibc:           2.15
Repositories: gentoo portage-local
Installed sets: @mykde, @mylive
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA RTCW-ETEULA PUEL dlj-1.1 skype-eula googleearth AdobeFlash-10 AdobeFlash-10.1 google-chrome Oracle-BCLA-JavaSE AdobeFlash-10.3"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -O2 -march=barcelona -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/maven-bin-3.0/conf /usr/share/openvpn/easy-rsa /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe"
DISTDIR="/tmp/distfiles"
FEATURES="assume-digests binpkg-logs distlocks ebuild-locks fixlafiles news parallel-fetch preserve-libs protect-owned sandbox sfperms sign strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox"
FFLAGS=""
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US"
LC_ALL="cs_CZ.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed -Wl,--hash-style=gnu"
LINGUAS="cs en en_GB en_US"
MAKEOPTS="-j5"
PKGDIR="/tmp/binpkgs"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/tmp/tmpfs"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow X a52 aac aalib acl acpi aio alsa amd64 amr apache2 avahi bash-completion berkdb bidi bluetooth branding bzip2 cairo ccache cdda cdparanoia cdr cdrom cgi cli consolekit cracklib crypt cups curl cxx dbus declarative dga dri dts dvb dvd dvdr emboss enca encode exif fam fbcon ffmpeg firefox flac flash fmod fontconfig ftp gallium gd gdu gif gkrellm glib glut gnutls gpgme gpm gps gstreamer gzip iconv icq imagemagick imap imlib innodb ipv6 irc irda jabber java java5 java6 javascript joystick jpeg kde kipi kpathsea kqemu krb4 kvm lame lcms libcaca libkms libnotify libwww linuxthreads-tls lirc live lm_sensors logrotate mad maildir matroska mime mmx mng modules mozilla mp3 mp4 mpeg mplayer mudflap multilib mysql mysqli ncurses network nls nntp nocd nptl nptlonly nsplugin nspluginwrapper ogg openal opencore-amr opengl openmp oss pam pango pcre pdf phonon php pic plasma png policykit pop portaudio posix ppds pppd pulseaudio python3 qt3support qt4 readline rss rsync rtc samba sasl screen sdl semantic-desktop session silc slang smartcard smime smtp sndfile sockets spell sse sse2 ssh ssl startup-notification stream subtitles subversion svg svgz symlink sysfs tcpd theora threads tiff truetype udev unicode usb utempter uudeview v4l v4l2 vde vdpau vdr videos vim vim-pager vorbis webkit wxwindows x264 xanim xcb xcomposite xinetd xml xmlreader xmlrpc xorg xosd xpm xscreensaver xsl xulrunner xv xvid zip zlib zvbi" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" APACHE2_MPMS="worker" CALLIGRA_FEATURES="kexi words flow plan stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" DRACUT_MODULES="plymouth biosdevname mdraid syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="cs en en_GB en_US" LIRC_DEVICES="devinput" NETBEANS_MODULES="apisupport cnd groovy gsf harness ide identity j2ee java mobility nb php profiler ruby soa visualweb webcommon websvccommon xml dlight enterprise" PHP_TARGETS="php5-3" QEMU_SOFTMMU_TARGETS="arm i386 x86_64" QEMU_USER_TARGETS="arm armeb i386 x86_64" RUBY_TARGETS="ruby19 jruby" SANE_BACKENDS="epson epson2" USERLAND="GNU" VIDEO_CARDS="vesa nv v4l nouveau nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS


Reproducible: Always




Comment 1


Ian Delaney (RETIRED)






          2012-03-23 09:29:42 UTC
        

could NOT replicate

archtester soprano # eix redland
[I] dev-libs/redland
     Available versions:  1.0.14 1.0.15 {berkdb iodbc mysql odbc postgres sqlite ssl static-libs +xml}
     Installed versions:  1.0.15(16:48:08 23/03/12)(berkdb mysql ssl xml -iodbc -odbc -postgres -sqlite -static-libs)


archtester soprano # ebuild soprano-2.7.5.ebuild configure

-- Build files have been written to: /mnt/gen2/TmpDir/portage/dev-libs/soprano-2.7.5/work/soprano-2.7.5
>>> Source configured.

---------------------------------------------------------------------
-- Found Threads: TRUE 
-- Found Rasqal: /usr/lib64/librasqal.so 
-- Found Rasqal 0.9.28: libs - /usr/lib64/librasqal.so; includes - /usr/include/rasqal
-- Found Raptor: /usr/lib64/libraptor2.so  (found version "2.0.6", required is "2.0.0")
-- Found Redland storage: /usr/lib64/redland/librdf_storage_mysql.so
-- Found Redland: /usr/bin/redland-config 
----------------------------------------------------------------------

perhaps try a revdep-rebuild




Comment 2


Johannes Huber (RETIRED)






          2012-07-13 21:43:51 UTC
        

Cant reproduce.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

