Title: 494258 – x11-libs/libdrm-2.4.50 - /bin/sed: can't read drm-mm.7: No such file or directory
URL: https://bugs.gentoo.org/show_bug.cgi?id=494258

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 494258
x11-libs/libdrm-2.4.50 - /bin/sed: can't read drm-mm.7: No such file or directory
Last modified: 2015-02-22 02:01:10 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 494258 
      - x11-libs/libdrm-2.4.50 - /bin/sed: can't read drm-mm.7: No such file or directory


Summary:
x11-libs/libdrm-2.4.50 - /bin/sed: can't read drm-mm.7: No such file or direc...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-12-14 17:51 UTC by Jonwiz





      Modified:
    
2015-02-22 02:01 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



tamas.haraszti









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log and emerge --info

              (libdrm-fail.txt,47.54 KB,
                text/plain)

            
2013-12-14 17:51 UTC,

            Jonwiz




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jonwiz





          2013-12-14 17:51:17 UTC
        

Created attachment 365332 [details]
build.log and emerge --info

x11-libs/libdrm-2.4.50 ebuild fails


if test -n "drm-mm.7" ; then /bin/sed -i -e 's/^\.so \([a-z_]\+\)\.\([0-9]\)$/\.so man\2\/\1\.\2/' "drm-mm.7" ; fi
if test -n "drm-gem.7" ; then /bin/sed -i -e 's/^\.so \([a-z_]\+\)\.\([0-9]\)$/\.so man\2\/\1\.\2/' "drm-gem.7" ; fi
/bin/sed: can't read drm-mm.7: No such file or directory
make[2]: *** [drm-mm.7] Error 2
make[2]: *** Waiting for unfinished jobs....
/bin/sed: can't read drm-gem.7: No such file or directory
make[2]: *** [drm-gem.7] Error 2
make[2]: Leaving directory `/var/tmp/portage/x11-libs/libdrm-2.4.50/work/libdrm-2.4.50-default/man'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/x11-libs/libdrm-2.4.50/work/libdrm-2.4.50-default'
make: *** [all] Error 2
 [31;01m*[0m ERROR: x11-libs/libdrm-2.4.50::gentoo failed (compile phase):
 [31;01m*[0m   emake failed




Comment 1


Rafał Mużyło





          2013-12-14 20:49:50 UTC
        

Check if you have app-text/docbook-xml-dtd:4.2.
Ebuild doesn't seem to pull that dep, probably cause the eclass would pull much more than really needed.




Comment 2


Jonwiz





          2013-12-14 21:41:39 UTC
        

localhost jon # equery l docbook-xml-dtd
 * Searching for docbook-xml-dtd ...
[IP-] [  ] app-text/docbook-xml-dtd-4.1.2-r6:4.1.2
[IP-] [  ] app-text/docbook-xml-dtd-4.3-r1:4.3


I have these installed




Comment 3


Jonwiz





          2013-12-14 21:47:49 UTC
        

I installed docbook-xml-dtd-4.2-r2

libdrm still fails




Comment 4


Rafał Mużyło





          2013-12-15 10:44:48 UTC
        

(In reply to Jonwiz from comment #3)
> I installed docbook-xml-dtd-4.2-r2
> 
> libdrm still fails

Was there a significant change in the build log ?
It should have removed 'warning: failed to load external entity' warnings.




Comment 5


Tamas Haraszti





          2014-04-08 11:14:49 UTC
        

(In reply to Rafał Mużyło from comment #4)
> Was there a significant change in the build log ?
> It should have removed 'warning: failed to load external entity' warnings.

I have this bug now. Try emerging libdrm-2.4.52, having the newest docbook-xml-dtd (4.5), autoconf, etc.

I could trace the problem being:
in /var/tmp/portage/x11-libs/libdrm-2.4.52/work/libdrm-2.4.52-default/man/
the files are:

Makefile   drm-memory.7  drmAvailable.3    drmModeGetResources.3  drm\-mm.7
drm-kms.7  drm.7         drmHandleEvent.3  drm\-gem.7             drm\-ttm.7

while they should be:

Makefile   drm-memory.7  drmAvailable.3    drmModeGetResources.3  drm-mm.7
drm-kms.7  drm.7         drmHandleEvent.3  drm-gem.7             drm-ttm.7

so I guess either is an escape sequence is messed up somewhere in the Makefile, or one of the tools are outdated in my sysetm, which I do not know.




Comment 6


Tamas Haraszti





          2014-04-08 11:16:05 UTC
        

One more thing:
if I rename the files, the make all and make install runs without error, but that does not make portage happy... 8).




Comment 7


Zhuchenko Valery





          2014-04-17 12:02:34 UTC
        

try this steps:
emerge -pv --depclean docbook-xsl-stylesheets
quickpkg docbook-xsl-stylesheets
emerge -b1 -O docbook-xsl-stylesheets




Comment 8


Tamas Haraszti





          2014-04-17 16:41:52 UTC
        

Excellent, this indeed solved the issue. (Is it possible to know what it was?)




Comment 9


Zhuchenko Valery





          2014-04-18 04:18:58 UTC
        

In attached build.log you can see this:
/usr/bin/xsltproc -o "drmModeGetResources.3" --stringparam man.authors.section.enabled 0 --stringparam man.copyright.section.enabled 0 --stringparam funcsynopsis.style ansi --stringparam man.output.quietly 1 --nonet http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl "/var/tmp/portage/x11-libs/libdrm-2.4.50/work/libdrm-2.4.50/man/drmModeGetResources.xml"

--nonet and http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl

When xsltproc build man pages drm-mm.7 etc., this stylesheet loaded from /usr/share/sgml/docbook/xsl-stylesheets/manpages/docbook.xsl (app-text/docbook-xsl-stylesheets).
Your version was old (I think), and 
  <refnamediv>
    <refname>drm-memory</refname>
    <refname>drm-mm</refname>
    <refname>drm-gem</refname>
    <refname>drm-ttm</refname>
    <refpurpose>DRM Memory Management</refpurpose>
  </refnamediv>
(in sources of libdrm man/drm-memory.xml ) transormed to drm\-mm.7 incorrectly.




Comment 10


Zhuchenko Valery





          2014-04-18 04:20:22 UTC
        

Sorry, this string of build.log

/usr/bin/xsltproc -o "drm-memory.7" --stringparam man.authors.section.enabled 0 --stringparam man.copyright.section.enabled 0 --stringparam funcsynopsis.style ansi --stringparam man.output.quietly 1 --nonet http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl "/var/tmp/portage/x11-libs/libdrm-2.4.50/work/libdrm-2.4.50/man/drm-memory.xml"




Comment 11


Tamas Haraszti





          2014-04-18 06:15:20 UTC
        

Thank you.




Comment 12


Matt Turner






          2015-02-22 02:01:10 UTC
        

I guess this isn't a libdrm issue? Closing.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

