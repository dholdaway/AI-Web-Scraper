Title: 88351 – 2.6.11 gentoo sources HYPERTHREADING DOESNT WORK
URL: https://bugs.gentoo.org/show_bug.cgi?id=88351

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 88351
2.6.11 gentoo sources HYPERTHREADING DOESNT WORK
Last modified: 2005-04-11 13:01:50 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 88351 
      - 2.6.11 gentoo sources HYPERTHREADING DOESNT WORK


Summary:
2.6.11 gentoo sources HYPERTHREADING DOESNT WORK
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo Kernel Bug Wranglers and Kernel Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-08 07:33 UTC by Chris Chance





      Modified:
    
2005-04-11 13:01 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Heres the pesky .config

              (my.config,24.14 KB,
                text/plain)

            
2005-04-08 11:55 UTC,

            Chris Chance




Details





Updated .config 2.6.11-r6

              (.config,24.59 KB,
                text/plain)

            
2005-04-11 10:44 UTC,

            Chris Chance




Details





latest dmesg

              (dmesg,11.66 KB,
                text/plain)

            
2005-04-11 11:10 UTC,

            Chris Chance




Details





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Chris Chance





          2005-04-08 07:33:08 UTC
        

I upgraded from 2.6.10 to 2.6.11 kernel, made sure SMP/Hyperthreading and procs were set to 4 .... and i no longer get my 4 processors as i originally did.

Reproducible: Always
Steps to Reproduce:
1. I installed 2.6.10-gentoo-r6 kernel and configured
2. Installed 2.6.11-gentoo-r3 kernel and copied .config from old settup
3. Rebooted and theres no 4 processors
4. Upgraded to 2.6.11-gentoo-r6 kernel and copied .config from old setup
5. ran make oldconfig to check changes ... none... 
6. Make and reboot... no HT!?

Actual Results:  
No hyperthreading support resulting in 2 processors instead of 4 usable processors

Expected Results:  
4 Usable processors

Bootdata ok (command line is ro root=/dev/sda3 video=1024x768-8@75)
Linux version 2.6.11-gentoo-r6 (root@idl-cache) (gcc version 3.4.3 20041125
(Gentoo Hardened Linux 3.4.3-r1, ssp-3.4.3-0, pie-8.7.7)) #1 SMP Fri Apr 8
03:47:37 EDT 2005
ACPI: Unable to locate RSDP
Intel MultiProcessor Specification v1.4
    Virtual Wire compatibility mode.
OEM ID: OEM00000 <6>Product ID: PROD00000000 <6>APIC at: 0xFEE00000
Processor #0 15:4 APIC version 17
Processor #6 15:4 APIC version 17
I/O APIC #4 Version 17 at 0xFEC00000.
I/O APIC #5 Version 17 at 0xFEC10000.
Setting APIC routing to flat
Processors: 2
Built 1 zonelists
Kernel command line: ro root=/dev/sda3 video=1024x768-8@75 console=tty0
Initializing CPU#0
PID hash table entries: 4096 (order: 12, 131072 bytes)
time.c: Using 1.193182 MHz PIT timer.
time.c: Detected 2800.207 MHz processor.
Console: colour VGA+ 80x25
Dentry cache hash table entries: 524288 (order: 10, 4194304 bytes)
Inode-cache hash table entries: 262144 (order: 9, 2097152 bytes)
Memory: 3607064k/3668928k available (2504k kernel code, 61104k reserved, 1191k
data, 200k init)
Calibrating delay loop... 5521.40 BogoMIPS (lpj=2760704)
Mount-cache hash table entries: 256 (order: 0, 4096 bytes)
CPU: Trace cache: 12K uops, L1 D cache: 16K
CPU: L2 cache: 1024K
using mwait in idle threads.
CPU: Physical Processor ID: 0
CPU0: Thermal monitoring enabled (TM1)
Using IO APIC NMI watchdog
CPU: Trace cache: 12K uops, L1 D cache: 16K
CPU: L2 cache: 1024K
CPU: Physical Processor ID: 0
CPU0:                   Intel(R) Xeon(TM) CPU 2.80GHz stepping 01
per-CPU timeslice cutoff: 1023.85 usecs.
task migration cache decay timeout: 2 msecs.
Booting processor 1/6 rip 6000 rsp ffff8100dfe97f58
Initializing CPU#1
Calibrating delay loop... 5586.94 BogoMIPS (lpj=2793472)
CPU: Trace cache: 12K uops, L1 D cache: 16K
CPU: L2 cache: 1024K
CPU: Physical Processor ID: 3
CPU1: Thermal monitoring enabled (TM1)
                  Intel(R) Xeon(TM) CPU 2.80GHz stepping 01
Total of 2 processors activated (11108.35 BogoMIPS).
WARNING: 1 siblings found for CPU0, should be 2
Using IO-APIC 4
Using IO-APIC 5
activating NMI Watchdog ... done.
testing NMI watchdog ... CPU#1: NMI appears to be stuck (0)!
Using local APIC timer interrupts.
Detected 12.500 MHz APIC timer.
checking TSC synchronization across 2 CPUs: passed.
time.c: Using PIT/TSC based timekeeping.
Brought up 2 CPUs
CPU0 attaching sched-domain:
 domain 0: span 1
  groups: 1
  domain 1: span 3
   groups: 1 2
CPU1 attaching sched-domain:
 domain 0: span 2
  groups: 2
  domain 1: span 3
   groups: 2 1




Comment 1


Carlos Silva (RETIRED)






          2005-04-08 08:25:41 UTC
        

Please attach your .config file.
also, could you test with vanilla-sources-2.6.11.6 and if the problem still exists, test with vanilla-sources-2.6.12_rc2. Just to see where the problem is.




Comment 2


Chris Chance





          2005-04-08 11:55:42 UTC
        

Created attachment 55704 [details]
Heres the pesky .config




Comment 3


Carlos Silva (RETIRED)






          2005-04-09 16:18:45 UTC
        

The file wasn't updated yet.... it still is the 2.6.10-gentoo-r7 one as seen on his header. "make oldconfig" or "make menuconfig" and then "exit & save" to update you config file.
any news on the new kernel testing?




Comment 4


Chris Chance





          2005-04-11 07:16:29 UTC
        

I did make menuconfig and save and ran make oldconfig and it said no changes needed and it still says 2.6.10 for some reason




Comment 5


Chris Chance





          2005-04-11 10:39:12 UTC
        

Ok i was wrong had the symlink wrong the config file now says 2.6.11 im gonna recompile now and post again in a few with the proper .config and see what you guys ahve to say as to why HT doesnt work.




Comment 6


Chris Chance





          2005-04-11 10:44:33 UTC
        

Created attachment 56007 [details]
Updated .config 2.6.11-r6




Comment 7


Chris Chance





          2005-04-11 11:10:34 UTC
        

Created attachment 56009 [details]
latest dmesg




Comment 8


Chris Chance





          2005-04-11 13:01:50 UTC
        

HAHAHAHA ACPI DISABLED in bios and gentoo uses acpi to access HT so that fixed it sorry









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

