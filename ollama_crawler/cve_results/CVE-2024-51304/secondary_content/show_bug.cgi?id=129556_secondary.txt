Title: 129556 – grub 0.96 boot fails if savedefault used
URL: https://bugs.gentoo.org/show_bug.cgi?id=129556

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 129556
grub 0.96 boot fails if savedefault used
Last modified: 2006-04-11 02:02:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 129556 
      - grub 0.96 boot fails if savedefault used


Summary:
grub 0.96 boot fails if savedefault used
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       minor
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-04-10 21:32 UTC by Ben Taylor





      Modified:
    
2006-04-11 02:02 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ben Taylor





          2006-04-10 21:32:56 UTC
        

If 'savedefault' exists uncommented in a boot entry, the boot fails with Error 15: File not found.  If that line is commented out or removed, the boot succeeds.

This problem appeared to resemble http://bugs.gentoo.org/show_bug.cgi?id=112234, but I filed a new bug because that individual's grub.conf did not use savedefault.

I had observed this problem months ago but simply tolerated it; I've entered this bug report now after re-emerging everything (long story, two weeks ago libc disappeared and I eventually had to repair with a LiveCD).

grub version:
grub (GNU GRUB 0.96)

boot.conf:
#
# JustCost boot menu configuration file
#
splashimage=(hd0,1)/grub/fukukatana.xpm.gz
timeout 20
default saved

# For booting GNU/Linux
title JustCost GNU/Linux
root (hd0,1)
kernel /vmlinuz root=/dev/hda4
#savedefault

# For booting Windows NT or Windows95
title MSWindows
rootnoverify (hd0,0)
makeactive
chainloader  +1
#savedefault

/etc/fstab:
/dev/hda1        /mnt/win        ntfs    defaults,ro,user,uid=0,gid=6,umask=002          0 0
/dev/hda2        /boot   ext3    noauto                  1 2
/dev/hda3        none            swap            sw              0 0
/dev/hda4        /       reiserfs        defaults                0 1
none        /proc     proc    defaults          0 0
none        /dev/shm  tmpfs   defaults          0 0
/dev/cdroms/cdrom0      /mnt/cdrom/0    iso9660         noauto,ro,user,unhide  0 0
/dev/cdroms/cdrom1      /mnt/cdrom/1    iso9660         noauto,ro,user,unhide  0 0
/dev/floppy/0           /mnt/floppy     vfat            noauto,user            0 0

motherboard:
EPoX EP-8KRAI-X: http://www.epox.com/USA/product.asp?ID=EP-8KRAI-X
VIA Apollo KT600 Chipset, VT8237 southbridge.

harddrive:
Seagate Barracuda ATA IV, ST340016A

emerge --info:
Portage 2.1_pre7-r5 (default-linux/x86/2006.0, gcc-3.4.5, glibc-2.4-r1, 2.6.15-gentoo-r1-JustCost i686)
=================================================================
System uname: 2.6.15-gentoo-r1-JustCost i686 AMD Sempron(tm)   2800+
Gentoo Base System version 1.6.14
dev-lang/python:     2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=i686 -O2 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/share/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/eselect/compiler /etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=i686 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
MAKEOPTS=""
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow 3dnowext X acpi alsa apache2 apm applet arts audiofile automount avi bash-completion berkdb bitmap-fonts bogofilter bootsplash bzip2 cairo calendar canna cdr cli crypt ctype cups dba dbm dio directfb dnd doc dri dvd eds elibc_glibc emboss encode escreen esd ethereal examples exif expat fam fastbuild firefox font-server fontconfig foomaticdb force-cgi-redirect fortran freetts freewnn ftp gb gcc-libffi gcj gd gdbm gif gimpprint glut glx gmp gnome gnome-print gnustep gphoto2 gpm gstreamer gtk gtk2 gtkhtml guile idn imlib insecure-savers ipv6 isdnlog jabber java javascript jpeg kde kernel_linux lcms lesstif libg++ libwww lua mad memlimit mikmod mng mono motif mouse mozilla mp3 mpeg mule ncurses nls nptl nptlonly nsplugin oav offensive ogg opengl oss pam pcre pdf pdflib perl plotutils png posix postgres pppd python qt quicktime readline samba scanner sdk sdl session simplexml slang soap sockets spell spl ssl tcltk tcpd threads tiff tokenizer truetype truetype-fonts type1-fonts udev unicode userland_GNU verbose vorbis xemacs xfs xft xine xml xml2 xmms xprint xscreensaver xsl xv zlib input_devices_keyboard input_devices_mouse video_cards_ati"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


Jakub Moc (RETIRED)






          2006-04-11 02:02:38 UTC
        

Your configuration is not useful or correct. Did you run grub-set-default X?, See this example:

<snip>
timeout 20
default saved
fallback 1

# For booting GNU/Linux
title JustCost GNU/Linux
root (hd0,1)
kernel /vmlinuz.new root=/dev/hda4 panic=5
savedefault fallback

# For booting GNU/Linux
title JustCost GNU/Linux (old kernel)
root (hd0,1)
kernel /vmlinuz.old root=/dev/hda4
savedefault
</snip>

Next, run

# grub-set-default 0

Now, on reboot it will either boot the vmlinuz.new kernel and set the new default to 1 (i.e., vmlinuz.old kernel - you can check /boot/grub/default) - or, if booting vmlinuz.new fails with kernel panic, it will fallback to vmlinuz.old and again set the default to vmlinuz.old. Then you need to either re-run grub-set-default or change grub.conf to default to the new kernel if you wish to boot vmlinuz.new on next reboot.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

