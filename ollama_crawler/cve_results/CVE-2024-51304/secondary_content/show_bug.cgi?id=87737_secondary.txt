Title: 87737 – media-video/kino-0.7.5-r1 segfaults onstartup
URL: https://bugs.gentoo.org/show_bug.cgi?id=87737

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 87737
media-video/kino-0.7.5-r1 segfaults onstartup
Last modified: 2005-05-30 02:11:04 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 87737 
      - media-video/kino-0.7.5-r1 segfaults onstartup


Summary:
media-video/kino-0.7.5-r1 segfaults onstartup
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Media-video project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-02 19:18 UTC by andrew lorien





      Modified:
    
2005-05-30 02:11 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



amd64









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


andrew lorien





          2005-04-02 19:18:50 UTC
        

the Kino window appears after "starting editor" in the terminal, but it has no controls and does not respond to the window manager...

01042005:gdb kino
GNU gdb 6.0

This GDB was configured as "x86_64-pc-linux-gnu"...Using host libthread_db library "/lib/libthread_db.so.1".

(gdb) run
Starting program: /usr/bin/kino
warning: Unable to find dynamic linker breakpoint function.
GDB will be unable to debug shared library initializers
and track explicitly loaded dynamic code.


> Kino Common being built
> Creating page editor
> Creating Capture Page
> Creating Export Page
> Creating Export1394 Page
> Creating ExportAVI Page
> Creating ExportStills Page
> Creating ExportAudio Page
> Creating ExportMJPEG Page
> Creating ExportPipe Page
/usr/share/kino/scripts/exports/ffmpeg_dvd_dual.sh
Detaching after fork from child process 11493.
/usr/share/kino/scripts/exports/ffmpeg_divx.sh
Detaching after fork from child process 11498.
/usr/share/kino/scripts/exports/ffmpeg_vcd.sh
Detaching after fork from child process 11501.
/usr/share/kino/scripts/exports/ffmpeg_mp3.sh
Detaching after fork from child process 11504.
/usr/share/kino/scripts/exports/rawplay.sh
Detaching after fork from child process 11512.
/usr/share/kino/scripts/exports/ffmpeg_dvd.sh
Detaching after fork from child process 11515.
/usr/share/kino/scripts/exports/extract_chapters
Detaching after fork from child process 11520.
/usr/share/kino/scripts/exports/ffmpeg2theora.sh
Detaching after fork from child process 11522.
which: no ffmpeg2theora in (/bin:/usr/bin:/usr/local/bin:/opt/bin:/usr/x86_64-pc-linux-gnu/gcc-bin/3.3:/usr/X11R6/bin:/opt/blackdown-jdk-1.4.2.01/bin:/opt/blackdown-jdk-1.4.2.01/jre/bin:/usr/qt/3/bin:/usr/kde/3.3/bin:/usr/kde/3.2/bin:/usr/games/bin)
/usr/share/kino/scripts/exports/mencoder.sh
Detaching after fork from child process 11525.
> Creating page trim
>> image creator repository created
>>> Image Create: Fixed Colour
>>> Image Create: Random noise
>>> Image Create: Colour Range
>>> Image Create: Gradiant
>>> Image Create: Create From File
>> image filter repository created
>>> Image Filter: No Change
>>> Image Filter: Black & White
>>> Image Filter: Sepia
>>> Image Filter: Reverse Video
>>> Image Filter: Mirror
>>> Image Filter: Kaleidoscope
>>> Image Filter: Swap
>> image transition repository created
>>> Image Transition: No Change
>>> Image Transition: Switch
>>> Image Transition: Fade
>>> Image Transition: Push Wipe
>>> Image Transition: Barn Door Wipe
>>> Image Transition: Differences
>> audio filter repository created
>>> Audio Filter: No Change
>>> Audio Filter: Silence
>>> Audio Filter: Fade In
>>> Audio Filter: Fade Out
>> audio transition repository created
>>> Audio Transition: No Change
>>> Audio Transition: Cross Fade
>>> Audio Transition: Dub
>>> Audio Transition: Mix
> Creating Magick Page
>> Searching /usr/lib/kino-gtk2 for plugins
>> Starting Editor

Program received signal SIGSEGV, Segmentation fault.

0x0000002a9970decb in mallopt () from /lib/libc.so.6
(gdb) bt
#0 0x0000002a9970decb in mallopt () from /lib/libc.so.6
#1 0x0000002a9970d021 in malloc () from /lib/libc.so.6
#2 0x0000002a996ff84a in fgets () from /lib/libc.so.6
#3 0x0000002a9970172b in fopen64 () from /lib/libc.so.6
#4 0x00000000004713fc in Frame::Frame() ()
#5 0x00000000004736b7 in KinoFramePool::GetFrame() ()
#6 0x0000000000482102 in PageEditor::start() ()
#7 0x000000000047f2bd in KinoCommon::start() ()
#8 0x000000000047bc2f in KinoCommon::setCurrentPage(int) ()
#9 0x0000002a965e2601 in _gtk_marshal_VOID__POINTER_UINT ()
from /usr/lib/libgtk-x11-2.0.so.0
#10 0x0000002a96fcd72f in g_closure_invoke () from /usr/lib/libgobject-2.0.so.0
#11 0x0000002a96fdf738 in g_signal_emit_by_name ()
from /usr/lib/libgobject-2.0.so.0
#12 0x0000002a96fde61c in g_signal_emit_valist ()
from /usr/lib/libgobject-2.0.so.0
#13 0x0000002a96fde975 in g_signal_emit () from /usr/lib/libgobject-2.0.so.0
#14 0x0000002a965f572e in gtk_notebook_new () from /usr/lib/libgtk-x11-2.0.so.0
#15 0x00000000004318fe in main ()

<END TERMINAL COPY>

Reproducible: Always
Steps to Reproduce:
1.>emerge -pv kino
2.>[ebuild   R   ] media-video/kino-0.7.5-r1  -dvdr -ffmpeg -quicktime 0 kB
3.>kino



Portage 2.0.51.19 (default-linux/amd64/2004.3, gcc-3.3.4,
glibc-2.3.4.20040808-r1, 2.6.9-gentoo-r14 x86_64)
=================================================================
System uname: 2.6.9-gentoo-r14 x86_64 AMD Athlon(tm) 64 Processor 3000+
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4 [2.3.4 (#1, Jan 11 2005, 18:22:45)]
ccache version 2.3 [enabled]
dev-lang/python:     2.3.4
sys-devel/autoconf:  2.59-r5
sys-devel/automake:  1.8.5-r1
sys-devel/binutils:  2.15.90.0.1.1-r3
sys-devel/libtool:   1.5.2-r7
virtual/os-headers:  2.4.21-r1
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-O2 -pipe -frename-registers  -mno-align-stringops
-fomit-frame-pointer"CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/X11R6/lib/X11/xkb /usr/kde/2/share/config
/usr/kde/3.2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config
/usr/kde/3.3/shutdown /usr/kde/3/share/config /usr/lib/mozilla/defaults/pref
/usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -pipe -frename-registers  -mno-align-stringops -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks nostrip prelink sandbox sfperms
userpriv usersandbox"
GENTOO_MIRRORS="ftp://mirror.pacific.net.au/linux/Gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X aalib acpi alsa amd64 arts artswrappersuid berkdb bitmap-fonts bonobo cdr
compositor crypt curl divx4linux dvd encode esd fam fbcon flac font-server
fortran gdbm gif gnome gphoto2 gpm graphviz gstreamer gtk gtkhtml imagemagick
imlib ipv6 java jbig jp2 jpeg junit lzw lzw-tiff mad mikmod motif mozilla
mozillanoirc mozillanomail mp3 mpeg multilib ncurses nls nvidia oggvorbis opengl
oss pam perl png python readline ruby samba sdl slang ssl tcltk tcpd tiff
truetype truetype-fonts ttfont type1-fonts usb userlocales wmf xml xml2 xmms xpm
xrandr xv zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, PORTDIR_OVERLAY




Comment 1


Jan Brinkmann (RETIRED)






          2005-04-02 19:23:12 UTC
        

does this also happen if you compile it with cflags that are less insane, like CFLAGS="-O2 -march=k8 -pipe" (edit them in the make.conf)?




Comment 2


andrew lorien





          2005-04-02 21:08:48 UTC
        

exactly the same (except i didn't use -march=k8 because i'm using x86_64)
i also added ffmpeg to my USE flags.
can't find this problem mentioned anywhere else, not on the kino forum or anywhere.




Comment 3


Jan Brinkmann (RETIRED)






          2005-04-16 07:25:04 UTC
        

i'm still unable to reproduce that problem






Comment 4


Jan Brinkmann (RETIRED)






          2005-04-20 10:16:35 UTC
        

which alsa-driver / alsa-lib do you use, i.e. whcih versions?




Comment 5


andrew lorien





          2005-04-20 17:07:43 UTC
        

Good question.
alsa-lib 1.0.7
alsa-headers 1.0.7

hmm - alsa-driver isn't installed at all.  do you think it should be?

i'm sorry i didn't reply to your last question, i spent a couple of hours recompiling things and running gdb and strace, but i just couldn't find anything new...




Comment 6


Jan Brinkmann (RETIRED)






          2005-04-20 22:17:46 UTC
        

do you use the kernel own alsa-driver? disable the kernel driver an use the one out of the tree. that can also be the problem, maybe things are out of sync.




Comment 7


andrew lorien





          2005-04-21 07:35:40 UTC
        

nope, still doesn't work.
didn't even fix my only sound problem (i can't record anything - just static or empty files)

it did change the backtrace though - up to line three was identical to what i've already posted, but the top three lines are new...

#0  0x0000002a9970f6a4 in _int_malloc () from /lib/libc.so.6
#1  0x0000002a9970e7b1 in malloc () from /lib/libc.so.6
#2  0x0000002a99700f8a in __fopen_internal () from /lib/libc.so.6
#3  0x0000002a99702e6b in fopen64 () from /lib/libc.so.6





Comment 8


Jan Brinkmann (RETIRED)






          2005-05-29 06:24:04 UTC
        

is this still an issue with the new alsa version 1.0.9? please update
alsa-driver, alsa-lib, alsa-headers and so on to 1.0.9, try it again and report
back. i'm still not able to reproduce this problem




Comment 9


andrew lorien





          2005-05-30 02:06:36 UTC
        

yay!  it works now!

using alsa-headers 1.0.9-rc3 and alsa-lib 1.0.9-rc3 (and the driver in the kernel).
However:   since last we spoke, i have rebuilt the system from 2005.0, using
exactly the same kernel config i had before (2.6.9-gentoo-r9).  so something
else may have changed.  if you (or anyone else experiencing this problem) would
like me to try downgrading the alsa stuff to 1.0.8 without changing anything
else to see if that breaks it again, i'd be happy to.  but for the moment, at
least, i think you can close the bug.

thanks again.




Comment 10


Jan Brinkmann (RETIRED)






          2005-05-30 02:11:04 UTC
        

marking as worksforme wrt to your last comment, thanks for reporting. feel free
to reopen if the problem pops up again.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

