Title: 846770 – net-misc/curl-7.83.1 compile error with ldap useflag
URL: https://bugs.gentoo.org/show_bug.cgi?id=846770

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 846770
net-misc/curl-7.83.1 compile error with ldap useflag
Last modified: 2023-06-08 11:59:48 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 846770 
      - net-misc/curl-7.83.1 compile error with ldap useflag


Summary:
net-misc/curl-7.83.1 compile error with ldap useflag
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Matt Jolly








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2022-05-21 13:59 UTC by b2c





      Modified:
    
2023-06-08 11:59 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



base-system









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (file_846770.txt,8.06 KB,
                text/plain)

            
2022-05-21 13:59 UTC,

            b2c




Details





curl buildlog

              (net-misc_curl_buildlog.log,400.72 KB,
                text/plain)

            
2022-05-21 14:22 UTC,

            b2c




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


b2c





          2022-05-21 13:59:04 UTC
        

Emerging curl 7.83.1 with "ldap" useflag yields the following compile error:

    /usr/lib/gcc/x86_64-pc-linux-gnu/11.2.1/../../../../x86_64-pc-linux-gnu/bin/ld: ../lib/.libs/libcurl.so: undefined reference to `Curl_sasl_decode_mech'
    /usr/lib/gcc/x86_64-pc-linux-gnu/11.2.1/../../../../x86_64-pc-linux-gnu/bin/ld: ../lib/.libs/libcurl.so: undefined reference to `Curl_sasl_parse_url_auth_option'
    /usr/lib/gcc/x86_64-pc-linux-gnu/11.2.1/../../../../x86_64-pc-linux-gnu/bin/ld: ../lib/.libs/libcurl.so: undefined reference to `Curl_sasl_cleanup'
    /usr/lib/gcc/x86_64-pc-linux-gnu/11.2.1/../../../../x86_64-pc-linux-gnu/bin/ld: ../lib/.libs/libcurl.so: undefined reference to `Curl_sasl_can_authenticate'
    /usr/lib/gcc/x86_64-pc-linux-gnu/11.2.1/../../../../x86_64-pc-linux-gnu/bin/ld: ../lib/.libs/libcurl.so: undefined reference to `Curl_sasl_continue'
    /usr/lib/gcc/x86_64-pc-linux-gnu/11.2.1/../../../../x86_64-pc-linux-gnu/bin/ld: ../lib/.libs/libcurl.so: undefined reference to `Curl_sasl_start'
    /usr/lib/gcc/x86_64-pc-linux-gnu/11.2.1/../../../../x86_64-pc-linux-gnu/bin/ld: ../lib/.libs/libcurl.so: undefined reference to `Curl_sasl_init'
    collect2: error: ld returned 1 exit status
    make[2]: *** [Makefile:988: curl] Error 1
    make[2]: Leaving directory '/var/tmp/portage/net-misc/curl-7.83.1/work/curl-7.83.1-abi_x86_64.amd64/src'
    make[1]: *** [Makefile:1475: all-recursive] Error 1
    make[1]: Leaving directory '/var/tmp/portage/net-misc/curl-7.83.1/work/curl-7.83.1-abi_x86_64.amd64/src'
    make: *** [Makefile:1229: all-recursive] Error 1

Disabling the ldap useflag makes it compile.




Comment 1


b2c





          2022-05-21 13:59:39 UTC
        

Created attachment 779675 [details]
emerge --info




Comment 2


Sam James









          2022-05-21 14:02:30 UTC
        

Please include the full build.log.




Comment 3


b2c





          2022-05-21 14:22:23 UTC
        

Created attachment 779684 [details]
curl buildlog

attached buildlog




Comment 4


b2c





          2022-05-21 14:26:16 UTC
        

Hi Sam,

buildlog attached now, also:

~# emerge -pqv '=net-misc/curl-7.83.1::gentoo'

[ebuild   R   ] net-misc/curl-7.83.1  USE="brotli ftp hsts http2 idn kerberos openssl progress-meter ssl threads zstd -adns -alt-svc -gnutls -gopher -imap -ipv6 -ldap -mbedtls (-nghttp3) -nss -pop3 (-quiche) -rtmp -samba -smtp -ssh -sslv3 -static-libs -telnet -test -tftp -verify-sig" ABI_X86="32 (64) (-x32)" CURL_SSL="openssl -gnutls -mbedtls -nss"




Comment 5


b2c





          2022-05-21 14:28:52 UTC
        

Sorry, last emerge output was missing the ldap useflag, I had already changed it back. When it fails to build it looks like this:

~# emerge -pqv '=net-misc/curl-7.83.1::gentoo'

[ebuild   R   ] net-misc/curl-7.83.1  USE="brotli ftp hsts http2 idn kerberos ldap  openssl progress-meter ssl threads zstd -adns -alt-svc -gnutls -gopher -imap -ipv6 -mbedtls (-nghttp3) -nss -pop3 (-quiche) -rtmp -samba -smtp -ssh -sslv3 -static-libs -telnet -test -tftp -verify-sig" ABI_X86="32 (64) (-x32)" CURL_SSL="openssl -gnutls -mbedtls -nss"




Comment 6


Vasco Steinmetz





          2022-05-22 09:35:49 UTC
        

I have the same issues here too on those machines which have +ldap but -imap set.
With +ldap and +imap it compiles fine.




Comment 7


Matt Jolly






          2023-02-20 12:25:41 UTC
        

Unable to repro with `USE=ldap -imap` for cURL 7.88.1. Please let me know if this is still occurring; if I don't hear back I'll close the ticket next time I look in on it.




Comment 8


b2c





          2023-03-17 13:36:30 UTC
        

Hi Matt,

works here now with curl-7.87:

---
emerge -pqv '=net-misc/curl-7.87.0-r2::gentoo'

[ebuild   R   ] net-misc/curl-7.87.0-r2  USE="brotli ftp hsts http2 idn kerberos ldap openssl progress-meter ssl zstd -adns -alt-svc -gnutls -gopher -imap -ipv6 -mbedtls (-nghttp3) -nss -pop3 (-quiche) -rtmp (-rustls) -samba -smtp -ssh -sslv3 -static-libs -telnet -test -tftp -verify-sig -websockets" ABI_X86="32 (64) (-x32)" CURL_SSL="openssl -gnutls -mbedtls -nss (-rustls)"
---

Thanks, ticket can be closed I presume.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

