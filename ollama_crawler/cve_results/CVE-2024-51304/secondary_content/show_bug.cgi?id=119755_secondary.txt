Title: 119755 – emerge of baselayout-1.11.14-r2 breaks 64-bit systems
URL: https://bugs.gentoo.org/show_bug.cgi?id=119755

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 119755
emerge of baselayout-1.11.14-r2 breaks 64-bit systems
Last modified: 2006-03-29 14:56:18 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 119755 
      - emerge of baselayout-1.11.14-r2 breaks 64-bit systems


Summary:
emerge of baselayout-1.11.14-r2 breaks 64-bit systems
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       blocker
      


Assignee:

Jeremy Huddleston (RETIRED)








URL:



http://forums.gentoo.org/viewtopic-p-...
        




Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-01-20 17:50 UTC by Greg Tassone





      Modified:
    
2006-03-29 14:56 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



base-system









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Greg Tassone





          2006-01-20 17:50:58 UTC
        

I just emerged the newest stable baselayout today during a system update.  emerge attempted to update me to "sys-apps/baselayout-1.11.14-r2".  The install appears to complete, but emerge died during the unmerge/clean process.  Afterwards, all applications begin to fail system-wide.

After rebooting to a live CD and investigating I found that all "lib/" symlinks were GONE.  On 64-bit systems like mine there should be symlinks like the following:

/lib -> /lib64
/usr/lib -> /usr/lib64
/usr/local/lib -> /usr/local/lib64

These were all missing.  I manually created the symlinks and rebooted which seems to have fixed everything.  I'll now be investigating further to see if I can find the exact cause of this.  Please see the URL I added for the Gentoo Forums to see more discussion around this issue.  Thanks!




Comment 1


Greg Tassone





          2006-01-20 18:04:50 UTC
        

I have re-emerged baselayout-1.11.14-r2 with no problems -- the symlinks still remain and everything is working.  I then researched by emerge.log to see what happened at the tail-end of the system update -- before everything began to crash.  It appears that things started breaking during the unmerge of the old baselayout (baselayout-1.11.14-r2):

-------------------------------
1137796330:  ::: completed emerge (2 of 6) sys-apps/sysvinit-2.86-r3 to /
1137796330:  >>> emerge (3 of 6) sys-apps/baselayout-1.11.14-r2 to /
1137796330:  === (3 of 6) Cleaning (sys-apps/baselayout-1.11.14-r2::/usr/portage/sys-apps/baselayout/baselayout-1.11.14-r2.ebuild)
1137796330:  === (3 of 6) Compiling/Merging (sys-apps/baselayout-1.11.14-r2::/usr/portage/sys-apps/baselayout/baselayout-1.11.14-r2.ebuild)
1137796345:  === (3 of 6) Post-Build Cleaning (sys-apps/baselayout-1.11.14-r2::/usr/portage/sys-apps/baselayout/baselayout-1.11.14-r2.ebuild)
1137796346:  >>> AUTOCLEAN: sys-apps/baselayout
1137796351: === Unmerging... (sys-apps/baselayout-1.11.13-r1)
1137796352:  *** terminating.
-------------------------------

Notice that there were still other ebuilds to be merged, yet emerge died at this point and terminated.  Shortly thereafter everything started failing on my machine (new problems wouldn't launch, new terminals were having problems executing any commands, etc.).

I suspect that the unmerge/clean removed the symlinks from the system and killed everything off.




Comment 2


Greg Tassone





          2006-01-21 12:23:13 UTC
        

FYI:  I've upgraded a similarly configured amd64 machine this morning.  It did NOT experience the problem on this machine.  At the completion of the system update everything is still working.  I investigated the status/existence of symlinks for my lib/ directories and found:

lib
lib32
lib64 -> lib

This is slightly different than the linking scheme I re-created manually, as in case the "lib" directory seems to contain the native 64-bit libs and a symlink of "lib64" has been created to point to it.  Now I'll have to investigate which way is the correct way -- I don't want anything else breaking in the future due to my manual fix.

Anyway, I'm not sure why one machine had the problem and the other did not.  There is one major difference that could be the factor:

- On the machine that broke, I have Portage version: sys-apps/portage-2.1_pre3-r1

- On the machine that didn't break, I have: sys-apps/portage-2.0.54

Otherwise, both machines are updated regularly and run almost entirely "stable" software.




Comment 3


Jeremy Huddleston (RETIRED)






          2006-03-29 10:34:38 UTC
        

I can't reproduce this on amd64 or ppc64 or sparc64 multilib... if you experience it again, please let me know...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

