Title: 492366 – www-client/chromium fails to build on arm (cross_correlation_neon)
URL: https://bugs.gentoo.org/show_bug.cgi?id=492366

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 492366
www-client/chromium fails to build on arm (cross_correlation_neon)
Last modified: 2014-06-09 06:57:33 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 492366 
      - www-client/chromium fails to build on arm (cross_correlation_neon)


Summary:
www-client/chromium fails to build on arm (cross_correlation_neon)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Chromium Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-11-23 17:32 UTC by Paweł Hajdan, Jr. (RETIRED)





      Modified:
    
2014-06-09 06:57 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



arm









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log.bz2

              (build.log.bz2,27.41 KB,
                application/x-bzip2)

            
2013-11-23 17:32 UTC,

            Paweł Hajdan, Jr. (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Paweł Hajdan, Jr. (RETIRED)






          2013-11-23 17:32:59 UTC
        

Created attachment 363840 [details]
build.log.bz2

FAILED: armv7a-hardfloat-linux-gnueabi-gcc -MMD -MF obj/third_party/webrtc/common_audio/signal_processing/common_audio_neon.cross_correlation_neon.o.d -DANGLE_DX11 '-DWEBRTC_SV
NREVISION="Unavailable(issue687)"' -D_FILE_OFFSET_BITS=64 -DNO_TCMALLOC -DDISABLE_NACL -DCHROMIUM_BUILD -DUSE_DEFAULT_RENDER_THEME=1 -DUSE_LIBJPEG_TURBO=1 -DUSE_NSS=1 -DUSE_X11
=1 -DENABLE_ONE_CLICK_SIGNIN -DGTK_DISABLE_SINGLE_INCLUDES=1 -DUSE_XI2_MT=2 -DENABLE_REMOTING=1 -DENABLE_WEBRTC=1 -DUSE_PROPRIETARY_CODECS -DENABLE_PEPPER_CDMS -DENABLE_CONFIGU
RATION_POLICY -DENABLE_INPUT_SPEECH -DENABLE_NOTIFICATIONS -DLOGGING_IS_OFFICIAL_BUILD=1 -DENABLE_EGLIMAGE=1 -DENABLE_TASK_MANAGER=1 -DENABLE_EXTENSIONS=1 -DENABLE_PLUGIN_INSTA
LLATION=1 -DENABLE_PLUGINS=1 -DENABLE_SESSION_SERVICE=1 -DENABLE_THEMES=1 -DENABLE_BACKGROUND=1 -DENABLE_AUTOMATION=1 -DENABLE_GOOGLE_NOW=1 -DCLD_VERSION=2 -DENABLE_FULL_PRINTI
NG=1 -DENABLE_PRINTING=1 -DENABLE_SPELLCHECK=1 -DENABLE_CAPTIVE_PORTAL_DETECTION=1 -DENABLE_MANAGED_USERS=1 -DENABLE_MDNS=1 -DWEBRTC_RESTRICT_LOGGING -DWEBRTC_CHROMIUM_BUILD -D
WEBRTC_ARCH_ARM -DWEBRTC_ARCH_ARM_V7 -DWEBRTC_DETECT_ARM_NEON -DWEBRTC_LINUX -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -DNDEBUG -DNVALGRIND -DDYNAMIC_ANNOTATIONS_ENABLED=
0 -D_FORTIFY_SOURCE=2 -I../../third_party -I../.. -fstack-protector --param=ssp-buffer-size=4  -pthread -fno-exceptions -fno-strict-aliasing -Wall -Wno-unused-parameter -Wno-mi
ssing-field-initializers -fvisibility=hidden -pipe -fPIC -mfpu=neon -flax-vector-conversions -march=armv7-a -mtune=cortex-a8 -mfpu=vfpv3 -mfloat-abi=hard -mthumb -O2 -fno-ident
 -fdata-sections -ffunction-sections -O2 -pipe -march=armv7-a -mfloat-abi=hard  -c ../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S -o obj/third
_party/webrtc/common_audio/signal_processing/common_audio_neon.cross_correlation_neon.o
<command-line>:0:0: warning: "_FORTIFY_SOURCE" redefined [enabled by default]
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:1:0: note: this is the location of the previous definition
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S: Assembler messages:
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:51: Error: selected FPU does not support instruction -- `vmov.i32 q9,#0'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:52: Error: selected FPU does not support instruction -- `vmov.i32 q14,#0'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:62: Error: selected processor does not support ARM mode `vmull.s16 q12,d20,d22'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:63: Error: selected processor does not support ARM mode `vmull.s16 q13,d21,d23'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:64: Error: selected processor does not support ARM mode `vpadal.s32 q9,q12'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:65: Error: selected processor does not support ARM mode `vpadal.s32 q14,q13'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:84: Error: selected FPU does not support instruction -- `vadd.i64 d18,d19'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:85: Error: selected FPU does not support instruction -- `vadd.i64 d28,d29'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:86: Error: selected FPU does not support instruction -- `vadd.i64 d18,d28'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:89: Error: selected FPU does not support instruction -- `vadd.i64 d17,d18'
../../third_party/webrtc/common_audio/signal_processing/cross_correlation_neon.S:90: Error: selected processor does not support ARM mode `vshl.s64 d17,d16'

Portage 2.2.7 (hardened/linux/arm/armv7a, gcc-4.7.3, glibc-2.15-r3, 3.0.35-03022-gbdde708 armv7l)
=================================================================
System uname: Linux-3.0.35-03022-gbdde708-armv7l-ARMv7_Processor_rev_10_-v7l-with-gentoo-2.2
KiB Mem:      765828 total,    429512 free
KiB Swap:    8388604 total,   8382892 free
Timestamp of tree: Fri, 22 Nov 2013 06:00:01 +0000
ld GNU ld (GNU Binutils) 2.23.1
ccache version 3.1.9 [disabled]
app-shells/bash:          4.2_p45
dev-lang/python:          2.7.5-r2, 3.2.5-r2
dev-util/ccache:          3.1.9
dev-util/cmake:           2.8.10.2-r2
dev-util/pkgconfig:       0.28
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.11.8
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.11.6, 1.12.6, 1.13.4
sys-devel/binutils:       2.23.1
sys-devel/gcc:            4.5.4, 4.6.3, 4.7.3-r1
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.9 (virtual/os-headers)
sys-libs/glibc:           2.15-r3
Repositories: gentoo x-testing
ACCEPT_KEYWORDS="arm"
ACCEPT_LICENSE="* -@EULA"
CBUILD="armv7a-hardfloat-linux-gnueabi"
CFLAGS="-O2 -pipe -march=armv7-a -mfpu=vfpv3 -mfloat-abi=hard"
CHOST="armv7a-hardfloat-linux-gnueabi"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe -march=armv7-a -mfpu=vfpv3 -mfloat-abi=hard"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe -march=armv7-a"
FEATURES="assume-digests binpkg-logs buildpkg config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe -march=armv7-a"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_BUNZIP2_COMMAND="pbunzip2 --ignore-trailing-garbage=1"
PORTAGE_BZIP2_COMMAND="pbzip2"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"   
PORTDIR_OVERLAY="/var/overlays/testing"
SYNC="rsync://192.168.11.55/gentoo-portage"
USE="X a52 aac acl alsa arm artworkextra ass avahi berkdb bindist bzip2 cairo caps cdio cli cracklib cxx dbus dirac dlz dri dts dv exif extras faac ffmpeg flac fortran g3dvl gd gdbm git gles2 gsm gtk guile hardened iconv icu intl ipv6 jpeg jpeg2k lame latex lcms lock lua math mbox minizip modplug modules mp3 mpeg mudflap ncurses networking nls nptl ogg openal opengl openmp openssl openxml oss ots pam pax_kernel pcre pic pulseaudio python readline sdl server session speex spell ssl static-libs svg taglib tcpd theora thesaurus threads thunar tiff unicode urandom vcd vorbis wmf wordperfect xmp xv xvid xvmc zlib" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-5" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_2" RUBY_TARGETS="ruby19 ruby18" USERLAND="GNU" VIDEO_CARDS="exynos fbdev omap omapfb dummy v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON




Comment 1


Paweł Hajdan, Jr. (RETIRED)






          2013-11-23 19:11:11 UTC
        

Actually chromium-31.0.1650.57 and 32 is also affected. I wonder why this wasn't reported by anyone before.




Comment 2


Steev Klimaszewski (RETIRED)






          2013-11-24 09:29:26 UTC
        

If I had to wager a guess, it's because chromium takes a while to build, so once we have a working version, we have it keyworded as "=www-client/chromium-30.0.1599.101" in the package.accept_keywords/chromium file, and so we don't upgrade it every single time there is a new version pushed into portage :)

That said, I can take a look tomorrow sometime, the Samsung has been sitting by idling while I've been working on SELinux as well as Xen for ARM.  There's only so much time to spare.




Comment 3


Mikhail Kurinnoi





          2013-11-25 21:15:08 UTC
        

I did't have any issues with www-client/chromium (30,31 and 32 versions) and neon support. Just now emerged www-client/chromium-32.0.1700.19 with "neon" USE flag on my ARM box.
As I see, you are using -mfpu=vfpv3 in CXXFLAGS, here is mine:
CXXFLAGS="-O2 -pipe -march=armv7-a -mtune=cortex-a9 -mfpu=neon -mfloat-abi=hard"

Probably, "Error: selected FPU does not support instruction -- `vmov.i32 q9,#0'" error line could be connected to wrong mfpu (vfpv3 instead of neon)?




Comment 4


Steev Klimaszewski (RETIRED)






          2013-11-25 21:55:40 UTC
        

More specifically, it should not be enabling neon code without neon support being enabled - either via neon in mfpu or a useflag of some sort.

We're running into something very similar in Firefox, when libpng is built with the neon useflag enabled, but users don't have mfpu=neon.

It SHOULD be possible to use neon code even when mfpu!=neon, at least, that's my understanding of it.  I could be wrong though.




Comment 5


Paweł Hajdan, Jr. (RETIRED)






          2014-06-09 06:57:33 UTC
        

It seems fixed as of www-client/chromium-36.0.1985.1 on ~arm.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

