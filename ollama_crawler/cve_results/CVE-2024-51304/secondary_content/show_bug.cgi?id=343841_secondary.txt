Title: 343841 – gnome-base/gnome-panel-2.32.0.2 needs eggdbus on some setups due orphan .la files
URL: https://bugs.gentoo.org/show_bug.cgi?id=343841

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 343841
gnome-base/gnome-panel-2.32.0.2 needs eggdbus on some setups due orphan .la files
Last modified: 2012-01-06 12:55:01 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 343841 
      - gnome-base/gnome-panel-2.32.0.2 needs eggdbus on some setups due orphan .la files


Summary:
gnome-base/gnome-panel-2.32.0.2 needs eggdbus on some setups due orphan .la f...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

No maintainer - Look at https://wiki.gentoo.org/wiki/Project:Proxy_Maintainers if you want to take care of it








URL:



https://bugzilla.gnome.org/show_bug.c...
        




Whiteboard:




Keywords:









Duplicates (2):
    

355199 361047

      (view as bug list)
    


Depends on:







Blocks:




gnome2.32



 

        Show dependency tree





 





      Reported:
    
2010-11-02 13:23 UTC by Hanno Böck





      Modified:
    
2012-01-06 12:55 UTC
      (History)
    




          CC List:
        

9 
          users
          
            (show)
          



andrey.vihrov
gnome
jan
jrmalaq
marduk
rose
saintdev
sheldonh
sparky









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




ebuild environment

              (environment,208.26 KB,
                text/plain)

            
2011-02-10 09:05 UTC,

            Sheldon Hearn




Details





build.log

              (build.log,25.00 KB,
                text/plain)

            
2011-02-10 09:07 UTC,

            Sheldon Hearn




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Hanno Böck






          2010-11-02 13:23:18 UTC
        

Seems the clock applet lib in gnome-panel-2.32.0.2 needs eggdbus:
  CCLD   libclock-applet.la
/usr/lib/gcc/x86_64-pc-linux-gnu/4.5.1/../../../../x86_64-pc-linux-gnu/bin/ld: cannot find -leggdbus-1

After merging dev-libs/eggdbus, compilation works fine.




Comment 1


Gilles Dartiguelongue (RETIRED)






          2010-11-02 13:40:24 UTC
        

This is strange, it indeed links to it here as well, but a git grep on upstream's repository gives nothing.




Comment 2


Gilles Dartiguelongue (RETIRED)






          2010-11-02 13:43:16 UTC
        

and ftr, checking /var/db/pkg/gnome-base/gnome-panel/.../NEEDED, only the clock applet is concerned.




Comment 3


Pacho Ramos






          2010-12-04 17:50:45 UTC
        

Fixed in 2.32.1




Comment 4


Pacho Ramos






          2011-02-01 09:37:17 UTC
        

Upstream thinks it's not required, and I have just rechecked today and I have seen nothing in /var/db/pkg/gnome-base/gnome-panel/.../NEEDED looks to require it and compilation works without eggdbus




Comment 5


Pacho Ramos






          2011-02-04 11:03:15 UTC
        

+  04 Feb 2011; Pacho Ramos <pacho@gentoo.org> gnome-panel-2.32.1.ebuild:
+  Drop eggdbus dependency as looks to be not really needed as told by upstream
+  and confirmed by me.
+





Comment 6


Adrian Bassett





          2011-02-09 09:10:20 UTC
        

(In reply to comment #5)
> +  04 Feb 2011; Pacho Ramos <pacho@gentoo.org> gnome-panel-2.32.1.ebuild:
> +  Drop eggdbus dependency as looks to be not really needed as told by upstream
> +  and confirmed by me.
> +
> 

But I get this with 2.32.1-r1:

Merging translations into clock.schemas.
  CCLD   libclock-applet.la
Found cached translation database
Merging translations into org.gnome.panel.ClockApplet.panel-applet.
  CCLD   test-system-timezone
/usr/lib/gcc/x86_64-pc-linux-gnu/4.5.2/../../../../x86_64-pc-linux-gnu/bin/ld: cannot find -leggdbus-1

Merging dev-libs/eggdbus-0.6 allows gnome-panel to emerge OK.





Comment 7


Pacho Ramos






          2011-02-09 17:02:01 UTC
        

Have you try to run "lafilefixer --justfixit"?




Comment 8


Sheldon Hearn





          2011-02-10 09:04:36 UTC
        

(In reply to comment #7)
> Have you try to run "lafilefixer --justfixit"?
 
Yes, makes no difference.

Ciao,
Sheldon.




Comment 9


Sheldon Hearn





          2011-02-10 09:05:58 UTC
        

Created attachment 262017 [details]
ebuild environment

ebuild environment from failing 2.32.1-r1 build.




Comment 10


Sheldon Hearn





          2011-02-10 09:07:10 UTC
        

Created attachment 262019 [details]
build.log

full build log of failing 2.32.1.-r1 build.




Comment 11


Sheldon Hearn





          2011-02-10 09:08:02 UTC
        

WONTFIX why?




Comment 12


Pacho Ramos






          2011-02-10 09:13:33 UTC
        

I will reopen but won't add that dep back until we know what is wrong in your systems :-|




Comment 13


Pacho Ramos






          2011-02-10 09:14:06 UTC
        

(In reply to comment #11)
> WONTFIX why?
> 

It was explained in comment #4




Comment 14


Sheldon Hearn





          2011-02-10 09:21:14 UTC
        

(In reply to comment #12)
> I will reopen but won't add that dep back until we know what is wrong in your
> systems :-|

What's wrong with our systems is that they cause the gnome-panel build to link the clock applet against a non-existent library. :-)

Ciao,
Sheldon.




Comment 15


Pacho Ramos






          2011-02-11 19:05:38 UTC
        

Maybe running the following could give an idea about why is this wrongly "needed":
$ grep eggdbus /usr/lib/*.la




Comment 16


Sheldon Hearn





          2011-02-14 07:29:58 UTC
        

Excellent.  A bunch of files that aren't owned by any installed package:

/usr/lib/libgksu2.la
/usr/lib/libgnomecupsui-1.0.la
/usr/lib/libgweather.la
/usr/lib/librhythmbox-core.la
/usr/lib/libsvn_auth_gnome_keyring-1.la

I removed them, and gnome-panel built fine.

Is there some important post-upgrade maintenance step that I'm ignoring, or are these left-overs a fact of life that gnome-panel's build should work around? I usually do

emerge -avtNDu world
revdep-rebuild -- -av
emerge --depclean

Ciao,
Sheldon.




Comment 17


Gilles Dartiguelongue (RETIRED)






          2011-02-14 09:54:20 UTC
        

I think you can blame lafilefixer for changing the md5 of files owned by portage packages but not updating vdb :(




Comment 18


Pacho Ramos






          2011-02-14 10:06:12 UTC
        

I am unsure about if we can do much more for this bug :-/




Comment 19


Gilles Dartiguelongue (RETIRED)






          2011-02-16 16:09:17 UTC
        

*** Bug 355199 has been marked as a duplicate of this bug. ***




Comment 20


Juergen Rose





          2011-02-16 16:52:15 UTC
        

I hit the same issue. I did 'lafilefixer --justfixit', it did not find any file for fixing, but 'grep eggdbus /usr/lib/*.la' shows that 
/usr/lib/libgksu2.la
/usr/lib/libgnomecupsui-1.0.la
/usr/lib/libgnomeuimm-2.6.la
/usr/lib/libgweather.la
/usr/lib/librhythmbox-core.la
/usr/lib/libsvn_auth_gnome_keyring-1.la
contain -leggdbus-1. 'qfile -v' shows that they are belong all to installed packages:
root@moose:/root(19)# qfile -v /usr/lib/libgksu2.la /usr/lib/libgnomecupsui-1.0.la /usr/lib64/libgnomeuimm-2.6.la /usr/lib64/libgweather.la /usr/lib64/librhythmbox-core.la /usr/lib64/libsvn_auth_gnome_keyring-1.la 
dev-vcs/subversion-1.6.15 (/usr/lib64/libsvn_auth_gnome_keyring-1.la)
dev-cpp/libgnomeuimm-2.28.0 (/usr/lib64/libgnomeuimm-2.6.la)
media-sound/rhythmbox-0.12.8-r1 (/usr/lib64/librhythmbox-core.la)
x11-libs/libgksu-2.0.12-r1 (/usr/lib64/libgksu2.la)
dev-libs/libgweather-2.30.3 (/usr/lib64/libgweather.la)
net-print/gnome-cups-manager-0.33-r2 (/usr/lib64/libgnomecupsui-1.0.la)


After reemerging subversion libgnomeuimm rhythmbox libgksu libgweather gnome-cups-manager eggdbus disappeared from the la files and I could also reemerge gnome-panel.






Comment 21


Pacho Ramos






          2011-02-16 18:21:02 UTC
        

(In reply to comment #17)
> I think you can blame lafilefixer for changing the md5 of files owned by
> portage packages but not updating vdb :(
> 

Maybe lafilefixer script should use "qfile -o /usr/lib/*.la" for removing orphan .la files




Comment 22


Pacho Ramos






          2011-02-16 18:22:50 UTC
        

(In reply to comment #20)
> contain -leggdbus-1. 'qfile -v' shows that they are belong all to installed
> packages:

In you case, lafilefixer not be working ok :-/ (not sure if there is any other similar report related with this)




Comment 23


Nathan Caldwell





          2011-02-19 03:45:54 UTC
        

(In reply to comment #20)
> I hit the same issue. I did 'lafilefixer --justfixit', it did not find any file
> for fixing, but 'grep eggdbus /usr/lib/*.la' shows that 
> /usr/lib/libgksu2.la
> /usr/lib/libgnomecupsui-1.0.la
> /usr/lib/libgnomeuimm-2.6.la
> /usr/lib/libgweather.la
> /usr/lib/librhythmbox-core.la
> /usr/lib/libsvn_auth_gnome_keyring-1.la
> contain -leggdbus-1. 'qfile -v' shows that they are belong all to installed
> packages:
> root@moose:/root(19)# qfile -v /usr/lib/libgksu2.la
> /usr/lib/libgnomecupsui-1.0.la /usr/lib64/libgnomeuimm-2.6.la
> /usr/lib64/libgweather.la /usr/lib64/librhythmbox-core.la
> /usr/lib64/libsvn_auth_gnome_keyring-1.la 
> dev-vcs/subversion-1.6.15 (/usr/lib64/libsvn_auth_gnome_keyring-1.la)
> dev-cpp/libgnomeuimm-2.28.0 (/usr/lib64/libgnomeuimm-2.6.la)
> media-sound/rhythmbox-0.12.8-r1 (/usr/lib64/librhythmbox-core.la)
> x11-libs/libgksu-2.0.12-r1 (/usr/lib64/libgksu2.la)
> dev-libs/libgweather-2.30.3 (/usr/lib64/libgweather.la)
> net-print/gnome-cups-manager-0.33-r2 (/usr/lib64/libgnomecupsui-1.0.la)
> 
> 
> After reemerging subversion libgnomeuimm rhythmbox libgksu libgweather
> gnome-cups-manager eggdbus disappeared from the la files and I could also
> reemerge gnome-panel.
> 

Same thing here, different packages. Here's what happened to me.

I ran --depclean one day, and noticed it wanted to remove eggdbus, I let it. I then ran into the problem with gnome-panel attempting to link to leggdbus. I then ran 'lafilefixer --justfixit', it didn't detect any broken packages. I searched, found this bug and ran a grep for eggdbus in all the la files in /usr/lib/. This returned a few results, all of them belonging to existing packages. I reemerged the packages these belonged to, then emerged gnome-panel.




Comment 24


Andrey Vihrov





          2011-02-24 13:25:08 UTC
        

I hit the same issue. Just like in comment #16, "grep eggdbus /usr/lib/*.la"
shows /usr/lib/libgksu2.la, /usr/lib/libgweather.la and /usr/lib/libsvn_auth_gnome_keyring-1.la, which do not belong to any package. lafilefixer did a good job, now I have to search the filesystem for all orphan files...




Comment 25


Matthew Turnbull





          2011-02-27 05:47:02 UTC
        

$ killall gnome-panel
$ tail .gnomerc-errors | grep -i clock
** (gnome-panel:19661): WARNING **: Failed to load applet ClockAppletFactory::ClockApplet: libeggdbus-1.so.0: cannot open shared object file: No such file or directory
$ grep eggdbus /usr/lib/*.la
/usr/lib/libgweather.la:dependency_libs=' -L/usr/lib64 -L/usr/lib64/qt4 -L/usr/lib -lgtk-x11-2.0 -lgdk-x11-2.0 -latk-1.0 -lpangocairo-1.0 -lcairo -lpangoft2-1.0 -lpango-1.0 -lgdk_pixbuf-2.0 -lpixman-1 -lfontconfig -lpng14 -lxcb-shm -lxcb-render -lXrender -lX11 -lEGL -lQtGui -lQtCore -lxcb -lXau -lXdmcp -lGL -lfreetype -lexpat -lsoup-gnome-2.4 -lgconf-2 -lsqlite3 -lgnome-keyring -lsoup-2.4 -lproxy -leggdbus-1 -lgio-2.0 -lxml2 -lgnutls -lm -ltasn1 -lgcrypt -lgpg-error -lresolv -lz -lORBit-2 -lgmodule-2.0 -lgobject-2.0 -ldl -ldbus-glib-1 -lgthread-2.0 -ldbus-1 -lglib-2.0 -lpthread -lrt'
$ ldd /usr/lib64/gnome-panel/libclock-applet.so | grep eggdbus
	libeggdbus-1.so.0 => not found
$

Given that libclock-applet.so is directly linking against eggdbus, lafilefixer wouldn't do a whole lot of good. And running lafilefixer on libgweather.la always came back clean (though I didn't think to run it after removing eggdbus).

Re-emerging libgweather and gnome-panel fixed the problem.

$ grep eggdbus /usr/lib/*.la
$ ldd /usr/lib64/gnome-panel/libclock-applet.so | grep egg
$





Comment 26


Jonathan Callen (RETIRED)






          2011-03-04 05:54:03 UTC
        

(In reply to comment #22)
> (In reply to comment #20)
> > contain -leggdbus-1. 'qfile -v' shows that they are belong all to installed
> > packages:
> 
> In you case, lafilefixer not be working ok :-/ (not sure if there is any other
> similar report related with this)
> 

lafilefixer did exactly what it was designed to do: it was *not* designed to fix this type of issue (where a library is removed completely), but rather the issue resulting from when the .la file is removed without removing the associated .so file.




Comment 27


Pacho Ramos






          2011-03-29 08:02:00 UTC
        

*** Bug 361047 has been marked as a duplicate of this bug. ***




Comment 28


Gilles Dartiguelongue (RETIRED)






          2011-03-29 08:29:28 UTC
        

I think the conclusion of this issue is that eggdbus, like glitz and maybe directfb have a pernicious tendency to pollute rdepends and la files when it is not actually used. It might be interesting to study them in order to find out why they do this to avoid such problems in the future.




Comment 29


Marco Clocchiatti





          2011-06-24 21:32:46 UTC
        

I also had problems with gnome-base/gnome-panel-2.32.*.

I my case I discovered this:

s939 ~ # grep eggdbus /usr/lib/*.la
/usr/lib/libgdata.la:dependency_libs=' -L/usr/lib64 -lsoup-gnome-2.4 -lgconf-2
-lsqlite3 -lgnome-keyring -leggdbus-1 -lsoup-2.4 -lORBit-2 -lproxy -ldbus-1
-ldbus-glib-1 -lgio-2.0 -lxml2 -lgnutls -licui18n -licuuc -licudata -lm
-ltasn1 -lgcrypt -lgpg-error -lgobject-2.0 -lgmodule-2.0 -lresolv -lz
-lgthread-2.0 -ldl -lglib-2.0 -lpthread -lrt'
s939 ~ # qfile /usr/lib/libgdata.la
dev-libs/libgdata (/usr/lib64/libgdata.la)

unemerging temporarily dev-libs/libgdata fixed my problem.




Comment 30


Samuli Suominen (RETIRED)






          2012-01-06 12:55:01 UTC
        

eggdbus is no longer in and any references to eggdbus in installed systems, is a local problem

closing









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

