Title: 156468 – media-sound/banshee-0.11.2 crashes and/or locks-up desktop
URL: https://bugs.gentoo.org/show_bug.cgi?id=156468

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 156468
media-sound/banshee-0.11.2 crashes and/or locks-up desktop
Last modified: 2006-12-02 07:26:08 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 156468 
      - media-sound/banshee-0.11.2 crashes and/or locks-up desktop


Summary:
media-sound/banshee-0.11.2 crashes and/or locks-up desktop
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Luis Medinas (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-11-27 19:08 UTC by Tango





      Modified:
    
2006-12-02 07:26 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



dotnet









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Tango





          2006-11-27 19:08:51 UTC
        

Installed Banshee with out errors and it runs.  Appears that all functions work however after a period of time depending on what else may be running, Banshee eventually eats the available cpu's and freezes or lockups up the desktop.  Top reports 200% cpu useage.  Starts off at about 3% than continues to build till the crash.

=banshee-0.11.2
=mono-1.2.1
Have tried various versions of mono. With mono-1.2, I was able to play an entire album before crashing. (nothing else running).  The other version vary to 1/2 a track, version 1.2.1 to 3 tracks, version 1.1.18-r1.

#/etc/portage/package.kewords
#needed by banshee
>=media-sound/banshee-0.10.12 ~amd64
>=media-plugins/banshee-official-plugins-0.11.2 ~amd64
>=media-plugins/gst-plugins-faad-0.10.0 ~amd64
>=media-plugins/gst-plugins-lame-0.10.0 ~amd64
>=dev-lang/mono-1.1.18-r1 ~amd64
#required by mono
>=dev-dotnet/libgdiplus-1.2 ~amd64

#emerge --info
Portage 2.1.1-r2 (default-linux/amd64/2006.1/desktop, gcc-4.1.1, glibc-2.4-r4, 2.6.17-gentoo-r8 x86_64)
=================================================================
System uname: 2.6.17-gentoo-r8 x86_64 AMD Opteron(tm) Processor 246
Gentoo Base System version 1.12.6
Last Sync: Mon, 27 Nov 2006 06:30:01 +0000
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O3 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/mozilla/defaults/pref /usr/share/X11/xkb"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=k8 -O3 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://gentoo.mirrors.tds.net/gentoo http://distfiles.gentoo.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
LC_ALL="en_US.UTF-8"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://thetangos/gentoo-portage"
USE="amd64 X aac aalib aim alsa artworkextra avahi avi berkdb bitmap-fonts bzip2 cairo cdinstall cdparanoia cdr cli cracklib crypt cups dbus directfb divx divx4linux dlloader dri dvd dvdr eds elibc_glibc emboss encode esd exif fam fbcon ffmpeg firefox flac fortran gb gdbm gif gmedia gnome gpm gstreamer gtk gtk+-1.2* gtk2 gtkhtml guile hal hbci howl iconv imagemagick imlib input_devices_keyboard input_devices_mouse ipv6 isdnlog java jpeg jpeg2k kernel_linux ldap libg++ libwww live mad mikmod mono motif mozcalendar mozilla mp3 mpeg ncurses network nls nptl nptlonly nsplugin ntp nvidia ofx ogg openal opengl openxr oss pam pcre pdf perl png postgres ppds pppd python qt qt3 qt4 quicktime readline reflection sdl session sndfile spell spl ssl tcpd tetex tiff timidity tng truetype truetype-fonts type1-fonts udev unicode usb userland_GNU userlocales vcd video_cards_fbdev video_cards_nvidia video_cards_vesa vorbis wma wmf wmp xinerama xml xorg xprint xv zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Luis Medinas (RETIRED)






          2006-11-28 04:58:42 UTC
        

i can't reproduce this problem but it seems to me that is a problem related with mono, not banshee. I'm able to play continuos with banshee for more than 8h almost everyday with a big uptime. Did you tried compiling mono with -O2 instead of -O3 ?
Adding dotnet team maybe they know something about this problem.




Comment 2


Tango





          2006-11-28 08:51:01 UTC
        

I agree that this is most likely a mono issue, but Banshee is the only app I have that requires mono.

Per your sugestion I compiled mono-1.2.1 with -O2 optimizations and it did affect how long I could play some tracks, with this version (3 tracks).  Started Banshee but in the middle of the 3trd track cpu usage suddenly went to 100% and the Banshee window frooze.  The track continued to play to the end.  So I compiled mono with -O1 and started Banshee but within seconds Banshee segfaulted.

#dmesg|tail
banshee[14930]: segfault at 0000000000000018 rip 00002b35d76ba838 rsp 00007fffd3ca2380 error 4

No suprise here, really.

I will also try mono-1.18-r1 with -O2 and see how that does.

If necessary I can rebuild the entire system with -O2, however this will take a couple of days to complete and I haven't had any troubles with this in the past.




Comment 3


Tango





          2006-11-28 19:16:00 UTC
        

(In reply to comment #2)
> I agree that this is most likely a mono issue, but Banshee is the only app I
> have that requires mono.
> 
> Per your sugestion I compiled mono-1.2.1 with -O2 optimizations and it did
> affect how long I could play some tracks, with this version (3 tracks). 
> Started Banshee but in the middle of the 3trd track cpu usage suddenly went to
> 100% and the Banshee window frooze.  The track continued to play to the end. 
> So I compiled mono with -O1 and started Banshee but within seconds Banshee
> segfaulted.
> 
> #dmesg|tail
> banshee[14930]: segfault at 0000000000000018 rip 00002b35d76ba838 rsp
> 00007fffd3ca2380 error 4
> 
> No suprise here, really.
> 
> I will also try mono-1.18-r1 with -O2 and see how that does.
> 
> If necessary I can rebuild the entire system with -O2, however this will take a
> couple of days to complete and I haven't had any troubles with this in the
> past.
> 

Spent to whole afternoon trying various options and version compiles, which netted zip.  I could get Banshee to fail in a different manner or time frame, I even managed to produce several segfaults.

banshee[14930]: segfault at 0000000000000018 rip 00002b35d76ba838 rsp 00007fffd3ca2380 error 4	#2nd try
banshee[31790]: segfault at 0000000000000004 rip 00002ba9ef402d10 rsp 00007fffbbb025e0 error 4	#4th try
mono[9446]: segfault at 0000000200000020 rip 00002b9ff1575100 rsp 0000000040223dd0 error 4	#5th try
banshee[18640]: segfault at 0000000000000001 rip 00002b6ac8627d10 rsp 00007fffe28dce70 error 4	#last try

In a last ditch effort I set flags back to my normal -O3 and did my best to rebuild every package for mono and Banshee in the correct order, using mono-1.2.1

#emerge -v gst-plugins-faad libgdiplus mono gtk-sharp glade-sharp art-sharp gnomevfs-sharp gnome-sharp gconf-sharp gst-plugins-lame banshee

I watched every build as closely as possible and even with -O3 set, mono would only build using -O2. libgdiplus will build using -O3.  So now I am back to square one with Banshee eating the cpu's till it just stops responding, around 3 to 4 tracks.  Only now the cpu usage according to top is 99 to 115%

Still scratchin my head.............:)




Comment 4


Luis Medinas (RETIRED)






          2006-11-28 21:00:48 UTC
        

this is very strange what happens if you try with another mono apps like muine, tomboy and beagle(this is very heavy for cpu) ? Another thing what dbus version are you using ? You can only notice with mono ? no other apps give you the same trouble ? this could be a problem related with kernel too.

dotnet team any ideas ? 




Comment 5


Tango





          2006-11-29 13:16:07 UTC
        

(In reply to comment #4)
> this is very strange what happens if you try with another mono apps like muine,
> tomboy and beagle(this is very heavy for cpu) ? Another thing what dbus version
> are you using ? You can only notice with mono ? no other apps give you the same
> trouble ? this could be a problem related with kernel too.
> 
> dotnet team any ideas ? 
> 

I installed muine.  Runs great no crashes.  While importing my music from the Banshee /music folder, the cpu usage went to 160%, but didn't stop or crash.  However during playback top never exceeded 18% cpu usage for mono.  I haven't checked yet for extended playing (for several hours), but it did play an entire album without any problems.  It also appears to work with any version of mono.

I even went as far as reverting all the way back to Banshee-0.10.12,  The results were the same.  Munie continued to work fine with the old mono-1.1.13.8.1.

It seems I can use Banshee to rip CD's.  This function works well.  While it does load the system heavely (up to 115% cpu usage) it dosen't crash.  It seems to crash only durning playback or when importing a huge music directory.

As far as other troubles like this, Acroread use to have this problem a little while back when opened from Mozilla.  It would continue to run even after it was closed making the system real sulggish and I would have to exit gnome to completely kill it.  An update solved this problem and it hasn't again.

As far as I can remember I have never had this problem anywhere else.

I have had lots of problems using newer kernels (>=2.6.16) with my hardware.  Many were giving me the many lost ticks and time source is unstable errors.  Also causing my system to reboot or just shut down.

The main kernel I use now is  2.6.15-r7 works well.  I have got (my testing kernel, running now)2.6.17-r8 to be stable and not crash the system or spit out errors at me.

Installed =sys-apps/dbus-0.62-r1  USE="X gtk mono python qt3 qt4 -debug -doc (-selinux)"

#/etc/portage/package.keywords
>=games-fps/vavoom-1.21.2 ~amd64
>=net-www/nspluginwrapper-0.9.90.3 ~amd64
media-fonts/font-bitstream-type1 ~amd64
#move all quake3 files to /usr/local/portage
#these files are a must have
>=games-fps/quake3-osp-1.03a ~amd64
#needed by banshee
>=media-sound/banshee-0.10.12 ~amd64
>=media-plugins/banshee-official-plugins-0.11.2 ~amd64
>=media-plugins/gst-plugins-faad-0.10.0 ~amd64
>=media-plugins/gst-plugins-lame-0.10.0 ~amd64
>=dev-lang/mono-1.1.13 ~amd64
#required by mono
>=dev-dotnet/libgdiplus-1.1.13 ~amd64
#exaile-unsupported app-setup in overlay
#nice app a little quirky but completely usable
>=media-sound/exaile-0.2.5 ~amd64
>=media-plugins/gst-plugins-faac-0.10 ~amd64
>=dev-python/gst-python-0.10 ~amd64
>=media-plugins/gst-plugins-musepack-0.10 ~amd64

#/etc/portage/package.use
sys-libs/glibc userlocales
>=media-sound/exaile-0.2.5 musepack trayicon

Hardware
Tyan Tiger S2875 K8W motherboard
4 gigs pc3200 dual-channel@128 bit ram <--I have considered that this could be problematic but lack the knowledge to know for sure.  Been using this setting from system day one.
AMD Opteron 246 2.0 gig processor X 2
Hitachi 160 gig SATA HD
MSI Nvidia6800-GTS/256 video card
Audigy2 ZS soundcard

I only have 2 apps now that use mono, Banshee and Muine.  Of these 2 only Banshee is causing a problem.  I may have others that can use mono, (Not Sure) but if so I don't use them or the mono function of them.  Mono didn't get added to my USE FLAGS till I installed Banshee.  I may pull it out of USE and use package.use to control the builds better.




Comment 6


Luis Medinas (RETIRED)






          2006-11-29 13:27:01 UTC
        

you continue to impress me... did you considered the option of your RAM damaged ? Did you have somekind of overclock ? Isn't good to know that newer kernels don't work well with your machine maybe you forgot to enable some feature on your kernel like support for big RAM. This is very strange and i'm consireding the option that the problem isn't on mono but on your machine or kernel. Try run memtest and see if your RAM is good. I'm sorry but this isn't really a banshee or mono bug imo. Reopen if you have something close to a bug on these two. 

Good luck




Comment 7


Tango





          2006-12-02 07:26:08 UTC
        

(In reply to comment #6)
> you continue to impress me... did you considered the option of your RAM damaged
> ? Did you have somekind of overclock ? Isn't good to know that newer kernels
> don't work well with your machine maybe you forgot to enable some feature on
> your kernel like support for big RAM. This is very strange and i'm consireding
> the option that the problem isn't on mono but on your machine or kernel. Try
> run memtest and see if your RAM is good. I'm sorry but this isn't really a
> banshee or mono bug imo. Reopen if you have something close to a bug on these
> two. 
> 
> Good luck
> 


I managed a couple of traces which can be viewed here.

http://www.thetangos.com/tango/backups/banshee_trace

and here

http://www.thetangos.com/tango/backups/banshee_trace2

Thanks









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

