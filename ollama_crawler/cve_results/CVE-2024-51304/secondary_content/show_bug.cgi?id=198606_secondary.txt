Title: 198606 – net-nds/openldap-2.3.39-r1 slapd service startup fails, because syncprov.so module is missing
URL: https://bugs.gentoo.org/show_bug.cgi?id=198606

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 198606
net-nds/openldap-2.3.39-r1 slapd service startup fails, because syncprov.so module is missing
Last modified: 2007-11-10 16:41:24 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 198606 
      - net-nds/openldap-2.3.39-r1 slapd service startup fails, because syncprov.so module is missing


Summary:
net-nds/openldap-2.3.39-r1 slapd service startup fails, because syncprov.so m...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo LDAP project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-11-09 23:40 UTC by Daniel





      Modified:
    
2007-11-10 16:41 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Daniel





          2007-11-09 23:40:15 UTC
        

Hi,
2.3.39-r1 does not compile/install (haven't investigated in deep) slapd's overlay syncprov. This module/overlay is stable and is used for repliction / synchronization. Without this module (if syncrepl is configured) slapd fails to start!

Downgrading to 2.3.39 (without -r1) resolved this issue for me. Both libs are available again:

-rwxr-xr-x 1 root root  38700 Nov 10 00:08 syncprov-2.3.so.0.2.27
-rwxr-xr-x 1 root root    925 Nov 10 00:08 syncprov.la

I've diffed 2.3.39 and 2.3.39-r1 ebuilds and I've seen that "--enable-syncprov" has been introduced in -r1, perhaps it should be changed to "--enable-syncprov=mod" instead? (just a guess, haven't tested it myself)

Reproducible: Always

Steps to Reproduce:
1. emerge 2.3.39-r1 --> syncprov.so is missing
2. emerge 2.3.39 --> syncprov.so exists.

Actual Results:  
syncprov.so is missing

Expected Results:  
syncprov.so should be existent

System uname: 2.6.22-gentoo-r5 i686 Intel(R) Pentium(R) M processor 1.80GHz
Timestamp of tree: Fri, 09 Nov 2007 02:16:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p17
dev-java/java-config: 1.3.7, 2.0.33-r1
dev-lang/python:     2.3.5-r3, 2.4.4-r6
dev-python/pycrypto: 2.0.1-r6
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.9-r2
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r2
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=pentium4 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"




Comment 1


Markus Ullmann (RETIRED)






          2007-11-10 13:42:06 UTC
        

We added that on purpose as with new-style config system (using slapd.d which is a database) you can't load any module until you start up. So if you want to sync your config bits, you can't do it if the syncprov isn't compiled in.

This will become the recommended default for 2.4 onwards and to ease the migration, we enabled that now, as some people already use it and noticed this small "issue".




Comment 2


Daniel





          2007-11-10 16:41:24 UTC
        

(In reply to comment #1)
> We added that on purpose as with new-style config system (using slapd.d which
> is a database) you can't load any module until you start up. So if you want to
> sync your config bits, you can't do it if the syncprov isn't compiled in.

Ahhh I see. :-)
So I rebuild 2.3.39-r1, removed "moduleload syncprov.so" from slapd's configuration and slapd started as usually. Many thanks for your explainations!

Nevertheless I would suggest to add a message like this to the next openldap-stable-ebuild:

"In contrast to previous openldap ebuild's from now on the syncprov overlay is compiled statically into slapd. In case you have been using the modular syncprov overlay in the past, please remove/comment-out the statement "moduleload syncprov.so" from your slapd's configuration (slapd.conf and/or slapd.d), otherwise slapd service will fail to start up properly. Your syncrepl-configuration statements should not effected at all."

> This will become the recommended default for 2.4 onwards and to ease the
> migration, we enabled that now, as some people already use it and noticed this
> small "issue".

Yes, 2.4 rocks! E.g. N-way-Multimaster replication... :-)










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

