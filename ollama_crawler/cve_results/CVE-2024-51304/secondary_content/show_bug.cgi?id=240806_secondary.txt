Title: 240806 – media-libs/dumb: C(XX)FLAGS are ignored (at src_configure/compile)
URL: https://bugs.gentoo.org/show_bug.cgi?id=240806

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 240806
media-libs/dumb: C(XX)FLAGS are ignored (at src_configure/compile)
Last modified: 2008-10-10 18:27:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 240806 
      - media-libs/dumb: C(XX)FLAGS are ignored (at src_configure/compile)


Summary:
media-libs/dumb: C(XX)FLAGS are ignored (at src_configure/compile)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Christian Birchinger (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-10-09 21:26 UTC by Diego Elio Pettenò (RETIRED)





      Modified:
    
2008-10-10 18:27 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Diego Elio Pettenò (RETIRED)






          2008-10-09 21:26:31 UTC
        

I don't know the build system for this program (and this is a generic bug template so I cannot tell you which program exactly is), but my tests shows that it's not respecting CFLAGS (or CXXFLAGS) properly.

Please look into it, since it's important to respect user CFLAGS and CXXFLAGS.

Warning: this bug might look like a false positive because you actually have your CFLAGS being used; this happens if the CFLAGS are "set in stone" in the build system during src_unpack/src_prepare. While QA has not as of this moment expressed to me a preference, I'd sincerely suggest to avoid the set-in-stone approach, so that ebuild commands could work to reproduce the actual results.

To avoid the set in stone approach:

- consider just changing CFLAGS= to CFLAGS+= if the build system enables warnings;
- if the buildsystem does not use CFLAGS variable at all, in the sed use '$(CFLAGS)', single quoted, so that the CFLAGS variable is picked up;
- use '$(OPTCFLAGS)' in the sed and then use make OPTCFLAGS=$CFLAGS.

Thanks,
Diego




Comment 1


Christian Birchinger (RETIRED)






          2008-10-10 18:11:52 UTC
        

Sorry, but i really have no clue what this all means and what you expect me to
do. I'm not using any sed to set the CFLAGS. All i do is a sed to remove the hardcoded striping of binaries. The makefile uses the variable OFLAGS for user
prefered compiler flags and that's what this build command does:

emake OFLAGS="${CFLAGS}" all || die "emake failed"

I don't see how thats a hardcoded sed.

You'd need to show me a solution if you want the built system to be changed
because i don't see what i should do.




Comment 2


Christian Birchinger (RETIRED)






          2008-10-10 18:21:53 UTC
        

Own flags are only being used for a special debug lib version which only gets
installed when using USE=debug. It gets built in any case (custom hardcoded makefile) but it's not being installed. Only the normal lib which uses the CFLAGS
the user specified gets installed.




Comment 3


Christian Birchinger (RETIRED)






          2008-10-10 18:27:47 UTC
        

The user get only binaries installed which use their CFLAGS.

Even though the debug library with hardcoded CFLAGS gets built, it does not get
installed on the users machine unless USE=debug is being used.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

