Title: 91776 – getdelta ignores localmirror-option
URL: https://bugs.gentoo.org/show_bug.cgi?id=91776

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 91776
getdelta ignores localmirror-option
Last modified: 2005-05-08 01:59:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 91776 
      - getdelta ignores localmirror-option


Summary:
getdelta ignores localmirror-option
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Stefan Schweizer (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-05-07 02:23 UTC by Frank Schmitt





      Modified:
    
2005-05-08 01:59 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



hansmi
nlissne









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




make.conf

              (make.conf,835 bytes,
                text/plain)

            
2005-05-07 12:34 UTC,

            Frank Schmitt




Details





getdelta.rc

              (getdelta.rc,2.12 KB,
                text/plain)

            
2005-05-07 12:34 UTC,

            Frank Schmitt




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Frank Schmitt





          2005-05-07 02:23:59 UTC
        

getdelta dosn't looks on localmirror first.  

from /etc/deltup/getdelta.rc

# set this to an URI ending with '/' if you want to check a local mirror first
# most people just leave it empty.
LOCAL_MIRROR="http://taipan.lan:8888/distfiles/"

Reproducible: Always
Steps to Reproduce:
1.emerge $something
Actual Results:  
moloch root # emerge gdb
Calculating dependencies ...done!
>>> emerge (1 of 1) sys-devel/gdb-6.3-r3 to /
>>> Downloading
http://mirror.switch.ch/ftp/mirror/gentoo/distfiles/gdb_6.3-5.diff.gz
/usr/bin/getdelta.sh: line 22: ${CFLAGS)"

SYNC="rsync://taipan.lan/gentoo-portage"
GENTOO_MIRRORS='http://mirror.switch.ch/ftp/mirror/gentoo/ http://gentoo.inode.at/'
MAKEOPTS="-j1 -l1"
FEATURES="fixpackages confcache"
PORT_LOGDIR="/var/log/ebuild"
PORTAGE_NICENESS=10

USE="-arts -bitmap-fonts berkdb -cups -f77 -fbcon -foomaticdb -gtk -gtk2 ipv6  
 -imlib -jpeg -kde gdbm -gnome -libwww -mikmod -motif -mad -mpeg -opengl png -qt
readline tcpd -truetype -X -xprint -xv -zlib -ruby -fortran -gif"

PORTDIR_OVERLAY="/usr/local/portage"
RSYNC_EXCLUDEFROM=/etc/portage/rsync_excludes
FETCHCOMMAND="/usr/bin/getdelta.sh \${URI}: bad substitution
Searching for a previously downloaded file in /usr/portage/distfiles

No old version of the requested file found.

The dtu could not be fetched, downloading full file from original URL

--11:08:46--  http://mirror.switch.ch/ftp/mirror/gentoo/distfiles/gdb_6.3-5.diff.gz
           => `gdb_6.3-5.diff.gz'
Resolving mirror.switch.ch... 130.59.10.35
Connecting to mirror.switch.ch[130.59.10.35]:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 149,881 [application/x-gzip]

100%[====================================>] 149,881      154.01K/s

11:08:47 (153.33 KB/s) - `gdb_6.3-5.diff.gz' saved [149881/149881]

Expected Results:  
It searches for a previously downloaded file, and connects the deltup-server or
load it from a gentoo-mirror if there's none.

Portage 2.0.51.19 (default-linux/sparc/sparc32/2005.0, gcc-3.3.5-20050130,
glibc-2.3.3.20040420-r2, 2.4.28-sparc-r6 sparc)
=================================================================
System uname: 2.4.28-sparc-r6 sparc sun4m
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Apr 30 2005, 15:58:48)]
distcc 2.16 sparc-unknown-linux-gnu (protocols 1 and 2) (default port 3632)
[disabled]
ccache version 2.3 [enabled]
dev-lang/python:     2.3.5
sys-apps/sandbox:    [Not Present]
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.8.5-r3, 1.5, 1.9.5, 1.7.9-r1, 1.6.3, 1.4_p6
sys-devel/binutils:  2.15.92.0.2-r7
sys-devel/libtool:   1.5.16
virtual/os-headers:  2.4.23
ACCEPT_KEYWORDS="sparc"
AUTOCLEAN="yes"
CFLAGS="-O2 -mcpu=v8 -pipe"
CHOST="sparc-unknown-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config
/usr/share/config /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS=""
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache confcache distlocks fixpackages sandbox
strict"
GENTOO_MIRRORS="http://mirror.switch.ch/ftp/mirror/gentoo/
http://gentoo.inode.at/"MAKEOPTS="-j1 -l1"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://taipan.lan/gentoo-portage"
USE="sparc berkdb crypt dlloader gd gdbm ipv6 ldap ncurses nls pam perl png
python readline slang spell ssl tcpd truetype-fonts type1-fonts xml2
userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS




Comment 1


Stefan Schweizer (RETIRED)






          2005-05-07 11:28:08 UTC
        

Can you please attach your full /etc/make.conf and /etc/deltup/getdelta.rc?


/usr/bin/getdelta.sh: line 22: ${CFLAGS)"

looks like there is a syntax error in the file.




Comment 2


Frank Schmitt





          2005-05-07 12:34:08 UTC
        

Created attachment 58293 [details]
make.conf




Comment 3


Frank Schmitt





          2005-05-07 12:34:41 UTC
        

Created attachment 58294 [details]
getdelta.rc




Comment 4


Steev Klimaszewski (RETIRED)






          2005-05-08 01:16:30 UTC
        

Line 5 of your make.conf

CXXFLAGS="${CFLAGS)"


I do believe that should be CXXFLAGS="${CFLAGS}"




Comment 5


Stefan Schweizer (RETIRED)






          2005-05-08 01:49:08 UTC
        

PLease fix your typo and reopen if it still does not work.




Comment 6


Frank Schmitt





          2005-05-08 01:59:16 UTC
        

oh no.... it's not a bug, it's a feature :-/
At 20. March, i have talked with genstef to mark getdelta ~sparc. He wants that i test the new getdelta-0.6.9.ebuild. For a real test, i must delete the localmirror-option in getdelta.rc, because deltup only loads the complete packages for the localmirror. Then getdelta makes an new emtpy localmirror-variable at the end of the file. This overrides the varible at the beginning of the file :-/ 
Sorry for that trouble, and my bad english. 

PS: This has nothing to do with the messages
/usr/bin/getdelta.sh: line 22: ${CFLAGS)" 









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

