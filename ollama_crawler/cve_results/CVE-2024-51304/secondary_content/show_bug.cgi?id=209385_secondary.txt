Title: 209385 – dev-libs/klibc-1.5.8 doesn't use the correct kernel sources
URL: https://bugs.gentoo.org/show_bug.cgi?id=209385

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 209385
dev-libs/klibc-1.5.8 doesn't use the correct kernel sources
Last modified: 2008-02-10 11:07:10 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 209385 
      - dev-libs/klibc-1.5.8 doesn't use the correct kernel sources


Summary:
dev-libs/klibc-1.5.8 doesn't use the correct kernel sources
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Kernel Miscellaneous








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-02-08 19:56 UTC by François Valenduc





      Modified:
    
2008-02-10 11:07 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge.log file

              (emerge.log,293.72 KB,
                text/plain)

            
2008-02-09 08:21 UTC,

            François Valenduc




Details





emerge.log file for klibc-1.5

              (emerge1.log,220.28 KB,
                text/plain)

            
2008-02-09 08:26 UTC,

            François Valenduc




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


François Valenduc





          2008-02-08 19:56:35 UTC
        

When klibc-1.5.8, it seems it doesn't use the kernel sources corresponding to the /usr/src/linux symlink. As a result, when I build splashutils, fbcondecor support is not build.

Reproducible: Always

Steps to Reproduce:
1.emerge klibc-1.5.8
2.emerge splashutils
3.
Actual Results:  
notice that fbcondecor support is not build even if the sources in /usr/src/linux are patched with fbcondecor


Expected Results:  
fbcondecor being build with splashutils




Comment 1


François Valenduc





          2008-02-08 19:57:16 UTC
        

Portage 2.1.3.19 (default-linux/amd64/2007.0/desktop, gcc-4.1.2, glibc-2.6.1-r0, 2.6.24 x86_64)
=================================================================
System uname: 2.6.24 x86_64 Intel(R) Core(TM)2 Duo CPU T7500 @ 2.20GHz
Timestamp of tree: Fri, 08 Feb 2008 05:16:01 +0000
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
app-shells/bash:     3.2_p17-r1
dev-java/java-config: 1.3.7, 2.0.33-r1
dev-lang/python:     2.4.4-r6
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.10-r5
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=nocona"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O2 -pipe -march=nocona"
DISTDIR="/usr/portage/distfiles"
FEATURES="distcc distlocks metadata-transfer parallel-fetch sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo/"
LANG="fr_BE.UTF-8"
LC_ALL="fr_BE.UTF-8"
LINGUAS="fr"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/xeffects /usr/portage/local/layman/ecatmur /usr/portage/local/layman/zugaina /usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="X acl acpi aiglx alsa amd64 arts berkdb bitmap-fonts cairo cdr cli cracklib crypt cups dbus dri dvd dvdr dvdread eds emboss encode esd evo fam firefox fortran gdbm gif gnome gpm gstreamer gtk hal iconv ipv6 isdnlog jpeg kde kerberos ldap mad midi mikmod mmx mp3 mpeg mudflap ncurses nls nptl nptlonly nsplugin ogg opengl openmp oss pam pcre pdf perl png pppd python qt3 qt3support qt4 quicktime readline reflection sdl session spell spl sse sse2 ssl svg tcpd tetex tiff truetype truetype-fonts type1-fonts unicode vorbis xml xorg xosd xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="mouse evdev keyboard synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="fr" USERLAND="GNU" VIDEO_CARDS="nvidia"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 2


Jakub Moc (RETIRED)






          2008-02-08 20:06:53 UTC
        

Reopen with full emerge.log




Comment 3


François Valenduc





          2008-02-09 08:21:36 UTC
        

Created attachment 143024 [details]
emerge.log file




Comment 4


François Valenduc





          2008-02-09 08:26:24 UTC
        

Created attachment 143025 [details]
emerge.log file for klibc-1.5

When I emerge klibc-1.5, it use the right kernel source, corresponding to /usr/src/linux which points to the kernel 2.6.23.14 sources. These are patched with fbcondecor, hence splashutils can be build with fbcondecor support.




Comment 5


François Valenduc





          2008-02-09 08:27:06 UTC
        

I hope I have provided enough informations now.




Comment 6


Robin Johnson









          2008-02-09 19:07:01 UTC
        

please review bug 198937 and bug 190113.
It is not MEANT to use /usr/src/linux, because that is not suitable in many cases - where /usr/src/linux does not contain uvesafb or the userspace #bits != kernel #bits (eg sparc, ppc64-32ul, some mips).

If there is some newer vanilla kernel that contains fbcondecor, I'll bump the sources used by klibc, but having a klibc that actually works on all machines is more important than graphics niceties.




Comment 7


François Valenduc





          2008-02-09 19:37:39 UTC
        

There is something I don't understand. Splashutils needs klibc to be build but the newer klibc releases doesn't permit to use it. For me this is a regression, even if you call "splashutils"  graphics niceties.




Comment 8


Robin Johnson









          2008-02-09 20:13:07 UTC
        

splashutils-1.5.3.4 builds fine for me.(In reply to comment #7)
> There is something I don't understand. Splashutils needs klibc to be build but
> the newer klibc releases doesn't permit to use it. For me this is a regression,
> even if you call "splashutils"  graphics niceties.
If splashutils really doesn't compile at all, open a new bug. It does build here on: x86, ppc64-32ul, amd64.




Comment 9


François Valenduc





          2008-02-09 20:41:13 UTC
        

Splashutils can be build, but as I have already said, fbcondecor support can't be build with the latest version of klibc, so it's quite unuseful.




Comment 10


Robin Johnson









          2008-02-10 00:50:10 UTC
        

# USE=fbcondecor emerge splashutils
compiles fine. if it doesn't actually work, answer the original question I posed:
"If there is some newer vanilla kernel that contains fbcondecor, I'll bump the
sources used by klibc"

Is there such a VANILLA kernel? The klibc stuff needs a bump to 2.6.24 sources soon anyway.




Comment 11


François Valenduc





          2008-02-10 08:13:48 UTC
        

Indeed, updating splashutils and adding fbcondecor as use flag solves the problem. 
Thanks for your help.




Comment 12


Daniel Drake (RETIRED)






          2008-02-10 11:07:10 UTC
        

There is no such vanilla kernel. I believe it is Michal's long term goal to get it upstream, but as he doesn't seem to get much time to work on these things I am guessing it will be a while yet.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

