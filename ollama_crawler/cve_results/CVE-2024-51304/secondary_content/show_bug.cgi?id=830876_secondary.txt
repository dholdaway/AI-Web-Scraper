Title: 830876 – sys-apps/portage: re-emerging virtual/jdk-1.8.0-r6 first pulls in catches openjdk-bin then openjdk
URL: https://bugs.gentoo.org/show_bug.cgi?id=830876

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 830876
sys-apps/portage: re-emerging virtual/jdk-1.8.0-r6 first pulls in catches openjdk-bin then openjdk
Last modified: 2022-01-09 22:21:48 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 830876 
      - sys-apps/portage: re-emerging virtual/jdk-1.8.0-r6 first pulls in catches openjdk-bin then openjdk


Summary:
sys-apps/portage: re-emerging virtual/jdk-1.8.0-r6 first pulls in catches ope...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core - Dependencies

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2022-01-09 21:25 UTC by Ulenrich





      Modified:
    
2022-01-09 22:21 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



ajak
sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ulenrich





          2022-01-09 21:25:57 UTC
        

virtual/jdk-1.8-r6 catches the bin and source of openjdk
(I got attention with zeppelin-bin)
So I tried:
--- first step
# emerge dev-java/openjdk-bin

These are the packages that would be merged, in order:

Calculating dependencies  ... done!
[ebuild  N     ] dev-java/java-config-2.3.1:2::gentoo  USE="-test" PYTHON_TARGETS="-python3_8 -python3_9 python3_10" 26 KiB
[ebuild  N     ] app-eselect/eselect-java-0.4.3::gentoo  14 KiB
[ebuild  N     ] dev-java/openjdk-bin-8.312_p07:8::gentoo  USE="alsa cups examples headless-awt (-selinux) -source" 100.602 KiB

Total: 3 packages (3 new), Size of downloads: 100.641 KiB

Would you like to merge these packages? [Yes/No] y
>>> Verifying ebuild manifests
>>> Emerging (1 of 3) dev-java/java-config-2.3.1::gentoo
>>> Installing (1 of 3) dev-java/java-config-2.3.1::gentoo
>>> Emerging (2 of 3) app-eselect/eselect-java-0.4.3::gentoo
>>> Installing (2 of 3) app-eselect/eselect-java-0.4.3::gentoo
>>> Emerging (3 of 3) dev-java/openjdk-bin-8.312_p07::gentoo
>>> Installing (3 of 3) dev-java/openjdk-bin-8.312_p07::gentoo
>>> Recording dev-java/openjdk-bin in "world" favorites file...
>>> Jobs: 3 of 3 complete                           Load avg: 1.64, 0.73, 0.46
>>> Auto-cleaning packages...

>>> No outdated packages were found on your system.
---

And to see if again virtual/jdk catches the openjdk source version,
this happens:
---
# emerge -1 =virtual/jre-1.8.0-r3:1.8::gentoo

These are the packages that would be merged, in order:

Calculating dependencies  ..... done!
[ebuild  N     ] dev-java/openjdk-8.312_p07:8::gentoo  USE="-alsa cups -debug -doc -examples -headless-awt (-javafx) jbootstrap pch (-selinux) -source" 67.622 KiB
[ebuild  N     ] virtual/jdk-1.8.0-r6:1.8::gentoo  USE="-headless-awt" 0 KiB
[ebuild  N     ] virtual/jre-1.8.0-r3:1.8::gentoo  0 KiB

Total: 3 packages (3 new), Size of downloads: 67.622 KiB

Would you like to merge these packages? [Yes/No] n
---

But in the virtua/jdk is written OR, like:
---
RDEPEND="|| (
                dev-java/openjdk-bin:8[headless-awt=]
                dev-java/openjdk:8[headless-awt=]
                dev-java/icedtea-bin:8[headless-awt=]
                dev-java/icedtea:8[headless-awt=]
)"
---

I am using stable portage with unstable python, perhaps this is an issue of python-3.10 only:
---
# emerge -1p portage

These are the packages that would be merged, in order:

Calculating dependencies  .... done!
[ebuild   R    ] sys-apps/portage-3.0.28-r1::gentoo  USE="apidoc -build doc -gentoo-dev (ipc) native-extensions -rsync-verify (-selinux) -test xattr" PYTHON_TARGETS="-pypy3 -python3_8 -python3_9 python3_10" 1.129 KiB

Total: 1 package (1 reinstall), Size of downloads: 1.129 KiB
---

Do you want me to try with =sys-apps/portage-3.0.30-r1
?




Comment 1


John Helmert III









          2022-01-09 21:27:59 UTC
        

Sorry, what is the problem?




Comment 2


Sam James









          2022-01-09 21:29:22 UTC
        

Why emerge the virtual again? If you emerge the bin then try a world upgrade, what happens? It should be satisfied.

But yeah, it seems odd that re-emerging the virtual does that...




Comment 3


Ulenrich





          2022-01-09 21:39:53 UTC
        

Hey John, I want to emerge quickly the zeppelin-bin but without compiling all of openjdk, therefore I had emerged openjdk-bin. Now happens:
---
 # emerge zeppelin-bin

These are the packages that would be merged, in order:

Calculating dependencies  ... done!
[ebuild  N     ] acct-group/zeppelin-0-r1::gentoo  0 KiB
[ebuild  N     ] acct-user/zeppelin-0-r1::gentoo  0 KiB
[ebuild  N     ] dev-java/openjdk-8.312_p07:8::gentoo  USE="-alsa cups -debug -doc -examples -headless-awt (-javafx) jbootstrap pch (-selinux) -source" 67.622 KiB
[ebuild  N     ] virtual/jdk-1.8.0-r6:1.8::gentoo  USE="-headless-awt" 0 KiB
[ebuild  N     ] virtual/jre-1.8.0-r3:1.8::gentoo  0 KiB
[ebuild  N     ] www-apps/zeppelin-bin-0.8.2-r1::gentoo  975.107 KiB

Total: 6 packages (6 new), Size of downloads: 1.042.728 KiB

Would you like to merge these packages? [Yes/No] n

Quitting.
---

@Sam,
if I emerge world, nothing happens, my system is up-to-date!
---
# emerge -auvDN world

These are the packages that would be merged, in order:

Calculating dependencies  . .. .. . ........ .... ... done!

Total: 0 packages, Size of downloads: 0 KiB
----




Comment 4


Ulenrich





          2022-01-09 21:43:18 UTC
        

A special is my glibc.ebuild I have made ready for only python-3.10
... which someon had written works and it worked to emerg glibc-2.34-r4 with only python-3.10
---
# emerge --info virtual/jdk
Portage 3.0.28 (python 3.10.1-final-0, default/linux/amd64/17.1/desktop/gnome/systemd, gcc-11.2.1, glibc-2.34-r4, 5.15.13-1.11.5644 x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-5.15.13-1.11.5644-x86_64-Intel-R-_Core-TM-2_Duo_CPU_P8700_@_2.53GHz-with-glibc2.34
KiB Mem:     3768972 total,    569120 free
KiB Swap:    3145720 total,   3115628 free
Head commit of repository matede: 563d8c18cc94ec91176053be5306493b960d2a21

Head commit of repository gentoo: 4fa26bd9039450d46ad06cf145269faaa52519f6

sh bash 5.1_p16
ld GNU ld (Gentoo 2.37_p1 p1) 2.37
app-misc/pax-utils:        1.3.3::gentoo
app-shells/bash:           5.1_p16::gentoo
dev-java/java-config:      2.3.1::gentoo
dev-lang/perl:             5.34.0-r6::gentoo
dev-lang/python:           3.10.1-r3::gentoo
dev-lang/rust-bin:         1.57.0::gentoo
dev-util/cmake:            3.22.1::gentoo
dev-util/meson:            0.60.3::gentoo
sys-apps/baselayout:       2.7-r3::gentoo
sys-apps/sandbox:          2.25::gentoo
sys-apps/systemd:          249.7::gentoo
sys-devel/autoconf:        2.13-r1::gentoo, 2.71-r1::gentoo
sys-devel/automake:        1.16.5::gentoo
sys-devel/binutils:        2.37_p1-r1::gentoo
sys-devel/binutils-config: 5.4::gentoo
sys-devel/gcc:             11.2.1_p20211127::gentoo
sys-devel/gcc-config:      2.5-r1::gentoo
sys-devel/libtool:         2.4.6-r6::gentoo
sys-devel/llvm:            13.0.0::gentoo
sys-devel/make:            4.3::gentoo
sys-kernel/linux-headers:  5.15-r3::gentoo (virtual/os-headers)
sys-libs/glibc:            2.34-r4::locali
Repositories:

matede
    location: /common/repos/matede
    sync-type: git
    sync-uri: https://github.com/oz123/mate-de-gentoo
    masters: gentoo
    priority: 2

gentoo
    location: /common/repos/gentoo
    sync-type: git
    sync-uri: https://github.com/gentoo/gentoo.git
    priority: 5
    sync-git-verify-commit-signature: no

locali
    location: /common/repos/locali
    masters: gentoo
    priority: 7

ABI="amd64"
ABI_X86="32 64"
ACCEPT_KEYWORDS="amd64"




Comment 5


Sam James









          2022-01-09 21:47:29 UTC
        

Not that this should be needed, but if you try masking everything but the -bin, what error (if any) does it give?

I'm wondering why it doesn't consider the bin to satisfy the virtual.




Comment 6


Ulenrich





          2022-01-09 22:20:08 UTC
        

@Sam
Thanks thanks very much, I found my error:
---
# emerge zeppelin-bin

These are the packages that would be merged, in order:

Calculating dependencies   * waiting for lock on /var/db/.pkg.portage_lockfile ...                                                                                                            [ ok ]
... done!

emerge: there are no ebuilds built with USE flags to satisfy "dev-java/openjdk-bin:8[headless-awt=]".
!!! One of the following packages is required to complete your request:
- dev-java/openjdk-bin-8.312_p07::gentoo (Change USE: -headless-awt)
- virtual/jdk-1.8.0-r6::gentoo (Change USE: +headless-awt)
(dependency required by "virtual/jdk-1.8.0-r6::gentoo" [ebuild])
(dependency required by "www-apps/zeppelin-bin-0.8.2-r1::gentoo" [ebuild])
(dependency required by "zeppelin-bin" [argument])
----

headless-awt !!!!!!!!!!!!!!!
---
 # emerge zeppelin-bin

These are the packages that would be merged, in order:

Calculating dependencies  ...... done!
[ebuild  N     ] acct-group/zeppelin-0-r1::gentoo  0 KiB
[ebuild  N     ] acct-user/zeppelin-0-r1::gentoo  0 KiB
[ebuild   R    ] dev-java/openjdk-bin-8.312_p07:8::gentoo  USE="alsa cups examples -headless-awt* (-selinux) -source" 0 KiB
[ebuild  N     ] virtual/jdk-1.8.0-r6:1.8::gentoo  USE="-headless-awt" 0 KiB
[ebuild  N     ] virtual/jre-1.8.0-r3:1.8::gentoo  0 KiB
[ebuild  N     ] www-apps/zeppelin-bin-0.8.2-r1::gentoo  975.107 KiB
---

RESOLVED




Comment 7


Sam James









          2022-01-09 22:21:48 UTC
        

Aha! Nice!









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

