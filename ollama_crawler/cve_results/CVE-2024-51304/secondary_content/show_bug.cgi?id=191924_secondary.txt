Title: 191924 – x11-drivers/synaptics-0.14.6 and xorg-server-1.4 are incompatible
URL: https://bugs.gentoo.org/show_bug.cgi?id=191924

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 191924
x11-drivers/synaptics-0.14.6 and xorg-server-1.4 are incompatible
Last modified: 2008-02-15 16:46:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 191924 
      - x11-drivers/synaptics-0.14.6 and xorg-server-1.4 are incompatible


Summary:
x11-drivers/synaptics-0.14.6 and xorg-server-1.4 are incompatible
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

X11 External Driver Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-09-10 00:54 UTC by Alexandre Rostovtsev (RETIRED)





      Modified:
    
2008-02-15 16:46 UTC
      (History)
    




          CC List:
        

9 
          users
          
            (show)
          



andrew.golovkov
bluebird
chrschmitt
ewanm89
jens
jrmalaq
lorenzo
mmokrejs
pesa









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




working-xorg.conf

              (xorg.conf,2.57 KB,
                text/plain)

            
2007-09-10 17:33 UTC,

            Friedrich Oslage (RETIRED)




Details





My Working Xorg.conf

              (xorg.conf,2.71 KB,
                text/plain)

            
2007-09-10 19:02 UTC,

            Ewan Marshall




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alexandre Rostovtsev (RETIRED)






          2007-09-10 00:54:08 UTC
        

The version of synaptics currently in the tree doesn't seem to work with xorg-server-1.4. From the Xorg.0.log:

(II) LoadModule: "synaptics"
(II) Loading /usr/lib/xorg/modules/input//synaptics_drv.so
dlopen: /usr/lib/xorg/modules/input//synaptics_drv.so: undefined symbol: miPointerGetMotionEvents
(EE) Failed to load /usr/lib/xorg/modules/input//synaptics_drv.so
(II) UnloadModule: "synaptics"
(EE) Failed to load module "synaptics" (loader failed, 7)

Recompiling synaptics doesn't help.




Comment 1


Andrew N Golovkov





          2007-09-10 07:41:06 UTC
        

>>> Emerging (1 of 1) x11-drivers/synaptics-0.14.6 to /
 * synaptics-0.14.6.tar.bz2 RMD160 ;-) ...                                                                                                                                                    [ ok ]
 * synaptics-0.14.6.tar.bz2 SHA1 ;-) ...                                                                                                                                                      [ ok ]
 * synaptics-0.14.6.tar.bz2 SHA256 ;-) ...                                                                                                                                                    [ ok ]
 * synaptics-0.14.6.tar.bz2 size ;-) ...                                                                                                                                                      [ ok ]
 * checking ebuild checksums ;-) ...                                                                                                                                                          [ ok ]
 * checking auxfile checksums ;-) ...                                                                                                                                                         [ ok ]
 * checking miscfile checksums ;-) ...                                                                                                                                                        [ ok ]
 * checking synaptics-0.14.6.tar.bz2 ;-) ...                                                                                                                                                  [ ok ]
>>> Unpacking source...
>>> Unpacking synaptics-0.14.6.tar.bz2 to /var/tmp/portage/x11-drivers/synaptics-0.14.6/work
>>> Source unpacked.
>>> Compiling source in /var/tmp/portage/x11-drivers/synaptics-0.14.6/work/synaptics-0.14.6 ...
rm -f synaptics.o
x86_64-pc-linux-gnu-gcc -c -g -O2 -pipe -pedantic -Wall -Wpointer-arith -fno-merge-constants -fPIC -I. -I/usr/include/X11 -I/usr/include/X11/extensions -I/usr/include/xorg -Dlinux -D_POSIX_C_SOURCE=199309L -D_POSIX_SOURCE -D_XOPEN_SOURCE -D_BSD_SOURCE -D_SVID_SOURCE  -D_GNU_SOURCE  -DSHAPE -DXINPUT -DXKB -DLBX -DXAPPGROUP -DXCSECURITY -DTOGCUP   -DDPMSExtension  -DPIXPRIV -DPANORAMIX  -DRENDER -DGCCUSESGAS -DAVOID_GLYPHBLT -DPIXPRIV -DSINGLEDEPTH -DXFreeXDGA -DXvExtension -DXFree86LOADER  -DXFree86Server -DXF86VIDMODE  -DSMART_SCHEDULE -DBUILDDEBUG -DX_BYTE_ORDER=X_LITTLE_ENDIAN -DNDEBUG -D__x86_64__ -D_XSERVER64 -DFUNCPROTO=15 -DNARROWPROTO -DIN_MODULE -DXFree86Module -DVERSION="\"0.14.6\"" -DVERSION_ID="(0*10000+14*100+6)"  synaptics.c
rm -f ps2comm.o
x86_64-pc-linux-gnu-gcc -c -g -O2 -pipe -pedantic -Wall -Wpointer-arith -fno-merge-constants -fPIC -I. -I/usr/include/X11 -I/usr/include/X11/extensions -I/usr/include/xorg -Dlinux -D_POSIX_C_SOURCE=199309L -D_POSIX_SOURCE -D_XOPEN_SOURCE -D_BSD_SOURCE -D_SVID_SOURCE  -D_GNU_SOURCE  -DSHAPE -DXINPUT -DXKB -DLBX -DXAPPGROUP -DXCSECURITY -DTOGCUP   -DDPMSExtension  -DPIXPRIV -DPANORAMIX  -DRENDER -DGCCUSESGAS -DAVOID_GLYPHBLT -DPIXPRIV -DSINGLEDEPTH -DXFreeXDGA -DXvExtension -DXFree86LOADER  -DXFree86Server -DXF86VIDMODE  -DSMART_SCHEDULE -DBUILDDEBUG -DX_BYTE_ORDER=X_LITTLE_ENDIAN -DNDEBUG -D__x86_64__ -D_XSERVER64 -DFUNCPROTO=15 -DNARROWPROTO -DIN_MODULE -DXFree86Module -DVERSION="\"0.14.6\"" -DVERSION_ID="(0*10000+14*100+6)"  ps2comm.c
rm -f eventcomm.o
x86_64-pc-linux-gnu-gcc -c -g -O2 -pipe -pedantic -Wall -Wpointer-arith -fno-merge-constants -fPIC -I. -I/usr/include/X11 -I/usr/include/X11/extensions -I/usr/include/xorg -Dlinux -D_POSIX_C_SOURCE=199309L -D_POSIX_SOURCE -D_XOPEN_SOURCE -D_BSD_SOURCE -D_SVID_SOURCE  -D_GNU_SOURCE  -DSHAPE -DXINPUT -DXKB -DLBX -DXAPPGROUP -DXCSECURITY -DTOGCUP   -DDPMSExtension  -DPIXPRIV -DPANORAMIX  -DRENDER -DGCCUSESGAS -DAVOID_GLYPHBLT -DPIXPRIV -DSINGLEDEPTH -DXFreeXDGA -DXvExtension -DXFree86LOADER  -DXFree86Server -DXF86VIDMODE  -DSMART_SCHEDULE -DBUILDDEBUG -DX_BYTE_ORDER=X_LITTLE_ENDIAN -DNDEBUG -D__x86_64__ -D_XSERVER64 -DFUNCPROTO=15 -DNARROWPROTO -DIN_MODULE -DXFree86Module -DVERSION="\"0.14.6\"" -DVERSION_ID="(0*10000+14*100+6)"  eventcomm.c
ps2comm.c: In function 'ps2_packet_ok':
ps2comm.c:507: warning: implicit declaration of function 'DBG'
ps2comm.c:507: error: invalid use of void expression
ps2comm.c:512: error: invalid use of void expression
ps2comm.c:517: error: invalid use of void expression
ps2comm.c:522: error: invalid use of void expression
ps2comm.c: In function 'ps2_synaptics_get_packet':
ps2comm.c:544: error: invalid use of void expression
ps2comm.c:547: error: invalid use of void expression
ps2comm.c:570: error: invalid use of void expression
ps2comm.c:580: error: invalid use of void expression
ps2comm.c: In function 'PS2ReadHwState':
ps2comm.c:629: error: invalid use of void expression
ps2comm.c:679: error: invalid use of void expression
synaptics.c: In function 'SynapticsPreInit':
synaptics.c:324: error: 'struct _LocalDeviceRec' has no member named 'motion_history_proc'
synaptics.c:435: warning: implicit declaration of function 'DBG'
synaptics.c:435: error: invalid use of void expression
synaptics.c: In function 'SynapticsCtrl':
synaptics.c:495: error: invalid use of void expression
synaptics.c: In function 'DeviceOn':
synaptics.c:537: error: invalid use of void expression
synaptics.c: In function 'DeviceOff':
synaptics.c:571: error: invalid use of void expression
synaptics.c: In function 'DeviceInit':
synaptics.c:607: error: invalid use of void expression
synaptics.c:617: warning: 'miPointerGetMotionBufferSize' is deprecated (declared at /usr/include/xorg/mipointer.h:99)
synaptics.c:617: error: too few arguments to function 'InitPointerDeviceStruct'
synaptics.c: In function 'SelectTapButton':
synaptics.c:955: error: invalid use of void expression
synaptics.c:959: error: invalid use of void expression
synaptics.c:963: error: invalid use of void expression
synaptics.c:967: error: invalid use of void expression
synaptics.c:971: error: invalid use of void expression
synaptics.c:977: error: invalid use of void expression
synaptics.c:981: error: invalid use of void expression
synaptics.c: In function 'SetTapState':
synaptics.c:994: error: invalid use of void expression
synaptics.c: In function 'HandleScrolling':
synaptics.c:1388: error: invalid use of void expression
synaptics.c:1396: error: invalid use of void expression
synaptics.c:1401: error: invalid use of void expression
synaptics.c:1409: error: invalid use of void expression
synaptics.c:1415: error: invalid use of void expression
synaptics.c:1425: error: invalid use of void expression
synaptics.c:1431: error: invalid use of void expression
synaptics.c:1435: error: invalid use of void expression
synaptics.c:1441: error: invalid use of void expression
synaptics.c:1445: error: invalid use of void expression
synaptics.c:1464: error: invalid use of void expression
synaptics.c:1475: error: invalid use of void expression
synaptics.c: In function 'ControlProc':
synaptics.c:1782: error: invalid use of void expression
synaptics.c: In function 'CloseProc':
synaptics.c:1790: error: invalid use of void expression
make: *** [synaptics.o] Error 1
make: *** Waiting for unfinished jobs....
make: *** [ps2comm.o] Error 1
 *
 * ERROR: x11-drivers/synaptics-0.14.6 failed.
 * Call stack:
 *   ebuild.sh, line 1654:   Called dyn_compile
 *   ebuild.sh, line 990:   Called qa_call 'src_compile'
 *   ebuild.sh, line 44:   Called src_compile
 *   synaptics-0.14.6.ebuild, line 33:   Called die
 *
 * (no error message)
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/var/tmp/portage/x11-drivers/synaptics-0.14.6/temp/build.log'.
 *




# emerge --info
Portage 2.1.3.9 (default-linux/amd64/2007.0, gcc-4.2.0, glibc-2.5-r4, 2.6.22-s-AnDoR x86_64)
=================================================================
System uname: 2.6.22-s-AnDoR x86_64 Intel(R) Core(TM)2 CPU T5300 @ 1.73GHz
Timestamp of tree: Sun, 09 Sep 2007 15:00:01 +0000
app-shells/bash:     3.2_p17-r1
dev-lang/python:     2.4.4-r5
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.10-r4
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.5, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18.50.0.1
sys-devel/gcc-config: 1.4.0-r2
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r2
ACCEPT_KEYWORDS="amd64 ~amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-g -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb"
CONFIG_PROTECT_MASK="/etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-g -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="ccache confcache distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
LANG="C"
LC_ALL=""
LINGUAS="ru en"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
USE="16bit 16bit-indices 64bit 7zip X X509 Xaw3d a52 aac aalib ace acpi addbookmarks administrator aim alias alisp alsa amd64 amr amrnb amrr amrwb animgif ao aotuv apache2 apm applet atm audiofile authfile bash-completion bashlogger bidi bl bluetooth boost bzip2 cdda cddb cdparanoia cgi chm chroot cli cracklib debug debug-freelist debug-malloc debugger dedicated dell doc dvd dvdnav dvdr dvdread examples fbsplash ffmpeg fftw flac flatfile ftp gdbm gif glep gpm hal iconv ieee1394 imagemagick imap imlib inifile innodb iproute2 irc javascript jpeg jpeg2k json justify kde kdm kerberos lame lcms libcaca libedit libsamplerate libwww live logrotate lua lzo lzw mad madwifi mail maildir matroska max-idx-128 md5sum mime mixer mjpeg mmap mmx mmxext mng mouse mp2 mp3 mp4 mp4live mpd mpeg mpeg2 mplayer munin-apache munin-dhcp munin-irc munin-squid munin-surfboard musepack mysql mysqli nat ncurses nethack network network-cron networking new-login nls nptl nvidia objc objc++ objc-gc ogg openal opengl openmp openntpd openssh openssl openvpn oscar oss pam pam_chroot pam_console pam_nuauth pam_timestamp passwordsave pcmcia pcre pda pdf perl png pptp pulseaudio pyste python quicktime radius rar readline realmedia recode regex reiserfs rle rpm rss rtc ruby rubytests sdl sdl-image sdl-sound sdlaudio sensord session slang smarty smp sms sndfile snmp soap sockets socks5 softquota spell sql sqlite sqlite3 sse sse2 ssl ssse3 tcl tcpd teletext test tga theora threads tiff tokenizer tools truetype type1 unicode unzip usb userlocales valgrind vcd vhosts vim vim-pager vim-syntax vim-with-x vorbis vroot wav wavpack web webdav wifi wma wmf wmp x11vnc x264 xcomposite xfs xhtml xine xinerama xml xmlreader xmlrpc xmlwriter xorg xosd xprint xscreensaver xsl xvid zip zlib zsh-completion" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="ru en" USERLAND="GNU" VIDEO_CARDS="nvidia vesa"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 2


Björn Ruberg





          2007-09-10 11:44:59 UTC
        

The latest version of synaptics in the tree fixes the compile problem.
But it is still not working. I have an
"Synaptics DeviceOff called" in my Xorg.0.log without any explanation.
MousePointer is not working.




Comment 3


Ewan Marshall





          2007-09-10 11:52:41 UTC
        

Builds here, and loads. But doesn't actually do anything, move cursor, mouse clicks...




Comment 4


Santiago Gala





          2007-09-10 12:37:08 UTC
        

Looks like /me too: xorg-server 1.4 stays doing nothing, neither keyboard nor mouse seem active, until I manage to kill it (and then the screen with the cross cursor remains and I need to login into VT1 and reboot blindly, or else I can't go to console, but acpi/power button reboots.

I recompiled every driver after xorg-server, and the logs are empty or errors or significant warnings.

Reverting to 1.3 and recompiling all drivers turns it into a stable, working X again. 




Comment 5


Santiago Gala





          2007-09-10 12:47:08 UTC
        

wrong, I'm seeing bug #191822




Comment 6


Ewan Marshall





          2007-09-10 13:26:51 UTC
        

Recompile keyboard driver again, then you get keyboard back. Synaptics touchpad still won't work.




Comment 7


Friedrich Oslage (RETIRED)






          2007-09-10 17:19:41 UTC
        

This bug is a duplicate of bug 191899.




Comment 8


Ewan Marshall





          2007-09-10 17:24:25 UTC
        

Patch in other report makes it build, but does not make it work.




Comment 9


Friedrich Oslage (RETIRED)






          2007-09-10 17:33:22 UTC
        

Created attachment 130520 [details]
working-xorg.conf

Do you have any *core* stuff in your xorg.conf file? (Like AlwaysCore, CorePointer, SendCoreEvents) If yes try removing it.

I attached my working xorg.conf as a reference(xorg-server-1.4-r1, synaptics-0.14.6)




Comment 10


Ewan Marshall





          2007-09-10 18:15:31 UTC
        

That fixes it, thanks.




Comment 11


Ewan Marshall





          2007-09-10 18:16:25 UTC
        

CorePointer is ok, AlwaysCore isn't.




Comment 12


Alexandre Rostovtsev (RETIRED)






          2007-09-10 18:48:43 UTC
        

(In reply to comment #11)
> CorePointer is ok, AlwaysCore isn't.

Removing CorePointer fixed the problem for me.




Comment 13


Ewan Marshall





          2007-09-10 19:02:14 UTC
        

Created attachment 130534 [details]
My Working Xorg.conf

Only one CorePointer is allowed to be specified, so my attachment has two mouse devices for people to compare.




Comment 14


Christian Schmitt





          2007-09-24 15:29:19 UTC
        

Works without a problem for me. Many thanks




Comment 15


Shyam Mani (RETIRED)






          2007-10-01 06:38:05 UTC
        

(In reply to comment #11)
> CorePointer is ok, AlwaysCore isn't.

I'd second this. I removed AlwaysCore and it seems to work fine.




Comment 16


Ivan Krownitz





          2007-10-29 12:33:33 UTC
        

(In reply to comment #15)
> (In reply to comment #11)
> > CorePointer is ok, AlwaysCore isn't.
> 
> I'd second this. I removed AlwaysCore and it seems to work fine.

Just removing the all the Core stuff (SendCoreEvents, CorePointer, ...) made my synaptics work. Though I also needed *exactly one* CorePointer so that USB mouse Mouse0 would work as well, here is the relevant part of Section "ServerLayout" from xorg.conf:

InputDevice    "Mouse0" "CorePointer"
InputDevice    "Keyboard0"
InputDevice    "TouchPad"

Without the single CorePointer mouse clicking was doing strange things - in KDE apps it mostly worked and in gnome apps the click was received (I could see the button animate), but didn't do anything.




Comment 17


David Krapohl





          2007-11-03 11:09:39 UTC
        

(In reply to comment #16)
> Just removing the all the Core stuff (SendCoreEvents, CorePointer, ...) made my
> synaptics work. Though I also needed *exactly one* CorePointer so that USB
> mouse Mouse0 would work as well, here is the relevant part of Section
> "ServerLayout" from xorg.conf:
> 
> InputDevice    "Mouse0" "CorePointer"
> InputDevice    "Keyboard0"
> InputDevice    "TouchPad"
> 
> Without the single CorePointer mouse clicking was doing strange things - in KDE
> apps it mostly worked and in gnome apps the click was received (I could see the
> button animate), but didn't do anything.
> 

I suggest putting this information in the ebuild and show it after installation. It  could save a lot of time. Nobody expects the option to change like that.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

