Title: 258423 – [java-overlay] icedtea6 reliance on large max args/missing zip dependency
URL: https://bugs.gentoo.org/show_bug.cgi?id=258423

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 258423
[java-overlay] icedtea6 reliance on large max args/missing zip dependency
Last modified: 2010-02-09 10:54:10 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 258423 
      - [java-overlay] icedtea6 reliance on large max args/missing zip dependency


Summary:
[java-overlay] icedtea6 reliance on large max args/missing zip dependency
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Java

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Java team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




icedtea-tracker



 

        Show dependency tree





 





      Reported:
    
2009-02-10 08:55 UTC by Brian Harring (RETIRED)





      Modified:
    
2010-02-09 10:54 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



gnu_andrew









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




maxarg-limit.patch

              (maxarg-limit.patch,2.19 KB,
                patch)

            
2009-02-10 08:56 UTC,

            Brian Harring (RETIRED)




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Brian Harring (RETIRED)






          2009-02-10 08:55:03 UTC
        

two issues w/ the icedtea6 in java-overlay as of rev 7489:

1) dependency on unzip actually needs to be zip.  Weird, but had fiddled it enough times to verify configure blows up w/ zip merged.
2) deep in the bowels of this beast it does a nasty ls expansion trick- this fails miserably however on <glibc-2.8 (roughly, still not entirely sure where argc limit is *truly* coming from).

For #2, since javac can do @ and glob expansion, the pattern should be passed directly to javac (so it does the expansion internally avoiding the arg limit).  One goofy bit about what they doing is the affect this had on depedencies- may require still expanding it out (or requiring a version of make satisfying the claimed incompatibility).

Either way, all y'alls; seems to do the trick for me.




Comment 1


Brian Harring (RETIRED)






          2009-02-10 08:56:20 UTC
        

Created attachment 181524 [details, diff]
maxarg-limit.patch

sidestep arg limits via using tmp files; epatch this in via src_prepare, should fix the issue.




Comment 2


Petteri Räty (RETIRED)






          2009-02-10 20:28:51 UTC
        

20:25 < Betelgeuse> mjw, gnu_andrew: https://bugs.gentoo.org/attachment.cgi?id=181524&action=view
20:26 < Betelgeuse> https://bugs.gentoo.org/show_bug.cgi?id=258423
20:27 < mjw> Betelgeuse, could you post that with some comments about why it works (or didn't before) to the list?
20:28 < Betelgeuse> mjw: distro-pkg-dev?
20:28 < mjw> yes please

The mailing list can be found here:
http://mail.openjdk.java.net/mailman/listinfo/distro-pkg-dev




Comment 3


Andrew John Hughes





          2009-02-10 20:36:31 UTC
        

http://bugs.openjdk.java.net is preferable; it's an OpenJDK bug.




Comment 4


Brian Harring (RETIRED)






          2009-02-10 21:57:41 UTC
        

Also, the ebuilds pkg_setup is evil, oh so very evil- you can't merge a built version of icedtea6 w/out merging a bootstrapping env prior.

Kind of defeats the purpose ;)





Comment 5


Andrew John Hughes





          2010-01-28 01:20:03 UTC
        

Brian, and how would you propose building a Java environment without Java?  GCC requires the same thing, that's why you get it in a pre-built stage.




Comment 6


Brian Harring (RETIRED)






          2010-01-28 07:29:56 UTC
        

(In reply to comment #5)
> Brian, and how would you propose building a Java environment without Java?  GCC
> requires the same thing, that's why you get it in a pre-built stage.

Read closer- I said
"you can't merge a built version of icedtea6 w/out merging a bootstrapping env prior."

Note the 'built'- yes you need a jdk to build it.  You sure as hell don't need a jdk to *merge* it however (as evidenced by icedtea6-bin and the ebuilds RDEPENDS).

The flaw is purely in that the ebuilds pkg_setup doesn't account for when ran twice (essentially)- if it's a binpkg, that force crap should already exist.  Detect that and you can skip the die nastyness (and other build localization steps) and it'll function properly as a binpkg.




Comment 7


Vlastimil Babka (Caster) (RETIRED)






          2010-01-28 13:12:39 UTC
        

(In reply to comment #4)
> Also, the ebuilds pkg_setup is evil, oh so very evil- you can't merge a built
> version of icedtea6 w/out merging a bootstrapping env prior.
> 
> Kind of defeats the purpose ;)
 
Fixed by some voodoo.
Are the other issues still present nowadays?





Comment 8


Brian Harring (RETIRED)






          2010-01-28 14:36:25 UTC
        

Sorry, no idea- I've not looked in the innards of this pkg/ebuild since Feb '09 or so.




Comment 9


Vlastimil Babka (Caster) (RETIRED)






          2010-02-09 10:54:10 UTC
        

Nobody reported the MAX_ARGS problems since year ago, assuming upstream fixed. The zip dependency was indeed needed - added, thanks.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

