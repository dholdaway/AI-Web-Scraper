Title: 195453 – media-video/mplayer-1.0-rc2 fails to play with "illegal instruction"
URL: https://bugs.gentoo.org/show_bug.cgi?id=195453

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 195453
media-video/mplayer-1.0-rc2 fails to play with "illegal instruction"
Last modified: 2007-10-16 03:20:19 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 195453 
      - media-video/mplayer-1.0-rc2 fails to play with "illegal instruction"


Summary:
media-video/mplayer-1.0-rc2 fails to play with "illegal instruction"
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Media-video project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-10-11 04:06 UTC by James





      Modified:
    
2007-10-16 03:20 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




gdb trace of mplayer attempting to play a media file

              (mplayer gdb trace.txt,6.84 KB,
                text/plain)

            
2007-10-11 04:32 UTC,

            James




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


James





          2007-10-11 04:06:30 UTC
        

mplayer-1.0-rc2 fails to play saying that it has an illegal instruction, it says that this us usually from using a binary built/optimized for a different processor. However, it was built on this computer using the same ebuild options as the rest of th system.

Reproducible: Always

Steps to Reproduce:
1.emerge mplayer-1.0_rc2
2.mplayer (any media file)
3.

Actual Results:  
end of emerge mplayer:
>>> Completed installing mplayer-1.0_rc2 into /var/tmp/portage/media-video/mplayer-1.0_rc2/image/

ecompressdir: bzip2 -9 usr/share/man

 * QA Notice: Package has poor programming practices which may compile
 *            fine but exhibit random runtime failures.
 * floor0.c:395: warning: implicit declaration of function ‘_vorbis_block_alloc’
floor1.c:320: warning: implicit declaration of function ‘_vorbis_block_alloc’
misc.h:188: warning: implicit declaration of function ‘_ilog’
res012.c:196: warning: implicit declaration of function '_vorbis_block_alloc'
misc.h:188: warning: implicit declaration of function ‘abs’
misc.h:188: warning: implicit declaration of function '_ilog'
misc.h:188: warning: implicit declaration of function ‘_ilog’
misc.h:188: warning: implicit declaration of function ‘abs’
ad_hwac3.c:171: warning: implicit declaration of function ‘swab’
nav_read.c:58: warning: implicit declaration of function ‘abort’
misc.h:188: warning: implicit declaration of function 'abs'
synthesis.c:36: warning: implicit declaration of function '_vorbis_block_ripcord'
synthesis.c:67: warning: implicit declaration of function '_vorbis_block_alloc'
misc.h:188: warning: implicit declaration of function ‘_ilog’
elfdll.c:106: warning: implicit declaration of function ‘TRACE’
dshow/mediatype.c:88: warning: implicit declaration of function 'vo_format_name'
../libavcodec/dsputil.h:675: warning: implicit declaration of function 'AV_WN16'
../libavcodec/dsputil.h:675: warning: implicit declaration of function 'AV_RN16'
../libavcodec/dsputil.h:686: warning: implicit declaration of function 'AV_WN32'
../libavcodec/dsputil.h:686: warning: implicit declaration of function 'AV_RN32'
vf_qp.c:91: warning: implicit declaration of function 'lrintf'
../libavcodec/dsputil.h:675: warning: implicit declaration of function 'AV_WN16'
../libavcodec/dsputil.h:675: warning: implicit declaration of function 'AV_RN16'
../libavcodec/dsputil.h:686: warning: implicit declaration of function 'AV_WN32'
../libavcodec/dsputil.h:686: warning: implicit declaration of function 'AV_RN32'
ad_liba52.c:68: warning: implicit declaration of function ‘swab’
../libavcodec/dsputil.h:675: warning: implicit declaration of function 'AV_WN16'
../libavcodec/dsputil.h:675: warning: implicit declaration of function 'AV_RN16'
../libavcodec/dsputil.h:686: warning: implicit declaration of function 'AV_WN32'
../libavcodec/dsputil.h:686: warning: implicit declaration of function 'AV_RN32'
../libavcodec/dsputil.h:675: warning: implicit declaration of function 'AV_WN16'
../libavcodec/dsputil.h:675: warning: implicit declaration of function 'AV_RN16'
../libavcodec/dsputil.h:686: warning: implicit declaration of function 'AV_WN32'
../libavcodec/dsputil.h:686: warning: implicit declaration of function 'AV_RN32'
ad_libvorbis.c:47: warning: implicit declaration of function 'vsscanf'
snow.c:4394: warning: implicit declaration of function 'dwt_quantize'


 * QA Notice: Package has poor programming practices which may compile
 *            fine but exhibit random runtime failures.
 * nav_read.c:58: warning: incompatible implicit declaration of built-in function ‘abort’
nav_read.c:108: warning: incompatible implicit declaration of built-in function ‘abort’
nav_read.c:272: warning: incompatible implicit declaration of built-in function ‘abort’
vf_qp.c:91: warning: incompatible implicit declaration of built-in function 'lrintf'

Notably, it installs as though everything were fine.

run mplayer:
mplayer dvd://1
MPlayer 1.0rc2-4.2.0 (C) 2000-2007 MPlayer Team
CPU: Mobile Intel(R) Pentium(R) III CPU - M  1133MHz (Family: 6, Model: 11, Stepping: 4)
CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 0
Compiled for x86 CPU with extensions: MMX MMX2 SSE

Playing dvd://1.
There are 1 titles on this DVD.
There are 19 chapters in this DVD title.
There are 1 angles in this DVD title.
audio stream: 0 format: ac3 (5.1) language: en aid: 128.
number of audio channels on disk: 1.
subtitle ( sid ): 0 language: en
number of subtitles on disk: 1
MPEG-PS file format detected.
VIDEO:  MPEG2  720x480  (aspect 3)  29.970 fps  9801.6 kbps (1225.2 kbyte/s)
==========================================================================
Opening video decoder: [mpegpes] MPEG 1/2 Video passthrough
VDec: vo config request - 720 x 480 (preferred colorspace: Mpeg PES)
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [libmpeg2] MPEG 1/2 Video decoder libmpeg2-v0.4.0b
Selected video codec: [mpeg12] vfm: libmpeg2 (MPEG-1 or 2 (libmpeg2))
==========================================================================
==========================================================================
Opening audio decoder: [liba52] AC3 decoding with liba52
Using SSE optimized IMDCT transform
Using MMX optimized resampler
AUDIO: 48000 Hz, 2 ch, s16le, 448.0 kbit/29.17% (ratio: 56000->192000)
Selected audio codec: [a52] afm: liba52 (AC3-liba52)
==========================================================================


MPlayer interrupted by signal 4 in module: af_preinit
- MPlayer crashed by an 'Illegal Instruction'.
  It usually happens when you run it on a CPU different than the one it was
  compiled/optimized for.
  Verify this!
- MPlayer crashed by bad usage of CPU/FPU/RAM.
  Recompile MPlayer with --enable-debug and make a 'gdb' backtrace and
  disassembly. Details in DOCS/HTML/en/bugreports_what.html#bugreports_crash.
- MPlayer crashed. This shouldn't happen.
  It can be a bug in the MPlayer code _or_ in your drivers _or_ in your
  gcc version. If you think it's MPlayer's fault, please read
  DOCS/HTML/en/bugreports.html and follow the instructions there. We can't and
  won't help unless you provide this information when reporting a possible bug.

mplayer South.Park.S11E08.DSR.XviD-LOKi.avi
MPlayer 1.0rc2-4.2.0 (C) 2000-2007 MPlayer Team
CPU: Mobile Intel(R) Pentium(R) III CPU - M  1133MHz (Family: 6, Model: 11, Stepping: 4)
CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 0
Compiled for x86 CPU with extensions: MMX MMX2 SSE

Playing South.Park.S11E08.DSR.XviD-LOKi.avi.
AVI file format detected.
[aviheader] Video stream found, -vid 0
[aviheader] Audio stream found, -aid 1
VIDEO:  [XVID]  512x384  12bpp  23.976 fps  991.3 kbps (121.0 kbyte/s)
Clip info:
 Software: VirtualDub
==========================================================================
Opening video decoder: [ffmpeg] FFmpeg's libavcodec codec family
Selected video codec: [ffodivx] vfm: ffmpeg (FFmpeg MPEG-4)
==========================================================================
==========================================================================
Opening audio decoder: [mp3lib] MPEG layer-2, layer-3
AUDIO: 48000 Hz, 2 ch, s16le, 128.0 kbit/8.33% (ratio: 16000->192000)
Selected audio codec: [mp3] afm: mp3lib (mp3lib MPEG layer-2, layer-3)
==========================================================================


MPlayer interrupted by signal 4 in module: af_preinit
- MPlayer crashed by an 'Illegal Instruction'.
  It usually happens when you run it on a CPU different than the one it was
  compiled/optimized for.
  Verify this!
- MPlayer crashed by bad usage of CPU/FPU/RAM.
  Recompile MPlayer with --enable-debug and make a 'gdb' backtrace and
  disassembly. Details in DOCS/HTML/en/bugreports_what.html#bugreports_crash.
- MPlayer crashed. This shouldn't happen.
  It can be a bug in the MPlayer code _or_ in your drivers _or_ in your
  gcc version. If you think it's MPlayer's fault, please read
  DOCS/HTML/en/bugreports.html and follow the instructions there. We can't and
  won't help unless you provide this information when reporting a possible bug.

Expected Results:  
that it would play the video

emerge --info
Portage 2.1.3.12 (default-linux/x86/2007.0/desktop, gcc-4.2.0, glibc-2.6.1-r0, 2.6.22-gentoo-r8 i686)
=================================================================
System uname: 2.6.22-gentoo-r8 i686 Mobile Intel(R) Pentium(R) III CPU - M 1133MHz
Timestamp of tree: Wed, 10 Oct 2007 07:50:01 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p17-r1
dev-java/java-config: 1.3.7, 2.1.1
dev-lang/python:     2.4.4-r4, 2.5.1-r2
dev-python/pycrypto: 2.0.1-r6
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.10-r5
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18
sys-devel/gcc-config: 1.4.0-r3
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r2
ACCEPT_KEYWORDS="x86 ~x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=pentium3 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O2 -march=pentium3 -fomit-frame-pointer -pipe"
DISTDIR="/mnt/nfs_portage/distfiles"
FEATURES="ccache distcc distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="en_US.UTF-8"
LC_ALL="en_US.UTF-8"
MAKEOPTS="-j20"
PKGDIR="/mnt/nfs_portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://192.168.1.1/gentoo-portage"
USE="X a52 aac aalib acl acpi aiglx alsa audiofile berkdb bitmap-fonts bzip2 cairo cdparanoia cdr cli cracklib crypt cups dbus dri dvd dvdr dvdread eds emboss encode esd evo fam ffmpeg firefox fortran gdbm gif gpm gstreamer hal iconv imagemagick isdnlog java jpeg kde kerberos ldap mad midi mikmod mmx mmx2 mmxext mp3 mpeg mplayer mudflap mysql mythtv ncurses nls nptl nptlonly nsplugin ogg openal opengl openmp oss pam pcre pdf pdflib perl png pppd python qt3 qt3support quicktime readline real reflection samba sdl session sockets spell spl sse ssl svg szip tcpd tiff truetype truetype-fonts type1-fonts unicode usb vcd vorbis wifi win32codecs x x86 xine xinerama xml xorg xosd xv xvid zlib" ALSA_CARDS="intel8x0" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="savage vesa"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

I'm attempting to follow the debug instructions in the "Actual Results" section




Comment 1


James





          2007-10-11 04:32:42 UTC
        

Created attachment 133113 [details]
gdb trace of mplayer attempting to play a media file




Comment 2


Wilken Haase





          2007-10-11 10:13:44 UTC
        

Same problem here




Comment 3


Steve Dibb (RETIRED)






          2007-10-11 14:05:59 UTC
        

post emerge -pv mplayer




Comment 4


James





          2007-10-11 14:32:02 UTC
        

(In reply to comment #3)
> post emerge -pv mplayer
> 

emerge -pv mplayer

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] media-video/mplayer-1.0_rc2  USE="X a52 aac aalib alsa cdparanoia dvd encode esd gif iconv jpeg mad mmx mmxext mp3 openal opengl oss png quicktime real samba sdl sse truetype unicode vorbis win32codecs xinerama xv xvid -3dnow -3dnowext (-altivec) -amrnb -amrwb -arts -bidi -bindist -bl -cddb -cdio -cpudetection -custom-cflags -debug* -dga -directfb -doc -dts -dv -dvb -enca -fbcon -ftp -ggi -gtk -ipv6 -ivtv -jack -joystick -lame -libcaca -lirc -live -livecd -lzo -md5sum -mp2 -musepack -nas -nemesi -pnm -pvr -radio -rar -rtc -speex -srt -sse2 -ssse3 -svga -teletext -tga -theora -tivo -v4l -v4l2 -vidix -x264 -xanim -xvmc -zoran" VIDEO_CARDS="vesa -mga -s3virge -tdfx" 0 kB




Comment 5


Steve Dibb (RETIRED)






          2007-10-11 14:47:21 UTC
        

(In reply to comment #4)
> (In reply to comment #3)
> > post emerge -pv mplayer
> > 
> 
> emerge -pv mplayer
> 
> These are the packages that would be merged, in order:
> 
> Calculating dependencies... done!
> [ebuild   R   ] media-video/mplayer-1.0_rc2  USE="X a52 aac aalib alsa
> cdparanoia dvd encode esd gif iconv jpeg mad mmx mmxext mp3 openal opengl oss
> png quicktime real samba sdl sse truetype unicode vorbis win32codecs xinerama
> xv xvid -3dnow -3dnowext (-altivec) -amrnb -amrwb -arts -bidi -bindist -bl
> -cddb -cdio -cpudetection -custom-cflags -debug* -dga -directfb -doc -dts -dv
> -dvb -enca -fbcon -ftp -ggi -gtk -ipv6 -ivtv -jack -joystick -lame -libcaca
> -lirc -live -livecd -lzo -md5sum -mp2 -musepack -nas -nemesi -pnm -pvr -radio
> -rar -rtc -speex -srt -sse2 -ssse3 -svga -teletext -tga -theora -tivo -v4l
> -v4l2 -vidix -x264 -xanim -xvmc -zoran" VIDEO_CARDS="vesa -mga -s3virge -tdfx"
> 0 kB
> 

Try re-emerging it w/o debug




Comment 6


Steve Dibb (RETIRED)






          2007-10-11 14:48:17 UTC
        

(In reply to comment #5)

> Try re-emerging it w/o debug

Er, scratch that, assuming you enabled it to get the backtrace...

Can you paste midentfy filename.avi as well






Comment 7


James





          2007-10-11 14:54:03 UTC
        

(In reply to comment #6)
> (In reply to comment #5)
> 
> > Try re-emerging it w/o debug
> 
> Er, scratch that, assuming you enabled it to get the backtrace...
> 
> Can you paste midentfy filename.avi as well
> 
Sorry, How would I do that?





Comment 8


James





          2007-10-11 14:59:12 UTC
        

(In reply to comment #7)
> (In reply to comment #6)
> > (In reply to comment #5)
> > 
> > > Try re-emerging it w/o debug
> > 
> > Er, scratch that, assuming you enabled it to get the backtrace...
> > 
> > Can you paste midentfy filename.avi as well
> > 
> Sorry, How would I do that?
> 

midentify HYC\ Final.mpg
ID_VIDEO_ID=0
ID_AUDIO_ID=0
ID_FILENAME=HYC\ Final.mpg
ID_DEMUXER=mpegps
ID_VIDEO_FORMAT=0x10000002
ID_VIDEO_BITRATE=7500000
ID_VIDEO_WIDTH=720
ID_VIDEO_HEIGHT=480
ID_VIDEO_FPS=29.970
ID_VIDEO_ASPECT=0.0000
ID_AUDIO_FORMAT=80
ID_AUDIO_BITRATE=0
ID_AUDIO_RATE=0
ID_AUDIO_NCH=0
ID_LENGTH=264.07
ID_VIDEO_CODEC=mpegpes
ID_AUDIO_BITRATE=128000
ID_AUDIO_RATE=48000
ID_AUDIO_NCH=2
ID_AUDIO_CODEC=mp3

midentify South.Park.S11E08.DSR.XviD-LOKi.avi
ID_VIDEO_ID=0
ID_AUDIO_ID=1
ID_SIGNAL=4

midentify /dev/dvd
ID_VIDEO_ID=0
ID_AUDIO_ID=128
ID_FILENAME=/dev/dvd
ID_DEMUXER=mpegps
ID_VIDEO_FORMAT=0x10000002
ID_VIDEO_BITRATE=9801600
ID_VIDEO_WIDTH=720
ID_VIDEO_HEIGHT=480
ID_VIDEO_FPS=29.970
ID_VIDEO_ASPECT=0.0000
ID_AUDIO_FORMAT=8192
ID_AUDIO_BITRATE=0
ID_AUDIO_RATE=0
ID_AUDIO_NCH=0
ID_LENGTH=3821.38
ID_VIDEO_CODEC=mpegpes
ID_AUDIO_BITRATE=448000
ID_AUDIO_RATE=48000
ID_AUDIO_NCH=2
ID_AUDIO_CODEC=a52




Comment 9


Samuli Suominen (RETIRED)






          2007-10-11 16:15:37 UTC
        

Does Pentium III actually support MMX2 a.k.a. mmxext which seems to be enabled here?




Comment 10


Samuli Suominen (RETIRED)






          2007-10-11 16:18:50 UTC
        

"grep flags /proc/cpuinfo" output please.




Comment 11


James





          2007-10-11 16:30:47 UTC
        

cat /proc/cpuinfo
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 11
model name      : Mobile Intel(R) Pentium(R) III CPU - M  1133MHz
stepping        : 4
cpu MHz         : 1130.500
cache size      : 512 KB
fdiv_bug        : no
hlt_bug         : no
f00f_bug        : no
coma_bug        : no
fpu             : yes
fpu_exception   : yes
cpuid level     : 2
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 sep mtrr pge mca cmov pat pse36 mmx fxsr sse
bogomips        : 2266.32
clflush size    : 32




Comment 12


Alexis Ballier






          2007-10-11 16:48:28 UTC
        

x/8i $pc
in gdb when the SIGILL is received perhaps could also help




Comment 13


Samuli Suominen (RETIRED)






          2007-10-11 17:06:40 UTC
        

(In reply to comment #11)
> flags           : fpu vme de pse tsc msr pae mce cx8 sep mtrr pge mca cmov pat
> pse36 mmx fxsr sse

According to this list your CPU doesn't support MMX2, so please remove USE="mmxext" and USE="mmx2" from your USE flags and recompile mplayer.


(Valid USE flags are USE="mmx" and USE="sse" for your CPU.)





Comment 14


James





          2007-10-11 17:11:38 UTC
        

Had to copy this manually, hope this is all correct.  I'm in the process of recompiling per above now as well.

Program received signal SIGILL, Illegal instruction.
0x080819b1 in reinit_audio_chain ()
(gdb) x/8i $pc
0x80819b1 <reinit_audio_chain+252>:	fisttpl 0x4(%esp)
0x80819b5 <reinit_audio_chain+256>:	mov	%edx, (%esp)
0x80819b8 <reinit_audio_chain+259>:
    call   0x80d7d20 <preinit_audio_filters>
0x80819bd <reinit_audio_chain+264>:	test	%eax,%eax
0x80819bf <reinit_audio_chain+266>:
    je     0x8081bad <reinit_audio_chain+760>
0x80819c5 <reinit_audio_chain+272>:	movl	$0x863a705,0x879d014
0x80819cf <reinit_audio_chain+282>:	movl	$0x0,0x14(%esp)
0x80819d7 <reinit_audio_chain+290>:	mov	0x8777ce8,%eax




Comment 15


James





          2007-10-11 17:26:46 UTC
        

Brand New build, without mmxext:

emerge -pv mplayer

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] media-video/mplayer-1.0_rc2  USE="X a52 aac alsa cdparanoia dvd encode esd gif iconv jpeg mad mmx mp3 openal opengl oss png quicktime sdl sse truetype unicode vorbis win32codecs xinerama xv xvid -3dnow -3dnowext -aalib (-altivec) -amrnb -amrwb -arts -bidi -bindist -bl -cddb -cdio -cpudetection -custom-cflags -debug -dga -directfb -doc -dts -dv -dvb -enca -fbcon -ftp -ggi -gtk -ipv6 -ivtv -jack -joystick -lame -libcaca -lirc -live -livecd -lzo -md5sum -mmxext -mp2 -musepack -nas -nemesi -pnm -pvr -radio -rar -real -rtc -samba -speex -srt -sse2 -ssse3 -svga -teletext -tga -theora -tivo -v4l -v4l2 -vidix -x264 -xanim -xvmc -zoran" VIDEO_CARDS="vesa -mga -s3virge -tdfx" 0 kB



mplayer HYC\ Final.mpg
MPlayer 1.0rc2-4.2.0 (C) 2000-2007 MPlayer Team
CPU: Intel Celeron 2/Pentium III Coppermine,Geyserville (Family: 6, Model: 8, Stepping: 3)
CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 0
Compiled for x86 CPU with extensions: MMX MMX2 SSE

Playing HYC Final.mpg.
MPEG-PS file format detected.
VIDEO:  MPEG2  720x480  (aspect 2)  29.970 fps  7500.0 kbps (937.5 kbyte/s)
==========================================================================
Opening video decoder: [mpegpes] MPEG 1/2 Video passthrough
VDec: vo config request - 720 x 480 (preferred colorspace: Mpeg PES)
Could not find matching colorspace - retrying with -vf scale...
Opening video filter: [scale]
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [libmpeg2] MPEG 1/2 Video decoder libmpeg2-v0.4.0b
Selected video codec: [mpeg12] vfm: libmpeg2 (MPEG-1 or 2 (libmpeg2))
==========================================================================
==========================================================================
Opening audio decoder: [mp3lib] MPEG layer-2, layer-3
AUDIO: 48000 Hz, 2 ch, s16le, 128.0 kbit/8.33% (ratio: 16000->192000)
Selected audio codec: [mp3] afm: mp3lib (mp3lib MPEG layer-2, layer-3)
==========================================================================


MPlayer interrupted by signal 4 in module: af_preinit
- MPlayer crashed by an 'Illegal Instruction'.
  It usually happens when you run it on a CPU different than the one it was
  compiled/optimized for.
  Verify this!
- MPlayer crashed by bad usage of CPU/FPU/RAM.
  Recompile MPlayer with --enable-debug and make a 'gdb' backtrace and
  disassembly. Details in DOCS/HTML/en/bugreports_what.html#bugreports_crash.
- MPlayer crashed. This shouldn't happen.
  It can be a bug in the MPlayer code _or_ in your drivers _or_ in your
  gcc version. If you think it's MPlayer's fault, please read
  DOCS/HTML/en/bugreports.html and follow the instructions there. We can't and
  won't help unless you provide this information when reporting a possible bug.




Comment 16


Alexis Ballier






          2007-10-11 17:29:46 UTC
        

actually fisttp is a sse3 instruction
according to http://en.wikipedia.org/wiki/X86_instruction_listings




Comment 17


James





          2007-10-11 17:40:25 UTC
        

new gdb trace:

run -v HYC\ Final.mpg
Starting program: /usr/bin/mplayer -v HYC\ Final.mpg
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
---Type <return> to continue, or q <return> to quit---
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
MPlayer 1.0rc2-4.2.0 (C) 2000-2007 MPlayer Team
CPU: Intel Celeron 2/Pentium III Coppermine,Geyserville (Family: 6, Model: 8, Stepping: 3)
CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 0
Compiled for x86 CPU with extensions: MMX MMX2 SSE
get_path('codecs.conf') -> '/home/james/.mplayer/codecs.conf'
Reading /home/james/.mplayer/codecs.conf: Can't open '/home/james/.mplayer/codecs.conf': No such file or directory
Reading /etc/mplayer/codecs.conf: Can't open '/etc/mplayer/codecs.conf': No such file or directory
Using built-in default codecs.conf.
Configuration: --cc=i686-pc-linux-gnu-gcc --host-cc=i686-pc-linux-gnu-gcc --prefix=/usr --confdir=/etc/mplayer --datadir=/usr/share/mplayer --libdir=/usr/lib --enable-largefiles --enable-menu --enable-network --disable-tv-bsdbt848 --disable-faad-external --disable-fribidi --disable-enca --disable-ftp --disable-nemesi --disable-vstream --disable-libcdio --disable-cddb --disable-libdv --disable-x264 --disable-ass --charset=UTF-8 --disable-lirc --disable-lircc --disable-joystick --disable-inet6 --disable-unrarlib --disable-rtc --disable-smb --disable-tv --disable-tv-v4l1 --disable-tv-v4l2 --disable-radio --disable-radio-v4l2 --disable-radio-bsdbt848 --disable-dvb --disable-dvbhead --disable-tv-teletext --disable-pvr --disable-live --disable-musepack --disable-pnm --disable-speex --disable-tga --disable-theora --disable-xanim --disable-libamr_nb --disable-libamr_wb --disable-libdca --disable-liblzo --disable-twolame --disable-toolame --disable-real --enable-win32dll --disable-directfb --disable-ivtv --disable-ggi --disable-md5sum --disable-aa --disable-dga1 --disable-dga2 --disable-fbdev --disable-caca --disable-vidix-internal --disable-vidix-external --disable-zr --disable-gui --disable-xvmc --disable-3dfx --disable-tdfxvid --disable-tdfxfb --disable-arts --disable-jack --disable-nas --disable-3dnow --disable-3dnowext --disable-mmxext --disable-sse2 --disable-ssse3 --disable-altivec
CommandLine: '-v' 'HYC Final.mpg'
init_freetype
Using MMX (with tiny bit MMX2) Optimized OnScreenDisplay
Using nanosleep() timing
get_path('input.conf') -> '/home/james/.mplayer/input.conf'
Can't open input config file /home/james/.mplayer/input.conf: No such file or directory
Can't open input config file /etc/mplayer/input.conf: No such file or directory
Falling back on default (hardcoded) input config
get_path('HYC Final.mpg.conf') -> '/home/james/.mplayer/HYC Final.mpg.conf'

Playing HYC Final.mpg.
get_path('sub/') -> '/home/james/.mplayer/sub/'
[file] File size is 247562240 bytes
STREAM: [file] HYC Final.mpg
STREAM: Description: File
STREAM: Author: Albeu
STREAM: Comment: based on the code from ??? (probably Arpi)
LAVF_check: MPEG PS format
Checking for YUV4MPEG2
ASF_check: not ASF guid!
Checking for NuppelVideo
Checking for REAL
Checking for SMJPEG
Searching demuxer type for filename HYC Final.mpg ext: .mpg
Checking for Nullsoft Streaming Video
Checking for MOV
Checking for VIVO
header block 1 size: 0
AVS: avs_check_file - attempting to open file HYC Final.mpg
AVS: File is too big, aborting...
Checking for PVA
Checking for MPEG-TS...
TRIED UP TO POSITION 67863, FOUND 47, packet_size= 0, SEEMS A TS? 0
Checking for LMLM4 Stream Format
Invalid packet in LMLM4 stream: ch=0 size=1140851704
LMLM4 Stream Format not found
system stream synced at 0xD (13)!
==> Found video stream: 0
==> Found audio stream: 0
MPEG Stream reached EOF
ds_fill_buffer: EOF reached (stream: video)
MPEG-PS file format detected.
Searching for sequence header... OK!
VIDEO:  MPEG2  720x480  (aspect 2)  29.970 fps  7500.0 kbps (937.5 kbyte/s)
[V] filefmt:2  fourcc:0x10000002  size:720x480  fps:29.97  ftime:=0.0334
get_path('sub/') -> '/home/james/.mplayer/sub/'
X11 opening display:
vo: couldn't open the X11 display ()!
X11 opening display:
vo: couldn't open the X11 display ()!
VO XOverlay need a subdriver
[gl] using extended formats. Use -vo gl:nomanyfmts if playback fails.
[gl] Using 0 as slice height (0 means image height).
X11 opening display:
vo: couldn't open the X11 display ()!
X11 opening display:
vo: couldn't open the X11 display ()!
(no debugging symbols found)
(no debugging symbols found)
[VO_SDL] SDL initialization failed: No available video device.
VO: [v4l2] No such file or directory
==========================================================================
Opening video decoder: [mpegpes] MPEG 1/2 Video passthrough
VDec: vo config request - 720 x 480 (preferred colorspace: Mpeg PES)
Trying filter chain: vo
VDec: using Mpeg PES as output csp (no 0)
Movie-Aspect is undefined - no prescaling applied.
VO Config (720x480->720x480,flags=0,'MPlayer',0x4D504553)
VO: [null] 720x480 => 720x480 Mpeg PES
VO: Description: Null video output
VO: Author: Aaron Holtzman <aholtzma@ess.engr.uvic.ca>
Selected video codec: [mpegpes] vfm: mpegpes (MPEG-PES output (.mpg or DXR3/IVTV/DVB/V4L2 card))
==========================================================================
==========================================================================
Opening audio decoder: [mp3lib] MPEG layer-2, layer-3
dec_audio: Allocating 4608 + 65536 = 70144 bytes for output buffer.
mp3lib: using SSE optimized decore!
MP3lib: init layer2&3 finished, tables done
MPEG 1.0, Layer III, 48000 Hz 128 kbit Joint-Stereo, BPF: 384
Channels: 2, copyright: No, original: Yes, CRC: No, emphasis: 0
AUDIO: 48000 Hz, 2 ch, s16le, 128.0 kbit/8.33% (ratio: 16000->192000)
Selected audio codec: [mp3] afm: mp3lib (mp3lib MPEG layer-2, layer-3)
==========================================================================

Program received signal SIGILL, Illegal instruction.
0x08053dd1 in ?? ()
(gdb) x/8i $pc
0x8053dd1 <ftell@plt+8705>:     fisttpl 0x4(%esp)
0x8053dd5 <ftell@plt+8709>:     mov    %edx,(%esp)
0x8053dd8 <ftell@plt+8712>:     call   0x80a7662 <ftell@plt+350866>
0x8053ddd <ftell@plt+8717>:     test   %eax,%eax
0x8053ddf <ftell@plt+8719>:     je     0x8053fcd <ftell@plt+9213>
0x8053de5 <ftell@plt+8725>:     movl   $0x860c2a5,0x876ddd4
0x8053def <ftell@plt+8735>:     movl   $0x0,0x14(%esp)
0x8053df7 <ftell@plt+8743>:     mov    0x8748c08,%eax
(gdb) 




Comment 18


James





          2007-10-11 18:02:16 UTC
        

Odd, recompiling without mmxext got it working on one of my P3s (the one that I initially discovered the problem on and reported on), but I'm still fighting it on the other one...it is that one that the above trace comes from




Comment 19


James





          2007-10-11 18:18:20 UTC
        

Here's the Info for that system, it is a Dual-processor system with two video cards, but that has never caused problems in the past. Thanks for the help.

emerge --info
Portage 2.1.3.12 (!/usr/portage/profiles/default-linux/x86/2007.0/desktop, gcc-4.2.0, glibc-2.6.1-r0, 2.6.22-gentoo-r8 i686)
=================================================================
System uname: 2.6.22-gentoo-r8 i686 Pentium III (Coppermine)
Timestamp of tree: Thu, 11 Oct 2007 07:50:01 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p17-r1
dev-java/java-config: 1.3.7, 2.1.1
dev-lang/python:     2.4.4-r5, 2.5.1-r2
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.10-r5
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r2
ACCEPT_KEYWORDS="x86 ~x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=pentium3 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O2 -march=pentium3 -pipe"
DISTDIR="/mnt/nfs_portage/distfiles"
FEATURES="ccache distcc distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
MAKEOPTS="-j20"
PKGDIR="/mnt/nfs_portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/mnt/nfs_portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://192.168.1.1/gentoo-portage"
USE="X a52 aac acl acpi alsa audiofile berkdb bitmap-fonts bzip2 cairo cdparanoia cdr cli cracklib crypt cups dbus dri dvd dvdr dvdread eds emboss encode esd evo fam ffmpeg firefox fortran gdbm gif glitz gpm gstreamer hal iconv imagemagick isdnlog java jpeg kde kerberos ldap mad midi mikmod mmx mp3 mpeg mplayer mudflap mysql mythtv ncurses nls nptl nptlonly nsplugin nvidia ogg openal opengl openmp oss pam pcre pdf pdflib perl png pppd python qt3 qt3support quicktime readline reflection sdl session sockets spell spl sse ssl svg szip tcpd tiff truetype truetype-fonts type1-fonts unicode usb vcd vorbis win32codecs x x86 xine xinerama xml xorg xv xvid zlib" ALSA_CARDS="emu10k1" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="nvidia nv r128 vga vesa"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 20


Guilherme Amadio






          2007-10-12 01:58:37 UTC
        

(In reply to comment #15)
> Brand New build, without mmxext:
> 
> emerge -pv mplayer
> 
> These are the packages that would be merged, in order:
> 
> Calculating dependencies... done!
> [ebuild   R   ] media-video/mplayer-1.0_rc2  USE="X a52 aac alsa cdparanoia dvd
> encode esd gif iconv jpeg mad mmx mp3 openal opengl oss png quicktime sdl sse
> truetype unicode vorbis win32codecs xinerama xv xvid -3dnow -3dnowext -aalib
> (-altivec) -amrnb -amrwb -arts -bidi -bindist -bl -cddb -cdio -cpudetection
> -custom-cflags -debug -dga -directfb -doc -dts -dv -dvb -enca -fbcon -ftp -ggi
> -gtk -ipv6 -ivtv -jack -joystick -lame -libcaca -lirc -live -livecd -lzo
> -md5sum -mmxext -mp2 -musepack -nas -nemesi -pnm -pvr -radio -rar -real -rtc
> -samba -speex -srt -sse2 -ssse3 -svga -teletext -tga -theora -tivo -v4l -v4l2
> -vidix -x264 -xanim -xvmc -zoran" VIDEO_CARDS="vesa -mga -s3virge -tdfx" 0 kB
> 
> 
> 
> mplayer HYC\ Final.mpg
> MPlayer 1.0rc2-4.2.0 (C) 2000-2007 MPlayer Team
> CPU: Intel Celeron 2/Pentium III Coppermine,Geyserville (Family: 6, Model: 8,
> Stepping: 3)
> CPUflags:  MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 0
> Compiled for x86 CPU with extensions: MMX MMX2 SSE
>                                           ^^^^ 

Funny how your mplayer still reports it has the support for MMX2 enabled , though...





Comment 21


Alexis Ballier






          2007-10-12 18:44:55 UTC
        

could you please attach mplayer's configure.log when building a mplayer that fails with sigill ?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

