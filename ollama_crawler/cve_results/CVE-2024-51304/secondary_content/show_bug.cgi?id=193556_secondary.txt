Title: 193556 – display (from media-gfx/imagemagick-6.3.5.9) crashes x11-base/xorg-server-1.3.0.0
URL: https://bugs.gentoo.org/show_bug.cgi?id=193556

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 193556
display (from media-gfx/imagemagick-6.3.5.9) crashes x11-base/xorg-server-1.3.0.0
Last modified: 2007-11-05 21:05:25 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 193556 
      - display (from media-gfx/imagemagick-6.3.5.9) crashes x11-base/xorg-server-1.3.0.0


Summary:
display (from media-gfx/imagemagick-6.3.5.9) crashes x11-base/xorg-server-1.3...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-09-23 19:06 UTC by Evgeniy Dushistov





      Modified:
    
2007-11-05 21:05 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Evgeniy Dushistov





          2007-09-23 19:06:10 UTC
        

If run "display" utility from imagemagick package, xorg crashes.

Reproducible: Always




Portage 2.1.3.9 (default-linux/x86/2007.0/desktop, gcc-4.1.2, glibc-2.5-r4, 2.6.20-gentoo-r8 i686)
=================================================================
System uname: 2.6.20-gentoo-r8 i686 AMD Athlon(tm) XP 2600+
Timestamp of tree: Sat, 22 Sep 2007 16:00:01 +0000
app-shells/bash:     3.2_p17-r1
dev-java/java-config: 1.3.7, 2.0.33-r1
dev-lang/python:     2.3.5-r3, 2.4.4-r5
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.9-r2
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17-r1
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.21
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=athlon-xp -fomit-frame-pointer -mfpmath=sse -msse -mmmx -m3dnow -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="${NXDIR}/etc ${NXDIR}/home /etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O2 -march=athlon-xp -fomit-frame-pointer -mfpmath=sse -msse -mmmx -m3dnow -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="ru_RU.UTF-8"
LC_ALL=""
LDFLAGS="-Wl,-O1 -Wl,--sort-common"
LINGUAS="en ru"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/nx /usr/portage/local/layman/toolchain /usr/portage/local/layman/vmware /home/evgeniy/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow X acl acpi alsa apache2 arts bash-completion berkdb bitmap-fonts cairo cdr cjk cli cracklib crypt cups dbus dlloader doc dri dvd dvdr dvdread eds emacs emboss encode esd evo fam fbcon firefox font-server foomaticdb fortran gdbm gif gimpprint gpm gstreamer gtk hal iconv isdnlog jpeg kde kdeenablefinal kdexdeltas kerberos logrotate mad maildir mailwrapper mbox midi mikmod mmx mp3 mpeg mudflap ncurses nls nptl nptlonly ogg opengl openmp oss pam pch pcre pdf perl png ppds pppd python qt3 qt3support qt4 quicktime readline reflection sdl session spel spell spl sse ssl svg tcpd tiff truetype truetype-fonts type1 type1-fonts udev unicode usb vorbis win32codecs x86 xml xorg xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en ru" USERLAND="GNU" VIDEO_CARDS="nvidia fbdev vga vesa nv"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Evgeniy Dushistov





          2007-09-23 19:09:07 UTC
        

From Xorg log:
Backtrace:
0: X(xf86SigHandler+0x85) [0x80c10f5]

Fatal server error:
Caught signal 11.  Server aborting





Comment 2


Jakub Moc (RETIRED)






          2007-09-23 19:12:59 UTC
        

Well, not here, also you didn't tell us which imagemagick/xorg-server versions is this about, plus that backtrace is less than useful. 

http://www.gentoo.org/proj/en/qa/backtraces.xml




Comment 3


Evgeniy Dushistov





          2007-09-23 19:25:22 UTC
        

(In reply to comment #2)
> Well, not here, also you didn't tell us which imagemagick/xorg-server versions
> is this about

The imagemagick and xorg-server is lastest stable:
[I--] [  ] x11-base/xorg-server-1.3.0.0 (0)
[I--] [  ] x11-base/xorg-x11-7.2 (0)

[I--] [  ] media-gfx/imagemagick-6.3.5.9 (0)




Comment 4


Evgeniy Dushistov





          2007-09-23 19:42:47 UTC
        

(In reply to comment #2)
> is this about, plus that backtrace is less than useful. 
> 
> http://www.gentoo.org/proj/en/qa/backtraces.xml
> 

The crash happened after calling XLoadQueryFont:

Breakpoint 4, XBestFont (display=0x804e510, resource_info=0xbfdaf3dc,
    text_font=MagickFalse) at magick/xwindow.c:823
823         font_info=XLoadQueryFont(display,(char *) *p);

backtrace:
(gdb) bt
#0  XBestFont (display=0x804e510, resource_info=0xbfdaf3dc,
    text_font=MagickFalse) at magick/xwindow.c:823
#1  0xb7debba1 in XDisplayImage (display=0x804e510, resource_info=0xbfdaf3dc,
    argv=0x804e4d8, argc=1, image=0xbfdb04e8, state=0xbfdb04dc)
    at magick/display.c:14255
#2  0xb7ccba34 in DisplayImageCommand (image_info=0x8059910, argc=1,
    argv=0x804e4d8, wand_unused_metadata=0x0, exception=0x804a030)
    at wand/display.c:567
#3  0x080488f7 in main (argc=1, argv=0xbfdb06f4) at utilities/display.c:128
#4  0xb7afc86f in __libc_start_main () from /lib/libc.so.6





Comment 5


Alan Hourihane





          2007-09-24 09:32:30 UTC
        

Can you get a backtrace of Xorg ??




Comment 6


Evgeniy Dushistov





          2007-09-27 18:16:00 UTC
        

(In reply to comment #5)
> Can you get a backtrace of Xorg ??
> 

Actually, I do it in the second message, rebuild xorg-server with debug info not give a lot:

Backtrace:
0: X [0x80dcb56]
1: X(xf86SigHandler+0xa6) [0x80dcb02]
2: [0xb7f40420]

Fatal server error:
Caught signal 11.  Server aborting





Comment 7


Evgeniy Dushistov





          2007-09-29 16:47:22 UTC
        

I used advise from here:
http://xorg.freedesktop.org/wiki/Development/Documentation/ServerDebugging

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1211525456 (LWP 26429)]
0xb7eb2ee0 in ft_smooth_lcd_renderer_class () from /usr/lib/libfreetype.so.6
(gdb) Undefined command: "module".  Try "help".
(gdb) #0  0xb7eb2ee0 in ft_smooth_lcd_renderer_class ()
   from /usr/lib/libfreetype.so.6
#1  0xb7ecc289 in ?? () from /usr/lib/libXfont.so.1
#2  0x084de060 in ?? ()
#3  0x0000000c in ?? ()
#4  0x0000000c in ?? ()
#5  0x084df4c8 in ?? ()
#6  0x0000004b in ?? ()
#7  0xb7f44978 in ?? ()
#8  0x00000000 in ?? ()





Comment 8


Evgeniy Dushistov





          2007-09-29 16:52:43 UTC
        

I rebuild libXfont and freetype with debug info:
Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1211361616 (LWP 16890)]
0x00000000 in ?? ()
(gdb) Undefined command: "module".  Try "help".
(gdb) #0  0x00000000 in ?? ()
#1  0xb7f0d289 in ?? () from /usr/lib/libXfont.so.1
#2  0x084cdfb8 in ?? ()
#3  0x0000000c in ?? ()
#4  0x0000000c in ?? ()
#5  0x084dbbd8 in ?? ()
#6  0x0000004b in ?? ()
#7  0xb7ef4400 in ?? () from /usr/lib/libfreetype.so.6
#8  0xbfa0fdc8 in ?? ()
#9  0xb7ead4e0 in sfnt_get_interface (module=Cannot access memory at address 0x14
)   
    at /var/tmp/portage/media-libs/freetype-2.3.4-r2/work/freetype-2.3.4/src/sfnt/sfdriver.c:366
Backtrace stopped: previous frame inner to this frame (corrupt stack?)
(gdb) Continuing.

Program terminated with signal SIGSEGV, Segmentation fault.





Comment 9


Evgeniy Dushistov





          2007-11-05 21:05:25 UTC
        

Looks like that some gcc/binutils bug, 
because of now I can not reproduce problem after several rebuilds of xorg and imagemagic stuff.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

