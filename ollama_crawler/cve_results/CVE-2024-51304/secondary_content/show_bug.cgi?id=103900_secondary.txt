Title: 103900 – openvpn-2.0.1 (or 2.0) cannot use BF_CBC from dev-libs/openssl-0.9.7g
URL: https://bugs.gentoo.org/show_bug.cgi?id=103900

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 103900
openvpn-2.0.1 (or 2.0) cannot use BF_CBC from dev-libs/openssl-0.9.7g
Last modified: 2006-07-14 23:42:20 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 103900 
      - openvpn-2.0.1 (or 2.0) cannot use BF_CBC from dev-libs/openssl-0.9.7g


Summary:
openvpn-2.0.1 (or 2.0) cannot use BF_CBC from dev-libs/openssl-0.9.7g
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Roy Marples (RETIRED)








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

112865

      (view as bug list)
    


Depends on:




56708 138484



Blocks:







 

        Show dependency tree





 





      Reported:
    
2005-08-27 03:10 UTC by Yasha Davidov





      Modified:
    
2006-07-14 23:42 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



cazzeml
cnoss
harold
luckyduck









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Yasha Davidov





          2005-08-27 03:10:15 UTC
        

After updating openssl to 0.9.7g openvpn fails to start:
openvpn log:
Aug 27 13:51:42 [openvpn] OpenVPN 2.0.1 i686-pc-linux-gnu [SSL] [LZO] [EPOLL]
built on Aug 27 2005
Aug 27 13:51:42 [openvpn] Cipher algorithm 'BF-CBC' not found (OpenSSL)
Aug 27 13:51:42 [openvpn] Exiting

It cannot find BF-CBC
music ~ # openvpn --show-ciphers
The following ciphers and cipher modes are available
for use with OpenVPN.  Each cipher shown below may be
used as a parameter to the --cipher option.  The default
key size is shown as well as whether or not it can be
changed with the --keysize directive.  Using a CBC mode
is recommended.

DES-CBC 64 bit default key (fixed)
IDEA-CBC 128 bit default key (fixed)
RC2-CBC 128 bit default key (variable)
DES-EDE3-CBC 192 bit default key (fixed)
AES-128-CBC 128 bit default key (fixed)
AES-192-CBC 192 bit default key (fixed)
AES-256-CBC 256 bit default key (fixed)

But libssl seems to have BF-CBC
music ~ # strings /usr/lib/libssl.so.0.9.7  | grep BF
BF-CBC
BF-ECB
BF-CFB
BF-OFB
BFIPS_RAND_BYTES

I also have tried to recompile openvpn. Same results.
openssl-0.9.7e-r1 works fine.

The simmiliar problem was discoverd earlier with openssl 0.9.7d-r1 (see URL).

Reproducible: Always
Steps to Reproduce:
1. USE="~x86" emerge =dev-libs/openssl-0.9.7-r1
2. /etc/init.d/openvpn start
3.

Actual Results:  
Cipher algorithm 'BF-CBC' not found (OpenSSL)

Expected Results:  
openvpn should start

Portage 2.0.51.22-r2 (default-linux/x86/2005.0, gcc-3.3.5-20050130,
glibc-2.3.5-r1, 2.6.12-gentoo-r9-01 i686)
=================================================================
System uname: 2.6.12-gentoo-r9-01 i686 AMD Athlon(tm) XP 2200+
Gentoo Base System version 1.6.13
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
dev-lang/python:     2.3.5
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.5
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.18-r1
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=athlon-xp -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config
/usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/
/usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/
/usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=athlon-xp -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distcc distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://gentoo.chem.wisc.edu/gentoo"
LANG="ru_RU.koi8r"
LC_ALL="ru_RU.koi8r"
MAKEOPTS="-j4"
PKGDIR="/mnt/win_h/portage-pkg"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow 7zip X aac aalib acpi alsa apm avi bash-completion berkdb
bitmap-fonts bonobo bzip2 bzlib cdr cpdflib crypt cups curl divx doc dvd dvdr
dvdread eds emacs emboss encode ethereal exif fam firefox flac flash flatfile
fontserver foomaticdb fortran ftp gcj gd gdbm gif gimpprint gnome gpm gstreamer
gtk gtk2 gtkhtml guile hal iconv icq imagemagick imlib ipv6 jabber java jpeg
libg++ libwww mad mikmod ming mmx mmxext mng motif mozilla mozsvg mp3 mpeg mule
ncurses nls nptl ogg oggvorbis opengl oscar pam pcre pda pdflib perl php
plotutils plugin png pnp posix ppds python quicktime readline samba sdl sockets
spell sqlite sse ssl svg tcltk tcpd tetex theora tiff truetype truetype-fonts
type1-fonts usb vorbis wmf x xine xml xml2 xmms xosd xpm xv xvid zlib
userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LDFLAGS, LINGUAS




Comment 1


Roy Marples (RETIRED)






          2005-10-13 07:44:14 UTC
        

openvpn-2.0.2-r1 reports these ciphers are being emerged against openssl-0.9.7e-r2

DES-CBC 64 bit default key (fixed)
IDEA-CBC 128 bit default key (fixed)
RC2-CBC 128 bit default key (variable)
DES-EDE-CBC 128 bit default key (fixed)
DES-EDE3-CBC 192 bit default key (fixed)
DESX-CBC 192 bit default key (fixed)
BF-CBC 128 bit default key (variable)
RC2-40-CBC 40 bit default key (variable)
CAST5-CBC 128 bit default key (variable)
RC5-CBC 128 bit default key (variable)
RC2-64-CBC 64 bit default key (variable)
AES-128-CBC 128 bit default key (fixed)
AES-192-CBC 192 bit default key (fixed)
AES-256-CBC 256 bit default key (fixed)





Comment 2


Jakub Moc (RETIRED)






          2005-11-18 01:16:08 UTC
        

*** Bug 112865 has been marked as a duplicate of this bug. ***




Comment 3


Jakub Moc (RETIRED)






          2005-11-18 01:18:36 UTC
        

Reopen wrt Bug 112865. This bug is not about openssl-0.9.7e; it fails with >=0.9.7g




Comment 4


Roy Marples (RETIRED)






          2006-01-11 11:53:38 UTC
        

openvpn-2.0.5-r2 reports the correct ciphers built against openssl-0.9.7i




Comment 5


Clemens Noss





          2006-02-10 16:56:29 UTC
        

After I installed openssl-0.9.7i on both machines and restarted, openvpn-2.0.5-r2 was unable to connect.

I recompiled openvpn on the fast machine and got a smaller list of ciphers:

DES-CBC 64 bit default key (fixed)
IDEA-CBC 128 bit default key (fixed)
RC2-CBC 128 bit default key (variable)
DES-EDE3-CBC 192 bit default key (fixed)
AES-128-CBC 128 bit default key (fixed)
AES-192-CBC 192 bit default key (fixed)
AES-256-CBC 256 bit default key (fixed)

This version connects to the slow openvpn server successfully. The slow server still has the full list of ciphers.

I know this is not complete information, but my guess is that openvpn won't build blowfish against openssl-0.9.7i, and if compiled against an older openssl, its blowfish won't work with openssl-0.9.7i.

If you really BUILT openvpn-2.0.5 against openssl-0.9.7i and got all ciphers, there must be something else involved...




Comment 6


Clemens Noss





          2006-02-10 17:16:49 UTC
        

(In reply to comment #4)
> openvpn-2.0.5-r2 reports the correct ciphers built against openssl-0.9.7i
> 

Update: on a third machine, it works for me too (but I didn't try to connect)




Comment 7


Pierre Cassimans





          2006-03-21 14:34:56 UTC
        

I still have this bug

openvpn-2.0.5-r2 against openssl-0.9.7i missing the BF-CRC cipher

arch is x86

there was a work around on the forum that is didn't happen with 0.9.7e-r2 but the compile fails.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

