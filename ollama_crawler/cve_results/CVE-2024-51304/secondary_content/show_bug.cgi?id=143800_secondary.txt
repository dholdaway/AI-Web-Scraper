Title: 143800 – vim eclass tells user to enable bash completion for vim-core rather than xxd
URL: https://bugs.gentoo.org/show_bug.cgi?id=143800

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 143800
vim eclass tells user to enable bash completion for vim-core rather than xxd
Last modified: 2006-09-13 23:04:48 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 143800 
      - vim eclass tells user to enable bash completion for vim-core rather than xxd


Summary:
vim eclass tells user to enable bash completion for vim-core rather than xxd
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Eclasses

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       enhancement
      


Assignee:

Vim Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-08-13 10:44 UTC by Bo Ørsted Andresen (RETIRED)





      Modified:
    
2006-09-13 23:04 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



halcy0n









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




# emerge -va1 vim-core

              (vim-core.log,182.19 KB,
                text/plain)

            
2006-08-30 04:04 UTC,

            Bo Ørsted Andresen (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Bo Ørsted Andresen (RETIRED)






          2006-08-13 10:44:47 UTC
        

app-editors/vim-core includes a hex dumper called xxd for which it also includes bash completion. During postinst vim-core-6.4 (contrary to 7.0.17 which prints "eselect bashcomp enable xxd" as it should) prints:

"To enable command-line completion for vim-core, run:

  eselect bashcomp enable vim-core".
Gentoo Base System version 1.12.4
Portage 2.1-r2 (default-linux/x86/2006.0, gcc-3.4.6, glibc-2.3.6-r4, 2.6.16-suspend2-r8 i686)
=================================================================
System uname: 2.6.16-suspend2-r8 i686 Intel(R) Pentium(R) M processor 1600MHz
app-admin/eselect-compiler: [Not Present]
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium-m -O2 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/eselect/compiler /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=pentium-m -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg collision-protect distlocks fixpackages metadata-transfer parallel-fetch sandbox sfperms strict test userfetch userpriv"
GENTOO_MIRRORS="http://mirror.uni-c.dk/pub/gentoo http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo"
LC_ALL="en_GB.utf8"
LINGUAS="da en en_GB"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_EXTRA_OPTS="--timeout=60"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://zlin.dk/gentoo-portage"
USE="x86 X alsa apache2 apm arts avi bash-completion berkdb bitmap-fonts bzip2 cli crypt cups dlloader dri eds emboss encode esd foomaticdb fortran gdbm gif gnome gpm gstreamer gtk gtk2 imlib isdnlog jpeg kde libg++ libwww mad mikmod motif mp3 mpeg ncurses nls nptl nptlonly ogg opengl oss pam pcre pdflib perl png pppd python qt3 qt4 quicktime readline reflection sdl session spell spl ssl tcpd test truetype truetype-fonts type1-fonts udev vorbis xml xmms xorg xv zlib elibc_glibc input_devices_evdev input_devices_keyboard input_devices_mouse input_devices_synaptics input_devices_void kernel_linux linguas_da linguas_en linguas_en_GB userland_GNU video_cards_fbdev video_cards_fglrx video_cards_i810 video_cards_radeon video_cards_vesa"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LDFLAGS, PORTDIR_OVERLAY




Comment 1


Bo Ørsted Andresen (RETIRED)






          2006-08-13 10:49:06 UTC
        

Just to make it entirely clear:

# eselect bashcomp enable vim-core
!!! Error: /usr/share/bash-completion/vim-core doesn't exist
# eselect bashcomp enable xxd
# eselect bashcomp list
Available completions:
  [1]   xxd *





Comment 2


Mark Loeser (RETIRED)






          2006-08-29 21:19:05 UTC
        

When merging 6.4 like you said:

 * To enable command-line completion for vim-core, run:
 * 
 *   eselect bashcomp enable xxd


Could you check it again please?  I'm not seeing why it would do what you are getting at first glance.




Comment 3


Bo Ørsted Andresen (RETIRED)






          2006-08-30 04:04:55 UTC
        

Created attachment 95455 [details]
# emerge -va1 vim-core




Comment 4


Bo Ørsted Andresen (RETIRED)






          2006-08-30 04:09:36 UTC
        

Btw. that really should be an elog rather than an einfo.

# cat /var/log/portage/elog/app-editors\:vim-core-6.4\:20060830-105927.log
INFO: postinst
To enable command-line completion for vim-core, run:

  eselect bashcomp enable vim-core





Comment 5


Bo Ørsted Andresen (RETIRED)






          2006-08-30 12:18:30 UTC
        

I have a ~x86 laptop with portage-2.1.1_rc1-r1. On the same laptop I have an stable (x86) chroot with portage-2.1-r2. It turns out that this issue is occuring in the chroot for both of vim-core-{6.4,7.0.17} but it is not occuring outside of the chroot (using the same eclasses and ebuilds). Moreover upgrading to portage-2.1.1_rc1-r1 in the chroot resolves the issue. With portage-2.1-r2 it does install xxd correctly but only the postinst is wrong as shown above. So perhaps the issue is that BASH_COMPLETION_NAME is unset in postinst with that version of portage... If you have any questions please ask.




Comment 6


Bo Ørsted Andresen (RETIRED)






          2006-08-30 12:27:27 UTC
        

Also the issue occurs when doing:

# emerge --usepkg -va1 vim-core

both in and out of the chroot.




Comment 7


Mike Kelly (RETIRED)






          2006-09-13 23:04:48 UTC
        

Hmm, I'm not able to reproduce this either. Try building it again from scratch instead of using binary packages, as those may be messing up the cache of the eclass.

If you're still able to reproduce this, feel free to re-open this bug, but I can see no possible reason in the eclass that would cause this to happen for vim-core...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

