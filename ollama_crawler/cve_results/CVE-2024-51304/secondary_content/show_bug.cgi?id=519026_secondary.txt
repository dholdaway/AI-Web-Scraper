Title: 519026 – sys-fs/udiskie-1.1.1 fails to show notifications: ImportError: cannot import name Notify
URL: https://bugs.gentoo.org/show_bug.cgi?id=519026

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 519026
sys-fs/udiskie-1.1.1 fails to show notifications: ImportError: cannot import name Notify
Last modified: 2017-01-23 03:19:20 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 519026 
      - sys-fs/udiskie-1.1.1 fails to show notifications: ImportError: cannot import name Notify


Summary:
sys-fs/udiskie-1.1.1 fails to show notifications: ImportError: cannot import ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Desktop Misc. Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-08-04 14:02 UTC by thunderrd





      Modified:
    
2017-01-23 03:19 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



rzubaly









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


thunderrd





          2014-08-04 14:02:25 UTC
        

1.1.1 seems to mount and unmount properly, but the notifications are gone after this update. Reverting to 0.6.4 solves the problem, but pulls in dev-python/notify-python-0.1.1-r3.  Some googling revealed that udiskie-1.1.1 no longer depends on it, though.

The tty is niosy upon login with this message:

Could not find any typelib for Notify
Traceback (most recent call last):
File "/usr/lib/python-exec/python2.7/udiskie", line 9, in <module> 
	load_entry_point('udiskie==2', 'console_scripts', 'udiskie')()
File "/usr/lib64/python2.7/site-packages/udiskie/cli.py", line 204, in main
	return cls(argv).run()
File "/usr/lib64/python2.7/site-packages/udiskie/cli.py", line 178, in __init__
	self._init(config, options)
File "/usr/lib64/python2.7/site-packages/udiskie/cli.py", line 319, in _init
	from gi.repository import Notify
ImportError: cannot import name Notify

udiskie is being started from xinitrc with the following line:

# the following line starts dbus session, udiskie [for automounting removable media], then xmonad
exec ck-launch-session dbus-launch bash -c "udiskie -2 & /usr/bin/xmonad"






Reproducible: Always

Steps to Reproduce:
1.update udiskie-0.6.4 to 1.1.1
2.login
3.ctrl-alt-F1 to tty to view message



thunderrd@Q6600:~$ emerge --info
Portage 2.2.10_p39 (python 3.4.1-final-0, default/linux/amd64/13.0/desktop, gcc-4.8.3, glibc-2.19-r1, 3.14.3-ck x86_64)
=================================================================
System uname: Linux-3.14.3-ck-x86_64-Intel-R-_Core-TM-2_Quad_CPU_Q6600_@_2.40GHz-with-gentoo-2.2
KiB Mem:     6106136 total,   4313416 free
KiB Swap:    1060860 total,   1060860 free
Timestamp of tree: Mon, 04 Aug 2014 10:45:01 +0000
ld GNU ld (Gentoo 2.24 p1.4) 2.24
app-shells/bash:          4.2_p47
dev-java/java-config:     2.2.0
dev-lang/python:          2.7.8, 3.3.5-r1, 3.4.1
dev-util/cmake:           2.8.12.2-r1
dev-util/pkgconfig:       0.28-r2
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.12.4
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.11.6, 1.14.1
sys-devel/binutils:       2.24-r3
sys-devel/gcc:            4.8.3
sys-devel/gcc-config:     1.8
sys-devel/libtool:        2.4.2-r1
sys-devel/make:           4.0-r1
sys-kernel/linux-headers: 3.16 (virtual/os-headers)
sys-libs/glibc:           2.19-r1
Repositories: gentoo BZ-overlay
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=native -O2 -pipe"
DISTDIR="/mnt/ext3_STORAGE/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--quiet-build=n"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs collision-protect config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://gentoo.channelx.biz/ http://gentoo.mirrors.easynews.com/linux/gentoo/"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j4"
PKGDIR="/mnt/ext3_STORAGE/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_EXTRA_OPTS="--verbose --progress --exclude-from=/etc/portage/rsync_excludes"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/mnt/ext3_STORAGE/usr/portage"
PORTDIR_OVERLAY="/mnt/ext3_STORAGE/usr/local/portage"
SYNC="rsync://mirrors.kernel.org/gentoo-portage"
USE="X a52 aac acl acpi alsa amd64 branding bzip2 cairo cdda cdr cli consolekit cracklib crypt cups cxx dbus device-mapper directfb dri dts dvd dvdr emboss encode exif fam ffmpeg firefox flac fortran gdbm gif gnutls gpm gtk iconv ipv6 jack jpeg lcms ldap libnotify mad mmx mng modules mp3 mp4 mpeg multilib ncurses nls nptl offensive ogg opengl openmp pam pango pcre pdf png policykit ppds python qt3support qt4 readline samba sdl session spell sse sse2 ssh ssl startup-notification svg tcpd threads tiff truetype udev udisks unicode upower usb uuid vdpau vorbis wxwidgets x264 xcb xcomposite xfce xml xv xvid zlib" ABI_X86="32 64" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-5" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_3 python3_4" RUBY_TARGETS="ruby19 ruby20" USERLAND="GNU" VIDEO_CARDS="nvidia" XFCE_PLUGINS="trash" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
USE_PYTHON="2.7 3.3 3.4"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS




Comment 1


thunderrd





          2014-08-07 08:13:20 UTC
        

I took this question to the dev on github: https://github.com/coldfix/udiskie/issues/47

We seem to have found the issue.  To make matters short, My machine has USE="-introspection" globally, as I don't use gnome, only xmonad WM.  So libnotify is built without introspection.  When it is built this way, it does not provide the following two files:

/usr/lib64/girepository-1.0/Notify-0.7.typelib
/usr/share/gir-1.0/Notify-0.7.gir

Adding the introspection use flag in as a per-package flag in package.use solves the issue, allows the tray icon and the notifications, and eliminates the noisy tty messages.

Perhaps the ebuild should be adjusted to make libnotify (+introspection) a requirement if notifications are desired?  I may be in the minority with -introspection set globally, but people should have the choice in a case like this.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

