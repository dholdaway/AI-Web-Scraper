Title: 798684 – =net-fs/samba-4.13.9-r1: native build fails because cross compiler detected and used
URL: https://bugs.gentoo.org/show_bug.cgi?id=798684

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 798684
=net-fs/samba-4.13.9-r1: native build fails because cross compiler detected and used
Last modified: 2021-07-26 23:00:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 798684 
      - =net-fs/samba-4.13.9-r1: native build fails because cross compiler detected and used


Summary:
=net-fs/samba-4.13.9-r1: native build fails because cross compiler detected a...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo's SAMBA Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-06-25 10:29 UTC by m1027





      Modified:
    
2021-07-26 23:00 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



chris
ionen
mscardovi









See Also:


728368





Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,192.58 KB,
                text/plain)

            
2021-06-25 10:31 UTC,

            m1027




Details





emerge --info

              (emerge-info.txt,7.01 KB,
                text/plain)

            
2021-06-26 09:23 UTC,

            m1027




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


m1027





          2021-06-25 10:29:15 UTC
        

Updating from samba-4.13.9 to 4.13.9-r1 fails because during the normal build a cross-compiler is detected and in turn used for building...

See the build.log.

Same for 4.14.5-r1 here.

Hm...

Reproducible: Always




Comment 1


m1027





          2021-06-25 10:31:10 UTC
        

Created attachment 719232 [details]
build.log




Comment 2


Ionen Wolkens






          2021-06-26 06:45:09 UTC
        

Please attach output of `emerge --info` as well, I can't seem to reproduce despite having i686-w64-mingw32-gcc installed.




Comment 3


m1027





          2021-06-26 09:23:46 UTC
        

Created attachment 719400 [details]
emerge --info

Voila the output of emerge --info.

Thanks for investigating.




Comment 4


m1027





          2021-07-05 13:46:38 UTC
        

A temporary workaround is:

mv /usr/bin/i686-w64-mingw32-gcc /usr/bin/i686-w64-mingw32-gcc-DISABLED

Then emerge samba works. When undoing the workaround, emerge samba fails
again.

I just don't understand why the presence of a mingw32 cross-compiler has any
impact on building samba for the native linux amd64 host.




Comment 5


m1027





          2021-07-26 19:48:04 UTC
        

The issue disappeared.

What I did is: crossdev --clean i686-w64-mingw32 and then reinstalled the cross-compiler again. Obviously with newer binutils, gcc and libc versions then originally, most importantly probably using gcc 10.3 instead of 9.3.

After that emerge -a samba worked.

Maybe crossdev --clean fixed some things like dangling symlinks or so.

Note: I have half a dozen cross-compilers and just wiped the i686-w64-mingw32 temporarily.

So, while not actually knowing what caused the issue, I'd close this bug report.




Comment 6


Ionen Wolkens






          2021-07-26 23:00:38 UTC
        

Thanks for looking into it, if there's an issue I imagine it may be with what older crossdev did (and was kept around) and it's not really samba's problem.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

