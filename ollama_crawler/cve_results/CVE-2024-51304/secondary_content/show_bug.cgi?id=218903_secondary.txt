Title: 218903 – Ever since emerging vim, vim-core, and gvim emerge hangs at "Updating documentation tags"
URL: https://bugs.gentoo.org/show_bug.cgi?id=218903

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 218903
Ever since emerging vim, vim-core, and gvim emerge hangs at "Updating documentation tags"
Last modified: 2009-01-23 10:09:22 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 218903 
      - Ever since emerging vim, vim-core, and gvim emerge hangs at "Updating documentation tags"


Summary:
Ever since emerging vim, vim-core, and gvim emerge hangs at "Updating documen...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Vim Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-04-22 15:30 UTC by Peter Weilbacher





      Modified:
    
2009-01-23 10:09 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



gentoo
triffid_hunter









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Peter Weilbacher





          2008-04-22 15:30:27 UTC
        

A while ago I updated vim and related packages. The installation of one of the packages hung using 100% CPU for quite some time (10 min or so), so I killed the process using Ctrl-C.

Since then every installation using emerge outputs the lines pasted below and then hangs, using 100% CPU. I already waited once for half an hour or so and it never finished. I already tried to unmerging the old versions explicitely, but that had the same effect. Re-emerging the vim packages didn't help either.

Reproducible: Always

Steps to Reproduce:
1. emerge anything
2. just now I did 
   emerge -v ">=net-print/cups-1.2.12-r8" ">=net-www/netscape-flash-9.0.124.0"
Actual Results:  
Hangs after outputting
    * Updating documentation tags in //usr/share/vim/vim71
using all CPU power.

Expected Results:  
Not hang...

---------------------------------------------

The Output at the end, everything preceding this is always related to the package that I really emerged at the time.

>>> No packages selected for removal by clean
>>> Auto-cleaning packages...

 app-editors/gvim
    selected: 7.0.17 
   protected: 7.1.266 
     omitted: none 

 app-editors/vim
    selected: 7.0.17 
   protected: 7.1.266 
     omitted: none 

 app-editors/vim-core
    selected: 7.0.17 
   protected: 7.1.266 
     omitted: none 

>>> 'Selected' packages are slated for removal.
>>> 'Protected' and 'omitted' packages will not be removed.

>>> Unmerging app-editors/gvim-7.0.17...
No package files given... Grabbing a set.
--- replaced obj /usr/share/pixmaps/gvim.xpm
--- replaced dir /usr/share/pixmaps
--- replaced obj /usr/share/bash-completion/gvim
--- replaced dir /usr/share/bash-completion
--- replaced obj /usr/share/applications/gvim.desktop
--- replaced dir /usr/share/applications
--- replaced dir /usr/share
--- replaced sym /usr/bin/rgvim
--- replaced sym /usr/bin/rgview
--- replaced sym /usr/bin/gvimdiff
--- replaced obj /usr/bin/gvim
--- replaced sym /usr/bin/gview
--- replaced sym /usr/bin/evim
--- replaced sym /usr/bin/eview
--- replaced dir /usr/bin
--- replaced dir /usr
--- replaced obj /etc/vim/gvimrc
--- replaced dir /etc/vim
--- replaced dir /etc
 * Updating documentation tags in //usr/share/vim/vim71


----------------------------------------------------------------------

# emerge --info
Portage 2.1.4.4 (default-linux/x86/2006.1, gcc-4.1.2, glibc-2.5-r4, 2.6.22-suspend2-r1 i686)
=================================================================
System uname: 2.6.22-suspend2-r1 i686 Intel(R) Pentium(R) M processor 1.86GHz
Timestamp of tree: Tue, 22 Apr 2008 12:30:01 +0000
app-shells/bash:     3.2_p17
dev-java/java-config: 1.3.7, 2.0.33-r1
dev-lang/python:     2.4.4-r6
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.5-r2
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=i686 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O2 -march=i686 -pipe"
DISTDIR="/media/extra/tmp/distfiles"
FEATURES="distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://ftp.wh2.tu-dresden.de/pub/mirrors/gentoo ftp://ftp.tu-clausthal.de/pub/linux/gentoo ftp://ftp.rz.tu-bs.de/pub/mirror/ftp.gentoo.org/gentoo-distfiles http://distfiles.gentoo.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
LINGUAS="en de pl es"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/media/ubuntu/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dfx X a52 aac aalib acpi alsa bash-completion berkdb bzip2 cairo cddb cdr cli cracklib crypt cups dri dvd dvdread enblend esd exif ffmpeg firefox fortran gd gdbm gif gimpprint glitz gnome gnuplot gpm gstreamer gtk hal iconv ipv6 isdnlog jpeg lcms lm_sensors midi mmx mozbranding mp3 mpeg mudflap ncurses nls nptl nptlonly nsplugin ogg opengl openmp pam pcre pdf perl png ppds pppd python qt-static readline real reflection sdl session sift spl sse sse2 ssl svg tcpd theora threads tiff tk truetype unicode vim-pager vim-with-x vorbis win32codecs x264 x86 xorg xprint xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en de pl es" USERLAND="GNU" VIDEO_CARDS="radeon fglrx vesa"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, MAKEOPTS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


Peter Weilbacher





          2008-04-24 08:12:15 UTC
        

OK, a workaround for this is to remove the old vim directories in /var/db/pkg/app-editors/ by hand, i.e.

rm -rfv /var/db/pkg/app-editors/vim-core-7.0.17 /var/db/pkg/app-editors/vim-7.0.17 /var/db/pkg/app-editors/gvim-7.0.17

I have made a backup and I can recreate the bug by unpacking it again, so if someone wants to debug this (or tell me where to start debugging), I can make it happen again.




Comment 2


Achim Breunig





          2008-05-01 20:14:05 UTC
        

I had the same problem - and the workaround from Comment #1 worked for me.
Thanks for this tip.




Comment 3


Triffid Hunter





          2008-06-08 08:18:08 UTC
        

works for me too! hooray!




Comment 4


Chris Gottbrath





          2008-06-09 22:23:09 UTC
        

does anyone know what removing these files (the suggestion in comment #1) does?




Comment 5


Triffid Hunter





          2008-06-10 01:30:18 UTC
        

/var/db/pkg is where portage keeps metadata about installed ebuilds, so removing those dirs should be equivalent to emerge -avC vim vim-core which never completes due to this bug.




Comment 6


Kenneth Kalmer





          2008-06-30 21:44:19 UTC
        

(In reply to comment #1)
> rm -rfv /var/db/pkg/app-editors/vim-core-7.0.17
> /var/db/pkg/app-editors/vim-7.0.17 /var/db/pkg/app-editors/gvim-7.0.17

Thanks, this worked for me as well.




Comment 7


Peter Weilbacher





          2009-01-23 10:09:22 UTC
        

I have installed Gentoo on a new system which doesn't have this problem. So I cannot reproduce any more and cannot help with any more debugging. So I'm closing this bug.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

