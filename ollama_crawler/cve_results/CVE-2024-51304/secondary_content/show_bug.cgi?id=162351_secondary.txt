Title: 162351 – dev-libs/g-wrap-1.9.7 compile fails
URL: https://bugs.gentoo.org/show_bug.cgi?id=162351

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 162351
dev-libs/g-wrap-1.9.7 compile fails
Last modified: 2007-01-17 07:24:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 162351 
      - dev-libs/g-wrap-1.9.7 compile fails


Summary:
dev-libs/g-wrap-1.9.7 compile fails
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

AMD64 Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-01-16 13:04 UTC by Aris Basic





      Modified:
    
2007-01-17 07:24 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



scheme









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Aris Basic





          2007-01-16 13:04:10 UTC
        

when i try to build g-wrap 1.9.7 this is where build process stops
any idea ? 

x86_64-pc-linux-gnu-gcc -shared  .libs/core-runtime.o  /usr/lib64/pnet/../lib64/libffi.a  -march=athlon64 -momit-leaf-frame-poin
soname -Wl,libgwrap-core-runtime.so.1 -o .libs/libgwrap-core-runtime.so.1.0.0
/usr/lib/gcc/x86_64-pc-linux-gnu/4.1.1/../../../../x86_64-pc-linux-gnu/bin/ld: /usr/lib64/pnet/../lib64/libffi.a(prep_cif.o): re
R_X86_64_32 against `a local symbol' can not be used when making a shared object; recompile with -fPIC
/usr/lib64/pnet/../lib64/libffi.a: could not read symbols: Bad value
collect2: ld returned 1 exit status
make[3]: *** [libgwrap-core-runtime.la] Error 1
make[3]: Leaving directory `/var/tmp/portage/dev-libs/g-wrap-1.9.7/work/g-wrap-1.9.7/g-wrap'
make[2]: *** [all] Error 2
make[2]: Leaving directory `/var/tmp/portage/dev-libs/g-wrap-1.9.7/work/g-wrap-1.9.7/g-wrap'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/dev-libs/g-wrap-1.9.7/work/g-wrap-1.9.7'
make: *** [all] Error 2

!!! ERROR: dev-libs/g-wrap-1.9.7 failed.
Call stack:
  ebuild.sh, line 1618:   Called dyn_compile
  ebuild.sh, line 975:   Called qa_call 'src_compile'
  environment, line 1287:   Called src_compile
  ebuild.sh, line 649:   Called die

!!! emake failed
!!! If you need support, post the topmost build error, and the call stack if relevant.
!!! A complete build log is located at '/var/tmp/portage/dev-libs/g-wrap-1.9.7/temp/build.log'.


emerge info
Portage 2.1.2 (default-linux/amd64/2006.1/desktop, gcc-4.1.1, glibc-2.5-r0, 2.6.18-gentoo x86_64)
=================================================================
System uname: 2.6.18-gentoo x86_64 AMD Athlon(tm) 64 Processor 3400+
Gentoo Base System version 1.12.8
Timestamp of tree: Tue, 16 Jan 2007 03:00:01 +0000
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
dev-java/java-config: 1.3.7, 2.0.31-r2
dev-lang/python:     2.4.4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.19.2-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=athlon64 -fomit-frame-pointer -momit-leaf-frame-pointer -fweb -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /etc/tomcat5 /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib64/mozilla/defaults/pref /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O2 -march=athlon64 -fomit-frame-pointer -momit-leaf-frame-pointer -fweb -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer parallel-fetch sandbox sfperms strict"
GENTOO_MIRRORS="http://open-systems.ufl.edu/mirrors/gentoo http://mirror.tucdemonic.org/gentoo/ ftp://mirrors.tds.net/gentoo http://adelie.polymtl.ca/"
LANG="en_US.utf8"
LC_ALL="en_US.utf8"
LINGUAS="en_US en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi agg alsa amd64 apache2 avahi avi bash-completion berkdb bitmap-fonts branding bzip2 cairo canvas cdb cdda cddb cdparanoia cdr cli cracklib crypt cups curl cursors daap dba dbus divx4linux dlloader dri dts dv dvb dvd dvdr dvdread eds emboss encode esd exif faad fam fame ffmpeg firefox flac fortran freetype gd gdbm gdm gif gimpprint glib glitz glut gmail gmailtimestamps gnome gnutls gphoto2 gstreamer gstreamer010 gtk gtk1 gtk2 gtkhtml hal howl howl-compat httpd icons iconv icq id3 imagemagick imap ipod ipv6 isdnlog java joystick jp2k jpeg jpeg2k kde kdeenablefinal kdm kqemu lame libg++ lirc live lm_sensors lzo mad matroska mikmod mime mjpeg mng mod modplug mono mozdevelop mozsvg mozxmlterm mp3 mp4live mpeg mpeg2 mplayer msn multislot musicbrainz nas nautilus ncurses net network nls no_wxgtk1 noxmms nptl nptlonly nsplugin nvidia nvtv odbc ogg oggvorbis opengl openntpd oscar oss pam pcre pdf pear perl player png postgres ppds pppd ptpi python qmax qt qt3 qt4 quicktime rar rdesktop readline reflection rtc ruby samba scanner screen sdl server session shout skins smime speex spell spl sqlite ssl stream subtitles subversion svg tcpd tetex theora threads tiff truetype truetype-fonts type1-fonts udev unicode usb userlocales v4l v4l2 vcd vlm vorbis vorbisi widescreen wmf wxwindows xanim xcomposite xine xinerama xml xml2 xorg xosd xscreensaver xv xvid xvmc yahoo zeroconf zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LINGUAS="en_US en" USERLAND="GNU" VIDEO_CARDS="nvidia vesa nv"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Jakub Moc (RETIRED)






          2007-01-16 13:06:59 UTC
        

Kindly review http://bugs.gentoo.org/page.cgi?id=fields.html#bug_severity





Comment 2


Marijn Schouten (RETIRED)






          2007-01-16 13:23:02 UTC
        

It works here with guile-1.6.8, but I think you have that too. Could it be your CFLAGS? Could you retry without "-momit-leaf-frame-pointer -fweb" please?




Comment 3


Aris Basic





          2007-01-16 13:58:40 UTC
        

nope that did not help
yes i have guile 1.6.8 installed and an old g-wrap (1.3.4-r1) that stoped working or something (gnucash is not starting up anylonger)

it seams like it is trying to link against libffi for pnet instead the one that it has built for itself (at least im thinking it is having own libffi)

should i try unmerging old g-wrap ? (i was not able to remerge the old one either )





Comment 4


Marijn Schouten (RETIRED)






          2007-01-16 14:07:04 UTC
        

(In reply to comment #3)
> yes i have guile 1.6.8 installed and an old g-wrap (1.3.4-r1) that stoped
> working or something (gnucash is not starting up anylonger)

there are issues with slib-3.1.4 and gnucash (bug 162229)
 
> it seams like it is trying to link against libffi for pnet instead the one that
> it has built for itself (at least im thinking it is having own libffi)

Yes, it has it's own libffi too, but it should try to build against the external libffi.
 
> should i try unmerging old g-wrap ? (i was not able to remerge the old one
> either )

Yes, please try this.






Comment 5


Simon Stelling (RETIRED)






          2007-01-16 14:25:20 UTC
        

For some reason g-wrap tries to link (in a dynamic manner) against the static /usr/lib64/pnet/../lib64/libffi.a (= /usr/lib64/lib64/libffi.a), which doesn't make sense at all. Can you give us the output of equery f libffi? The libffi.so (and .a) should be in /usr/lib64/libffi.




Comment 6


Aris Basic





          2007-01-16 14:42:50 UTC
        

uninstalling did not help

seams like it is getting libffi from pnet instead the one from libffi package (my guess) :)

# equery f libffi
[ Searching for packages matching libffi... ]
* Contents of dev-libs/libffi-3.4.1:
/etc
/etc/env.d
/etc/env.d/99libffi
/usr
/usr/include
/usr/include/libffi
/usr/include/libffi/ffi.h
/usr/include/libffi/ffitarget.h
/usr/lib
/usr/lib64
/usr/lib64/libffi
/usr/lib64/libffi/libffi-2.00-beta.so
/usr/lib64/libffi/libffi.a
/usr/lib64/libffi/libffi.la
/usr/lib64/libffi/libffi.so -> libffi-2.00-beta.so





Comment 7


Aris Basic





          2007-01-16 14:44:54 UTC
        

yeha its not using he pnet one but just a std static version
but i can not find who si rpoviding that file libffi puts everything in libffi folder uder lib64 this file is directly in lib64





Comment 8


Aris Basic





          2007-01-16 15:06:09 UTC
        

because i coudlnt find out whom do those two files belong
(libffi.a and libffi.la [saying version 4.0.0 of libffi is in .a] )
I moved those 2 files out of the lib folder and now g-wrap builds fine.
dont know should we mark this resolved or needs more looked at ?





Comment 9


Aris Basic





          2007-01-16 15:08:49 UTC
        

actualy it seams like those 2 files where from g-wrap cause new g-wrap installed them on same place and is using version 4.0.0. but for some reson these files did not disapear on unmerge 





Comment 10


Simon Stelling (RETIRED)






          2007-01-17 07:24:47 UTC
        

i doubt there is anything we could do









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

