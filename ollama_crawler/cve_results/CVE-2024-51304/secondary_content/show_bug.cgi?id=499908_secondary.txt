Title: 499908 – net-wireless/bluez-5.12 - a2dp-sink profile connect failed: Protocol not available
URL: https://bugs.gentoo.org/show_bug.cgi?id=499908

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 499908
net-wireless/bluez-5.12 - a2dp-sink profile connect failed: Protocol not available
Last modified: 2014-07-22 19:41:11 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 499908 
      - net-wireless/bluez-5.12 - a2dp-sink profile connect failed: Protocol not available


Summary:
net-wireless/bluez-5.12 - a2dp-sink profile connect failed: Protocol not avai...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Pacho Ramos








URL:







Whiteboard:




Keywords:








Depends on:




500724



Blocks:







 

        Show dependency tree





 





      Reported:
    
2014-01-31 16:59 UTC by F. Delente





      Modified:
    
2014-07-22 19:41 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



adimanav5
ao
renegart









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


F. Delente





          2014-01-31 16:59:41 UTC
        

Hello.

BlueZ seems to have been updated from API 4 to 5 in the last days. I could connect my headset in A2DP mode correctly with BlueZ 4, but not anymore with BlueZ 5: when using bluetoothctl to test the connection, I get:

[bluetooth]# connect 00:18:91:D0:7A:24
Attempting to connect to 00:18:91:D0:7A:24
Failed to connect: org.bluez.Error.Failed

and /var/log/messages shows

Jan 30 18:15:15 smug bluetoothd[1390]: a2dp-sink profile connect failed for 00:18:91:D0:7A:24: Protocol not available




Comment 1


Aditya Iyer





          2014-02-04 01:12:56 UTC
        

I'm facing the same issue after upgrade from gnome-3.8 to gnome-3.10 which pulled in bluez-5. Things were working just fine with gnome-3.8 and bluez-4.




Comment 2


Pavel Volkov





          2014-02-05 18:23:48 UTC
        

Same problem with a headset here.




Comment 3


Pavel Volkov





          2014-02-05 18:26:02 UTC
        

The device is paired.
This is my asound.conf:

pcm.bluetooth {
        type bluetooth
        device "00:02:3C:31:96:12"
        profile "auto"
}




Comment 4


Pacho Ramos






          2014-02-09 09:12:02 UTC
        

Please retry with 5.14




Comment 5


Pavel Volkov





          2014-02-09 11:04:47 UTC
        

Still the same with 5.14:
 2月 09 15:01:54 melforce bluetoothd[12825]: a2dp-sink profile connect failed for 00:02:3C:31:96:12: Protocol not available




Comment 6


Pacho Ramos






          2014-02-09 11:36:37 UTC
        

Umm, this could be caused by we don't having a pulseaudio version compatible with bluez5




Comment 7


Pavel Volkov





          2014-02-09 12:01:57 UTC
        

I don't use PulseAudio, it must be something else




Comment 8


Pacho Ramos






          2014-02-09 12:10:36 UTC
        

Maybe mailing to upstream ML could help:
linux-bluetooth@vger.kernel.org




Comment 9


Pacho Ramos






          2014-02-09 22:21:09 UTC
        

I have seen in ML that you are using bluedevil, I guess you are using 2.0-rc version (since older are incompatible with bluez-5)




Comment 10


Pavel Volkov





          2014-02-09 23:06:03 UTC
        

Yes, 2.0_rc5 for Bluez 5 and 1.3.2 for Bluez 4.




Comment 11


Bernardo Costa





          2014-02-12 09:25:51 UTC
        

Got bit by this one too. I have only ALSA + .asoundrc:

pcm.bt {
  type plug
  slave {
    pcm {
      type bluetooth
      device 00:02:3C:29:61:5C
      profile "auto"
    }
  }
  hint {
    show on
    description "BT Speaker"
  }
}

ctl.bt {
  type bluetooth
}


Then, on trying to play with "mplayer -ao alsa:device=bt" I get:

alsa-lib: /var/tmp/portage/media-libs/alsa-lib-1.0.27.2/work/alsa-lib-1.0.27.2/src/dlmisc.c:252:(snd1_dlobj_cache_get) Cannot open shared library /usr/lib64/alsa-lib/libasound_module_pcm_bluetooth.so

This file existed in bluez-4, and no more in bluez-5. Recompiling alsa-lib does not help.




Comment 12


Pavel Volkov





          2014-02-20 06:02:51 UTC
        

After googling here and there I found out that audio socket API and ALSA plugin is removed and PulseAudio is the only choice.
I'll try it later.




Comment 13


Pacho Ramos






          2014-03-12 20:41:49 UTC
        

Were you able to make it work with pulseaudio? :|




Comment 14


Pavel Volkov





          2014-03-12 20:43:47 UTC
        

Yes




Comment 15


Pacho Ramos






          2014-03-12 20:47:45 UTC
        

Then, I guess we cannot do much more downstream as looks like upstream expects people to use pulseaudio for this with bluez-

Thanks for feedback




Comment 16


Sumit Khanna





          2014-03-27 22:16:05 UTC
        

I've run into this same issue, but I'm using PulseAudio (and was using it with the previous release). I never did get bluez+pulseaudio working with pulseaudio-4, so I had it masked as was using 2.x for the longest time.

This week I decided to do the big update and went up to pulseaudio-5.0, net-wireless/bluez-5.15. I uninstalled blueman and emerged bluedevil. But even when I just use the command line bluetoothctl and try to issue a connect for my A2DP headphones, I see the following in the logs:

Mar 28 10:45:55 [bluetoothd] a2dp-sink profile connect failed for 34:DF:2A:09:A5:D0: Protocol not available
Mar 28 10:46:01 [pulseaudio] [pulseaudio] bluez5-util.c: Properties changed in a device which information is unknown or invalid
                - Last output repeated twice -
Mar 28 10:48:47 [pulseaudio] [pulseaudio] bluez5-util.c: Properties changed in unknown device
Mar 28 10:48:47 [pulseaudio] [pulseaudio] bluez5-util.c: Properties changed in a device which information is unknown or invalid
Mar 28 10:48:47 [pulseaudio] [pulseaudio] bluez5-util.c: Properties changed in unknown adapter

I seem to be running the right versions of everything. What's going on?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

