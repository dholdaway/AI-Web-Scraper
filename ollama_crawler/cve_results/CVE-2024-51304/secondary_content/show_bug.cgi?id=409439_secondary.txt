Title: 409439 – =sys-fs/udev-182 does not create /dev/md* devices for raid
URL: https://bugs.gentoo.org/show_bug.cgi?id=409439

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 409439
=sys-fs/udev-182 does not create /dev/md* devices for raid
Last modified: 2012-03-23 17:50:59 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 409439 
      - =sys-fs/udev-182 does not create /dev/md* devices for raid


Summary:
=sys-fs/udev-182 does not create /dev/md* devices for raid
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

udev maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-03-23 12:49 UTC by Matthew Schultz





      Modified:
    
2012-03-23 17:50 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Matthew Schultz





          2012-03-23 12:49:10 UTC
        

I just upgraded to udev-182 yesterday and I noticed when I reboot my machine, none of my /dev/md* raid devices are created in /dev.  I do not use a separate /usr partition as the warning message mentioned when upgrading udev.  I'm not sure how to solve the problem.  I saw this in the changelog but I'm not sure if this relates to this problem and if so, how to fix it:

  /dev/disk/by-path/ links are no longer created for ATA devices behind
  an 'ATA transport class', the logic to extract predictable numbers does
  not exist in the kernel at this moment.
  /dev/disk/by-id/scsi-* compatibility links are no longer created for
  ATA devices, they have their own ata-* prefix.

Fortunately I was able to unmerge udev-init-scripts and downgrade udev to 171-r5 without issue.

Reproducible: Always

Steps to Reproduce:
1. Upgrade to udev-182 from udev-171-r5 with linux autodetect raid arrays for partitions.
2. Reboot the machine and watch how none of the /dev/md* devices are created.
Actual Results:  
None of the /dev/md* devices are created.

Expected Results:  
All of the /dev/md* devices should be created.

(after udev downgrade)

cat /proc/mdstat 
Personalities : [linear] [raid1] [multipath] 
md3 : active raid1 sdc1[1] sdb1[0]
      971683392 blocks [2/2] [UU]
      
md4 : active raid1 sdc2[1] sdb2[0]
      5076416 blocks [2/2] [UU]
      
md1 : active raid1 sdd2[1] sda2[0]
      979840 blocks [2/2] [UU]
      
md2 : active raid1 sdd3[1] sda3[0]
      145476480 blocks [2/2] [UU]
      
md0 : active raid1 sdd1[1] sda1[0]
      64128 blocks [2/2] [UU]
      
unused devices: <none>

emerge --info
Portage 2.1.10.49 (default/linux/amd64/10.0, gcc-4.5.3, glibc-2.13-r4, 3.3.0-gentoo x86_64)
=================================================================
System uname: Linux-3.3.0-gentoo-x86_64-AMD_Athlon-tm-_II_X4_615e_Processor-with-gentoo-2.1
Timestamp of tree: Wed, 21 Mar 2012 20:00:02 +0000
app-shells/bash:          4.2_p20
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.2-r3, 3.2.2
dev-util/cmake:           2.8.6-r4
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1
sys-apps/openrc:          0.9.9.3
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.9.6-r3, 1.11.1
sys-devel/binutils:       2.21.1-r1
sys-devel/gcc:            4.5.3-r2
sys-devel/gcc-config:     1.5-r2
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82-r1
sys-kernel/linux-headers: 3.1 (virtual/os-headers)
sys-libs/glibc:           2.13-r4
Repositories: gentoo sunrise mythtv x-portage
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=amdfam10 -O2 -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/openvpn/easy-rsa /var/bind /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=amdfam10 -O2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks ebuild-locks fixlafiles metadata-transfer news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch xattr"
FFLAGS=""
GENTOO_MIRRORS="http://gentoo.cites.uiuc.edu/pub/gentoo/ http://gentoo.mirrors.easynews.com/linux/gentoo/ http://mirror.phy.olemiss.edu/mirror/gentoo "
LANG="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en ru"
MAKEOPTS="-j6"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/sunrise /usr/local/mythtv_portage/Gentoo /usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac acl acpi alsa amd64 apache2 ass async audiofile avi bcmath berkdb bluetooth bzip2 cairo calendar caps cjk clamav cli consolekit cracklib crypt css ctype cups curl curlwrappers cxx dbus declarative deflate device-mapper dga dio directfb dri dts dvb dvd dvdread emu-linux-x86 enca encode exif fbcon ffmpeg fftw flac fortran ftp gd gdbm gif gimp gmp gnutls gpm gstreamer gtk gtk2 gzip hash hbci hddtemp iconv id3 idn ieee1394 imagemagick imlib innodb ipv6 ithreads jabber java javascript jpeg jpeg2k json kde kipi lcms libcaca libv4l live lm_sensors logrotate lzma lzo mad matroska mcal mhash mime mjpeg mms mmx mmxext mng modules mp3 mp4 mpeg mplayer msession mssql mudflap multilib mysql mysqli mythtv ncurses network nls nptl nptlonly nsplugin nvidia offensive ofx ogg openal opengl openmp openssl opensslcrypt oss pam pcntl pcre pdf pdo pear perl php png policykit posix ppds pppd pvr python qt qt3 qt3support qt4 quicktime readline reflection samba sasl sdl seamonkey semantic-desktop session simplexml smtp soap sockets spell spl sql sqlite sse sse2 ssl subversion suhosin svg sysfs syslog tcpd theora threads thumbnail tidy tiff tokenizer transcode truetype udev unicode urandom usb utempter v4l v4l2 vaapi vcd vhosts vorbis vpx wddx webkit wxwindows x264 xattr xcb xforms xine xinetd xml xml2 xorg xpm xprint xv xvid xvmc zip zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" APACHE2_MPMS="worker" CALLIGRA_FEATURES="kexi words flow plan stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en ru" PHP_TARGETS="php5-3 php5-4" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="radeonhd radeon r600 vesa fbdev v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Priit Laes (IRC: plaes)





          2012-03-23 15:06:07 UTC
        

Do you have 'devtmpfs' enabled in the kernel? If not, enable it and it should fix this issue.




Comment 2


Matthew Schultz





          2012-03-23 17:50:59 UTC
        

(In reply to comment #1)
> Do you have 'devtmpfs' enabled in the kernel? If not, enable it and it
> should fix this issue.

Oops.  I looked at the warning message when udev installed but I must have missed seeing the required CONFIG_DEVTMPFS flag error.  I also enabled CONFIG_DEVTMPFS_MOUNT as well just in case.  Everything seems to work now.  Thanks for the info.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

