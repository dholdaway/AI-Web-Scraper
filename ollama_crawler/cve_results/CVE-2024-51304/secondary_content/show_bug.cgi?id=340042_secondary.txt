Title: 340042 – sys-devel/crossdev-20100620: crossdev -s4 avr does not create avr-g++
URL: https://bugs.gentoo.org/show_bug.cgi?id=340042

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 340042
sys-devel/crossdev-20100620: crossdev -s4 avr does not create avr-g++
Last modified: 2013-02-14 02:33:57 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 340042 
      - sys-devel/crossdev-20100620: crossdev -s4 avr does not create avr-g++


Summary:
sys-devel/crossdev-20100620: crossdev -s4 avr does not create avr-g++
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Development

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-10-07 08:59 UTC by Shawn Rutledge





      Modified:
    
2013-02-14 02:33 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



chaujc
s
walch.martin
wyvern5









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




binutils

              (cross-avr-binutils.log,335 bytes,
                text/plain)

            
2010-10-07 20:55 UTC,

            Shawn Rutledge




Details





gcc-stage1

              (cross-avr-gcc-stage1.log,335 bytes,
                text/plain)

            
2010-10-07 20:55 UTC,

            Shawn Rutledge




Details





libc

              (cross-avr-avr-libc.log,335 bytes,
                text/plain)

            
2010-10-07 20:55 UTC,

            Shawn Rutledge




Details





stage2

              (cross-avr-gcc-stage2.log,335 bytes,
                text/plain)

            
2010-10-07 20:56 UTC,

            Shawn Rutledge




Details





info

              (cross-avr-info.log,17.91 KB,
                text/plain)

            
2010-10-07 20:56 UTC,

            Shawn Rutledge




Details





this time it failed (info)

              (cross-avr-info.log,17.87 KB,
                text/plain)

            
2010-10-07 21:38 UTC,

            Shawn Rutledge




Details





this time it failed (libc)

              (cross-avr-avr-libc.log,454.54 KB,
                text/plain)

            
2010-10-07 21:39 UTC,

            Shawn Rutledge




Details





cross-avr-avr-libc.log

              (cross-avr-avr-libc.log,63.90 KB,
                text/plain)

            
2011-10-21 10:15 UTC,

            Andrew Walker




Details





cross-avr-info.log

              (cross-avr-info.log,14.92 KB,
                text/plain)

            
2011-10-21 10:16 UTC,

            Andrew Walker




Details





Show
              Obsolete (4)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Shawn Rutledge





          2010-10-07 08:59:35 UTC
        

+++ This bug was initially created as a clone of Bug #286267 +++

arduino depends on avr-g++.  So I did

USE="-openmp" crossdev  -s4 avr

which goes fine but doesn't create avr-g++

Reproducible: Always


[i7][01:55:28 AM] emerge --info
Portage 2.1.8.3 (default/linux/amd64/10.0, gcc-4.3.4, glibc-2.11.2-r0, 2.6.33-gentoo x86_64)
=================================================================
System uname: Linux-2.6.33-gentoo-x86_64-Intel-R-_Core-TM-_i7_CPU_860_@_2.80GHz-with-gentoo-1.12.13
Timestamp of tree: Thu, 07 Oct 2010 07:30:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p37
dev-java/java-config: 2.1.11
dev-lang/python:     2.6.5-r3, 3.1.2-r4
dev-util/ccache:     2.4-r7
dev-util/cmake:      2.8.1-r2
sys-apps/baselayout: 1.12.13
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.4_p6-r1, 1.8.5-r4, 1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.3.4, 4.4.3-r2
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
sys-devel/make:      3.81
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64 -O2 -pipe -fno-ident -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/eselect/postgresql /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=athlon64 -O2 -pipe -fno-ident -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests buildpkg ccache distlocks fixpackages metadata-transfer news parallel-fetch protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en ru"
MAKEOPTS="-j6"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/science /usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="16bit 3dnow 3dnowext X a52 aac acct acl acpi alac alisp alsa amd64 amr amrnb amrwb ao apache2 assistant astribank audiofile autoipd automount autostart avahi bash-completion berkdb bidi bineditor bonjour bookmarks bzip2 cairo calendar cdb cdda cddb cdio cdparanoia cdr cleartype cli consolekit contactnotes cracklib crypt cups curl cxx daap dbus devhelp device-mapper dga dia dirac djvu docbook dot dri dssi dts dv dvb dvbplayer dvd dvdnav dvdr dvdread eckb1 ecmark ecmark2 ecmark3 ecmg2 ecoslec ecsteve ecsteve2 encode espeak excel exif expat fame fbcon fbdev festival ffmpeg fftw flac flite fortran fts3 fuse garmin gcj gd gdbm ggi gif gimp git glade glib glitz gnome gpgme gpm graphviz gs gstreamer gtk h323 hal handbook hddtemp heterogeneous howl howl-compat html httpd hybrid-auth hyperestraier iconv id3 id3tag idn image imagemagick imap imlib inkjar inotify ipod ipv6 irda jabber jack java6 jbig jfs jit jpeg jpeg2k kate kde konqueror kqemu ladspa lame laptop lash latex lcd lcms ldap libass libsamplerate libv4l2 lirc lircsettings live lm_sensors log4j lv2 lzo mad madwifi maps matroska mbox mbrola mdnsresponder-compat melt midi mikmod mjpeg mmx mmxext mng modplug modules mono mozdevelop mp2 mp3 mp3rtp mp4 mpeg mplayer mudflap multilib mysql nas ncurses nemesi net netjack network nls nntp nptl nptlonly nsplugin ntfs ntp nuv nxclient objc objc++ objc-gc ogg openal opengl openmp openstreetmap optimized-qmake oscar pam pcre pda pdf perl phonon php plotutils png pop portaudio posix postgres postproc postscript ppds pppd pri pulseaudio python qml qt3support qt4 qtscript quicktime quotes rar rdesktop readline realmedia reflection replaygain resolvconf romio rrdcgi rrdtool rss rtc rtf rtsp samba scanner schroedinger scripting sdl sdl-image sdl-sound sdlaudio sensord server session shorten shout sidebar skype slang slp smime smp smtp sndfile sockets soundtouch sourceview speex sql sqlite sqlite3 srt sse sse2 ssl startup-notification stream subtitles subversion svg swig sysfs tcpd teletext test-programs theora threads threadsafe thumbnail tiff timidity transcode transparent-proxy truetype twolame udev unicode upnp urandom usb v4l v4l2 vaapi vamp vcd vcdinfo vcdx vdpau vim-syntax vim-with-x visualization vlm vnc vorbis vpx watchdog webdav webkit wifi wmf wxwidgets x264 xanim xcb xext xface xfs xine xml xmlpatterns xorg xosd xscreensaver xv xvid xvmc yahoo yv12 zaptel zlib zvbi" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INITNG_PLUGINS="also bash_launcher chdir chroot conflict cpout critical ctrlaltdel daemon_clean debug_commands envparser find fmon fstat history idleprobe initctl interactive iparser last limit lockfile logfile netdev netprobe ngc4 ngcs nge pause provide reload renice rlparser simple_launcher stcmd stdout suid syncron syslog sysreq unneeded usplash" INPUT_DEVICES="evdev keyboard mouse wacom" KERNEL="linux" LCD_DEVICES="noritakevfd" LINGUAS="en ru" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="vesa v4l fbdev nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


SpanKY






          2010-10-07 20:12:34 UTC
        

works fine for me.  but you didnt post any of the logs that crossdev told you to.

# crossdev -C avr
# USE=-openmp crossdev avr
# avr-g++ --version
avr-g++ (Gentoo 4.5.1 p1.1, pie-0.4.5) 4.5.1




Comment 2


Shawn Rutledge





          2010-10-07 20:54:47 UTC
        

crossdev didn't _tell_ me to post any logs because it didn't fail.  It just didn't build avr-g++.  But here's some logs for you anyway.




Comment 3


Shawn Rutledge





          2010-10-07 20:55:27 UTC
        

Created attachment 249878 [details]
binutils




Comment 4


Shawn Rutledge





          2010-10-07 20:55:40 UTC
        

Created attachment 249880 [details]
gcc-stage1




Comment 5


Shawn Rutledge





          2010-10-07 20:55:56 UTC
        

Created attachment 249882 [details]
libc




Comment 6


Shawn Rutledge





          2010-10-07 20:56:05 UTC
        

Created attachment 249883 [details]
stage2




Comment 7


Shawn Rutledge





          2010-10-07 20:56:15 UTC
        

Created attachment 249884 [details]
info




Comment 8


Shawn Rutledge





          2010-10-07 20:57:59 UTC
        

Oops those are pretty useless because I tried to build repeatedly.  Will clean, rebuild and post again.




Comment 9


Shawn Rutledge





          2010-10-07 21:02:01 UTC
        

(In reply to comment #1)
> works fine for me.  but you didnt post any of the logs that crossdev told you
> to.
> 
> # crossdev -C avr
> # USE=-openmp crossdev avr
> # avr-g++ --version
> avr-g++ (Gentoo 4.5.1 p1.1, pie-0.4.5) 4.5.1

How did you end up with 4.5.1?  It's building 4.4.4 for me.  Is it dependent on your system gcc?

Are you on AMD64?





Comment 10


SpanKY






          2010-10-07 21:22:36 UTC
        

gcc ebuilds use the same file (toolchain.eclass), so there shouldnt be a difference.  host arch shouldnt matter either.




Comment 11


Shawn Rutledge





          2010-10-07 21:37:54 UTC
        

OK this time (trying the same command line as you did) I got an error:

[i7][01:58:45 PM] USE=-openmp crossdev avr
----------------------------------------------------------------------------------------------------------
 * crossdev version:      20100620
 * Host Portage ARCH:     amd64
 * Target Portage ARCH:   *
 * Target System:         avr
 * Stage:                 4 (C/C++ compiler)

 * binutils:              binutils-[latest]
 * gcc:                   gcc-[latest]
 * libc:                  avr-libc-[latest]

 * PORTDIR_OVERLAY:       /var/lib/layman/science
 * PORT_LOGDIR:           /var/log/portage
 * PKGDIR:                /usr/portage/packages/cross/avr
 * PORTAGE_TMPDIR:        /var/tmp/cross/avr
  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~ 
 * Forcing the latest versions of {binutils,gcc}-config/gnuconfig ...                               [ ok ]
 * Log: /var/log/portage/cross-avr-binutils.log
 * Emerging cross-binutils ...                                                                      [ ok ]
 * Log: /var/log/portage/cross-avr-gcc-stage1.log
 * Emerging cross-gcc-stage1 ...                                                                    [ ok ]
 * Log: /var/log/portage/cross-avr-avr-libc.log
 * Emerging cross-avr-libc ...

 * avr-libc failed :(
 * If you file a bug, please attach the following logfiles:
 * /var/log/portage/cross-avr-info.log
 * /var/log/portage/cross-avr-avr-libc.log

But I'm sure I can also reproduce the case where it doesn't fail, but doesn't produce g++ either.  Will attach logs for this round.





Comment 12


Shawn Rutledge





          2010-10-07 21:38:47 UTC
        

Created attachment 249889 [details]
this time it failed (info)




Comment 13


Shawn Rutledge





          2010-10-07 21:39:04 UTC
        

Created attachment 249890 [details]
this time it failed (libc)




Comment 14


Shawn Rutledge





          2010-10-07 21:54:15 UTC
        

Well it made a liar out of me and built avr-g++ this time.  

[i7][02:39:32 PM] USE="-openmp" crossdev -t avr -s4 -S --without-headers
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 * crossdev version:      20100620
 * Host Portage ARCH:     amd64
 * Target Portage ARCH:   *
 * Target System:         avr
 * Stage:                 4 (C/C++ compiler)

 * binutils:              binutils-[stable]
 * gcc:                   gcc-[stable]
 * libc:                  avr-libc-[stable]

 * PORTDIR_OVERLAY:       /var/lib/layman/science
 * PORT_LOGDIR:           /var/log/portage
 * PKGDIR:                /usr/portage/packages/cross/avr
 * PORTAGE_TMPDIR:        /var/tmp/cross/avr
  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _
 * Forcing the latest versions of {binutils,gcc}-config/gnuconfig ...                                                                                                [ ok ]
 * Log: /var/log/portage/cross-avr-binutils.log
 * Emerging cross-binutils ...                                                                                                                                       [ ok ]
 * Log: /var/log/portage/cross-avr-gcc-stage1.log
 * Emerging cross-gcc-stage1 ...                                                                                                                                     [ ok ]
 * Log: /var/log/portage/cross-avr-avr-libc.log
 * Emerging cross-avr-libc ...                                                                                                                                       [ ok ]
 * Log: /var/log/portage/cross-avr-gcc-stage2.log
 * Emerging cross-gcc-stage2 ...                                                                                                                                     [ ok ]

So all I can say is that IF I have done a clean first, and IF I use that exact command line, it can work.  Whereas leaving it to the defaults does not work.  And besides that, there is still the need for the -openmp USE flag, which ought to be defaulted in the ebuild (but I think that's been reported already as another bug).  So it still seems to me a bug that it didn't just work the first time, but at least I finally got an avr-g++ after so many attempts.





Comment 15


SpanKY






          2010-10-08 02:06:45 UTC
        

np.  glad it worked for you.




Comment 16


Andrew Walker





          2011-10-21 10:15:30 UTC
        

Created attachment 290443 [details]
cross-avr-avr-libc.log

My cross-avr-avr-libc.log log file




Comment 17


Andrew Walker





          2011-10-21 10:16:43 UTC
        

Created attachment 290445 [details]
cross-avr-info.log

cross-avr-info.log log file




Comment 18


Andrew Walker





          2011-10-21 10:18:38 UTC
        

I'm having a similar problem. I've attached my log files, the relevant part seems to be this

/var/tmp/portage/cross-avr/avr-libc-1.6.2/temp/ccLj5rr8.s: Assembler messages:
/var/tmp/portage/cross-avr/avr-libc-1.6.2/temp/ccLj5rr8.s: Error: .size expression for strlcat_P does not evaluate to a constant
avr-gcc -I/var/tmp/portage/cross-avr/avr-libc-1.6.2/work/avr-libc-1.6.2/common -I/var/tmp/portage/cross-avr/avr-libc-1.6.2/work/avr-libc-1.6.2/include -x assembler-with-cpp -Wa,-gstabs -mmcu=avr2 -D__COMPILING_AVR_LIBC__   -c /var/tmp/portage/cross-avr/avr-libc-1.6.2/work/avr-libc-1.6.2/libc/pmstring/strlen_P.S
make[5]: *** [strlcat_P.o] Error 1




Comment 19


wuos





          2011-12-23 17:12:30 UTC
        

Andrew: Don't  know why it fails, but three days ago I've trying to connect my arduino to my gentoo and I had exacly the same problem

try avr-libc-1.7.0









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

