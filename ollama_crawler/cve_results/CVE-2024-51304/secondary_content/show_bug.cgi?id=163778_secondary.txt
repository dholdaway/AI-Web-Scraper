Title: 163778 – Stupid netfilter hardcoded path in iproute2 sources
URL: https://bugs.gentoo.org/show_bug.cgi?id=163778

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 163778
Stupid netfilter hardcoded path in iproute2 sources
Last modified: 2007-01-25 21:04:13 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 163778 
      - Stupid netfilter hardcoded path in iproute2 sources


Summary:
Stupid netfilter hardcoded path in iproute2 sources
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-01-25 17:26 UTC by lkml_ccc





      Modified:
    
2007-01-25 21:04 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


lkml_ccc





          2007-01-25 17:26:55 UTC
        

TC is unable to find shared iptables libs. Iptables actions
won't work.
This is because they are searched in the wrong place. Solution:
change
./iproute2-2.6.16-060323/tc/m_ipt.c  at line 51
 from hardcoded path
#define IPT_LIB_DIR "/usr/local/lib/iptables"
to
#define IPT_LIB_DIR "/usr/lib/iptables"

Reproducible: Always

Steps to Reproduce:
1.Just follow the typical usage howto: http://linux-net.osdl.org/index.php/IFB
2.
3.




Comment 1


lkml_ccc





          2007-01-25 17:44:08 UTC
        

I have to add that it's the same on all ebuild:
iproute2-2.6.19-061214 too.






Comment 2


lkml_ccc





          2007-01-25 18:28:15 UTC
        

> This is because they are searched in the wrong place. Solution:
> change
> ./iproute2-2.6.16-060323/tc/m_ipt.c  at line 51
>  from hardcoded path
> #define IPT_LIB_DIR "/usr/local/lib/iptables"
> to
> #define IPT_LIB_DIR "/usr/lib/iptables"

OOps sorry, gentoo path is /lib/iptables !





Comment 3


lkml_ccc





          2007-01-25 18:40:11 UTC
        

After further investigation I found that this SHOULD be solved yet, but
it isn't!

> OOps sorry, gentoo path is /lib/iptables !
# Use correct iptables dir, #144265.
sed -i "s:/usr/local/lib/iptables:/$(get_libdir)/iptables:g" \
       include/iptables.h

/sbin/tc filter add dev eth1 parent ffff: protocol ip prio 10 u32   match u32 0 0 flowid 1:1   action ipt -j MARK --set-mark 1   action mirred egress redirect dev ifb0

/usr/lib/iptables/libipt_mark.so: cannot open shared object file: No such file or directory
 failed to find target MARK

Do I need to rebuild iproute2? I will try
 






Comment 4


lkml_ccc





          2007-01-25 19:31:41 UTC
        

(In reply to comment #3) 
> Do I need to rebuild iproute2? I will try

No, that does not help.




Comment 5


Jakub Moc (RETIRED)






          2007-01-25 21:04:13 UTC
        

Reopen if you have problems w/ >=2.6.18.20061002









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

