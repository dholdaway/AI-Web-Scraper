Title: 153177 – qmail doesn't remove delivered messages from the queue unless they contain a From line
URL: https://bugs.gentoo.org/show_bug.cgi?id=153177

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 153177
qmail doesn't remove delivered messages from the queue unless they contain a From line
Last modified: 2006-10-29 01:56:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 153177 
      - qmail doesn't remove delivered messages from the queue unless they contain a From line


Summary:
qmail doesn't remove delivered messages from the queue unless they contain a ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

Qmail Team (OBSOLETE)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-10-28 13:34 UTC by Christoph Bussenius





      Modified:
    
2006-10-29 01:56 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Christoph Bussenius





          2006-10-28 13:34:37 UTC
        

When qmail successfully delivers a specially crafted message to the local machine, it does not remove the message from the queue.  This results into frequent redeliveries of the  message, so you find many duplicates in your mailbox.

I could reproduce this for messages which do not contain a "From" line in the header:

echo -e 'HELO localhost
MAIL FROM: <pepe@localhost>
RCPT TO: <pepe@localhost>
DATA
Subject: Bug Test\r
To: <pepe@localhost>\r
\r
Test.\r
.\r
QUIT' | nc localhost 25

The log (/var/log/qmail/qmail-send/current) contains:

@400000004543b8bf28059524 info msg 415599: bytes 208 from <pepe@localhost> qp 6961 uid 201
@400000004543b8bf2ce8548c starting delivery 13: msg 415599 to local pepe@localhost
@400000004543b8bf2ceb5de4 status: local 1/10 remote 0/20
@400000004543b8bf33c063e4 delivery 13: deferral:

So qmail seems to treat those deliveries as deferred.

The content of my .qmail file is simply "./Maildir/".

The ebuild is mail-mta/qmail-1.03-r16.  I could not reproduce this on a Debian system using qmail-1.03-24.  I've not tested netqmail yet.

emerge --info:

Portage 2.1.2_rc1 (default-linux/x86/2006.0, gcc-3.4.3-20050110, glibc-2.3.4.20050125-r0, 2.6.13.1 i686)
=================================================================
System uname: 2.6.13.1 i686 AMD-K7(tm) Processor
Gentoo Base System version 1.12.1
Last Sync: Sat, 28 Oct 2006 04:50:01 +0000
distcc 2.17 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [disabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.2.6
dev-lang/python:     2.3.5
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r2
sys-devel/gcc-config: 1.3.10-r2
sys-devel/libtool:   1.5.18
virtual/os-headers:  2.6.11-r5
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -fomit-frame-pointer -march=i686 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.2/share/config /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/lib/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/bind /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/terminfo"
CXXFLAGS="-O3 -fomit-frame-pointer -march=i686 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig candy distlocks metadata-transfer prallel-fetch sandbox sfperms strict urgs userpriv usersandbox"
GENTOO_MIRRORS="ftp://ftp.fu-berlin.de/linux/gentoo ftp://ftp.uni-erlangen.de/pub/mirrors/gentoo"
LC_ALL="en_US.ISO8859-1"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 3dfx 3dnow X Xaw3d aalib acpi alsa apache2 apm arts avi bash-completion berkdb bitmap-fonts bzip2 cdr cli cracklib crypt cscope curl dedicated dga directfb dlloader doc dri eds elibc_glibc emboss encode esd fbcon foomaticdb gd gdbm ggi gif gpm gs gstreamer gtk gtk2 iconv icq imap imlib input_devices_evdev input_devices_keyboard input_devices_mouse ipv6 isdnlog jabber java jikes jpeg kernel_linux libcaca libg++ libwww mad maildir matroska mbox mikmod mmx motif mozilla mp3 mpeg msn mysql nas ncurses nptl nvidia ogg oggvorbis opengl oss pam pcre pdflib perl png postgres pppd python qt qt3 qt4 quicktime readline reflection ruby sdl session slang smime spell spl sse ssl svga tcpd tetex threads tiff truetype truetype-fonts type1-fonts udev unicode urandom usb userland_GNU video_cards_apm video_cards_ark video_cards_ati video_cards_chips video_cards_cirrus video_cards_cyrix video_cards_dummy video_cards_fbdev video_cards_glint video_cards_i128 video_cards_i740 video_cards_i810 video_cards_imstt video_cards_mga video_cards_neomagic video_cards_nsc video_cards_nv video_cards_rendition video_cards_s3 video_cards_s3virge video_cards_savage video_cards_siliconmotion video_cards_sis video_cards_sisusb video_cards_tdfx video_cards_tga video_cards_trident video_cards_tseng video_cards_v4l video_cards_vesa video_cards_vga video_cards_via video_cards_vmware video_cards_voodoo vim-with-x vorbis wmf xml xml2 xorg xosd xv xvid yahoo zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Michael Hanselmann (hansmi) (RETIRED)






          2006-10-29 01:56:16 UTC
        

qmail doesn't parse the message content. Works for me (tested!). This must be something in your setup.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

