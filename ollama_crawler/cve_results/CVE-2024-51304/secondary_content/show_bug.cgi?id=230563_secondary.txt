Title: 230563 – x11-libs/qt-4.4.0 - Qt designer segfaults
URL: https://bugs.gentoo.org/show_bug.cgi?id=230563

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 230563
x11-libs/qt-4.4.0 - Qt designer segfaults
Last modified: 2008-09-19 13:34:18 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 230563 
      - x11-libs/qt-4.4.0 - Qt designer segfaults


Summary:
x11-libs/qt-4.4.0 - Qt designer segfaults
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Development

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Qt Bug Alias








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-07-02 19:23 UTC by Matteo Sasso





      Modified:
    
2008-09-19 13:34 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



gapon
superfastgentoo
unnamedrambler









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emergeinfo,10.36 KB,
                text/plain)

            
2008-07-02 19:37 UTC,

            Matteo Sasso




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Matteo Sasso





          2008-07-02 19:23:04 UTC
        

No error messages. The startup splash is not displayed.
Do you need a backtrace (might take a while)? If I want to compile a debug version is it sufficient to set the debug use flag or I need to modify CFLAGS too?
Can you replicate this bug or is it me?

Reproducible: Always

Steps to Reproduce:
1. Run /usr/bin/designer


Actual Results:  
...
clock_gettime(CLOCK_MONOTONIC, {98646, 436839322}) = 0
write(7, "\233\24\31\0\4\0 \3\1\0\0\0\32\0\0\0\5\0\t\0\377\377\t\0\7\0\0\0\0\377\377\377"..., 2896) = 2896
read(7, "\1\1?\1\0\0\0\0e\0\0\0X\0 \1[\1P\1[\1P\1\20\0 \10Pa\365\257", 32) = 32
brk(0x9816000)                          = 0x9816000
brk(0x9837000)                          = 0x9837000
clock_gettime(CLOCK_MONOTONIC, {98646, 450415728}) = 0
brk(0x9858000)                          = 0x9858000
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV +++


Expected Results:  
Well...




Comment 1


Matteo Sasso





          2008-07-02 19:37:30 UTC
        

Created attachment 159365 [details]
emerge --info




Comment 2


unnamedrambler





          2008-07-02 19:49:50 UTC
        

I'm having a similiar issue but I'm getting SIGABRT instead:

Results:
$ /usr/bin/designer
Aborted

emerge --info
Portage 2.2_rc1 (default-linux/x86/2007.0, gcc-4.3.1, glibc-2.6.1-r0, 2.6.25-tuxonice-r4 i686)                                                                                                         
=================================================================                                                                                                                                      
System uname: Linux-2.6.25-tuxonice-r4-i686-Intel-R-_Core-TM-_Duo_CPU_T2700_@_2.33GHz-with-glibc2.0                                                                                                    
Timestamp of tree: Sun, 22 Jun 2008 10:15:01 +0000                                                                                                                                                     
app-shells/bash:     3.2_p39
dev-java/java-config: 1.3.7, 2.1.4
dev-lang/python:     2.4.4-r7, 2.5.2-r4
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 2.0.0
sys-apps/openrc:     0.2.4-r1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.62
sys-devel/automake:  1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.1-r1
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.25-r3
ACCEPT_KEYWORDS="x86 ~x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=i686 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O2 -march=i686 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks nostrip parallel-fetch preserve-libs sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://mirror.cc.vt.edu/pub/gentoo"
LANG="en_US.UTF-8"
LDFLAGS=""
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/minefield /usr/portage/local/layman/sunrise /usr/portage/local/layman/gentopia /usr/portage/local/layman/xeffects /usr/portage/local/layman/arcon /usr/portage/local/layman/kdesvn-portage /usr/local/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="X aac aalib acl alsa arts bash-completion berkdb bluetooth cairo cddb cdparanoia cdr cli cpudetection cracklib crypt cups dbs dbus dri dv dvd dvdnav dvdr encode ffmpeg firefox flac fortran freetype gdbm gif gpm hal iconv ipv6 isdnlog jpeg kde ldap libnotify mad midi mmx mono mp3 mp4 mpeg mudflap ncurses nls nptl nptlonly nsplugin ogg opengl openmp pam pcre perl png pppd python qt3 qt4 quicktime rar readline real reflection samba session spell spl sse sse2 ssl svga tcpd tiff tk truetype unicode v4l vidix vim-syntax vorbis win32codecs x86 xorg xv xvid zlib" ALSA_CARDS="hda-intel usb-audio" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev synaptics wacom" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="nv nvidia vesa"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 3


Carsten Lohrke (RETIRED)






          2008-07-02 22:54:58 UTC
        

The debug use flag triggers debug functionality in build scripts, which usually should be special code paths, additional error messages etc.. Please read 

http://www.gentoo.org/proj/en/qa/backtraces.xml

how to provide a meaningful backtrace.




Comment 4


unnamedrambler





          2008-07-03 00:56:42 UTC
        

backtrace:
(gdb) bt
#0  0xffffe424 in __kernel_vsyscall ()
#1  0xb676f525 in raise () from /lib/libc.so.6
#2  0xb6770d41 in abort () from /lib/libc.so.6
#3  0xb67ab76b in malloc_printerr () from /lib/libc.so.6
#4  0xb67ad3a5 in free () from /lib/libc.so.6
#5  0xb6960d51 in operator delete () from /usr/lib/gcc/i686-pc-linux-gnu/4.3.1/libstdc++.so.6
#6  0xb748a7a5 in ~QAbstractScrollAreaPrivate (this=0x8d4e478) at widgets/qabstractscrollarea_p.h:68
#7  0xb6b31695 in ~QObject (this=0x8d4e3a8) at kernel/qobject.cpp:890
#8  0xb708c474 in ~QWidget (this=0x8d4e3a8) at kernel/qwidget.cpp:1346
#9  0xb73ec5a1 in ~QFrame (this=0x8d4e3a8) at widgets/qframe.cpp:244
#10 0xb748833d in ~QAbstractScrollArea (this=0x8d4e3a8) at widgets/qabstractscrollarea.cpp:484
#11 0xb629345b in QsciScintillaBase::~QsciScintillaBase () from /usr/lib/qt4/plugins/designer/libqscintillaplugin.so
#12 0xb62914d9 in QsciScintilla::~QsciScintilla () from /usr/lib/qt4/plugins/designer/libqscintillaplugin.so
#13 0xb7b87b44 in qdesigner_internal::WidgetDataBase::defaultPropertyValues (this=0x89a98e0, name=@0xbf846ae4) at shared/widgetdatabase.cpp:503
#14 0xb7b87f1e in qdesigner_internal::WidgetDataBase::grabDefaultPropertyValues (this=0x89a98e0) at shared/widgetdatabase.cpp:512
#15 0xb7b4ebba in qdesigner_internal::QDesignerIntegration::initializePlugins (formEditor=0x8994068) at shared/qdesigner_integration.cpp:378
#16 0xb7cefcbd in QDesignerComponents::initializePlugins (core=0x8994068) at qdesigner_components.cpp:143
#17 0x0807bae0 in QDesignerWorkbench::initialize (this=0x8a00568) at qdesigner_workbench.cpp:305
#18 0x0808067b in QDesignerWorkbench (this=0x8a00568) at qdesigner_workbench.cpp:195
#19 0x08074e46 in QDesigner::initialize (this=0xbf846eb4) at qdesigner.cpp:214
#20 0x08075503 in QDesigner (this=0xbf846eb4, argc=@0xbf846f00, argv=0xbf846f84) at qdesigner.cpp:98
#21 0x08073dc6 in main (argc=135463816, argv=Cannot access memory at address 0x1670
) at main.cpp:70





Comment 5


Matteo Sasso





          2008-07-03 01:51:31 UTC
        

Carsten, thanks for the tip. gdb is not very helpful:

Thread 1 (Thread 0xa662f8e0 (LWP 22782)):
#0  0xa67ce561 in ?? () from /lib/libc.so.6
#1  0xa67d2838 in free () from /lib/libc.so.6
#2  0xa68b6140 in ?? () from /lib/libc.so.6
#3  0x092b19c0 in ?? ()
#4  0x090172c8 in ?? ()
#5  0xafae2928 in ?? ()
#6  0xa6b33a67 in QMutexPrivate::self (this=0xa6d0e888) at thread/qmutex_unix.cpp:77
Backtrace stopped: previous frame inner to this frame (corrupt stack?)






Comment 6


Matteo Sasso





          2008-07-03 15:33:11 UTC
        

Everything works fine with vanilla qt-4.4.0.




Comment 7


Matteo Sasso





          2008-07-03 15:56:49 UTC
        

The problem must lie in one of the libraries: the ebuild designer works fine with the "vanilla" libraries. Now I'll try do change the libraries one by one to narrow the field.




Comment 8


Matteo Sasso





          2008-07-03 17:29:55 UTC
        

Ok, it's libQtGui. Now what?




Comment 9


unnamedrambler





          2008-07-11 06:58:41 UTC
        

I resolved this bug for myself. It turns out designer was segfaulting due to a binary incompatible plugin.

In my case it was: /usr/lib/qt4/plugins/designer/libqscintillaplugin.so

Simply moving/deleting that plugin resolved my issue with designer not starting.




Comment 10


Martin Gysel (bearsh)





          2008-07-30 20:57:27 UTC
        

(In reply to comment #9)
> In my case it was: /usr/lib/qt4/plugins/designer/libqscintillaplugin.so
> 
> Simply moving/deleting that plugin resolved my issue with designer not
> starting.

I had the same issue, it seems re-emerging x11-libs/qscintilla-2.2 solves it






Comment 11


F. Di Milia (root_tux_linux)





          2008-08-15 17:33:01 UTC
        

Same problem here!

angelus@gentoo ~ $ designer
Speicherzugriffsfehler
angelus@gentoo ~ $


Speicherzugriffsfehler = segmentation fault!





Comment 12


Man Shankar





          2008-09-17 16:57:56 UTC
        

(In reply to comment #0)
> No error messages. The startup splash is not displayed.
> Do you need a backtrace (might take a while)? If I want to compile a debug
> version is it sufficient to set the debug use flag or I need to modify CFLAGS
> too?
> Can you replicate this bug or is it me?
> 
> Reproducible: Always
> 
> Steps to Reproduce:
> 1. Run /usr/bin/designer
> 
> 
> Actual Results:  
> ...
> clock_gettime(CLOCK_MONOTONIC, {98646, 436839322}) = 0
> write(7, "\233\24\31\0\4\0
> \3\1\0\0\0\32\0\0\0\5\0\t\0\377\377\t\0\7\0\0\0\0\377\377\377"..., 2896) = 2896
> read(7, "\1\1?\1\0\0\0\0e\0\0\0X\0 \1[\1P\1[\1P\1\20\0 \10Pa\365\257", 32) = 32
> brk(0x9816000)                          = 0x9816000
> brk(0x9837000)                          = 0x9837000
> clock_gettime(CLOCK_MONOTONIC, {98646, 450415728}) = 0
> brk(0x9858000)                          = 0x9858000
> --- SIGSEGV (Segmentation fault) @ 0 (0) ---
> +++ killed by SIGSEGV +++
> 
> 
> Expected Results:  
> Well...
> 

(In reply to comment #11)
> Same problem here!
> 
> angelus@gentoo ~ $ designer
> Speicherzugriffsfehler
> angelus@gentoo ~ $
> 
> 
> Speicherzugriffsfehler = segmentation fault!
> 

I have the same problem on a mostly stable amd64 system. The version of qt is


root ~ # emerge -pv qt:4

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] x11-libs/qt-4.3.3  USE="accessibility dbus doc examples gif glib jpeg mng mysql opengl pch png qt3support ssl tiff zlib -cups -debug (-firebird) -nas -nis -odbc -postgres -sqlite -sqlite3 -xinerama" INPUT_DEVICES="-wacom" 0 kB 

Total: 1 package (1 reinstall), Size of downloads: 0 kB

The dirty hack for me was to move/delete the plugin

/usr/lib64/qt4/plugins/designer/libtaskmenuextension.so

and frankly i don't know what that plugin does.





Comment 13


Ben de Groot (RETIRED)






          2008-09-19 12:13:52 UTC
        

Please update to qt-4.4.2 (as 4.4.0 is not a version we officially support) and remerge qscintilla-2.2. If the problem reappears, we can reopen this bug.




Comment 14


Man Shankar





          2008-09-19 13:34:18 UTC
        

(In reply to comment #13)
> Please update to qt-4.4.2 (as 4.4.0 is not a version we officially support) and
> remerge qscintilla-2.2. If the problem reappears, we can reopen this bug.
> 

Thanks but unfortunately the latest stable version is qt-4.3.3
Also i tried to unmerge everything kde:3, qt:3 related; then installed qt:4
and now everything works ok. Could there be a file collision, if qt:3 is installed first and then qt:4?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

