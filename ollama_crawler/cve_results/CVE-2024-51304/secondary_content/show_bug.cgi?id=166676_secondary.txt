Title: 166676 – sys-libs/db-4.2.52_p4-r2: QA: TEXTREL, failing with FEATURES=stricter
URL: https://bugs.gentoo.org/show_bug.cgi?id=166676

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 166676
sys-libs/db-4.2.52_p4-r2: QA: TEXTREL, failing with FEATURES=stricter
Last modified: 2007-02-14 11:08:14 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 166676 
      - sys-libs/db-4.2.52_p4-r2: QA: TEXTREL, failing with FEATURES=stricter


Summary:
sys-libs/db-4.2.52_p4-r2: QA: TEXTREL, failing with FEATURES=stricter
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Paul de Vrieze (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-02-13 15:25 UTC by Jan Kundrát (RETIRED)





      Modified:
    
2007-02-14 11:08 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



hardened









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge log

              (emerge-db.log,145.26 KB,
                text/plain)

            
2007-02-13 22:12 UTC,

            Jan Kundrát (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jan Kundrát (RETIRED)






          2007-02-13 15:25:23 UTC
        

QA Notice: the following files contain runtime text relocations
 Text relocations require a lot of extra work to be preformed by the
 dynamic linker which will cause serious performance impact on IA-32
 and might not function properly on other architectures hppa for example.
 If you are a programmer please take a closer look at this package and
 consider writing a patch which addresses this problem.
TEXTREL usr/lib/libdb-4.2.so
TEXTREL usr/lib/libdb_cxx-4.2.so


!!! ERROR: sys-libs/db-4.2.52_p4-r2 failed.
!!! Function dyn_install, Line 1087, Exitcode 0
!!! Aborting due to textrels
!!! If you need support, post the topmost build error, NOT this status message.

!!! When you file a bug report, please include the following information:
GENTOO_VM=  CLASSPATH="" JAVA_HOME=""
JAVACFLAGS="" COMPILER=""
and of course, the output of emerge --info

Portage 2.0.53 (hardened/x86/2.6, gcc-3.4.4, glibc-2.3.6-r5, 2.6.19-1.2895.fc6xen i686)
=================================================================
System uname: 2.6.19-1.2895.fc6xen i686 AMD Opteron(tm) Processor 280
Gentoo Base System version 1.6.13
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: [Not Present]
dev-lang/python:     2.4.2
dev-python/pycrypto: [Not Present]
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.12-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -mcpu=i686 -pipe -ggdb3"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -mcpu=i686 -pipe -ggdb3"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg collision-protect distlocks fixpackages parallel-fetch sandbox sfperms splitdebug strict stricter test userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://ftp.sh.cvut.cz/MIRRORS/gentoo"
INSTALL_MASK="/usr/lib/debug/"
LANG="en_US.UTF-8"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 berkdb bzip2 crypt dlloader expat hardened midi ncurses nls nptl nptlonly pam perl pic python readline ssl udev xorg zlib input_devices_mouse input_devices_keyboard userland_GNU kernel_linux elibc_glibc alsa_pcm_plugins_adpcm alsa_pcm_plugins_alaw alsa_pcm_plugins_asym alsa_pcm_plugins_copy alsa_pcm_plugins_dmix alsa_pcm_plugins_dshare alsa_pcm_plugins_dsnoop alsa_pcm_plugins_empty alsa_pcm_plugins_extplug alsa_pcm_plugins_file alsa_pcm_plugins_hooks alsa_pcm_plugins_iec958 alsa_pcm_plugins_ioplug alsa_pcm_plugins_ladspa alsa_pcm_plugins_lfloat alsa_pcm_plugins_linear alsa_pcm_plugins_meter alsa_pcm_plugins_mulaw alsa_pcm_plugins_multi alsa_pcm_plugins_null alsa_pcm_plugins_plug alsa_pcm_plugins_rate alsa_pcm_plugins_route alsa_pcm_plugins_share alsa_pcm_plugins_shm alsa_pcm_plugins_softvol lcd_devices_bayrad lcd_devices_cfontz lcd_devices_cfontz633 lcd_devices_glk lcd_devices_hd44780 lcd_devices_lb216 lcd_devices_lcdm001 lcd_devices_mtxorb lcd_devices_ncurses lcd_devices_text"
Unset:  CTARGET, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS, PORTAGE_RSYNC_OPTS, PORTDIR_OVERLAY




Comment 1


Kevin F. Quinn (RETIRED)






          2007-02-13 16:22:23 UTC
        

hmm; I don't get textrels here.  You could try upgrading gcc to 3.4.6.

Please attach the build log - if you don't have one, either set PORT_LOGDIR in /etc/make.conf to the name of a directory to capture the log and re-try the emerge, or do:

  emerge =sys-libs/db-4.2.52_p4-r2 2>&1 | tee emerge-db.log




Comment 2


Jan Kundrát (RETIRED)






          2007-02-13 22:12:41 UTC
        

Created attachment 110126 [details]
emerge log

New emerge --info after some updates. The build finishes but the QA notice is still here.

Portage 2.1.2-r9 (hardened/x86/2.6, gcc-3.4.6, glibc-2.3.6-r5, 2.6.19-1.2895.fc6xen i686)
=================================================================
System uname: 2.6.19-1.2895.fc6xen i686 AMD Opteron(tm) Processor 280
Gentoo Base System version 1.6.13
Timestamp of tree: Tue, 13 Feb 2007 16:20:01 +0000
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.12-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -mcpu=i686 -pipe -ggdb3"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-O2 -mcpu=i686 -pipe -ggdb3"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg collision-protect distlocks fixpackages metadata-transfer parallel-fetch sandbox sfperms splitdebug strict stricter userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://ftp.sh.cvut.cz/MIRRORS/gentoo"
INSTALL_MASK="/usr/lib/debug/"
LANG="en_US.UTF-8"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="berkdb crypt dlloader hardened midi nls nptl nptlonly pam pic readline ssl x86 xorg zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="mouse keyboard" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 3


Kevin F. Quinn (RETIRED)






          2007-02-13 22:47:56 UTC
        

> checking if i686-pc-linux-gnu-gcc PIC flag -fPIC works... no

That's odd.  Mine (from a couple of months ago; 17 Nov 2006) says:

> checking if i686-pc-linux-gnu-cc PIC flag -fPIC works... yes

and it puts '-fPIC -DPIC' on all the objects that go into the shared libraries.

Could you attach the config.log?  It should explain why it failed trying to use '-fPIC'.

A thought - I wonder if it's the deprecated '-mcpu=i686' (causing extra junk in the output of gcc, you can see it throughout the log and perhaps that's what tripped up the configure check) - you could try '-mtune=i686' instead, to get i386 code that's tuned for i686 (e.g. pipeline use, instruction ordering).  Note, if you want code that uses all the i686 instruction set, you want -march rather than -mtune.




Comment 4


Jan Kundrát (RETIRED)






          2007-02-14 11:08:14 UTC
        

(In reply to comment #3)
> A thought - I wonder if it's the deprecated '-mcpu=i686'

You are right, changing to -march fixed the issue. Thanks for your help.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

