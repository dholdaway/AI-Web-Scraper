Title: 147690 – net-fs/samba-3.0.23a - net rpc command fails
URL: https://bugs.gentoo.org/show_bug.cgi?id=147690

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 147690
net-fs/samba-3.0.23a - net rpc command fails
Last modified: 2006-12-17 13:35:05 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 147690 
      - net-fs/samba-3.0.23a - net rpc command fails


Summary:
net-fs/samba-3.0.23a - net rpc command fails
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Server

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Gentoo's SAMBA Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-09-15 06:52 UTC by GP Walker





      Modified:
    
2006-12-17 13:35 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



vapier









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


GP Walker





          2006-09-15 06:52:32 UTC
        

I am unable to add nested groups following an update to 3.0.23a, here is a debug log. (IP's and computernames changed to protect the innocent) 

gentoo ~ # net rpc group add NewGroup -Umyauthuser -L -d 3 -I 10.0.0.1
[2006/09/15 14:41:07, 3] param/loadparm.c:lp_load(4945)
  lp_load: refreshing parameters
[2006/09/15 14:41:07, 3] param/loadparm.c:init_globals(1410)
  Initialising global parameters
[2006/09/15 14:41:07, 3] param/params.c:pm_process(572)
  params.c:pm_process() - Processing configuration file "/etc/samba/smb.conf"
[2006/09/15 14:41:07, 3] param/loadparm.c:do_section(3687)
  Processing section "[global]"
[2006/09/15 14:41:07, 1] param/loadparm.c:lp_do_parameter(3426)
  WARNING: The "printer admin" option is deprecated
[2006/09/15 14:41:07, 2] lib/interface.c:add_interface(81)
  added interface ip=10.0.0.1 bcast=10.0.255.255 nmask=255.255.0.0
[2006/09/15 14:41:07, 2] lib/interface.c:add_interface(81)
  added interface ip=127.0.0.1 bcast=127.255.255.255 nmask=255.0.0.0
Password:
[2006/09/15 14:41:11, 3] libsmb/cliconnect.c:cli_start_connection(1417)
  Connecting to host=10.0.0.1
[2006/09/15 14:41:11, 3] lib/util_sock.c:open_socket_out(874)
  Connecting to 130.88.88.89 at port 445
[2006/09/15 14:41:11, 3] libsmb/cliconnect.c:cli_session_setup_spnego(723)
  Doing spnego session setup (blob length=122)
[2006/09/15 14:41:11, 3] libsmb/cliconnect.c:cli_session_setup_spnego(748)
  got OID=1 2 840 113554 1 2 2
[2006/09/15 14:41:11, 3] libsmb/cliconnect.c:cli_session_setup_spnego(748)
  got OID=1 2 840 48018 1 2 2
[2006/09/15 14:41:11, 3] libsmb/cliconnect.c:cli_session_setup_spnego(748)
  got OID=1 3 6 1 4 1 311 2 2 10
[2006/09/15 14:41:11, 3] libsmb/cliconnect.c:cli_session_setup_spnego(757)
  got principal=cifs/netbiosname.realm@REALM
[2006/09/15 14:41:11, 3] libsmb/ntlmssp.c:ntlmssp_client_challenge(941)
  Got challenge flags:
[2006/09/15 14:41:11, 3] libsmb/ntlmssp.c:debug_ntlmssp_flags(63)
  Got NTLMSSP neg_flags=0x60890215
[2006/09/15 14:41:11, 3] libsmb/ntlmssp.c:ntlmssp_client_challenge(963)
  NTLMSSP: Set final flags:
[2006/09/15 14:41:11, 3] libsmb/ntlmssp.c:debug_ntlmssp_flags(63)
  Got NTLMSSP neg_flags=0x60080215
[2006/09/15 14:41:11, 3] libsmb/ntlmssp_sign.c:ntlmssp_sign_init(338)
  NTLMSSP Sign/Seal - Initialising with flags:
[2006/09/15 14:41:11, 3] libsmb/ntlmssp.c:debug_ntlmssp_flags(63)
  Got NTLMSSP neg_flags=0x60080215
[2006/09/15 14:41:12, 3] rpc_client/cli_pipe.c:rpc_pipe_bind(2081)
  rpc_pipe_bind: Remote machine 10.0.0.1 pipe \lsarpc fnum 0x726a bind request returned ok.
[2006/09/15 14:41:12, 3] rpc_client/cli_pipe.c:rpc_pipe_bind(2081)
  rpc_pipe_bind: Remote machine 10.0.0.1 pipe \samr fnum 0x726b bind request returned ok.
add alias failed: NT_STATUS_ACCESS_DENIED
[2006/09/15 14:41:12, 1] utils/net_rpc.c:run_rpc_command(170)
  rpc command function failed! (NT_STATUS_ACCESS_DENIED)
[2006/09/15 14:41:12, 2] utils/net.c:main(988)
  return code = 1
gentoo ~ #

wbinfo -t works, I can enumerate the domain users and groups with wbinfo and getent. I can even delete existing nested groups, but I cant create them. Non of the nested groups allow domain access anyway and I have been struggling with this for quite a while. this has not worked consistently since 3.0.14a

emerge --info gives:
gentoo ~ # emerge --info
Portage 2.1.1 (default-linux/x86/2006.1, gcc-3.4.6, glibc-2.4-r3, 2.6.17 i686)
=================================================================
System uname: 2.6.17 i686 Intel(R) Pentium(R) 4 CPU 1400MHz
Gentoo Base System version 1.12.4
Last Sync: Fri, 15 Sep 2006 02:50:01 +0000
ccache version 2.3 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r5
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=pentium4 -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/mozilla/defaults/pref /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-O2 -march=pentium4 -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://www.mirrorservice.org/sites/www.ibiblio.org/gentoo/ ftp://ftp6.uni-erlangen.de/pub/mirrors/gentoo ftp://vlaai.snt.ipv6.utwente.nl/pub/os/linux/gentoo/ http://vlaai.snt.ipv6.utwente.nl/pub/os/linux/gentoo/ http://ftp6.uni-erlangen.de/pub/mirrors/gentoo"
LC_ALL="en_GB"
LINGUAS="en_GB es"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 alsa audiofile berkdb bitmap-fonts cdparanoia cdr cli crypt cups dlloader dri dvd elibc_glibc foomaticdb fortran gdbm gimp-print gpm input_devices_keyboard input_devices_mouse ipv6 isdnlog kde kerberos kernel_linux libg++ linguas_en_GB linguas_es ncurses nls nptl nptlonly pam pcre perl ppds pppd python qt readline reflection samba session slp smime spl ssl tcpd truetype-fonts type1-fonts udev unicode usb userland_GNU video_cards_fbdev video_cards_nv video_cards_vga winbind xorg zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY

gentoo ~ #

samba was compiled with the following use flags:
USE="acl cups kerberos ldap pam python readline winbind -async -automount -doc -examples -oav -quotas (-selinux) -swat -syslog" LINGUAS="-ja -pl" 0 kB

This samba server is a domain member server within a windows 2003 active directory.




Comment 1


SpanKY






          2006-12-17 13:35:05 UTC
        

please re-open if 3.0.23d does not work









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

