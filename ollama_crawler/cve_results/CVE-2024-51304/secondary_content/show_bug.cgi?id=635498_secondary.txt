Title: 635498 – sys-firmware/edk2-ovmf-2017_pre20170505 fails to compile: GnuGenBootSector.o: relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a shared object; recompile with -fPIC
URL: https://bugs.gentoo.org/show_bug.cgi?id=635498

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 635498
sys-firmware/edk2-ovmf-2017_pre20170505 fails to compile: GnuGenBootSector.o: relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a shared object; recompile with -fPIC
Last modified: 2018-02-12 07:46:35 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 635498 
      - sys-firmware/edk2-ovmf-2017_pre20170505 fails to compile: GnuGenBootSector.o: relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a shared object; recompile with -fPIC


Summary:
sys-firmware/edk2-ovmf-2017_pre20170505 fails to compile: GnuGenBootSector.o:...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Matthias Maier








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2017-10-26 14:39 UTC by Jaak Ristioja





      Modified:
    
2018-02-12 07:46 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



tsmksubc
virtualization









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,8.31 KB,
                text/x-log)

            
2017-10-26 14:39 UTC,

            Jaak Ristioja




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jaak Ristioja





          2017-10-26 14:39:04 UTC
        

Created attachment 500190 [details]
build.log

[ebuild  N     ] sys-firmware/edk2-ovmf-2017_pre20170505::gentoo  USE="-binary" 0 KiB

make[2]: Entering directory '/var/tmp/portage/sys-firmware/edk2-ovmf-2017_pre20170505/work/edk2-ovmf-2017_pre20170505/BaseTools/Source/C/GnuGenBootSector'
mkdir ../bin
gcc  -c -MD -fshort-wchar -fno-strict-aliasing -Wall -Wno-deprecated-declarations -Wno-unused-result -nostdlib -c -g  -I .. -I ../Include/Common -I ../Include/ -I ../Include/IndustryStandard -I ../Common/ -I .. -I . -I ../Include/X64/  -O2 GnuGenBootSector.c -o GnuGenBootSector.o
gcc -o ../bin/GnuGenBootSector  GnuGenBootSector.o -L../libs -lCommon
/usr/lib/gcc/x86_64-pc-linux-gnu/5.4.0/../../../../x86_64-pc-linux-gnu/bin/ld: GnuGenBootSector.o: relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a shared object; recompile with -fPIC
GnuGenBootSector.o: error adding symbols: Bad value
collect2: error: ld returned 1 exit status

# emerge --info
Traceback (most recent call last):
  File "/usr/lib/python-exec/python3.4/emerge", line 50, in <module>
    retval = emerge_main()
  File "/usr/lib64/python3.4/site-packages/_emerge/main.py", line 1250, in emerge_main
    return run_action(emerge_config)
  File "/usr/lib64/python3.4/site-packages/_emerge/actions.py", line 3255, in run_action
    emerge_config.trees, emerge_config.opts, valid_atoms)
  File "/usr/lib64/python3.4/site-packages/_emerge/actions.py", line 1654, in action_info
    head_commit = sync.retrieve_head(options=options)
AttributeError: 'WebRsync' object has no attribute 'retrieve_head'

Using gcc (Gentoo Hardened 5.4.0-r3 p1.4, pie-0.6.5) 5.4.0, hardened/linux/amd64/no-multilib profile.




Comment 1


Matthias Maier






          2018-02-12 00:11:40 UTC
        

Cannot repdroduce. Please attach emerge --info and reopen if problem persists.




Comment 2


Jaak Ristioja





          2018-02-12 07:46:35 UTC
        

It's been a while...

Meanwhile, among other upgrades, I've also switched to a new profile and compiler, and I can no longer reproduce this issue, as sys-firmware/edk2-ovmf-2017_pre20170505 merges properly now.

Portage 2.3.19 (python 3.4.5-final-0, default/linux/amd64/17.0/no-multilib/hardened, gcc-6.4.0, glibc-2.26-r5, 4.15.2-gentoo x86_64)
=================================================================
Timestamp of repository gentoo: Sat, 10 Feb 2018 00:45:01 +0000
sh bash 4.4_p12
ld GNU ld (Gentoo 2.29.1 p3) 2.29.1
distcc 3.2rc1 x86_64-pc-linux-gnu [disabled]
ccache version 3.2.4 [disabled]
app-shells/bash:          4.4_p12::gentoo
dev-lang/perl:            5.24.3::gentoo
dev-lang/python:          2.7.14-r1::gentoo, 3.4.5-r1::gentoo, 3.5.4-r1::gentoo
dev-util/ccache:          3.2.4::gentoo
dev-util/cmake:           3.10.2::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.4.1-r2::gentoo
sys-apps/openrc:          0.34.11::gentoo
sys-apps/sandbox:         2.12::gentoo
sys-devel/autoconf:       2.13::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.11.6-r2::gentoo, 1.14.1-r1::gentoo, 1.15.1-r1::gentoo
sys-devel/binutils:       2.29.1-r1::gentoo
sys-devel/gcc:            4.9.4::gentoo, 5.4.0-r3::gentoo, 6.4.0-r1::gentoo, 7.2.0-r1::gentoo, 7.3.0::gentoo
sys-devel/gcc-config:     1.8-r1::gentoo
sys-devel/libtool:        2.4.6-r3::gentoo
sys-devel/make:           4.2.1::gentoo
sys-kernel/linux-headers: 4.15::gentoo (virtual/os-headers)
sys-libs/glibc:           2.26-r5::gentoo
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="@FREE"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=native -ggdb"
CHOST="x86_64-pc-linux-gnu"
CXXFLAGS="-O2 -pipe -march=native -ggdb"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs collision-protect compressdebug config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync multilib-strict news parallel-fetch preserve-libs protect-owned sandbox sfperms splitdebug strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync webrsync-gpg xattr"
FFLAGS="-O2 -pipe"
LANG="POSIX"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en et et_EE"
MAKEOPTS="-j12"
ABI_X86="64" CPU_FLAGS_X86="mmx mmxext sse sse2 aes avx avx2 f16c fma3 popcnt sse3 sse4_1 sse4_2 ssse3" ELIBC="glibc" KERNEL="linux" L10N="en et et-EE" USERLAND="GNU"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

