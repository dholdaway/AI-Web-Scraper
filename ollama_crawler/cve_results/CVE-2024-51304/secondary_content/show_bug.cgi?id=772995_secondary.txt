Title: 772995 – www-apps/nextcloud-21.0.0 fails to install "..files/php-argon2-en.txt' not found
URL: https://bugs.gentoo.org/show_bug.cgi?id=772995

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 772995
www-apps/nextcloud-21.0.0 fails to install "..files/php-argon2-en.txt' not found
Last modified: 2021-04-15 19:42:34 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 772995 
      - www-apps/nextcloud-21.0.0 fails to install "..files/php-argon2-en.txt' not found


Summary:
www-apps/nextcloud-21.0.0 fails to install "..files/php-argon2-en.txt' not found
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Bernard Cafarelli








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-02-26 08:59 UTC by Anders Larsson





      Modified:
    
2021-04-15 19:42 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



polynomial-c









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge output

              (file_772995.txt,4.01 KB,
                text/plain)

            
2021-02-26 13:25 UTC,

            Anders Larsson




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Anders Larsson





          2021-02-26 08:59:59 UTC
        

www-apps/nextcloud-21.0.0 fails to install because php-argon2-en.txt is missing in the ebuild.

>>> Unpacking source...
>>> Unpacking nextcloud-21.0.0.tar.bz2 to /var/tmp/portage/www-apps/nextcloud-21.0.0/work
>>> Source unpacked in /var/tmp/portage/www-apps/nextcloud-21.0.0/work
>>> Preparing source in /var/tmp/portage/www-apps/nextcloud-21.0.0/work/nextcloud ...
>>> Source prepared.
>>> Configuring source in /var/tmp/portage/www-apps/nextcloud-21.0.0/work/nextcloud ...
>>> Source configured.
>>> Compiling source in /var/tmp/portage/www-apps/nextcloud-21.0.0/work/nextcloud ...
>>> Source compiled.
>>> Test phase [not enabled]: www-apps/nextcloud-21.0.0

>>> Install www-apps/nextcloud-21.0.0 into /var/tmp/portage/www-apps/nextcloud-21.0.0/image
 * (config) htdocs/.htaccess
 * ebuild fault: file '/var/tmp/portage/www-apps/nextcloud-21.0.0/files/php-argon2-en.txt' not found
 * Please report this as a bug at https://bugs.gentoo.org/
 * ERROR: www-apps/nextcloud-21.0.0::gentoo failed (install phase):
 *   ebuild fault: file '/var/tmp/portage/www-apps/nextcloud-21.0.0/files/php-argon2-en.txt' not found
 *
 * Call stack:
 *     ebuild.sh, line 125:  Called src_install
 *   environment, line 628:  Called webapp_postinst_txt 'en' '/var/tmp/portage/www-apps/nextcloud-21.0.0/files/php-argon2-en.txt'
 *   environment, line 914:  Called webapp_checkfileexists '/var/tmp/portage/www-apps/nextcloud-21.0.0/files/php-argon2-en.txt'
 *   environment, line 714:  Called die
 * The specific snippet of code:
 *           die "$msg";
 *
 * If you need support, post the output of `emerge --info '=www-apps/nextcloud-21.0.0::gentoo'`,
 * the complete build log and the output of `emerge -pqv '=www-apps/nextcloud-21.0.0::gentoo'`.
 * The complete build log is located at '/var/tmp/portage/www-apps/nextcloud-21.0.0/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/www-apps/nextcloud-21.0.0/temp/environment'.
 * Working directory: '/var/tmp/portage/www-apps/nextcloud-21.0.0/work/nextcloud'
 * S: '/var/tmp/portage/www-apps/nextcloud-21.0.0/work/nextcloud'


Reproducible: Always

Steps to Reproduce:
1. emerge -1 '=www-apps/nextcloud-21.0.0'

Actual Results:  
Ebuild fails to install.

Expected Results:  
Ebuild installs successfully.

Portage 3.0.13 (python 3.8.7-final-0, default/linux/amd64/17.1/no-multilib/hardened, gcc-9.3.0, glibc-2.32-r6, 5.4.81-gentoo x86_64)                                                                                                                                                                                                                                                                                                 
=================================================================
System uname: Linux-5.4.81-gentoo-x86_64-QEMU_Virtual_CPU_version_2.5+-with-glibc2.2.5
KiB Mem:     1943696 total,    405372 free
KiB Swap:     524284 total,    476668 free
Timestamp of repository gentoo: Fri, 26 Feb 2021 07:30:01 +0000
Head commit of repository gentoo: b965fdf51af50aa51b768c9d67547b08b907e671
Timestamp of repository genthree: Mon, 28 Dec 2020 10:28:18 +0000
sh bash 5.0_p18
ld GNU ld (Gentoo 2.35.1 p2) 2.35.1
app-shells/bash:          5.0_p18::gentoo
dev-lang/perl:            5.30.3::gentoo
dev-lang/python:          3.8.7-r1::gentoo, 3.9.1-r1::gentoo
dev-util/cmake:           3.18.5::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.7::gentoo
sys-apps/openrc:          0.42.1-r1::gentoo
sys-apps/sandbox:         2.20::gentoo
sys-devel/autoconf:       2.69-r5::gentoo
sys-devel/automake:       1.16.2-r1::gentoo
sys-devel/binutils:       2.35.1-r1::gentoo
sys-devel/gcc:            9.3.0-r2::gentoo
sys-devel/gcc-config:     2.3.2-r1::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.3::gentoo
sys-kernel/linux-headers: 5.4-r1::gentoo (virtual/os-headers)
sys-libs/glibc:           2.32-r6::gentoo
Repositories:

gentoo
    location: /var/db/repos/gentoo
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-max-age: 24
    sync-rsync-extra-opts:
    sync-rsync-verify-metamanifest: yes
    sync-rsync-verify-jobs: 1

anders-larsson
    location: /var/db/repos/anders-larsson
    masters: gentoo

genthree
    location: /var/db/repos/genthree
    masters: gentoo

server-portage
    location: /var/db/repos/server
    masters: gentoo

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="@FREE"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=native"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php7.3/ext-active/ /etc/php/apache2-php7.4/ext-active/ /etc/php/cgi-php7.3/ext-active/ /etc/php/cgi-php7.4/ext-active/ /etc/php/cli-php7.3/ext-active/ /etc/php/cli-php7.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe -march=native"
DISTDIR="/var/cache/distfiles"
EMERGE_DEFAULT_OPTS="--with-bdeps=y --complete-graph y --jobs=5 --load-average=1 --usepkg"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_GB.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j1"
PKGDIR="/var/cache/binpkgs"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="acl amd64 bzip2 crypt hardened iconv ipv6 libglvnd libtirpc ncurses nls nptl offensive openmp openssl pam pcre php pie readline seccomp split-usr ssl ssp syslog unicode vhosts vim-syntax xattr xtpax zlib zsh-completion" ABI_X86="64" ADA_TARGET="gnat_2018" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio
 via82xx via82xx-modem ymfpci" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiati
on rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext sse sse2 sse3" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq super
star2 timing tsip tripmate tnt ublox ubx" GRUB_PLATFORMS="pc" INPUT_DEVICES="libinput" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-3 php7-4" POSTGRES_TARGETS="postgres10 postgres11" PYTHON_SINGLE_TARGET="python3_8" PYTHON_TARGETS="python3_8" RUBY_TARGETS="ruby26" USERLAND="GNU" VIDEO_CARDS="amdgpu fbdev intel nouveau radeon radeonsi vesa dummy v4l" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ip
p2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, INSTALL_MASK, LC_ALL, LINGUAS, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Bernard Cafarelli






          2021-02-26 13:13:20 UTC
        

Strange one, it works fine here:
[www] /usr/portage/www-apps/nextcloud # ebuild nextcloud-21.0.0.ebuild prepare
 * nextcloud-21.0.0.tar.bz2 BLAKE2B SHA512 size ;-) ...                  [ ok ]
 * checking ebuild checksums ;-) ...                                     [ ok ]
 * checking auxfile checksums ;-) ...                                    [ ok ]
 * checking miscfile checksums ;-) ...                                   [ ok ]
>>> Unpacking source...
>>> Unpacking nextcloud-21.0.0.tar.bz2 to /var/tmp/portage/www-apps/nextcloud-21.0.0/work
>>> Source unpacked in /var/tmp/portage/www-apps/nextcloud-21.0.0/work
>>> Preparing source in /var/tmp/portage/www-apps/nextcloud-21.0.0/work/nextcloud ...
>>> Source prepared.
[www] /usr/portage/www-apps/nextcloud # ls /var/tmp/portage/www-apps/nextcloud-21.0.0/files/php-argon2-en.txt
/var/tmp/portage/www-apps/nextcloud-21.0.0/files/php-argon2-en.txt

Do you have nextcloud in another overlay perhaps? First lines of build.log may help here




Comment 2


Anders Larsson





          2021-02-26 13:25:39 UTC
        

Created attachment 688491 [details]
emerge output




Comment 3


Anders Larsson





          2021-02-26 13:27:41 UTC
        

I don't understand why though. Because it appears to indeed be there?

# /var/tmp/portage/www-apps/nextcloud-21.0.0/files # ls -l
total 4
-rw-r--r-- 1 portage portage 416 Jan 25 21:39 php-argon2-en.txt




Comment 4


Anders Larsson





          2021-02-26 13:47:07 UTC
        

It works fine to use 'ebuild nextcloud-21.0.0.ebuild install'. Could it be a race-condition because /var/db/repos is stored on NFS? Not sure I understand how though since it should really unpack it before it proceed with the next step?

Thanks for your help. Not sure if this bug is valid. Sorry for the noise.




Comment 5


Bernard Cafarelli






          2021-04-15 19:42:34 UTC
        

All right, this can be reopened if issue reappears, closing for now









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

