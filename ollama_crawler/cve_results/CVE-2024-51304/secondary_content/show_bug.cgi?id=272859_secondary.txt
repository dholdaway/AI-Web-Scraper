Title: 272859 – sys-apps/tcp-wrapper fails to compile
URL: https://bugs.gentoo.org/show_bug.cgi?id=272859

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 272859
sys-apps/tcp-wrapper fails to compile
Last modified: 2011-04-21 07:43:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 272859 
      - sys-apps/tcp-wrapper fails to compile


Summary:
sys-apps/tcp-wrapper fails to compile
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-06-06 08:11 UTC by Xake





      Modified:
    
2011-04-21 07:43 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Xake





          2009-06-06 08:11:17 UTC
        

This is the problem (Åtkomst nekas means Access denied):

>>> Verifying ebuild manifests
>>> Emerging (1 of 1) sys-apps/tcp-wrappers-7.6-r8
>>> Failed to emerge sys-apps/tcp-wrappers-7.6-r8, Log file:
>>>  '/var/log/portage/sys-apps:tcp-wrappers-7.6-r8:20090606-080442.log'
 * Applying tcp-wrappers-7.6-makefile.patch ...                           [ ok ]
 * Applying various patches (bugfixes/updates) ...
 *   01_all_redhat-bug11881.patch ...                                     [ ok ]
 *   02_all_redhat-bug17795.patch ...                                     [ ok ]
 *   03_all_wildcard.patch ...                                            [ ok ]
 *   04_all_fixgethostbyname.patch ...                                    [ ok ]
 *   07_all_sig.patch ...                                                 [ ok ]
 *   08_all_strerror.patch ...                                            [ ok ]
 *   09_all_gcc-3.4.patch ...                                             [ ok ]
 *   10_all_more-headers.patch ...                                        [ ok ]
 * Done with patching
 * Applying tcp-wrappers-7.6-shared.patch ...                             [ ok ]
/bin/sh: /tmp/cflags.31162: Åtkomst nekas
make: *** [config-check] Fel 1
 * 
 * ERROR: sys-apps/tcp-wrappers-7.6-r8 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 2140:  Called die
 * The specific snippet of code:
 *       emake REAL_DAEMON_DIR=/usr/sbin GENTOO_OPT="${myconf}" MAJOR=0 MINOR=${PV:0:1} REL=${PV:2:3} config-check || die "emake config-check failed";
 *  The die message:
 *   emake config-check failed
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/var/log/portage/sys-apps:tcp-wrappers-7.6-r8:20090606-080442.log'.
 * The ebuild environment file is located at '/var/tmp/portage/sys-apps/tcp-wrappers-7.6-r8/temp/environment'.



The problem is that first config-check fails to create /tmp/cflags.$$$$, then it finds no ${PWD}/cflags after which it tries to "mv /tmp/cflags.$$$$ cflags" which obvious fails too.

This little patch fixed the behaviour (it just handles cflags.$$$$ in local directory instead of in /tmp):

--- /var/tmp/portage/sys-apps/tcp-wrappers-7.6-r8/work/tcp_wrappers_7.6/Makefile	2009-06-06 10:04:44.636008429 +0200
+++ tcp_wrappers_7.6/Makefile	2009-06-06 10:02:23.659000296 +0200
@@ -694,11 +694,11 @@
 
 config-check:
 	@set +e; test -n "$(REAL_DAEMON_DIR)" || { make; exit 1; }
-	@set +e; echo $(CFLAGS) >/tmp/cflags.$$$$ ; \
-	if cmp cflags /tmp/cflags.$$$$ ; \
-	then rm /tmp/cflags.$$$$ ; \
-	else mv /tmp/cflags.$$$$ cflags ; \
-	fi >/dev/null 2>/dev/null
+	@set +e; echo $(CFLAGS) >cflags.$$$$ ; \
+	if cmp cflags cflags.$$$$ ; \
+	then rm cflags.$$$$ ; \
+	else mv cflags.$$$$ cflags ; \
+	fi
 
 $(LIB):	$(LIB_OBJ)
 	rm -f $(LIB)




Comment 1


Xake





          2011-04-21 07:43:58 UTC
        

This bug as everything to do with stupid restrictions on /tmp









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

