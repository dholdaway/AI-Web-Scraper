Title: 259436 – sys-apps/sandbox: respect color settings from portage
URL: https://bugs.gentoo.org/show_bug.cgi?id=259436

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 259436
sys-apps/sandbox: respect color settings from portage
Last modified: 2009-02-18 22:17:20 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 259436 
      - sys-apps/sandbox: respect color settings from portage


Summary:
sys-apps/sandbox: respect color settings from portage
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core - Interface (emerge)

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       enhancement
      


Assignee:

Sandbox Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-02-18 01:05 UTC by Martin Walch





      Modified:
    
2009-02-18 22:17 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



dev-portage









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin Walch





          2009-02-18 01:05:05 UTC
        

When provoking some sort of access violation in the sandbox, a summary is displayed, like e. g.

--------------------------- ACCESS VIOLATION SUMMARY ---------------------------
LOG FILE = "/var/log/sandbox/sandbox-4588.log"

foo
foo
foo
foo
--------------------------------------------------------------------------------

The header and the footer are red, also when using --color n


emerge --info

Portage 2.1.6.7 (default/linux/amd64/2008.0/desktop, gcc-4.4.0-alpha20090213, glibc-2.8_p20080602-r1, 2.6.27-gentoo-r8 x86_64)
=================================================================                                                             
System uname: Linux-2.6.27-gentoo-r8-x86_64-Intel-R-_Core-TM-2_CPU_4300_@_1.80GHz-with-glibc2.2.5                             
Timestamp of tree: Tue, 17 Feb 2009 12:45:01 +0000                                                                            
ccache version 2.4 [enabled]                                                                                                  
app-shells/bash:     3.2_p39                                                                                                  
dev-java/java-config: 2.1.6-r1                                                                                                
dev-lang/python:     2.5.2-r7                                                                                                 
dev-util/ccache:     2.4-r7                                                                                                   
dev-util/cmake:      2.6.2-r1                                                                                                 
sys-apps/baselayout: 2.0.0
sys-apps/openrc:     0.4.1-r1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   2.2.4
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -fgcse-after-reload -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-march=native -O2 -fgcse-after-reload -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="ccache collision-protect distlocks fixpackages metadata-transfer parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://mirrors.sec.informatik.tu-darmstadt.de/gentoo/ http://ftp-stud.fht-esslingen.de/pub/Mirrors/gentoo/ http://mirror.switch.ch/ftp/mirror/gentoo/"
LANG="de_DE.utf8"
LC_ALL="de_DE.utf8"
LDFLAGS="-Wl,-O1"
LINGUAS="de"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/java-overlay /usr/portage/local/layman/gnash-cvs /usr/portage/local/layman/enlightenment /usr/portage/local/layman/enlightenment /usr/portage/local/layman/sunrise /usr/portage/local/layman/toolchain /usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="X Xaw3d a52 aac aalib accessibility acl acpi agg akode alsa amarok amd64 apache2 bash-completion berkdb blender-game bluetooth branding bzip2 cairo captury cdaudio cdr cdrom cjk cli clucene cracklib crypt cups curl cviewer daap dbus designer-plugin dga dirac djvu dri dvd dvdnav dvdr dvdread dxr3 eds emacs embedded emboss encode evo fam fbcon ffmpeg fftw firefox fits flac fortran gcj gdbm ggi gif glibc-omitfp glitz gopher gpg gpm gstreamer hal hdri htmlhandbook iceweasel iconv icu imagemagick insecure-savers ipv6 isdnlog jabber jack java java5 java6 javascript jingle jpeg kde kde4 kdebuild kdecards kdeenablefinal kdehiddenvisibility kdepim kdm kontact ktts latex lcms ldap libcaca libnotify libwww lm_sensors logitech-mouse lua lzma mad matroska mdnsresponder-compat midi mikmod mmx mng mp3 mpeg mpeg2 mpi mudflap mule multilib musepack mysql ncurses nepomuk nls noamazon nova nptl nptlonly nsplugin offensive ogg ogg123 openal openexr opengl openmp oscar oss otr pam pcre pdf perl plasma png posix povray ppds pppd python qt3support qt4 quicktime readline reflectionreiser4 reiserfs schroedinger sdl sdl-image semantic-desktop sensord session sndfile solver songs sound speex spell spl sse sse2 ssl startup-notification svg sysfs tcpd tetex theora threads tidy tiff tools truetype type1 unicode usb vhook visualization vorbis wav wavpack xcomposite xemacs xine xml xorg xosd xprint xscreensaver xulrunner xv zip zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de" USERLAND="GNU" VIDEO_CARDS="i810 intel nv nvidia vesa"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Peter Alfredsen (RETIRED)






          2009-02-18 01:10:49 UTC
        

This looks like a sandbox issue. Sandbox should add a --color=n option for portage to use?




Comment 2


Zac Medico






          2009-02-18 01:13:37 UTC
        

This needs support on the sandbox side. It seems to have a static setting inside /etc/sandbox.conf, but perhaps is should use the NOCOLOR environment variable like the portage shell code does:

case "${NOCOLOR:-false}" in
	yes|true)
		unset_colors
		;;
	no|false)
		set_colors
		;;
esac




Comment 3


SpanKY






          2009-02-18 01:26:05 UTC
        

what variable is portage exporting to the environment ?  NOCOLOR ?




Comment 4


SpanKY






          2009-02-18 01:38:04 UTC
        

nm, it's already implemented in sandbox-1.3




Comment 5


Martin Walch





          2009-02-18 02:17:51 UTC
        

Sorry for bothering, but I just tried this with sys-apps/sandbox-1.3.7 and I still get those red lines.




Comment 6


SpanKY






          2009-02-18 03:07:44 UTC
        

works fine for me with `emerge --color n foo`




Comment 7


Martin Walch





          2009-02-18 03:27:08 UTC
        

I tried different things now. The color remains. Do I need =sys-apps/portage-2.2*? How can I investigate this further?




Comment 8


Zac Medico






          2009-02-18 22:17:20 UTC
        

I'm still getting color with --color=n here too, and $T/environment contains declare -x NOCOLOR="true" like it's supposed to.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

