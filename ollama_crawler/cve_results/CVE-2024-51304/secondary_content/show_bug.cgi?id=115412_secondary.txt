Title: 115412 – USB bus dies with >=ati-drivers-8.16
URL: https://bugs.gentoo.org/show_bug.cgi?id=115412

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 115412
USB bus dies with >=ati-drivers-8.16
Last modified: 2006-11-11 10:54:11 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 115412 
      - USB bus dies with >=ati-drivers-8.16


Summary:
USB bus dies with >=ati-drivers-8.16
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       enhancement
      


Assignee:

X11 External Driver Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-12-13 05:46 UTC by ivo welch





      Modified:
    
2006-11-11 10:54 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



jakub
jokey
mtippett









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




lspci output and emerge info

              (lspci,5.92 KB,
                text/plain)

            
2005-12-14 11:38 UTC,

            Markus Ullmann (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


ivo welch





          2005-12-13 05:46:20 UTC
        

after some hours, part of my USB bus dies.  lsusb outputs about 6 devices, and
then hangs hard with the message

  "cannot read device descriptor: No such device"  and some error number like 19.

An unplug/replug does not cure it.  A reboot cures it every time.   

I am trying to figure out which device exactly triggers it.  (I have now
replaced my mouse.)  Thereafter, I will see if a newer kernel will make the
problem go away.  

I am filing this bug report, because what I really need, other than no more USB
problems, is a utility that does a full reset on the USB bus and its devices.


0000:00:10.0 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1
Controller (rev 81)
0000:00:10.1 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1
Controller (rev 81)
0000:00:10.2 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1
Controller (rev 81)
0000:00:10.3 USB Controller: VIA Technologies, Inc. VT82xxxxx UHCI USB 1.1
Controller (rev 81)
0000:00:10.4 USB Controller: VIA Technologies, Inc. USB 2.0 (rev 86)

the logitech laser mouse on an NEC hub dies.

Bus 001 Device 002: ID 0409:0058 NEC Corp. HighSpeed Hub
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               2.00
  bDeviceClass            9 Hub
  bDeviceSubClass         0 Unused
  bDeviceProtocol         1 Single TT
  bMaxPacketSize0        64


Reproducible: Sometimes
Steps to Reproduce:
1.
2.
3.




Portage 2.0.51.22-r3 (default-linux/amd64/2005.0, gcc-3.4.4, glibc-2.3.5-r2,
2.6.14 x86_64)
=================================================================
System uname: 2.6.14 x86_64 AMD Athlon(tm) 64 Processor 3000+
Gentoo Base System version 1.6.13
dev-lang/python:     2.3.5-r2, 2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.20
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env
/usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib64/mozilla/defaults/pref /usr/share/config
/var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/texmf/web2c /etc/env.d"
CXXFLAGS="-march=athlon64 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org
http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
LC_ALL="POSIX"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X acpi alsa amd64 audiofile avi berkdb bitmap-fonts bzip2 bzlib cdr crypt
cups curl dvd dvdr eds emboss encode esd exif expat f77 fam fbcon ffmpeg flac
foomaticdb fortran g77 gdbm gif glut gnome gpm gstreamer gtk gtk2 idn
imagemagick imlib ipv6 java jpeg kde lcms libwww lzw lzw-tiff mad mng motif
mozilla mp3 mpeg ncurses nls ogg openal opengl pam pcre pdflib perl png python
qt quicktime readline sdl spell ssl tcltk tcpd tetex tiff truetype
truetype-fonts type1-fonts udev usb userlocales vorbis xine xml xml2 xmms xpm xv
xvid zlib userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


Jakub Moc (RETIRED)






          2005-12-13 06:24:44 UTC
        

Reopen if you are able to reproduce the problem with latest vanilla-sources.




Comment 2


Markus Ullmann (RETIRED)






          2005-12-13 07:52:44 UTC
        

Are you running >=ati-drivers-8.16? Then there is your problem... 




Comment 3


ivo welch





          2005-12-13 14:45:18 UTC
        

(In reply to comment #2)
> Are you running >=ati-drivers-8.16? Then there is your problem... 

yes, I have 8.19.10 installed.  holy moly...where did you find this?

(I searched "ALL usb ati-drivers" and nothing came up.)





Comment 4


Markus Ullmann (RETIRED)






          2005-12-14 11:34:54 UTC
        

Came across that "bug" recently.
I used fglrx for some time and had these problems with my headset.
Then I wanted some suspend2disk to work so switched back to radeon and
everything worked fine.
Now I got a second Monitor, installed fglrx again and that problem came back
again...

It's reproducable with vanilla sources here or any source you like, seems to be
some ATI internal error when initializing graphics memory but then my assembler
knowledge ended ;)




Comment 5


Markus Ullmann (RETIRED)






          2005-12-14 11:38:28 UTC
        

Created attachment 74750 [details]
lspci output and emerge info

maybe the bug opener could submit his lspci output too so we're able to see if
it depends on some special chipset.

Also usb-reset wouldn't work. Your BIOS has to reset it to get it work again, I
tried that already ;)




Comment 6


Markus Ullmann (RETIRED)






          2005-12-14 11:39:30 UTC
        

better less coffee tomorrow, didn't see that output on top ;)




Comment 7


Jakub Moc (RETIRED)






          2005-12-14 11:47:35 UTC
        

Uh eh, great "feature". :/ 

REOPEN.




Comment 8


Markus Ullmann (RETIRED)






          2006-03-19 17:13:23 UTC
        

Persists even with latest version (8.23.7)





Comment 9


Kamaji





          2006-03-27 07:59:26 UTC
        

(In reply to comment #8)
> Persists even with latest version (8.23.7)

The question then is, why did someone mark 8.18.8-r2 as stable on AMD64?
In addition to the USB bus problems, it hangs my system after the first switch back to X after being in console mode.




Comment 10


Markus Ullmann (RETIRED)






          2006-11-11 10:54:11 UTC
        

Working for me now with latest drivers, reopen if needed









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

