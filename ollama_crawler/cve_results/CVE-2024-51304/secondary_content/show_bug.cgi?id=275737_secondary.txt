Title: 275737 – sys-libs/glibc-2.9_p20081201-r2 fails install on upgrade, leaving unusable crashing system
URL: https://bugs.gentoo.org/show_bug.cgi?id=275737

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 275737
sys-libs/glibc-2.9_p20081201-r2 fails install on upgrade, leaving unusable crashing system
Last modified: 2009-09-30 15:53:52 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 275737 
      - sys-libs/glibc-2.9_p20081201-r2 fails install on upgrade, leaving unusable crashing system


Summary:
sys-libs/glibc-2.9_p20081201-r2 fails install on upgrade, leaving unusable cr...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-06-28 20:10 UTC by Jaak Ristioja





      Modified:
    
2009-09-30 15:53 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



gent.8.madblock
xmw









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jaak Ristioja





          2009-06-28 20:10:45 UTC
        

[ebuild     U ] sys-libs/glibc-2.9_p20081201-r2 [2.8_p20080602-r1] USE="(multilib) -debug -gd -glibc-omitfp (-hardened) -nls -profile (-selinux) -vanilla"

>>> Installing (2 of 3) sys-libs/glibc-2.9_p20081201-r2
 * >>> SetUID: [chmod go-r] /usr/lib32/misc/glibc/pt_chown ...                                                                                             [ ok ]
 * >>> SetUID: [chmod go-r] /usr/lib64/misc/glibc/pt_chown ...                                                                                             [ ok ]
!!! Error extracting saved environment: '/var/db/pkg/sys-libs/glibc-2.8_p20080602-r1/environment.bz2'                                                            
 * The ebuild phase 'prerm' has exited unexpectedly. This type of behavior                                                                                       
 * is known to be triggered by things such as failed variable assignments                                                                                        
 * (bug #190128) or bad substitution errors (bug #200313). Normally, before                                                                                      
 * exiting, bash should have displayed an error message above. If bash did                                                                                       
 * not produce an error message above, it's possible that the ebuild has                                                                                         
 * called `exit` when it should have called `die` instead. This behavior                                                                                         
 * may also be triggered by a corrupt bash binary or a hardware problem                                                                                          
 * such as memory or cpu malfunction. If the problem is not reproducible or                                                                                      
 * it appears to occur randomly, then it is likely to be triggered by a                                                                                          
 * hardware problem. If you suspect a hardware problem then you should try                                                                                       
 * some basic hardware diagnostics such as memtest. Please do not report                                                                                         
 * this as a bug unless it is consistently reproducible and you are sure                                                                                         
 * that your bash binary and hardware are functioning properly.                                                                                                  
!!! FAILED prerm: 2816                                                                                                                                           
!!! Error extracting saved environment: '/var/db/pkg/sys-libs/glibc-2.8_p20080602-r1/environment.bz2'                                                            
 * The ebuild phase 'postrm' has exited unexpectedly. This type of behavior                                                                                      
 * is known to be triggered by things such as failed variable assignments                                                                                        
 * (bug #190128) or bad substitution errors (bug #200313). Normally, before                                                                                      
 * exiting, bash should have displayed an error message above. If bash did                                                                                       
 * not produce an error message above, it's possible that the ebuild has                                                                                         
 * called `exit` when it should have called `die` instead. This behavior                                                                                         
 * may also be triggered by a corrupt bash binary or a hardware problem                                                                                          
 * such as memory or cpu malfunction. If the problem is not reproducible or                                                                                      
 * it appears to occur randomly, then it is likely to be triggered by a                                                                                          
 * hardware problem. If you suspect a hardware problem then you should try                                                                                       
 * some basic hardware diagnostics such as memtest. Please do not report                                                                                         
 * this as a bug unless it is consistently reproducible and you are sure                                                                                         
 * that your bash binary and hardware are functioning properly.                                                                                                  
!!! FAILED postrm: 2816                                                                                                                                          
 * The 'postrm' phase of the 'sys-libs/glibc-2.8_p20080602-r1' package has                                                                                       
 * failed with exit value 2816.                                                                                                                                  
 *                                                                                                                                                               
 * The problem occurred while executing the ebuild file named                                                                                                    
 * 'glibc-2.8_p20080602-r1.ebuild' located in the '/var/db/pkg/sys-                                                                                              
 * libs/glibc-2.8_p20080602-r1' directory. If necessary, manually remove                                                                                         
 * the environment.bz2 file and/or the ebuild file located in that                                                                                               
 * directory.                                                                                                                                                    
 *                                                                                                                                                               
 * Removal of the environment.bz2 file is preferred since it may allow the                                                                                       
 * removal phases to execute successfully. The ebuild will be sourced and                                                                                        
 * the eclasses from the current portage tree will be used when necessary.                                                                                       
 * Removal of the ebuild file will cause the pkg_prerm() and pkg_postrm()                                                                                        
 * removal phases to be skipped entirely.                                                                                                                        
 * The ebuild phase 'postinst' has exited unexpectedly. This type of                                                                                             
 * behavior is known to be triggered by things such as failed variable                                                                                           
 * assignments (bug #190128) or bad substitution errors (bug #200313).                                                                                           
 * Normally, before exiting, bash should have displayed an error message                                                                                         
 * above. If bash did not produce an error message above, it's possible                                                                                          
 * that the ebuild has called `exit` when it should have called `die`                                                                                            
 * instead. This behavior may also be triggered by a corrupt bash binary or                                                                                      
 * a hardware problem such as memory or cpu malfunction. If the problem is                                                                                       
 * not reproducible or it appears to occur randomly, then it is likely to                                                                                        
 * be triggered by a hardware problem. If you suspect a hardware problem                                                                                         
 * then you should try some basic hardware diagnostics such as memtest.                                                                                          
 * Please do not report this as a bug unless it is consistently                                                                                                  
 * reproducible and you are sure that your bash binary and hardware are                                                                                          
 * functioning properly.                                                                                                                                         
!!! FAILED postinst: 2816                                                                                                                                        

>>> Failed to install sys-libs/glibc-2.9_p20081201-r2, Log file:

>>>  '/var/tmp/portage/sys-libs/glibc-2.9_p20081201-r2/temp/build.log'

 * Messages for package sys-libs/glibc-2.8_p20080602-r1:

 * The ebuild phase 'prerm' has exited unexpectedly. This type of behavior
 * is known to be triggered by things such as failed variable assignments 
 * (bug #190128) or bad substitution errors (bug #200313). Normally, before
 * exiting, bash should have displayed an error message above. If bash did 
 * not produce an error message above, it's possible that the ebuild has   
 * called `exit` when it should have called `die` instead. This behavior   
 * may also be triggered by a corrupt bash binary or a hardware problem    
 * such as memory or cpu malfunction. If the problem is not reproducible or
 * it appears to occur randomly, then it is likely to be triggered by a    
 * hardware problem. If you suspect a hardware problem then you should try 
 * some basic hardware diagnostics such as memtest. Please do not report   
 * this as a bug unless it is consistently reproducible and you are sure   
 * that your bash binary and hardware are functioning properly.            
 * The ebuild phase 'postrm' has exited unexpectedly. This type of behavior
 * is known to be triggered by things such as failed variable assignments  
 * (bug #190128) or bad substitution errors (bug #200313). Normally, before
 * exiting, bash should have displayed an error message above. If bash did 
 * not produce an error message above, it's possible that the ebuild has   
 * called `exit` when it should have called `die` instead. This behavior   
 * may also be triggered by a corrupt bash binary or a hardware problem    
 * such as memory or cpu malfunction. If the problem is not reproducible or
 * it appears to occur randomly, then it is likely to be triggered by a    
 * hardware problem. If you suspect a hardware problem then you should try 
 * some basic hardware diagnostics such as memtest. Please do not report   
 * this as a bug unless it is consistently reproducible and you are sure   
 * that your bash binary and hardware are functioning properly.            
 * The 'postrm' phase of the 'sys-libs/glibc-2.8_p20080602-r1' package has 
 * failed with exit value 2816.                                            
 *                                                                         
 * The problem occurred while executing the ebuild file named              
 * 'glibc-2.8_p20080602-r1.ebuild' located in the '/var/db/pkg/sys-        
 * libs/glibc-2.8_p20080602-r1' directory. If necessary, manually remove   
 * the environment.bz2 file and/or the ebuild file located in that         
 * directory.                                                              
 *                                                                         
 * Removal of the environment.bz2 file is preferred since it may allow the 
 * removal phases to execute successfully. The ebuild will be sourced and  
 * the eclasses from the current portage tree will be used when necessary. 
 * Removal of the ebuild file will cause the pkg_prerm() and pkg_postrm()  
 * removal phases to be skipped entirely.                                  

 * Messages for package sys-libs/glibc-2.9_p20081201-r2:

 * The ebuild phase 'postinst' has exited unexpectedly. This type of
 * behavior is known to be triggered by things such as failed variable
 * assignments (bug #190128) or bad substitution errors (bug #200313).
 * Normally, before exiting, bash should have displayed an error message
 * above. If bash did not produce an error message above, it's possible 
 * that the ebuild has called `exit` when it should have called `die`   
 * instead. This behavior may also be triggered by a corrupt bash binary or
 * a hardware problem such as memory or cpu malfunction. If the problem is 
 * not reproducible or it appears to occur randomly, then it is likely to  
 * be triggered by a hardware problem. If you suspect a hardware problem   
 * then you should try some basic hardware diagnostics such as memtest.    
 * Please do not report this as a bug unless it is consistently            
 * reproducible and you are sure that your bash binary and hardware are    
 * functioning properly.                                                   

 * Regenerating GNU info directory index...
 * Processed 200 info files.               
 * error scanning '/etc':  * error scanning '/usr/share/config':

Emerge exited at this point and this had no newline at end. Invoking emerge again fails.




Comment 1


Jaak Ristioja





          2009-06-28 20:12:13 UTC
        

After this all other packages will fail to emerge, new shells fail to spawn, everything is segfaulting. I think glibc is wasted.

# emerge --info
!!! No gcc found. You probably need to 'source /etc/profile'
!!! to update the environment of this terminal and possibly
!!! other terminals also.
Portage 2.1.6.13 (default/linux/amd64/2008.0/developer, [unavailable], glibc-2.9_p20081201-r2, 2.6.30-gentoo-r1-arm x86_64)
=================================================================
System uname: Linux-2.6.30-gentoo-r1-arm-x86_64-with-glibc2.2.5
Timestamp of tree: Sun, 28 Jun 2009 19:00:01 +0000
app-shells/bash:     3.2_p39
dev-lang/python:     2.5.4-r2
dev-util/cmake:      2.6.4
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.29
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -O2 -pipe -ggdb"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-march=core2 -O2 -pipe -ggdb"
DISTDIR="/usr/portage/distfiles"
FEATURES="collision-protect cvs distlocks fixpackages installsources multilib-strict parallel-fetch protect-owned sandbox sfperms sign splitdebug strict unmerge-orphans userfetch userpriv usersandbox usersync"
LANG="et_EE.UTF-8"
LDFLAGS="-Wl,-O1"
LINGUAS="en et de"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
USE="X acl acpi alsa amd64 apache2 aspell berkdb bindist bzip2 cairo caps cdr cli consolekit cracklib crypt cups dbus directfb djvu doc dri dvd dvdr dvdread eds emboss encode esd evo exif faac faad fam fbcon firefox flac fortran gdbm gif git glitz gmp gnokii gnutls gpm gstreamer gtk hal hdri htmlhandbook iconv icu idn ipv6 isdnlog jbig jpeg jpeg2k kde kontact kpathsea latex lcms libnotify lua lzma lzo mad mailwrapper md5sum midi mikmod mmx mng mp3 mp4 mpeg mudflap multilib mysql ncurses nptl nptlonly ogg opengl openmp pam pcre pdf perl phonon php pic plasma png postgres ppds pppd python qt3 qt3support qt4 quicktime readline reflection sdl semantic-desktop session snmp source spell spl sqlite sse sse2 ssl ssse3 startup-notification subversion svg sysfs tcpd threads tiff truetype ucs2 unicode usb vorbis webkit xcb xcomposite xetex xinerama xml xorg xprint xscreensaver xulrunner xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en et de" QEMU_SOFTMMU_TARGETS="arm i386 x86_64" QEMU_USER_TARGETS="arm i386 x86_64" USERLAND="GNU" VIDEO_CARDS="fbdev intel vesa i810"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

New programs, e.g. bash, less etc crash at startup. Here's output of dmesg|tail of a already running shell from about the time the emerge failed:
[348694.512029] debugedit[6998]: segfault at 7f918b5a3000 ip 00007f918b1fdea9 sp 00007fff0540f670 error 4 in libsandbox.so[7f918b1fa000+c000]
[348702.094229] debugedit[7190]: segfault at 7fbedf8b1000 ip 00007fbedf4e1ea9 sp 00007fff2f25c040 error 4 in libsandbox.so[7fbedf4de000+c000]
[348702.464431] debugedit[7200]: segfault at 7ff3f022a000 ip 00007ff3efe78ea9 sp 00007fffaeb15970 error 4 in libsandbox.so[7ff3efe75000+c000]
[348703.272196] debugedit[7220]: segfault at 7f27a5a08000 ip 00007f27a5653ea9 sp 00007fff4093eec0 error 4 in libsandbox.so[7f27a5650000+c000]
[348704.824450] debugedit[7260]: segfault at 7f7ecc692000 ip 00007f7ecc2d1ea9 sp 00007fff328ed530 error 4 in libsandbox.so[7f7ecc2ce000+c000]
[348706.871876] debugedit[7311]: segfault at 7f1d141d1000 ip 00007f1d13e04ea9 sp 00007fff9fe61880 error 4 in libsandbox.so[7f1d13e01000+c000]
[348712.721866] debugedit[7452]: segfault at 7f3aa67ca000 ip 00007f3aa640fea9 sp 00007fff18b7f440 error 4 in libsandbox.so[7f3aa640c000+c000]
[348716.894312] debugedit[7553]: segfault at 7f0a445691e8 ip 00007f0a4438723b sp 00007fffeb001750 error 4 in ld-2.8.so[7f0a4437a000+1c000]   
[348718.901888] debugedit[7603]: segfault at 7f2afe2b1000 ip 00007f2afdf02ea9 sp 00007fff4c1f6250 error 4 in libsandbox.so[7f2afdeff000+c000]
[348724.124924] debugedit[7734]: segfault at 7fff72290000 ip 00007fff71ee7ea9 sp 00007fffbb5973c0 error 4 in libsandbox.so[7fff71ee4000+c000]
[348725.266127] debugedit[7764]: segfault at 7ff466a67000 ip 00007ff4666b3ea9 sp 00007fff60fa6280 error 4 in libsandbox.so[7ff4666b0000+c000]
[348725.712238] debugedit[7774]: segfault at 7f1be563c000 ip 00007f1be528dea9 sp 00007fffdbf4b2e0 error 4 in libsandbox.so[7f1be528a000+c000]
[348727.894689] debugedit[7825]: segfault at 7fd411e52000 ip 00007fd411aa0ea9 sp 00007fff36c034e0 error 4 in libsandbox.so[7fd411a9d000+c000]
[348735.194299] debugedit[8006]: segfault at 7f728dc47000 ip 00007f728d8a1ea9 sp 00007fff394d76d0 error 4 in libsandbox.so[7f728d89e000+c000]
[348747.687632] debugedit[8309]: segfault at 7f108a64f000 ip 00007f108a29dea9 sp 00007fff9bc63430 error 4 in libsandbox.so[7f108a29a000+c000]
[348749.664582] debugedit[8359]: segfault at 7f76996b1000 ip 00007f7699305ea9 sp 00007fff332343b0 error 4 in libsandbox.so[7f7699302000+c000]
[348753.092466] debugedit[8440]: segfault at 7f8f701b8000 ip 00007f8f6fe06ea9 sp 00007fffe38dbef0 error 4 in libsandbox.so[7f8f6fe03000+c000]
[348754.321802] debugedit[8470]: segfault at 7f7f51117000 ip 00007f7f50d6bea9 sp 00007fffc2832560 error 4 in libsandbox.so[7f7f50d68000+c000]
[348755.914878] debugedit[8510]: segfault at 7f7e5ba70000 ip 00007f7e5b6c7ea9 sp 00007fff34273ed0 error 4 in libsandbox.so[7f7e5b6c4000+c000]
[348757.046741] debugedit[8541]: segfault at 7f21761c7000 ip 00007f2175e12ea9 sp 00007fffb0bb8050 error 4 in libsandbox.so[7f2175e0f000+c000]
[348758.225310] debugedit[8571]: segfault at 7f7a87f5b000 ip 00007f7a87ba0ea9 sp 00007fff87266ff0 error 4 in libsandbox.so[7f7a87b9d000+c000]
[348770.534484] debugedit[8873]: segfault at 7f9fe1eb0000 ip 00007f9fe1ae6ea9 sp 00007fffe20440c0 error 4 in libsandbox.so[7f9fe1ae3000+c000]
[348773.694285] debugedit[8954]: segfault at 7ffa6fa3a000 ip 00007ffa6f68eea9 sp 00007ffff7d4f230 error 4 in libsandbox.so[7ffa6f68b000+c000]
[348776.101525] debugedit[9014]: segfault at 7f44c21b9000 ip 00007f44c1e10ea9 sp 00007fff6a58b010 error 4 in libsandbox.so[7f44c1e0d000+c000]
[348777.689079] debugedit[9055]: segfault at 7f287689c000 ip 00007f28764f3ea9 sp 00007fffdae0d4e0 error 4 in libsandbox.so[7f28764f0000+c000]
[348778.555945] debugedit[9075]: segfault at 7fe9e9bf6000 ip 00007fe9e9826ea9 sp 00007fff7932cdd0 error 4 in libsandbox.so[7fe9e9823000+c000]
[348784.104386] debugedit[9206]: segfault at 7f8ac3994000 ip 00007f8ac35e9ea9 sp 00007fff8573ef70 error 4 in libsandbox.so[7f8ac35e6000+c000]
[348805.911749] debugedit[9743]: segfault at 7f3769f89000 ip 00007f3769bceea9 sp 00007fffaddb9200 error 4 in libsandbox.so[7f3769bcb000+c000]
[348859.894088] stty[11419]: segfault at 0 ip (null) sp 00007fff6b9c0ae8 error 14 in stty[400000+e000]                                       
[348859.905979] sh[11420]: segfault at 0 ip (null) sp 00007fffca6b51d8 error 14 in bash[400000+b9000]                                        
[348859.922250] bash[11421]: segfault at 0 ip (null) sp 00007fff98b354d8 error 14 in bash[400000+b9000]                                      
[348862.075130] stty[11423]: segfault at 0 ip (null) sp 00007ffffd2d5c48 error 14 in stty[400000+e000]                                       
[348862.106073] sh[11424]: segfault at 0 ip (null) sp 00007fff38fd19b8 error 14 in bash[400000+b9000]                                        
[348862.146148] bash[11425]: segfault at 0 ip (null) sp 00007fffe9f5f518 error 14 in bash[400000+b9000]                                      
[348862.680718] sh[11426]: segfault at 0 ip (null) sp 00007fff3e439a28 error 14 in bash[400000+b9000]                                        
[348862.869432] stty[11427]: segfault at 0 ip (null) sp 00007fffdc9fcb38 error 14 in stty[400000+e000]                                       
[348862.905574] bash[11428]: segfault at 0 ip (null) sp 00007fffcae61b58 error 14 in bash[400000+b9000]                                      
[348864.267801] sh[11429]: segfault at 0 ip (null) sp 00007fff669dcfd8 error 14 in bash[400000+b9000]                                        
[348864.931743] __ratelimit: 25 callbacks suppressed                                                                                         
[348864.931754] sh[11455]: segfault at 0 ip (null) sp 00007fff38943db8 error 14 in bash[400000+b9000]                                        
[348864.956184] sh[11456]: segfault at 0 ip (null) sp 00007fffbd752b88 error 14 in bash[400000+b9000]                                        
[348864.980558] sh[11457]: segfault at 0 ip (null) sp 00007fff7663a868 error 14 in bash[400000+b9000]                                        
[348865.005147] sh[11458]: segfault at 0 ip (null) sp 00007fff60c5f968 error 14 in bash[400000+b9000]                                        
[348865.033574] sh[11459]: segfault at 0 ip (null) sp 00007fff365130b8 error 14 in bash[400000+b9000]                                        
[348865.083536] sh[11460]: segfault at 0 ip (null) sp 00007fff04221078 error 14 in bash[400000+b9000]                                        
[348865.117042] sh[11461]: segfault at 0 ip (null) sp 00007fff0fc885e8 error 14 in bash[400000+b9000]                                        
[348865.141446] sh[11462]: segfault at 0 ip (null) sp 00007fff80e14248 error 14 in bash[400000+b9000]                                        
[348865.168302] sh[11463]: segfault at 0 ip (null) sp 00007fff6bb8d7b8 error 14 in bash[400000+b9000]                                        
[348865.199143] sh[11464]: segfault at 0 ip (null) sp 00007fffca5c8a68 error 14 in bash[400000+b9000]                                        
[348900.779797] __ratelimit: 168 callbacks suppressed                                                                                        
[348900.779808] hal-system-lcd-[11640]: segfault at 0 ip (null) sp 00007fffaf08e8e8 error 14 in bash[400000+b9000]                           
[348900.786343] hal-system-lcd-[11641]: segfault at 0 ip (null) sp 00007fff19b155c8 error 14 in bash[400000+b9000]                           
[348932.304388] sh[11650]: segfault at 0 ip (null) sp 00007fff37e3af38 error 14 in bash[400000+b9000]                                        
[348932.310848] sh[11651]: segfault at 0 ip (null) sp 00007fff07d545a8 error 14 in bash[400000+b9000]                                        
[348938.969551] stty[11653]: segfault at 0 ip (null) sp 00007fff63ab3568 error 14 in stty[400000+e000]                                       
[348939.121388] sh[11655]: segfault at 0 ip (null) sp 00007fffd0f734e8 error 14 in bash[400000+b9000]                                        
[348939.123584] sh[11656]: segfault at 0 ip (null) sp 00007fff3db29408 error 14 in bash[400000+b9000]                                        
[348939.915967] bash[11657]: segfault at 0 ip (null) sp 00007fffafd102b8 error 14 in bash[400000+b9000]                                      
[348939.924577] bash[11658]: segfault at 0 ip (null) sp 00007fff0f9a91f8 error 14 in bash[400000+b9000]                                      
[348940.374314] stty[11659]: segfault at 0 ip (null) sp 00007fff79cc7ec8 error 14 in stty[400000+e000]                                       
[348940.391748] bash[11660]: segfault at 0 ip (null) sp 00007fff3785d9c8 error 14 in bash[400000+b9000]                                      
[349006.556200] sh[11676]: segfault at 0 ip (null) sp 00007fff16058dc8 error 14 in bash[400000+b9000]                                        
[349006.568613] sh[11677]: segfault at 0 ip (null) sp 00007fff7e15ce18 error 14 in bash[400000+b9000]                                        
[349070.956640] sh[11691]: segfault at 0 ip (null) sp 00007fff9b2315b8 error 14 in bash[400000+b9000]                                        
[349070.960879] sh[11692]: segfault at 0 ip (null) sp 00007fff7d7b9ae8 error 14 in bash[400000+b9000]
[349075.202831] stty[11694]: segfault at 0 ip (null) sp 00007fff903efa48 error 14 in stty[400000+e000]
[349075.244745] sh[11696]: segfault at 0 ip (null) sp 00007fff85fd5de8 error 14 in bash[400000+b9000]
[349075.246098] sh[11697]: segfault at 0 ip (null) sp 00007ffff345f148 error 14 in bash[400000+b9000]
[349075.937102] bash[11698]: segfault at 0 ip (null) sp 00007fff9b9d90c8 error 14 in bash[400000+b9000]
[349075.945925] bash[11699]: segfault at 0 ip (null) sp 00007fff2185bcf8 error 14 in bash[400000+b9000]
[349080.558304] stty[11703]: segfault at 0 ip (null) sp 00007fff85eabbe8 error 14 in stty[400000+e000]
[349080.574432] bash[11704]: segfault at 0 ip (null) sp 00007ffffe265a38 error 14 in bash[400000+b9000]
[349093.634762] utempter[11713]: segfault at 0 ip (null) sp 00007fffc5f153c8 error 14 in utempter[400000+1000]
[349093.648129] bash[11712]: segfault at 0 ip (null) sp 00007fffbb68a048 error 14 in bash[400000+b9000]
[349380.362342] less[11773]: segfault at 0 ip (null) sp 00007fff7241ca88 error 14 in less[400000+20000]
[349387.991047] gdb[11778]: segfault at 0 ip (null) sp 00007fffe6f4a438 error 14 in gdb[400000+35c000]
[349459.334838] sh[11794]: segfault at 0 ip (null) sp 00007fff1bcb3af8 error 14 in bash[400000+b9000]
[349459.339032] sh[11795]: segfault at 0 ip (null) sp 00007fffdd38d528 error 14 in bash[400000+b9000]
[349460.257306] sh[11796]: segfault at 0 ip (null) sp 00007fff75e58418 error 14 in bash[400000+b9000]
[349460.263744] sh[11797]: segfault at 0 ip (null) sp 00007fff484948d8 error 14 in bash[400000+b9000]
[349460.269474] sh[11798]: segfault at 0 ip (null) sp 00007fffeb7d12d8 error 14 in bash[400000+b9000]
[349460.315098] sh[11799]: segfault at 0 ip (null) sp 00007fff412c7228 error 14 in bash[400000+b9000]
[349460.321227] sh[11800]: segfault at 0 ip (null) sp 00007fff1161a038 error 14 in bash[400000+b9000]




Comment 2


Jaak Ristioja





          2009-06-28 22:30:55 UTC
        

Manually restoring glibc-2.8 and then trying to re-emerge glibc-2.9 again fails with the exact same results. Therefore this bug is reproducable.




Comment 3


Michael





          2009-06-29 13:25:54 UTC
        

I can confirm this behavior.
gcc 4.3.2-r2 on amd64
chost march=core2 -O2 -pipe
after updating, the system is unusable. Some apps segfaulting (wget, kdm, gdb etc).
strace worked, here is a sample from wget: http://pastebin.com/d6b7d9ec9




Comment 4


SpanKY






          2009-06-29 18:06:35 UTC
        

try using a different -march other than core2




Comment 5


Michael Weber (RETIRED)






          2009-06-29 21:29:29 UTC
        

hi, i've used this version og glibc for two months or so on core2 with gcc-4.3.3-*, without any problems. The actual emegre (newer libtool and auto*)

Portage 2.1.6.13 (default/linux/amd64/2008.0, gcc-4.3.3, glibc-2.10.1-r0, 2.6.29-gentoo-r5 x86_64)
=================================================================
System uname: Linux-2.6.29-gentoo-r5-x86_64-Intel-R-_Core-TM-2_Duo_CPU_T7300_@_2.00GHz-with-glibc2.2.5
Timestamp of tree: Mon, 29 Jun 2009 00:00:01 +0000
distcc 3.1 x86_64-pc-linux-gnu [disabled]
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p39
dev-java/java-config: 2.1.7
dev-lang/python:     2.5.4-r2
dev-util/ccache:     2.4-r7
dev-util/cmake:      2.6.4
sys-apps/baselayout: 2.0.0
sys-apps/openrc:     0.4.3-r3
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6a
virtual/os-headers:  2.6.29
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -mtune=core2 -mfpmath=sse -mieee-fp -O2 -pipe -mmmx -msse -msse2 -msse2 -mssse3"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-march=core2 -mtune=core2 -mfpmath=sse -mieee-fp -O2 -pipe -mmmx -msse -msse2 -msse2 -mssse3"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--jobs 2 --keep-going"
FEATURES="ccache distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://nash.fs.lmu.de/gentoo/"
LANG="en_US.UTF-8"
LC_ALL="en_US.UTF-8"
LDFLAGS="-Wl,-O1"
LINGUAS="de en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/sunrise /usr/local/portage/layman/wschlich-testing /usr/local/portage/layman/gnome /usr/local/portage/layman/xmw /usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac aalib acl acpi alsa amd64 bash-completion berkdb bluetooth bzip2 cairo cddb cdparanoia cli consolekit cracklib crypt cups dbus dga directfb djvu doc dri dts dv dvb dvd dvdr dvdread encode exif fbcon ffmpeg fftw flac fontconfig fortran gdbm gif gimp glut gnome gnome-keyring gnutls gphoto2 gpm gs gtk hal iconv imagemagick ipod ipv6 isdnlog java java6 jbig joystick jpeg jpeg2k lame latex lcms libsamplerate lm_sensors lzma lzo mad midi mikmod mmap mmx mng mp3 mpeg mplayer mudflap multilib mysql ncurses nls nptl nptlonly nsplugin ogg openal openexr opengl openmp pam pch pcmcia pcre pdf perl png postgres pppd python qt3 qt4 quicktime raw readline reflection rle samba sdl session smp speex spell spl sqlite sse sse2 ssl svg symlink sysfs syslog tcl tcpd theora threads tiff tk truetype unicode usb vim-syntax vorbis wavpack x264 xcb xine xinerama xml xorg xscreensaver xulrunner xv xvid zlib" ALSA_CARDS="intel-hda" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev joystick" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de en" USERLAND="GNU" VIDEO_CARDS="intel"
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 6


Michael





          2009-06-30 07:36:15 UTC
        

(In reply to comment #4)
> try using a different -march other than core2
> 

-march=nocona
Re-emerged glibc and wget, did not help.

Re-emerged -e system, did not help.

Portage does not allow downgrading of glibc (emerge sainty check fails), but probally -r2 downgraded to -r1 should not cause breaking of all binaries, or? Is there a way to disable the portage sainty check?




Comment 7


Michael Weber (RETIRED)






          2009-06-30 09:23:58 UTC
        

(In reply to comment #6)
> Portage does not allow downgrading of glibc (emerge sainty check fails), but
> probally -r2 downgraded to -r1 should not cause breaking of all binaries, or?
> Is there a way to disable the portage sainty check?

yes, edit the /usr/portage/sys-libs/glibc/glibc-2.8_p20080602-r1.ebuild in line 224 following and remove the santiy check.
then an ebuild /usr/portage/sys-libs/glibc/glibc-2.8_p20080602-r1.ebuild manifest and you can downgrade via emerge. Maybe you make a backup of the current ... working ... system.





Comment 8


Michael





          2009-06-30 18:06:09 UTC
        

> Maybe you make a backup of the
> current ... working ... system.

Then there is not much to backup :P (mz system is pretty useless at the moment)

I saw that 2.9-...-r1 is keyworded - so maybe I confused something when I sad this happend with the update of 2.9...-r1 to r2. It was the regular systemupdate and I do not remember my preverious version. Eventually it was 2.8...-r1 to 2.9...-r2


Anyways, I downgraded to 2.9_...-r1, and it did not help. wget still segfaulting like the other tools. If anyone could show me a guide or tell me how to propperly get useful debug information, I will gladly help.




Comment 9


Michael





          2009-07-01 20:04:22 UTC
        

I guve up, reinstalling my system.




Comment 10


Jaak Ristioja





          2009-07-01 22:27:01 UTC
        

(In reply to comment #9)
> I guve up, reinstalling my system.
> 

I think while trying to fix this glibc bug (without rebooting my system), I might have erased some of my root partition, so i've been busy in the last 2 evenings reinstalling gentoo. Good news is that now I have glibc-2.9. Bad news is that because of that, I probably can't help to fix this bug.




Comment 11


Michael





          2009-09-30 11:51:49 UTC
        

I assume we can put a 'wont fix' under this here, or? Since the current libc works and whatever caused it, is gone now.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

