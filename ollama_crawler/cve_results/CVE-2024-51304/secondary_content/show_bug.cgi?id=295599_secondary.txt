Title: 295599 – x11-drivers/ati-drivers-9.11: fglrx_gamma.c: “X11/extensions/{XTest,record,xf86vmode}.h” not found / missing!
URL: https://bugs.gentoo.org/show_bug.cgi?id=295599

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 295599
x11-drivers/ati-drivers-9.11: fglrx_gamma.c: “X11/extensions/{XTest,record,xf86vmode}.h” not found / missing!
Last modified: 2009-12-19 14:48:51 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 295599 
      - x11-drivers/ati-drivers-9.11: fglrx_gamma.c: “X11/extensions/{XTest,record,xf86vmode}.h” not found / missing!


Summary:
x11-drivers/ati-drivers-9.11: fglrx_gamma.c: “X11/extensions/{XTest,record,xf...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Unspecified

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-12-03 23:24 UTC by Navid Zamani





      Modified:
    
2009-12-19 14:48 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Full build log for the failed ebuild.

              (x11-drivers:ati-drivers-9.11:20091203-223021.log,5.69 KB,
                text/plain)

            
2009-12-03 23:26 UTC,

            Navid Zamani




Details





emerge --info

              (emerge --info.txt,4.99 KB,
                text/plain)

            
2009-12-03 23:27 UTC,

            Navid Zamani




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Navid Zamani





          2009-12-03 23:24:14 UTC
        

Hello guys. Compiling ati-drivers-9.11 does fail here. I’ll attached the full log, but see “Actual Results” (manually translated back!) below for the relevant excerpt.



Reproducible: Always

Steps to Reproduce:
1. Make sure you have xorg-server-1.6.5 and xorg-x11-7.4-r1 installed. (Not sure if that makes a difference, but I have those versions, so: Your call. :)
2. “emerge -u ati-drivers” (Should choose 9.11. If not, choose it manually, and perhaps leave away “-u”. I’m also not sure if “-D” would make a difference.)
3. Wait until after “Building fglrx_gamma lib ...”


Actual Results:  
fglrx_gamma.c:19:34: Error: X11/extensions/XTest.h: File or Directory not found
fglrx_gamma.c:23:35: Error: X11/extensions/record.h: File or Directory not found
In file, included from fglrx_gamma.c:41:
fglrx_gamma.h:17:38: Error: X11/extensions/xf86vmode.h: File or Directory not found
In file included from fglrx_gamma.c:41:
fglrx_gamma.h:44: Error: expected »=«, »,«, »;«, »asm« or »__attribute__« before »FGLRX_X11Gamma_float«
fglrx_gamma.h:69: Error: expected declaration specifiers or »...« before »FGLRX_X11Gamma_float«
fglrx_gamma.h:77: Error: expected declaration specifiers or »...« before »FGLRX_X11Gamma_float«
fglrx_gamma.c:217: Error: expected declaration specifiers or »...« before »FGLRX_X11Gamma_float«
fglrx_gamma.c: In function »FGLRX_X11SetGammaRamp_float«:
fglrx_gamma.c:253: Error: »Gamma« not declared (first use in this function)
fglrx_gamma.c:253: Error: (Every non-declared identifier is listed only once
fglrx_gamma.c:253: Error: for each function where it occurs.)
fglrx_gamma.c: On the highest level:
fglrx_gamma.c:499: Error: expected declaration specifiers or »...« before »FGLRX_X11Gamma_float«
fglrx_gamma.c: In function »FGLRX_X11SetGamma«:
fglrx_gamma.c:522: Error: »Gamma« not declared (first usage in this function)



Expected Results:  
Successful installation of ati-drivers-9.11.



IMPORTANT: I noticed, that at at least icedtea6-1.6.2, and other packages could have the same problem with XTest.h missing. So I guess it’s not a problem in ati-drivers itself. Unfortunately I have no idea how to track down the real cause.

My system wants to install x11-base/xorg-server-1.6.5-r1 too, but unfortunately that fails too, right now. :/




Comment 1


Navid Zamani





          2009-12-03 23:26:03 UTC
        

Created attachment 211931 [details]
Full build log for the failed ebuild.




Comment 2


Navid Zamani





          2009-12-03 23:27:02 UTC
        

Created attachment 211932 [details]
emerge --info




Comment 3


Navid Zamani





          2009-12-03 23:28:02 UTC
        

Oh, and if you need a proper translation of the german words in the build log, I recommend http://dict.leo.org/ .




Comment 4


Navid Zamani





          2009-12-03 23:38:34 UTC
        

Wait… xorg-server-1.6.5-r1 also misses “X11/extensions/xf86vmode.h”.

Which seems to belong to no package…




Comment 5


Navid Zamani





          2009-12-03 23:51:02 UTC
        

Ok, it looks like all this was caused by some stupid manual masking, because ati-drivers still does not work with xorg-1.7. I *knew* this would happes. I felt dirty, and had to ask twice, before I copied the masking lines into my package.mask.

The problem is: We fglrx users need to stay with 1.6.5 for a bit of time. But nobody knows the proper packages to mask. (Why doesn’t it suffice to mask “>=xorg-1.7”?)

I’m now trying to unmask stuff until it works. IF it works.

BUT: Has anyone got the *proper* list of mask lines to block >=xorg-1.7? That would be really great! :/




Comment 6


Navid Zamani





          2009-12-04 01:44:33 UTC
        

(In reply to comment #5)
Great, but unmasking means a new version of xextwhatever gets installed. And that one does not have XTest.h anymore. :(

So back to masking them again.




Comment 7


Navid Zamani





          2009-12-04 02:31:51 UTC
        

Ah, interesting! After re-merging various X packages (e.g. all those masked), the missing files return again, and the compilation of xorg and ati-drivers goes trough successfully!

Here are the packages:
x11-proto/xf86vidmodeproto-2.2.2
x11-proto/xextproto-7.0.5
x11-libs/libX11-1.2.2
x11-libs/libXext-1.0.5
x11-libs/libXxf86vm-1.0.2
x11-proto/recordproto-1.13.2
x11-proto/xf86dgaproto-2.0.3





Comment 8


Navid Zamani





          2009-12-04 02:36:02 UTC
        

(In reply to comment #7)
> (e.g. all those masked),

I meant (all those that were installed, because of the masking. I did not install those that were masked! ^^

And the list shows those packages that I re-installed. :)

Finally! :)

I am still interested in where that mess comes from. Anyone here who cares to explain it?




Comment 9


Uros





          2009-12-05 10:52:33 UTC
        

(In reply to comment #8)
> (In reply to comment #7)
> > (e.g. all those masked),
> 
> I meant (all those that were installed, because of the masking. I did not
> install those that were masked! ^^
> 
> And the list shows those packages that I re-installed. :)
> 
> Finally! :)
> 
> I am still interested in where that mess comes from. Anyone here who cares to
> explain it?
> 

(In reply to comment #7)
> Ah, interesting! After re-merging various X packages (e.g. all those masked),
> the missing files return again, and the compilation of xorg and ati-drivers
> goes trough successfully!
> 
> Here are the packages:
> x11-proto/xf86vidmodeproto-2.2.2
> x11-proto/xextproto-7.0.5
> x11-libs/libX11-1.2.2
> x11-libs/libXext-1.0.5
> x11-libs/libXxf86vm-1.0.2
> x11-proto/recordproto-1.13.2
> x11-proto/xf86dgaproto-2.0.3
> 

What a mess!!!
I came to the same fglrx xorg 1.6.5 dependecy mess (hell) 
my working package mask 
#XORG1.6.5--Start
>=x11-libs/libXinerama-1.1
>=x11-proto/xineramaproto-1.2
>=x11-base/xorg-server-1.7
>=x11-proto/xcmiscproto-1.2.0
>=x11-proto/bigreqsproto-1.1.0
>=x11-proto/xf86driproto-2.1.0
>=x11-proto/xf86bigfontproto-1.2.0
>=x11-base/xorg-drivers-1.7
>=x11-proto/xextproto-7.1.1
>=x11-proto/fixesproto-4.1.1
>=x11-proto/inputproto-2.0
>=x11-libs/libX11-1.3.2
>=x11-libs/libXext-1.1.1
>=x11-apps/xinput-1.5.0
>=x11-proto/xf86vidmodeproto-2.3
>=x11-libs/libXxf86vm-1.1.0
>=x11-proto/recordproto-1.14
>=x11-libs/libXtst-1.1.0
>=x11-proto/scrnsaverproto-1.2.0
>=x11-libs/libXScrnSaver-1.2.0
>=x11-proto/xineramaproto-1.2
>=x11-libs/libXinerama-1.1
>=x11-proto/xf86dgaproto-2.1
>=x11-libs/libXxf86dga-1.1.1
>=x11-libs/libX11-1.3.2
>=x11-libs/libXext-1.1.1
>=x11-proto/inputproto-2.0
>=x11-libs/libXi-1.3
>xfce-base/xfce4-settings-4.6.3
>xfce-extra/xfce4-xkb-plugin-0.5.3.3
>=gnome-base/libgnomekbd-2.28.0
>=gnome-base/gnome-settings-daemon-2.28.0
>=gnome-base/gnome-control-center-2.28.0
>=gnome-base/gnome-applets-2.28.0
>=gnome-extra/gnome-screensaver-2.28.0
>=gnome-extra/gucharmap-2.28.0
>x11-proto/xextproto-7.0.5
>x11-proto/xf86vidmodeproto-2.2.2
>x11-base/xorg-server-1.6.5-r1
<=x11-base/xorg-server-1.6.3.901-r2
>=x11-libs/libXxf86vm-1.1.0
>x11-apps/x11perf-1.5
>x11-apps/xrdb-1.0.6
#XORG1.6.5--END












Comment 10


Navid Zamani





          2009-12-05 19:21:50 UTC
        

(In reply to comment #9)
> What a mess!!!
> I came to the same fglrx xorg 1.6.5 dependecy mess (hell) 
> my working package mask 

I agree. Here is my mask. It is shorter. Maybe thet helps you somewhat:

>=x11-apps/xinput-1.5.0
>=x11-base/xorg-drivers-1.7
>=x11-base/xorg-server-1.7.1
>=x11-libs/libX11-1.3.2
>=x11-libs/libXScrnSaver-1.2.0
>=x11-libs/libXext-1.1.1
>=x11-libs/libXi-1.3
>=x11-libs/libXinerama-1.1
>=x11-libs/libXtst-1.1.0
>=x11-libs/libXxf86dga-1.1.1
>=x11-libs/libXxf86vm-1.1.0
>=x11-proto/bigreqsproto-1.1.0
>=x11-proto/fixesproto-4.1.1
>=x11-proto/inputproto-2.0
>=x11-proto/recordproto-1.14
>=x11-proto/scrnsaverproto-1.2.0
>=x11-proto/xcmiscproto-1.2.0
>=x11-proto/xextproto-7.1.1
>=x11-proto/xf86bigfontproto-1.2.0
>=x11-proto/xf86dgaproto-2.1
>=x11-proto/xf86driproto-2.1.0
>=x11-proto/xf86vidmodeproto-2.3
>=x11-proto/xineramaproto-1.2

But since I still don’t even know what those packages have in common, what other X packages don’t have, I can’t say it’s complete, or overkill. The only thing I know is that it just feels plain wrong and nasty. ^^




Comment 11


Navid Zamani





          2009-12-05 19:24:45 UTC
        

(In reply to comment #10)
> The only thing I know is that it just feels plain wrong and nasty. ^^

And my guess is that that is the reason, why I can’t ever compile something (emerging, kernel) in a X terminal (yakuake, konsole), without it crashing the graphics system so that I have to restart. (But it works fine when ran from a normal text or framebuffer VT.)




Comment 12


Samuli Suominen (RETIRED)






          2009-12-19 10:36:27 UTC
        

In general for amd64/x86:

Packages that's marked stable is for X.org 1.6
Packages that's marked ~arch is for X.org 1.7

Either way mixing arch/with ~arch or local masking a.k.a. mixing isn't supported. I'm closing this.

Use xf86-video-ati.




Comment 13


Navid Zamani





          2009-12-19 14:48:51 UTC
        

(In reply to comment #12)

> Packages that's marked stable is for X.org 1.6
> Packages that's marked ~arch is for X.org 1.7
For *now*. Doesn’t help in the long run.
Also, who does know this, despite people internally at Gentoo?

> Either way mixing arch/with ~arch or local masking a.k.a. mixing isn't
> supported.
Agreed, that’s trouble.
Then again, using only stable packages means your entire system is outdated by a good 1-2 *years*. So for a modern desktop, that is way out of the question.

So how do I know, what packages are X-related in this context? Which one do i have to force to stable, until fglrx can do 1.7? (No, everything in x11-*/* is not sensible.)

>  I'm closing this.

How exactly is this problem solved then? It may work for you, because you do not have to *use* the card, and did not pay money for it. (No, I can’t buy another one, unless you pay me.) 
Now I sit here with a halfway non-workable system because of this shit.

> Use xf86-video-ati.
You’re kidding, right? Have you ever tried that with a 4850? Or a 5xxx?
NO 3D support, no compositing, nothing. Only most basic stuff.
That is not a recommendation. It’s an insult coming from ignorance. Sorry, if you did not mean it that way, but that’s what it is.

I have a general rule for you:
xf86-video-ati is *useless* for anything beyond the 3xxx line. And even there, 3D support still is pretty crappy.

But it’s so convenient to use a known straw man “solution”, right?

P.S.: The unfriendliness of this comment is solely based on the unfriendliness I received and being treated like an idiot. You can thank yourself for that.











Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

