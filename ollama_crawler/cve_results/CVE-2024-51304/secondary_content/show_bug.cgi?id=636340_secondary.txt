Title: 636340 – dev-lisp/sbcl-1.4.1 - debugger invoked on a SB-C::INPUT-ERROR-IN-LOAD: READ error during LOAD: The value -4095 is not of type (OR UNSIGNED-BYTE BOOLEAN) from the function type declaration.
URL: https://bugs.gentoo.org/show_bug.cgi?id=636340

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 636340
dev-lisp/sbcl-1.4.1 - debugger invoked on a SB-C::INPUT-ERROR-IN-LOAD: READ error during LOAD: The value -4095 is not of type (OR UNSIGNED-BYTE BOOLEAN) from the function type declaration.
Last modified: 2017-12-07 05:41:01 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 636340 
      - dev-lisp/sbcl-1.4.1 - debugger invoked on a SB-C::INPUT-ERROR-IN-LOAD: READ error during LOAD: The value -4095 is not of type (OR UNSIGNED-BYTE BOOLEAN) from the function type declaration.


Summary:
dev-lisp/sbcl-1.4.1 - debugger invoked on a SB-C::INPUT-ERROR-IN-LOAD: READ e...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Common Lisp Bugs








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2017-11-03 03:21 UTC by Andrey Grozin





      Modified:
    
2017-12-07 05:41 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



bugs
endymion+gentoo
proxy-maint









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




full log (bzip2ed)

              (sbcl-1.4.1.log.bz2,14.67 KB,
                application/x-bzip2)

            
2017-11-07 03:10 UTC,

            Andrey Grozin




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andrey Grozin






          2017-11-03 03:21:00 UTC
        

+ echo //doing warm init - compilation phase
//doing warm init - compilation phase
+ ./src/runtime/sbcl --core output/cold-sbcl.core --lose-on-corruption --no-sysinit --no-userinit --eval '(sb-fasl::!warm-load "src/cold/warm.lisp")' --quit
This is SBCL 1.4.1, an implementation of ANSI Common Lisp.
More information about SBCL is available at <http://www.sbcl.org/>.

SBCL is free software, provided as is, with absolutely no warranty.
It is mostly in the public domain; some portions are provided under
BSD-style licenses.  See the CREDITS and COPYING files in the
distribution for more information.
COLD-INIT... ("Length(TLFs)= " 13496)


debugger invoked on a SB-C::INPUT-ERROR-IN-LOAD:
  READ error during LOAD:

    The value
      -4095
    is not of type
      (OR UNSIGNED-BYTE BOOLEAN)
    from the function type declaration.


Type HELP for debugger help, or (SB-EXT:EXIT) to exit from SBCL.

restarts (invokable by number or by possibly-abbreviated name):
    (in form starting at line: 1, column: NIL, position: 0)
  0: [ABORT   ] Abort loading file "/var/tmp/portage/dev-lisp/sbcl-1.4.1/work/sbcl-1.4.1/src/cold/warm.lisp".
  1:            Abort building SBCL.
  2: [CONTINUE] Ignore runtime option --eval "(sb-fasl::!warm-load \"src/cold/warm.lisp\")".
  3:            Skip rest of --eval and --load options.
  4:            Skip to toplevel READ/EVAL/PRINT loop.
  5: [EXIT    ] Exit SBCL (calling #'EXIT, killing the process).

(SB-C:COMPILER-ERROR SB-C::INPUT-ERROR-IN-LOAD :CONDITION #<TYPE-ERROR {ABD6BA1}> :POSITION 0 :LINE/COL (1) :STREAM #<SB-INT:FORM-TRACKING-STREAM for "file /var/tmp/portage/dev-lisp/sbcl-1.4.1/work/sbcl-1.4.1/src/cold/warm.lisp" {ABD1BE9}>)
0]




Comment 1


Andrey Grozin






          2017-11-03 05:55:46 UTC
        

CC'ing nimiux@gentoo.org because he has done this latest version bump.




Comment 2


Andrey Grozin






          2017-11-03 11:19:46 UTC
        

As I wrote in the original title of this bug, this problem happens on my ~x86 box. On my ~amd64 box sbcl-1.4.1 builds and works fine.




Comment 3


Chema Alonso Josa (RETIRED)






          2017-11-04 18:50:47 UTC
        

(In reply to Andrey Grozin from comment #2)
> As I wrote in the original title of this bug, this problem happens on my
> ~x86 box. On my ~amd64 box sbcl-1.4.1 builds and works fine.

Can you post your emerge --info ?




Comment 4


Andrey Grozin






          2017-11-07 03:10:11 UTC
        

Created attachment 502896 [details]
full log (bzip2ed)

elrond ~ # emerge --info '=dev-lisp/sbcl-1.4.1::gentoo'
Portage 2.3.13 (python 3.6.3-final-0, default/linux/x86/13.0/desktop/plasma, gcc-6.4.0, glibc-2.25-r9, 4.9.0-gentoo i686)
=================================================================
                         System Settings
=================================================================
System uname: Linux-4.9.0-gentoo-i686-Pentium-R-_Dual-Core_CPU_E5300_@_2.60GHz-with-gentoo-2.4.1
KiB Mem:     2060820 total,    225192 free
KiB Swap:    2088412 total,   1971148 free
Timestamp of repository gentoo: Thu, 02 Nov 2017 02:45:01 +0000
Head commit of repository gentoo: fdee63cf68b25c81d5ca71354bb28e0afd77ea46
Head commit of repository lisp: 1a67c52d2f08e4c1e8853a48313c87a5a42b54ce

Head commit of repository science: 570e33bc02d06a5afbf955cd458f6cd1b1fbc786

sh bash 4.4_p12
ld GNU ld (Gentoo 2.29.1 p3) 2.29.1
app-shells/bash:          4.4_p12::gentoo
dev-java/java-config:     2.2.0-r3::gentoo
dev-lang/perl:            5.26.1-r1::gentoo
dev-lang/python:          2.7.14::gentoo, 3.4.6::gentoo, 3.5.4::gentoo, 3.6.3::gentoo
dev-util/cmake:           3.9.4::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.4.1-r2::gentoo
sys-apps/openrc:          0.34.5::gentoo
sys-apps/sandbox:         2.12::gentoo
sys-devel/autoconf:       2.13::gentoo, 2.59-r7::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.9.6-r3::gentoo, 1.10.3::gentoo, 1.11.6::gentoo, 1.12.6::gentoo, 1.13.4-r1::gentoo, 1.14.1-r1::gentoo, 1.15.1-r1::gentoo
sys-devel/binutils:       2.27::gentoo, 2.28-r2::gentoo, 2.29.1-r1::gentoo
sys-devel/gcc:            5.4.0-r3::gentoo, 6.3.0::gentoo, 6.4.0::gentoo
sys-devel/gcc-config:     1.9.0::gentoo
sys-devel/libtool:        2.4.6-r4::gentoo
sys-devel/make:           4.2.1-r1::gentoo
sys-kernel/linux-headers: 4.13::gentoo (virtual/os-headers)
sys-libs/glibc:           2.25-r9::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.europe.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts: 

lisp
    location: /var/lib/layman/lisp
    sync-type: git
    sync-uri: git://anongit.gentoo.org/proj/lisp.git
    masters: gentoo
    priority: 50

science
    location: /var/lib/layman/science
    sync-type: git
    sync-uri: git://anongit.gentoo.org/proj/sci.git
    masters: gentoo
    priority: 50

grozin
    location: /usr/local/portage
    masters: gentoo
    priority: 60

ACCEPT_KEYWORDS="x86 ~x86"
ACCEPT_LICENSE="*"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib/libreoffice/program/sofficerc /usr/share/config /usr/share/gnupg/qualified.txt /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php7.1/ext-active/ /etc/php/cgi-php7.1/ext-active/ /etc/php/cli-php7.1/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -march=native -pipe"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -march=i686 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync multilib-strict news parallel-fetch preserve-libs protect-owned sandbox sfperms sign strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -march=native -pipe"
GENTOO_MIRRORS="ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo"
LANG="ru_RU.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="X a52 aac acpi activities alsa bash-completion berkdb blas bluetooth boehm-gc branding bzip2 cairo cdda cdr consolekit cracklib crypt css cups curl cxx dbus declarative doc dri dvd dvdr emacs enca encode exif fam fftw firefox flac fltk fortran gd gdbm gif glamor gmp gpm gsl gtk iconv imagemagick jpeg kde kipi kpathsea kwallet lapack latex lcms ldap leim libnotify lzma mad mng modules mozilla mp3 mp4 mpeg mule ncurses nls nptl offensive ogg opengl openmp pam pango pcre pdf phonon plasma plotutils png policykit ppds python qml qt3support qt4 qt5 readline sdl seccomp semantic-desktop session spell ssl startup-notification svg tcl tcpd tiff tk truetype udev udisks umfpack unicode upower usb vorbis widgets wxwidgets x264 x86 xattr xcb xcomposite xinerama xml xscreensaver xv xvid zlib" ABI_X86="32" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext sse sse2 sse3 ssse3" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="evdev" KERNEL="linux" L10N="ru en" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LINGUAS="ru en" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-6" POSTGRES_TARGETS="postgres9_5" PYTHON_SINGLE_TARGET="python3_5" PYTHON_TARGETS="python2_7 python3_5 python3_6" RUBY_TARGETS="ruby22 ruby23 ruby24" USERLAND="GNU" VIDEO_CARDS="intel" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

elrond ~ # emerge -pqv '=dev-lisp/sbcl-1.4.1::gentoo'
[ebuild  r  U ] dev-lisp/sbcl-1.4.1 [1.4.0] USE="doc unicode zlib -debug -pax_kernel -source -threads" 
[ebuild  rR   ] sci-mathematics/maxima-5.41.0  USE="X clisp clozurecl cmucl ecls emacs gcl nls sbcl tk unicode" LINGUAS="-de -es -pt -pt_BR"                                                                                                                

The following packages are causing rebuilds:

  (dev-lisp/sbcl-1.4.1:0/1.4.1::gentoo, ebuild scheduled for merge) causes rebuilds for:
    (sci-mathematics/maxima-5.41.0:0/0::grozin, ebuild scheduled for merge)
elrond ~ #




Comment 5


Vincent-Xavier JUMEL





          2017-12-06 19:31:46 UTC
        

I'm trying every single version of SBCL in tree and the all failed. Seems to have a -no-pie flag to be set about this : https://sourceforge.net/p/sbcl/sbcl/ci/3403dbaffc0a9bab49b78cf0bb5308cce0a0c153/




Comment 6


Andrey Grozin






          2017-12-07 05:41:01 UTC
        

sbcl-1.4.2 successfully compiles on my ~x86 box with the 13.0 profile. The resulting sbcl successfully compiles maxima-5.41.0; the resulting maxima passes its testsuite without unexpected errors.

I'm not going to switch to the 17.0 profile because it breaks packages which are most important for me.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

