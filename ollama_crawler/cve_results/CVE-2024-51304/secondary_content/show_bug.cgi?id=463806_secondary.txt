Title: 463806 – app-arch/bzip2: installs then overwrites (?!) bunzip2 and bzcat
URL: https://bugs.gentoo.org/show_bug.cgi?id=463806

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 463806
app-arch/bzip2: installs then overwrites (?!) bunzip2 and bzcat
Last modified: 2013-04-23 16:21:49 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 463806 
      - app-arch/bzip2: installs then overwrites (?!) bunzip2 and bzcat


Summary:
app-arch/bzip2: installs then overwrites (?!) bunzip2 and bzcat
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       trivial
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-03-30 08:42 UTC by Michał Górny





      Modified:
    
2013-04-23 16:21 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



pms









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Patch for pkg-mgr-commands.tex

              (overwrite.diff,1.11 KB,
                patch)

            
2013-04-01 09:49 UTC,

            Ulrich Müller




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michał Górny









          2013-03-30 08:42:39 UTC
        

dodir /bin
    mv "${D}"/usr/bin/b{zip2,zcat,unzip2} "${D}"/bin/ || die
    dosym bzip2 /bin/bzcat || die
    dosym bzip2 /bin/bunzip2 || die

It looks like you're moving the two, then replacing with symlinks... wouldn't it be more correct to just remove them instead? I don't think you can really rely on 'dosym' handling file replacement with symlink.




Comment 1


SpanKY






          2013-03-31 01:56:05 UTC
        

if that's how dosym has always operated, then yes, it can be relied upon

the choice of doing a mv && rm && dosym vs a mv && dosym, the latter is a bit simpler




Comment 2


Michał Górny









          2013-03-31 07:51:27 UTC
        

@pms-bugs, can you confirm? This seems to be undefined behavior per the PMS wording to me.




Comment 3


Ciaran McCreesh





          2013-03-31 18:44:06 UTC
        

Yeah, it's not specified, so it can't be relied upon.




Comment 4


SpanKY






          2013-04-01 05:08:13 UTC
        

(In reply to comment #3)

dosym has operated this way since the beginning.  the fact that PMS missed this nuance means it is buggy and should be fixed.

 Mon May 27 20:55:19 2002 UTC (10 years, 10 months ago): dosym uses -sf
 Sun Jun  2 15:12:59 2002 UTC (10 years, 10 months ago): dosym uses -snf




Comment 5


Ulrich Müller






          2013-04-01 09:49:45 UTC
        

Created attachment 343908 [details, diff]
Patch for pkg-mgr-commands.tex

Behaviour for existing destination files isn't specified for any of the install commands. AFAICS, they all overwrite existing files, and have always (i.e. since 2001, when Portage was first committed to CVS) done that.




Comment 6


Ulrich Müller






          2013-04-12 22:39:32 UTC
        

(In reply to comment #5)
> Created attachment 343908 [details, diff] [details, diff]
> Patch for pkg-mgr-commands.tex

Committed:
http://git.overlays.gentoo.org/gitweb/?p=proj/pms.git;a=commit;h=34985f0ae8d8fe1cb24780a585b4feee44d58398




Comment 7


SpanKY






          2013-04-23 16:21:49 UTC
        

(In reply to comment #6)

thanks!









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

