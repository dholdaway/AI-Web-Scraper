Title: 383253 – www-client/seamonkey-2.3.3 fails in install phase
URL: https://bugs.gentoo.org/show_bug.cgi?id=383253

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 383253
www-client/seamonkey-2.3.3 fails in install phase
Last modified: 2011-10-13 21:39:06 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 383253 
      - www-client/seamonkey-2.3.3 fails in install phase


Summary:
www-client/seamonkey-2.3.3 fails in install phase
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Lars Wendler (Polynomial-C) (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-09-16 17:37 UTC by Sven Müller





      Modified:
    
2011-10-13 21:39 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



mozilla









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




stripped build log

              (build.log,190.58 KB,
                text/plain)

            
2011-09-16 17:57 UTC,

            Sven Müller




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Sven Müller





          2011-09-16 17:37:03 UTC
        

/var/tmp/portage/www-client/seamonkey-2.3.3/work/comm-release/mozilla/config/nsinstall -D /var/tmp/portage/www-client/seamonkey-2.3.3/image//usr/bin
rm -f -f /var/tmp/portage/www-client/seamonkey-2.3.3/image//usr/bin/seamonkey
ln -s /usr/lib64/seamonkey-2.3.3/seamonkey /var/tmp/portage/www-client/seamonkey-2.3.3/image//usr/bin
make[1]: Leaving directory `/var/tmp/portage/www-client/seamonkey-2.3.3/work/comm-release/suite/installer'
Archive:  /var/tmp/portage/www-client/seamonkey-2.3.3/work/comm-release/mozilla/dist/bin/enigmail-1.4-linux-x86_64.xpi
  inflating: install.rdf             
Archive:  /var/tmp/portage/www-client/seamonkey-2.3.3/work/comm-release/mozilla/dist/bin/enigmail-1.4-linux-x86_64.xpi
  inflating: components/enigmail.xpt  
  inflating: components/enigmail.js  
  inflating: components/enigprefs-service.js  
  inflating: components/enigMsgCompFields.js  
  inflating: defaults/preferences/enigmail.js  
  inflating: defaults/pref/enigmail.js  
  inflating: modules/enigmailCommon.jsm  
  inflating: modules/commonFuncs.jsm  
  inflating: modules/subprocess.jsm  
  inflating: chrome/enigmail.jar     
  inflating: wrappers/gpg-wrapper.sh  
  inflating: wrappers/gpg-agent-wrapper.sh  
  inflating: components/ipc.xpt      
  inflating: components/enigmime.xpt  
  inflating: platform/Linux_x86_64-gcc3/components/libenigmime-x86_64-gcc3.so  
  inflating: platform/Linux_x86_64-gcc3/components/libipc-x86_64-gcc3.so  
  inflating: chrome.manifest         
  inflating: install.rdf             
/var/tmp/portage/www-client/seamonkey-2.3.3/temp/environment: line 6133: /var/tmp/portage/www-client/seamonkey-2.3.3/image//usr/lib64/seamonkey/defaults/pref/all-gentoo.js: No such file or directory
 * ERROR: www-client/seamonkey-2.3.3 failed (install phase):
 *   (no error message)


Reproducible: Always




Comment 1


Sven Müller





          2011-09-16 17:57:10 UTC
        

Created attachment 286701 [details]
stripped build log

I deleted the middle part (compilation process) to get the size below 1 mb.




Comment 2


Lars Wendler (Polynomial-C) (RETIRED)






          2011-09-23 08:49:58 UTC
        

I fail to reproduce the error. I even used the same set of USE flags you have used.




Comment 3


Sven Müller





          2011-10-07 13:30:32 UTC
        

Ok, finally I got it installed (version 2.4.1). 

As seen in the report the directory 

/var/tmp/portage/www-client/seamonkey-2.3.3/image//usr/lib64/seamonkey/defaults/pref

is missing. Therefore all-gentoo.js isn't available too. To get it installed I did the following (quick and very dirty workaround):

1. start install phase:
cd /usr/portage/www-client/seamonkey
ebuild seamonkey-2.3.3.ebuild install
When install.rdf at the end of the install phase shows up, stop the install process (ctrl + z in the terminal).

2. create the non-existing directories:
mkdir -p /var/tmp/portage/www-client/seamonkey-2.3.3/image/usr/lib64/seamonkey/defaults/pref
mkdir -p /var/tmp/portage/www-client/seamonkey-2.3.3/image/usr/lib64/seamonkey-2.3.3/defaults/pref

3. copy the all-gentoo.js from the existing installation to the created paths:
cp /usr/lib64/seamonkey/defaults/pref/all-gentoo.js /var/tmp/portage/www-client/seamonkey-2.3.3/image/usr/lib64/seamonkey/defaults/pref/
cp /usr/lib64/seamonkey/defaults/pref/all-gentoo.js /var/tmp/portage/www-client/seamonkey-2.3.3/image/usr/lib64/seamonkey-2.3.3/defaults/pref/

4. continue the install process (fg)

Because the missing file all-gentoo.js seems to be Gentoo related, it could be an error related to the "branding" USE-Flag which is set in my configuration. Maybe I'll check it later when I have more time.




Comment 4


Lars Wendler (Polynomial-C) (RETIRED)






          2011-10-08 17:15:44 UTC
        

You shouldn't need to create a directory called 

  /var/tmp/portage/www-client/seamonkey-2.3.3/image/usr/lib64/seamonkey-2.3.3

The version number in the last dir is plain wrong and should be patched away with the 

  2000-seamonkey_gentoo_install_dirs.patch

from the seamonkey-2.3.3-patches-02.tar.xz patchset tarball.

Please make sure that 

a) you have downloaded the correct patchset tarball
b) the above mentioned patch can be found in that tarball
c) that the patch gets applied at the beginning of seamonkey's emerge process




Comment 5


Sven Müller





          2011-10-12 08:14:15 UTC
        

(In reply to comment #4)
> The version number in the last dir is plain wrong and should be patched away
> with the 
> 
>   2000-seamonkey_gentoo_install_dirs.patch
> 
> from the seamonkey-2.3.3-patches-02.tar.xz patchset tarball.
> 
> Please make sure that 
> 
> a) you have downloaded the correct patchset tarball
> b) the above mentioned patch can be found in that tarball
> c) that the patch gets applied at the beginning of seamonkey's emerge process

emerge -1 seamonkey (2.4.1) gives me:

>>> Emerging (1 of 1) www-client/seamonkey-2.4.1-r1
 * seamonkey-2.4.1.source.tar.bz2 RMD160 SHA1 SHA256 size ;-) ...                                                                                                                                            [ ok ]
 * seamonkey-2.4.1-patches-01.tar.xz RMD160 SHA1 SHA256 size ;-) ...                                                                                                                                         [ ok ]
 * enigmail-1.3.2.tar.gz RMD160 SHA1 SHA256 size ;-) ...                                                                                                                                                     [ ok ]
 * seamonkey-2.4.1-de.xpi RMD160 SHA1 SHA256 size ;-) ...                                                                                                                                                    [ ok ]
>>> Unpacking source...
>>> Unpacking seamonkey-2.4.1.source.tar.bz2 to /var/tmp/portage/www-client/seamonkey-2.4.1-r1/work
>>> Unpacking seamonkey-2.4.1-patches-01.tar.xz to /var/tmp/portage/www-client/seamonkey-2.4.1-r1/work
>>> Unpacking enigmail-1.3.2.tar.gz to /var/tmp/portage/www-client/seamonkey-2.4.1-r1/work
>>> Unpacking seamonkey-2.4.1-de.xpi to /var/tmp/portage/www-client/seamonkey-2.4.1-r1/work
unpack seamonkey-2.4.1-de.xpi: file format not recognized. Ignoring.
 * Unpacking seamonkey-2.4.1-de.xpi to /var/tmp/portage/www-client/seamonkey-2.4.1-r1/work
 * Selected language packs (first will be default): de
>>> Source unpacked in /var/tmp/portage/www-client/seamonkey-2.4.1-r1/work
>>> Preparing source in /var/tmp/portage/www-client/seamonkey-2.4.1-r1/work/comm-release ...
 * Applying various patches (bugfixes/updates) ...
 * Done with patching
 * Applying seamonkey_replace_alsa_with_oss.patch ...                                                                                                                                                        [ ok ]
 * Applying various patches (bugfixes/updates) ...
 *   1000-config_rules_install_dist_files.patch ...                                                                                                                                                          [ ok ]
 *   1001-fix_jemalloc_vs_aslr.patch ...                                                                                                                                                                     [ ok ]
 *   2001-gentoo_no_app_updates.patch ...                                                                                                                                                                    [ ok ]
 *   2002_fix-preferences-gentoo.patch ...                                                                                                                                                                   [ ok ]
 *   2003_fix_system_hunspell_dict_detection.patch ...                                                                                                                                                       [ ok ]
 *   2100-fixup_for_prefix_gre.patch ...                                                                                                                                                                     [ ok ]
 *   5000_arm-bug-644136.patch ...                                                                                                                                                                           [ ok ]
 *   5001_fix-title-backspace.patch ...                                                                                                                                                                      [ ok ]
 *   5002_allow_locked_prefs.patch ...                                                                                                                                                                       [ ok ]
 *   5003_avoid_spurious_run_items_in_application_handlers.patch ...                                                                                                                                         [ ok ]
 *   5004_properly_launch_applications_set_in_home.patch ...                                                                                                                                                 [ ok ]
 *   5005_do_not_call_openunshareddatabse.patch ...                                                                                                                                                          [ ok ]
 *   5006_initialize_ns_xp_come_library_file_from_ns.patch ...                                                                                                                                               [ ok ]
 *   5007_allow_to_pass_an_application_directory.patch ...                                                                                                                                                   [ ok ]
 *   5008_always_load_gre_defaults_pref.patch ...                                                                                                                                                            [ ok ]
 *   5009_provide_ns_app_pre_defaults_dir.patch ...                                                                                                                                                          [ ok ]
 *   5010_only_add_-DEANBLE_JIT-1_to_CXXFLAGS.patch ...                                                                                                                                                      [ ok ]
 *   5011_build_fix_for_ENABLE_YARR_JIT-0.patch ...                                                                                                                                                          [ ok ]
 *   5012_workaround_recent_arm_gnu_ld_bug.patch ...                                                                                                                                                         [ ok ]
 *   5013_dont_enable_YARR_JIT_on_mips.patch ...                                                                                                                                                             [ ok ]
 *   5014_allow_to_build_yuv_convert_arm.patch ...                                                                                                                                                           [ ok ]
 *   5015_add_mips_hppa_ia64_s390_sparch_defines_in_ipc.patch ...                                                                                                                                            [ ok ]
 *   5016_allow_armv4t_in_nanojit.patch ...                                                                                                                                                                  [ ok ]
 *   5017_enable_system_ffi.patch ...                                                                                                                                                                        [ ok ]
 *   5018_enable_system_ffi_part2.patch ...                                                                                                                                                                  [ ok ]
 * Done with patching
 * Applying various patches (bugfixes/updates) ...
 * Done with patching
 * Applying seamonkey-2.2-curl7217-includes-fix.patch ...                                                                                                                                                    [ ok ]
 * Applying seamonkey-2.3.1-scrollbar-mouse-interaction-improvement.patch ...                                                                                                                                [ ok ]
 * Applying Copy_xpcshell_only_if_tests_are_enabled.patch ...                                                                                                                                                [ ok ]
 * Running eautoreconf in '/var/tmp/portage/www-client/seamonkey-2.4.1-r1/work/comm-release' ...
 * Running autoconf ...                                                                                                                                                                                      [ ok ]
 * Running elibtoolize in: comm-release/mozilla/js/src/ctypes/libffi/
 *   Applying install-sh/1.5.4 patch ...
 *   Applying portage/2.2 patch ...
 *   Applying sed/1.5.6 patch ...
 *   Applying as-needed/2.2.6 patch ...
 * Running elibtoolize in: comm-release/mozilla/modules/freetype2/builds/unix/
 *   Applying portage/2.2 patch ...
 *   Applying sed/1.5.6 patch ...
 *   Applying as-needed/2.2.6 patch ...
 * Running elibtoolize in: comm-release/mozilla/toolkit/crashreporter/google-breakpad/autotools/
 *   Applying portage/2.2 patch ...
 *   Applying sed/1.5.6 patch ...
 *   Applying as-needed/2.2.6 patch ...
 * Running elibtoolize in: comm-release/mozilla/ipc/chromium/src/third_party/libevent/
 *   Applying install-sh/1.5 patch ...
 *   Applying portage/1.5.10 patch ...
 *   Applying sed/1.5.6 patch ...
 *   Applying as-needed/1.5.26 patch ...
 * Running eautoreconf in '/var/tmp/portage/www-client/seamonkey-2.4.1-r1/work/comm-release/mozilla' ...
 * Running autoconf ...

The above-mentioned 2000-seamonkey_gentoo_install_dirs.patch at least seems not to be listed there.




Comment 6


Lars Wendler (Polynomial-C) (RETIRED)






          2011-10-12 12:10:25 UTC
        

Please post your  "emerge --info"




Comment 7


Lars Wendler (Polynomial-C) (RETIRED)






          2011-10-12 12:14:50 UTC
        

Oh and

   seamonkey_replace_alsa_with_oss.patch

is definitely no patch that I included into the seamonkey package from portage-tree. Are you by any chance using a modified ebuild? If yes please make sure that the patching is done correctly. Look at the original seamonkey ebuild from the portage-tree to see what I changed since seamonkey-2.3.3 entered the tree.




Comment 8


Sven Müller





          2011-10-13 07:59:31 UTC
        

(In reply to comment #7)
> Oh and
> 
>    seamonkey_replace_alsa_with_oss.patch
> 
> is definitely no patch that I included into the seamonkey package from
> portage-tree. Are you by any chance using a modified ebuild? If yes please make
> sure that the patching is done correctly. Look at the original seamonkey ebuild
> from the portage-tree to see what I changed since seamonkey-2.3.3 entered the
> tree.

Got it. :)

That patch is included by myself. I'm using oss instead of alsa, but xulrunner,  seamonkey and firefox support oss (for bsd) but expect only alsa for Linux. So I made a patch to replace the alsa support with oss support in sydneyaudio. Unfortunately my Script to modify the ebuilds deleted a path in the prepare function:

correct: epatch "${WORKDIR}/_seamonkey"
my patch script modified to: epatch "${WORKDIR}/"

So thanks a lot for your hints. And sorry for using your time for my own mistakes.

I would suggest to mark the bug as INVALID.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

