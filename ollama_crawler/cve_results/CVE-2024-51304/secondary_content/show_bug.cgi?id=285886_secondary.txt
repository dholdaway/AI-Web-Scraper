Title: 285886 – xfce overlay needs audit and decision on what to do with it
URL: https://bugs.gentoo.org/show_bug.cgi?id=285886

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 285886
xfce overlay needs audit and decision on what to do with it
Last modified: 2009-09-24 03:38:07 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 285886 
      - xfce overlay needs audit and decision on what to do with it


Summary:
xfce overlay needs audit and decision on what to do with it
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Eclasses

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

XFCE Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-09-22 03:06 UTC by Alex Dedul





      Modified:
    
2009-09-24 03:38 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alex Dedul





          2009-09-22 03:06:08 UTC
        

Most of live ebuilds now requires git and xfce4.eclass has some issues with it. For example:

-----------------------

>>> Emerging (1 of 1) xfce-base/exo-9999 from xfce-dev
 * checking ebuild checksums ;-) ...                                                                                                                    [ ok ]
 * checking auxfile checksums ;-) ...                                                                                                                   [ ok ]
 * checking miscfile checksums ;-) ...                                                                                                                  [ ok ]
>>> Unpacking source...
 * GIT update -->
 *    repository: 		git://git.xfce.org/xfce/exo
 * git fetch -f -u origin master:master
 *    at the commit: 		a27374fec0c3347c64fdc8ede93185bd45d2f34f
 *    branch: 			master
 *    storage directory: 	"/usr/portage/distfiles/git-src/exo"
Initialized empty Git repository in /var/tmp/portage/xfce-base/exo-9999/work/exo-9999/.git/
Switched to a new branch 'branch-master'
>>> Unpacked to /var/tmp/portage/xfce-base/exo-9999/work/exo-9999
fatal: Not a git repository (or any of the parent directories): .git
fatal: Not a git repository (or any of the parent directories): .git
>>> Source unpacked in /var/tmp/portage/xfce-base/exo-9999/work
>>> Compiling source in /var/tmp/portage/xfce-base/exo-9999/work/exo-9999 ...
 * 
 * ERROR: xfce-base/exo-9999 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 3713:  Called xfce4_src_compile
 *             environment, line 4341:  Called xfce4_src_configure
 *             environment, line 4348:  Called econf '--disable-gtk-doc' '--enable-hal' '--enable-notifications' '--disable-python' '--enable-maintainer-mode' '--disable-debug'
 *               ebuild.sh, line  541:  Called die
 * The specific snippet of code:
 *   		die "no configure script found"
 *  The die message:
 *   no configure script found

-----------------------

Proposed simple fix:

--- xfce4.eclass.orig	2009-09-22 06:01:01.396610490 +0300
+++ xfce4.eclass	2009-09-22 06:01:06.090610058 +0300
@@ -127,6 +127,7 @@
 		XFCE_CONFIG+=" --enable-maintainer-mode"
 		if [ "${XFCE_VCS}" = "git" ]; then
 			git_src_unpack
+			cd ${S}
 			revision=$(git show --pretty=format:%ci | head -n 1 | \
 			awk '{ gsub("-", "", $1); print $1"-"; }')
 			revision+=$(git rev-parse HEAD | cut -c1-8)


Reproducible: Always




Comment 1


Jeremy Olexa (darkside) (RETIRED)








          2009-09-22 04:30:26 UTC
        

Two things: 
-xfce4.eclass isn't supported anymore
-the overlay has bitrot and is potentially dangerous. We should remove it.




Comment 2


Alex Dedul





          2009-09-22 04:37:44 UTC
        

(In reply to comment #1)
> Two things: 
> -xfce4.eclass isn't supported anymore
> -the overlay has bitrot and is potentially dangerous. We should remove it.
> 

Hm.. Any alternatives to using xfce4.eclass and that overlay to use live xfce ebuilds ?




Comment 3


Jeremy Olexa (darkside) (RETIRED)








          2009-09-22 05:07:51 UTC
        

I guess we could convert ebuilds to use xfconf.eclass and audit the overlay. Care to help? Myself..I don't really care for live ebuilds and only maintain them when inherited and someone complains/submits patches..




Comment 4


Samuli Suominen (RETIRED)






          2009-09-23 10:01:37 UTC
        

xfce*.eclass is all deprecated, and won't be updated in tree, soon as we are allowed to remove eclasses they will be wiped off.

asked scarabeus a month ago to clean up the overlay, which he did

talked to angelos and he said he'll take care of the overlay again once he gets the time

given that gentoo-xfce team is me, darkside and angelos and only latter one is intrested in this, there's nothing to decide

i suggest you maintain your own live ebuilds somewhere




Comment 5


Jeremy Olexa (darkside) (RETIRED)








          2009-09-24 01:42:54 UTC
        

(In reply to comment #4)
> xfce*.eclass is all deprecated, and won't be updated in tree, soon as we are
> allowed to remove eclasses they will be wiped off.
> 
> asked scarabeus a month ago to clean up the overlay, which he did

really? Looks there to me http://git.overlays.gentoo.org/gitweb/?p=proj/xfce.git;a=summary :)

> 
> talked to angelos and he said he'll take care of the overlay again once he gets
> the time
> 
> given that gentoo-xfce team is me, darkside and angelos and only latter one is
> intrested in this, there's nothing to decide
> 
> i suggest you maintain your own live ebuilds somewhere

This is why I asked if he was interested to help. We can give him access to the xfce overlay and watch his commits? :)

> 






Comment 6


Alex Dedul





          2009-09-24 03:28:39 UTC
        

> > i suggest you maintain your own live ebuilds somewhere
> 
> This is why I asked if he was interested to help. We can give him access to the
> xfce overlay and watch his commits? :)

Dunno.. I don't quite understand what is going on here.. So i just made my own copy of that eclass and added that just one line patch. And all is good..




Comment 7


Jeremy Olexa (darkside) (RETIRED)








          2009-09-24 03:38:07 UTC
        

Alex, in that case it is probably for the best :)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

