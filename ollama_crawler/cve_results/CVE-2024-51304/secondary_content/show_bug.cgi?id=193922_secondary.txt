Title: 193922 – media-libs/x264-svn-20070924 produces green and red rectangles, not video
URL: https://bugs.gentoo.org/show_bug.cgi?id=193922

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 193922
media-libs/x264-svn-20070924 produces green and red rectangles, not video
Last modified: 2007-12-06 01:32:27 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 193922 
      - media-libs/x264-svn-20070924 produces green and red rectangles, not video


Summary:
media-libs/x264-svn-20070924 produces green and red rectangles, not video
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Media-video project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-09-26 23:25 UTC by Stuart W. Finlayson





      Modified:
    
2007-12-06 01:32 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



x11-drivers









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Stuart W. Finlayson





          2007-09-26 23:25:09 UTC
        

The summary says it all, when using ffplay or mplayer after upgrading to media-libs/x264-svn-20070924, and recompiling both ffmpeg and mplayer, any H.264 videos I play show up as a bunch of green rectangles with some red rectangles mixed in.  media-libs/x264-svn-20070923 does the same thing, so I've reverted back to media-libs/x264-svn-20070325 which works fine...

Here's some additional stuff:

chronos ~ # emerge -pv x264-svn

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] media-libs/x264-svn-20070924  USE="threads -debug" 0 kB

Total: 1 package (1 reinstall), Size of downloads: 0 kB
chronos ~ # emerge -pv mplayer ffmpeg

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] media-video/mplayer-1.0_rc1_p20070824  USE="X a52 aac alsa arts dvd encode gif iconv ipv6 jpeg mad mmx mmxext mp3 opengl png rtc sdl sse sse2 ssse3 truetype unicode vorbis x264 xv xvid -3dnow -3dnowext -aalib (-altivec) -amrnb -amrwb -bidi -bindist -bl -cddb -cdio -cdparanoia -cpudetection -custom-cflags -dga -directfb -doc -dts -dv -dvb -enca -esd -fbcon -ftp -ggi -gtk -ivtv -jack -joystick -libcaca -lirc -live -livecd -lzo -md5sum -mp2 -musepack -nas -openal -oss -pnm -pvr -quicktime -radio -rar -real -samba -speex -srt (-svga) -teletext -tga -theora -tivo -v4l -v4l2 (-vidix) (-win32codecs) -xanim -xinerama -xvmc -zoran" VIDEO_CARDS="nvidia vesa -i810 -mga -s3virge -tdfx" 0 kB
[ebuild   R   ] media-video/ffmpeg-0.4.9_p20070616-r1  USE="X a52 aac amr encode ieee1394 imlib mmx ogg sdl threads truetype vorbis x264 xvid zlib (-altivec) -debug -doc -network -oss -test -theora -v4l" 0 kB

Total: 2 packages (2 reinstalls), Size of downloads: 0 kB
chronos ~ # emerge --info
Portage 2.1.3.9 (default-linux/amd64/2006.1, gcc-4.1.2, glibc-2.5-r4, 2.6.22-gentoo-r5 x86_64)
=================================================================
System uname: 2.6.22-gentoo-r5 x86_64 Intel(R) Core(TM)2 CPU 6700 @ 2.66GHz
Timestamp of tree: Wed, 26 Sep 2007 16:20:01 +0000
app-shells/bash:     3.2_p17
dev-lang/python:     2.4.4-r5
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.9-r2
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17-r1
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=nocona -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/bind"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=nocona -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://mirror.datapipe.net/gentoo http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo/ http://gentoo.netnitco.net"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_EXTRA_OPTS="--exclude-from=/etc/portage/rsync_excludes"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="X a52 aac alsa amd64 amr arts bash-completion berkdb bitmap-fonts bzip2 cairo cli cracklib crypt cups curl dri dvd dvdread encode fam ffmpeg flac fortran gdbm gif gpm iconv ieee1394 imlib ipv6 isdnlog jpeg kde kdeenablefinal logitech-mouse mad matroska midi mng mp3 mudflap ncurses nls nptl nptlonly ogg opengl openmp pam pcre perl png ppds pppd python qt4 readline reflection rtc ruby sdl session smp spell spl ssl ssse3 symlink tcpd tetex threads truetype truetype-fonts type1-fonts unicode usb vorbis x264 xorg xv xvid zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="dummy fbdev nvidia vesa vga"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTDIR_OVERLAY




Comment 1


Alexis Ballier






          2007-09-27 18:06:02 UTC
        

afaik ffmpeg and mplayer use libx264 only for encoding, so that's really weird they cannot read em if you upgrade.
Do you have a sample mplayer output when failing ? and perhaps a (small) sample file ? Here I can read h264 files fine.




Comment 2


Stuart W. Finlayson





          2007-09-27 19:10:00 UTC
        

The output looks the same as if it was playing normally.

I've narrowed the problem down to being strange condition that occurs between media-libs/x264-svn-20070924 and x11-drivers/nvidia-drivers-100.14.19.

If I have these installed, start X, and play videos (of any encoding) it works fine.  However, if I use OpenGL for any length of time (I use an OpenGL screensaver), from that point on any videos I play show up as a static (it's like a still picture) bunch of green rectangles with some red rectangles mixed in.  If I downgrade to x11-drivers/nvidia-drivers-100.14.11 (leaving media-libs/x264-svn-20070924 installed) or downgrade to media-libs/x264-svn-20070325 (leaving x11-drivers/nvidia-drivers-100.14.19 installed), this problem goes does not happen.  So, for some reason those two packages (media-libs/x264-svn-20070924 and x11-drivers/nvidia-drivers-100.14.19) won't play nice after using OpenGL.

I've only tested this out in KDE, so I'm not sure if this is true for other desktop environments.





Comment 3


Alexis Ballier






          2007-09-27 19:23:35 UTC
        

(In reply to comment #2)
> I've narrowed the problem down to being strange condition that occurs between
> media-libs/x264-svn-20070924 and x11-drivers/nvidia-drivers-100.14.19.

I really dont understand whats going on...

any help is more than welcome




Comment 4


Doug Goldstein (RETIRED)






          2007-09-27 19:44:33 UTC
        

Any issues with the NVIDIA binary drivers are outside of the scope of anything we can support. Your best method is to contact NVIDIA direct via nvidia-bug-report.sh or via the NVIDIA Linux forums, http://www.nvnews.net/vbulletin/forumdisplay.php?s=&forumid=14




Comment 5


Alexis Ballier






          2007-10-13 13:48:07 UTC
        

(In reply to comment #4)
> Any issues with the NVIDIA binary drivers are outside of the scope of anything
> we can support. Your best method is to contact NVIDIA direct via
> nvidia-bug-report.sh or via the NVIDIA Linux forums,
> http://www.nvnews.net/vbulletin/forumdisplay.php?s=&forumid=14
> 

@Stuart: did you try this ? No news on that bug, has the problem disappeared ?
I'm tempted to close it as worksforme...




Comment 6


Alexis Ballier






          2007-11-19 07:33:20 UTC
        

(In reply to comment #5)
> @Stuart: did you try this ? No news on that bug, has the problem disappeared ?
> I'm tempted to close it as worksforme...


1 month later...





Comment 7


Stuart W. Finlayson





          2007-12-06 01:32:27 UTC
        

Sorry I didn't follow up, the problem went away when I upgraded to kernel 2.6.23.  I imagine that they had some code for 2.6.23 in them that wasn't compatible with 2.6.22 as it was compile for my machine...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

