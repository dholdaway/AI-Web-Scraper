Title: 146334 – gtk+: no jpg support in nautilus, eog with --as-needed in LDFLAGS
URL: https://bugs.gentoo.org/show_bug.cgi?id=146334

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 146334
gtk+: no jpg support in nautilus, eog with --as-needed in LDFLAGS
Last modified: 2006-11-01 10:24:18 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 146334 
      - gtk+: no jpg support in nautilus, eog with --as-needed in LDFLAGS


Summary:
gtk+: no jpg support in nautilus, eog with --as-needed in LDFLAGS
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-09-04 18:07 UTC by Anton Kuzmin





      Modified:
    
2006-11-01 10:24 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Anton Kuzmin





          2006-09-04 18:07:28 UTC
        

Recently I've been upgrading to gcc-4.1 experementing with LDFLAGS. I don't know what's wrong.

I use --as-needed in LDFLAGS. It must be related to the issue

1. I can see jpeg images in nautilus, gimp.
2. I cannot see jpeg images in eog. gdb said that program exited normally just after I opened jpeg file. In file->open I cannot even see jpeg files listed in dialog box with "all images" filter.
3. In "desktop background" I can add jpeg images but when I set one, there are no picture on desktop.

Portage 2.1.1_rc1-r3 (default-linux/amd64/2006.1, gcc-4.1.1, glibc-2.4-r3, 2.6.17-suspend2-r5 x86_64)
=================================================================
System uname: 2.6.17-suspend2-r5 x86_64 AMD Turion(tm) 64 Mobile Technology MT-32
Gentoo Base System version 1.12.4
Last Sync: Mon, 04 Sep 2006 22:30:01 +0000
app-admin/eselect-compiler: 2.0.0_rc2-r1
dev-lang/python:     2.4.3-r3
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.16
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-Os -march=athlon64 -fomit-frame-pointer -msse3 -pipe -fweb"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/eselect/compiler /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-Os -march=athlon64 -fomit-frame-pointer -msse3 -pipe -fweb"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer parallel-fetch sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,--as-needed"
LINGUAS="ru"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X a52 acpi alsa apache2 audiofile bitmap-fonts bzip2 cairo cdr cli crypt dbus djvu dlloader doc dvd dvdr dvdread dvi elibc_glibc fat ffmpeg firefox flac fuse gcc64 gdbm gif glibc-omitfp gnome gpm hal howl imagemagick immqt input_devices_evdev input_devices_keyboard input_devices_mouse isdnlog java java5 jpeg kde kdehiddenvisibility kernel_linux libg++ libnotify linguas_ru mad mjpeg mng mp3 musicbrainz mysql nautilus ncurses nforce2 nls nptl nptlonly ntfs nvidia ogg opengl pam pcre pdf pdo pmu png postgres ppds pppd python readline reflection reiserfs session sndfile spell spl sqlite ssl svg tagwriting tcpd theora tidy truetype truetype-fonts type1-fonts udev unicode userland_GNU vcd video_cards_nv video_cards_nvidia video_cards_vesa video_cards_vmware vorbis xfs xine xorg xvid zip zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


Anton Kuzmin





          2006-10-06 14:18:01 UTC
        

Gave up --as-needed. Surely it was the cause of the problem




Comment 2


Xavier Rival





          2006-10-24 10:26:37 UTC
        

I think I have the same problem and other people reported facing similar problem in the thread:
http://forums.gentoo.org/viewtopic-t-509019-highlight-eog.html

I have tested various of eog and all fail with the same symptoms as described in the initial bug report.

Below is my emerge info:
$ emerge --info
Portage 2.1.1 (default-linux/x86/2006.1, gcc-4.1.1, glibc-2.4-r3, 2.6.17.13-mactel i686)
=================================================================
System uname: 2.6.17.13-mactel i686 Genuine Intel(R) CPU           T2600  @ 2.16GHz
Gentoo Base System version 1.12.5
Last Sync: Tue, 24 Oct 2006 15:00:01 +0000
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: [Not Present]
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=i686 -O2 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=i686 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LINGUAS="fr en ja"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X acpi alsa apm berkdb bitmap-fonts cdparanoia cdr cli cracklib crypt cups dlloader dri dvd dvdr elibc_glibc emacs exif firefox foomaticdb fortran gdbm gpm gstreamer gtk gtk2 imagemagick input_devices_keyboard input_devices_mouse input_devices_synaptics ipv6 isdnlog jpeg kde kernel_linux latex lcms leim libg++ linguas_en linguas_fr linguas_ja lm_sensors madwifi mp3 ncurses nls nptl nptlonly opengl pam pcre pdf perl png ppds pppd python qt readline reflection sdl session spl ssl tcltk tcpd tiff truetype truetype-fonts type1-fonts udev unicode usb userland_GNU video_cards_fglrx video_cards_radeon video_cards_vesa vorbis xine xinerama xorg zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, MAKEOPTS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY


Here are my use flags for eog and gtk+:

[ebuild   R   ] x11-libs/gtk+-2.8.19  USE="X jpeg* tiff* xinerama* -debug -doc" 12,015 kB
[ebuild     U ] media-gfx/eog-2.14.2 [2.10.2] USE="debug jpeg lcms%*" 0 kB





Comment 3


Xavier Rival





          2006-10-24 10:28:26 UTC
        

(In reply to comment #2)

I forgot to mention that I do NOT have the --as-needed flag, yet I still have the same issues.




Comment 4


Anton Kuzmin





          2006-10-24 10:33:54 UTC
        

I am not sure but recompiling gtk library and nautilus/eog without --as-needed did seem helped me. Try that.




Comment 5


Anton Kuzmin





          2006-10-24 10:38:17 UTC
        

It seems that your gtk+ library doesn't include jpeg support. The jpeg* indicates that.




Comment 6


Xavier Rival





          2006-11-01 09:40:54 UTC
        

(In reply to comment #5)
> It seems that your gtk+ library doesn't include jpeg support. The jpeg*
> indicates that.
Indeed, this was that. Still, I am not sure to understand why gtk+ was compiled without jpeg support in the first place, since I had jpeg in my USE since the beginning. But I was not familiar with the "*" tagging of USE options in outputs of emerge. Thanks.





Comment 7


John N. Laliberte (RETIRED)






          2006-11-01 10:24:18 UTC
        

marking resolved per reporters comments









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

