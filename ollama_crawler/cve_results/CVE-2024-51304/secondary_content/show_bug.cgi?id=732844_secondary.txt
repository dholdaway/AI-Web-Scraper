Title: 732844 – app-backup/pdumpfs fails tests
URL: https://bugs.gentoo.org/show_bug.cgi?id=732844

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 732844
app-backup/pdumpfs fails tests
Last modified: 2020-10-20 19:41:13 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 732844 
      - app-backup/pdumpfs fails tests


Summary:
app-backup/pdumpfs fails tests
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Paul Healy








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-07-16 06:07 UTC by Agostino Sarubbo





      Modified:
    
2020-10-20 19:41 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



proxy-maint









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,7.76 KB,
                text/plain)

            
2020-07-16 06:07 UTC,

            Agostino Sarubbo




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Agostino Sarubbo






          2020-07-16 06:07:04 UTC
        

https://blogs.gentoo.org/ago/2020/07/04/gentoo-tinderbox/

Issue: app-backup/pdumpfs fails tests.
Discovered on: amd64  (internal ref: tinderbox)

NOTE:
This machine uses a clang/LLVM toolchain.
If you think that this issue is strictly related to clang/LLVM please block bug 408963. If you think that this issue isstrictly related to the LLD linker, please block bug 731004.




Comment 1


Agostino Sarubbo






          2020-07-16 06:07:09 UTC
        

Created attachment 649424 [details]
build.log

build log and emerge --info




Comment 2


Paul Healy





          2020-09-01 09:46:45 UTC
        

Hi,

I haven't been able to recreate this failure.

The tests run and pass when I merge it.

All suggestions welcome?

Thanks,

Paul
--

# FEATURES="test" emerge -av app-backup/pdumpfs

with:

# cat profile/use.stable.mask 
-ruby_targets_ruby27
-ruby_targets_ruby26

# eselect ruby list
Available Ruby profiles:
  [1]   ruby25 (with Rubygems)
  [2]   ruby26 (with Rubygems)
  [3]   ruby27 (with Rubygems) *

# ruby --version
ruby 2.7.1p83 (2020-03-31 revision a0c7c23c9c) [x86_64-linux]

# grep -n -C 1 compatibility /usr/lib64/ruby/2.7.0/rubygems.rb 
15-# Must be first since it unloads the prelude from 1.9.2
16:require 'rubygems/compatibility'
17-

# file /usr/lib64/ruby/site_ruby/2.7.0/rubygems/compatibility.rb 
/usr/lib64/ruby/site_ruby/2.7.0/rubygems/compatibility.rb: Ruby script, ASCII text


# equery d dev-ruby/rubygems
 * These packages depend on dev-ruby/rubygems:
virtual/rubygems-16 (ruby_targets_ruby25 ? >=dev-ruby/rubygems-2.7.3[ruby_targets_ruby25])
                    (ruby_targets_ruby26 ? >=dev-ruby/rubygems-3.0.1[ruby_targets_ruby26])
                    (ruby_targets_ruby27 ? >=dev-ruby/rubygems-3.1.0[ruby_targets_ruby27])

# equery d virtual/rubygems
 * These packages depend on virtual/rubygems:
...
dev-lang/ruby-2.5.8 (virtual/rubygems[ruby_targets_ruby25])
dev-lang/ruby-2.6.6-r2 (virtual/rubygems[ruby_targets_ruby26])
dev-lang/ruby-2.7.1-r2 (virtual/rubygems[ruby_targets_ruby27])
...

And the used/installed shebang is:

# head -1 /usr/bin/pdumpfs 
#! /usr/bin/env ruby

build.log excerpt:

...
>>> Emerging (1 of 1) app-backup/pdumpfs-1.3-r2::gentoo
 * pdumpfs-1.3.tar.gz BLAKE2B SHA512 size ;-) ...                                                                                                         [ ok ]
>>> Unpacking source...
>>> Unpacking pdumpfs-1.3.tar.gz to /var/tmp/portage/app-backup/pdumpfs-1.3-r2/work
>>> Source unpacked in /var/tmp/portage/app-backup/pdumpfs-1.3-r2/work
>>> Preparing source in /var/tmp/portage/app-backup/pdumpfs-1.3-r2/work/pdumpfs-1.3 ...
 * Applying pdumpfs-in.patch ...                                                                                                                          [ ok ]
 * Applying pdumpfs-test.patch ...                                                                                                                        [ ok ]
>>> Source prepared.
>>> Configuring source in /var/tmp/portage/app-backup/pdumpfs-1.3-r2/work/pdumpfs-1.3 ...
>>> Source configured.
>>> Compiling source in /var/tmp/portage/app-backup/pdumpfs-1.3-r2/work/pdumpfs-1.3 ...
make -j9 pdumpfs 
rm -f pdumpfs
sed -e "s!@VERSION@!1.3!g" \
    pdumpfs.in > pdumpfs
chmod 555 pdumpfs
>>> Source compiled.
>>> Test phase: app-backup/pdumpfs-1.3-r2
make -j9 check 
cd tests && sh pdumpfs-test
ok.
>>> Completed testing app-backup/pdumpfs-1.3-r2

>>> Install app-backup/pdumpfs-1.3-r2 into /var/tmp/portage/app-backup/pdumpfs-1.3-r2/image/
>>> Completed installing app-backup/pdumpfs-1.3-r2 into /var/tmp/portage/app-backup/pdumpfs-1.3-r2/image/

 * Final size of build directory: 216 KiB
 * Final size of installed tree:  124 KiB
...




Comment 3


Paul Healy





          2020-09-01 09:50:48 UTC
        

Tests also pass with:

FEATURES="test assume-digests binpkg-docompress binpkg-dostrip binpkg-logs buildpkg collision-protect config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms sign split-log strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"




Comment 4


Paul Healy





          2020-10-20 19:41:13 UTC
        

I wasn't able to recreate this. If it occurs again, reopen?

Thanks,

Paul









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

