Title: 356469 – dev-lang/php-{5.3.3-r1, 5.3.5} fail to build on ~x64-macos
URL: https://bugs.gentoo.org/show_bug.cgi?id=356469

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 356469
dev-lang/php-{5.3.3-r1, 5.3.5} fail to build on ~x64-macos
Last modified: 2011-09-15 23:09:59 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 356469 
      - dev-lang/php-{5.3.3-r1, 5.3.5} fail to build on ~x64-macos


Summary:
dev-lang/php-{5.3.3-r1, 5.3.5} fail to build on ~x64-macos
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

Mac OSX

  (show other bugs)



Hardware:

All
        OS X
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Prefix








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




356465



 

        Show dependency tree





 





      Reported:
    
2011-02-25 19:58 UTC by nietonfir





      Modified:
    
2011-09-15 23:09 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


nietonfir





          2011-02-25 19:58:02 UTC
        

Bug #343481 [1] introduced a darwin specific ebuild change because it failed to build php properly. That bug seems to be ~x86-macos specific, because on my machine (~x64-macos) php builds just fine without that change but fails otherwise with "Unable to copy cgi SAPI". And indeed, in the build directories the cgi sapi is not built...

It would be nice if someone else running on ~x64-macos could counter-check that behavior. My proposed solution then would be to make that fix for ~86-macos only if possible.

[1] http://bugs.gentoo.org/show_bug.cgi?id=343481




Comment 1


Fabian Groffen






          2011-02-27 09:36:44 UTC
        

hmmm, please attach a buildlog, as the intended change has no reason to break 64-bits vs 32-bits.




Comment 2


nietonfir





          2011-02-27 13:20:11 UTC
        

(In reply to comment #1)
> hmmm, please attach a buildlog, as the intended change has no reason to break
> 64-bits vs 32-bits.
> 
Here, as requested: http://dpaste.org/YMwS/
I used the 5.3.3-r1 ebuild to eliminate possible eblits v2 port errors from my side.




Comment 3


nietonfir





          2011-02-27 13:20:36 UTC
        

And my emerge --info:

Portage 2.2.01.17901-prefix (prefix/darwin/macos/10.6/x64, gcc-4.2.1, unavailable, 10.6.0 i386)
=================================================================
System uname: Darwin-10.6.0-i386-64bit
Timestamp of tree: Thu, 24 Feb 2011 00:07:34 +0000
distcc 3.1-toolwhip.1 i386-apple-darwin10.0 [disabled]
ccache version 3.1.4 [enabled]
app-shells/bash:     4.1_p7
dev-java/java-config: 2.1.11-r2
dev-lang/python:     2.7.1-r00.1
dev-util/ccache:     3.1.4
dev-util/cmake:      2.8.4
sys-devel/autoconf:  2.13, 2.68
sys-devel/automake:  1.11.1
sys-devel/gcc-config: 1.4.1-r00.2
sys-devel/libtool:   2.4-r1
sys-devel/make:      3.82
Repositories: gentoo_prefix main-overlay
Installed sets: 
ACCEPT_KEYWORDS="~x64-macos"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-apple-darwin10"
CFLAGS="-O2 -pipe -fomit-frame-pointer -march=nocona"
CHOST="x86_64-apple-darwin10"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5.3/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/portage /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-O2 -pipe -fomit-frame-pointer -march=nocona"
DISTDIR="/Users/me/Gentoo/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs ccache collision-protect distlocks fixlafiles fixpackages news nostrip parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="de_AT.UTF-8"
LDFLAGS="-Wl,-dead_strip_dylibs"
LINGUAS="en de"
MAKEOPTS="-j3"
PKGDIR="/Users/me/Gentoo/usr/portage/packages"
PORTAGE_CONFIGROOT="/Users/me/Gentoo/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/Users/me/Gentoo/var/tmp"
PORTDIR="/Users/me/Gentoo/usr/portage"
PORTDIR_OVERLAY="/Users/me/Gentoo/usr/local/portage/main-overlay"
SYNC="rsync://rsync.prefix.freens.org/gentoo-portage-prefix"
USE="aqua bash-completion coreaudio cracklib cxx mmx mmxext modules ncurses nls objc objc++ prefix readline sse sse2 ssl unicode x64-macos zlib" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="Darwin" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse" KERNEL="Darwin" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en de" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 4


Fabian Groffen






          2011-02-27 18:59:13 UTC
        

/Users/me/Gentoo/bin/bash /Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/libtool --silent --preserve-dup-deps --mode=link x86_64-apple-darwin10-gcc -DPHP_ATOM_INC -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/include -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/main -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/ext/date/lib -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/ext/ereg/regex -I/usr/include/libxml2 -I/Users/me/Gentoo/usr/include -I/Users/me/Gentoo/usr/include/freetype2 -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/ext/mbstring/libmbfl -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/ext/mbstring/libmbfl/mbfl -I/Users/me/Gentoo/usr/include/mysql -I/Users/me/Gentoo/usr/include/libxml2 -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/TSRM -I/Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/Zend -no-cpp-precomp -I/Users/me/Gentoo/usr/include -O2 -pipe -fomit-frame-pointer -march=nocona -fvisibility=hidden -Wl,-dead_strip_dylibs -o ext/zip/zip.la -export-dynamic -avoid-version -prefer-pic -module -rpath /Users/me/Gentoo/var/tmp/portage/dev-lang/php-5.3.3-r1/work/sapis-build/cgi/modules -L/Users/me/Gentoo/usr/lib ext/zip/php_zip.lo ext/zip/zip_stream.lo ext/zip/lib/zip_add.lo ext/zip/lib/zip_error.lo ext/zip/lib/zip_fclose.lo ext/zip/lib/zip_fread.lo ext/zip/lib/zip_open.lo ext/zip/lib/zip_source_filep.lo ext/zip/lib/zip_strerror.lo ext/zip/lib/zip_close.lo ext/zip/lib/zip_error_get.lo ext/zip/lib/zip_file_error_get.lo ext/zip/lib/zip_free.lo ext/zip/lib/zip_rename.lo ext/zip/lib/zip_source_free.lo ext/zip/lib/zip_unchange_all.lo ext/zip/lib/zip_delete.lo ext/zip/lib/zip_error_get_sys_type.lo ext/zip/lib/zip_file_get_offset.lo ext/zip/lib/zip_get_name.lo ext/zip/lib/zip_replace.lo ext/zip/lib/zip_source_function.lo ext/zip/lib/zip_unchange.lo ext/zip/lib/zip_dirent.lo ext/zip/lib/zip_error_strerror.lo ext/zip/lib/zip_filerange_crc.lo ext/zip/lib/zip_file_strerror.lo ext/zip/lib/zip_get_num_files.lo ext/zip/lib/zip_get_archive_flag.lo ext/zip/lib/zip_set_archive_flag.lo ext/zip/lib/zip_set_name.lo ext/zip/lib/zip_source_zip.lo ext/zip/lib/zip_unchange_data.lo ext/zip/lib/zip_entry_free.lo ext/zip/lib/zip_error_to_str.lo ext/zip/lib/zip_fopen.lo ext/zip/lib/zip_name_locate.lo ext/zip/lib/zip_source_buffer.lo ext/zip/lib/zip_stat.lo ext/zip/lib/zip_entry_new.lo ext/zip/lib/zip_err_str.lo ext/zip/lib/zip_fopen_index.lo ext/zip/lib/zip_get_archive_comment.lo ext/zip/lib/zip_get_file_comment.lo ext/zip/lib/zip_new.lo ext/zip/lib/zip_source_file.lo ext/zip/lib/zip_stat_index.lo ext/zip/lib/zip_set_archive_comment.lo ext/zip/lib/zip_set_file_comment.lo ext/zip/lib/zip_unchange_archive.lo ext/zip/lib/zip_memdup.lo ext/zip/lib/zip_stat_init.lo ext/zip/lib/zip_add_dir.lo ext/zip/lib/zip_error_clear.lo ext/zip/lib/zip_file_error_clear.lo -lz
I/Users/me/Gentoo/usr/include -O2 -pipe -fomit-frame-pointer -march=nocona -fvisibility=hidden -L/Users/me/Gentoo/usr/lib -Wl,-dead_strip_dylibs -Wl,-rpath,/Users/me/Gentoo/usr/lib ext/standard/crypt_freesec.o ext/standard/crypt_blowfish.o ext/standard/crypt_sha512.o ext/standard/crypt_sha256.o ext/standard/php_crypt_r.o ext/date/php_date.o ext/date/lib/astro.o ext/date/lib/dow.o ext/date/lib/parse_date.o ext/date/lib/parse_tz.o ext/date/lib/timelib.o ext/date/lib/tm2unixtime.o ext/date/lib/unixtime2tm.o ext/date/lib/parse_iso_intervals.o ext/date/lib/interval.o ext/ereg/ereg.o ext/ereg/regex/regcomp.o ext/ereg/regex/regexec.o ext/ereg/regex/regerror.o ext/ereg/regex/regfree.o ext/libxml/libxml.o ext/openssl/openssl.o ext/openssl/xp_ssl.o ext/pcre/php_pcre.o ext/sqlite3/sqlite3.o ext/sqlite3/libsqlite/sqlite3.o ext/ctype/ctype.o ext/dom/php_dom.o ext/dom/attr.o ext/dom/document.o ext/dom/domerrorhandler.o ext/dom/domstringlist.o ext/dom/domexception.o ext/dom/namelist.o ext/dom/processinginstruction.o ext/dom/cdatasection.o ext/dom/documentfragment.o ext/dom/domimplementation.o ext/dom/element.o ext/dom/node.o ext/dom/string_extend.o ext/dom/characterdata.o ext/dom/documenttype.o ext/dom/domimplementationlist.o ext/dom/entity.o ext/dom/nodelist.o ext/dom/text.o ext/dom/comment.o ext/dom/domconfiguration.o ext/dom/domimplementationsource.o ext/dom/entityreference.o ext/dom/notation.o ext/dom/xpath.o ext/dom/dom_iterators.o ext/dom/typeinfo.o ext/dom/domerror.o ext/dom/domlocator.o ext/dom/namednodemap.o ext/dom/userdatahandler.o ext/fileinfo/fileinfo.o ext/fileinfo/libmagic/apprentice.o ext/fileinfo/libmagic/apptype.o ext/fileinfo/libmagic/ascmagic.o ext/fileinfo/libmagic/cdf.o ext/fileinfo/libmagic/cdf_time.o ext/fileinfo/libmagic/compress.o ext/fileinfo/libmagic/encoding.o ext/fileinfo/libmagic/fsmagic.o ext/fileinfo/libmagic/funcs.o ext/fileinfo/libmagic/is_tar.o ext/fileinfo/libmagic/magic.o ext/fileinfo/libmagic/print.o ext/fileinfo/libmagic/readcdf.o ext/fileinfo/libmagic/readelf.o ext/fileinfo/libmagic/softmagic.o ext/filter/filter.o ext/filter/sanitizing_filters.o ext/filter/logical_filters.o ext/filter/callback_filter.o ext/gd/gd.o ext/gd/libgd/gd.o ext/gd/libgd/gd_gd.o ext/gd/libgd/gd_gd2.o ext/gd/libgd/gd_io.o ext/gd/libgd/gd_io_dp.o ext/gd/libgd/gd_io_file.o ext/gd/libgd/gd_ss.o ext/gd/libgd/gd_io_ss.o ext/gd/libgd/gd_png.o ext/gd/libgd/gd_jpeg.o ext/gd/libgd/gdxpm.o ext/gd/libgd/gdfontt.o ext/gd/libgd/gdfonts.o ext/gd/libgd/gdfontmb.o ext/gd/libgd/gdfontl.o ext/gd/libgd/gdfontg.o ext/gd/libgd/gdtables.o ext/gd/libgd/gdft.o ext/gd/libgd/gdcache.o ext/gd/libgd/gdkanji.o ext/gd/libgd/wbmp.o ext/gd/libgd/gd_wbmp.o ext/gd/libgd/gdhelpers.o ext/gd/libgd/gd_topal.o ext/gd/libgd/gd_gif_in.o ext/gd/libgd/xbm.o ext/gd/libgd/gd_gif_out.o ext/gd/libgd/gd_security.o ext/gd/libgd/gd_filter.o ext/gd/libgd/gd_pixelate.o ext/gd/libgd/gd_arc.o ext/gd/libgd/gd_rotate.o ext/gd/libgd/gd_color.o ext/hash/hash.o ext/hash/hash_md.o ext/hash/hash_sha.o ext/hash/hash_ripemd.o ext/hash/hash_haval.o ext/hash/hash_tiger.o ext/hash/hash_gost.o ext/hash/hash_snefru.o ext/hash/hash_whirlpool.o ext/hash/hash_adler32.o ext/hash/hash_crc32.o ext/hash/hash_salsa.o ext/iconv/iconv.o ext/json/json.o ext/json/utf8_to_utf16.o ext/json/utf8_decode.o ext/json/JSON_parser.o ext/pdo/pdo.o ext/pdo/pdo_dbh.o ext/pdo/pdo_stmt.o ext/pdo/pdo_sql_parser.o ext/pdo/pdo_sqlstate.o ext/phar/util.o ext/phar/tar.o ext/phar/zip.o ext/phar/stream.o ext/phar/func_interceptors.o ext/phar/dirstream.o ext/phar/phar.o ext/phar/phar_object.o ext/phar/phar_path_check.o ext/posix/posix.o ext/readline/readline.o ext/reflection/php_reflection.o ext/session/session.o ext/session/mod_files.o ext/session/mod_mm.o ext/session/mod_user.o ext/simplexml/simplexml.o ext/simplexml/sxe.o ext/spl/php_spl.o ext/spl/spl_functions.o ext/spl/spl_engine.o ext/spl/spl_iterators.o ext/spl/spl_array.o ext/spl/spl_directory.o ext/spl/spl_exceptions.o ext/spl/spl_observer.o ext/spl/spl_dllist.o ext/spl/spl_heap.o ext/spl/spl_fixedarray.o ext/standard/array.o ext/standard/base64.o ext/standard/basic_functions.o ext/standard/browscap.o ext/standard/crc32.o ext/standard/crypt.o ext/standard/cyr_convert.o ext/standard/datetime.o ext/standard/dir.o ext/standard/dl.o ext/standard/dns.o ext/standard/exec.o ext/standard/file.o ext/standard/filestat.o ext/standard/flock_compat.o ext/standard/formatted_print.o ext/standard/fsock.o ext/standard/head.o ext/standard/html.o ext/standard/image.o ext/standard/info.o ext/standard/iptc.o ext/standard/lcg.o ext/standard/link.o ext/standard/mail.o ext/standard/math.o ext/standard/md5.o ext/standard/metaphone.o ext/standard/microtime.o ext/standard/pack.o ext/standard/pageinfo.o ext/standard/quot_print.o ext/standard/rand.o ext/standard/soundex.o ext/standard/string.o ext/standard/scanf.o ext/standard/syslog.o ext/standard/type.o ext/standard/uniqid.o ext/standard/url.o ext/standard/var.o ext/standard/versioning.o ext/standard/assert.o ext/standard/strnatcmp.o ext/standard/levenshtein.o ext/standard/incomplete_class.o ext/standard/url_scanner_ex.o ext/standard/ftp_fopen_wrapper.o ext/standard/http_fopen_wrapper.o ext/standard/php_fopen_wrapper.o ext/standard/credits.o ext/standard/css.o ext/standard/var_unserializer.o ext/standard/ftok.o ext/standard/sha1.o ext/standard/user_filters.o ext/standard/uuencode.o ext/standard/filters.o ext/standard/proc_open.o ext/standard/streamsfuncs.o ext/standard/http.o ext/tokenizer/tokenizer.o ext/tokenizer/tokenizer_data.o ext/xml/xml.o ext/xml/compat.o ext/xmlreader/php_xmlreader.o ext/xmlwriter/php_xmlwriter.o TSRM/TSRM.o TSRM/tsrm_strtok_r.o TSRM/tsrm_virtual_cwd.o main/main.o main/snprintf.o main/spprintf.o main/php_sprintf.o main/safe_mode.o main/fopen_wrappers.o main/alloca.o main/php_scandir.o main/php_ini.o main/SAPI.o main/rfc1867.o main/php_content_types.o main/strlcpy.o main/strlcat.o main/mergesort.o main/reentrancy.o main/php_variables.o main/php_ticks.o main/network.o main/php_open_temporary_file.o main/php_logos.o main/output.o main/getopt.o main/streams/streams.o main/streams/cast.o main/streams/memory.o main/streams/filter.o main/streams/plain_wrapper.o main/streams/userspace.o main/streams/transports.o main/streams/xp_socket.o main/streams/mmap.o main/streams/glob_wrapper.o Zend/zend_language_parser.o Zend/zend_language_scanner.o Zend/zend_ini_parser.o Zend/zend_ini_scanner.o Zend/zend_alloc.o Zend/zend_compile.o Zend/zend_constants.o Zend/zend_dynamic_array.o Zend/zend_execute_API.o Zend/zend_highlight.o Zend/zend_llist.o Zend/zend_opcode.o Zend/zend_operators.o Zend/zend_ptr_stack.o Zend/zend_stack.o Zend/zend_variables.o Zend/zend.o Zend/zend_API.o Zend/zend_extensions.o Zend/zend_hash.o Zend/zend_list.o Zend/zend_indent.o Zend/zend_builtin_functions.o Zend/zend_sprintf.o Zend/zend_ini.o Zend/zend_qsort.o Zend/zend_multibyte.o Zend/zend_ts_hash.o Zend/zend_stream.o Zend/zend_iterators.o Zend/zend_interfaces.o Zend/zend_exceptions.o Zend/zend_strtod.o Zend/zend_gc.o Zend/zend_closures.o Zend/zend_float.o Zend/zend_objects.o Zend/zend_object_handlers.o Zend/zend_objects_API.o Zend/zend_default_classes.o Zend/zend_execute.o sapi/cgi/cgi_main.o sapi/cgi/fastcgi.o main/internal_functions.o -lresolv -lreadline -lncurses -liconv -liconv -lt1 -lfreetype -lpng -lz -ljpeg -lpcre -lm -lxml2 -lz -licucore -lm -lssl -lcrypto -lz -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -lxml2 -lz -licucore -lm -o sapi/cgi/php-cgi
/Users/me/Gentoo/bin/bash: I/Users/me/Gentoo/usr/include: No such file or directory
make: [sapi/cgi/php-cgi] Fehler 127 (ignoriert)

Ok, so the - in front of the I is missing.




Comment 5


nietonfir





          2011-02-27 21:31:04 UTC
        

Yep, that got my eye as well. And as said, as soon as I comment that block out, it's built completely without any problems. Any clues? I mean, I don't really see how that sed statement should trigger that behaviour, but who knows...

Is it even reproducible on other systems?




Comment 6


nietonfir





          2011-09-15 23:09:59 UTC
        

I'm already on 5.3.6-r1 and got the same issue but a different fix. Will close here, follow-up: #383159









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

