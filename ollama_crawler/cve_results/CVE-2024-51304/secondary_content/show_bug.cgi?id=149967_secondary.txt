Title: 149967 – amarok-1.4.3-r1 crashes on start
URL: https://bugs.gentoo.org/show_bug.cgi?id=149967

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 149967
amarok-1.4.3-r1 crashes on start
Last modified: 2007-03-15 23:49:06 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 149967 
      - amarok-1.4.3-r1 crashes on start


Summary:
amarok-1.4.3-r1 crashes on start
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-10-03 08:35 UTC by Sergey





      Modified:
    
2007-03-15 23:49 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



decamps
gentoo.bug
pacho
sound









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




This is the thing it tries to send via mail to developers

              (amarok-mail,2.92 KB,
                text/plain)

            
2006-10-03 08:36 UTC,

            Sergey




Details





strace amarok

              (strace-amarok,6.58 KB,
                text/plain)

            
2006-10-03 08:39 UTC,

            Sergey




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Sergey





          2006-10-03 08:35:08 UTC
        

# emerge --info
Portage 2.1.1 (default-linux/x86/2006.1/desktop, gcc-3.4.6, glibc-2.3.6-r4, 2.6.17-gentoo-r8 i686)
=================================================================
System uname: 2.6.17-gentoo-r8 i686 Intel(R) Pentium(R) 4 CPU 2.80GHz
Gentoo Base System version 1.12.5
Last Sync: Sat, 30 Sep 2006 21:50:01 +0000
ccache version 2.3 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.3.5-r2, 2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i386-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=pentium4"
CHOST="i386-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/mozilla/defaults/pref /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-O2 -pipe -march=pentium4"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://194.85.81.130/Gentoo ftp://172.16.3.79/gentoo_mirror http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo "
LANG="ru_RU.UTF-8"
LC_ALL=""
LINGUAS="en ru"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://194.85.81.130/gentoo-portage"
USE="x86 X alsa arts bash-completion berkdb bitmap-fonts cairo cdr cli crypt cups dbus dlloader dri dvd dvdr eds elibc_glibc emboss encode esd fam firefox fortran gdbm gif gpm gstreamer gtk hal input_devices_keyboard input_devices_mouse ipv6 isdnlog java jpeg kde kernel_linux ldap libg++ linguas_en linguas_ru mad mikmod mmx mmx2 mp3 mpeg ncurses nls nptl nptlonly ogg opengl oss pam pcre perl png ppds pppd python qt qt3 qt4 quicktime readline reflection samba sdl session spell spl sse sse2 ssl svg tcpd tiff truetype truetype-fonts type1-fonts udev unicode userland_GNU utf8 video_cards_ati video_cards_fglrx video_cards_nvidia video_cards_radeon video_cards_vesa video_cards_vga video_cards_via video_cards_vmware vorbis win32codecs xine xml xorg xv zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Sergey





          2006-10-03 08:36:55 UTC
        

Created attachment 98706 [details]
This is the thing it tries to send via mail to developers




Comment 2


Sergey





          2006-10-03 08:39:50 UTC
        

Created attachment 98707 [details]
strace amarok




Comment 3


Sergey





          2006-10-03 08:41:41 UTC
        

It shows a splash screen for a little then fails.




Comment 4


Sergey





          2006-10-03 08:53:44 UTC
        

I tried emerge "amarok -uD" but in vain.
I can't get when this first occured.
When iptables DROP all packet amarok hangs at all 
showing splash screen until click on it. And does that witpid stuff continuously(see strace attachment)




Comment 5


Sergey





          2006-10-03 09:01:54 UTC
        

amarok-1.3.8 works fine :(




Comment 6


Roman Brunka





          2006-10-25 15:28:23 UTC
        

Try to run it in a terminal. Then write the error message here.




Comment 7


Rob Munsch





          2006-10-30 08:59:17 UTC
        

I also am having weird issues.  It will not start.  I get the splash screen then this message and nothing else:

"Amarok could not find any sound-engine plugins. Amarok is now updating the KDE configuration database. Please wait a couple of minutes, then restart Amarok.
If this does not help, it is likely that Amarok is installed under the wrong prefix, please fix your installation using:
$ cd /path/to/amarok/source-code/
$ su -c "make uninstall"
$ ./configure --prefix=`kde-config --prefix` && su -c "make install"
$ kbuildsycoca
$ amarok
More information can be found in the README file. For further assistance join us at #amarok on irc.freenode.net."

The commandline output is quite long, i will post it as an attachment.




Comment 8


Heiko Nock





          2006-10-31 14:07:12 UTC
        

(In reply to comment #7)
> I also am having weird issues.  It will not start.  I get the splash screen
> then this message and nothing else:

I've also been getting this message for quite some time. I simply can't use Amarok anymore. Upgrading to Amarok-1.4.4 didn't help. Removing and reemerging didn't help. Deleting the configuration files didn't help. Before Amarok-1.4.4 I still got the database configuration dialog, but since upgrading to Amarok-1.4.4 this also doesn't show up anymore. There are several forum messages about this problem, but none of the offered solutions worked for me. 

I suspect it to be a sqlite problem. Maybe a corrupt database?

Until this is resolved, I simply can't use Amarok at all.




Comment 9


Dave G





          2006-11-06 17:24:01 UTC
        

(In reply to comment #8)
> (In reply to comment #7)
> > I also am having weird issues.  It will not start.  I get the splash screen
> > then this message and nothing else:
> 
> I've also been getting this message for quite some time. I simply can't use
> Amarok anymore. Upgrading to Amarok-1.4.4 didn't help. Removing and reemerging
> didn't help. Deleting the configuration files didn't help. Before Amarok-1.4.4
> I still got the database configuration dialog, but since upgrading to
> Amarok-1.4.4 this also doesn't show up anymore. There are several forum
> messages about this problem, but none of the offered solutions worked for me. 
> 
> I suspect it to be a sqlite problem. Maybe a corrupt database?
> 
> Until this is resolved, I simply can't use Amarok at all.
> 

I have been getting this error for a long time as well! It seems that if you 
just keep trying to restart it, eventually it works. The problem MAY be that 
the default xine engine tries to use alsa, but is blocked by the damned artsd.
One solution is to simply disable artsd in the KDE controls. Another way is 
to temporarily kill artsd, then run amarok, then configure the xine to use artsd.

Rant: This highlights the truly sad state of affairs for linux sound software - how many goddamned sound daemons and engines should we have to *&@# with to get an mp3 player to work.




Comment 10


Heiko Nock





          2006-11-10 15:03:08 UTC
        

(In reply to comment #9)
> (In reply to comment #8)
> > (In reply to comment #7)
> > > I also am having weird issues.  It will not start.  I get the splash
> > > screen then this message and nothing else:
> > I've also been getting this message for quite some time. I simply can't use
> > Amarok anymore. Upgrading to Amarok-1.4.4 didn't help. Removing and
> > reemerging didn't help. Deleting the configuration files didn't help. 
> > Before Amarok-1.4.4 I still got the database configuration dialog, but 
> > since upgrading to Amarok-1.4.4 this also doesn't show up anymore. There 
> > are several forum messages about this problem, but none of the offered 
> > solutions worked for me. 
> > I suspect it to be a sqlite problem. Maybe a corrupt database?
> > Until this is resolved, I simply can't use Amarok at all.
> I have been getting this error for a long time as well! It seems that if you 
> just keep trying to restart it, eventually it works.

I've found a solution for my problem on the forum after all:

'find /usr/kde -name \*amarok\* -print0 | xarg -0 rm'

After that I deleted the remaining two amarok folders by hand that it wouldn't delete by itself. I restarted Amarok and this time it brought up the database dialog and didn't give me the damn error message after choosing the folders.

I don't understand why it didn't work earlier, when I deleted the amarok configuration by hand, but as long as it works again, I'm happy.




Comment 11


Kim Nilsson





          2006-11-11 09:23:27 UTC
        

$ amarokapp
QLayout "unnamed" added to QVBox "unnamed", which already has a layout
QLayout: Adding KToolBar/mainToolBar (child of QVBox/unnamed) to layout for PlaylistWindow/PlaylistWindow
Amarok is crashing...
Running: gdb --nw -n --batch -x /tmp/kde-encripted/amarokWyiU6a.tmp amarokapp 30729
Failed to read a valid object file image from memory.
Running: file `which amarokapp`
1.4.3 [___stripped][validity: 0.25][frames:  88][]

Amarok has crashed! We are terribly sorry about this :(

But, all is not lost! Perhaps an upgrade is already available which fixes the problem. Please check your distribution's software repository.

well, this time I got to read the warning about no access to mysql a bit more.

media-sound/amarok-1.4.3-r1

# emerge --info
Portage 2.1.2_rc1-r5 (default-linux/x86/2006.1/desktop, gcc-4.1.1, glibc-2.4-r4, 2.6.18-gentoo-r1 i686)
=================================================================
System uname: 2.6.18-gentoo-r1 i686 Intel(R) Pentium(R) 4 CPU 2.40GHz
Gentoo Base System version 1.12.6
Last Sync: Fri, 10 Nov 2006 17:20:01 +0000
ccache version 2.3 [disabled]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.3.6, 2.4.4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium4 -O2 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/splash /etc/terminfo"
CXXFLAGS="-march=pentium4 -O2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--alphabetical"
FEATURES="autoconfig distlocks metadata-transfer parallel-fetch sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.du.se/pub/os/gentoo http://ds.thn.htu.se/linux/gentoo http://mirror.gentoo.no/ http://gentoo.osuosl.org/ ftp://distro.ibiblio.org/pub/linux/distributions/gentoo/ ftp://ftp.gtlib.gatech.edu/pub/gentoo ftp://ftp.ussg.iu.edu/pub/linux/gentoo ftp://ftp.ucsb.edu/pub/mirrors/linux/gentoo/ ftp://gentoo.mirrors.pair.com/ ftp://gentoo.mirrors.tds.net/gentoo ftp://gentoo.netnitco.net/pub/mirrors/gentoo/source/ ftp://mirror.datapipe.net/gentoo http://mirror.uni-c.dk/pub/gentoo/ http://trumpetti.atm.tut.fi/gentoo/ http://ftp.club-internet.fr/pub/mirrors/gentoo ftp://ftp.uni-erlangen.de/pub/mirrors/gentoo ftp://pandemonium.tiscali.de/pub/gentoo/ ftp://files.gentoo.org ftp://ftp.snt.utwente.nl/pub/os/linux/gentoo ftp://mirrors.blueyonder.co.uk/mirrors/gentoo ftp://ftp.mirrorservice.org/sites/www.ibiblio.org/gentoo/ ftp://ftp.planetmirror.com/pub/gentoo/ ftp://mirror.pacific.net.au/linux/Gentoo ftp://mirror.isp.net.au/pub/gentoo/ "
LANG="sv_SE.UTF-8"
LC_ALL="en_US"
LDFLAGS="-Wl,-O1 -Wl,--sort-common -s"
LINGUAS="sv_SE sv en en_GB en_US da"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/gentoo-webapps-overlay/experimental /usr/local/gentoo-webapps-overlay/production-ready /usr/local/gentoo-general-overlay /usr/local/gentoo-webapps-overlay/experimental /usr/local/gentoo-webapps-overlay/production-ready /usr/local/gentoo-general-overlay"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 7zip X a52 acpi alsa bcmath berkdb bitmap-fonts bzlib cairo cdr cli cracklib crypt cups dbus dlloader dri dvd dvdr eds elibc_glibc emboss encode fam ffmpeg firefox flac fortran ftp gdbm gif gnome gnutls gpm gstreamer gtk hal iconv input_devices_keyboard input_devices_mouse ipv6 isdnlog jpeg jpeg2k kde kernel_linux ldap libg++ linguas_da linguas_en linguas_en_GB linguas_en_US linguas_sv linguas_sv_SE lzo mad mikmod mmx mp3 mpeg ncurses network nls nptl nptlonly nsplugin opengl oss pam pcre perl png ppds pppd python qt qt3 qt4 quicktime readline reflection samba sdl session spell spl sse sse2 ssl tcpd theora truetype truetype-fonts type1-fonts udev unicode userland_GNU video_cards_nvidia win32codecs xinerama xml xml2 xorg xv zlib"
Unset:  CTARGET, INSTALL_MASK, PORTAGE_RSYNC_EXTRA_OPTS




Comment 12


mike <loft306>





          2006-11-18 14:55:05 UTC
        

I just figured out that if I do:
'source /etc/profile' in both the root shell and my users shell then start amarok then all works flawlessly. :)





Comment 13


mike <loft306>





          2006-11-18 14:59:24 UTC
        

(In reply to comment #12)
> I just figured out that if I do:
> 'source /etc/profile' in both the root shell and my users shell then start
> amarok then all works flawlessly. :)
> 

ummm... didnt finnish this one ^^^

so is 'source /etc/profile' not running at the end of emerges or something?




Comment 14


mike <loft306>





          2006-11-18 15:07:09 UTC
        

(In reply to comment #13)
> (In reply to comment #12)
> > I just figured out that if I do:
> > 'source /etc/profile' in both the root shell and my users shell then start
> > amarok then all works flawlessly. :)
> > 
> 
> ummm... didnt finnish this one ^^^
> 
> so is 'source /etc/profile' not running at the end of emerges or something?
> 

or rather is it not in .bashrc it seems i have to run this manuly everytime i get a new shell to avoid the "Amarok could not find any sound-engine plugins" issue.




Comment 15


Jon Kuhn





          2006-11-19 22:16:08 UTC
        

(In reply to comment #10)
> (In reply to comment #9)
> > (In reply to comment #8)
> > > (In reply to comment #7)
> > > > I also am having weird issues.  It will not start.  I get the splash
> > > > screen then this message and nothing else:
> > > I've also been getting this message for quite some time. I simply can't use
> > > Amarok anymore. Upgrading to Amarok-1.4.4 didn't help. Removing and
> > > reemerging didn't help. Deleting the configuration files didn't help. 
> > > Before Amarok-1.4.4 I still got the database configuration dialog, but 
> > > since upgrading to Amarok-1.4.4 this also doesn't show up anymore. There 
> > > are several forum messages about this problem, but none of the offered 
> > > solutions worked for me. 
> > > I suspect it to be a sqlite problem. Maybe a corrupt database?
> > > Until this is resolved, I simply can't use Amarok at all.
> > I have been getting this error for a long time as well! It seems that if you 
> > just keep trying to restart it, eventually it works.
> 
> I've found a solution for my problem on the forum after all:
> 
> 'find /usr/kde -name \*amarok\* -print0 | xarg -0 rm'
> 
> After that I deleted the remaining two amarok folders by hand that it wouldn't
> delete by itself. I restarted Amarok and this time it brought up the database
> dialog and didn't give me the damn error message after choosing the folders.
> 
> I don't understand why it didn't work earlier, when I deleted the amarok
> configuration by hand, but as long as it works again, I'm happy.
> 

I tried this but it was unable to fix the issue for me.  I unmerged deleted the folders and then re-emerged but still have the same problem.  The first time I run it it gives me an error about a python script that I know I have seen before and still had it work fine, and it dumps a bunch of messages to STDOUT about files in '/usr/share/applications/' which it seems to be scanning for some reason, and then this:
QLayout "unnamed" added to QVBox "unnamed", which already has a layout
QLayout: Adding KToolBar/mainToolBar (child of QVBox/unnamed) to layout for PlaylistWindow/PlaylistWindow

Then the second time I run it i see the playlist window but then it crashes and complains about kmail.  This is 1.4.4 but I also tried 1.4.3-r1 and had the same problem.




Comment 16


c-yoborg





          2006-11-30 15:13:14 UTC
        

(In reply to comment #12)
> I just figured out that if I do:
> 'source /etc/profile' in both the root shell and my users shell then start
> amarok then all works flawlessly. :)
> 

If I do 'source /etc/profile', amarok does not give the splash sreen described in comment #7 anymore. The amarok window shows for half a second and the console shows:

Amarok: [Loader] Starting amarokapp..
Amarok: [Loader] Don't run gdb, valgrind, etc. against this binary! Use amarokapp.
QLayout "unnamed" added to QVBox "unnamed", which already has a layout
QLayout: Adding KToolBar/mainToolBar (child of QVBox/unnamed) to layout for PlaylistWindow/PlaylistWindow
QPainter::begin: Cannot paint null pixmap

Afterwards it shows the splash screen again.




Comment 17


Pacho Ramos






          2006-12-09 04:27:06 UTC
        

This
find /usr/kde -name \*amarok\* -print0 | xargs -0 rm

fixed the problem for me :-)

Thanks, I think that this command could be notified in an "ewarn" in amarok ebuild...




Comment 18


Sergey





          2007-02-18 20:19:00 UTC
        

I'm terribly sorry not to post what I did to make it work in time.
It was pretty after the initial post.
But it was long ago enough for me not to remember exactly what i did.
I copied either plugins or libraries from one folder to another - where it tried to find them (what could be seen from the output of crashes)
So the plugins were put in the wrong place.




Comment 19


Jakub Moc (RETIRED)






          2007-03-15 23:49:06 UTC
        

Closing it the original reporter has fixed the issue and this bug has become a mess of completely unrelated issues (mostly dupes of Bug 130052).









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

