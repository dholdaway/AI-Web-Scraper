Title: 422451 – =sys-apps/portage-2.1.10.65: Emerging media-libs/libpng-1.5.11 hangs
URL: https://bugs.gentoo.org/show_bug.cgi?id=422451

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 422451
=sys-apps/portage-2.1.10.65: Emerging media-libs/libpng-1.5.11 hangs
Last modified: 2012-06-19 20:06:19 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 422451 
      - =sys-apps/portage-2.1.10.65: Emerging media-libs/libpng-1.5.11 hangs


Summary:
=sys-apps/portage-2.1.10.65: Emerging media-libs/libpng-1.5.11 hangs
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-06-19 19:08 UTC by Andrey





      Modified:
    
2012-06-19 20:06 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



ssuominen









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andrey





          2012-06-19 19:08:17 UTC
        

When I try to emerge media-libs/libpng-1.5.11 emerge hungs without any response:

Calculating dependencies... done!
>>> Verifying ebuild manifests
>>> Emerging (1 of 1) media-libs/libpng-1.5.11
---hungs here----

I try to wait some hours, but nothing changes. It not uses CPU, only stop works. All other ebuilds including libpng-1.5.10 emerge good.
If I press ctrl+C it prints:
^CTraceback (most recent call last):
  File "/usr/lib64/portage/bin/lock-helper.py", line 28, in <module>
    rval = main(sys.argv[1:])
  File "/usr/lib64/portage/bin/lock-helper.py", line 20, in main
    lock_obj = portage.locks.lockfile(args[0], wantnewlockfile=True)
  File "/usr/lib64/portage/pym/portage/locks.py", line 171, in lockfile
    locking_method(myfd, fcntl.LOCK_EX)
KeyboardInterrupt


Exiting on signal 2
_LockProcess: failed to acquire lock on '/var/tmp/portage/media-libs/libpng-1.5.11'
Traceback (most recent call last):
  File "/usr/bin/emerge", line 43, in <module>
    retval = emerge_main()
  File "/usr/lib64/portage/pym/_emerge/main.py", line 2041, in emerge_main
    myopts, myaction, myfiles, spinner)
  File "/usr/lib64/portage/pym/_emerge/actions.py", line 443, in action_build
    retval = mergetask.merge()
  File "/usr/lib64/portage/pym/_emerge/Scheduler.py", line 1006, in merge
    rval = self._merge()
  File "/usr/lib64/portage/pym/_emerge/Scheduler.py", line 1356, in _merge
    self._main_loop()
  File "/usr/lib64/portage/pym/_emerge/PollScheduler.py", line 154, in _main_loop
    self._schedule()
  File "/usr/lib64/portage/pym/_emerge/PollScheduler.py", line 144, in _schedule
    self._schedule_tasks()
  File "/usr/lib64/portage/pym/_emerge/Scheduler.py", line 1520, in _schedule_tasks
    if self._schedule_tasks_imp():
  File "/usr/lib64/portage/pym/_emerge/Scheduler.py", line 1608, in _schedule_tasks_imp
    self._task_queues.jobs.add(task)
  File "/usr/lib64/portage/pym/_emerge/SequentialTaskQueue.py", line 23, in add
    self.schedule()
  File "/usr/lib64/portage/pym/_emerge/SequentialTaskQueue.py", line 45, in schedule
    task.start()
  File "/usr/lib64/portage/pym/_emerge/AsynchronousTask.py", line 30, in start
    self._start()
  File "/usr/lib64/portage/pym/_emerge/MergeListItem.py", line 91, in _start
    self._start_task(build, self._default_final_exit)
  File "/usr/lib64/portage/pym/_emerge/CompositeTask.py", line 147, in _start_task
    task.start()
  File "/usr/lib64/portage/pym/_emerge/AsynchronousTask.py", line 30, in start
    self._start()
  File "/usr/lib64/portage/pym/_emerge/EbuildBuild.py", line 88, in _start
    self._prefetch_exit(prefetcher)
  File "/usr/lib64/portage/pym/_emerge/EbuildBuild.py", line 143, in _prefetch_exit
    self._build_dir.lock()
  File "/usr/lib64/portage/pym/_emerge/EbuildBuildDir.py", line 61, in lock
    self._assert_lock(builddir_lock)
  File "/usr/lib64/portage/pym/_emerge/EbuildBuildDir.py", line 72, in _assert_lock
    % (async_lock.returncode,))
AssertionError: AsynchronousLock failed with returncode 1

Reproducible: Always




$ emerge --info
Portage 2.1.10.65 (default/linux/amd64/10.0/desktop, gcc-4.6.3, glibc-2.15-r2, 3.4.1 x86_64)
=================================================================
System uname: Linux-3.4.1-x86_64-Pentium-R-_Dual-Core_CPU_T4400_@_2.20GHz-with-gentoo-2.1
Timestamp of tree: Tue, 19 Jun 2012 18:30:01 +0000
ccache version 3.1.7 [enabled]
app-shells/bash:          4.2_p29
dev-lang/python:          2.7.3-r2, 3.2.3-r1
dev-util/ccache:          3.1.7
dev-util/cmake:           2.8.8-r3
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1-r1
sys-apps/openrc:          0.10.3
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.9.6-r3, 1.11.5, 1.12.1
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.6.3
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r3
sys-kernel/linux-headers: 3.4 (virtual/os-headers)
sys-libs/glibc:           2.15-r2
Repositories: gentoo xorik xorik-link
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -mtune=generic -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=core2 -mtune=generic -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--keep-going --fail-clean=y"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs buildpkg ccache config-protect-if-modified distlocks ebuild-locks fail-clean fixlafiles news parallel-fetch parse-eapi-ebuild-head protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://mirror.yandex.ru/gentoo-distfiles "
LANG="ru_RU.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="ru"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/xorik /usr/local/portage/xorik-link"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi alsa amd64 automount bash-completion berkdb bluetooth branding bzip2 cairo cdda cdr cli consolekit cracklib crypt cups cxx dbus dri dts dvd dvdr emboss encode exif fam ffmpeg firefox flac fortran fuse gdbm gdu gif gimp gnome gnome-keyring gpm gtk iconv icu idn ipv6 jpeg laptop lcms libnotify mad mmx mng modules mp3 mp4 mpeg mudflap multilib natspec nautilus ncurses nls nptl ogg opengl openmp pam pango pcre pdf png policykit ppds pppd qt3support readline samba sdl session spell sse sse2 sse3 ssl startup-notification svg tcpd threads tiff truetype udev udisks unicode upnp upower usb userlocales v4l v4l2 vorbis wifi wxwidgets x264 xcb xinerama xml xorg xulrunner xv xvid zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="*" APACHE2_MODULES="authz_host dir alias mime rewrite vhost_alias auth_digest authn_file authz_groupfile dav dav_fs" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" DRACUT_MODULES="lvm" ELIBC="glibc" FOO2ZJS_DEVICES="hp1018" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="mouse keyboard synaptics evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LINGUAS="ru" PHP_TARGETS="php5-3" PYTHON_TARGETS="python3_2 python2_7" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="intel i810 i915 i965" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON




Comment 1


Samuli Suominen (RETIRED)






          2012-06-19 19:14:19 UTC
        

Possible broken filesystem. Have you tried removing the libpng directory from /usr/portage/ and re-syncing?

# rm -rf /usr/portage/media-libs/libpng
# emerge --sync




Comment 2


Andrey





          2012-06-19 19:20:15 UTC
        

(In reply to comment #1)
> Possible broken filesystem. Have you tried removing the libpng directory
> from /usr/portage/ and re-syncing?
> 
> # rm -rf /usr/portage/media-libs/libpng
> # emerge --sync

I try it, also I try to remove libpng-1.5.11.tar.xz from distfiles. But problem still present.




Comment 3


Samuli Suominen (RETIRED)






          2012-06-19 19:34:06 UTC
        

Stop changing the bugs Component to 'baselayout'. This has nothing do with baselayout.




Comment 4


Andrey





          2012-06-19 19:44:43 UTC
        

Thank you, fsck solved the problem









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

