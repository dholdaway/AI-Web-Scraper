Title: 749705 – kde-plasma/plasma-workspace-5.19.5-r2: plasmashell crashes in libQt5Qml
URL: https://bugs.gentoo.org/show_bug.cgi?id=749705

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 749705
kde-plasma/plasma-workspace-5.19.5-r2: plasmashell crashes in libQt5Qml
Last modified: 2020-10-18 10:50:13 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 749705 
      - kde-plasma/plasma-workspace-5.19.5-r2: plasmashell crashes in libQt5Qml


Summary:
kde-plasma/plasma-workspace-5.19.5-r2: plasmashell crashes in libQt5Qml
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-10-17 12:57 UTC by Tom





      Modified:
    
2020-10-18 10:50 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




requested information

              (gentoo.tar.gz,7.20 KB,
                application/gzip)

            
2020-10-17 12:57 UTC,

            Tom




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Tom





          2020-10-17 12:57:51 UTC
        

Created attachment 666194 [details]
requested information

After upgrading to plasma-meta-5.19.5 kde won't run - after initializing 80% it hangs and, after some time, shows a black screen with only xosview running. I'm able to move the mouse, but nothing else happens.

/var/log/syslog shows plasmashell crashing inside libqt5qml:

Oct 17 14:07:24 laptop kernel: [10179.134284] plasmashell[16998]: segfault at 14 ip b71e186a sp bfe2cce0 error 4 in libQt5Qml.so.5.14.2[b715f000+2e1000]
Oct 17 14:07:24 laptop kernel: [10179.134291] Code: 74 24 28 e8 08 f8 f7 ff 83 c4 10 e9 79 ff ff ff 57 56 53 8b 4c 24 14 e8 d4 3c f8 ff 81 c3 a4 77 3d 00 8b 7c 24 10 85 c9 74 56 <8b> 71 04 31 c0 ba 00 80 02 00 85 f6 74 3c f6 46 10 0c 75 36 8b 76

Therefore I've recompiled qtdeclarative-5.14.2-r4, which holds the above library, but without success.

emerge -pqv of the relevant packages:

[ebuild   R   ] kde-plasma/plasma-meta-5.19.5  USE="browser-integration desktop-portal display-manager elogind handbook networkmanager sddm wallpapers -bluetooth -crypt -discover -grub -gtk -kwallet -legacy-systray -plymouth -pulseaudio -qrcode -sdk -systemd -thunderbolt" 
[ebuild   R   ] kde-plasma/plasma-workspace-5.19.5-r2  USE="handbook -appstream -calendar -debug -geolocation -gps -qalculate -qrcode -semantic-desktop -systemd -telemetry -test" 
[ebuild   R   ] kde-frameworks/plasma-5.74.0-r1  USE="X -debug -doc -gles2-only -test -wayland" 
[ebuild   R   ] dev-qt/qtdeclarative-5.14.2-r4  USE="jit widgets -debug -gles2-only -localstorage -test -vulkan"

The attached tar additionally holds this information:
- output of emerge --info
- small extract of /var/log/syslog up to the crash
- dot.Xerrors - from starting up to killing xinit

CU Tom




Comment 1


Andreas Sturmlechner






          2020-10-17 13:53:53 UTC
        

Please try with a clean testuser.




Comment 2


Tom





          2020-10-17 15:15:09 UTC
        

Starting kde plasma as an ordinary user works, although slower.

OTOH running plasma as su worked for many years - and I am aware of the possible risk. ;)

Meanwhile searching the net (using xfce4) it looks like qtqml v5.14 might be the problem when using plasma v5.19 - several users using binary distributions had the same problem with a crashing plasmashell...
I've read about qtqml v5.15.2 should have fixed the segfault?

Do you think my problem could be solved marking all qt* v5.15 packages using the ~x86 flag?

CU Tom




Comment 3


Andreas Sturmlechner






          2020-10-17 15:45:20 UTC
        

(In reply to Tom from comment #2)
> Starting kde plasma as an ordinary user works, although slower.
> 
> OTOH running plasma as su worked for many years - and I am aware of the
> possible risk. ;)
Plasma session as root is unsupported and will be RESOLVED/INVALID.

(In reply to Tom from comment #2)
> several users using binary distributions had the same problem with a crashing
> plasmashell... I've read about qtqml v5.15.2 should have fixed the segfault?
You're first and only report of this kind in Gentoo. If you point me to where you read that, possibly even with link to the commit, then I will happily try and backport to 5.15.1.




Comment 4


Tom





          2020-10-18 10:33:58 UTC
        

(In reply to Andreas Sturmlechner from comment #3)
> (In reply to Tom from comment #2)
> > several users using binary distributions had the same problem with a crashing
> > plasmashell... I've read about qtqml v5.15.2 should have fixed the segfault?
> You're first and only report of this kind in Gentoo. If you point me to
> where you read that, possibly even with link to the commit, then I will
> happily try and backport to 5.15.1.

Sadly I've killed my browser history yesterday and tried hard to find it again this morning, but without success...

In the meantime I've moved my old ~/.config directory out of the way, as it holds configurations for kde 4 and 5, and started the plasma desktop freshly as root - now it works again after reconfiguring it. :)

Looks like some of the old configuration files caused the segfault.

Sorry for making panic on this topic. ;)

CU Tom









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

