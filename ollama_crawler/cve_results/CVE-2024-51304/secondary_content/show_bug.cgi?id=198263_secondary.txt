Title: 198263 – Haupage DVB card crashes Xen domU (sys-kernel/xen-sources)
URL: https://bugs.gentoo.org/show_bug.cgi?id=198263

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 198263
Haupage DVB card crashes Xen domU (sys-kernel/xen-sources)
Last modified: 2008-08-31 17:37:43 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 198263 
      - Haupage DVB card crashes Xen domU (sys-kernel/xen-sources)


Summary:
Haupage DVB card crashes Xen domU (sys-kernel/xen-sources)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Xen Devs








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-11-06 13:07 UTC by Alexander Wigen





      Modified:
    
2008-08-31 17:37 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alexander Wigen





          2007-11-06 13:07:37 UTC
        

I am experiencing a kernel bug when running a Hauppauge Nova T500 Dual HDTV Tuner DVB card inside a Xen domain. I have seen the bug over a long period, close to a year now. It happens in xen-sources 2.6.18-xen-r7 and 2.6.20. It's been a while since I ran 2.6.16 but I believe it happened there as well.

I'm not sure where to go from here. The DVB drivers are from media-tv/v4l-dvg-hg when using 2.6.18 and the included kernel modules in 2.6.20. Can this be a problem with the DVB driver even though the kernel spits out: "kernel BUG at arch/i386/mm/hypervisor.c" ?

The following is the kernel output when the bug trips:

------------[ cut here ]------------
kernel BUG at arch/i386/mm/hypervisor.c:172!
invalid opcode: 0000 [#1]
SMP
Modules linked in: mt2060 dvb_usb_dib0700 dib7000p dib7000m dvb_usb dvb_
core dib3000mc dibx000_common dib0070
CPU:    1
EIP:    0061:[<c010f53b>]    Not tainted VLI
EFLAGS: 00010282   (2.6.18-xen-r7 #2)
EIP is at xen_pgd_pin+0x58/0x66
eax: ffffffea   ebx: c969fe40   ecx: 00000001   edx: 00000000
esi: 00007ff0   edi: e64b4040   ebp: e6acec80   esp: c969fe40
ds: 007b   es: 007b   ss: 0069
Process cron (pid: 4551, ti=c969e000 task=c00eb030 task.ti=c969e000)
Stack: 00000001 00057f8e 13dc8000 00013dc8 c06b72e2 c010c61f e64b4040 c010c64b
       e6acecb4 c0154a6e e69d2a00 00000000 e7bc6bc0 c07df514 e78003c0 c041de48
       c00eb030 e6acec80 00000000 00000000 c07df570 e69d2a00 c0000000 c0365af1
Call Trace:
 [<c010c61f>] __pgd_pin+0x26/0x36
 [<c010c64b>] mm_pin+0x1c/0x22
 [<c0154a6e>] flush_old_exec+0x5b5/0x940
 [<c041de48>] af_unix_init+0x3f/0x59
 [<c0153f99>] kernel_read+0x32/0x43
 [<c016f23a>] load_elf_binary+0x480/0x1430
 [<c0135377>] __alloc_pages+0x4e/0x267
 [<c0153cb0>] copy_strings+0x1b3/0x1bd
 [<c0153d56>] search_binary_handler+0x75/0x1ec
 [<c0155696>] do_execve+0x143/0x1b1
 [<c0103250>] sys_execve+0x2a/0x72
 [<c0104953>] syscall_call+0x7/0xb
Code: 35 c0 a1 64 c6 42 c0 8b 14 90 81 e2 ff ff ff 7f 89 54 24 04 89 e3  b9 01 00 00 00 31 d2 be f0 7f 00 00 e8 09 1e ff ff 85 c0 79 08 <0f> 0b ac 00 97 1d 36 c0 83 c4 0c 5b 5e c3 56 89 c2 c1 ea 0c 53
EIP: [<c010f53b>] xen_pgd_pin+0x58/0x66 SS:ESP 0069:c969fe40


Reproducible: Sometimes

Steps to Reproduce:
Record tv, change channels, record some more. Some times takes a few hours to trigger the bug.
Actual Results:  
The domU crashes and must be "rebooted". The domU will not be able to use the Haupage card again without a proper dom0 reboot.


Portage 2.1.3.16 (default-linux/x86/2006.1, gcc-4.1.2, glibc-2.6.1-r0, 2.6.18-xen-r7 i686)
=================================================================
System uname: 2.6.18-xen-r7 i686 AMD Athlon(tm) 64 X2 Dual Core Processor 4600+
Timestamp of tree: Tue, 06 Nov 2007 04:00:01 +0000
app-shells/bash:     3.2_p17-r1
dev-java/java-config: 1.3.7, 2.1.2-r1
dev-lang/python:     2.4.4-r4, 2.5.1-r3
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.10-r5
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.23
ACCEPT_KEYWORDS="x86 ~x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=athlon64 -pipe -fomit-frame-pointer -msse3 -mno-tls-direct-seg-refs"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O2 -march=athlon64 -pipe -fomit-frame-pointer -msse3 -mno-tls-direct-seg-refs"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS=" ftp://gentoo.chem.wisc.edu/gentoo/ ftp://gentoo.inode.at/source/ ftp://gentoo.itdnet.net/gentoo/ ftp://gentoo.kems.net/mirrors/gentoo ftp://gentoo.llarian.net/pub/gentoo ftp://gentoo.mirrored.ca/ ftp://gentoo.mirrors.pair.com/ ftp://gentoo.mirrors.scphost.com/pub/mirrors/gentoo/ ftp://gentoo.mirrors.tds.net/gentoo ftp://gentoo.netnitco.net/pub/mirrors/gentoo/source/ ftp://gentoo.po.opole.pl"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow a52 aac apache2 berkdb bitmap-fonts cli cracklib crypt dri dv dvb dvdread encode flac fortran gdbm gpm iconv isdnlog jpeg midi mjpeg mmx mmxext mp2 mp3 mpeg mudflap musepack ncurses nls nptl nptlonly ogg openmp pam pcre perl png pnm ppds pppd python readline reflection session speex spl sse sse2 ssl tcpd theora threads truetype-fonts type1-fonts unicode v4l v4l2 vorbis win32codec x86 xorg xv xvid yv12 zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" DVB_CARDS="usb-dib0700" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="none"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


Robert Buchholz (RETIRED)






          2008-08-29 15:32:09 UTC
        

Can you reproduce this issue with newer versions of .18 ? If so, please report the issue upstream on http://bugzilla.xensource.com/




Comment 2


Alexander Wigen





          2008-08-29 23:10:08 UTC
        

Hi,

The host has been un-xenified, so I can't run any tests. The Haupage drivers have also become more stable over time so this bug might not be reproducible.

Cheers









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

