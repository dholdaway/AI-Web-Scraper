Title: 280522 – "python-updater -v" didn't do anything, although setuptools needed updating
URL: https://bugs.gentoo.org/show_bug.cgi?id=280522

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 280522
"python-updater -v" didn't do anything, although setuptools needed updating
Last modified: 2009-08-17 18:08:34 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 280522 
      - "python-updater -v" didn't do anything, although setuptools needed updating


Summary:
"python-updater -v" didn't do anything, although setuptools needed updating
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Python Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-08-06 02:24 UTC by Patrick Ensign





      Modified:
    
2009-08-17 18:08 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



kingjon3377









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




compile failure output

              (compile failure,3.27 KB,
                text/plain)

            
2009-08-06 02:32 UTC,

            Patrick Ensign




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Patrick Ensign





          2009-08-06 02:24:12 UTC
        

Deluge was already installed.  After an update, it would no longer launch.  Attempting to emerge it again produced a compilation failure.

Reproducible: Always

Steps to Reproduce:
1. sync and then emerge --uDN world
2. emerge deluge
Actual Results:  
compilation failure, output attached

Expected Results:  
successful install


no-multilib system ...

Portage 2.1.6.13 (default/linux/amd64/2008.0/no-multilib, gcc-4.3.2, glibc-2.9_p20081201-r2, 2.6.29-gentoo-r5 x86_64)
=================================================================
System uname: Linux-2.6.29-gentoo-r5-x86_64-AMD_Athlon-tm-_64_Processor_3000+-with-gentoo-1.12.11.1
Timestamp of tree: Wed, 05 Aug 2009 20:30:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p39
dev-java/java-config: 2.1.8-r1
dev-lang/python:     2.6.2-r1
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-march=native -O2 -pipe"
DISTDIR="/home/portage/distfiles"
FEATURES="ccache distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://ftp.ucsb.edu/pub/mirrors/linux/gentoo/ http://www.gtlib.gatech.edu/pub/gentoo http://cudlug.cudenver.edu/gentoo/ http://gentoo.mirrors.pair.com/ http://gentoo.mirrors.tds.net/gentoo http://gentoo.netnitco.net http://open-systems.ufl.edu/mirrors/gentoo http://gentoo.llarian.net/ http://gentoo.binarycompass.org http://mirror.datapipe.net/gentoo http://mirrors.cs.wmich.edu/gentoo http://mirror.usu.edu/mirrors/gentoo/ http://mirror.mcs.anl.gov/pub/gentoo/ http://gentoo.mirrors.easynews.com/linux/gentoo/ http://gentoo.cites.uiuc.edu/pub/gentoo/ http://mirror.fslutd.org/linux/distributions/gentoo/ http://gentoo.chem.wisc.edu/gentoo/ http://lug.mtu.edu/gentoo/ http://gentoo.mirrors.hoobly.com/ "
LDFLAGS="-Wl,-O1"
LINGUAS="en en_US"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/home/portage"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X acl acpi alsa amd64 bash-completion berkdb bzip2 cdr cli cracklib crypt cups dbus dri dvd dvdr dvdread encode esd fam firefox fortran gdbm gif gnome gnome-keyring gpm gstreamer gtk guile hal iconv isdnlog java java6 jpeg libnotify mad mikmod mmx mmxext mp3 mpeg mudflap nautilus ncurses networking nls nptl nptlonly nsplugin nvidia nxclient offensive ogg opengl openmp pam pcre pdf perl png pppd python quicktime rar readline reflection sdl session spell spl sse sse2 ssl startup-notification svg symlink sysfs tcpd tiff timidity truetype unicode usb vorbis xml xorg xulrunner xv xvmc zlib" ALSA_CARDS="emu10k1x" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_US" USERLAND="GNU" VIDEO_CARDS="nvidia"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


Patrick Ensign





          2009-08-06 02:32:18 UTC
        

Created attachment 200332 [details]
compile failure output




Comment 2


Wormo (RETIRED)






          2009-08-06 07:05:05 UTC
        

It looks to me like you are missing a module from dev-python/setuptools, even though it is listed as a dependency of deluge. Have you upgraded python recently? Maybe you need to run python-updater to rebuild your python modules. 




Comment 3


Patrick Ensign





          2009-08-06 16:59:16 UTC
        

Python was part of the update.  Curiously, the emerge messages after everything was finished said nothing about it (no mention of dev-lang/python at all)...  I would have expected it to display that message about needing to run python-updater if an upgrade had been performed.  When I run "python-updater -v", it hangs there for a few seconds and returns to the command line, producing no output whatsoever.  Shouldn't it produce something?  "emerge -av1 python-updater" makes no difference.  I may have ran python-updater AFTER --depclean uninstalled the previous version though, I don't remember.

The only mention of the word "python" after that update was completed is as follows:

>>> Messages generated by process 3020 on 2009-08-04 10:14:57 PDT for package dev-python/pygtk-2.14.1:

WARN: postrm
Unable to establish /usr/lib64/python2.5/site-packages/pygtk.py symlink
Unable to establish /usr/lib64/python2.5/site-packages/pygtk.pth symlink

...

"emerge -av1 pygtk" completes without any problems, and does not generate the warning it did before.  Those symlinks are still not there though...  Why are there any python2.5 directories at all?  I have 2.6 installed. 

"eselect python list" shows only 2.6 with the asterisk next to it.
eselect-python is version 20090606

huh ... "emerge -av1 setuptools" made a difference.  Deluge is compiling right now as I write this, whereas it would fail immediately before.  python-updater produces no output.  The setuptools install said a bunch of stuff about purging python2.5 files ... but I still see a bunch of stuff in /usr/lib64/python2.5 ...

I don't know what is going on now...




Comment 4


Wormo (RETIRED)






          2009-08-07 05:59:28 UTC
        

"python-updater -v" certainly should give some output...

What version of python-updater do you have installed? 




Comment 5


Patrick Ensign





          2009-08-07 16:36:54 UTC
        

I have 0.7 ... emerging again does not make any difference ... I am concerned that I have something borked and the system is gonna give me weird problems down the line.




Comment 6


Jonathan Lovelace





          2009-08-07 18:07:14 UTC
        

On an amd64 box of which I am the current maintainer, I neglected to run python-updater after pythhon 2.6 was installed until emerge --depclean had taken python 2.5 away, and when I did run python-updater it gave the same symptoms: it did and said nothing, even with -v. Reinstalling python 2.5 (--oneshot) fixed it.

Emerge --info:
Portage 2.1.6.13 (default/linux/amd64/2008.0, gcc-4.3.2, glibc-2.8_p20080602-r1, 2.6.23-gentoo-r3 x86_64)
=================================================================
System uname: Linux-2.6.23-gentoo-r3-x86_64-AMD_Athlon-tm-_64_X2_Dual_Core_Processor_3800+-with-gentoo-1.12.11.1
Timestamp of tree: Fri, 07 Aug 2009 10:00:21 +0000
app-shells/bash:     3.2_p39
dev-java/java-config: 2.1.8-r1
dev-lang/python:     2.5.4-r3, 2.6.2-r1
dev-python/pycrypto: 2.0.1-r6
dev-util/cmake:      2.6.4
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.7.9-r1, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-mtune=athlon64 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-mtune=athlon64 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--with-bdeps y"
FEATURES="distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict test unmerge-orphans userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
LDFLAGS="-Wl,-O1"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac acl aim alsa amd64 bash-completion berkdb blender-game bzip2 cdr chroot cli cracklib crypt css cups debugger dri dvd dvdr dvdread exif ffmpeg firefox fortran gif gpm gtk gtk2 iconv ipv6 isdnlog ithreads jpeg mad mjpeg mmx mmxext mp3 mpeg mudflap multilib ncurses nls no-htdocs nptl nptlonly nsplugin nvidia ogg openal opengl openmp pam pcre pdf perl png pppd python quicktime readline realmedia reflection sdl session smp spl sse sse2 ssl svg svnserve sysfs tcpd theora truetype unicode usb vorbis wma wmf xcomposite xinerama xorg xvid xvmc yahoo zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="nvidia nv fbdev vesa vga"
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, LANG, LC_ALL, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 7


Patrick Ensign





          2009-08-07 21:39:11 UTC
        

I was thinking of doing the same thing.  I figure I will reinstall python 2.5, run the updater, and then uninstall 2.5 again...

I know for sure that my machine did not spit out the end of emerge message about needing to run python-updater... Perhaps there is a typo in the ebuild or something?




Comment 8


Patrick Ensign





          2009-08-07 22:07:30 UTC
        

great, now I am stuck between a rock and a hard place:

awesome tolkien # emerge -av1 =dev-lang/python-2.5.4-r3

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild  NS   ] sys-libs/db-4.5.20_p2-r1 [4.6.21_p4] USE="java -doc -nocxx -tcl -test" 0 kB
[ebuild  NS   ] dev-lang/python-2.5.4-r3 [2.6.2-r1] USE="berkdb gdbm ncurses readline ssl threads xml -build -doc -examples -ipv6 -sqlite -tk -ucs2 -wininst" 0 kB

Total: 2 packages (2 in new slots), Size of downloads: 0 kB

Would you like to merge these packages? [Yes/No] 

>>> Verifying ebuild manifests

>>> Starting parallel fetch

>>> Emerging (1 of 2) sys-libs/db-4.5.20_p2-r1
 * db-4.5.20.tar.gz RMD160 SHA1 SHA256 size ;-) ...                      [ ok ]
 * patch.4.5.20.1 RMD160 SHA1 SHA256 size ;-) ...                        [ ok ]
 * patch.4.5.20.2 RMD160 SHA1 SHA256 size ;-) ...                        [ ok ]
 * checking ebuild checksums ;-) ...                                     [ ok ]
 * checking auxfile checksums ;-) ...                                    [ ok ]
 * checking miscfile checksums ;-) ...                                   [ ok ]
Traceback (most recent call last):
  File "/usr/bin/java-config-2", line 8, in <module>
    from java_config_2 import __version__
ImportError: No module named java_config_2
 * 
 * Can't run java-config --help
 * Have you upgraded python recently but haven't
 * run python-updater yet?
 * 
 * ERROR: sys-libs/db-4.5.20_p2-r1 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called pkg_setup
 *               ebuild.sh, line 1273:  Called java-pkg-opt-2_pkg_setup
 *   java-pkg-opt-2.eclass, line   45:  Called java-pkg_init
 *     java-utils-2.eclass, line 2050:  Called die
 * The specific snippet of code:
 *   		die "Can't run java-config --help"
 *  The die message:
 *   Can't run java-config --help
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/home/portage/portage/sys-libs/db-4.5.20_p2-r1/temp/build.log'.
 * The ebuild environment file is located at '/home/portage/portage/sys-libs/db-4.5.20_p2-r1/temp/die.env'.
 * 
!!! When you file a bug report, please include the following information:
GENTOO_VM=  CLASSPATH="" JAVA_HOME=""
JAVACFLAGS="" COMPILER=""
and of course, the output of emerge --info

>>> Failed to emerge sys-libs/db-4.5.20_p2-r1, Log file:

>>>  '/home/portage/portage/sys-libs/db-4.5.20_p2-r1/temp/build.log'

 * Messages for package sys-libs/db-4.5.20_p2-r1:

 * 
 * Can't run java-config --help
 * Have you upgraded python recently but haven't
 * run python-updater yet?
 * 
 * ERROR: sys-libs/db-4.5.20_p2-r1 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called pkg_setup
 *               ebuild.sh, line 1273:  Called java-pkg-opt-2_pkg_setup
 *   java-pkg-opt-2.eclass, line   45:  Called java-pkg_init
 *     java-utils-2.eclass, line 2050:  Called die
 * The specific snippet of code:
 *   		die "Can't run java-config --help"
 *  The die message:
 *   Can't run java-config --help
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/home/portage/portage/sys-libs/db-4.5.20_p2-r1/temp/build.log'.
 * The ebuild environment file is located at '/home/portage/portage/sys-libs/db-4.5.20_p2-r1/temp/die.env'.
 * 
awesome tolkien # 





Comment 9


Wormo (RETIRED)






          2009-08-10 06:22:38 UTC
        

Try turning off berkdb flag, and that should allow you to get your python 2.5 back. I think it's a good idea to keep it around for a while longer actually, in case other things have problems with 2.6.




Comment 10


Patrick Ensign





          2009-08-11 20:17:46 UTC
        

I was able to get the old versions installed from tinderbox, then ran python-updater and everything worked just fine.

I would say there is still the issue where the messages that were displayed after the emerge did not say anything about having been updated to a newer python and reminding me to run python-updater...




Comment 11


Lars Wendler (Polynomial-C) (RETIRED)






          2009-08-14 09:20:04 UTC
        

Let's see what our python team thinks about this...




Comment 12


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2009-08-14 15:03:57 UTC
        

I can't reproduce this bug.




Comment 13


tanstaafl@libertytrek.org





          2009-08-17 18:08:34 UTC
        

> Try turning off berkdb flag, and that should allow you to get your
> python 2.5 back. I think it's a good idea to keep it around for a
> while longer actually, in case other things have problems with 2.6.

Can you switch back and forth between python versions? Using python-updater?

How? I don't see this documented in the man page for python-updater... I was holding off on updating python for a while, to let it stabilize a bit more (I'm a bit paranoid about critical system apps like python and portage)...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

