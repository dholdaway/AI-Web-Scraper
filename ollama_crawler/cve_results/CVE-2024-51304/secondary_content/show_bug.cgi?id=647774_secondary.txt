Title: 647774 – kde-frameworks/baloo-5.43.0 in Gnome session - runs with 99.99 % of IO bandwidth
URL: https://bugs.gentoo.org/show_bug.cgi?id=647774

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 647774
kde-frameworks/baloo-5.43.0 in Gnome session - runs with 99.99 % of IO bandwidth
Last modified: 2018-04-20 12:56:10 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 647774 
      - kde-frameworks/baloo-5.43.0 in Gnome session - runs with 99.99 % of IO bandwidth


Summary:
kde-frameworks/baloo-5.43.0 in Gnome session - runs with 99.99 % of IO bandwidth
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

653604

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2018-02-15 20:55 UTC by Juergen Rose





      Modified:
    
2018-04-20 12:56 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Juergen Rose





          2018-02-15 20:55:37 UTC
        

My system is very not responsive. If I run iotop I get the following information:

Total DISK READ :       0.00 B/s | Total DISK WRITE :      11.48 K/s
Actual DISK READ:       0.00 B/s | Actual DISK WRITE:       2.10 M/s
  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO>    COMMAND                                                                
 1937 be/3 root        0.00 B/s   11.48 K/s  0.00 % 99.99 % [jbd2/dm-9-8]
 6277 idle rose        0.00 B/s    0.00 B/s  0.00 % 99.99 % baloo_file_extractor
13901 be/4 root        0.00 B/s    0.00 B/s  0.00 % 99.99 % [kworker/u16:0]
 6556 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.10 % [kworker/1:2]
1000|34:~ni /usr/lib64/firefox/browser/omni.ja -appdir /usr/lib64/firefox/browser 13567 tab

I do not understand why baloo_file_extractor is running. I am using a Gnome desktop via lightdm and I did not start any kde programm. I thought that baloo_file_extractor is a kde programm. If I grep for running kde I see:

 root@lynx:/root(12)# ps -ef | grep kd
root        47     2  0 Feb13 ?        00:00:00 [kdevtmpfs]
root        54     2  0 Feb13 ?        00:00:00 [khungtaskd]
root        60     2  0 Feb13 ?        00:00:00 [kblockd]
systemd+  1455     1  0 16:56 ?        00:00:00 /lib/systemd/systemd-networkd
root      1741     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1745     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1747     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1750     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1754     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1758     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1761     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1765     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1768     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1774     2  0 Feb13 ?        00:00:00 [kdmflush]
root      1990     2  0 16:57 ?        00:00:00 [lockd]
rose      5880  5149  0 Feb13 ?        00:00:03 /usr/bin/kded5
rose      6030  5149  0 Feb13 ?        00:00:00 kdeinit5: Running...
root     11352     2  0 Feb14 ?        00:00:00 [cifsoplockd]
root     14630 11108  0 21:43 pts/5    00:00:00 grep --colour=auto kd
root@lynx:/root(13)# 

rose@lynx:/home/rose(49)$  pgrep -l "gnome|kde|mate|cinnamon|lxde|xfce|jwm"
47 kdevtmpfs
5157 gnome-keyring-d
5160 gnome-session-b
5598 gnome-shell
5789 gnome-shell-cal
5880 kded5
6030 kdeinit5
7947 gnome-terminal-

So my next question is, why kde5 and kdeinit5 is running? I am now not able to update my systems. 'emerge -uvDN world' hangs already for several hours at:

...
INFO:root:Keys refreshed.
INFO:root:Manifest timestamp: 2018-02-15 15:38:30 UTC
INFO:root:Valid OpenPGP signature found:
INFO:root:- primary key: DCD05B71EAB94199527F44ACDB6B8C1F96D8BF6D
INFO:root:- subkey: E1D6ABB63BFCFB4BA02FDF1CEC590EEAC9189250
INFO:root:- timestamp: 2018-02-15 15:38:30 UTC
INFO:root:Verifying /usr/portage_lynx...


Maybe this is related to the issues discribed above.




Comment 1


Juergen Rose





          2018-02-15 21:25:17 UTC
        

>>  I did not start any kde programm.

At this point I was wrong. Okular was running.




Comment 2


Juergen Rose





          2018-02-15 22:37:58 UTC
        

Now on the next system just after the login into gnome via lightdm (I started only one xterm and firefox) iotop shows 99.99% bandwidth for baloo_file_extractor:


4427 be/4 root        12.02 Ms    0.00 B/s  0.00 % 80.36   0.00 B2.7 -b /usr/lib/python-exec/python2.7/emerge -pvueDN system
 6406 be/4 root      395.17 K/s    0.00 B/s  0.00 % 73.41 % diff --brief -r //usr/share/desktop-directories~t/Configurations///usr/share/desktop-directories
 1952 be/3 root        0.00 B/s    0.00 B/s  0.00 % 99.99 % [jbd2/dm-4-8]
 6599 be/4 rose      228.26 K/s    0.00 B/s  0.00 % 99.99 % firefox [Cache2 I/O]
 6853 idle rose       11.71 M/s    0.00 B/s  0.00 % 97.73 % baloo_file_extractor
 4427 be/4 root       45.65 K/s    0.00 B/s  0.00 % 69.90 % python2.7 -b /usr/lib/python-exec/python2.7/emerge -pvueDN system
 6560 be/4 root       38.04 K/s    0.00 B/s  0.00 % 65.70 % python2.7 -b /usr/lib/python-exec/python2.7/emerge -pvueDN system
 4503 be/4 root        0.00 B/s    0.00 B/s  0.00 %  0.38 % [kworker/3:0]
 4351 be/4 rose        0.00 B/s    0.00 B/s  0.00 %  0.06 % gnome-shell




Comment 3


Andreas Sturmlechner






          2018-02-16 10:09:52 UTC
        

I'm not sure what we are supposed to do here... do you think the time is well spent on figuring out why it runs in your Gnome session at all, or do you simply not want to have to deal with baloo anyway (USE=-semantic-desktop is all you need)




Comment 4


Juergen Rose





          2018-02-16 15:58:49 UTC
        

(In reply to Andreas Sturmlechner from comment #3)
> I'm not sure what we are supposed to do here... do you think the time is
> well spent on figuring out why it runs in your Gnome session at all, or do
> you simply not want to have to deal with baloo anyway (USE=-semantic-desktop
> is all you need)

My systems seems to be rather slow, I try to find the reason. I found that baloo_file_extractor is running using 4-5GB of memeory and 99 % of IO-Bandwith.
So I am wondering whether the baloo_file_extractor is responsible for the slowness. 
I do not see at least that baloo_file_extractor is using so much memory at other systems.
Then I wondering whether I can disable baloo and kdeinit5, if I running a Gnome desktop.




Comment 5


Michael Palimaka (kensington)






          2018-02-16 23:01:25 UTC
        

I wonder what packages you have pulling in baloo in Gnome? (equery d kde-frameworks/baloo)




Comment 6


Robert Spillner





          2018-02-18 22:22:17 UTC
        

baloo is seriously broken with respect to io consumption. Broken like so many of the semantic desktop crap tools in kde, current and past (nepomuk...). This is a known state for quite some time (for years). For me I'm fed up with tools that cause a load of 5 when they're supposed to be imperceptible.

Googling "baloo io consumption" reveals many reports of this kind of behaviour in other distros or bugs.kde.org. The problem pops up again and again -- most people conclude to turn it off and that's what I recommend wholeheartedly. Just kill it, "balooctl disable" sometimes keeps the process running.

There is another solution:
http://www.freehackers.org/thomas/2014/05/03/fix-baloo-on-kde-using-the-same-trick-as-onced-used-with-nepomuk/

Sorry for the rant.




Comment 7


Andreas Sturmlechner






          2018-02-18 22:24:05 UTC
        

Your rant is offtopic and the link completely useless considering our very useful USE="-semantic-desktop" feature on Gentoo.




Comment 8


Robert Spillner





          2018-02-19 22:01:57 UTC
        

I know and the link was neither meant to be a serious recommendation nor am I blaming the Gentoo kde team.
It would just be good to have a different solution to tame baloo then to turn the whole thing off. Semantic desktop, in principle, is an important feature.




Comment 9


Juergen Rose





          2018-02-20 21:15:57 UTC
        

(In reply to Michael Palimaka (kensington) from comment #5)
> I wonder what packages you have pulling in baloo in Gnome? (equery d
> kde-frameworks/baloo)

root@lynxold:/root(23)# equery d kde-frameworks/baloo
 * These packages depend on kde-frameworks/baloo:
kde-apps/baloo-widgets-17.12.2 (>=kde-frameworks/baloo-5.40.0:5)
kde-apps/dolphin-17.12.2 (semantic-desktop ? >=kde-frameworks/baloo-5.40.0:5)
kde-apps/gwenview-17.12.2 (semantic-desktop ? >=kde-frameworks/baloo-5.40.0:5)

root@lynxold:/root(24)# emerge -pv1 baloo-widgets dolphin gwenview
These are the packages that would be merged, in order:
Calculating dependencies... done!
[ebuild   R    ] kde-apps/baloo-widgets-17.12.2:5::gentoo  USE="-debug {-test}" 0 KiB
[ebuild   R    ] kde-apps/dolphin-17.12.2:5::gentoo  USE="handbook semantic-desktop -debug {-test} -thumbnail" 0 KiB
[ebuild   R    ] kde-apps/gwenview-17.12.2:5::gentoo  USE="X fits handbook raw semantic-desktop -debug -kipi {-test}" 0 KiB
Total: 3 packages (3 reinstalls), Size of downloads: 0 KiB

root@lynxold:/root(25)# grep semantic-desktop /etc/make.conf
     semantic-desktop




Comment 10


Juergen Rose





          2018-02-20 21:23:48 UTC
        

(In reply to Michael Palimaka (kensington) from comment #5)
> I wonder what packages you have pulling in baloo in Gnome? (equery d
> kde-frameworks/baloo)

Digikam seems to depend on semantic-desktop too:

root@lynxold:/root(29)# equery h semantic-desktop
 * Searching for USE flag semantic-desktop ... 
[IP-] [  ] kde-apps/dolphin-17.12.2:5
[IP-] [  ] kde-apps/gwenview-17.12.2:5
[IP-] [  ] media-gfx/digikam-5.7.0-r3:5




Comment 11


Juergen Rose





          2018-02-20 22:22:26 UTC
        

(In reply to Andreas Sturmlechner from comment #3)
> I'm not sure what we are supposed to do here... do you think the time is
> well spent on figuring out why it runs in your Gnome session at all, or do
> you simply not want to have to deal with baloo anyway (USE=-semantic-desktop
> is all you need)

I removed semantic-desktop from /etc/make.conf, reemerged dolphin, gwenview and digikam, depcleaned baloo-widgets and baloo and killed the still running baloo_file_extractor and baloo_file.
And some seconds later the disk activity LED does not anymore show permanent disk activity.

Thanks for the hint.




Comment 12


Andreas Sturmlechner






          2018-03-05 07:12:40 UTC
        

Since we are not going to solve the resource consumption in here, which as far as upstream concerned is notabug, and the offending package has been removed since, there's probably nothing to do here anymore.




Comment 13


Andreas Sturmlechner






          2018-04-20 12:56:10 UTC
        

*** Bug 653604 has been marked as a duplicate of this bug. ***









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

