Title: 86806 – Hugs compilation hangs on "libraries/Graphics/Rendering/OpenGL/GL/BeginEnd.hs"
URL: https://bugs.gentoo.org/show_bug.cgi?id=86806

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 86806
Hugs compilation hangs on "libraries/Graphics/Rendering/OpenGL/GL/BeginEnd.hs"
Last modified: 2006-10-16 14:22:27 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 86806 
      - Hugs compilation hangs on "libraries/Graphics/Rendering/OpenGL/GL/BeginEnd.hs"


Summary:
Hugs compilation hangs on "libraries/Graphics/Rendering/OpenGL/GL/BeginEnd.hs"
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo's Haskell Language team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-03-26 15:02 UTC by Scott Turner





      Modified:
    
2006-10-16 14:22 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Scott Turner





          2005-03-26 15:02:33 UTC
        

My problem is virtually the same as what was reported in 55188 which was not reproduced.  It occurs for me when emerging the latest Hugs ebuild, hugs98-2005.3. The emerge hangs indefinitely.



Reproducible: Always
Steps to Reproduce:
1. Set package.keywords to ~x86 for hugs.
2. emerge hugs


Actual Results:  
The tail of the ebuild output is

Compiling FFI stubs
../../../src/ffihugs -98 -P../../../hugsdir/packages/OpenGL: -i"HsOpenGL.h"
../../../hugsdir/packages/OpenGL/Graphics/Rendering/OpenGL/GL/BeginEnd.hs
-Iinclude-DCALLCONV=ccall -lGLU -lGL -lm

and there it hangs.

Expected Results:  
Completed the emerge and install of hugs98-2005.3.

Like the reporter of bug 55188, I have NVidia and had disabled OpenGL due to
problems with the "stable" NVidia 6629 driver.  So I attempted to get past the
bug by the method described under 55188. I got my NVidia/OpenGL act together,
finding that the 7167 driver works nicely with my video card. Unfortunately,
this has not eliminated the hang in emerging the latest Hugs.

I've done some debugging of the problem. The ffihugs command generates a stub
and causes it to be compiled into a file BeginEnd.so.  Then (in its source file
machdep.c), ffihugs calls dlopen on the file BeginEnd.so.  Next it calls dlsym
on the symbol HugsAPIVersion.  That's where it hangs. That is, the dlsym
function never returns. I don't understand what could cause dlsym to hang.

# emerge info
Portage 2.0.51.19 (default-linux/x86/2004.0, gcc-3.3.5, glibc-2.3.4.20041102-r1,
2.6.9 i686)
=================================================================
System uname: 2.6.9 i686 Intel(R) Celeron(TM) CPU                1300MHz
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.2.3-r5,dev-lang/python-2.3.4-r1 [2.3.4
(#1, Feb 11 2005, 20:20:43)]
dev-lang/python:     2.2.3-r5, 2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r1
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.4.22-r1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-march=pentium3 -O3 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.1/share/config
/usr/kde/3.2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config
/usr/kde/3.3/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/share/config
/var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=pentium3 -O3 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms"
GENTOO_MIRRORS="ftp://ftp.gtlib.cc.gatech.edu/pub/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/install/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X acpi alsa apm arts avi berkdb bitmap-fonts bonobo cdr cjk crypt
cupscurl divx4linux dvd emacs emboss encode esd fam flash font-server foomaticdb
fortran gdbm gif gnome gphoto2 gpm gtk gtk2 gtkhtml guile imagemagick imap imlib
ipv6 java jpeg kde kerberos libg++ libwww live mad mikmod mmx motif mozilla
mozsvg mp3 mpeg nas ncurses network nls oggvorbis opengl oss pam pdflib perl png
pnp python qt quicktime readline rtc samba scanner sdl slang spell sse ssl svga
tcltk tcpd tiff truetype truetype-fonts type1-fonts usb xml xml2 xmms xv zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS




Comment 1


raptor





          2005-11-30 15:07:37 UTC
        

I have the same problem compilation of  

hugs98-2005.3-r1  +opengl

hangs here and i stop it with Ctrl+C:
Compiling FFI stubs
../../../src/ffihugs -98 -P../../../hugsdir/packages/OpenGL: -i"HsOpenGL.h"
../../../hugsdir/packages/OpenGL/Graphics/Rendering/OpenGL/GL/BeginEnd.hs
-Iinclude -DCALLCONV=ccall -lGLU -lGL -lm




Portage 2.0.51.22-r3 (default-linux/x86/2005.0, gcc-3.3.6, glibc-2.3.5-r2,
2.6.10-rc3 i686)
=================================================================
System uname: 2.6.10-rc3 i686 Intel(R) Celeron(R) CPU 2.53GHz
Gentoo Base System version 1.6.13
dev-lang/python:     2.3.3, 2.4.1-r1
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.4.3-r3, 1.5.10-r4
virtual/os-headers:  2.4.19-r1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=i686 -funroll-loops -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config
/var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=i686 -funroll-loops -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://x.x.x.x:8080/ http://gentoo.itdnet.net/gentoo/"
LANG="C"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/arh/myportage"
SYNC="rsync://x.x.x.x/gentoo-portage"
USE="x86 X aalib alsa apm audiofile autofs avi bash-completion berkdb
bitmap-fonts bonobo bzip2 cdr chroot crypt curl dga directfb divx4linux dvd dvdr
dvdread emboss encode esd ethereal exif expat fam fbcon ffmpeg firebird
foomaticdb fortran gd gdbm gif glut gmp gnome gnomedb gphoto2 gpm gstreamer gtk
gtk2 gtkhtml guile idn imagemagick imlib ipv6 java javascript jpeg junit lcms
ldap libg++ libgda libwww ltsp mad mldonkeypango mmx mmx2 mng mozilla moznomail
mozsvg mp3 mpeg mpeg4 ncurses nls nvidia ogg oggvorbis opengl opie oss pam pcap
pcre pdflib perl pg-intdatetime pg-vacuumdelay png postgres propolice python
quicktime readline ruby samba sdl slang snmp speex spell sqlite sse sse2 ssl svg
svga tcpd tiff truetype truetype-fonts type1-fonts unicode v4l v4l2 vorbis wmf
xface xml xml2 xmms xv xvid zlib zvbi userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LC_ALL, LDFLAGS, LINGUAS, MAKEOPTS







Comment 2


Duncan Coutts (RETIRED)






          2006-02-17 02:47:45 UTC
        

We've made a slight change to the hugs98 ebuild which might improve the opengl / nvidia issue. I'd be interested to know if you find the same problem with dev-lang/hugs98-2005.3-r2.




Comment 3


Scott Turner





          2006-02-17 06:42:39 UTC
        

The problem no longer shows up for me with either
  hugs98-2005.3-r1  +opengl
or
  hugs98-2005.3-r2  +opengl
so I'm afraid no conclusion can be drawn from my setup.




Comment 4


Duncan Coutts (RETIRED)






          2006-02-17 11:38:43 UTC
        

Ok, thanks Scott.




Comment 5


Duncan Coutts (RETIRED)






          2006-03-10 18:21:21 UTC
        

(In reply to comment #1)
> I have the same problem compilation of  
> 
> hugs98-2005.3-r1  +opengl
> 
> hangs here and i stop it with Ctrl+C:

raptor, do you have an nvidia graphics card? what does this command report:
$ opengl-update --get-implementation

(see also bug #55188)




Comment 6


Duncan Coutts (RETIRED)






          2006-08-02 13:30:26 UTC
        

raptor, any progress? Is this bug still a problem for you?

I'm inclined to close this bug with WORKSFORME.




Comment 7


Duncan Coutts (RETIRED)






          2006-10-16 14:22:27 UTC
        

Closing now.

If anyone can repdoruce this then do reopen the bug.

Note that we'll also have a newer hugs version in portage soonish.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

