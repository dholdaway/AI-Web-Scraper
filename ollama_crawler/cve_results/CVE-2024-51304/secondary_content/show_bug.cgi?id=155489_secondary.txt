Title: 155489 – world dependency calculation wrong
URL: https://bugs.gentoo.org/show_bug.cgi?id=155489

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 155489
world dependency calculation wrong
Last modified: 2006-11-17 10:57:20 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 155489 
      - world dependency calculation wrong


Summary:
world dependency calculation wrong
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-11-17 08:25 UTC by Marcin Kowalski





      Modified:
    
2006-11-17 10:57 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



dhp_gentoo









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Marcin Kowalski





          2006-11-17 08:25:46 UTC
        

Portage 2.1.2_rc1-r7 (default-linux/x86/2006.1/desktop, gcc-4.1.1, glibc-2.5-r0, 2.6.18-beyond1pre1 i686)
=================================================================
System uname: 2.6.18-beyond1pre1 i686 AMD Athlon(tm) 64 Processor 3200+
Gentoo Base System version 1.12.6
Last Sync: Fri, 17 Nov 2006 12:50:01 +0000
ccache version 2.4 [enabled]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=athlon-xp -mtune=athlon-xp -O2 -pipe -mfpmath=sse -msse2 -msse3"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=athlon-xp -mtune=athlon-xp -O2 -pipe -mfpmath=sse -msse2 -msse3"
DISTDIR="/home/gentoo/distfiles"
FEATURES="autoconfig candy ccache distlocks moo sandbox sfperms strict userpriv usersandbox"
GENTOO_MIRRORS=" http://distfiles.gentoo.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
LANG="pl_PL.UTF-8"
LC_ALL="pl_PL.UTF-8"
LINGUAS="pl en"
MAKEOPTS="-j2"
PKGDIR="/home/gentoo/packages"
PORTAGE_RSYNC_EXTRA_OPTS="--progress"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/mnt/debian/workdirs/portage"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/home/gentoo/overlays/kpex-media /home/gentoo/overlays/fluidportage /home/gentoo/overlays/sunrise /home/gentoo/overlays/wschlich /home/gentoo/overlays/wrobel /home/gentoo/overlays/ebuild-exchange /home/gentoo/overlays/mpd /home/gentoo/overlays/musicbrainz /home/gentoo/overlays/sabayon /home/gentoo/overlays/custom-kernels /home/gentoo/overlays/portage-xgl /home/gentoo/overlays/geneticone /home/gentoo/overlays/einit /home/gentoo/overlays/gentoojp /home/gentoo/overlays/yoshi /home/gentoo/overlays/nelchael"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 3dnow 3dnowext 7zip X a52 aac aalib acct acl acpi ada aiglx aim akode alsa amazon amr amuled animation ao aoss aotuv apache apache2 ares asf async atk audacious audiofile bash-completion bcmath bcp berkdb bitmap-fonts bittorrent bjam bonjour boost bzip2 cairo calendar caps capslib catalogs ccache cdb cdda cddb cdr cgi chardet clearcase cli clock-screen colordiff cracklib crypt cscope css ctype cups curl cursors custom-cflags dbus devmap dillo directfb djbfft dlloader dmi dnotify dpmod dpms dri dts dvd dvdr dvdread dvi ecc effects elibc_glibc emboss enca encode esd exif expat extraengine extras faad fam fame fastcgi fat fbcon fbdev ffmpeg fftw firefox flac flatfile fontconfig foomaticdb fortran fpx freetype ft ftp fuse gadu gcj gd gdbm geoip ggi gif gimp glade glib glibc-omitfp glitz glsa glut glx gmp gnutls gopher gpgme gpm grammar gs gsm gstreamer gstreamer010 gtk hal hash icons iconv icq idea imagemagick imap imlib inifile inkjar input_devices_keyboard input_devices_mouse ipv6 irc irmc isdnlog jabber javascript jfs jikes jpeg jpeg2k js junit justify kde kdeenablefinal kdehiddenvisibility kdrive kernel_linux key-screen kipi kqemu l7filter largeterminal lcms leim lesstif libcaca libg++ libnotify libsamplerate libvisual lights linguas_en linguas_pl lj lm_sensors logrotate lzo mad maildir mailwrapper math matroska mbox md5sum metalink mhash mikmod mmkeys mmx mmxext mng modplug mods mouse mozsvg mp3 mp4 mp4live mpeg mplayer mudflap multiuser musepack musicbrainz mysql ncurses nethack network nforce2 nls nntp no-old-linux no-seamonkey nogecko-sdk nosendmail nptl nptlonly nsplugin ntfs ogg oggvorbis on-the-fly-crypt openal opengl oss overlays pam panel panel-plugin pango pascal password paste64 pch pcntl pcre pdf pdo perl php plugin pmu png pop posix ppds pppd pulseaudio python qa qmax qsa qt3 qt4 quicktime rar rdesktop readline real reflection reiser4 reiserfs remote rle rplay rrdtool rss rtc ruby sdl sdl-sound search-screen sensord session sharedext silc simplexml skins slang smtp sndfile sockets socks5 softmmu source speedo spell spl sql sqlite sqlite3 srv srvdir sse sse-filters sse2 ssl startup-notification stencil-buffer stroke subtitles subversion svg svga sysfs sysvipc t1lib tabs tagwriting tcl tcltk tcpd textures tga theora thesaurus threads thumbnail thunar thunar-vfs tidy tiff tk tokenizer tools tordns transcode trayicon truetype truetype-fonts type1 type1-fonts udev unicode upnp usb userland_GNU userlocales vcd vcdimager vhosts video_cards_ati video_cards_fglrx video_cards_radeon vidix vim vim-pager vim-with-x visualization vm-switch vorbis win32codecs wma wmf wordperfect wv x264 xchatdccserver xcomposite xfs xgetdefault xine xml xml2 xmlreader xmlrpc xmlwriter xorg xpm xrandr xscreensaver xsettings xsl xv xvid xvmc yahoo yv12 zip zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS

===================================================

okay, i just rid myself from gnome and i tried emerge -uDpv world

i already remerged everything applicable with USE="-gnome" and removed anything that would need gnome. however portage still wants to install gnome-vfs, libgnome gnome-desktop etc etc.

the only thing i found was this dependency:

yOSHi ~ # equery d gnome-vfs
[ Searching for packages depending on gnome-vfs... ]
media-gfx/gimp-2.3.12
gnome-base/librsvg-2.16.0
gnome-extra/libgsf-1.14.2
sys-fs/ntfsprogs-1.13.1
media-libs/xine-lib-1.1.3_pre20061112

all those packages work (and build) fine without gnome-vfs (i already remerged them to make sure). what gives?

2: mono wants to be installed in world update. (i unmerged it recently)
equery d mono

yOSHi ~ # equery d mono
[ Searching for packages depending on mono... ]
dev-lang/swig-1.3.29-r1
dev-java/antlr-2.7.5-r3
dev-libs/gmime-2.2.1
sys-apps/dbus-0.62-r1
net-dns/libidn-0.6.5-r1

yOSHi ~ #  emerge -uDpv swig antlr gmime dbus libidn
These are the packages that would be merged, in order:
Calculating dependencies  ... done!            
Total: 0 packages, Size of downloads: 0 kB

[ebuild   R   ] dev-lang/swig-1.3.29-r1  USE="perl php python ruby tcl tk -doc -guile -java -lua -mono -ocaml -pike" 0 kB 
[ebuild   R   ] dev-java/antlr-2.7.5-r3  USE="python source -debug -doc -examples -mono -nocxx -nojava -script" 0 kB 
[ebuild   R   ] dev-libs/gmime-2.2.1  USE="ipv6 -debug -doc -mono" 0 kB 
[ebuild   R   ] sys-apps/dbus-0.62-r1  USE="X gtk python qt3 qt4 -debug -doc -mono (-selinux)" 0 kB 
[ebuild   R   ] net-dns/libidn-0.6.5-r1  USE="nls -doc -emacs -java -mono" 0 kB 

all those packages have USE="-mono" and have been remerged already.

----------------------------------------------------------------
does anyone have a clue what's going on?




Comment 1


DEMAINE Benoît-Pierre, aka DoubleHP





          2006-11-17 09:29:53 UTC
        

(In reply to comment #0)
> all those packages work (and build) fine without gnome-vfs (i already remerged
> them to make sure). what gives?

no: it worked for you, on your box, for a few minutes.

> does anyone have a clue what's going on?

If ebuild maints put a dep, I bet year salary than removing the dep will lead to something broken for at least one user amongst 10000.

Did you test every single possible feature of those packages for at least 100h long ?

did you at least try some ldd ?

Just what /me thinks. I am not a maint. Good luck.




Comment 2


ebfe





          2006-11-17 09:56:02 UTC
        

Works for me.

>> ACCEPT_KEYWORDS="~x86" USE="-mono" emerge -pve --nospinner swig antlr gmime dbus libidn | grep dev-lang/mono || echo "No Mono required"
>> No Mono required

>> ACCEPT_KEYWORDS="~x86" USE="-gnome" emerge -pve --nospinner gimp librsvg libgsf ntfsprogs xine-lib | grep gnome-vfs || echo "No gnomevfs required"
>> No gnomevfs required



doublehp: your post is completly useless.




Comment 3


Jakub Moc (RETIRED)






          2006-11-17 10:57:20 UTC
        

Don't use equery depends, it doesn't look at use flags state. If you want to find out what pulls in some package, then package.mask it (or pass --tree option to emerge).

Bugzilla is not a support forum, please don't use it as such.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

