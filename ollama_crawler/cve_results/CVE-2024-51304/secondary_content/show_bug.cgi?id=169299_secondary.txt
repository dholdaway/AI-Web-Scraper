Title: 169299 – net-misc/whois-4.7.20 cannot find idna.h; does not build
URL: https://bugs.gentoo.org/show_bug.cgi?id=169299

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 169299
net-misc/whois-4.7.20 cannot find idna.h; does not build
Last modified: 2007-03-05 07:53:53 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 169299 
      - net-misc/whois-4.7.20 cannot find idna.h; does not build


Summary:
net-misc/whois-4.7.20 cannot find idna.h; does not build
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-03-04 15:00 UTC by Martin





      Modified:
    
2007-03-05 07:53 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin





          2007-03-04 15:00:27 UTC
        

net-misc/whois-4.7.20 has compile error

whois.c:32:18: error: idna.h: No such file or directory
whois.c: In function 'normalize_domain':
whois.c:790: error: 'IDNA_SUCCESS' undeclared (first use in this function)
whois.c:790: error: (Each undeclared identifier is reported only once
whois.c:790: error: for each function it appears in.)
make: *** [whois] Error 1


Reproducible: Always

Steps to Reproduce:
1. Gentoo install 2006.1 x86_64 with fairly minimal gnome setup (gaim, thunderbird, that's about it)
2. emerge --sync (a few days later)
3. emerge --update --deep --newuse world (there were actually no altered USE flags but I was just following the suggested command from the handbook)

Actual Results:  
>>> Emerging (33 of 75) net-misc/whois-4.7.20 to /
>>> Downloading 'http://gentoo.mirrors.tera-byte.com/distfiles/whois_4.7.20.tar.gz'
--06:19:33--  http://gentoo.mirrors.tera-byte.com/distfiles/whois_4.7.20.tar.gz
           => `/usr/portage/distfiles/whois_4.7.20.tar.gz'
Resolving gentoo.mirrors.tera-byte.com... 216.194.64.133
Connecting to gentoo.mirrors.tera-byte.com|216.194.64.133|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 60,004 (59K) [application/x-gzip]

100%[====================================>] 60,004         4.12K/s    ETA 00:00

06:19:51 (4.21 KB/s) - `/usr/portage/distfiles/whois_4.7.20.tar.gz' saved [60004/60004]

 * checking ebuild checksums ;-) ...                                      [ ok ] * checking auxfile checksums ;-) ...                                     [ ok ] * checking miscfile checksums ;-) ...                                    [ ok ] * checking whois_4.7.20.tar.gz ;-) ...                                   [ ok ]>>> Unpacking source...
>>> Unpacking whois_4.7.20.tar.gz to /var/tmp/portage/net-misc/whois-4.7.20/work * Applying whois-4.7.19-gentoo-security.patch ...                        [ ok ] * Applying whois-4.7.2-config-file.patch ...                             [ ok ]>>> Source unpacked.
>>> Compiling source in /var/tmp/portage/net-misc/whois-4.7.20/work/whois-4.7.20 ...
perl -w make_as_del.pl < as_del_list > as_del.h
perl -w make_ip_del.pl < ip_del_list > ip_del.h
perl -w make_ip6_del.pl < ip6_del_list > ip6_del.h
perl -w make_tld_serv.pl < tld_serv_list > tld_serv.h
x86_64-pc-linux-gnu-gcc -march=athlon64 -O2 -pipe -DHAVE_LIBIDN -march=athlon64 -O2 -pipe whois.c -o whois \
                 -lidn
whois.c:32:18: error: idna.h: No such file or directory
whois.c: In function 'normalize_domain':
whois.c:790: error: 'IDNA_SUCCESS' undeclared (first use in this function)
whois.c:790: error: (Each undeclared identifier is reported only once
whois.c:790: error: for each function it appears in.)
make: *** [whois] Error 1

!!! ERROR: net-misc/whois-4.7.20 failed.
Call stack:
  ebuild.sh, line 1614:   Called dyn_compile
  ebuild.sh, line 971:   Called qa_call 'src_compile'
  environment, line 3092:   Called src_compile
  whois-4.7.20.ebuild, line 39:   Called die

!!! (no error message)
!!! If you need support, post the topmost build error, and the call stack if relevant.
!!! A complete build log is located at '/var/tmp/portage/net-misc/whois-4.7.20/temp/build.log'.



Expected Results:  
Expected a successful emerge command.

# emerge --info
Portage 2.1.2-r9 (default-linux/amd64/2006.1/desktop, gcc-4.1.1, glibc-2.4-r3, 2.6.19-gentoo-r5 x86_64)
=================================================================
System uname: 2.6.19-gentoo-r5 x86_64 AMD Turion(tm) 64 Mobile Technology MK-36
Gentoo Base System version 1.12.1
Timestamp of tree: Sun, 04 Mar 2007 05:20:01 +0000
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/terminfo"
CXXFLAGS="-march=athlon64 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://gentoo.mirrors.tera-byte.com/ "
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="X alsa amd64 arts berkdb bitmap-fonts cairo cdr cli cracklib crypt cups dbus dri dvd dvdr eds emboss encode esd fam firefox fortran gdbm gif gnome gpm gstreamer gtk gtk2 hal iconv ipv6 isdnlog jpeg kde ldap libg++ mad midi mikmod mp3 mpeg ncurses nls nptl nptlonly ogg opengl oss pam pcre perl png ppds pppd python qt3 qt4 quicktime readline reflection sdl session spell spl ssl tcpd truetype truetype-fonts type1-fonts unicode vorbis xml xorg xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="apm ark ati chips cirrus cyrix dummy fbdev glint i128 i810 mga neomagic nv rendition s3 s3virge savage siliconmotion sis sisusb tdfx tga trident tseng v4l vesa vga via vmware voodoo"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


ebfe





          2007-03-04 16:54:36 UTC
        

which version of libidn do you have installed?

net-dns/libidn-0.5.15 should provide idna.h - whois-4.7.20 includes a dependency on net-dns/libidn and _should_ pull it in




Comment 2


Martin





          2007-03-04 18:22:17 UTC
        

I did not explicitly emerge this libidn package.  But it appears I do have it (see below).  Nonetheless my "emerge --update --deep --newuse world" seems to not be able to find it.

emerge --search libidn
Searching...
[ Results for search key : libidn ]
[ Applications found : 1 ]

*  net-dns/libidn
      Latest version available: 0.5.15
      Latest version installed: 0.5.15





Comment 3


SpanKY






          2007-03-04 21:08:24 UTC
        

not a bug in whois

as noted by ebfe, libidn-0.5.15 provides /usr/include/idna.h:
root@vapier 1 whois # file /var/tmp/portage/net-dns/libidn-0.5.15/image/usr/include/idna.h
/var/tmp/portage/net-dns/libidn-0.5.15/image/usr/include/idna.h: ASCII C program text




Comment 4


Martin





          2007-03-05 03:00:47 UTC
        

Um, that is not a very satisfactory resolution.

Do you have any theory as to how this happened?  Do I need to send my entire .bash_history to show that I used nothing but exact steps from the Gentoo handbook to get to my base install, and nothing but a few vanilla emerge commands? (for gnome, gaim, firefox, thunderbird)

How can a user, using nothing but emerge commands, arrive at this compile error?




Comment 5


Jakub Moc (RETIRED)






          2007-03-05 03:02:31 UTC
        

No, I don't have any theory, sorry. Re-emerge libidn.




Comment 6


Martin





          2007-03-05 03:48:37 UTC
        

Um, yes, that is what I did to work around this, I did "emerge --unmerge libidn", then "emerge libidn", and then find / -name idna.h was able to find the file (and subsequent emerge commands worked).

However a work around is not the same as a bug solution.  It sounds like you're just trying to say "go away".

You say "not a bug in whois", fine, I hope you're right.  But it is a bug in _something_.

Either I'm an idiot and I manually deleted idna.h, which of course isn't the case, or something else is wrong.  i.e. are you calling me an idiot, or a liar, or you just can't investigate without more details from me?  If it is the latter, what further details of the steps I took from fresh install (which was only a few days ago) would you need to be convinced that something is wrong?

Or is it just not a priority and you've got bigger fish to fry (higher priority things to work on) even if I provide full list of every keystroke from a fresh install, to prove this is reproducible?  If this is the case, okay, I will not re-open this a third time, but it isn't much of a bug reporting system, and is not consistent with how Gentoo/emerge/portage is described and praised in your Install Guides and Handbook.

Sorry, I'm not trying to be a jerk, I'm trying to help by reporting a bug.  What info do you need?




Comment 7


Jakub Moc (RETIRED)






          2007-03-05 07:53:53 UTC
        

Sorry, I have no idea what did delete your idna.h, and likely won't find out, so just leave this bug alone until you can tell who what did eat the file.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

