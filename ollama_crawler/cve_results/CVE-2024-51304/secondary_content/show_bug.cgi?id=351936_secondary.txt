Title: 351936 – www-client/chromium-10.0.634.0-r1 fails with python-2.7 selected
URL: https://bugs.gentoo.org/show_bug.cgi?id=351936

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 351936
www-client/chromium-10.0.634.0-r1 fails with python-2.7 selected
Last modified: 2011-01-18 21:25:07 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 351936 
      - www-client/chromium-10.0.634.0-r1 fails with python-2.7 selected


Summary:
www-client/chromium-10.0.634.0-r1 fails with python-2.7 selected
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Chromium Project








URL:







Whiteboard:
ht-wanted  
  


Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-01-17 20:15 UTC by Dror Levin (RETIRED)





      Modified:
    
2011-01-18 21:25 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Build log of failure

              (build.log,1.62 KB,
                text/plain)

            
2011-01-17 20:16 UTC,

            Dror Levin (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Dror Levin (RETIRED)






          2011-01-17 20:15:29 UTC
        

Python 2.6 is not installed and the default Python version is 2.7:
# eselect python list
Available Python interpreters:
  [1]   python2.7 *
  [2]   python3.1

When trying to merge chromium-10.0.634.0-r1 I get the following error:

/var/tmp/portage/www-client/chromium-10.0.634.0-r1/temp/environment: /usr/bin/v8-extract-version: /usr/bin/python2.6: bad interpreter: No such file or directory
 * ERROR: www-client/chromium-10.0.634.0-r1 failed:
 *   update v8 dependency to 


(will soon attach full build.log).

Looks like some shebang needs to be modified to something like /usr/bin/python2.




Comment 1


Dror Levin (RETIRED)






          2011-01-17 20:16:00 UTC
        

Created attachment 260071 [details]
Build log of failure




Comment 2


Paweł Hajdan, Jr. (RETIRED)






          2011-01-17 20:44:40 UTC
        

Does the issue persist after running python-updater?




Comment 3


Mike Gilbert






          2011-01-17 20:50:18 UTC
        

v8-extract-version is part of chromium-tools. If you re-merge
dev-util/chromium-tools with python2.7 selected, it should update the shebang. At least, it did for me.

The version in the source tarball actually has "#!/usr/bin/python2". I'm not
sure where this is being mangled, but probably in distutils or python eclass.




Comment 4


Dror Levin (RETIRED)






          2011-01-17 21:02:59 UTC
        

(In reply to comment #3)
> v8-extract-version is part of chromium-tools. If you re-merge
> dev-util/chromium-tools with python2.7 selected, it should update the shebang.
> At least, it did for me.

You're right, that did fix the issue. Running python-updater, however, did not (I've run it since upgrading). Should this bug be closed as INVALID or is there something that can be done to make this error a bit more user friendly?

Sorry for bothering you.




Comment 5


Mike Gilbert






          2011-01-17 21:23:17 UTC
        

I think chromium-tools should be changed so that the python2 shebang is NOT changed to python2.x since there really is no reason to tie it to a specific python slot.

python-updater probably should have caught this.




Comment 6


Paweł Hajdan, Jr. (RETIRED)






          2011-01-18 07:10:38 UTC
        

(In reply to comment #4)
> You're right, that did fix the issue. Running python-updater, however, did not
> (I've run it since upgrading). Should this bug be closed as INVALID or is there
> something that can be done to make this error a bit more user friendly?

Let's keep it open for a while. We should definitely prevent breakages like this.

I'll figure out the best place for the fix.




Comment 7


Paweł Hajdan, Jr. (RETIRED)






          2011-01-18 16:14:39 UTC
        

Could you attach/post the output of following commands?

qlist dev-util/chromium-tools | sort
python-updater -p -v

On my system python-updater wants to re-emerge chromium-tools (I haven't unmerged python:2.6 though):

 *   Adding to list: dev-util/chromium-tools:0
 *     check: need_rebuild [ Ebuild set PYTHON_NEED_REBUILD=2.6 ]




Comment 8


Mike Gilbert






          2011-01-18 16:40:15 UTC
        

(In reply to comment #7)
> Could you attach/post the output of following commands?
> 

Probably not directed at me, but I thought I would do it anyway just to see what happens. In my case, I switched from python2.7 to python2.6 just to test this.

> qlist dev-util/chromium-tools | sort

/usr/bin/chromium-depot-tool
/usr/bin/drover
/usr/bin/gcl
/usr/bin/gclient
/usr/bin/v8-create-tarball
/usr/bin/v8-extract-version
/usr/lib64/python2.7/site-packages/chromium_tools-0.1.5-py2.7.egg-info
/usr/share/doc/chromium-tools-0.1.5/PKG-INFO.bz2

> python-updater -p -v
> 

Running with extra tests disabled to speed it up:

floppym@naomi ~ % python-updater -p -v --disable-pylibdir --disable-shared_linking --disable-static_linking --disable-manual
 * Starting Python Updater...
 * Main active version of Python:  2.6
 * Active version of Python 2:     2.6
 * Active version of Python 3:     3.1
 * check "shared_linking" disabled.
 * check "static_linking" disabled.
 * check "pylibdir" disabled.
 * check "manual" disabled.
 * check "need_rebuild" enabled.
 *   Adding to list: dev-libs/boost:1.42
 *     check: need_rebuild [ Ebuild set PYTHON_NEED_REBUILD=2.7 ]
 *   Adding to list: dev-util/chromium-tools:0
 *     check: need_rebuild [ Ebuild set PYTHON_NEED_REBUILD=2.7 ]
 * emerge -Dv1 --keep-going -p dev-libs/boost:1.42 dev-util/chromium-tools:0





Comment 9


Dror Levin (RETIRED)






          2011-01-18 20:34:02 UTC
        

# qlist dev-util/chromium-tools| sort
/usr/bin/chromium-depot-tool
/usr/bin/drover
/usr/bin/gcl
/usr/bin/gclient
/usr/bin/v8-create-tarball
/usr/bin/v8-extract-version
/usr/lib64/python2.7/site-packages/chromium_tools-0.1.5-py2.7.egg-info
/usr/share/doc/chromium-tools-0.1.5/PKG-INFO.xz

I've already fixed the problem by re-emerging chromium-tools myself, so python-updater will surely not find it now.




Comment 10


Paweł Hajdan, Jr. (RETIRED)






          2011-01-18 21:01:37 UTC
        

(In reply to comment #9)
> I've already fixed the problem by re-emerging chromium-tools myself, so
> python-updater will surely not find it now.

Would you like to temporary downgrade to python2.6, unmerge 2.7, and try the update again?

If not, I guess we should close this as WORKSFORME.




Comment 11


Dror Levin (RETIRED)






          2011-01-18 21:25:07 UTC
        

(In reply to comment #10)
> Would you like to temporary downgrade to python2.6, unmerge 2.7, and try the
> update again?
> 
> If not, I guess we should close this as WORKSFORME.

I'll probably won't be able to reproduce this even if I downgrade and upgrade again. Probably something stupid I did back then that I might not do now. So I'm closing this as WORKSFORME.

Thanks for your time and effort.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

