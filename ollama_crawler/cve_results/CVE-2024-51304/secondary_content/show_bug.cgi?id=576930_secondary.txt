Title: 576930 – gnome-base/gnome-extra-apps-3.18.0-r2 depends on 470MB of fonts
URL: https://bugs.gentoo.org/show_bug.cgi?id=576930

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 576930
gnome-base/gnome-extra-apps-3.18.0-r2 depends on 470MB of fonts
Last modified: 2016-05-05 16:51:59 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 576930 
      - gnome-base/gnome-extra-apps-3.18.0-r2 depends on 470MB of fonts


Summary:
gnome-base/gnome-extra-apps-3.18.0-r2 depends on 470MB of fonts
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:




581344



Blocks:







 

        Show dependency tree





 





      Reported:
    
2016-03-10 02:51 UTC by Alexandre Rostovtsev (RETIRED)





      Modified:
    
2016-05-05 16:51 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



fonts
kensington
marduk









See Also:


581344

571098





Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alexandre Rostovtsev (RETIRED)






          2016-03-10 02:51:48 UTC
        

media-fonts/noto is 470MB. It is *absolute 100% madness* to depend on something like that unconditionally from gnome-base/gnome-extra-apps. If you really want to view emojis, please find a reasonably sized font for emojis and put it behind a USE flag.

Don't kill people's mobile download quotas and limited disk space for something that the vast majority of our users don't want and won't need!




Comment 1


Alexandre Rostovtsev (RETIRED)






          2016-03-10 03:05:09 UTC
        

I've masked =gnome-extra-apps-3.18.0-r2 for now:

https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=3bc468d6006243185509ed87b322d1682efd46e2

Please feel free to remove the mask when the font dependency is changed to something with a more reasonable download size.




Comment 2


Michael Palimaka (kensington)






          2016-03-11 17:57:40 UTC
        

While it is a very complete font, only a small subset is likely required for any given user (at least in KDE).

I wonder if we can consider splitting it into multiple packages or having some new package like noto-minimal?




Comment 3


Pacho Ramos






          2016-03-12 09:24:46 UTC
        

What about putting it behing a USE flag? The problem currently is that we don't have any way of knowing what font do we need to install for viewing a concrete character. And it's not only about emojis, it's about many maths symbols and many other fonts that, otherwise, (depending on the app you are using), you simply see nothing or that symbol with the missing unicode character inside it

I also would like to know what kind of maximum distfiles size is now allower by you for allowing to be used in ebuild :|

If you are using mobile limited bandwitch for this I guess you will hit a ton of other ebuilds requiring you to download much more than that for sure




Comment 4


Alexandre Rostovtsev (RETIRED)






          2016-03-13 04:30:33 UTC
        

(In reply to Pacho Ramos from comment #3)

> What about putting it behing a USE flag? The problem currently is that we
> don't have any way of knowing what font do we need to install for viewing a
> concrete character. And it's not only about emojis, it's about many maths
> symbols and many other fonts that, otherwise, (depending on the app you are
> using), you simply see nothing or that symbol with the missing unicode
> character inside it

For mathematical symbols, I personally use stix-fonts (1.8 MB).

Pulling in the full noto font via a USE flag is IMHO still wrong. Because:
(l) most users only need to display text in a small number of human languages;
(2) most users *know* which language they need;
(3) most users want to choose a particular *style* of font for that language based on personal tastes.

So I think the correct solution is a gentoo wiki page that shows them the style of specific fonts for specific languages so they can choose the one they like.

The only purpose for media-fonts/noto that I can imagine is if somebody wants a consistent typeface for a wide variety of writing systems. Let's say to print a big "welcome" poster with the word "welcome" in 20 different languages so that the font style is consistent for all those languages. But most users don't need this!

> I also would like to know what kind of maximum distfiles size is now allower
> by you for allowing to be used in ebuild :|

It's a cost/benefit issue. There are many games with a download size of several gigabytes. But then you get a modern game with beautiful 3D graphics! And of course you install the game explicitly - you are downloading those gigabytes because you specifically asked to download them. However, with media-fonts/noto, you get something 99% useless, and it's pulled in as a very surprising dependency.

PS. On my laptop, in my distfiles directory, the only thing that comes close to media-fonts/noto is qt 4.8, and that's 2 times smaller.




Comment 5


Pacho Ramos






          2016-03-13 09:01:49 UTC
        

What about pulling it optionally? Because you are simply keeping on current way of hiding the problem and pretend people figure out what fonts do they need to cover the missing fonts (that are often even noticed simply because nothing is shown at all).

It's always the same on Gentoo, we pretend our users from knowing about... everything, and knowing what font sets need to be installed is simply near impossible without:
1. Knowing that something is not shown at all because some font set is missing.
2. Trying to figure out what font set is providing that character

It took to me a lot of time to know what was wrong causing me to have random missing characters, I only pretended to get that done by default with the "extras" gnome USE flag and, then, I get the complaints about needing to download a distfile bigger than... ? 

But, well, I guess it's always the same, I could try to push this change, you would revert it, then I simply give up and, as usual, nothing is solved and people will simply see either nothing or some squares forever without knowing what is happening 

I am all for making it (more) optional, but I disagree completely on we providing a mid working setup by default and we relying on people installing manually the remaining pieces to work.




Comment 6


Pacho Ramos






          2016-03-13 09:10:05 UTC
        

Well, other option would be to show an elog message pointing to the concrete font sets. What do you think about that option? In general I don't like much to clobber elog messages as they end up being simply ignored many times... but I guess that would reach like a midpoint between the issue with downloading many MBs and trying to suggest people what they can do to cover most of the fonts they could need in some cases




Comment 7


Albert W. Hopkins





          2016-03-13 11:25:53 UTC
        

(In reply to Alexandre Rostovtsev from comment #4)
> (3) most users want to choose a particular *style* of font for that language
> based on personal tastes.

I especially agree with this one.  The main reason I'm cc:ed to this bug is that after having installed gnome-extra-apps-3.18-r2 a few of my glyphs changed to, IMO, lesser-quality alternatives.  I already had fonts installed that are used to render certain characters I wanted and the newly installed fonts replaced them.

The quickest way I could think of to get around it was to put noto (and unifont) in package.provided.

Perhaps if there was a way to make these fonts optional, as already mentioned via a USE flag or something similar, then I wouldn't see a problem with having them as an optional dependency.




Comment 8


Alexandre Rostovtsev (RETIRED)






          2016-03-13 13:56:20 UTC
        

My suggestions:

1. Split media-fonts/noto as done on its homepage: https://www.google.com/get/noto/
That way gnome-extra-apps can depend on 2.1 MB of emojis (reasonable), and people can install 230 MB of chinese characters only if they like noto's visual style and don't already have another better-looking chinese font installed.

Maybe media-fonts/noto can become a meta package with USE flags pulling in the different noto sub-fonts.

2. Wiki page listing fonts and sample screenshots for different languages.

3. Explain on the wiki how to deal with the krakozyabra / mojibake / tofu problem: copy-paste the strange character into gucharmap search, see which language the character belongs to, install a font for that language.

4. Elog in gnome-extra-apps pointing to the wiki page. (Same elog message can be used in other packages with elogs of suggested fonts, e.g. www-client/chromium.)




Comment 9


Pacho Ramos






          2016-03-13 15:55:15 UTC
        

Well, until someone goes ahead and makes all that, maybe we can go with the elog messages :| (no, I don't have the time for doing all that)




Comment 10


Pacho Ramos






          2016-04-24 12:15:04 UTC
        

Solved adding a note to the wiki:
https://wiki.gentoo.org/wiki/Project:GNOME/GNOME3-Troubleshooting#Missing_emojis_and_characters




Comment 11


Michael Palimaka (kensington)






          2016-04-27 14:10:33 UTC
        

I'm planning on adding a cjk USE flag to media-fonts/noto (with a repackaged tarball). This will still have wide coverage with the compressed tarball reduced to 7.5mb.




Comment 12


Pacho Ramos






          2016-05-05 10:37:07 UTC
        

Wow, interesting :)

This makes me think if maybe some kind of virtual under freedesktop project would be interesting as it looks like all major desktops (KDE, gnome...) need to accomplish this issue of people having problems to know what font set they need to install to get some functionality (also chromium/google-chrome were relying on elog messages for trying to warn people about how to manually handle that).

I have also seen the media-fonts/infinality-ultimate-meta meta package that looks to try to cover something similar :/




Comment 13


Michael Palimaka (kensington)






          2016-05-05 16:51:59 UTC
        

Bug #581344 is fixed now so the dependency is much less painful.

We depend on it unconditionally in Plasma 5 as it's the default font, I'm not sure exactly what it's used for in GNOME.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

