Title: 350567 – mail-client/thunderbird-3.1.7-r2 - nsGTKRemoteService.cpp:256:29: error: invalid conversion from ‘char**’ to ‘const char**’
URL: https://bugs.gentoo.org/show_bug.cgi?id=350567

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 350567
mail-client/thunderbird-3.1.7-r2 - nsGTKRemoteService.cpp:256:29: error: invalid conversion from ‘char**’ to ‘const char**’
Last modified: 2011-01-05 02:41:08 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 350567 
      - mail-client/thunderbird-3.1.7-r2 - nsGTKRemoteService.cpp:256:29: error: invalid conversion from ‘char**’ to ‘const char**’


Summary:
mail-client/thunderbird-3.1.7-r2 - nsGTKRemoteService.cpp:256:29: error: inva...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Mozilla Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-01-04 17:29 UTC by Matt





      Modified:
    
2011-01-05 02:41 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




mail-client\:thunderbird-3.1.7-r2\:20110104-180946.tar.bz2

              (thunderbird-3.1.7-r2_invalid conversion error.tar.bz2,121.65 KB,
                application/octet-stream)

            
2011-01-04 18:27 UTC,

            Matt




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Matt





          2011-01-04 17:29:56 UTC
        

the following 2 errors occur:

nsGTKRemoteService.cpp: In static member function ‘static void nsGTKRemoteService::EnsureAtoms()’: 
nsGTKRemoteService.cpp:256:29: error: invalid conversion from ‘char**’ to ‘const char**’ 
nsGTKRemoteService.cpp:256:29: error: initializing argument 2 of ‘int XInternAtoms(Display*, const char**, int, int, Atom*)’ 
make[5]: *** [nsGTKRemoteService.o] Error 1 
make[5]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla/toolkit/components/remote' 
make[4]: *** [libs] Error 2 
make[4]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla/toolkit/components' 
make[3]: *** [libs_tier_toolkit] Error 2 
make[3]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla' 
make[2]: *** [tier_toolkit] Error 2 
make[2]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla' 
make[1]: *** [default] Error 2 
make[1]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla' 
make: *** [default] Error 2 
emake failed 


XRemoteClient.cpp: In member function ‘virtual nsresult XRemoteClient::Init()’: 
XRemoteClient.cpp:145:77: error: invalid conversion from ‘char**’ to ‘const char**’ 
XRemoteClient.cpp:145:77: error: initializing argument 2 of ‘int XInternAtoms(Display*, const char**, int, int, Atom*)’ 
XRemoteClient.cpp: In member function ‘virtual nsresult XRemoteClient::Init()’: 
XRemoteClient.cpp:145:77: error: invalid conversion from ‘char**’ to ‘const char**’ 
XRemoteClient.cpp:145:77: error: initializing argument 2 of ‘int XInternAtoms(Display*, const char**, int, int, Atom*)’ 
make[4]: *** [XRemoteClient_standalone.o] Error 1 
make[4]: *** Waiting for unfinished jobs.... 
make[4]: *** [XRemoteClient.o] Error 1 
make[4]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla/widget/src/xremoteclient' 
make[3]: *** [libs_tier_toolkit] Error 2 
make[3]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla' 
make[2]: *** [tier_toolkit] Error 2 
make[2]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla' 
make[1]: *** [default] Error 2 
make[1]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-3.1.7-r2/work/comm-1.9.2/mozilla' 
make: *** [default] Error 2 
emake failed 



more information is posted in the forum:

http://forums.gentoo.org/viewtopic-t-858778.html



FWIW this also occurs with upstreams xulrunner-2.0 beta builds and firefox 4.0 beta builds from the mozilla overlay for me:

http://forums.gentoo.org/viewtopic-t-835108-start-50.html




Comment 1


Matt





          2011-01-04 17:32:32 UTC
        

according to the forum thread the fix is rather trivial:
(note the 'const' in static const char)

nsGTKRemoteService.cp 
lines 236-246
// Minimize the roundtrips to the X server by getting all the atoms at once 
static char *XAtomNames[] = { 
MOZILLA_VERSION_PROP, 
MOZILLA_LOCK_PROP, 
MOZILLA_COMMAND_PROP, 
MOZILLA_RESPONSE_PROP, 
MOZILLA_USER_PROP, 
MOZILLA_PROFILE_PROP, 
MOZILLA_PROGRAM_PROP, 
MOZILLA_COMMANDLINE_PROP 
};

to 

// Minimize the roundtrips to the X server by getting all the atoms at once 
static const char *XAtomNames[] = { 
MOZILLA_VERSION_PROP, 
MOZILLA_LOCK_PROP, 
MOZILLA_COMMAND_PROP, 
MOZILLA_RESPONSE_PROP, 
MOZILLA_USER_PROP, 
MOZILLA_PROFILE_PROP, 
MOZILLA_PROGRAM_PROP, 
MOZILLA_COMMANDLINE_PROP 
};



XRemoteClient.cpp 
lines 117-128 

// Minimize the roundtrips to the X-server 
static char *XAtomNames[] = { 
MOZILLA_VERSION_PROP, 
MOZILLA_LOCK_PROP, 
MOZILLA_COMMAND_PROP, 
MOZILLA_RESPONSE_PROP, 
"WM_STATE", 
MOZILLA_USER_PROP, 
MOZILLA_PROFILE_PROP, 
MOZILLA_PROGRAM_PROP, 
MOZILLA_COMMANDLINE_PROP 
};

to

// Minimize the roundtrips to the X-server 
static const char *XAtomNames[] = { 
MOZILLA_VERSION_PROP, 
MOZILLA_LOCK_PROP, 
MOZILLA_COMMAND_PROP, 
MOZILLA_RESPONSE_PROP, 
"WM_STATE", 
MOZILLA_USER_PROP, 
MOZILLA_PROFILE_PROP, 
MOZILLA_PROGRAM_PROP, 
MOZILLA_COMMANDLINE_PROP 
};




Comment 2


Agostino Sarubbo






          2011-01-04 17:53:33 UTC
        

you must not add arch teams in CC.

Please:

If you have write a patch, attach a diff, and attach always complete build log.




Comment 3


Matt





          2011-01-04 18:27:46 UTC
        

Created attachment 258843 [details]
mail-client\:thunderbird-3.1.7-r2\:20110104-180946.tar.bz2

ok, I'll avoid adding arches in the future - sorry !

attaching log

the 2 line-changes above practically are the patch only in plain

what way would be the correct to create a patch:

diff -Nrupad

?

thanks !




Comment 4


Matt





          2011-01-04 19:17:09 UTC
        

ok, to be more precisly this seems to be an upstream-problem introduced by x11-libs/libX11 and meanwhile it got reverted upstream:

http://cgit.freedesktop.org/xorg/lib/libX11/commit/?id=d2714d65e85b44abedf5f82e1a31506dba397ef2






Comment 5


Rafał Mużyło





          2011-01-04 19:36:48 UTC
        

(In reply to comment #4)
> ok, to be more precisly this seems to be an upstream-problem introduced by
> x11-libs/libX11 and meanwhile it got reverted upstream:
> 
> http://cgit.freedesktop.org/xorg/lib/libX11/commit/?id=d2714d65e85b44abedf5f82e1a31506dba397ef2
> 

However, that change was never released.
What's your libX11 version ?




Comment 6


Jeroen Roovers (RETIRED)






          2011-01-04 20:03:02 UTC
        

Comment on attachment 258843 [details]
mail-client\:thunderbird-3.1.7-r2\:20110104-180946.tar.bz2

Er, why a tarball when it contains a single file?




Comment 7


Matt





          2011-01-04 20:09:08 UTC
        

(In reply to comment #5)
> (In reply to comment #4)
> > ok, to be more precisly this seems to be an upstream-problem introduced by
> > x11-libs/libX11 and meanwhile it got reverted upstream:
> > 
> > http://cgit.freedesktop.org/xorg/lib/libX11/commit/?id=d2714d65e85b44abedf5f82e1a31506dba397ef2
> > 
> 
> However, that change was never released.
> What's your libX11 version ?
> 

it was 1.4.0

I upgraded it to an live-ebuild and that *fixed* it :)

(In reply to comment #6)
> (From update of attachment 258843 [details])
> Er, why a tarball when it contains a single file?
> 

oh, that's just a habit ;) 
and as a single (uncompressed) file it would have been too large




Comment 8


Jory A. Pratt






          2011-01-05 02:41:08 UTC
        

My entire system uses libX11-1.4.0 which is what everything for mozilla is built against before pushed out for you the end users to test with.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

