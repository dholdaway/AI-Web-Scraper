Title: 176705 – www-client/mozilla-firefox-2.0.0.3 crashes when the url typed to the addressbar begins with "."
URL: https://bugs.gentoo.org/show_bug.cgi?id=176705

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 176705
www-client/mozilla-firefox-2.0.0.3 crashes when the url typed to the addressbar begins with "."
Last modified: 2007-12-09 15:39:33 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 176705 
      - www-client/mozilla-firefox-2.0.0.3 crashes when the url typed to the addressbar begins with "."


Summary:
www-client/mozilla-firefox-2.0.0.3 crashes when the url typed to the addressb...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Mozilla Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-05-01 18:02 UTC by Mátyás Somfai





      Modified:
    
2007-12-09 15:39 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



cfuga









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




strace output during the reproduction of the crash

              (firefox.strace,27.83 KB,
                text/plain)

            
2007-05-01 18:05 UTC,

            Mátyás Somfai




Details





reproducing the problem with a new profile

              (firefox.new.strace,25.25 KB,
                text/plain)

            
2007-05-01 18:57 UTC,

            Mátyás Somfai




Details





strace with following forks

              (ffcrash.tar.gz,265.09 KB,
                text/plain)

            
2007-05-03 12:56 UTC,

            Mátyás Somfai




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Mátyás Somfai





          2007-05-01 18:02:35 UTC
        

I accidently typed ".gentoo.org" to the addressbar of an opened firefox (yes, it's obviously mistyped  :)  ), and it suddenly chrashed. Than I started a new firefox from console to see if it writes something when I mistype the address again, and I got this:

~ $ firefox
No running windows found
/usr/libexec/mozilla-launcher: line 119: 13904 Segmentation fault $(type -P aoss) "$mozbin" "$@"
firefox-bin exited with non-zero status (139) 


Strace output attached.

Reproducible: Always

Steps to Reproduce:
1. start firefox
2. type ".gentoo.org" to the addressbar

Actual Results:  
firefox crashed


# emerge -pv mozilla-firefox

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] www-client/mozilla-firefox-2.0.0.3  USE="ipv6 java -bindist -debug -filepicker -gnome -mozdevelop -moznopango -restrict-javascript -xforms -xinerama -xprint" LINGUAS="hu -af -ar -be -bg -ca -cs -da -de -el -en_GB -es -es_AR -es_ES -eu -fi -fr -fy -fy_NL -ga -ga_IE -gu -gu_IN -he -it -ja -ka -ko -ku -lt -mk -mn -nb -nb_NO -nl -nn -nn_NO -pa -pa_IN -pl -pt -pt_BR -pt_PT -ru -sk -sl -sv -sv_SE -tr -zh -zh_CN -zh_TW" 36,456 kB

Total: 1 package (1 reinstall), Size of downloads: 36,456 kB

///////////////////////////////////////////////////////////////////////////////

# emerge --info
Portage 2.1.2.2 (default-linux/x86/2006.1/desktop, gcc-4.1.1, glibc-2.5-r0, 2.6.19-gentoo-r5 i686)
=================================================================
System uname: 2.6.19-gentoo-r5 i686 AMD Athlon(tm) XP 1700+
Gentoo Base System release 1.12.9
Timestamp of tree: Mon, 30 Apr 2007 18:20:01 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
dev-java/java-config: 1.3.7, 2.0.31-r7
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.15-r1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=athlon-xp"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/php/apache1-php5/ext-active/ /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/splash /etc/terminfo"
CXXFLAGS="-O2 -march=athlon-xp"
DISTDIR="/usr/portage/distfiles"
FEATURES="distcc distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://gentoo.inf.elte.hu http://gentoo.mirror.icd.hu/ ftp://ftp.nyx.hu/gentoo http://gd.tuwien.ac.at/opsys/linux/gentoo/ http://gd.tuwien.ac.at/opsys/linux/gentoo/"
LINGUAS="hu"
MAKEOPTS="-j6"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp/portage"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /usr/local/portage/xeffects/trunk /usr/local/portage/xeffects/experimental"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X acpi alsa apache2 arts avahi bash-completion berkdb bitmap-fonts bzip2 cairo cdr cli cracklib crypt cups dbus dhcp dri dvd dvdr eds emboss encode esd fam firefox flac fortran gdbm gif gpm gstreamer gtk hal iconv ipv6 isdnlog jpeg kde ldap libg++ lm_sensors mad midi mikmod mmx mmxext mp3 mpeg mysql ncurses nls nptl nptlonly nsplugin nvidia ogg opengl oss pam pcre perl png ppds pppd python qt3 qt4 quicktime readline reflection samba sdl session spell spl sse ssl tcpd tiff truetype truetype-fonts type1-fonts unicode v4l vorbis win32codecs x86 xml xorg xv xvid zeroconf zlib" ALSA_CARDS="via82xx bt87x" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="hu" LIRC_DEVICES="devinput" USERLAND="GNU" VIDEO_CARDS="nvidia vga v4l"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Mátyás Somfai





          2007-05-01 18:05:44 UTC
        

Created attachment 117871 [details]
strace output during the reproduction of the crash




Comment 2


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-01 18:21:14 UTC
        

It works here.

Try with new profile:
  mv ~/.mozilla ~/.mozilla.old




Comment 3


Mátyás Somfai





          2007-05-01 18:56:09 UTC
        

(In reply to comment #2)
> It works here.
> 
> Try with new profile:
>   mv ~/.mozilla ~/.mozilla.old
> 

Tried, but didn't work.
Strace attached.





Comment 4


Mátyás Somfai





          2007-05-01 18:57:15 UTC
        

Created attachment 117877 [details]
reproducing the problem with a new profile




Comment 5


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-02 13:51:50 UTC
        

Try with GDB.

If you don't have sys-devel/gdb, install it:
  emerge sys-devel/gdb

Next run:
  gdb /usr/lib/mozilla-firefox/firefox-bin
  run
  quit

Post the output of GDB.




Comment 6


Mátyás Somfai





          2007-05-03 12:54:06 UTC
        

(In reply to comment #5)
> Try with GDB.
> 
> If you don't have sys-devel/gdb, install it:
>   emerge sys-devel/gdb
> 
> Next run:
>   gdb /usr/lib/mozilla-firefox/firefox-bin
>   run
>   quit
> 
> Post the output of GDB.
> 

I tried many times as you wrote:
   gdb /usr/lib/mozilla-firefox/firefox-bin
   run
   quit

Everything went well, no crash occured.

I tried some times starting firefox with /usr/lib/mozilla-firefox/firefox-bin, no crash.

Than I tried again some times using the "Steps to Reproduce", and firefox crashed again every time!

Than I started with strace:
strace -ff -o ff.out firefox

It made 30 files. Packed and attached.

In the 435. line of the file ff.out there's a SIGSEGV. The end of the line shows that the PID 9750 process made the segfault. So I looked into the ff.out.9750 and it ends with a "poll(" string.

I hope it means more to you.




Comment 7


Mátyás Somfai





          2007-05-03 12:56:26 UTC
        

Created attachment 118040 [details]
strace with following forks




Comment 8


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-03 14:21:27 UTC
        

(In reply to comment #6)
> (In reply to comment #5)
> > Try with GDB.
> > 
> > If you don't have sys-devel/gdb, install it:
> >   emerge sys-devel/gdb
> > 
> > Next run:
> >   gdb /usr/lib/mozilla-firefox/firefox-bin
> >   run
> >   quit
> > 
> > Post the output of GDB.
> > 
> 
> I tried many times as you wrote:
>    gdb /usr/lib/mozilla-firefox/firefox-bin
>    run
>    quit
> 
> Everything went well, no crash occured.

So if you run Firefox with GDB, after executing `run` in GDB and next typing ".gentoo.org" and pressing Enter does Firefox NOT crash?

In my case Firefox doesn't crash and the output of GDB is:
$ gdb /usr/lib/mozilla-firefox/firefox-bin
GNU gdb 6.6
Copyright (C) 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu"...
(no debugging symbols found)
Using host libthread_db library "/lib/libthread_db.so.1".
(gdb) run
Starting program: /usr/lib/mozilla-firefox/firefox-bin
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[Thread debugging using libthread_db enabled]
[New Thread -1208232272 (LWP 4886)]
[New Thread -1210319984 (LWP 4889)]
[New Thread -1220248688 (LWP 4890)]
[New Thread -1236563056 (LWP 4891)]
[New Thread -1246045296 (LWP 4892)]
[New Thread -1255998576 (LWP 4893)]
[New Thread -1265935472 (LWP 4894)]
[New Thread -1274328176 (LWP 4895)]
[New Thread -1283327088 (LWP 4897)]
[New Thread -1291719792 (LWP 4898)]
[New Thread -1301730416 (LWP 4899)]
[New Thread -1310123120 (LWP 4900)]
[Thread -1310123120 (LWP 4900) exited]
[New Thread -1318515824 (LWP 4901)]
[Thread -1318515824 (LWP 4901) exited]
[New Thread -1318515824 (LWP 4916)]
[Thread -1301730416 (LWP 4899) exited]
[Thread -1265935472 (LWP 4894) exited]
[Thread -1274328176 (LWP 4895) exited]
[Thread -1210319984 (LWP 4889) exited]
[Thread -1246045296 (LWP 4892) exited]
[New Thread -1246045296 (LWP 4929)]
[Thread -1246045296 (LWP 4929) exited]
[New Thread -1210319984 (LWP 4930)]
[Thread -1210319984 (LWP 4930) exited]
[Thread -1318515824 (LWP 4916) exited]
[Thread -1255998576 (LWP 4893) exited]
[Thread -1283327088 (LWP 4897) exited]
[Thread -1236563056 (LWP 4891) exited]
[Thread -1291719792 (LWP 4898) exited]
[Thread -1220248688 (LWP 4890) exited]

Program exited normally.
(gdb) quit
$ 

Does it crash when you run `/usr/lib/mozilla-firefox/firefox-bin` in console, next type ".gentoo.org" and press Enter?

Does it crash only if you run `firefox` in console, next type ".gentoo.org" and press Enter?




Comment 9


Mátyás Somfai





          2007-05-03 14:37:50 UTC
        

(In reply to comment #8)
> (In reply to comment #6)
> > (In reply to comment #5)
> > > Try with GDB.
> > > 
> > > If you don't have sys-devel/gdb, install it:
> > >   emerge sys-devel/gdb
> > > 
> > > Next run:
> > >   gdb /usr/lib/mozilla-firefox/firefox-bin
> > >   run
> > >   quit
> > > 
> > > Post the output of GDB.
> > > 
> > 
> > I tried many times as you wrote:
> >    gdb /usr/lib/mozilla-firefox/firefox-bin
> >    run
> >    quit
> > 
> > Everything went well, no crash occured.
> 
> So if you run Firefox with GDB, after executing `run` in GDB and next typing
> ".gentoo.org" and pressing Enter does Firefox NOT crash?
> 
No, it does not crash.
The output of GDB is:

$ gdb /usr/lib/mozilla-firefox/firefox-bin
GNU gdb 6.6
Copyright (C) 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu"...
(no debugging symbols found)
Using host libthread_db library "/lib/libthread_db.so.1".
(gdb) run
Starting program: /usr/lib/mozilla-firefox/firefox-bin
(no debugging symbols found)
Failed to read a valid object file image from memory.
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[Thread debugging using libthread_db enabled]
[New Thread -1222043984 (LWP 11038)]
[New Thread -1223492720 (LWP 11041)]
[New Thread -1248015472 (LWP 11044)]
[New Thread -1263875184 (LWP 11045)]
[New Thread -1275696240 (LWP 11046)]
[New Thread -1284088944 (LWP 11047)]
[New Thread -1293108336 (LWP 11049)]
[New Thread -1301501040 (LWP 11050)]
[New Thread -1309893744 (LWP 11051)]
[New Thread -1319924848 (LWP 11052)]
[New Thread -1328317552 (LWP 11053)]
[Thread -1328317552 (LWP 11053) exited]
[New Thread -1336710256 (LWP 11054)]
[Thread -1336710256 (LWP 11054) exited]
[New Thread -1336710256 (LWP 11055)]
[New Thread -1328317552 (LWP 11056)]
[Thread -1319924848 (LWP 11052) exited]
[Thread -1275696240 (LWP 11046) exited]
[Thread -1284088944 (LWP 11047) exited]
[Thread -1223492720 (LWP 11041) exited]
[Thread -1336710256 (LWP 11055) exited]
[Thread -1328317552 (LWP 11056) exited]
[Thread -1293108336 (LWP 11049) exited]
[Thread -1301501040 (LWP 11050) exited]
[Thread -1263875184 (LWP 11045) exited]
[Thread -1309893744 (LWP 11051) exited]
[Thread -1248015472 (LWP 11044) exited]

Program exited normally.
(gdb) quit

> 
> Does it crash when you run `/usr/lib/mozilla-firefox/firefox-bin` in console,
> next type ".gentoo.org" and press Enter?
No, it doesn't crash.

> Does it crash only if you run `firefox` in console, next type ".gentoo.org" and
> press Enter?
Exactly, it only crashes in this case.





Comment 10


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-04 18:29:42 UTC
        

/usr/bin/firefox is the script which invokes script /usr/libexec/mozilla-launcher which eventually invokes /usr/lib/mozilla-firefox/firefox-bin. /usr/libexec/mozilla-launcher can be run with option "--debug" / "-g" which enables debugging with some debugger (e.g. GDB).

Edit /usr/bin/firefox with your favourite editor (e.g. Vim):
 Change line:
   exec /usr/libexec/mozilla-launcher "$@"
 To:
   exec /usr/libexec/mozilla-launcher -g "$@"

Next run `firefox` in console, next type `run` and next try to type ".gentoo.org" to the addressbar. (If Firefox doesn't crash, close it.) Type `quit`.

Post the entire output starting with something like that:
$ firefox
No running windows found
              MOZILLA_FIVE_HOME=/usr/lib/mozilla-firefox
                LD_LIBRARY_PATH=/usr/lib/mozilla-firefox:/usr/lib/mozilla-firefox/plugins
                        DISPLAY=:0.0
                       debugger=gdb

GNU gdb 6.6
Copyright (C) 2006 Free Software Foundation, Inc.
...




Comment 11


Mátyás Somfai





          2007-05-04 20:06:28 UTC
        

(In reply to comment #10)
> /usr/bin/firefox is the script which invokes script
> /usr/libexec/mozilla-launcher which eventually invokes
> /usr/lib/mozilla-firefox/firefox-bin. /usr/libexec/mozilla-launcher can be run
> with option "--debug" / "-g" which enables debugging with some debugger (e.g.
> GDB).
> 
> Edit /usr/bin/firefox with your favourite editor (e.g. Vim):
>  Change line:
>    exec /usr/libexec/mozilla-launcher "$@"
>  To:
>    exec /usr/libexec/mozilla-launcher -g "$@"
> 
> Next run `firefox` in console, next type `run` and next try to type
> ".gentoo.org" to the addressbar. (If Firefox doesn't crash, close it.) Type
> `quit`.
> 
> Post the entire output starting with something like that:
> $ firefox
> No running windows found
>               MOZILLA_FIVE_HOME=/usr/lib/mozilla-firefox
>                
> LD_LIBRARY_PATH=/usr/lib/mozilla-firefox:/usr/lib/mozilla-firefox/plugins
>                         DISPLAY=:0.0
>                        debugger=gdb
> 
> GNU gdb 6.6
> Copyright (C) 2006 Free Software Foundation, Inc.
> ...
> 

It crashed again, here is the output:


No running windows found
              MOZILLA_FIVE_HOME=/usr/lib/mozilla-firefox
                LD_LIBRARY_PATH=/usr/lib/mozilla-firefox:/usr/lib/mozilla-firefox/plugins
                        DISPLAY=:0
                       debugger=gdb

GNU gdb 6.6
Copyright (C) 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu"...
(no debugging symbols found)
Using host libthread_db library "/lib/libthread_db.so.1".
(gdb) run
Starting program: /usr/lib/mozilla-firefox/firefox-bin
(no debugging symbols found)
Failed to read a valid object file image from memory.
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[Thread debugging using libthread_db enabled]
[New Thread -1223444816 (LWP 9350)]
[New Thread -1224893552 (LWP 9353)]
[New Thread -1248576624 (LWP 9356)]
[New Thread -1264518256 (LWP 9357)]
[New Thread -1276118128 (LWP 9358)]
[New Thread -1284510832 (LWP 9359)]
[New Thread -1294713968 (LWP 9360)]
[New Thread -1303106672 (LWP 9361)]
[New Thread -1312126064 (LWP 9363)]
[New Thread -1321608304 (LWP 9364)]
[New Thread -1330001008 (LWP 9365)]
[Thread -1330001008 (LWP 9365) exited]
[New Thread -1338393712 (LWP 9366)]
[Thread -1338393712 (LWP 9366) exited]
[New Thread -1338393712 (LWP 9367)]
[New Thread -1330001008 (LWP 9368)]
[Thread -1338393712 (LWP 9367) exited]
[New Thread -1338393712 (LWP 9369)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1330001008 (LWP 9368)]
0xafb608a8 in ?? () from /lib/libnss_mdns.so.2
(gdb) quit
The program is running.  Exit anyway? (y or n) y





Comment 12


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-04 20:50:20 UTC
        

(In reply to comment #11)
> Program received signal SIGSEGV, Segmentation fault.
> [Switching to Thread -1330001008 (LWP 9368)]
> 0xafb608a8 in ?? () from /lib/libnss_mdns.so.2

/lib/libnss_mdns.so.2 is probably the source of problems. (I don't have this file.)

If you don't have app-portage/portage-utils, install it:
   emerge portage-utils
   chmod +x /etc/portage/postsync.d/q-reinitialize

Run:
   q -qr

Next post the output of:
   qfile /lib/libnss_mdns.so.2
   emerge -ptv nss-mdns
   emerge -ptv mDNSResponder




Comment 13


Mátyás Somfai





          2007-05-04 21:05:11 UTC
        

(In reply to comment #12)
> (In reply to comment #11)
> > Program received signal SIGSEGV, Segmentation fault.
> > [Switching to Thread -1330001008 (LWP 9368)]
> > 0xafb608a8 in ?? () from /lib/libnss_mdns.so.2
> 
> /lib/libnss_mdns.so.2 is probably the source of problems. (I don't have this
> file.)
> 
> If you don't have app-portage/portage-utils, install it:
>    emerge portage-utils
>    chmod +x /etc/portage/postsync.d/q-reinitialize
> 
> Run:
>    q -qr
> 
> Next post the output of:
>    qfile /lib/libnss_mdns.so.2
>    emerge -ptv nss-mdns
>    emerge -ptv mDNSResponder
> 

# qfile /lib/libnss_mdns.so.2
net-misc/mDNSResponder (/lib/libnss_mdns.so.2)


# emerge -pvt nss-mdns

These are the packages that would be merged, in reverse order:

Calculating dependencies... done!
[ebuild  N    ] sys-auth/nss-mdns-0.8  USE="avahi" 335 kB

Total: 1 package (1 new), Size of downloads: 335 kB


# emerge -pvt mDNSResponder

These are the packages that would be merged, in reverse order:

Calculating dependencies... done!
[ebuild   R   ] net-misc/mDNSResponder-98  1,338 kB

Total: 1 package (1 reinstall), Size of downloads: 1,338 kB






Comment 14


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-04 21:32:20 UTC
        

Temporarily rename this library:
  mv /lib/libnss_mdns.so.2{,-}

Next post the output of running `firefox` in console.




Comment 15


Mátyás Somfai





          2007-05-04 22:20:28 UTC
        

(In reply to comment #14)
> Temporarily rename this library:
>   mv /lib/libnss_mdns.so.2{,-}
> 
> Next post the output of running `firefox` in console.
> 

Yes, this must be the sinner!
I tried more times renaming, backnaming. If this lib is not there, firefox doesn't crash.

Here is the output when lib is renamed:
$ firefox
No running windows found
              MOZILLA_FIVE_HOME=/usr/lib/mozilla-firefox
                LD_LIBRARY_PATH=/usr/lib/mozilla-firefox:/usr/lib/mozilla-firefox/plugins
                        DISPLAY=:0
                       debugger=gdb

GNU gdb 6.6
Copyright (C) 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu"...
(no debugging symbols found)
Using host libthread_db library "/lib/libthread_db.so.1".
(gdb) run
Starting program: /usr/lib/mozilla-firefox/firefox-bin
(no debugging symbols found)
Failed to read a valid object file image from memory.
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[Thread debugging using libthread_db enabled]
[New Thread -1222728016 (LWP 9100)]
[New Thread -1224176752 (LWP 9103)]
[New Thread -1247859824 (LWP 9106)]
[New Thread -1263801456 (LWP 9107)]
[New Thread -1273762928 (LWP 9108)]
[New Thread -1282155632 (LWP 9109)]
[New Thread -1290548336 (LWP 9110)]
[New Thread -1300784240 (LWP 9111)]
[New Thread -1309176944 (LWP 9112)]
[New Thread -1319834736 (LWP 9114)]
[New Thread -1328227440 (LWP 9115)]
[Thread -1328227440 (LWP 9115) exited]
[New Thread -1336620144 (LWP 9116)]
[Thread -1336620144 (LWP 9116) exited]
[New Thread -1336620144 (LWP 9117)]
[New Thread -1328227440 (LWP 9118)]
[Thread -1336620144 (LWP 9117) exited]
[New Thread -1336620144 (LWP 9120)]
[New Thread -1375732848 (LWP 9122)]
[Thread -1375732848 (LWP 9122) exited]
[Thread -1319834736 (LWP 9114) exited]
[Thread -1300784240 (LWP 9111) exited]
[Thread -1309176944 (LWP 9112) exited]
[Thread -1328227440 (LWP 9118) exited]
[Thread -1224176752 (LWP 9103) exited]
[Thread -1336620144 (LWP 9120) exited]
[Thread -1273762928 (LWP 9108) exited]
[Thread -1282155632 (LWP 9109) exited]
[Thread -1263801456 (LWP 9107) exited]
[Thread -1290548336 (LWP 9110) exited]
[Thread -1247859824 (LWP 9106) exited]

Program exited normally.
(gdb) quit





Comment 16


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-05 18:14:41 UTC
        

(In reply to comment #10)
> Edit /usr/bin/firefox with your favourite editor (e.g. Vim):
>  Change line:
>    exec /usr/libexec/mozilla-launcher "$@"
>  To:
>    exec /usr/libexec/mozilla-launcher -g "$@"

Revert these changes.
You can run `firefox -g`, because '"$@"' is expanded to the positional parameters.

I have grepped entire Firefox 2.0.0.3 sources and I haven't found any "nss_mdns".

Try to reinstall mDNSResponder:
 emerge -1tv mDNSResponder




Comment 17


Mátyás Somfai





          2007-05-05 20:21:12 UTC
        

(In reply to comment #16)
> (In reply to comment #10)
> > Edit /usr/bin/firefox with your favourite editor (e.g. Vim):
> >  Change line:
> >    exec /usr/libexec/mozilla-launcher "$@"
> >  To:
> >    exec /usr/libexec/mozilla-launcher -g "$@"
> 
> Revert these changes.
> You can run `firefox -g`, because '"$@"' is expanded to the positional
> parameters.
> 
> I have grepped entire Firefox 2.0.0.3 sources and I haven't found any
> "nss_mdns".
> 
> Try to reinstall mDNSResponder:
>  emerge -1tv mDNSResponder
> 

I tried, but didn't help :(

I tried this too:
# revdep-rebuild -X net-misc/mDNSResponder -- -vt1

It invoked the following command, 9 packages were rebuilt:
emerge --tree --oneshot --verbose net-misc/mDNSResponder =dev-libs/cyrus-sasl-2.1.22-r2 =app-crypt/gnupg-1.9.21 =app-crypt/gpgme-1.1.2-r1 =gno
me-base/libgnomeprint-2.12.1 =dev-cpp/libgnomecanvasmm-2.12.0 =dev-cpp/libgnomemm-2.12.2 =dev-cpp/libgnomeuimm-2.12.0

But it didn't help too.

equery shows this:
# equery d mDNSResponder
[ Searching for packages depending on mDNSResponder... ]
kde-base/kdelibs-3.5.5-r10 (zeroconf & !avahi? net-misc/mDNSResponder)
kde-base/ksysguard-3.5.5 (zeroconf? net-misc/mDNSResponder)

Maybe I should reemerge these two by hand, these were not among the revdep-rebuilt packages.




Comment 18


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-13 17:41:12 UTC
        

(In reply to comment #15)
> (In reply to comment #14)
> > Temporarily rename this library:
> >   mv /lib/libnss_mdns.so.2{,-}
> 
> Yes, this must be the sinner!
> I tried more times renaming, backnaming. If this lib is not there, firefox
> doesn't crash.

After renaming it back to /lib/libnss_mdns.so.2 rebuild mDNSResponder, mozilla-launcher and mozilla-firefox with debug information enabled:
  # quickpkg mozilla-firefox
  # FEATURES="nostrip" emerge -1 mDNSResponder mozilla-{launcher,firefox}

Next post the output of running in console:
  $ firefox -g




Comment 19


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-14 10:22:56 UTC
        

(In reply to comment #18)
>   # FEATURES="nostrip" emerge -1 mDNSResponder mozilla-{launcher,firefox}

  # FEATURES="nostrip" CFLAGS="-O2 -march=athlon-xp -ggdb3" CFLAGS="-O2 -march=athlon-xp -ggdb3" emerge -1 mDNSResponder mozilla-{launcher,firefox}




Comment 20


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2007-05-14 16:52:29 UTC
        

(In reply to comment #19)

You can also read http://www.gentoo.org/proj/en/qa/backtraces.xml




Comment 21


CFuga





          2007-06-22 17:28:31 UTC
        

(In reply to comment #16)

> I have grepped entire Firefox 2.0.0.3 sources and I haven't found any
> "nss_mdns".

 You'll never find any referente to nss_mdns in the Firefox source code.
 This library belongs to mDNSResponder, one of the three Zeroconf implementations available to Gentoo users, and it's invoked when some program requests DNS resolution. (address -> ip). The Zeroconf addresses begin with a dot (like .local or .tcp), and when .gentoo.org is required, it should return a 'hostname not legal' error.

 When Firefox segfaults, is the mdnsd service running? Try

 /etc/init.d/mdnsd start

 before running Firefox, and repeat the previous tests.

 As an alternative, change to avahi instead of mDNSResponder. You could follow the instructions from http://forums.gentoo.org/viewtopic-p-4103073.html




Comment 22


Raúl Porcel (RETIRED)






          2007-12-07 11:12:17 UTC
        

Still happening?




Comment 23


Mátyás Somfai





          2007-12-09 08:30:04 UTC
        

(In reply to comment #22)
> Still happening?
> 

After a HDD crash :( I had to reinstall my Gentoo completely. The problem has gone, and now I use 2.0.0.11.

Anyway, thanks for all of your help, and sorry that I didn't respond lately :-$




Comment 24


Raúl Porcel (RETIRED)






          2007-12-09 15:39:33 UTC
        

Closing, then









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

