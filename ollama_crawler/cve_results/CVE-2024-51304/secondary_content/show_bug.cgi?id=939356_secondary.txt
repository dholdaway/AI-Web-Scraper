Title: 939356 – INSTALL_MASK in profile/make.defaults has no effect
URL: https://bugs.gentoo.org/show_bug.cgi?id=939356

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 939356
INSTALL_MASK in profile/make.defaults has no effect
Last modified: 2024-09-09 18:17:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 939356 
      - INSTALL_MASK in profile/make.defaults has no effect


Summary:
INSTALL_MASK in profile/make.defaults has no effect
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Enhancement/Feature Requests

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2024-09-08 23:20 UTC by Michael Jones





      Modified:
    
2024-09-09 18:17 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



ionen
ulm









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michael Jones





          2024-09-08 23:20:54 UTC
        

I have several profiles in an overlay that i sync to my machines, i wanted to add INSTALL_MASK to their make.default to slice-and-dice what files get masked based on what the profile is, but it apparently has no effect.

Reproducible: Always




Comment 1


Sam James









          2024-09-08 23:22:53 UTC
        

I think it should work.

It working even caused a bunch of bugs in the past.

commit 2db918ff33b15be6731b3cd87266b7f62efeacf3
Author: Jory Pratt <anarchy@gentoo.org>
Date:   Sun Mar 22 17:05:48 2020 -0500

    profiles/features/musl: add locale.alias to INSTALL_MASK

    Closes: https://bugs.gentoo.org/713474
    Closes: https://bugs.gentoo.org/713762
    Closes: https://bugs.gentoo.org/713826
    Closes: https://bugs.gentoo.org/713964
    Closes: https://bugs.gentoo.org/713034

    Signed-off-by: Jory Pratt <anarchy@gentoo.org>

commit acc828b30f673d695cae4bb4010b4c0402a1e104
Author: Sam James <sam@gentoo.org>
Date:   Thu Oct 14 18:15:51 2021 +0100

    profiles/features/musl: use full path in INSTALL_MASK for locale.alias

    We want to allow e.g. /usr/share/X11/locale/locale.alias to be installed.

    Closes: https://bugs.gentoo.org/799437
    Signed-off-by: Sam James <sam@gentoo.org>




Comment 2


Ionen Wolkens






          2024-09-09 00:48:38 UTC
        

To me it doesn't sound like it "should" be working, profile isn't like portage configuration files. And INSTALL_MASK is not in PMS.




Comment 3


Sam James









          2024-09-09 00:55:52 UTC
        

right, I expect it to work and am not aware of anything changing there; not really sure it should work though (at least not for standard profile types with no extensions enabled in layout)




Comment 4


Sam James









          2024-09-09 00:58:05 UTC
        

PMS says "Any other variables set in make.defaults must be passed on into the ebuild environment as-is, and are not required to be interpreted by the package manager."

But I think this is an aside anyway. As far as I'm aware, this works today?




Comment 5


Ionen Wolkens






          2024-09-09 01:01:04 UTC
        

(In reply to Sam James from comment #4)
> PMS says "Any other variables set in make.defaults must be passed on into
> the ebuild environment as-is, and are not required to be interpreted by the
> package manager."
> 
> But I think this is an aside anyway. As far as I'm aware, this works today?
Well, ebuild environment is not portage configuration. INSTALL_MASK working in ebuild would sound weird, and if it doesn't, I don't think it makes sense to fix it.

Point was just that I don't think should be relying on this working in profiles whether it does or not.




Comment 6


Ulrich Müller






          2024-09-09 06:52:21 UTC
        

Maybe it is overridden by INSTALL_MASK defined elsewhere, e.g in make.conf (because in bug 939355 you have an INSTALL_MASK there)?




Comment 7


Mike Gilbert






          2024-09-09 18:17:16 UTC
        

It definitely works for me. I suspect you are overriding INSTALL_MASK as ulm says.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

