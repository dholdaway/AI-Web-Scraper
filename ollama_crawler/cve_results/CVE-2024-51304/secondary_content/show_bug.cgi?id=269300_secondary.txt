Title: 269300 – media-libs/libsdl needs to be configured with --disable-assembly for autio output through ALSA
URL: https://bugs.gentoo.org/show_bug.cgi?id=269300

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 269300
media-libs/libsdl needs to be configured with --disable-assembly for autio output through ALSA
Last modified: 2009-10-24 22:10:48 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 269300 
      - media-libs/libsdl needs to be configured with --disable-assembly for autio output through ALSA


Summary:
media-libs/libsdl needs to be configured with --disable-assembly for autio ou...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Games








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

283297

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2009-05-10 18:44 UTC by Mike Cui





      Modified:
    
2009-10-24 22:10 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



brebs









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Disable MMX assembly in libsdl/src/audio/SDL_mixer.c

              (libsdl-1.2.13-disable-mmx-mixer.patch,438 bytes,
                text/plain)

            
2009-05-12 05:44 UTC,

            Vladimir




Details





Proposed ebuild to use libsdl-1.2.13-disable-mmx-mixer.patch 

              (libsdl-1.2.13-r2.ebuild,4.30 KB,
                text/plain)

            
2009-05-12 05:49 UTC,

            Vladimir




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Mike Cui





          2009-05-10 18:44:05 UTC
        

A libsdl regression in asm routines causes the audio output through ALSA to crakle. This issue only reproducible on x86 there is no assembly for other architectures. 

Reproducible: Always

Steps to Reproduce:
1. USE=-ao emerge zsnes (or any SDL game)
2. SDL_AUDIODRIVER=alsa zsnes (or any other game of your choice)
3. 

Actual Results:  
sound crackles.

Expected Results:  
smooth sound.

libsdl needs to be configured with --disable-assembly for ALL architectures, not just non-x86. Not sure what the performance penalty will be for other audio output modules. Perhaps make this into a USE flag?

See libsdl bug report:
http://bugzilla.libsdl.org/show_bug.cgi?id=649




Comment 1


Vladimir





          2009-05-12 05:44:38 UTC
        

Created attachment 190993 [details]
Disable MMX assembly in libsdl/src/audio/SDL_mixer.c

This patch fixes this bug for SDL audio part only, not affecting other assembly.




Comment 2


Vladimir





          2009-05-12 05:46:24 UTC
        

Proposed patch fixed sound in sauerbraten (cube 2) for me.




Comment 3


Vladimir





          2009-05-12 05:49:03 UTC
        

Created attachment 190995 [details]
Proposed ebuild to use libsdl-1.2.13-disable-mmx-mixer.patch 

Put it to overlay to media-libs/libsdl, put libsdl-1.2.13-disable-mmx-mixer.patch to the media-libs/libsdl/files subdir.




Comment 4


Mr. Bones. (RETIRED)






          2009-06-15 06:25:12 UTC
        

I can't reproduce this.  I'm not really inclined to turn off the assembly routines outright unless you can narrow down the cause of the failure or show exactly how to reproduce the issue so I can see it here.




Comment 5


Mr. Bones. (RETIRED)






          2009-06-24 21:29:01 UTC
        

marking WORKSFORME.  reopen with more information if you can.




Comment 6


Tristan Heaven (RETIRED)






          2009-08-31 08:49:38 UTC
        

*** Bug 283297 has been marked as a duplicate of this bug. ***




Comment 7


Paul Bredbury





          2009-10-24 22:10:48 UTC
        

Is fixed in SDL 1.2.14









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

