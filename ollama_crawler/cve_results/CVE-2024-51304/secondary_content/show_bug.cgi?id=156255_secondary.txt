Title: 156255 – DHCP option to prevent requesting the previously assigned IP address
URL: https://bugs.gentoo.org/show_bug.cgi?id=156255

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 156255
DHCP option to prevent requesting the previously assigned IP address
Last modified: 2006-11-27 13:27:14 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 156255 
      - DHCP option to prevent requesting the previously assigned IP address


Summary:
DHCP option to prevent requesting the previously assigned IP address
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       enhancement
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-11-25 15:28 UTC by sfp-a7x





      Modified:
    
2006-11-27 13:27 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


sfp-a7x





          2006-11-25 15:28:31 UTC
        

It would be nice to have an option in /etc/conf.d/net that prevents the chosen DHCP client from requesting the previously assigned IP address upon startup.

My /etc/conf.d/net is configured to use dhcpcd.  Unfortunately, dhcpcd does not have a command-line option for this; the file /var/lib/dhcpc/dhcpcd-eth0.cache must be deleted before starting dhcpcd.  I tried deleting the cache file using the following /etc/dhcpc/dhcpcd.exe script, but it does not appear to work (perhaps the DHCP server is remembering my MAC address?):

  #!/bin/bash
  
  if [[ "$2" == "down" ]] ; then
      CACHEFILE="$(echo "$1"|sed 's/\.info$/\.cache/')"
      if [[ -f "${CACHEFILE}" ]] ; then
          rm -rf "${CACHEFILE}"
      fi
  fi

I have not yet investigated the other DHCP clients to see if they can be configured to not request the previously assigned IP address, but for privacy reasons I figured it would be good to put in a request to support all DHCP clients in a generic way via /etc/conf.d/net.

Thanks!




Comment 1


Robin Johnson









          2006-11-25 17:35:24 UTC
        

1. The server may be configured to hand out a specific IP per MAC address
2. If you do not specifically DHCP_RELEASE your IP, and re-request it even without having the cache file, the server may give you the same one again.
2.1. The server may be configured to IGNORE DHCP_RELEASE messages.
3. The cache file only really has an effect where (your IP was released or expired from the server) AND (the IP in question is presently free) AND (the server honours specific requests).

It's possible best to delete the cache file using a preup block.

Test with the dhcpcd client manually with debugging on, and you can figure out which of the behaviors 1-3 are applicable to your DHCP server.




Comment 2


SpanKY






          2006-11-26 16:36:41 UTC
        

i dont see any change required in our net scripts ...




Comment 3


Roy Marples (RETIRED)






          2006-11-27 13:27:14 UTC
        

dhcpcd-3.0.0 doesn't use .cache files any more, which fixes this









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

