Title: 90992 – When compiling apache 2.0.53, no modules are created
URL: https://bugs.gentoo.org/show_bug.cgi?id=90992

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 90992
When compiling apache 2.0.53, no modules are created
Last modified: 2005-05-07 11:11:45 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 90992 
      - When compiling apache 2.0.53, no modules are created


Summary:
When compiling apache 2.0.53, no modules are created
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Server

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Apache Team - Bugzilla Reports








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-30 13:08 UTC by Orkie





      Modified:
    
2005-05-07 11:11 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



phattanon









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Orkie





          2005-04-30 13:08:27 UTC
        

I'm not entirely certain as to wether or not this is expected due to it being a testing package but when I did export 'ACCEPT_KEYWORDS="~x86"' then installed this version of apache ('emerge apache'), it didn't create any modules in /usr/lib/apache2/modules (which is where I would expect them to be - the program too expects them to be here by default but I may be looking in the wrong place). This is from a portage tree which I updated yesterday (29th April 2005).

Reproducible: Always
Steps to Reproduce:
1. su
2. export ACCEPT_KEYWORDS="~x86"
3. emerge apache

Actual Results:  
No modules compiled (could be due to incorrect/non-existant compile parameters).

Expected Results:  
Make modules!




Comment 1


Phattanon Duangdara





          2005-04-30 16:20:53 UTC
        

Got same problems with ~amd64 keywords.
This problems happend after just emerge -u world and following packages have
been upgraded (taken from genlo, It may cause by other packages before but
I didn't paste here).

     Sat Apr 30 06:27:39 2005 >>> sys-libs/ncurses-5.4-r6
     Sat Apr 30 06:29:05 2005 >>> app-shells/bash-3.0-r10
     Sat Apr 30 06:29:32 2005 >>> sys-apps/grep-2.5.1-r7
     Sat Apr 30 06:30:24 2005 >>> sys-devel/libtool-1.5.16
     Sat Apr 30 06:30:43 2005 >>> sys-apps/baselayout-1.11.11-r3
     Sat Apr 30 06:34:34 2005 >>> net-dns/bind-9.2.5-r4
     Sat Apr 30 06:52:14 2005 >>> net-www/apache-2.0.53

This apache package now not make modules. I just try to emerge some other versions and this version many times. Still have problems.

Remerge older apache not create modules too. I just
try to add /etc/portage/package.mask to mask >= 2.0.52-r2
but now apache 2.0.52-r1, 2.0.52 not create modules too.

After some investigate using

# ebuild apache-2.0.53.ebuild unpack
# ebuild apache-2.0.53.ebuild compile

Compiling process is correct and have modules in  /var/tmp/portage/apache-2.0.53/work/

this is output of 

# find /var/tmp/portage/apache-2.0.53/work -iname '*.so'

dekdoi ~ # find /var/tmp/portage/apache-2.0.53/work -iname '*.so'
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/aaa/.libs/mod_access.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/aaa/.libs/mod_auth.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/aaa/.libs/mod_auth_anon.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/aaa/.libs/mod_auth_dbm.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/aaa/.libs/mod_auth_digest.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/cache/.libs/mod_file_cache.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/dav/fs/.libs/mod_dav_fs.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/dav/main/.libs/mod_dav.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/echo/.libs/mod_echo.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/experimental/.libs/mod_charset_lite.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/experimental/.libs/mod_cache.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/experimental/.libs/mod_disk_cache.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/experimental/.libs/mod_mem_cache.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/experimental/.libs/mod_case_filter.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/experimental/.libs/mod_case_filter_in.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/filters/.libs/mod_ext_filter.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/filters/.libs/mod_include.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/filters/.libs/mod_deflate.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators/.libs/mod_status.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators/.libs/mod_autoindex.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators/.libs/mod_asis.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators/.libs/mod_info.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators/.libs/mod_suexec.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators/.libs/mod_cgi.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators/.libs/mod_cgid.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http/.libs/mod_mime.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/loggers/.libs/mod_logio.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/loggers/.libs/mod_log_config.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_vhost_alias.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_negotiation.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_dir.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_imap.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_actions.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_speling.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_userdir.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_alias.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/mappers/.libs/mod_rewrite.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/metadata/.libs/mod_env.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/metadata/.libs/mod_mime_magic.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/metadata/.libs/mod_cern_meta.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/metadata/.libs/mod_headers.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/metadata/.libs/mod_expires.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/metadata/.libs/mod_unique_id.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/metadata/.libs/mod_usertrack.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/metadata/.libs/mod_setenvif.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/proxy/.libs/mod_proxy.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/proxy/.libs/mod_proxy_connect.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/proxy/.libs/mod_proxy_ftp.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/proxy/.libs/mod_proxy_http.so
/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl/.libs/mod_ssl.so


But this is some output of install stage using

# ebuild apache-2.0.53.ebuild install

echo
make[3]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/dav/main'
make[2]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/dav/main'
Making install in generators
make[2]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators'
make[3]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators'
echo
echo
echo
echo
echo
echo
echo
make[3]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators'
make[2]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/generators'
Making install in dav/fs
make[2]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/dav/fs'
make[3]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/dav/fs'

No any modules or shared libs have been installed.


---
I think it not the apache problems itself. I am Trying to continue investigate it.





Comment 2


Phattanon Duangdara





          2005-04-30 16:43:09 UTC
        

These lines may tell what happened better than above.

Making install in ssl
make[2]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl'
make[3]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl'
echo
make[3]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl'
make[2]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl'
Making install in http
make[2]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http'
make[3]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http'
echo
make[3]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http'
make[2]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http'
...
... (some lines)
...
make[3]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl'
Building shared: mod_ssl.la
make[4]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl'
make[4]: Nothing to be done for `local-shared-build'.
make[4]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl'
make[3]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/ssl'
make[3]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http'
Building shared: mod_mime.la
make[4]: Entering directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http'
make[4]: Nothing to be done for `local-shared-build'.
make[4]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http'
make[3]: Leaving directory `/var/tmp/portage/apache-2.0.53/work/httpd-2.0.53/modules/http'

Nothing happened in install stage even with these 2 modules ?

I just upgrade apache before. But apache is work fine ?

     Tue Apr 26 23:36:52 2005 >>> net-www/gentoo-webroot-default-0.2
     Tue Apr 26 23:38:19 2005 >>> dev-libs/apr-0.9.6-r2
     Tue Apr 26 23:38:25 2005 >>> app-misc/mime-types-1.0-r1
     Tue Apr 26 23:39:00 2005 >>> dev-libs/apr-util-0.9.6-r1
     Tue Apr 26 23:43:03 2005 >>> net-www/apache-2.0.53
     Wed Apr 27 00:08:20 2005 >>> net-www/mod_limitipconn-0.22


Portage 2.0.51.19 (default-linux/amd64/2004.3, gcc-3.4.3, glibc-2.3.4.20041102-r1, 2.6.9-gentoo-r9 x86_64)
=================================================================
System uname: 2.6.9-gentoo-r9 x86_64 AMD Athlon(tm) 64 Processor 3200+
Gentoo Base System version 1.6.11
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb  8 2005, 02:45:01)]
dev-lang/python:     2.3.4-r1
sys-apps/sandbox:    [Not Present]
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.8.5-r3, 1.5, 1.6.3, 1.7.9-r1, 1.9.4, 1.4_p6
sys-devel/binutils:  2.15.92.0.2-r7
sys-devel/libtool:   1.5.16
virtual/os-headers:  2.6.11
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-O2 -march=k8 -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/lib/X11/xkb /usr/share/config /var/bind /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=k8 -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox strict"
GENTOO_MIRRORS="http://gentoo.scphost.com  http://gentoo.osuosl.org"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://mirrors2.mirrors.scphost.com/gentoo-portage"
USE="amd64 X acpi alsa apache2 berkdb bitmap-fonts crypt curl esd fam font-server fortran gd gdbm gif gpm gtk imap imlib ipv6 java jp2 jpeg libwww lzw lzw-tiff mp3 msn multilib mysql ncurses nls nptl odbc opengl oss pam pdflib perl perlsuid png python readline samba sasl slang snmp socks5 ssl tcltk tcpd threads tiff truetype truetype-fonts type1-fonts usb userlocales vhosts xml xml2 xpm xrandr xv zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS






Comment 3


Gabriel Jackson (Jax)





          2005-05-01 10:17:49 UTC
        

Hi 
I was messing with this the whole friggin day .. mod_php wouldn't compile either.
I finally found the error:
in /usr/lib/apache2/build/instdso.sh
change all the $CMD to $CMD_EXEC, or anything else, just not $CMD.
$CMD seems to be constantly overriden (in shell do: echo $CMD it will output 'echo')
hence everything is messed up.
Why this happens is because of bash-3.10-r10 somehow $CMD got introduced there, which messes up a LOT of things.
i.e emerge bash-3.10-r11 to fix these issues, or do it like me.. unpack the httpd.tar.bz2 in /usr/portage/distfiles, change the script in the build dir, repack it, re-digest (ebuild /usr/portage/net-www/apache/apache-2.0.53.ebuild digest) and emerge apache again.. then it will all work

Hope that helps,

Jax




Comment 4


Elfyn McBratney (beu) (RETIRED)






          2005-05-07 11:11:45 UTC
        

This is a bash bug (in 3.0-r10) and emerging =app-shells/bash-3.0-r11 should fix this.  Please re-open you still experience this with -r11.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

