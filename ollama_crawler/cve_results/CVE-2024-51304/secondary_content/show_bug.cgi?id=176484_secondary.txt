Title: 176484 – [2.6.20 regression] system freezes before halt
URL: https://bugs.gentoo.org/show_bug.cgi?id=176484

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 176484
[2.6.20 regression] system freezes before halt
Last modified: 2007-06-16 04:41:32 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 176484 
      - [2.6.20 regression] system freezes before halt


Summary:
[2.6.20 regression] system freezes before halt
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Kernel Bug Wranglers and Kernel Maintainers








URL:







Whiteboard:
linux-2.6.20-regression  
  


Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-04-29 18:25 UTC by thierry volpiatto





      Modified:
    
2007-06-16 04:41 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



mbres
rane









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




dmesg with kernel 2.6.20-r7

              (log_boot,18.07 KB,
                text/plain)

            
2007-04-29 19:06 UTC,

            thierry volpiatto




Details





the /usr/src/linux/.config of the 2.6.20-r8 compiled manually

              (log_kernel-2.6.20-r8_config,38.89 KB,
                text/plain)

            
2007-06-09 17:15 UTC,

            thierry volpiatto




Details





the /usr/src/linux/.config of the 2.6.20-r8 compiled with genkernel(broken config)

              (config_kernel-2.6.20-r8_genkernel_bad,49.31 KB,
                text/plain)

            
2007-06-10 17:00 UTC,

            thierry volpiatto




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


thierry volpiatto





          2007-04-29 18:25:41 UTC
        

Every things work fine ,network,printer,alsa...,no problems for boot,
but when i want to shutdown the process fail at the end , just before stopping
whithout any message of failure
so i came back on my kernel 2.6.19-r5 and no problems.
I have another machine but on x86 and it did the same but with a message:
some things like impossible to stop mouse ps2 on isa ...do i have to send a bug for this machine too?

Reproducible: Always




Comment 1


Daniel Drake (RETIRED)






          2007-04-29 18:43:48 UTC
        

Yes, please file a different bug for your other system.

Is this issue reproducible on the latest kernel, currently 2.6.21?

Please attach dmesg output after boot.




Comment 2


thierry volpiatto





          2007-04-29 19:06:52 UTC
        

Created attachment 117662 [details]
dmesg with kernel 2.6.20-r7




Comment 3


thierry volpiatto





          2007-05-11 07:41:40 UTC
        

I have installed kernel 2.6.20-r8 and the problem is the same:
at the end of the halting process:
system halted
system halted #seem to try again

and then nothing it stay like that and don't stop




Comment 4


Daniel Drake (RETIRED)






          2007-05-11 12:18:14 UTC
        

OK. How about 2.6.21?
Also, does the problem go away if you boot with kernel parameter "acpi=off" ?




Comment 5


thierry volpiatto





          2007-05-11 13:25:00 UTC
        

Ok, i write in my kernel line in grub.conf:
acpi=off ==> it's change nothing , anyway i have compiled kernel with power support disabled.
with kernel 2.6.21 ==>the same unable to stop with same message at the end:
system halted #twice
on all these kernel(2.6.20-r7, 2.6.20-r8, 2.6.21) every things except that work perfectly
So the last version working fine and able to stop! is 2.6.19-r5




Comment 6


thierry volpiatto





          2007-06-06 10:07:08 UTC
        

Hey,
finally, I have recompiled the kernel manually and I am able to shutdown.
every things work fine too.
with genkernel its still impossible to halt the system
 




Comment 7


Daniel Drake (RETIRED)






          2007-06-09 15:16:50 UTC
        

Please attach the broken genkernel config and the working manual config




Comment 8


thierry volpiatto





          2007-06-09 17:15:57 UTC
        

Created attachment 121601 [details]
the /usr/src/linux/.config of the 2.6.20-r8 compiled manually




Comment 9


Maarten Bressers (RETIRED)






          2007-06-09 22:07:55 UTC
        

All right, that's the working .config for 2.6.20-r8. Please also post the non-working genkernel one for that same kernel version, so we can compare the two.





Comment 10


thierry volpiatto





          2007-06-10 07:10:22 UTC
        

So you have lost the precedents .config of the broken kernels ; I try to install again 2.6.20-r8 with genkernel without breaking this config (manual one) and i send you the .config of the broken genkernel. if you have a tip to give me to do that tell me




Comment 11


thierry volpiatto





          2007-06-10 17:00:34 UTC
        

Created attachment 121675 [details]
the /usr/src/linux/.config of the 2.6.20-r8 compiled with genkernel(broken config)




Comment 12


thierry volpiatto





          2007-06-10 17:01:17 UTC
        

So i have uninstall my good kernel (manual one)
install it again with genkernel , reproduce the bug and get the .config
reinstall it again manually with my oldconfig
ouf!! so here is the bad .config ,you can ediff it with the over




Comment 13


Daniel Drake (RETIRED)






          2007-06-16 00:36:42 UTC
        

Thanks for all the info. As expected, there are a large number of differences in the 2 configs and there aren't any changes that jump out at me which might be responsible for breaking/fixing shutdown.

This is probably a valid kernel bug, in that there is probably some option that genkernel is enabling which is breaking shutdown for you. However, tracking down this option would be a lengthy process and I'm not sure how to suggest you would even tackle this.

If you do ever manage to reproduce this on a manual kernel, reopen the bug and we can try to dig deeper. Other than the other bug you filed, we don't have any other reports of this problem.




Comment 14


thierry volpiatto





          2007-06-16 04:41:32 UTC
        

for me it's resolved with the manual config of kernel it's was just to help for genkernel users Thank you for all.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

