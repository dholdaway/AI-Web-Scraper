Title: 833853 – media-libs/hamlib-4.4 blocks cat transmit command from other hamradio packages
URL: https://bugs.gentoo.org/show_bug.cgi?id=833853

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 833853
media-libs/hamlib-4.4 blocks cat transmit command from other hamradio packages
Last modified: 2022-06-25 16:41:22 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 833853 
      - media-libs/hamlib-4.4 blocks cat transmit command from other hamradio packages


Summary:
media-libs/hamlib-4.4 blocks cat transmit command from other hamradio packages
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Thomas Beierlein








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2022-02-21 15:15 UTC by Teun Blok





      Modified:
    
2022-06-25 16:41 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Teun Blok





          2022-02-21 15:15:38 UTC
        

media-libs/hamlibs-4.4 blocks transmit command from media-radio/wstjx-2.5.4, media-radio/flrig-1.44 and media-radio/fldigi -4.1.20. 


Reproducible: Always

Actual Results:  
ic-7300 won't transmit


emerging media-libs/hamlib-4.3.1 instead of version 4.4 solves this.




Comment 1


Teun Blok





          2022-02-21 15:17:04 UTC
        

5-4430 /home/teun # emerge --info
Portage 3.0.30 (python 3.9.9-final-0, default/linux/amd64/17.1/systemd, gcc-11.2.0, glibc-2.33-r7, 5.10.76-gentoo-r1 x86_64)
=================================================================
System uname: Linux-5.10.76-gentoo-r1-x86_64-Intel-R-_Core-TM-_i5-4430_CPU_@_3.00GHz-with-glibc2.33
KiB Mem:     8077492 total,   3914076 free
KiB Swap:          0 total,         0 free
Timestamp of repository gentoo: Mon, 21 Feb 2022 15:00:01 +0000
Head commit of repository gentoo: 6f15c1921422a3957f210f6896795de5647fbbd8
sh bash 5.1_p16
ld GNU ld (Gentoo 2.37_p1 p2) 2.37
app-misc/pax-utils:        1.3.3::gentoo
app-shells/bash:           5.1_p16::gentoo
dev-lang/perl:             5.34.0-r6::gentoo
dev-lang/python:           2.7.18_p13::gentoo, 3.9.9-r1::gentoo, 3.10.0_p1-r1::gentoo
dev-lang/rust:             1.58.1::gentoo
dev-util/cmake:            3.22.2::gentoo
dev-util/meson:            0.60.3::gentoo
sys-apps/baselayout:       2.7-r3::gentoo
sys-apps/sandbox:          2.25::gentoo
sys-apps/systemd:          249.9::gentoo
sys-devel/autoconf:        2.13-r1::gentoo, 2.71-r1::gentoo
sys-devel/automake:        1.16.4::gentoo
sys-devel/binutils:        2.37_p1-r2::gentoo
sys-devel/binutils-config: 5.4::gentoo
sys-devel/clang:           13.0.0::gentoo
sys-devel/gcc:             11.2.0::gentoo
sys-devel/gcc-config:      2.5-r1::gentoo
sys-devel/libtool:         2.4.6-r6::gentoo
sys-devel/lld:             13.0.0::gentoo
sys-devel/llvm:            13.0.0::gentoo
sys-devel/make:            4.3::gentoo
sys-kernel/linux-headers:  5.15-r3::gentoo (virtual/os-headers)
sys-libs/glibc:            2.33-r7::gentoo
Repositories:

gentoo
    location: /var/db/repos/gentoo
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts: 
    sync-rsync-verify-jobs: 1
    sync-rsync-verify-metamanifest: yes
    sync-rsync-verify-max-age: 24

x-portage
    location: /usr/local/portage
    masters: gentoo
    priority: 0

ROKO__
    location: /var/lib/layman/ROKO__
    masters: gentoo
    priority: 50

ixit
    location: /var/lib/layman/ixit
    masters: gentoo
    priority: 50

jorgicio
    location: /var/lib/layman/jorgicio
    masters: gentoo
    priority: 50

localrepo
    location: /usr/local/portage
    masters: gentoo
    priority: 50

qsx
    location: /var/lib/layman/qsx
    masters: gentoo
    priority: 50

rich0
    location: /var/lib/layman/rich0
    masters: gentoo
    priority: 50

spikyatlinux
    location: /var/lib/layman/spikyatlinux
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="@FREE"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=native -O2 -pipe"
DISTDIR="/var/cache/distfiles"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-march=native -O2 -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs buildpkg-live config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-march=native -O2 -pipe"
GENTOO_MIRRORS="ftp://ftp.snt.utwente.nl/pub/os/linux/gentoorsync://ftp.snt.utwente.nl/gentoo http://ftp.snt.utwente.nl/pub/os/linux/gentoo"
LANG="en_US.utf-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j3"
PKGDIR="/var/cache/binpkgs"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
SHELL="/bin/bash"
USE="X acl alsa amd64 bzip2 cdr cli crypt cups dbus dri dvd fortran gdbm iconv ipv6 jpeg libglvnd libtirpc multilib ncurses nls nptl opengl openmp pam pcre png pulseaudio readline seccomp split-usr ssl systemd udev unicode usb xattr zlib" ABI_X86="64" ADA_TARGET="gnat_2020" ALSA_CARDS="virtuoso hda-intel" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext sse sse2" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" GRUB_PLATFORMS="multiboot pc" INPUT_DEVICES="evdev" KERNEL="linux" L10N="en nl de" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-4 php8-0" POSTGRES_TARGETS="postgres12 postgres13" PYTHON_SINGLE_TARGET="python3_9" PYTHON_TARGETS="python3_9" RUBY_TARGETS="ruby26 ruby27" SANE_BACKENDS="hp" USERLAND="GNU" VIDEO_CARDS="nouveau" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq proto steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  ADDR2LINE, AR, ARFLAGS, AS, ASFLAGS, CC, CCLD, CONFIG_SHELL, CPP, CPPFLAGS, CTARGET, CXX, CXXFILT, ELFEDIT, EMERGE_DEFAULT_OPTS, EXTRA_ECONF, F77FLAGS, FC, GCOV, GPROF, INSTALL_MASK, LC_ALL, LD, LEX, LFLAGS, LIBTOOL, LINGUAS, MAKE, MAKEFLAGS, NM, OBJCOPY, OBJDUMP, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, RANLIB, READELF, RUSTFLAGS, SIZE, STRINGS, STRIP, YACC, YFLAGS




Comment 2


Jonas Stein






          2022-02-21 18:10:25 UTC
        

which overlay?




Comment 3


Sam James









          2022-02-21 20:09:08 UTC
        

(In reply to Jonas Stein from comment #2)
> which overlay?

Are you sure an overlay is involved? They probably meant hamlib.




Comment 4


Thomas Beierlein






          2022-02-24 18:26:48 UTC
        

Hi Teun,

can you please give more some more information about your settings. Which of your programs send the commands via hamlib, which sends them via rigctld?

Please elaborate what you mean by 'blocks transmit command'.

Tested it just now here with TS-590S without problems.




Comment 5


Teun Blok





          2022-03-02 11:20:04 UTC
        

Hello Tom,
Flrig and Fldigi is no problem (anymore) with Hamlib-4.4. I don't know why it is now working ok.
But Wsjtx-2.5.4 and hamlib-4.4 is still given an error when I wan't to use transmit. This error pops up in a window.

Rig failure

Hamlib error: Communication timed out
icom_rig_open: rig error getting frequency retry=0, err=Communication timed out
frame.c(439):icom_transaction return(-5)
icom.c(752):icom_get_usb_echo_off return(-5)
icom.c(752):icom_get_usb_echo_off return(-5)icom.c(995):icom_rig_open return(-5)
rig.c(1031):rig_open return(-5) while opening connection to rig

I have of course tried all the ttyUSB ports but it (transmit in FT8) does not work with hamlib-4.4

When I downgrade to hamlib-4.3.1, wsjt-x works ok. 
So to my opinion something in hamlib-4.4 is wrong.

Am I doing something wrong?

TIA

Teun




Comment 6


Thomas Beierlein






          2022-03-04 17:04:55 UTC
        

Hi Teun,

(In reply to Teun Blok from comment #5)
> Hello Tom,
> Flrig and Fldigi is no problem (anymore) with Hamlib-4.4. I don't know why
> it is now working ok.

glad to hear.

> But Wsjtx-2.5.4 and hamlib-4.4 is still given an error when I wan't to use
> transmit. This error pops up in a window.
> 
> Rig failure
> 
> Hamlib error: Communication timed out
.... 
> When I downgrade to hamlib-4.3.1, wsjt-x works ok. 
> So to my opinion something in hamlib-4.4 is wrong.
> 

Hamlib-4.4 works here without problems with all programs. From the hamlib mailing list there was quite some work for IC-7300 related problems in last time. so there may be a bug for that rig in 4.4 version.

I would suggest trying to compile hamlib from the actual github sources and see if the problem is solved. If that worked we can try to find to back port the relevant patches.

As I have no chance to test it on IC7300 I can do no direct tests myself.


I will be away the next week, so further replies may take some time.




Comment 7


Thomas Beierlein






          2022-05-05 18:02:27 UTC
        

No news. Closing.
Please reopen if new information are available.




Comment 8


Teun Blok





          2022-05-07 12:59:47 UTC
        

I reopen...

I have tried all versions of Hamlib.

As suggested I cloned from github:

First: # emerge --unmerge hamlib

Second: git clone https://github.com/Hamlib/Hamlib.git (hamlib 4.5-git Mon Apr 25 20.27B 2022)

These are the steps i did:
$ ./bootstrap
$ ./configure
$ make
$ sudo make install

Everything ok, also with wsjtx.
I manually deleted all the files of hamlib in /...

Third: emerge hamlib(-4.4)
problem: IC-7300 does not tx.
emerge --unmerge hamlib(-4.4)

Fourth: masking >=media-libs/hamlib-4.4 in /etc/portage/package.mask
emerge hamlib(-4.3.1)
Everything ok, also with wsjtx

It was not possible to continue hamlib-4.5 from git because wsjtx pulled the version hamlib-4.3.1 or 4.4 every time. If I would allow that it's gonna be a mess.

I am willing to test for you the github version with my ic-7300 as long as you tell me what to do.

TIA
Teun PA1TB




Comment 9


Thomas Beierlein






          2022-05-11 05:24:47 UTC
        

Well. Let us see if can make sense of it:

(In reply to Teun Blok from comment #8)
> First: # emerge --unmerge hamlib
>
> Second: git clone https://github.com/Hamlib/Hamlib.git (hamlib 4.5-git Mon
> Apr 25 20.27B 2022)
> 
> These are the steps i did:
>..... 
> Everything ok, also with wsjtx.
> I manually deleted all the files of hamlib in /...
> 
> Third: emerge hamlib(-4.4)
> problem: IC-7300 does not tx.
> 
> Fourth: masking >=media-libs/hamlib-4.4 in /etc/portage/package.mask

That means you tried:

hamlib-4.3.1 and hamlib-4.4 from ebuild and hamlib-4.5~git (actual head of development) from git.

Of that only hamlib-4.4 make problems.


First thing to try is to download hamlib-4.4 source code and compile it yourself as for the git version. If it does not solve the problem. there is a bug in hamlib-4.4 sources which should be reported on the hamlib mailing list.




Comment 10


Teun Blok





          2022-06-24 18:03:53 UTC
        

Murphy's law, my sdd crashed and I had to buy a new one and did a fresh install of Gentoo Linux. This took a while....

After this fresh install, hamlib-4.4 works and I have no problems anymore.
I don't know what is different now but hey it works.

Thanks for the patience.




Comment 11


Thomas Beierlein






          2022-06-25 16:41:22 UTC
        

(In reply to Teun Blok from comment #10)
> Murphy's law, my sdd crashed and I had to buy a new one and did a fresh
> install of Gentoo Linux. This took a while....
> 
> After this fresh install, hamlib-4.4 works and I have no problems anymore.
> I don't know what is different now but hey it works.
> 
> Thanks for the patience.

Glad to hear. Enjoy it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

