Title: 760324 – =media-libs/mesa-20.2.4 fails to build with GNU linker
URL: https://bugs.gentoo.org/show_bug.cgi?id=760324

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 760324
=media-libs/mesa-20.2.4 fails to build with GNU linker
Last modified: 2021-09-15 06:43:01 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 760324 
      - =media-libs/mesa-20.2.4 fails to build with GNU linker


Summary:
=media-libs/mesa-20.2.4 fails to build with GNU linker
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-12-16 16:00 UTC by alfr0451





      Modified:
    
2021-09-15 06:43 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



jstein
sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build log

              (mesa-20.2.4:20201216-152435.log.xz,48.57 KB,
                application/x-xz)

            
2020-12-16 16:00 UTC,

            alfr0451




Details





emerge --info

              (emerge-info.txt,11.30 KB,
                text/plain)

            
2020-12-16 16:02 UTC,

            alfr0451




Details





log of successful build w/ -fuse-ld=lld in LDFLAGS

              (mesa-20.2.4:20201216-154249.log.xz,65.55 KB,
                application/x-xz)

            
2020-12-16 16:20 UTC,

            alfr0451




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


alfr0451





          2020-12-16 16:00:19 UTC
        

Created attachment 678499 [details]
build log

Building =media-libs/mesa-20.2.4 using GNU ld fails with:

/usr/lib/gcc/x86_64-pc-linux-gnu/9.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: /usr/lib/llvm/11/lib/libLLVM-11.so: __morestack: invalid needed version 2
/usr/lib/gcc/x86_64-pc-linux-gnu/9.3.0/../../../../x86_64-pc-linux-gnu/bin/ld: /usr/lib/llvm/11/lib/libLLVM-11.so: error adding symbols: bad value
collect2: error: ld returned 1 exit status

The build succeeds when using lld.


emerge -qpv '=media-libs/mesa-20.2.4::gentoo' results:

[ebuild   R   ] media-libs/mesa-20.2.4  USE="X classic d3d9 dri3 egl gallium gbm gles1 gles2 llvm lm-sensors unwind vaapi vdpau vulkan vulkan-overlay wayland xa xvmc zstd -debug -opencl -osmesa* (-selinux) -test -valgrind -zink" ABI_X86="32 (64) (-x32)" VIDEO_CARDS="i965 intel iris (-freedreno) -i915 (-lima) -nouveau (-panfrost) -r100 -r200 -r300 -r600 -radeon -radeonsi (-v3d) (-vc4) -virgl (-vivante) -vmware"




Comment 1


alfr0451





          2020-12-16 16:02:07 UTC
        

Created attachment 678505 [details]
emerge --info




Comment 2


alfr0451





          2020-12-16 16:20:15 UTC
        

Created attachment 678508 [details]
log of successful build w/ -fuse-ld=lld in LDFLAGS




Comment 3


alfr0451





          2021-09-15 01:59:38 UTC
        

With =media-libs/mesa-21.1.7 the above mentioned build failure does not arise any more.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

