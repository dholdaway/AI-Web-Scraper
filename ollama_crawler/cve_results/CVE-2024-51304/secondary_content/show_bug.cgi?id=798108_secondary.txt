Title: 798108 – x11-base/xwayland-21.1.1-r1 fails tests
URL: https://bugs.gentoo.org/show_bug.cgi?id=798108

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 798108
x11-base/xwayland-21.1.1-r1 fails tests
Last modified: 2021-07-05 20:16:37 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 798108 
      - x11-base/xwayland-21.1.1-r1 fails tests


Summary:
x11-base/xwayland-21.1.1-r1 fails tests
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

800272

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2021-06-23 20:35 UTC by Agostino Sarubbo





      Modified:
    
2021-07-05 20:16 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



floppym
slashbeast









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,668.04 KB,
                text/plain)

            
2021-06-23 20:35 UTC,

            Agostino Sarubbo




Details





1-testlog.txt

              (1-testlog.txt,18.25 KB,
                text/plain)

            
2021-06-23 20:35 UTC,

            Agostino Sarubbo




Details





ebuild for standalone xwayland

              (xwayland-21.1.1.ebuild,2.27 KB,
                text/plain)

            
2021-06-24 19:00 UTC,

            Don O




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Agostino Sarubbo






          2021-06-23 20:35:30 UTC
        

https://blogs.gentoo.org/ago/2020/07/04/gentoo-tinderbox/

Issue: x11-base/xwayland-21.1.1-r1 fails tests.
Discovered on: amd64 (internal ref: ci)

NOTE:
This machine uses GCC-11: https://gcc.gnu.org/gcc-11/porting_to.html
If you think this is a GCC-11 related issue, please block bug 732706.




Comment 1


Agostino Sarubbo






          2021-06-23 20:35:33 UTC
        

Created attachment 718395 [details]
build.log

build log and emerge --info




Comment 2


Agostino Sarubbo






          2021-06-23 20:35:34 UTC
        

Created attachment 718398 [details]
1-testlog.txt

1-testlog.txt




Comment 3


Don O





          2021-06-23 22:37:50 UTC
        

I didn't have a problem with the tests both gcc 9.3 and 11.1

I don't think it's a compile problem though

This is from the testlog.txt all 3 that failed are similar.
--------
stderr:
_XSERVTransmkdir: Owner of /tmp/.X11-unix should be set to root
XKB: Failed to compile keymap
Keyboard initialization failed. This could be a missing or incorrect setup of xkeyboard-config.
(EE) 
Fatal server error:
(EE) Failed to activate virtual core keyboard: 2(EE) 
Server failed to start before setting up displayfd
--------




Comment 4


Don O





          2021-06-24 00:41:08 UTC
        

I think you're missing the Xtrans as a dependency.

This is part of my ebuild

IUSE="bsd eglstream rpc selinux unwind"

CDEPEND="
    bsd? ( dev-libs/libbsd )
    media-libs/libglvnd[X]
    dev-libs/openssl:0=
    >=x11-apps/iceauth-1.0.2
    >=x11-apps/rgb-1.0.3
    >=x11-apps/xauth-1.0.3
    x11-apps/xkbcomp
    >=x11-libs/libdrm-2.4.89
    >=x11-libs/libpciaccess-0.12.901
    >=x11-libs/libXau-1.0.4
    >=x11-libs/libXdmcp-1.0.2
    >=x11-libs/libXfont2-2.0.1
    >=x11-libs/libxkbfile-1.0.4
    >=x11-libs/libxshmfence-1.1
    >=x11-libs/pixman-0.27.2
    >=x11-misc/xbitmaps-1.0.1
    >=dev-libs/wayland-1.3.0
    >=dev-libs/wayland-protocols-1.18
    eglstream? (
        gui-libs/egl-wayland
        gui-libs/eglexternalplatform
    )
    >=media-libs/libepoxy-1.5.4[X,egl(+)]
    rpc? ( net-libs/libtirpc )
    selinux? (
        >=sys-libs/libselinux-2.9.86
        sys-process/audit
    )
    unwind? ( sys-libs/libunwind )
    x11-apps/xkbcomp
    >=x11-libs/libXfont2-2.0.0
    >=x11-libs/libdrm-2.4.89
    >=x11-libs/libxshmfence-1.1
    >=x11-libs/pixman-0.27.2
    >=x11-libs/xtrans-1.3.5
"




Comment 5


Don O





          2021-06-24 19:00:07 UTC
        

Created attachment 718887 [details]
ebuild for standalone xwayland

This is a merging of what I had written for my xwayland ebuild and the one by slashbeast. I believe that I have all the deps needed, but before blindly using it, notice the bottom of the ebuild (mods that affect where Xwayland goes). 
I also modified the xorg-server from <= some version to just blocking if xorg-server[wayland] is seen. 

I'd be happy to discuss it with slashbeast, as I have a couple of questions, dealing with stuff in the ebuild. 

Anyway, it should work with the caveat that right now this ebuild uses /usr/bin directly.




Comment 6


Piotr Karbowski (RETIRED)






          2021-07-03 20:01:46 UTC
        

I cannot reproduce any of those failures on either of my systems.

Ok:                 3
Expected Fail:      0
Fail:               0
Unexpected Pass:    0
Skipped:            2
Timeout:            0




Comment 7


Mike Gilbert






          2021-07-04 15:22:46 UTC
        

*** Bug 800272 has been marked as a duplicate of this bug. ***




Comment 8


Matt Turner






          2021-07-04 19:24:33 UTC
        

(In reply to Don O from comment #4)
> I think you're missing the Xtrans as a dependency.

xtrans is a source-code-only library (i.e., it only installs source code), so if it's missing as a dependency then the way this would show is a build failure, not a test failure.




Comment 9


Piotr Karbowski (RETIRED)






          2021-07-05 20:16:37 UTC
        

Was anyone actually able to reproduce it outside of ago's chroot?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

