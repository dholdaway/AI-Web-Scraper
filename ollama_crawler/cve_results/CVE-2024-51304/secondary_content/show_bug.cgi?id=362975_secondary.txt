Title: 362975 – media-sound/amarok with media-libs/phonon-vlc-0.4.0 backend fails to play some mp3 files
URL: https://bugs.gentoo.org/show_bug.cgi?id=362975

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 362975
media-sound/amarok with media-libs/phonon-vlc-0.4.0 backend fails to play some mp3 files
Last modified: 2011-11-12 14:00:21 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 362975 
      - media-sound/amarok with media-libs/phonon-vlc-0.4.0 backend fails to play some mp3 files


Summary:
media-sound/amarok with media-libs/phonon-vlc-0.4.0 backend fails to play som...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       minor
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-04-10 21:30 UTC by MarisN





      Modified:
    
2011-11-12 14:00 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




output of cvlc -vvv on one of unplayable files

              (vlc_mp3_problem,28.24 KB,
                text/plain)

            
2011-04-10 21:35 UTC,

            MarisN




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


MarisN





          2011-04-10 21:30:14 UTC
        

Recenlty phonon default backend seems to be changed to VLC from xine. After this change some MP3 files are not player anymore by any phonon using application (amarok) without any error message. Xine backend and standalone xine, mplayer, mpg123 play that file just fine.

Will attach VLC -vvv output on one of unplayable files.

Reproducible: Always




emerge --info
Portage 2.1.9.45 (default/linux/amd64/10.0/desktop, gcc-4.5.2, glibc-2.13-r2, 2.6.38-gentoo x86_64)
=================================================================
System uname: Linux-2.6.38-gentoo-x86_64-Intel-R-_Core-TM-2_Duo_CPU_P9500_@_2.53GHz-with-gentoo-2.0.2
Timestamp of tree: Sun, 10 Apr 2011 10:45:01 +0000
app-shells/bash:     4.2_p8
dev-java/java-config: 2.1.11-r3
dev-lang/python:     2.6.6-r2, 2.7.1-r1, 3.1.3-r1
dev-util/cmake:      2.8.4
sys-apps/baselayout: 2.0.2
sys-apps/openrc:     0.8.0
sys-apps/sandbox:    2.5
sys-devel/autoconf:  2.13, 2.68
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.9.6-r3, 1.10.3, 1.11.1-r1
sys-devel/binutils:  2.21
sys-devel/gcc:       4.4.5, 4.5.2
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.4-r1
sys-devel/make:      3.82
virtual/os-headers:  2.6.38 (sys-kernel/linux-headers)
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA dlj-1.1 skype-eula AdobeFlash-10.1 googleearth PUEL"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe -ggdb"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/openvpn/easy-rsa /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/eselect/postgresql /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=native -O2 -pipe -ggdb"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs collision-protect distlocks fixlafiles fixpackages news protect-owned sandbox sfperms splitdebug strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://gentoo.tups.lv/source"
LANG="lv_LV"
LC_ALL="lv_LV.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="lv"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/kde-sunset /home/maris/soft/portage"
SYNC="rsync://gentoo.tups.lv/gentoo-portage"
USE="X a52 aac acl acpi alsa amd64 berkdb bluetooth branding bzip2 cairo cdr cli clucene consolekit cracklib crypt cups cxx dbus dell dhcpcd dri dts dvd dvdr eap-tls emboss encode exif fam firefox flac fortran gallium gdal gdbm gdu geos gif glib gpm gpu iconv idn inotify ipv6 jpeg json kde kvm laptop lcms ldap libnotify lzma mad mikmod mmx mmxext mng modules mp3 mp4 mpeg mudflap multilib ncurses nls nptl nptlonly nsplugin offensive ogg opengl openmp pam pango pcre pdf perl png policykit ppds pppd proj python qemu qt3support qt4 readline sasl sdl semantic-desktop session slp spell sqlite sse sse2 sse3 ssl ssse3 startup-notification svg sysfs tcpd theora threads tiff truetype udev unicode usb utf-8 vdpau vorbis x264 xcb xcomposite xinerama xml xmp xorg xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="alias authz_host autoindex dir env headers mime rewrite vhost_alias log_config auth_basic authn_file authz_user cgi" APACHE2_MPMS="prefork" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="synaptics mouse keyboard evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="lv" PHP_TARGETS="php5-3" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="vesa nvidia nouveau" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


MarisN





          2011-04-10 21:35:09 UTC
        

Created attachment 269401 [details]
output of cvlc -vvv on one of unplayable files

mplayer provided info during same file playback:
Opening audio decoder: [mp3lib] MPEG layer-2, layer-3
AUDIO: 44100 Hz, 2 ch, s16le, 192.0 kbit/13.61% (ratio: 24000->176400)
Selected audio codec: [mp3] afm: mp3lib (mp3lib MPEG layer-2, layer-3)




Comment 2


Tomáš Chvátal (RETIRED)






          2011-04-11 11:33:33 UTC
        

How about other backends? xine/gstreamer, do they play the file?




Comment 3


MarisN





          2011-04-11 17:02:52 UTC
        

(In reply to comment #2)
> How about other backends? xine/gstreamer, do they play the file?
Sorry for my bad language skills.
I don't have phonon-gstreamer backend only xine one. After changing phonon to xine backend, Amarok plays all files just fine.
So - there are two problems - VLC backend fails to play some MP3's and second - there are no meaningfull error messages for user - Amarok just skips files as unplayable. At first I was surprised that Amarok suddenly started to skip some files from my collection as some time a go it was playing them just fine. Not nicest way how to find out about a new phonon backend :(




Comment 4


Tomáš Chvátal (RETIRED)






          2011-04-12 14:41:59 UTC
        

Welcome to the brave new world full of features.

So our culprit indeed is the vlc package. Could you check if it has mp3 useflag enabled?

PS: your English is quite good :)




Comment 5


MarisN





          2011-04-12 15:17:45 UTC
        

(In reply to comment #4)
> So our culprit indeed is the vlc package. Could you check if it has mp3 useflag
> enabled?
> 
> PS: your English is quite good :)

Apparently not good enough, as I wrote - "some MP3 files ... fail". 

[ebuild   R   ] media-video/vlc-1.1.8  USE="X a52 aac alsa dbus dts dvd ffmpeg flac gcrypt kde libnotify mmx mp3 mpeg ncurses nsplugin ogg opengl png qt4 sdl sqlite sse svg theora truetype udev v4l2 vorbis x264 xcb xml xv -aalib ...




Comment 6


Tomáš Chvátal (RETIRED)






          2011-04-12 15:24:11 UTC
        

(In reply to comment #5)
> (In reply to comment #4)
> > So our culprit indeed is the vlc package. Could you check if it has mp3 useflag
> > enabled?
> > 
> > PS: your English is quite good :)
> 
> Apparently not good enough, as I wrote - "some MP3 files ... fail". 

mp3 useflag on vlc just means use libmad instead of ffmpeg implementation for playing mp3 files. So my question was more to find out if you use libmad of ffmpeg :) (yes vlc can always play mp3 files technically)
> 
> [ebuild   R   ] media-video/vlc-1.1.8  USE="X a52 aac alsa dbus dts dvd ffmpeg
> flac gcrypt kde libnotify mmx mp3 mpeg ncurses nsplugin ogg opengl png qt4 sdl
> sqlite sse svg theora truetype udev v4l2 vorbis x264 xcb xml xv -aalib ...

Try to disable the mp3 useflag and see if the problem is still around :)




Comment 7


Jorge Manuel B. S. Vicetto (RETIRED)






          2011-04-12 16:17:34 UTC
        

(In reply to comment #6)
> Try to disable the mp3 useflag and see if the problem is still around :)

In any case, this is an upstream bug so all we can do is track this through an upstream bug.




Comment 8


MarisN





          2011-04-12 17:24:35 UTC
        

(In reply to comment #6)
> Try to disable the mp3 useflag and see if the problem is still around :)

After emerge vlc with -mp3, it still fails.

Still I managed to track down cause of error - those MP3 have different tags.

EasyTag, Amarok, mplayer, xine, mpg123, id3info all display one tag content and are able to play file (ofcourse EasyTag and id3info doesn't play anything at all ;)

mplayer doesn't display album_artist tag at all. mplayer plays just fine with -ac mad, ffmp3, ffmp3float, ffmp2

Amarok displays album_artist to be "Röyksopp"

ffplay is able to play file but it displays different content for album_artist tag - "刀礀欀猀漀瀀"

After stripping all ID3 tags from file with "id3convert -s", VLC starts to play it. Bad thing - stripping "Album artist" tag contents in Amarok do not affect contents displayed by ffplay and VLC still doesn't play such file.

Conclusion: bug lies somewhere in VLC ID3 tag processing part.




Comment 9


Jorge Manuel B. S. Vicetto (RETIRED)






          2011-05-08 14:36:43 UTC
        

Can you please test phonon-vlc-0.4.0 that I just added to the tree?
Let us know if the issue persists or if it's fixed.




Comment 10


MarisN





          2011-06-26 18:46:29 UTC
        

(In reply to comment #9)
> Can you please test phonon-vlc-0.4.0 that I just added to the tree?
> Let us know if the issue persists or if it's fixed.

Still an issue with:
media-libs/phonon-vlc-0.4.0:0
media-video/vlc-1.1.10:0




Comment 11


Andreas K. Hüttel







          2011-11-08 19:53:00 UTC
        

It's probably best if you file an upstream bug on bugs.kde.org and link to it here. That said, upstream is not always that responsive...




Comment 12


MarisN





          2011-11-12 14:00:21 UTC
        

Tested with media-video/vlc-1.1.12 and could not reproduce anymore. Either I have fixed mp3's tags or it has been fixed upstream.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

