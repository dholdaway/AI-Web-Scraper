Title: 286161 – kde-base/kpdf-3.5.10-r1 eats up whole memory
URL: https://bugs.gentoo.org/show_bug.cgi?id=286161

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 286161
kde-base/kpdf-3.5.10-r1 eats up whole memory
Last modified: 2009-10-22 17:00:28 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 286161 
      - kde-base/kpdf-3.5.10-r1 eats up whole memory


Summary:
kde-base/kpdf-3.5.10-r1 eats up whole memory
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-09-24 02:03 UTC by Frédéric Magnard





      Modified:
    
2009-10-22 17:00 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Frédéric Magnard





          2009-09-24 02:03:55 UTC
        

kpdf takes whole memory very quickly, forcing a reboot with alt-sysrq keystrokes (if done quickly enough...).

Reproducible: Always

Steps to Reproduce:
1.start kpdf
2.press the reset button...


Actual Results:  
Using top or redirecting ps aux to a file into a while loop shows the whole memory is eaten up:
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
user     11401  0.0  0.0 125636  1380 ?        D    03:20   0:00 kpdf
[...snip...]
user     11401  1.4  1.1 161100 44796 ?        R    03:20   0:00 kpdf
[...snip...]
user     11401  4.7 10.2 651584 415068 ?       R    03:20   0:00 kpdf
[...snip...]
user     11401  8.3 20.1 1310156 813812 ?      R    03:20   0:00 kpdf
[...snip...]
user     11401 13.8 40.1 2302472 1622596 ?     R    03:20   0:01 kpdf
[...snip...]
user     11401 22.9 72.8 4522636 2947252 ?     D    03:20   0:02 kpdf



To avoid the machine's crash, this line is useful:
while [ /bin/true ]; do p=`ps aux | grep kpdf | egrep -ve 'grep|strace' | awk '{print int($4)}'`; if [ "X${p}X" == "XX" ]; then p=0; fi; if [ $p -ge 70 ]; then killall -9 kpdf; fi; done

Started with strace, I could see that the memory is eaten up by calls to mmap:
mmap(NULL, 528384, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7fda29d53000

related packages versions:
kde-base/kdelibs (3.5.10-r6(3.5)@09/14/09)
kde-base/kdeprint (3.5.10(3.5)@06/23/09)
kde-base/kghostview (3.5.10(3.5)@06/23/09)

# emerge --info:
Portage 2.1.6.13 (default/linux/amd64/2008.0/desktop, gcc-4.3.2, glibc-2.9_p20081201-r2, 2.6.30-gentoo-r4 x86_64)
=================================================================
System uname: Linux-2.6.30-gentoo-r4-x86_64-Intel-R-_Core-TM-2_Quad_CPU_Q6600_@_2.40GHz-with-gentoo-1.12.11.1
Timestamp of tree: Wed, 23 Sep 2009 05:45:02 +0000
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p28
dev-java/java-config: 1.3.7-r1, 2.1.8-r1
dev-lang/python:     2.5.4-r3, 2.6.2-r1
dev-util/ccache:     2.4-r7
dev-util/cmake:      2.6.4
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.4_p6, 1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6a
virtual/os-headers:  2.6.27-r2
ABI="amd64"
ACCEPT_KEYWORDS="amd64"
ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci"
ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol"
ANT_HOME="/usr/share/ant"
APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias"
ARCH="amd64"
ASFLAGS_x86="--32"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CDEFINE_amd64="__x86_64__"
CDEFINE_x86="__i386__"
CFLAGS="-O2 -march=nocona -pipe"
CFLAGS_x86="-m32"
CG_COMPILER_EXE="/usr/bin/cgc"
CHOST="x86_64-pc-linux-gnu"
CHOST_amd64="x86_64-pc-linux-gnu"
CHOST_x86="i686-pc-linux-gnu"
CLASSPATH="."
CLEAN_DELAY="5"
COLLISION_IGNORE="/lib/modules"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"
CVS_RSH="ssh"
CXXFLAGS="-O2 -march=nocona -pipe"
DEFAULT_ABI="amd64"
DISPLAY=":0.0"
DISTDIR="/usr/portage/distfiles"
EDITOR="vi"
ELIBC="glibc"
EMERGE_DEFAULT_OPTS="--ask --verbose"
EMERGE_WARNING_DELAY="10"
FEATURES="ccache distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans usersandbox"
FETCHCOMMAND="/usr/bin/wget -t 5 -T 60 --passive-ftp -O "${DISTDIR}/${FILE}" "${URI}""
FLTK_DOCDIR="/usr/share/doc/fltk-2.0_pre6786/html"
GCC_SPECS=""
GDK_USE_XFT="1"
GENTOO_MIRRORS="http://mirror.ovh.net/gentoo-distfiles/ ftp://mirror.ovh.net/gentoo-distfiles/ ftp://gentoo.imj.fr/pub/gentoo/ ftp://ftp.free.fr/mirrors/ftp.gentoo.org/ "
GUILE_LOAD_PATH="/usr/share/guile/1.8"
HG="/usr/bin/hg"
HOME="/root"
INFODIR="/usr/GNUstep/System/Library/Documentation/info:/usr/GNUstep/Local/Library/Documentation/info"
INFOPATH="/usr/share/info:/usr/share/binutils-data/x86_64-pc-linux-gnu/2.18/info:/usr/share/gcc-data/x86_64-pc-linux-gnu/4.3.2/info:/usr/GNUstep/System/Library/Documentation/info:/usr/GNUstep/Local/Library/Documentation/info"
INPUT_DEVICES="evdev keyboard mouse"
JAVAC="/etc/java-config-2/current-system-vm/bin/javac"
JAVACC_HOME="/usr/share/javacc/"
JAVA_HOME="/etc/java-config-2/current-system-vm"
JDK_HOME="/etc/java-config-2/current-system-vm"
KDE_IS_PRELINKED="1"
KERNEL="linux"
LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text"
LDFLAGS="-Wl,-O1"
LDFLAGS_x86="-m elf_i386"
LESS="-R -M --shift 5"
LESSOPEN="|lesspipe.sh %s"
LIBDIR_amd64="lib64"
LIBDIR_amd64_fbsd="lib64"
LIBDIR_ppc="lib32"
LIBDIR_ppc64="lib64"
LIBDIR_sparc32="lib32"
LIBDIR_sparc64="lib64"
LIBDIR_x86="lib32"
LIBDIR_x86_fbsd="lib32"
LINGUAS="en fr"
LOGNAME="root"
MAKEOPTS="-j5"
MANPATH="/etc/java-config-2/current-system-vm/man:/usr/local/share/man:/usr/share/man:/usr/share/binutils-data/x86_64-pc-linux-gnu/2.18/man:/usr/share/gcc-data/x86_64-pc-linux-gnu/4.3.2/man:/opt/intel/cce/10.0.026/man:/opt/intel/fce/10.0.026/man:/etc/java-config/system-vm/man/:/usr/lib64/php5/man/:/usr/kde/3.5/share/man:/usr/qt/3/doc/man:/opt/opera/share/man:/opt/vmware/player/man:/usr/GNUstep/System/Library/Documentation/man:/usr/GNUstep/Local/Library/Documentation/man"
MULTILIB_ABIS="amd64 x86"
MULTILIB_STRICT_DENY="64-bit.*shared object"
MULTILIB_STRICT_DIRS="/lib32 /lib /usr/lib32 /usr/lib /usr/kde/*/lib32 /usr/kde/*/lib /usr/qt/*/lib32 /usr/qt/*/lib /usr/X11R6/lib32 /usr/X11R6/lib"
MULTILIB_STRICT_EXEMPT="(perl5|gcc|gcc-lib|binutils|eclipse-3|debug|portage)"
NETBEANS="apisupport cnd groovy gsf harness ide identity j2ee java mobility nb php profiler soa visualweb webcommon websvccommon xml"
OPENGL_PROFILE="nvidia"
PAGER="less"
PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/x86_64-pc-linux-gnu/i686-pc-linux-gnu/gcc-bin/4.3.2:/usr/x86_64-pc-linux-gnu/gcc-bin/4.3.2:/opt/intel/cce/10.0.026/bin:/opt/intel/fce/10.0.026/bin:/usr/kde/3.5/sbin:/usr/kde/3.5/bin:/usr/qt/3/bin:/usr/lib64/subversion/bin:/opt/vmware/player/bin:/usr/GNUstep/System/Tools:/usr/GNUstep/Local/Tools"
PKGDIR="/usr/portage/packages"
PKG_CONFIG_PATH="/usr/qt/3/lib64/pkgconfig"
PORTAGE_ARCHLIST="ppc x86-openbsd ppc-openbsd ppc64 x86-winnt x86-fbsd ppc-aix alpha arm x86-freebsd s390 amd64 x86-macos x64-openbsd ia64-hpux hppa x86-netbsd amd64-linux ia64-linux x86 sparc-solaris x64-freebsd sparc64-solaris x86-linux x64-macos sparc m68k-mint ia64 mips ppc-macos x86-interix hppa-hpux amd64-fbsd x64-solaris mips-irix m68k sh x86-solaris sparc-fbsd"
PORTAGE_BINHOST_CHUNKSIZE="3000"
PORTAGE_BIN_PATH="/usr/lib64/portage/bin"
PORTAGE_COMPRESS_EXCLUDE_SUFFIXES="css gif htm[l]? jp[e]?g js pdf png"
PORTAGE_CONFIGROOT="/"
PORTAGE_DEBUG="0"
PORTAGE_DEPCACHEDIR="/var/cache/edb/dep"
PORTAGE_ELOG_CLASSES="info warn error log"
PORTAGE_ELOG_MAILFROM="magnard@iap.fr"
PORTAGE_ELOG_MAILSUBJECT="package ${PACKAGE} merged on ${HOST} with notice"
PORTAGE_ELOG_MAILURI="magnard@iap.fr smtp.iap.fr"
PORTAGE_ELOG_SYSTEM="echo save_summary save mail_summary:warn,error,log"
PORTAGE_FETCH_CHECKSUM_TRY_MIRRORS="5"
PORTAGE_FETCH_RESUME_MIN_SIZE="350K"
PORTAGE_GID="250"
PORTAGE_INST_GID="0"
PORTAGE_INST_UID="0"
PORTAGE_PYM_PATH="/usr/lib64/portage/pym"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_RSYNC_RETRIES="3"
PORTAGE_TMPDIR="/var/tmp"
PORTAGE_VERBOSE="1"
PORTAGE_WORKDIR_MODE="0700"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/sunrise /usr/local/portage"
PORT_LOGDIR="/var/log/portage"
PROFILE_ONLY_VARIABLES="ARCH ELIBC KERNEL USERLAND"
PWD="/root"
PYTHONDOCS="/usr/share/doc/python-docs-2.6.2-r1/html/library"
PYTHONDOCS_2_6="/usr/share/doc/python-docs-2.6.2-r1/html/library"
QMAKESPEC="linux-g++"
QTDIR="/usr/qt/3"
RESUMECOMMAND="/usr/bin/wget -c -t 5 -T 60 --passive-ftp -O "${DISTDIR}/${FILE}" "${URI}""
ROOT="/"
ROOTPATH="/opt/bin:/usr/x86_64-pc-linux-gnu/i686-pc-linux-gnu/gcc-bin/4.3.2:/usr/x86_64-pc-linux-gnu/gcc-bin/4.3.2:/opt/intel/cce/10.0.026/bin:/opt/intel/fce/10.0.026/bin:/usr/kde/3.5/sbin:/usr/kde/3.5/bin:/usr/qt/3/bin:/usr/lib64/subversion/bin:/opt/vmware/player/bin:/usr/GNUstep/System/Tools:/usr/GNUstep/Local/Tools"
RPMDIR="/usr/portage/rpm"
RUBYOPT="-rauto_gem"
SANE_BACKENDS="epson mustek mustek_usb plustek plustek_pp"
SANE_CONFIG_DIR="/etc/sane.d"
SGML_CATALOG_FILES="/etc/sgml/xml-docbook-4.3.cat:/etc/sgml/xml-docbook-4.2.cat:/etc/sgml/xml-docbook-4.1.2.cat:/etc/sgml/sgml-docbook-4.1.cat:/etc/sgml/sgml-docbook.cat:/etc/sgml/dsssl-docbook-stylesheets.cat:/etc/sgml/openjade-1.3.2.cat:/etc/sgml/sgml-ent.cat:/etc/sgml/xml-docbook-4.4.cat:/etc/sgml/sgml-docbook-3.1.cat:/etc/sgml/sgml-lite.cat:/etc/sgml/sgml-docbook-4.4.cat:/etc/sgml/sgml-docbook-3.0.cat:/etc/sgml/sgml-docbook-4.0.cat"
SHELL="/bin/bash"
SHLVL="1"
STAGE1_USE="multilib nptl nptlonly unicode"
SYMLINK_LIB="yes"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
TERM="xterm"
TEXINPUTS="/usr/lib64/ocaml/ocamldoc:"
TIME="%U user %S system %e elapsed %P CPU"
TIMEFORMAT="%U user %S system %R elapsed %P%% CPU"
USB_DEVFS_PATH="/dev/bus/usb"
USE="3dnow 3dnowext X X509 Xaw3d a52 aac aalib acl acpi additions aften aim akode alsa amd64 amr amrnb amrwb apache2 arts artworkextra assistant audacious audiofile authfile automount avahi background bash-completion bdf beagle berkdb big-tables bl bluetooth bogofilter branding bs2b bzip2 cairo calendar cdaudio cdda cddb cdio cdparanoia cdr cg cgi cgraph chm chroot cli console consolekit contrast cpudetection cracklib crypt css ctype cups curl cvs cxx daap dbus dc1394 dedicated device-mapper dga dia dillo dirac directfb disk-partition divx djconsole djvu dmraid dmx dri dts dv dvb dvd dvdr dvdread dvi dvipdfm emboss enca encode esd evo exif extraengine extrafilters extras faac fam fastcgi fat fbcon ffmpeg fftw firefox flac fltk fontconfig fortran fping ftp fuse gcj gd gdbm geoip gif gimp git gkrellm glade glut gmedia gmp gnome gnome-keyring gnome-print gnomecd gnustep gnutls gpac gpg gphoto2 gpm grammar graphviz gs gsl gsm gstreamer gtk gtkhtml gutenprint hal hddtemp hdf5 hdri hifieq hpn httpd ia32 icecast iconv id3 id3tag idn ieee1394 ifp ilbc imagemagick imap imlib inherit-graph ipod ipv6 isdnlog ithreads jabber java javascript jbig jce jpeg jpeg2k kate kde kerberos keyring kpathsea kqemu lame lapack largeterminal lastfmradio latex latex3 lcms ldap libass libcaca libffi libgcrypt libmms libnotify libsamplerate libssh2 libsysfs libv4l2 lighttpd live lm_sensors lock logitech-mouse logrotate lyx lzma lzo mad math matroska max-idx-128 metric mhash midi mikmod mjpeg mmx mmxext mng modules mozdom mozilla mp2 mp3 mp4 mpd mpeg mplayer mtp mudflap multilib multitarget multiuser musepack musicbrainz mysql nagios-dns nagios-ping nagios-ssh nas nautilus ncurses neXt netpbm network networkmanager new-login nis nls nntp nodrm nptl nptlonly nsplugin ntfs numeric nvidia objc odbc offensive ogg openal opengl openmp opensslcrypt oss ots pam passfile patented pcre pda pdf perl plotutils plugins png pnm posix postscript ppds pppd profile pulseaudio python qhull qt3 qt3support qt4 quicktime radio rar raw rdesktop readline realmedia reflection reiser4 reiserfs replytolist rewrite rplay rrdtool rss rtc rtsp samba sametime sasl scanner schroedinger screen scrobbler sdl sdl-image sensord server session shaper shout skins slp smime smp snmp soundtouch sourceview sox spamassassin speex spell spl spoof-source sqlite srt sse sse2 ssl ssse3 startup-notification stream stroke subtitles subversion svg svnserve sysfs szip t1lib taglib tagwriting tcpd teamarena tetex theora thesaurus threads thunar thunderbird tiff timezone timidity tivo tk tools transcode truetype tta twolame unicode unzip ups usb utils v4l v4l2 valgrind vamp vdpau vdr vhook vhosts video vim-pager vim-syntax vim-with-x vimpager visualization vlm vnc vorbis vroot wavpack webdav webkit wifi wma wmf wmp wxwidgets wxwindows x264 xattr xcb xcomposite xface xfce xfs xine xinerama xinetd xml xmlpatterns xmp xorg xosd xpm xprint xrandr xscreensaver xulrunner xv xvid xvmc yaz yv12 zeroconf zip zlib zrtp" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en fr" SANE_BACKENDS="epson mustek mustek_usb plustek plustek_pp" USERLAND="GNU" VIDEO_CARDS="nvidia nv v4l vmware vga vesa fbdev"
USER="root"
USERLAND="GNU"
USE_EXPAND="ALSA_CARDS ALSA_PCM_PLUGINS APACHE2_MODULES APACHE2_MPMS CAMERAS CROSSCOMPILE_OPTS DVB_CARDS ELIBC FCDSL_CARDS FOO2ZJS_DEVICES FRITZCAPI_CARDS INPUT_DEVICES KERNEL LCD_DEVICES LINGUAS LIRC_DEVICES MISDN_CARDS NETBEANS_MODULES QEMU_SOFTMMU_TARGETS QEMU_USER_TARGETS SANE_BACKENDS USERLAND VIDEO_CARDS"
USE_EXPAND_HIDDEN="CROSSCOMPILE_OPTS ELIBC KERNEL USERLAND"
USE_ORDER="env:pkg:conf:defaults:pkginternal:env.d"
VIDEO_CARDS="nvidia nv v4l vmware vga vesa fbdev"
VISUAL="vi"
VTKHOME="/usr"
VTK_DATA_ROOT="/usr/share/vtk/data"
VTK_DIR="/usr/lib64/vtk-5.4"
XAUTHORITY="/root/.xauthBCaL6e"
XDG_CONFIG_DIRS="/etc/xdg"
XDG_DATA_DIRS="/usr/local/share:/usr/kde/3.5/share:/usr/share"
_="/usr/bin/emerge"




Comment 1


Frédéric Magnard





          2009-09-24 02:11:50 UTC
        

I have just re-emerged kpdf, after which it works...
Could a linking with the former version of kdelibs cause this behaviour ?
Sorry for not having tryed to re-emerge before submitting this bug.




Comment 2


Samuli Suominen (RETIRED)






          2009-10-22 17:00:28 UTC
        

(In reply to comment #1)
> I have just re-emerged kpdf, after which it works...

Closing since it's working for you now.

I wouldn't waste time on reporting KDE3 bugs, it's about to get removed.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

