Title: 97625 – consolefont not set on all framebuffer consoles
URL: https://bugs.gentoo.org/show_bug.cgi?id=97625

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 97625
consolefont not set on all framebuffer consoles
Last modified: 2006-08-24 20:25:29 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 97625 
      - consolefont not set on all framebuffer consoles


Summary:
consolefont not set on all framebuffer consoles
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-07-01 08:21 UTC by Alexander Stoll





      Modified:
    
2006-08-24 20:25 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alexander Stoll





          2005-07-01 08:21:32 UTC
        

Consolefont lat9w-16 is set correctly only on the first console (vc0) when vesa
framebuffer support is compiled into kernel

Reproducible: Always
Steps to Reproduce:
1. Boot kernel with vesa fb support
2. log into vc0, type umlauts into console -> correct display
3. log into vc1, type umlauts into console -> garbled fonts
4. manually set consolefont "setfont lat9w-16", enter again umlauts -> correct
display
5. boot same kernel without fb support compiled in an repeat test -> no problem

Actual Results:  
garbled font display on framebuffer vc1 - 11

Expected Results:  
correct font display on framebuffer vc1 - 11

This issue is very strange, I




Comment 1


Alexander Stoll





          2005-07-01 08:21:32 UTC
        

Consolefont lat9w-16 is set correctly only on the first console (vc0) when vesa
framebuffer support is compiled into kernel

Reproducible: Always
Steps to Reproduce:
1. Boot kernel with vesa fb support
2. log into vc0, type umlauts into console -> correct display
3. log into vc1, type umlauts into console -> garbled fonts
4. manually set consolefont "setfont lat9w-16", enter again umlauts -> correct
display
5. boot same kernel without fb support compiled in an repeat test -> no problem

Actual Results:  
garbled font display on framebuffer vc1 - 11

Expected Results:  
correct font display on framebuffer vc1 - 11

This issue is very strange, I´m not sure this is caused by update to
baselayout-1.11.12-r4, kernel related or something other...
The init script is checked and on all vc´s the font is set on system boot,
verified via test with different font size, but umlauts for locale de_DE@euro
are garbled on vc > 0 and after manually setting font again on those vc all is
displayed like it should...
It seems not related to grafic chip hardware, on different systems tested.
I´m a bit lost what to check next.


Gentoo Base System version 1.6.12
Portage 2.0.51.19 (default-linux/x86/2005.0, gcc-3.3.5-20050130, glibc-2.3.4.200
41102-r1, 2.4.31-grsec i686)
=================================================================
System uname: 2.4.31-grsec i686 Pentium III (Katmai)
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Apr 30 2005, 16:53:41)]
dev-lang/python:     2.3.5
sys-apps/sandbox:    [Not Present]
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.5
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.16
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-O3 -march=pentiumpro -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/share/
config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=pentiumpro -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms strict"

GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/Linux/
distributions/gentoo"
LC_ALL="de_DE@euro"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 activefilter bitmap-fonts bzlib crypt ctype dbm emboss erandom ethereal
 flatfile fortran ftp gdbm gnutls hardened icc ifc maildir mbox memlimit mhash m
ime mmap mmx mp3 mysqli ncurses nls pam pcntl pcre perl pic pie posix readline r
ecode sasl shared sharedmem slang sockets socks5 sse ssl sysvipc szip tcpd truet
ype-fonts type1-fonts unicode zlib userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 2


SpanKY






          2005-07-01 10:52:22 UTC
        

probably because the patch which we used to apply to `setfont` to add the
'--tty' option has been missing for a while ...




Comment 3


SpanKY






          2005-07-02 10:52:46 UTC
        

hmm, or not ...

reboot the machine and login to vc0 ... then run this:
setfont -C /dev/vc/1 lat9w-16

then, if you log in to vc1, does it look OK ?




Comment 4


Alexander Stoll





          2005-07-02 11:50:59 UTC
        

> reboot the machine and login to vc0 ... then run this:
> setfont -C /dev/vc/1 lat9w-16
> then, if you log in to vc1, does it look OK ?
no, umlauts are garbled and ncurses applications also, line characters are not
drawn properly like the false font is in place...
Verified once again that enviroment ist set correctly on vc1 (LC_ALL=de_DE@euro)
and if entered "setfont lat9w-16" ON vc1 all back to normal...
Very mysterious to me...






Comment 5


Alexander Stoll





          2005-07-26 05:29:06 UTC
        

Since time has passed by and nothing new came up, I want to add some info to
reduce confusion. In opposition to earlier comments, the console getties are
beginning on vc1 not vc0, device counting for kernel starts with vc0. I wish to
point out that the above tests have been done with respect to this matter and it
is still the same issue...
If something new should be tested, please feel free to ask, I will gladly
provide time for testing to resolve this annoying bug.





Comment 6


Martin Schlemmer (RETIRED)






          2005-08-02 00:44:05 UTC
        

Problem is that most of us doing baselayout is from the US or other english
orientated countries ... mind helping out how to type this 'umlauts' ?




Comment 7


Alexander Stoll





          2005-08-03 03:07:01 UTC
        

(In reply to comment #5)
> Problem is that most of us doing baselayout is from the US or other english
> orientated countries ... mind helping out how to type this 'umlauts' ?

This is no problem since ncurses applications are also affected, I first noticed
the bug via garbled umlauts, but if you want to check for this bug, fire up a
ncurses application like mc (checked that locale setting has no influence on
this via "export LC_ALL=en_EN"...) and if the lines are drawn properly on the
first console and badly replaced by other ASCII charakters on the second, then
you have a proper testcase even for your locale setting.
If I could do anything other helpful, please don




Comment 8


Alexander Stoll





          2005-08-03 03:07:01 UTC
        

(In reply to comment #5)
> Problem is that most of us doing baselayout is from the US or other english
> orientated countries ... mind helping out how to type this 'umlauts' ?

This is no problem since ncurses applications are also affected, I first noticed
the bug via garbled umlauts, but if you want to check for this bug, fire up a
ncurses application like mc (checked that locale setting has no influence on
this via "export LC_ALL=en_EN"...) and if the lines are drawn properly on the
first console and badly replaced by other ASCII charakters on the second, then
you have a proper testcase even for your locale setting.
If I could do anything other helpful, please don´t hesitate to ask.




Comment 9


Martin Schlemmer (RETIRED)






          2005-08-25 03:06:15 UTC
        

If I login to tty[1-3], and then do:

  # setfont -C /dev/tty1 lat9w-16
  # setfont -C /dev/tty2 lat9w-16

from the first, and then start mc in all three like:

  $ LC_ALL=en_EN mc

All three mc's look just fine, and I can see that the mc's on tty1 and tty2's
font is different from the font for mc on tty3 (I have diff default font) ....





Comment 10


SpanKY






          2006-08-24 20:25:29 UTC
        

works for me









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

