Title: 400749 – app-laptop/ibam-0.5.2-r3 - ./ibam-0.5.2/debian/patches/04sysfs.dpatch fails
URL: https://bugs.gentoo.org/show_bug.cgi?id=400749

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 400749
app-laptop/ibam-0.5.2-r3 - ./ibam-0.5.2/debian/patches/04sysfs.dpatch fails
Last modified: 2015-11-06 14:06:07 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 400749 
      - app-laptop/ibam-0.5.2-r3 - ./ibam-0.5.2/debian/patches/04sysfs.dpatch fails


Summary:
app-laptop/ibam-0.5.2-r3 - ./ibam-0.5.2/debian/patches/04sysfs.dpatch fails
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

No maintainer - Look at https://wiki.gentoo.org/wiki/Project:Proxy_Maintainers if you want to take care of it








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-01-25 13:13 UTC by Fabian Büttner





      Modified:
    
2015-11-06 14:06 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



as.gentoo
jarauh
mail









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge.info,4.59 KB,
                text/plain)

            
2012-01-25 13:13 UTC,

            Fabian Büttner




Details





04sysfs.dpatch.out

              (04sysfs.dpatch.out,3.56 KB,
                text/plain)

            
2012-01-25 13:13 UTC,

            Fabian Büttner




Details





iabm-0.5.2-r3.ebuild without debian patches

              (ibam-0.5.2-r3.ebuild,1.15 KB,
                text/plain)

            
2012-07-22 12:31 UTC,

            Fabian Büttner




Details





app-misc/tracker-0.14.4 build log

              (build.log,198.27 KB,
                text/plain)

            
2012-12-14 15:41 UTC,

            Attila Stehr




Details





emerge -pvD --info tracker

              (file_400749.txt,16.96 KB,
                text/plain)

            
2012-12-14 15:42 UTC,

            Attila Stehr




Details





app-laptop/ibam-0.5.2-r3 build log

              (build.log,2.46 KB,
                text/plain)

            
2012-12-14 15:49 UTC,

            Attila Stehr




Details





emerge --info '=app-laptop/ibam-0.5.2-r3'

              (file_400749.txt,16.84 KB,
                text/plain)

            
2012-12-14 15:51 UTC,

            Attila Stehr




Details





Show
              Obsolete (2)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Fabian Büttner





          2012-01-25 13:13:12 UTC
        

Compilation fails applying patch 04sysfs.dpatch

See emerge --info and 04sysfs.dpatch.out

regards,
fabian




Comment 1


Fabian Büttner





          2012-01-25 13:13:36 UTC
        

Created attachment 299845 [details]
emerge --info




Comment 2


Fabian Büttner





          2012-01-25 13:13:55 UTC
        

Created attachment 299847 [details]
04sysfs.dpatch.out




Comment 3


Jeroen Roovers (RETIRED)






          2012-01-25 15:32:27 UTC
        

Which version of sys-devel/patch do you have?




Comment 4


Fabian Büttner





          2012-01-26 00:37:43 UTC
        

(In reply to comment #3)
> Which version of sys-devel/patch do you have?

Hi,
I do have sys-devel/patch-2.6.1 installed.

regards,
fabian




Comment 5


Attila Stehr





          2012-02-02 07:40:10 UTC
        

Same here

* sys-devel/patch
     Available versions:  2.5.9 (~)2.5.9-r1 2.6.1 {static test}
     Installed versions:  Version: 2.6.1
                          Date:    01:01:39 22.09.2010
                          USE:     test -static




Comment 6


Fabian Büttner





          2012-07-22 12:29:46 UTC
        

Apparently the debian style patches fail during src_prepare().
I just removed the section that does apply those patches.

regards,
fabian




Comment 7


Fabian Büttner





          2012-07-22 12:31:15 UTC
        

Created attachment 318898 [details]
iabm-0.5.2-r3.ebuild without debian patches




Comment 8


Damien Levac





          2012-09-20 21:15:55 UTC
        

I have the same problem, if it's worth pointing out.




Comment 9


Attila Stehr





          2012-12-12 19:30:49 UTC
        

Looks like the patch is applied to the wrong path. The patch should look like this:

--- ibam.inl    2010-12-10 11:34:38.584151204 +0100
+++ ibam.inl.orig       2010-12-10 11:29:43.151172174 +0100

instead of

--- ibam-0.5.2/ibam.inl	2010-12-10 11:34:38.584151204 +0100
+++ ibam-0.5.2/ibam.inl.orig	2010-12-10 11:29:43.151172174 +0100

Anyone fit enough to supply a patch of the patch? ^^

********************************

# cd /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work/ibam-0.5.2
# patch -p0 -g0 -E --no-backup-if-mismatch  < './ibam-0.5.2/debian/patches/04sysfs.dpatch'
can't find file to patch at input line 11

// removal of    ibam-0.5.2/    in the patch file
# emacs ibam-0.5.2/debian/patches/04sysfs.dpatch

# patch -p0 -g0 -E --no-backup-if-mismatch  < './ibam-0.5.2/debian/patches/04sysfs.dpatch'
patching file ibam.inl
Reversed (or previously applied) patch detected!  Assume -R? [n] y

# ll
insgesamt 124K
drwxr-xr-x 3 portage portage 4,0K 12. Dez 20:05 .
drwx------ 3 portage portage   47 12. Dez 19:55 ..
-rw-r--r-- 1 portage portage 1,3K  9. Mär 2009  CHANGES
-rw-r--r-- 1 portage portage 2,6K 12. Dez 19:55 Makefile
-rw-r--r-- 1 portage portage 9,5K  9. Mär 2009  README
-rw-r--r-- 1 portage portage 3,0K  9. Mär 2009  REPORT
drwxr-xr-x 3 portage portage   19 12. Dez 19:55 ibam-0.5.2
-rw-r--r-- 1 portage portage 7,6K  9. Mär 2009  ibam-krell.cpp
-rw-r--r-- 1 portage portage 7,5K  9. Mär 2009  ibam-krell1.cpp
-rw-r--r-- 1 portage portage  17K  9. Mär 2009  ibam.cpp
-rw-r--r-- 1 portage portage 6,7K  9. Mär 2009  ibam.hpp
-rw-r--r-- 1 portage portage  41K 12. Dez 20:05 ibam.inl       # PATCHED
-rw-r--r-- 1 root    root    1,9K 12. Dez 20:04 ibam.inl.rej
-rw-r--r-- 1 portage portage  998  9. Mär 2009  ibam.spec

# make
g++  -DIBAM_VERSION=\"0.5.2\" -Wall ibam.cpp -o ibam
[...]

# ll
insgesamt 208K
[...]
-rwxr-xr-x 1 root    root     81K 12. Dez 20:06 ibam          # BUILD SUCCESS
drwxr-xr-x 3 portage portage   19 12. Dez 19:55 ibam-0.5.2
[...]
-rw-r--r-- 1 portage portage  41K 12. Dez 20:05 ibam.inl
[...]




Comment 10


Sergey Popov (RETIRED)






          2012-12-13 08:31:33 UTC
        

pinkbyte@phantom /usr/portage/app-laptop/ibam $ eix -cI patch$
[I] sys-devel/patch (2.6.1@10.06.2012): Utility to apply diffs to files

pinkbyte@phantom /usr/portage/app-laptop/ibam $ ebuild ibam-0.5.2-r3.ebuild clean prepare
 * ibam-0.5.2.tar.gz SHA256 SHA512 WHIRLPOOL size ;-) ...                                                                                                            [ ok ]
 * ibam_0.5.2-2.diff.gz SHA256 SHA512 WHIRLPOOL size ;-) ...                                                                                                         [ ok ]
 * checking ebuild checksums ;-) ...                                                                                                                                 [ ok ]
 * checking auxfile checksums ;-) ...                                                                                                                                [ ok ]
 * checking miscfile checksums ;-) ...                                                                                                                               [ ok ]
>>> Unpacking source...
>>> Unpacking ibam-0.5.2.tar.gz to /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
>>> Unpacking ibam_0.5.2-2.diff.gz to /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
>>> Source unpacked in /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
>>> Preparing source in /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work/ibam-0.5.2 ...
 * Applying ibam-0.5.2-build.patch ...                                                                                                                               [ ok ]
 * Applying ibam_0.5.2-2.diff ...                                                                                                                                    [ ok ]
 * Applying 03acpi-check.dpatch ...                                                                                                                                  [ ok ]
 * Applying 02deviation.dpatch ...                                                                                                                                   [ ok ]
 * Applying 05_sysfs_lenovo.dpatch ...                                                                                                                               [ ok ]
 * Applying 04sysfs.dpatch ...                                                                                                                                       [ ok ]
>>> Source prepared.

Something is definitely wrong with your system




Comment 11


Fabian Büttner





          2012-12-13 18:24:58 UTC
        

(In reply to comment #10)
> pinkbyte@phantom /usr/portage/app-laptop/ibam $ eix -cI patch$
> [I] sys-devel/patch (2.6.1@10.06.2012): Utility to apply diffs to files
> 
> pinkbyte@phantom /usr/portage/app-laptop/ibam $ ebuild ibam-0.5.2-r3.ebuild
> clean prepare
>  * ibam-0.5.2.tar.gz SHA256 SHA512 WHIRLPOOL size ;-) ...                   
> [ ok ]
>  * ibam_0.5.2-2.diff.gz SHA256 SHA512 WHIRLPOOL size ;-) ...                
> [ ok ]
>  * checking ebuild checksums ;-) ...                                        
> [ ok ]
>  * checking auxfile checksums ;-) ...                                       
> [ ok ]
>  * checking miscfile checksums ;-) ...                                      
> [ ok ]
> >>> Unpacking source...
> >>> Unpacking ibam-0.5.2.tar.gz to /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
> >>> Unpacking ibam_0.5.2-2.diff.gz to /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
> >>> Source unpacked in /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
> >>> Preparing source in /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work/ibam-0.5.2 ...
>  * Applying ibam-0.5.2-build.patch ...                                      
> [ ok ]
>  * Applying ibam_0.5.2-2.diff ...                                           
> [ ok ]
>  * Applying 03acpi-check.dpatch ...                                         
> [ ok ]
>  * Applying 02deviation.dpatch ...                                          
> [ ok ]
>  * Applying 05_sysfs_lenovo.dpatch ...                                      
> [ ok ]
>  * Applying 04sysfs.dpatch ...                                              
> [ ok ]
> >>> Source prepared.
> 
> Something is definitely wrong with your system

very helpful, thank you ...
Still, it does not build!

>>> eix -cI patch
[I] sys-devel/patch (2.7.1-r1@11/13/2012): Utility to apply diffs to files

>>> ebuild ibam-0.5.2-r3.ebuild clean prepare
 * ibam-0.5.2.tar.gz SHA256 SHA512 WHIRLPOOL size ;-) ...                         [ ok ]
 * ibam_0.5.2-2.diff.gz SHA256 SHA512 WHIRLPOOL size ;-) ...                      [ ok ]
 * checking ebuild checksums ;-) ...                                              [ ok ]
 * checking auxfile checksums ;-) ...                                             [ ok ]
 * checking miscfile checksums ;-) ...                                            [ ok ]
>>> Unpacking source...
>>> Unpacking ibam-0.5.2.tar.gz to /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
>>> Unpacking ibam_0.5.2-2.diff.gz to /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
>>> Source unpacked in /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work
>>> Preparing source in /var/tmp/portage/app-laptop/ibam-0.5.2-r3/work/ibam-0.5.2 ...
 * Applying ibam-0.5.2-build.patch ...                                            [ ok ]
 * Applying ibam_0.5.2-2.diff ...                                                 [ ok ]
 * Applying 04sysfs.dpatch ...

 * Failed Patch: 04sysfs.dpatch !
 *  ( ./ibam-0.5.2/debian/patches/04sysfs.dpatch )
 * 
 * Include in your bugreport the contents of:
 * 
 *   /var/tmp/portage/app-laptop/ibam-0.5.2-r3/temp/04sysfs.dpatch.out

 * ERROR: app-laptop/ibam-0.5.2-r3 failed (prepare phase):
 *   Failed Patch: 04sysfs.dpatch!
 * 
 * Call stack:
 *     ebuild.sh, line   93:  Called src_prepare
 *   environment, line 2040:  Called epatch './ibam-0.5.2/debian/patches/04sysfs.dpatch'
 *   environment, line  937:  Called die
 * The specific snippet of code:
 *               die "Failed Patch: ${patchname}!";
 * 
 * If you need support, post the output of `emerge --info '=app-laptop/ibam-0.5.2-r3'`,
 * the complete build log and the output of `emerge -pqv '=app-laptop/ibam-0.5.2-r3'`.
 * The complete build log is located at '/var/tmp/portage/app-laptop/ibam-0.5.2-r3/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/app-laptop/ibam-0.5.2-r3/temp/environment'.
 * Working directory: '/var/tmp/portage/app-laptop/ibam-0.5.2-r3/work/ibam-0.5.2'
 * S: '/var/tmp/portage/app-laptop/ibam-0.5.2-r3/work/ibam-0.5.2'

regards,
fabian




Comment 12


Sergey Popov (RETIRED)






          2012-12-14 11:25:02 UTC
        

(In reply to comment #11)
>  * If you need support, post the output of `emerge --info
> '=app-laptop/ibam-0.5.2-r3'`,
>  * the complete build log and the output of `emerge -pqv
> '=app-laptop/ibam-0.5.2-r3'`.
>  * The complete build log is located at
> '/var/tmp/portage/app-laptop/ibam-0.5.2-r3/temp/build.log'.

Where your build.log? What USE-flags are you used to reproduce this?




Comment 13


Attila Stehr





          2012-12-14 15:41:13 UTC
        

Created attachment 332294 [details]
app-misc/tracker-0.14.4 build log

$ sudo emerge -pvD tracker
                       
[ebuild   R    ] app-misc/tracker-0.14.4  USE="eds exif firefox-bookmarks flac gif gsf gtk iptc iso jpeg laptop miner-fs mp3 pdf playlist {test} tiff vorbis xml (-applet) -cue -doc -flickr -gnome-keyring -gstreamer -nautilus -networkmanager -rss -thunderbird -upnp -xine -xmp -xps" 0 kB

Total: 1 package (1 reinstall), Size of downloads: 0 kB

$ ldd /usr/libexec/tracker-miner-fs | grep libicu
	libicuuc.so.49 => not found
	libicui18n.so.49 => not found
	libicui18n.so.50 => /usr/lib64/libicui18n.so.50 (0x00007f2787295000)
	libicuuc.so.50 => /usr/lib64/libicuuc.so.50 (0x00007f2786f2e000)
	libicudata.so.50 => /usr/lib64/libicudata.so.50 (0x00007f2785440000)




Comment 14


Attila Stehr





          2012-12-14 15:42:38 UTC
        

Created attachment 332296 [details]
emerge -pvD --info tracker

emerge -pvD --info tracker




Comment 15


Attila Stehr





          2012-12-14 15:43:46 UTC
        

ups ... sorry :(




Comment 16


Attila Stehr





          2012-12-14 15:49:38 UTC
        

Created attachment 332298 [details]
app-laptop/ibam-0.5.2-r3 build log

atti@spirit ~ $ sudo emerge -pvD ibam

Calculating dependencies     ... done!                      
[ebuild     U  ] app-laptop/ibam-0.5.2-r3 [0.5.2-r2] USE="gkrellm" 0 kB

Total: 1 package (1 upgrade), Size of downloads: 0 kB




Comment 17


Attila Stehr





          2012-12-14 15:51:56 UTC
        

Created attachment 332300 [details]
emerge --info '=app-laptop/ibam-0.5.2-r3'




Comment 18


Pacho Ramos






          2015-11-06 14:06:07 UTC
        

I am completly unable to reproduce on a full updated system (from stable branch) right now :/









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

