Title: 186015 – Klamav segfaults shortly after having been launched
URL: https://bugs.gentoo.org/show_bug.cgi?id=186015

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 186015
Klamav segfaults shortly after having been launched
Last modified: 2008-04-26 15:38:46 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 186015 
      - Klamav segfaults shortly after having been launched


Summary:
Klamav segfaults shortly after having been launched
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-07-20 17:19 UTC by paulphilippe





      Modified:
    
2008-04-26 15:38 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



robert









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


paulphilippe





          2007-07-20 17:19:55 UTC
        

When launching klamav, it crashed without giving too much details on why it crashed. A single time it gave a message about a bad window ('Invalid Window parameter.)

Here is the most detailed error message:
"
user@localhost ~ $ klamav
QLayout "unnamed" added to Klamav "KlamAV ", which already has a layout
klamav: WARNING: Pixmap not found for mimetype inode/directory
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".

(process:17326): GLib-GObject-CRITICAL **: gtype.c:2242: initialization assertion failed, use IA__g_type_init() prior to this function

(process:17326): Gtk-CRITICAL **: gtk_clipboard_get_for_display: assertion `GDK_IS_DISPLAY (display)' failed
Adobe FlashPlayer: gtk_clipboard_get(GDK_SELECTION_PRIMARY); failed. Trying to call gtk_init(0,0);
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".
The program '<unknown>' received an X Window System error.
This probably reflects a bug in the program.
The error was 'BadWindow (invalid Window parameter)'.
  (Details: serial 3007 error_code 3 request_code 3 minor_code 0)
  (Note to programmers: normally, X errors are reported asynchronously;
   that is, you will receive the error a while after causing it.
   To debug your program, run it with the --sync command line
   option to change this behavior. You can then get a meaningful
   backtrace from your debugger if you break on the gdk_x_error() function.)
Segmentation fault
"





Reproducible: Always

Steps to Reproduce:
1.launch klamav (from kde menu and/or command line)


Actual Results:  
1.The klamav gui appears and freezes
2.The gui disappears with the error message

Expected Results:  
Expecting gui to not crash and program to scan for viruses and to update virus definitions

Portage 2.1.3_rc8 (default-linux/x86/2006.1/desktop, gcc-4.1.2, glibc-2.6-r0, 2.
6.21-gentoo-r1 i686)
=================================================================
System uname: 2.6.21-gentoo-r1 i686 Intel(R) Pentium(R) 4 CPU 2.80GHz
Gentoo Base System release 1.12.10
Timestamp of tree: Mon, 16 Jul 2007 18:00:11 +0000
dev-java/java-config: 1.3.7, 2.0.33-r1
dev-lang/python:     2.3.6-r2, 2.4.4-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r1
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium4 -O3 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shu
tdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/
3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/
share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/php/apache2-php
5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/r
evdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=pentium4 -O3 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="ccache cvs distcc distlocks metadata-transfer sandbox sfperms strict u
nmerge-orphans userpriv usersandbox"
GENTOO_MIRRORS="http://mirror.tucdemonic.org/gentoo/ ftp://gentoo.netnitco.net/p
ub/mirrors/gentoo/source/  http://gentoo.netnitco.net ftp://ftp.ussg.iu.edu/pub/
linux/gentoo"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress
--force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/di
stfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X aac aalib alsa ansi arts berkdb bitmap-fonts cairo cdr cli cracklib crypt                  cups dbus divx4linux dri dvd dvdr eds emboss encode esd faad2 fam fbdev firefox                  flac fortran gcj gdbm gif gnome gpm gstreamer gtk hal iconv ipv6 isdnlog java j                 peg kde ldap libg++ live m4a mad midi mikmod mp3 mp4 mpeg mudflap nas ncurses ne                 twork nls nptl nptlonly ogg opengl openmp oss pam pcre pdf perl png ppds pppd py                 thon qt3 qt4 quicktime readline reflection sdl seamonkey session spell spl ssl t                 cpd truetype truetype-fonts type1-fonts unicode vorbis win32codecs wma wmv x86 x                 ml xorg xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cm                 ipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 int                 el8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS                 ="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug                  ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol"                  ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad                  cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" V                 IDEO_CARDS="vesa vga fbdev nv nvidia"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGU                 AS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


rob





          2007-08-11 11:49:48 UTC
        

could you try running 'klamav --sync' as the x error msg suggests?






Comment 2


paulphilippe





          2007-08-15 13:02:50 UTC
        

(In reply to comment #1)

Hi, sorry for the delay...

Here is what I get when running 'klamav --sync'
user@localhost ~ $ klamav --sync
QLayout "unnamed" added to Klamav "KlamAV ", which already has a layout
klamav: WARNING: Pixmap not found for mimetype inode/directory
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".
Xlib:  extension "SHAPE" missing on display ":0.0".
Segmentation fault
user@localhost ~ $  

I see no clues that would tell me where to look to solve this problem.
 


> could you try running 'klamav --sync' as the x error msg suggests?
> 






Comment 3


Wulf Krueger (RETIRED)






          2007-08-18 11:32:21 UTC
        

Do you have 'Load "extmod"' in your module section in /etc/X11/xorg.conf?




Comment 4


paulphilippe





          2007-08-20 14:09:04 UTC
        

(In reply to comment #3)
> Do you have 'Load "extmod"' in your module section in /etc/X11/xorg.conf?
> 

Nope. I do not have this line in my module section. Would it help if I added this line my module section?

Paul




Comment 5


Wulf Krueger (RETIRED)






          2007-08-22 14:33:12 UTC
        

It should, yes. Please try it.




Comment 6


paulphilippe





          2007-08-23 14:01:28 UTC
        

(In reply to comment #5)
> It should, yes. Please try it.
> 

Hi,
 I added the line "Load  extmod" and the same error message appears

Paul-Philippe




Comment 7


Matteo Azzali (RETIRED)






          2007-10-13 10:35:26 UTC
        

Hum, why all those Gtk and GDK warnings? Were are you trying to run KlamAV,
is that Gnome, Fluxbox or what? This is relevant.

Also,if the answer is yes and you're using some fancy theme for KlamAV, try to
remove the theme.




Comment 8


Wulf Krueger (RETIRED)






          2008-01-27 23:02:42 UTC
        

Please try using klamav 0.42 and let us know if the problem persists.




Comment 9


Wulf Krueger (RETIRED)






          2008-04-26 15:38:46 UTC
        

No response and works for me.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

