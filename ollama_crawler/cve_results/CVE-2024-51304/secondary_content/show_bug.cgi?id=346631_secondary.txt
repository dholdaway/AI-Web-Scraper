Title: 346631 – x11-base/xorg-server-1.9.2.901 with x11-drivers/xf86-video-intel-2.13.0: segfault
URL: https://bugs.gentoo.org/show_bug.cgi?id=346631

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 346631
x11-base/xorg-server-1.9.2.901 with x11-drivers/xf86-video-intel-2.13.0: segfault
Last modified: 2010-12-08 12:49:02 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 346631 
      - x11-base/xorg-server-1.9.2.901 with x11-drivers/xf86-video-intel-2.13.0: segfault


Summary:
x11-base/xorg-server-1.9.2.901 with x11-drivers/xf86-video-intel-2.13.0: segf...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Unspecified

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-11-24 10:41 UTC by Andrey Grozin





      Modified:
    
2010-12-08 12:49 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Xorg log

              (Xorg.0.log,25.33 KB,
                text/plain)

            
2010-11-24 10:43 UTC,

            Andrey Grozin




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andrey Grozin






          2010-11-24 10:41:20 UTC
        

Backtrace:
[   715.853] 0: /usr/bin/X (xorg_backtrace+0x3c) [0x80e91ac]
[   715.853] 1: /usr/bin/X (0x8048000+0x60401) [0x80a8401]
[   715.853] 2: (vdso) (__kernel_rt_sigreturn+0x0) [0xb78b240c]
[   715.853] 3: /usr/lib/xorg/modules/extensions/libglx.so (0xb7478000+0x42d3c) [0xb74bad3c]
[   715.853] 4: /usr/lib/xorg/modules/extensions/libdri2.so (0xb745e000+0x15e5) [0xb745f5e5]
[   715.853] 5: /usr/lib/xorg/modules/extensions/libdri2.so (DRI2SwapBuffers+0x2f4) [0xb74609b4]
[   715.853] 6: /usr/lib/xorg/modules/extensions/libdri2.so (0xb745e000+0x3d49) [0xb7461d49]
[   715.853] 7: /usr/bin/X (0x8048000+0x2a797) [0x8072797]
[   715.853] 8: /usr/bin/X (0x8048000+0x1d665) [0x8065665]
[   715.853] 9: /lib/libc.so.6 (__libc_start_main+0xe6) [0xb75b9cc6]
[   715.853] 10: /usr/bin/X (0x8048000+0x1d221) [0x8065221]
[   715.853] Segmentation fault at address 0x16d49
[   715.853] 
Fatal server error:
[   715.853] Caught signal 11 (Segmentation fault). Server aborting

X starts, the kde splash screen appears for a second or two, then X segfaults.
xorg-server-1.9.2.901 with USE="doc nptl udev xorg"
xf86-video-intel-2.13.0 with USE=dri
Hardware: Intel 82G33/G31 integrated graphics card

Oh well, had to downgrade back to xorg-server-1.7.7-r1, the last version which works (1.8.x refuse to start completely, with the message about "KMS not found", though the kernel is compiled with KMS, and xorg-server-1.7 uses it).




Comment 1


Andrey Grozin






          2010-11-24 10:43:15 UTC
        

Created attachment 255301 [details]
Xorg log




Comment 2


Andrey Grozin






          2010-11-24 10:43:58 UTC
        

elrond ~ # emerge --info
Portage 2.2.0_alpha4 (default/linux/x86/10.0/desktop/kde, gcc-4.5.1, glibc-2.12.1-r3, 2.6.36-gentoo-r1 i686)
=================================================================
System uname: Linux-2.6.36-gentoo-r1-i686-Pentium-R-_Dual-Core_CPU_E5300_@_2.60GHz-with-gentoo-2.0.1
Timestamp of tree: Mon, 22 Nov 2010 04:45:02 +0000
app-shells/bash:     4.1_p9
dev-java/java-config: 2.1.11-r2
dev-lang/python:     2.6.6-r1, 3.1.2-r4
dev-util/cmake:      2.8.1-r2
sys-apps/baselayout: 2.0.1-r1
sys-apps/openrc:     0.6.5
sys-apps/sandbox:    2.3-r1
sys-devel/autoconf:  2.13, 2.68
sys-devel/automake:  1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.4.5, 4.5.1-r1
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.4
sys-devel/make:      3.82
virtual/os-headers:  2.6.36 (sys-kernel/linux-headers)
Repositories: gentoo science sunrise lisp grozin
ACCEPT_KEYWORDS="x86 ~x86"
ACCEPT_LICENSE="*"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -march=native -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs collision-protect distlocks fixlafiles fixpackages news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS="-O2 -march=native -pipe"
GENTOO_MIRRORS="ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo"
LANG="ru_RU.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="ru"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/science /var/lib/layman/sunrise /var/lib/layman/lisp /usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="X a52 aac acpi alsa bash-completion berkdb blas boehm-gc branding browserplugin bzip2 cairo cdr consolekit cracklib crypt css cups curl cxx dbus dirac doc dri dvd dvdnav dvdr emacs enca encode exif fam ffmpeg fftw firefox flac fltk fortran gd gdbm gif gmp gpm gsl gtk hal iconv imagemagick jpeg kde kpathsea lapack latex lcms ldap leim libnotify lzma mad mikmod mmx mng modules mozilla mp3 mp4 mpeg mudflap mule ncurses nls nptl nptlonly nsplugin offensive ogg opengl openmp pam pango pcre pdf perl plotutils png ppds pppd python qt3support qt4 readline schroedinger sdl session speex spell sse sse2 ssl startup-notification svg sysfs tcl tcpd theora tiff tk truetype umfpack unicode usb v4l2 vcd vorbis win32codecs wxwidgets x264 x86 xcb xine xml xorg xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="ru" PHP_TARGETS="php5-2" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="intel" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 3


Chí-Thanh Christopher Nguyễn






          2010-11-24 11:34:27 UTC
        


(In reply to comment #0)
> [   715.853] 3: /usr/lib/xorg/modules/extensions/libglx.so (0xb7478000+0x42d3c)
> [0xb74bad3c]
> [   715.853] 4: /usr/lib/xorg/modules/extensions/libdri2.so (0xb745e000+0x15e5)

Could be a mesa related issue. Are you using compositing? Does the problem persists if you use mesa-7.9 from the x11 overlay?





Comment 4


Rémi Cardona (RETIRED)






          2010-11-24 22:27:03 UTC
        

Please try a newer kernel, possibly one from ~arch.

Thanks




Comment 5


Andrey Grozin






          2010-11-25 06:41:44 UTC
        

(In reply to comment #4)
> Please try a newer kernel, possibly one from ~arch.

elrond ~ # uname -a
Linux elrond 2.6.34-gentoo-r1 #1 SMP PREEMPT Wed Jun 30 16:29:07 NOVST 2010 i686 Pentium(R) Dual-Core CPU E5300 @ 2.60GHz GenuineIntel GNU/Linux

Isn't this sufficiently new? (thr box is pure ~x86)




Comment 6


Andrey Grozin






          2010-11-25 06:45:15 UTC
        

(In reply to comment #3)
> Could be a mesa related issue.
elrond ~ # eix media-libs/mesa
[I] media-libs/mesa
     Available versions:  7.7.1 7.8.2{tbz2} {debug +gallium kernel_FreeBSD motif +nptl pic selinux video_cards_intel video_cards_mach64 video_cards_mga video_cards_nouveau video_cards_r128 video_cards_radeon video_cards_savage video_cards_sis video_cards_sunffb video_cards_svga video_cards_tdfx video_cards_via +xcb}                
     Installed versions:  7.8.2{tbz2}(00:44:35 24.11.2010)(nptl video_cards_intel xcb -debug -gallium -kernel_FreeBSD -motif -pic -selinux -video_cards_mach64 -video_cards_mga -video_cards_nouveau -video_cards_r128 -video_cards_radeon -video_cards_savage -video_cards_sis -video_cards_svga -video_cards_tdfx -video_cards_via)        
     Homepage:            http://mesa3d.sourceforge.net/
     Description:         OpenGL-like graphic library for Linux

> Are you using compositing?
kwin is called a compositing window manager, so, I suppose, yes

> Does the problem
> persists if you use mesa-7.9 from the x11 overlay?
I'll try




Comment 7


Andrey Grozin






          2010-11-25 13:20:24 UTC
        

(In reply to comment #5)
> elrond ~ # uname -a
> Linux elrond 2.6.34-gentoo-r1 #1 SMP PREEMPT Wed Jun 30 16:29:07 NOVST 2010
> i686 Pentium(R) Dual-Core CPU E5300 @ 2.60GHz GenuineIntel GNU/Linux
Sorry, I gave wrong information. When I was trying x11-base/xorg-server-1.9.2.901, the kernel was really new:

elrond ~ # uname -a
Linux elrond 2.6.36-gentoo-r1 #1 SMP PREEMPT Wed Nov 24 22:00:12 NOVT 2010 i686 Pentium(R) Dual-Core CPU E5300 @ 2.60GHz GenuineIntel GNU/Linux

After that, the box has rebooted for some reason (in my absense), probably, due to a short power interruption. And the old kernel was still the default in grub.conf.

So, the segfault I observed was with 2.6.36-gentoo-r1, which seems sufficiently new. Sorry for confusion.




Comment 8


Rémi Cardona (RETIRED)






          2010-11-25 23:11:38 UTC
        

Like Chí-Thanh said, you might want to try a newer mesa from the x11 overlay.

Thanks




Comment 9


Andrey Grozin






          2010-11-30 08:24:50 UTC
        

OK, I've added the x11 overlay. Now X does not crash. kde starts normally. When I wanted to switch to a different desktop, it did not want to switch for a rather long time. Then I got a message from kwin that desktop effects are too slow, and they are switched off. After vthat, everything works, but without nice desktop effects.

Why these effects were not "too slow" with xorg-server-1.7 and mesa-7.8, and suddenly became too slow after the upgrade?

My current package set is

elrond ~ # eix -c media-libs/mesa
[I] media-libs/mesa (7.9@29.11.2010): OpenGL-like graphic library for Linux
[1] "x11" /var/lib/layman/x11
elrond ~ # eix -c xorg-server
[I] x11-base/xorg-server (1.9.2.901@29.11.2010): X.Org X servers
[1] "x11" /var/lib/layman/x11
elrond ~ # eix -c xf86-video-intel
[I] x11-drivers/xf86-video-intel (2.13.0@30.11.2010): X.Org driver for Intel cards
[1] "x11" /var/lib/layman/x11

The kernel is

elrond ~ # uname -a
Linux elrond 2.6.36-gentoo-r1 #1 SMP PREEMPT Wed Nov 24 22:00:12 NOVT 2010 i686 Pentium(R) Dual-Core CPU E5300 @ 2.60GHz GenuineIntel GNU/Linux




Comment 10


Andrey Grozin






          2010-12-08 12:49:02 UTC
        

Latest news from this box:
xorg-server-1.9.2.902
xf86-video-intel-2.13.0
media-libs/mesa-7.9
kde-base/kwin-4.5.4

1. If I eselect mesa classic everywhere (default), kde starts but slowly (the splash screen contains some pictures which appear gradualy, I suppose it's compositing). Then switching between virtual desktops worked for me several times, but after a minute or so I got the same notification from kwin that desktop effects are too slow and have been disabled (my kde is configured to show the rotating cube effect when switching desktops). When I exit kde, X craches:

Backtrace:
[1095505.784] 0: /usr/bin/X (xorg_backtrace+0x3c) [0x80e942c]
[1095505.784] 1: /usr/bin/X (0x8048000+0x60431) [0x80a8431]
[1095505.784] 2: (vdso) (__kernel_rt_sigreturn+0x0) [0xb789640c]
[1095505.784] 3: /usr/bin/X (FreeClientResources+0xe6) [0x80910e6]
[1095505.784] 4: /usr/bin/X (FreeAllResources+0x4c) [0x809119c]
[1095505.784] 5: /usr/bin/X (0x8048000+0x1d691) [0x8065691]
[1095505.784] 6: /lib/libc.so.6 (__libc_start_main+0xe6) [0xb759dcc6]
[1095505.784] 7: /usr/bin/X (0x8048000+0x1d221) [0x8065221]
[1095505.784] Segmentation fault at address 0x47c5
[1095505.784] 
Fatal server error:
[1095505.784] Caught signal 11 (Segmentation fault). Server aborting

2. If I eselect gallium for i915, kde starts much faster. Desktop effects work (and the rotating cube animation is faster than in classic, where it worked only a few times and slowly). So far everything seems all right.

Closing









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

