Title: 224831 – sci-libs/blas-atlas-3.8.1 - sh: -c: line 0: syntax error near unexpected token `2'
URL: https://bugs.gentoo.org/show_bug.cgi?id=224831

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 224831
sci-libs/blas-atlas-3.8.1 - sh: -c: line 0: syntax error near unexpected token `2'
Last modified: 2008-06-04 18:20:39 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 224831 
      - sci-libs/blas-atlas-3.8.1 - sh: -c: line 0: syntax error near unexpected token `2'


Summary:
sci-libs/blas-atlas-3.8.1 - sh: -c: line 0: syntax error near unexpected toke...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Development

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Science Related Packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-06-04 03:49 UTC by thewtex





      Modified:
    
2008-06-04 18:20 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


thewtex





          2008-06-04 03:49:08 UTC
        

blas-atlas is not configuring.  Core2 Quad system.

tried 3.8.0 and 3.8.1

Reproducible: Always




x86_64-pc-linux-gnu-gcc -I/var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/..//CONFIG/include  -O2 -mar
ch=nocona -pipe -DNDEBUG -c /var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/..//CONFIG/src/atlconf_misc.c
x86_64-pc-linux-gnu-gcc -I/var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/..//CONFIG/include  -O2 -march=nocona -pipe -DNDEBUG -o xconfig /var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/..//CONFIG/src/config.c atlconf_misc.o
/var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/..//CONFIG/src/config.c: In function 'ProbeF77LIB':
/var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/..//CONFIG/src/config.c:287: warning: assignment makes pointer from integer without a cast
./xconfig -d s /var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/../ -d b /var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build  -C ac x86_64-pc-linux-gnu-gcc -F ac '-O2 -march=nocona -pipe -DNDEBUG' -C if gfortran -F if -O2 -Ss pmake '$(MAKE) -j3' -Si cputhrchk 0 -b 64
sh: -c: line 0: syntax error near unexpected token `2'
sh: -c: line 0: `make IRun_OS args="-v 0 " | fgrep 'OS=' >  2>&1'

Bad OS value=0, ierr=1, ln2=''

OS configured as UNKNOWN (0)
sh: -c: line 0: syntax error near unexpected token `2'
sh: -c: line 0: `make IRun_asm args="-v 0  -O 0" | fgrep 'ASM=' >  2>&1'

Bad ASM value=0, ierr=1, ln2=''

Assembly configured as  (0)
sh: -c: line 0: syntax error near unexpected token `2'
sh: -c: line 0: `make IRun_vec args="-v 0  -O 0 -s 0" | fgrep 'VECFLAG=' >  2>&1'

Bad VECFLAG value=0, ierr=1, ln2=''

Vector ISA Extension configured as   (0,0)
sh: -c: line 0: syntax error near unexpected token `2'
sh: -c: line 0: `make IRun_arch args="-v 0  -O 0 -s 0 -a" | fgrep 'MACHTYPE=' >  2>&1'

Bad MACHTYPE value=0, ierr=1, ln2=''

Architecture configured as  UNKNOWN (0)
sh: -c: line 0: syntax error near unexpected token `2'
sh: -c: line 0: `make IRun_arch args="-v 0  -O 0 -s 0 -m" | fgrep 'CPU MHZ=' >  2>&1'

Bad CPU MHZ value=0, ierr=1, ln2=''

Clock rate configured as 0Mhz
sh: -c: line 0: syntax error near unexpected token `2'
sh: -c: line 0: `make IRun_arch args="-v 0  -O 0 -s 0 -n" | fgrep 'NCPU=' >  2>&1'

Bad NCPU value=0, ierr=1, ln2=''

Maximum number of threads configured as  0
sh: -c: line 0: syntax error near unexpected token `2'
sh: -c: line 0: `make IRun_arch args="-v 0  -O 0 -s 0 -t" | fgrep 'CPU THROTTLE=' >  2>&1'
Cannot detect CPU throttling.
/bin/sh: line 1: 19091 Segmentation fault      ./xconfig -d s /var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/../ -d b /var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build -C ac x86_64-pc-linux-gnu-gcc -F ac '-O2 -march=nocona -pipe -DNDEBUG' -C if gfortran -F if -O2 -Ss pmake '$(MAKE) -j3' -Si cputhrchk 0 -b 64
xconfig exited with 139

!!! ERROR in sci-libs/blas-atlas-3.8.1:
!!! In src_unpack at line 4061
!!! configure failed

!!! Call stack:
!!!    * src_unpack (/var/tmp/paludis/sci-libs-blas-atlas-3.8.1/temp/loadsaveenv:4061)
!!!    * ebuild_f_unpack (/usr/libexec/paludis/0/src_unpack.bash:42)
!!!    * ebuild_main (/usr/libexec/paludis/ebuild.bash:460)
!!!    * main (/usr/libexec/paludis/ebuild.bash:479)

diefunc: making ebuild PID 17533 exit with error
die trap: exiting with error.

Install error:
  * In program /usr/bin/paludis --log-level warning --continue-on-failure if-satisfied -i blas-atlas:
  * When performing install action from command line:
  * When executing install task:
  * When installing 'sci-libs/blas-atlas-3.8.1:0::gentoo':
  * Install error: Install failed for 'sci-libs/blas-atlas-3.8.1:0::gentoo'


Portage 2.1.4.4 (default-linux/amd64/2007.0/desktop, gcc-4.2.4, glibc-2.6.1-r0, 2.6.24-gentoo-r7 x86_64)
=================================================================
System uname: 2.6.24-gentoo-r7 x86_64 Intel(R) Core(TM)2 Quad CPU Q6600 @ 2.40GHz
Timestamp of tree: Wed, 04 Jun 2008 00:45:03 +0000
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p33
dev-java/java-config: 1.3.7, 2.1.6
dev-lang/python:     2.4.4-r13
dev-python/pycrypto: 2.0.1-r6
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.1
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/kde/svn/env /usr/kde/svn/share/config /usr/kde/svn/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O2 -march=native -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="ccache distlocks metadata-transfer parallel-fetch sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://gentoo.cites.uiuc.edu/pub/gentoo/ http://www.gtlib.gatech.edu/pub/gentoo http://gentoo.osuosl.org/ http://distro.ibiblio.org/pub/linux/distributions/gentoo/ "
LANG="en_US.UTF8"
LC_ALL="en_US.UTF8"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="X Xaw3d aac acl acpi aim alsa amd64 audiofile bash-completion bcmath berkdb blas bzip2 cairo cddb cdr cli cracklib crypt cups dbus dvd dvdr dvdread eds emboss encode evo examples exif fam ffmpeg fftw firefox flac fortran ftp gdbm gif glitz gphoto2 gpm graphviz gtk hal iconv imagemagick imap isdnlog jabber jack java javascript jbig jpeg jpeg2k kde kerberoslame lapack latex ldap libsamplerate mad midi mikmod mmx mp3 mpeg mplayer msn mudflap musicbrainz ncurses nls nptl nptlonly ogg opengl openmp pam pcre pdf perl plotutils png ppds pppd python qt3 qt3support qt4 quicktime readline reflection samba sdl session spell spl sse sse2 ssl svg symlink tcpd tetex tex theora tiff truetype unicode usb vcd videos vim-syntaxvorbis x264 xcomposite xml xorg xscreensaver xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="nvidia"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY



paludis --info
paludis 0.26.2
Paludis build information:
    Compiler:
        CXX:                   x86_64-pc-linux-gnu-g++ 4.2.4 (Gentoo 4.2.4 p1.0)
        CXXFLAGS:              -O2 -march=nocona -pipe -DNDEBUG
        LDFLAGS:
        DATE:                  2008-06-03T09:37:50-0500

    Libraries:
        C++ Library:           GNU libstdc++ 20080519

    Reduced Privs:
        reduced_uid:           103
        reduced_uid->name:     paludisbuild
        reduced_uid->dir:      /dev/null
        reduced_gid:           1004
        reduced_gid->name:     paludisbuild

    Paths:
        DATADIR:               /usr/share
        LIBDIR:                /usr/lib64
        LIBEXECDIR:            /usr/libexec
        SYSCONFDIR:            /etc
        PYTHONINSTALLDIR:      /usr/lib64/python2.4/site-packages
        RUBYINSTALLDIR:        /usr/lib64/ruby/site_ruby/1.8/x86_64-linux




Comment 1


Markus Dittrich (RETIRED)






          2008-06-04 13:18:03 UTC
        

Ok, t looks like you don't define any compile flags for the fortran 
compiler (FFLAGS). In this case, the ebuild will choose a default of
-O2. It seems that adding this flag without quotation marks 
causes problems on your machine (it does not on mine). I've just added
single quotes to the default FFLAGS in the ebuild and this should
hopefully fix your problem (please re-sync and try again in an hour
or so). 
Alternatively, and this is very likely what you would want to do
if you compile fortran code, you could define FFLAGS in your 
make.conf. In the simplest case you could just add FFLAGS="${CFLAGS}" 
which is what I do. 


Best,
Markus






Comment 2


thewtex





          2008-06-04 15:53:58 UTC
        

Thanks for the help.

I tried syncing and adding FFLAGS, but it is still a no-go.  The line is now

./xconfig -d s /var/tmp/paludis/sci-libs-blas-atlas-3.8.1/work/ATLAS/gentoo-build/../ -d b /var/tmp/paludis/sci-libs-blas
-atlas-3.8.1/work/ATLAS/gentoo-build  -C ac x86_64-pc-linux-gnu-gcc -F ac '-O2 -march=nocona -pipe -DNDEBUG' -C if gfortr
an -F if '-O2 -march=nocona -pipe -DNDEBUG' -Ss pmake '$(MAKE) -j3' -Si cputhrchk 0 -b 64





Comment 3


Markus Dittrich (RETIRED)






          2008-06-04 16:10:32 UTC
        

Ahh, the problem is the -DNDEBUG which completely 
confuses atlas' build system :-D

> an -F if '-O2 -march=nocona -pipe -DNDEBUG' -Ss pmake '$(MAKE) -j3' -Si

Where does it come from anyway since it is not in your make.conf 
(paludis maybe?). Please try removing it and then
it should work.

Best,
Markus




Comment 4


thewtex





          2008-06-04 16:39:09 UTC
        

Hazaa!  You nailed it.  

I didn't keep my /etc/make.conf and /etc/paludis/bashrc in sync, which is why it might have been as obvious at first.  Sorry about that.  

Maybe the ebuild can do more advanced parsing of compiler flags since atlas is so particular?

Thanks for your help.




Comment 5


Markus Dittrich (RETIRED)






          2008-06-04 18:20:39 UTC
        

(In reply to comment #4)
> Hazaa!  You nailed it.  

Excellent!

> Maybe the ebuild can do more advanced parsing of compiler flags since atlas is
> so particular?

Compiler flags can be filtered if there are some known problems.
However, users should never add pre-processor directives to their 
CFLAGS since their effect on individual packages
is completely undefined. These directives should only be added by
the packages' build systems or maybe the ebuild itself in certain cases.

I am glad everything works for you again.

Best,
Markus











Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

