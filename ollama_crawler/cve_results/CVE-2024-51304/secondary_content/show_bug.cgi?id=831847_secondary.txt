Title: 831847 – dev-qt/qtwebengine-5.15.2_p20211216 fails to compile on dav1d components
URL: https://bugs.gentoo.org/show_bug.cgi?id=831847

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 831847
dev-qt/qtwebengine-5.15.2_p20211216 fails to compile on dav1d components
Last modified: 2022-04-10 11:49:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 831847 
      - dev-qt/qtwebengine-5.15.2_p20211216 fails to compile on dav1d components


Summary:
dev-qt/qtwebengine-5.15.2_p20211216 fails to compile on dav1d components
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Qt Bug Alias








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2022-01-22 20:17 UTC by Stefan de Konink





      Modified:
    
2022-04-10 11:49 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log.gz,100.82 KB,
                application/gzip)

            
2022-01-22 20:18 UTC,

            Stefan de Konink




Details





build.log for gcc

              (build-gcc.log.gz,227.23 KB,
                application/gzip)

            
2022-01-22 21:02 UTC,

            Stefan de Konink




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Stefan de Konink





          2022-01-22 20:17:55 UTC
        

Both GCC and CLANG fail on the dav1d third party components. 

[2831/22994] /usr/lib/llvm/13/bin/clang -MMD -MF obj/third_party/dav1d/dav1d/cdf.o.d -DUSE_UDEV -DUSE_AURA=1 -DUSE_NSS_CERTS=1 -DUSE_OZONE=1 -DOFFICIAL_BUILD -DTOOLKIT_QT -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -DNO_UNWIND_TABLES -DNDEBUG -DNVALGRIND -DDYNAMIC_ANNOTATIONS_ENABLED=0 -DCONFIG_LOG=0 -DSTACK_ALIGNMENT=32 -DDAV1D_API= -DCONFIG_LOG=0 -DSTACK_ALIGNMENT=32 -DDAV1D_API= -Igen -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/libdav1d -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/libdav1d/include -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/libdav1d/include/dav1d -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/config/linux/x64 -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/version -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/version -D_FILE_OFFSET_BITS=64 -D_POSIX_C_SOURCE=200112L -std=c99 -mpreferred-stack-boundary=5 -D_GNU_SOURCE -fno-strict-aliasing --param=ssp-buffer-size=4 -fstack-protector -fno-unwind-tables -fno-asynchronous-unwind-tables -fPIC -pipe -pthread -m64 -O2 -fno-ident -fdata-sections -ffunction-sections -fno-omit-frame-pointer -g0 -fvisibility=hidden -Wno-unused-local-typedefs -Wno-maybe-uninitialized -Wno-deprecated-declarations -fno-delete-null-pointer-checks -Wno-comments -Wno-packed-not-aligned -Wno-dangling-else -Wno-missing-field-initializers -Wno-unused-parameter -std=gnu11 -c ../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/libdav1d/src/cdf.c -o obj/third_party/dav1d/dav1d/cdf.o
FAILED: obj/third_party/dav1d/dav1d/cdf.o

Reproducible: Always




Portage 3.0.30 (python 3.10.1-final-0, default/linux/amd64/17.1/no-multilib, gcc-11.2.1, glibc-2.34-r6, 5.16.1-gentoo x86_64)
=================================================================
System uname: Linux-5.16.1-gentoo-x86_64-AMD_Ryzen_5_2500U_with_Radeon_Vega_Mobile_Gfx-with-glibc2.34
KiB Mem:    16090876 total,   1556616 free
KiB Swap:   33554428 total,  33537276 free
Timestamp of repository gentoo: Sat, 22 Jan 2022 19:30:01 +0000
Head commit of repository gentoo: c9872fbcc1a78102cec8073d6309f550e5c949ab
sh bash 5.1_p16
ld GNU ld (Gentoo 2.37_p1 p1) 2.37
ccache version 4.5.1 [disabled]
app-misc/pax-utils:        1.3.3::gentoo
app-shells/bash:           5.1_p16::gentoo
dev-java/java-config:      2.3.1::gentoo
dev-lang/perl:             5.34.0-r6::gentoo
dev-lang/python:           2.7.18_p13::gentoo, 3.7.12_p1::gentoo, 3.8.12_p1-r1::gentoo, 3.9.9-r1::gentoo, 3.10.1-r1::gentoo, 3.11.0_alpha3::gentoo
dev-lang/rust:             1.57.0::gentoo
dev-util/ccache:           4.5.1::gentoo
dev-util/cmake:            3.22.1::gentoo
dev-util/meson:            0.60.3::gentoo
sys-apps/baselayout:       2.8::gentoo
sys-apps/openrc:           0.41.2::gentoo
sys-apps/sandbox:          2.29::gentoo
sys-apps/systemd:          250.2::gentoo
sys-devel/autoconf:        2.13-r1::gentoo, 2.69-r5::gentoo, 2.71-r1::gentoo
sys-devel/automake:        1.16.5::gentoo
sys-devel/binutils:        2.37_p1-r1::gentoo
sys-devel/binutils-config: 5.4::gentoo
sys-devel/clang:           11.1.0::gentoo, 12.0.1::gentoo, 13.0.0::gentoo
sys-devel/gcc:             10.3.0::gentoo, 11.2.1_p20211127::gentoo
sys-devel/gcc-config:      2.5-r1::gentoo
sys-devel/libtool:         2.4.6-r6::gentoo
sys-devel/lld:             13.0.0::gentoo
sys-devel/llvm:            11.1.0::gentoo, 12.0.1::gentoo, 13.0.0::gentoo
sys-devel/make:            4.3::gentoo
sys-kernel/linux-headers:  5.16::gentoo (virtual/os-headers)
sys-libs/glibc:            2.34-r6::gentoo
Repositories:

gentoo
    location: /var/db/repos/gentoo
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-jobs: 1
    sync-rsync-verify-metamanifest: yes
    sync-rsync-extra-opts: 

2xsaiko
    location: /var/lib/layman/2xsaiko
    masters: gentoo
    priority: 50

4nykey
    location: /var/lib/layman/4nykey
    masters: gentoo
    priority: 50

Drauthius
    location: /var/lib/layman/Drauthius
    masters: gentoo
    priority: 50

booboo
    location: /var/lib/layman/booboo
    masters: gentoo
    priority: 50

d3-gentoo
    location: /var/lib/layman/d3-gentoo
    masters: gentoo
    priority: 50

darthgandalf-overlay
    location: /var/lib/layman/darthgandalf-overlay
    masters: gentoo
    priority: 50

dotnet
    location: /var/lib/layman/dotnet
    masters: gentoo
    priority: 50

flammie
    location: /var/lib/layman/flammie
    masters: gentoo
    priority: 50

flavour
    location: /var/lib/layman/flavour
    masters: gentoo
    priority: 50

fordfrog
    location: /var/lib/layman/fordfrog
    masters: gentoo
    priority: 50

gentoo-zh
    location: /var/lib/layman/gentoo-zh
    masters: gentoo
    priority: 50

imaging
    location: /var/lib/layman/imaging
    masters: gentoo
    priority: 50

lto-overlay
    location: /var/lib/layman/lto-overlay
    masters: gentoo mv
    priority: 50

mv
    location: /var/lib/layman/mv
    masters: gentoo
    priority: 50

raiagent
    location: /var/lib/layman/raiagent
    masters: gentoo
    priority: 50

salfter
    location: /var/lib/layman/salfter
    masters: gentoo
    priority: 50

science
    location: /var/lib/layman/science
    masters: gentoo
    priority: 50

FireBurn
    location: /var/lib/layman/FireBurn
    masters: gentoo
    priority: 60

ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CC="clang"
CFLAGS="-O2 -march=znver1 -O2 -pipe -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/maven-bin-3.6/conf /usr/share/maven-bin-3.8/conf"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXX="clang++"
CXXFLAGS="-O2 -march=znver1 -O2 -pipe -pipe"
DISTDIR="/var/cache/distfiles"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -march=znver1 -O2 -pipe -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs binpkg-multi-instance buildpkg-live config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -march=znver1 -O2 -pipe -pipe"
GENTOO_MIRRORS="http://mirror.leaseweb.com/gentoo/ http://ftp.snt.utwente.nl/pub/os/linux/gentoo"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j7"
PKGDIR="/var/cache/binpkgs"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
SHELL="/bin/bash"
USE="X aac acl adwaita-icon-theme alsa amd64 apng aptx autohint avif bluetooth bluray brotli bzip2 cairo caps clang cli codec2 color-management corefonts cpudetection crypt curl dav1d dbus designer dri dri3 echo-cancel exif exiv2 ffmpeg fftw fontconfig fortran gdal gdbm geos gimp gles2 glslang gold graphite gtk gtk3 hackrf harfbuzz heif http2 hunspell iconv icu infinality ipv6 jpeg jpeg2k jumbo-build krita ladspa lapack lcms libglvnd libnotify libsamplerate libtirpc lm-sensors lto lv2 lz4 lzma minizip ncurses nptl ntfs ogg opencv openexr opengl openmp optimization opus orc pam pcre pdf pgo pipewire png policykit postgres qml qt5 readline rtlsdr rubberband screencast seccomp sftp sndfile speex split-usr sqlite srt ssl startup-notification strong-optimization svg synaptics system-bootstrap system-jsoncpp system-libvpx system-llvm systemd sysv-utils theora tiff tracepath truetype udev unicode upower user-session v4l vaapi vdpau vim-syntax vorbis vpx vulkan wayland webp webstart woff2 x264 x265 xattr xinerama xrandr zeromq zlib zstd" ABI_X86="64" ADA_TARGET="gnat_2020" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt sha sse sse2 sse3 sse4_1 sse4_2 sse4a ssse3" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput" KERNEL="linux" L10N="en nl" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LLVM_TARGETS="AMDGPU BPF WebAssembly" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-4 php8-0" POSTGRES_TARGETS="postgres13" PYTHON_SINGLE_TARGET="python3_8" PYTHON_TARGETS="python2_7 python3_8 python3_9 python3_10" RUBY_TARGETS="ruby27 ruby30" USERLAND="GNU" UWSGI_PLUGINS="cache carbon cheaper_busyness corerouter fastrouter http logfile logsocket mongodblog nagios ping rawrouter redislog router_basicauth router_cache router_expires router_hash router_http router_memcached router_metrics router_redirect router_redis router_rewrite router_static router_uwsgi rpc signal spooler symcall syslog transformation_chunked transformation_gzip transformation_offload transformation_tofile ugreen zergpool" VIDEO_CARDS="amdgpu radeonsi radeon" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq proto steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  ADDR2LINE, AR, ARFLAGS, AS, ASFLAGS, CCLD, CONFIG_SHELL, CPP, CPPFLAGS, CTARGET, CXXFILT, ELFEDIT, EMERGE_DEFAULT_OPTS, EXTRA_ECONF, F77FLAGS, FC, GCOV, GPROF, INSTALL_MASK, LC_ALL, LD, LEX, LFLAGS, LIBTOOL, LINGUAS, MAKE, MAKEFLAGS, NM, OBJCOPY, OBJDUMP, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, RANLIB, READELF, RUSTFLAGS, SIZE, STRINGS, STRIP, YACC, YFLAGS




Comment 1


Stefan de Konink





          2022-01-22 20:18:18 UTC
        

Created attachment 763292 [details]
build.log




Comment 2


Sam James









          2022-01-22 20:22:51 UTC
        

[31mFAILED: [0mobj/third_party/dav1d/dav1d/cdf.o 
/usr/lib/llvm/13/bin/clang -MMD -MF obj/third_party/dav1d/dav1d/cdf.o.d -DUSE_UDEV -DUSE_AURA=1 -DUSE_NSS_CERTS=1 -DUSE_OZONE=1 -DOFFICIAL_BUILD -DTOOLKIT_QT -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -DNO_UNWIND_TABLES -DNDEBUG -DNVALGRIND -DDYNAMIC_ANNOTATIONS_ENABLED=0 -DCONFIG_LOG=0 -DSTACK_ALIGNMENT=32 -DDAV1D_API= -DCONFIG_LOG=0 -DSTACK_ALIGNMENT=32 -DDAV1D_API= -Igen -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/libdav1d -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/libdav1d/include -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/libdav1d/include/dav1d -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/config/linux/x64 -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/version -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/version -D_FILE_OFFSET_BITS=64 -D_POSIX_C_SOURCE=200112L -std=c99 -mpreferred-stack-boundary=5 -D_GNU_SOURCE -fno-strict-aliasing --param=ssp-buffer-size=4 -fstack-protector -fno-unwind-tables -fno-asynchronous-unwind-tables -fPIC -pipe -pthread -m64 -O2 -fno-ident -fdata-sections -ffunction-sections -fno-omit-frame-pointer -g0 -fvisibility=hidden -Wno-unused-local-typedefs -Wno-maybe-uninitialized -Wno-deprecated-declarations -fno-delete-null-pointer-checks -Wno-comments -Wno-packed-not-aligned -Wno-dangling-else -Wno-missing-field-initializers -Wno-unused-parameter -std=gnu11 -c ../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/third_party/dav1d/libdav1d/src/cdf.c -o obj/third_party/dav1d/dav1d/cdf.o
clang-13: error: unknown argument: '-mpreferred-stack-boundary=5'

How does it fail with GCC?




Comment 3


Stefan de Konink





          2022-01-22 21:02:37 UTC
        

Created attachment 763293 [details]
build.log for gcc

GCC fails on;

[7859/22717] /usr/bin/x86_64-pc-linux-gnu-g++ -MMD -MF obj/v8/v8_compiler/v8_compiler_jumbo_2.o.d -DUSE_UDEV -DUSE_AURA=1 -DUSE_NSS_CERTS=1 -DUSE_OZONE=1 -DOFFICIAL_BUILD -DTOOLKIT_QT -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -DNO_UNWIND_TABLES -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -DNDEBUG -DNVALGRIND -DDYNAMIC_ANNOTATIONS_ENABLED=0 -DV8_TYPED_ARRAY_MAX_SIZE_IN_HEAP=64 -DENABLE_MINOR_MC -DV8_INTL_SUPPORT -DV8_CONCURRENT_MARKING -DV8_ENABLE_LAZY_SOURCE_POSITIONS -DV8_WIN64_UNWINDING_INFO -DV8_ENABLE_REGEXP_INTERPRETER_THREADED_DISPATCH -DV8_SNAPSHOT_COMPRESSION -DV8_COMPRESS_POINTERS -DV8_31BIT_SMIS_ON_64BIT_ARCH -DV8_DEPRECATION_WARNINGS -DV8_REVERSE_JSARGS -DV8_TARGET_ARCH_X64 -DV8_HAVE_TARGET_OS -DV8_TARGET_OS_LINUX -DDISABLE_UNTRUSTED_CODE_MITIGATIONS -DV8_COMPRESS_POINTERS -DV8_31BIT_SMIS_ON_64BIT_ARCH -DV8_DEPRECATION_WARNINGS -DV8_REVERSE_JSARGS -DUSING_SYSTEM_ICU=1 -DICU_UTIL_DATA_IMPL=ICU_UTIL_DATA_STATIC -DUCHAR_TYPE=uint16_t -I. -Igen -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/v8 -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/v8/include -Igen/v8 -Igen -Igen -fno-strict-aliasing --param=ssp-buffer-size=4 -fstack-protector -fno-unwind-tables -fno-asynchronous-unwind-tables -fPIC -pipe -pthread -m64 -Wall -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Wno-unused-local-typedefs -Wno-maybe-uninitialized -Wno-deprecated-declarations -fno-delete-null-pointer-checks -Wno-comments -Wno-packed-not-aligned -Wno-dangling-else -Wno-missing-field-initializers -Wno-unused-parameter -fno-omit-frame-pointer -g0 -fvisibility=hidden -Wno-strict-overflow -Wno-return-type -O3 -fno-ident -fdata-sections -ffunction-sections -std=gnu++14 -Wno-narrowing -Wno-class-memaccess -Wno-attributes -Wno-class-memaccess -Wno-subobject-linkage -Wno-invalid-offsetof -Wno-return-type -Wno-deprecated-copy -fno-exceptions -fno-rtti -fvisibility-inlines-hidden -c gen/v8/v8_compiler_jumbo_2.cc -o obj/v8/v8_compiler/v8_compiler_jumbo_2.o
FAILED: obj/v8/v8_compiler/v8_compiler_jumbo_2.o




Comment 4


Sam James









          2022-01-22 21:16:10 UTC
        

(In reply to Stefan de Konink from comment #3)
> Created attachment 763293 [details]
> build.log for gcc
> 
> GCC fails on;
> 
> [7859/22717] /usr/bin/x86_64-pc-linux-gnu-g++ -MMD -MF
> obj/v8/v8_compiler/v8_compiler_jumbo_2.o.d -DUSE_UDEV -DUSE_AURA=1
> -DUSE_NSS_CERTS=1 -DUSE_OZONE=1 -DOFFICIAL_BUILD -DTOOLKIT_QT
> -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE
> -DNO_UNWIND_TABLES -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -DNDEBUG
> -DNVALGRIND -DDYNAMIC_ANNOTATIONS_ENABLED=0
> -DV8_TYPED_ARRAY_MAX_SIZE_IN_HEAP=64 -DENABLE_MINOR_MC -DV8_INTL_SUPPORT
> -DV8_CONCURRENT_MARKING -DV8_ENABLE_LAZY_SOURCE_POSITIONS
> -DV8_WIN64_UNWINDING_INFO -DV8_ENABLE_REGEXP_INTERPRETER_THREADED_DISPATCH
> -DV8_SNAPSHOT_COMPRESSION -DV8_COMPRESS_POINTERS
> -DV8_31BIT_SMIS_ON_64BIT_ARCH -DV8_DEPRECATION_WARNINGS -DV8_REVERSE_JSARGS
> -DV8_TARGET_ARCH_X64 -DV8_HAVE_TARGET_OS -DV8_TARGET_OS_LINUX
> -DDISABLE_UNTRUSTED_CODE_MITIGATIONS -DV8_COMPRESS_POINTERS
> -DV8_31BIT_SMIS_ON_64BIT_ARCH -DV8_DEPRECATION_WARNINGS -DV8_REVERSE_JSARGS
> -DUSING_SYSTEM_ICU=1 -DICU_UTIL_DATA_IMPL=ICU_UTIL_DATA_STATIC
> -DUCHAR_TYPE=uint16_t -I. -Igen
> -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium
> -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/v8
> -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/v8/include
> -Igen/v8 -Igen -Igen -fno-strict-aliasing --param=ssp-buffer-size=4
> -fstack-protector -fno-unwind-tables -fno-asynchronous-unwind-tables -fPIC
> -pipe -pthread -m64 -Wall -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2
> -Wno-unused-local-typedefs -Wno-maybe-uninitialized
> -Wno-deprecated-declarations -fno-delete-null-pointer-checks -Wno-comments
> -Wno-packed-not-aligned -Wno-dangling-else -Wno-missing-field-initializers
> -Wno-unused-parameter -fno-omit-frame-pointer -g0 -fvisibility=hidden
> -Wno-strict-overflow -Wno-return-type -O3 -fno-ident -fdata-sections
> -ffunction-sections -std=gnu++14 -Wno-narrowing -Wno-class-memaccess
> -Wno-attributes -Wno-class-memaccess -Wno-subobject-linkage
> -Wno-invalid-offsetof -Wno-return-type -Wno-deprecated-copy -fno-exceptions
> -fno-rtti -fvisibility-inlines-hidden -c gen/v8/v8_compiler_jumbo_2.cc -o
> obj/v8/v8_compiler/v8_compiler_jumbo_2.o
> FAILED: obj/v8/v8_compiler/v8_compiler_jumbo_2.o

Error's quite different for GCC:

./../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/v8/src/compiler/simd-scalar-lowering.cc: In function 'int v8::internal::compiler::GetReturnCountAfterLoweringSimd128(const v8::internal::compiler::CallDescriptor*)':
./../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/v8/src/compiler/simd-scalar-lowering.cc:475:37: error: call of overloaded 'GetReturnIndexAfterLowering(const v8::internal::compiler::CallDescriptor*&, int)' is ambiguous
  475 |   return GetReturnIndexAfterLowering(
      |          ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
  476 |       call_descriptor, static_cast<int>(call_descriptor->ReturnCount()));
      |       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




Comment 5


Sam James









          2022-01-22 21:16:39 UTC
        

(probably worth filing a separate bug for one of them, maybe the gcc one?)




Comment 6


Stephan Hartmann (RETIRED)






          2022-01-23 13:35:13 UTC
        

You need to set EXTRA_GN="is_clang=true" in your environment for building with clang, otherwise wrong flags are passed, e.g.:

https://chromium.googlesource.com/chromium/src.git/+/refs/heads/main/third_party/dav1d/BUILD.gn#55




Comment 7


Stefan de Konink





          2022-01-23 14:15:51 UTC
        

It then fails for me even earlier.

[3/23894] /usr/lib/llvm/13/bin/clang -MMD -MF obj/base/third_party/dynamic_annotations/dynamic_annotations/dynamic_annotations.o.d -DUSE_UDEV -DUSE_AURA=1 -DUSE_NSS_CERTS=1 -DUSE_OZONE=1 -DOFFICIAL_BUILD -DTOOLKIT_QT -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -DNO_UNWIND_TABLES -D_GNU_SOURCE -DCR_CLANG_REVISION=\"llvmorg-12-init-5035-gd0abc757-3\" -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -DNDEBUG -DNVALGRIND -DDYNAMIC_ANNOTATIONS_ENABLED=0 -Igen -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium -fno-strict-aliasing --param=ssp-buffer-size=4 -fstack-protector -Wno-unknown-attributes -Wno-unknown-pragmas -Wno-unknown-warning-option -fno-unwind-tables -fno-asynchronous-unwind-tables -fPIC -pthread -fcolor-diagnostics -fmerge-all-constants -m64 -no-canonical-prefixes -Wall -Wextra -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Wimplicit-fallthrough -Wunreachable-code -Wthread-safety -Wextra-semi -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-psabi -Wno-ignored-pragma-optimize -Wno-implicit-int-float-conversion -Wno-final-dtor-non-final-class -Wno-builtin-assume-aligned-alignment -Wno-deprecated-copy -Wno-non-c-typedef-for-linkage -Wno-max-tokens -O2 -fno-ident -fdata-sections -ffunction-sections -fno-omit-frame-pointer -g0 -fvisibility=hidden -Xclang -add-plugin -Xclang find-bad-constructs -Xclang -plugin-arg-find-bad-constructs -Xclang check-ipc -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -std=c11 -Wno-implicit-fallthrough -c ../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/base/third_party/dynamic_annotations/dynamic_annotations.c -o obj/base/third_party/dynamic_annotations/dynamic_annotations/dynamic_annotations.o
FAILED: obj/base/third_party/dynamic_annotations/dynamic_annotations/dynamic_annotations.o 
/usr/lib/llvm/13/bin/clang -MMD -MF obj/base/third_party/dynamic_annotations/dynamic_annotations/dynamic_annotations.o.d -DUSE_UDEV -DUSE_AURA=1 -DUSE_NSS_CERTS=1 -DUSE_OZONE=1 -DOFFICIAL_BUILD -DTOOLKIT_QT -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -DNO_UNWIND_TABLES -D_GNU_SOURCE -DCR_CLANG_REVISION=\"llvmorg-12-init-5035-gd0abc757-3\" -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -DNDEBUG -DNVALGRIND -DDYNAMIC_ANNOTATIONS_ENABLED=0 -Igen -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium -fno-strict-aliasing --param=ssp-buffer-size=4 -fstack-protector -Wno-unknown-attributes -Wno-unknown-pragmas -Wno-unknown-warning-option -fno-unwind-tables -fno-asynchronous-unwind-tables -fPIC -pthread -fcolor-diagnostics -fmerge-all-constants -m64 -no-canonical-prefixes -Wall -Wextra -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Wimplicit-fallthrough -Wunreachable-code -Wthread-safety -Wextra-semi -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-psabi -Wno-ignored-pragma-optimize -Wno-implicit-int-float-conversion -Wno-final-dtor-non-final-class -Wno-builtin-assume-aligned-alignment -Wno-deprecated-copy -Wno-non-c-typedef-for-linkage -Wno-max-tokens -O2 -fno-ident -fdata-sections -ffunction-sections -fno-omit-frame-pointer -g0 -fvisibility=hidden -Xclang -add-plugin -Xclang find-bad-constructs -Xclang -plugin-arg-find-bad-constructs -Xclang check-ipc -Wheader-hygiene -Wstring-conversion -Wtautological-overlap-compare -std=c11 -Wno-implicit-fallthrough -c ../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/base/third_party/dynamic_annotations/dynamic_annotations.c -o obj/base/third_party/dynamic_annotations/dynamic_annotations/dynamic_annotations.o
error: unable to find plugin 'find-bad-constructs'
1 error generated.




Comment 8


Stephan Hartmann (RETIRED)






          2022-01-23 14:27:11 UTC
        

(In reply to Stefan de Konink from comment #7)
> It then fails for me even earlier.
> 
> [3/23894] /usr/lib/llvm/13/bin/clang -MMD -MF
> obj/base/third_party/dynamic_annotations/dynamic_annotations/
> dynamic_annotations.o.d -DUSE_UDEV -DUSE_AURA=1 -DUSE_NSS_CERTS=1
> -DUSE_OZONE=1 -DOFFICIAL_BUILD -DTOOLKIT_QT -D_FILE_OFFSET_BITS=64
> -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -DNO_UNWIND_TABLES -D_GNU_SOURCE
> -DCR_CLANG_REVISION=\"llvmorg-12-init-5035-gd0abc757-3\"
> -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -DNDEBUG -DNVALGRIND
> -DDYNAMIC_ANNOTATIONS_ENABLED=0 -Igen
> -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium
> -fno-strict-aliasing --param=ssp-buffer-size=4 -fstack-protector
> -Wno-unknown-attributes -Wno-unknown-pragmas -Wno-unknown-warning-option
> -fno-unwind-tables -fno-asynchronous-unwind-tables -fPIC -pthread
> -fcolor-diagnostics -fmerge-all-constants -m64 -no-canonical-prefixes -Wall
> -Wextra -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Wimplicit-fallthrough
> -Wunreachable-code -Wthread-safety -Wextra-semi
> -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing
> -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-psabi
> -Wno-ignored-pragma-optimize -Wno-implicit-int-float-conversion
> -Wno-final-dtor-non-final-class -Wno-builtin-assume-aligned-alignment
> -Wno-deprecated-copy -Wno-non-c-typedef-for-linkage -Wno-max-tokens -O2
> -fno-ident -fdata-sections -ffunction-sections -fno-omit-frame-pointer -g0
> -fvisibility=hidden -Xclang -add-plugin -Xclang find-bad-constructs -Xclang
> -plugin-arg-find-bad-constructs -Xclang check-ipc -Wheader-hygiene
> -Wstring-conversion -Wtautological-overlap-compare -std=c11
> -Wno-implicit-fallthrough -c
> ../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/base/
> third_party/dynamic_annotations/dynamic_annotations.c -o
> obj/base/third_party/dynamic_annotations/dynamic_annotations/
> dynamic_annotations.o
> FAILED:
> obj/base/third_party/dynamic_annotations/dynamic_annotations/
> dynamic_annotations.o 
> /usr/lib/llvm/13/bin/clang -MMD -MF
> obj/base/third_party/dynamic_annotations/dynamic_annotations/
> dynamic_annotations.o.d -DUSE_UDEV -DUSE_AURA=1 -DUSE_NSS_CERTS=1
> -DUSE_OZONE=1 -DOFFICIAL_BUILD -DTOOLKIT_QT -D_FILE_OFFSET_BITS=64
> -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -DNO_UNWIND_TABLES -D_GNU_SOURCE
> -DCR_CLANG_REVISION=\"llvmorg-12-init-5035-gd0abc757-3\"
> -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -DNDEBUG -DNVALGRIND
> -DDYNAMIC_ANNOTATIONS_ENABLED=0 -Igen
> -I../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium
> -fno-strict-aliasing --param=ssp-buffer-size=4 -fstack-protector
> -Wno-unknown-attributes -Wno-unknown-pragmas -Wno-unknown-warning-option
> -fno-unwind-tables -fno-asynchronous-unwind-tables -fPIC -pthread
> -fcolor-diagnostics -fmerge-all-constants -m64 -no-canonical-prefixes -Wall
> -Wextra -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -Wimplicit-fallthrough
> -Wunreachable-code -Wthread-safety -Wextra-semi
> -Wno-missing-field-initializers -Wno-unused-parameter -Wno-c++11-narrowing
> -Wno-unneeded-internal-declaration -Wno-undefined-var-template -Wno-psabi
> -Wno-ignored-pragma-optimize -Wno-implicit-int-float-conversion
> -Wno-final-dtor-non-final-class -Wno-builtin-assume-aligned-alignment
> -Wno-deprecated-copy -Wno-non-c-typedef-for-linkage -Wno-max-tokens -O2
> -fno-ident -fdata-sections -ffunction-sections -fno-omit-frame-pointer -g0
> -fvisibility=hidden -Xclang -add-plugin -Xclang find-bad-constructs -Xclang
> -plugin-arg-find-bad-constructs -Xclang check-ipc -Wheader-hygiene
> -Wstring-conversion -Wtautological-overlap-compare -std=c11
> -Wno-implicit-fallthrough -c
> ../../../../qtwebengine-5.15.2_p20211216/src/3rdparty/chromium/base/
> third_party/dynamic_annotations/dynamic_annotations.c -o
> obj/base/third_party/dynamic_annotations/dynamic_annotations/
> dynamic_annotations.o
> error: unable to find plugin 'find-bad-constructs'
> 1 error generated.

Sorry, forgot the plugins, try:
  EXTRA_GN="is_clang=true clang_use_chrome_plugins=false"




Comment 9


Stefan de Konink





          2022-01-23 18:47:27 UTC
        

(In reply to Stephan Hartmann from comment #8)
> Sorry, forgot the plugins, try:
>   EXTRA_GN="is_clang=true clang_use_chrome_plugins=false"

Thanks for your support. Compilation took a while, but is the first time in months this thing compiled. So for clang this works. Allows me to do stuff with pyside again.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

