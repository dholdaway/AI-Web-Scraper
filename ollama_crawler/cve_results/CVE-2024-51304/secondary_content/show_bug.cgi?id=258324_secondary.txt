Title: 258324 – media-sound/phonon-4.3.0 fails to compile with gstreamer USE flag
URL: https://bugs.gentoo.org/show_bug.cgi?id=258324

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 258324
media-sound/phonon-4.3.0 fails to compile with gstreamer USE flag
Last modified: 2010-02-28 10:32:49 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 258324 
      - media-sound/phonon-4.3.0 fails to compile with gstreamer USE flag


Summary:
media-sound/phonon-4.3.0 fails to compile with gstreamer USE flag
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-02-09 12:56 UTC by bay





      Modified:
    
2010-02-28 10:32 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



frossie
icestar









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




full build log

              (build.log,46.36 KB,
                text/plain)

            
2009-02-09 13:02 UTC,

            bay




Details





full build log

              (build.log,46.36 KB,
                text/plain)

            
2009-02-09 13:06 UTC,

            bay




Details





full build log

              (build.log,46.36 KB,
                text/plain)

            
2009-02-09 13:06 UTC,

            bay




Details





full build log

              (build.log,46.36 KB,
                text/plain)

            
2009-02-09 13:10 UTC,

            bay




Details





media-sound/phonon-4.3.1 build log file

              (build.log,15.58 KB,
                text/plain)

            
2009-06-08 14:39 UTC,

            Dmitry Bigunyak




Details





media-sound/phonon-4.3.1 build log file (english version)

              (build.log,15.27 KB,
                text/plain)

            
2009-06-08 14:58 UTC,

            Dmitry Bigunyak




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


bay





          2009-02-09 12:56:47 UTC
        

when i try to emerge phonon i get this:

[ 39%] Building CXX object phonon/experimental/CMakeFiles/phononexperimental.dir/audiodataoutput.cpp.o                            
In file included from /usr/include/glib-2.0/glib/glist.h:34,                                                                      
                 from /usr/include/glib-2.0/glib/gcache.h:34,                                                                     
                 from /usr/include/glib-2.0/glib.h:39,                                                                            
                 from /usr/include/gstreamer-0.10/gst/gst.h:27,                                                                   
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/../../phonon-4.3.0/gstreamer/effectmanager.h:27,                                                                                                                        
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/moc_effectmanager.cpp:10,             
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/phonon_gstreamer_automoc.cpp:4:       
/usr/include/glib-2.0/glib/gmem.h:42:5: warning: "GLIB_SIZEOF_VOID_P" is not defined                                              
/usr/include/glib-2.0/glib/gmem.h:42:26: warning: "GLIB_SIZEOF_LONG" is not defined                                               
In file included from /usr/include/glib-2.0/gobject/gboxed.h:26,                                                                  
                 from /usr/include/glib-2.0/glib-object.h:25,                                                                     
                 from /usr/include/gstreamer-0.10/gst/gstenumtypes.h:7,                                                           
                 from /usr/include/gstreamer-0.10/gst/gst.h:31,                                                                   
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/../../phonon-4.3.0/gstreamer/effectmanager.h:27,                                                                                                                        
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/moc_effectmanager.cpp:10,             
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/phonon_gstreamer_automoc.cpp:4:       
/usr/include/glib-2.0/gobject/gtype.h:366:9: warning: "GLIB_SIZEOF_SIZE_T" is not defined                                         
/usr/include/glib-2.0/gobject/gtype.h:366:31: warning: "GLIB_SIZEOF_LONG" is not defined                                          
[ 40%] Building CXX object xine/CMakeFiles/phonon_xine.dir/sourcenode.cpp.o                                                       
[ 41%] Building CXX object phonon/experimental/CMakeFiles/phononexperimental.dir/audioformat.cpp.o                                
In file included from /usr/include/glib-2.0/glib/galloca.h:34,                                                                    
                 from /usr/include/glib-2.0/glib.h:32,                                                                            
                 from /usr/include/gstreamer-0.10/gst/gst.h:27,                                                                   
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/../../phonon-4.3.0/gstreamer/effectmanager.h:27,                                                                                                                        
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/moc_effectmanager.cpp:10,             
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/phonon_gstreamer_automoc.cpp:4:       
/usr/include/glib-2.0/glib/gtypes.h:45: error: expected constructor, destructor, or type conversion before 'typedef'              
/usr/include/glib-2.0/glib/gtypes.h:94: error: expected initializer before '*' token                                              
/usr/include/glib-2.0/glib/gtypes.h:407: error: 'G_END_DECLS' does not name a type                                                
In file included from /usr/include/glib-2.0/glib.h:33,                                                                            
                 from /usr/include/gstreamer-0.10/gst/gst.h:27,                                                                   
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/../../phonon-4.3.0/gstreamer/effectmanager.h:27,                                                                                                                        
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/moc_effectmanager.cpp:10,             
                 from /var/tmp/portage/media-sound/phonon-4.3.0/work/phonon_build/gstreamer/phonon_gstreamer_automoc.cpp:4:       
/usr/include/glib-2.0/glib/garray.h:44: error: ISO C++ forbids declaration of 'gchar' with no type                                
/usr/include/glib-2.0/glib/garray.h:44: error: expected ';' before '*' token

Reproducible: Always

Steps to Reproduce:
1. emerge =media-sound/phonon-4.3.0




Portage 2.2_rc23 (default/linux/amd64/2008.0/desktop, gcc-4.3.3, glibc-2.9_p20081201-r1, 2.6.28-gentoo-r1 x86_64)
=================================================================                                                
System uname: Linux-2.6.28-gentoo-r1-x86_64-AMD_Athlon-tm-_64_X2_Dual_Core_Processor_4600+-with-glibc2.2.5       
Timestamp of tree: Sun, 08 Feb 2009 01:45:01 +0000                                                               
ccache version 2.4 [disabled]                                                                                    
app-shells/bash:     3.2_p48                                                                                     
dev-java/java-config: 1.3.7-r1, 2.1.6-r1                                                                         
dev-lang/python:     2.4.4-r13, 2.5.4-r1                                                                         
dev-python/pycrypto: 2.0.1-r6                                                                                    
dev-util/ccache:     2.4-r8                                                                                      
dev-util/cmake:      2.6.2-r1                                                                                    
sys-apps/baselayout: 2.0.0                                                                                       
sys-apps/openrc:     0.4.2                                                                                       
sys-apps/sandbox:    1.3.2                                                                                       
sys-devel/autoconf:  2.13, 2.63                                                                                  
sys-devel/automake:  1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2                                            
sys-devel/binutils:  2.18-r1, 2.18.50.0.6, 2.19                                                                  
sys-devel/gcc-config: 1.4.0-r4                                                                                   
sys-devel/libtool:   2.2.6a                                                                                      
virtual/os-headers:  2.6.28-r1                                                                                   
ACCEPT_KEYWORDS="amd64 ~amd64"                                                                                   
CBUILD="x86_64-pc-linux-gnu"                                                                                     
CFLAGS="-O2 -pipe -march=athlon64"                                                                               
CHOST="x86_64-pc-linux-gnu"                                                                                      
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"                                                                                    
CXXFLAGS="-O2 -pipe -march=athlon64"                                                                                              
DISTDIR="/usr/portage/distfiles"                                                                                                  
FEATURES="distlocks fixpackages parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-orphans userfetch"      
GENTOO_MIRRORS="http://mirror.yandex.ru/gentoo-distfiles"                                                                         
LANG="POSIX"                                                                                                                      
LC_ALL=""                                                                                                                         
LDFLAGS="-Wl,-O1"                                                                                                                 
LINGUAS="ru en"                                                                                                                   
MAKEOPTS="-j3"                                                                                                                    
PKGDIR="/usr/portage/packages"                                                                                                    
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://212.49.103.119/gentoo-portage"
USE="3dnow 3dnowext 7zip X a52 aac accessibility acl acpi alsa amd64 apache2 arts artswrappersuid audiofile berkdb branding bzip2cairo caps cdparanoia cdr cli clucene cracklib crypt cups curl dbus dedicated directfb djvu dri dvd dvdr dvdread emboss encode esd fam fbcon ffmpeg firefox flac fortran ftp gd gdbm gif glib glibc-omitfp glitz gpm gstreamer gtk hal iconv icq isdnlog ithreads java javascript jpeg jpeg2k kde kde4 libnotify lm_sensors mad madwifi memlimit midi mikmod mime mmx mp3 mpeg mplayer mudflap multilib mysql ncurses nls nptl nptlonly nvidia ogg opengl openmp pam pcre pdf perl php png ppds pppd python qt3 qt3support qt4 quicktime rcc readline reflection samba sdl semantic-desktop session slang spl sse sse2 ssl startup-notification svg sysfs syslog tcpd threads tiff truetype unicode usb userlocales vorbis webkit wifi wmf xcb xcomposite xml xorg xscreensaver xulrunner xv xvid zip zlib"ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajpproxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc"INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncursestext" LINGUAS="ru en" USERLAND="GNU" VIDEO_CARDS="fbdev nv nvidia vmware vesa vga"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Franz Trischberger





          2009-02-09 13:01:48 UTC
        

Did you install qt-core and qt-gui qith USE="glib"?
(AFAIR there was a problem qith qt-phonon not compiling without glib enabled in qt-core/gui, and the media-sound/phonon-ebuild does not check this)




Comment 2


bay





          2009-02-09 13:02:05 UTC
        

Created attachment 181432 [details]
full build log




Comment 3


bay





          2009-02-09 13:06:03 UTC
        

Created attachment 181433 [details]
full build log




Comment 4


bay





          2009-02-09 13:06:55 UTC
        

Created attachment 181435 [details]
full build log




Comment 5


bay





          2009-02-09 13:10:37 UTC
        

Created attachment 181437 [details]
full build log




Comment 6


bay





          2009-02-09 13:15:18 UTC
        

emerge qt-core qt-gui -pv

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] x11-libs/qt-core-4.4.2-r1  USE="glib qt3support ssl -debug -doc
-pch" 0 kB
[ebuild   R   ] x11-libs/qt-gui-4.4.2-r2  USE="accessibility cups dbus glib
qt3support tiff -debug -mng -nas -nis -pch -xinerama" INPUT_DEVICES="-wacom" 0
kB

both are compilied with useflag glib

sorry for duplicate attachments




Comment 7


bay





          2009-02-09 13:37:50 UTC
        

i turned off gstreamer useflag. phonon compiled successfully




Comment 8


Frossie





          2009-04-09 05:22:08 UTC
        

(In reply to comment #7)
> i turned off gstreamer useflag. phonon compiled successfully
> 

Same problem with phonon 4.3.1 - and the above workaround worked here too. I suggest changing the title of the bug to "media-sound/phonon-4.3.0 fails to compile with gstreamer USE flag" in order to direct people to the issue faster (only the creator of the bug and the assignee can change the subject it seems).




Comment 9


Frossie





          2009-04-10 05:50:30 UTC
        

(In reply to comment #8)

> Same problem with phonon 4.3.1 - and the above workaround worked here too. I
> suggest changing the title of the bug to "media-sound/phonon-4.3.0 fails to
> compile with gstreamer USE flag" in order to direct people to the issue faster
> (only the creator of the bug and the assignee can change the subject it seems).
> 

Okay I have been chasing my tail, but right now I have build successfully with the gstreamer use flag - suggest the original poster try

emerge --sync
emerge cmake [check that really builds]
"USE=xine gstreamer" emerge phonon

in case they are having the same problem I was.




Comment 10


Dmitry Bigunyak





          2009-06-08 14:36:33 UTC
        

I got error while compiling media-sound/phonon-4.3.1:
emerge -avD media-sound/phonon
[ebuild  N    ] media-sound/phonon-4.3.1  USE="xine -debug -gstreamer -xcb" 0 kB

>>> Emerging (1 of 4) media-sound/phonon-4.3.1
...

[ 69%] Built target phonon_xine_automoc
Scanning dependencies of target phonon_xine
[ 70%] Building CXX object xine/CMakeFiles/phonon_xine.dir/phonon_xine_automoc.cpp.o
[ 71%] Building CXX object xine/CMakeFiles/phonon_xine.dir/sinknode.cpp.o
[ 73%] Building CXX object xine/CMakeFiles/phonon_xine.dir/sourcenode.cpp.o
[ 74%] Building CXX object xine/CMakeFiles/phonon_xine.dir/xinethread.cpp.o
[ 76%] Building CXX object xine/CMakeFiles/phonon_xine.dir/nullsink.cpp.o
[ 77%] Building CXX object xine/CMakeFiles/phonon_xine.dir/xineengine.cpp.o
[ 78%] Building CXX object xine/CMakeFiles/phonon_xine.dir/xinestream.cpp.o
In file included from /var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/xinestream.cpp:36:
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:32:21: error: xcb/xcb.h: Нет такого файла или каталога
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:55: ошибка: expected type-specifier before ‘xcb_connection_t’
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:56: ошибка: ISO C++ запрещает декларации ‘xcb_screen_t’ без типа
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:56: ошибка: expected ‘;’ before ‘*’ token
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:57: ошибка: expected `;' before ‘operator’
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:67: ошибка: ISO C++ запрещает декларации ‘xcb_connection_t’ без типа
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:67: ошибка: expected ‘;’ before ‘*’ token
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:68: ошибка: ISO C++ запрещает декларации ‘xcb_screen_t’ без типа
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:68: ошибка: expected ‘;’ before ‘*’ token
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h: In member function ‘Phonon::Xine::XcbConnection::operator bool() const’:
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:57: ошибка: нет декларации ‘m_xcbConnection’ в этой области видимости
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h: At global scope:
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:87: ошибка: ISO C++ запрещает декларации ‘xcb_connection_t’ без типа
/var/tmp/portage/media-sound/phonon-4.3.1/work/phonon-4.3.1/xine/videowidget.h:87: ошибка: expected ‘;’ before ‘*’ token
make[2]: *** [xine/CMakeFiles/phonon_xine.dir/xinestream.cpp.o] Ошибка 1
make[1]: *** [xine/CMakeFiles/phonon_xine.dir/all] Ошибка 2
make: *** [all] Ошибка 2
 *
 * ERROR: media-sound/phonon-4.3.1 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 2890:  Called cmake-utils_src_compile
 *             environment, line  766:  Called cmake-utils_src_make
 *             environment, line  845:  Called die
 * The specific snippet of code:
 *           emake "$@" || die "Make failed!";
 *  The die message:
 *   Make failed!
 *
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/var/tmp/portage/media-sound/phonon-4.3.1/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/media-sound/phonon-4.3.1/temp/environment'.
 *

>>> Failed to emerge media-sound/phonon-4.3.1, Log file:

>>>  '/var/tmp/portage/media-sound/phonon-4.3.1/temp/build.log'

As you see "gstreamer" use flag is turned off. Could you help me?





Comment 11


Dmitry Bigunyak





          2009-06-08 14:39:39 UTC
        

Created attachment 193900 [details]
media-sound/phonon-4.3.1 build log file




Comment 12


Dmitry Bigunyak





          2009-06-08 14:58:48 UTC
        

Created attachment 193903 [details]
media-sound/phonon-4.3.1 build log file (english version)

Add build log file on english :)




Comment 13


Dmitry Bigunyak





          2009-06-08 15:19:31 UTC
        

I think the problem is that I'm trying to compile media-sound/phonon-4.3.1 without "xcb" use flag. Is "xcb" a mandatory use flag? If so, this is a bug in the media-sound/phonon-4.3.1 ebuild.




Comment 14


Dmitry Bigunyak





          2009-06-08 15:31:09 UTC
        

I think the problem is that I'm trying to compile media-sound/phonon-4.3.1 without "xcb" use flag. Is "xcb" a mandatory use flag? If so, this is a bug in the media-sound/phonon-4.3.1 ebuild.




Comment 15


Jorge Manuel B. S. Vicetto (RETIRED)






          2009-06-09 01:19:24 UTC
        

(In reply to comment #14)
> I think the problem is that I'm trying to compile media-sound/phonon-4.3.1
> without "xcb" use flag. Is "xcb" a mandatory use flag? If so, this is a bug in
> the media-sound/phonon-4.3.1 ebuild.

Your problem is not the same as the one reported in this bug. Please open a different bug for your issue.
You'll want to post there the use flags for libX11 and xine-lib. Looking at the ebuild, maybe we need to change the xine-lib[xcb?] dep into xine-lib[xcb=]

        xine? (
                >=media-libs/xine-lib-1.1.15-r1[xcb?]
                xcb? ( x11-libs/libxcb )
        )





Comment 16


Jorge Manuel B. S. Vicetto (RETIRED)






          2009-06-09 02:16:24 UTC
        

I've just build phonon with all variants of the gtreamer and xcb use flags and it WORKSFORME.




Comment 17


Dmitry Bigunyak





          2009-06-09 12:17:01 UTC
        

(In reply to comment #16)
> I've just build phonon with all variants of the gtreamer and xcb use flags and
> it WORKSFORME.
> 

I got the same problem on my second computer too. And in both cases after turning on "xcb" use flag, package compiles successfully. I'll open a new bug as you suggest.




Comment 18


Samuli Suominen (RETIRED)






          2010-02-28 10:32:49 UTC
        

The USE="xcb" build problem issue is bug 273347.

I'm closing this one per Comment #16.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

