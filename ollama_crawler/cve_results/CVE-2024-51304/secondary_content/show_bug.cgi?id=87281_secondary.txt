Title: 87281 – asm code in scummvm 0.7.1 fails: midi backend
URL: https://bugs.gentoo.org/show_bug.cgi?id=87281

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 87281
asm code in scummvm 0.7.1 fails: midi backend
Last modified: 2005-05-30 09:31:11 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 87281 
      - asm code in scummvm 0.7.1 fails: midi backend


Summary:
asm code in scummvm 0.7.1 fails: midi backend
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Games

  (show other bugs)



Hardware:

x86
        All
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Games








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-03-30 07:28 UTC by Michael Hill





      Modified:
    
2005-05-30 09:31 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michael Hill





          2005-03-30 07:28:59 UTC
        

Here's the last few lines of the build:

mkdir -p backends/midi/mt32/.deps
g++ -Wp,-MMD,"backends/midi/mt32/.deps/mt32_file.d",-MQ,"backends/midi/mt32/mt32_file.o",-MP -Wall -O2 -march=athlon-xp -pipe -fomit-frame-pointer -O2 -march=athlon-xp -pipe -fomit-frame-pointer   -ansi -W -Wno-unused-parameter -O -Wuninitialized -Wno-long-long -Wno-multichar -Wno-unknown-pragmas -pedantic -Wpointer-arith -Wcast-qual -Wconversion -Wshadow -Wimplicit -Wundef -Wnon-virtual-dtor -Wno-reorder -Wwrite-strings -fcheck-new -Wctor-dtor-privacy  -DHAVE_CONFIG_H -DUNIX -DDISABLE_SAGA -DDISABLE_KYRA -I. -I. -I./common -I./backends/midi/mt32        -I/usr/include/SDL -D_REENTRANT -Itest/cxxtest -c backends/midi/mt32/mt32_file.cpp -o backends/midi/mt32/mt32_file.o
mkdir -p backends/midi/mt32/.deps
g++ -Wp,-MMD,"backends/midi/mt32/.deps/i386.d",-MQ,"backends/midi/mt32/i386.o",-MP -Wall -O2 -march=athlon-xp -pipe -fomit-frame-pointer -O2 -march=athlon-xp -pipe -fomit-frame-pointer   -ansi -W -Wno-unused-parameter -O -Wuninitialized -Wno-long-long -Wno-multichar -Wno-unknown-pragmas -pedantic -Wpointer-arith -Wcast-qual -Wconversion -Wshadow -Wimplicit -Wundef -Wnon-virtual-dtor -Wno-reorder -Wwrite-strings -fcheck-new -Wctor-dtor-privacy  -DHAVE_CONFIG_H -DUNIX -DDISABLE_SAGA -DDISABLE_KYRA -I. -I. -I./common -I./backends/midi/mt32        -I/usr/include/SDL -D_REENTRANT -Itest/cxxtest -c backends/midi/mt32/i386.cpp -o backends/midi/mt32/i386.o
mkdir -p backends/midi/mt32/.deps
g++ -Wp,-MMD,"backends/midi/mt32/.deps/part.d",-MQ,"backends/midi/mt32/part.o",-MP -Wall -O2 -march=athlon-xp -pipe -fomit-frame-pointer -O2 -march=athlon-xp -pipe -fomit-frame-pointer   -ansi -W -Wno-unused-parameter -O -Wuninitialized -Wno-long-long -Wno-multichar -Wno-unknown-pragmas -pedantic -Wpointer-arith -Wcast-qual -Wconversion -Wshadow -Wimplicit -Wundef -Wnon-virtual-dtor -Wno-reorder -Wwrite-strings -fcheck-new -Wctor-dtor-privacy  -DHAVE_CONFIG_H -DUNIX -DDISABLE_SAGA -DDISABLE_KYRA -I. -I. -I./common -I./backends/midi/mt32        -I/usr/include/SDL -D_REENTRANT -Itest/cxxtest -c backends/midi/mt32/part.cpp -o backends/midi/mt32/part.o
backends/midi/mt32/i386.cpp: In function `bool MT32Emu::DetectSIMD()':
backends/midi/mt32/i386.cpp:58: error: PIC register `ebx' clobbered in `asm'
make: *** [backends/midi/mt32/i386.o] Error 1
make: *** Waiting for unfinished jobs....

!!! ERROR: games-engines/scummvm-0.7.1 failed.
!!! Function src_compile, Line 56, Exitcode 2
!!! emake failed
!!! If you need support, post the topmost build error, NOT this status message.

Here's emerge info:

Portage 2.0.51.19 (default-linux/x86/2004.3, gcc-3.4.3, glibc-2.3.4.20050125-r1, 2.6.11-gentoo-r4 i686)
=================================================================
System uname: 2.6.11-gentoo-r4 i686 AMD Athlon(tm) XP 1800+
Gentoo Base System version 1.6.10
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Feb 20 2005, 01:14:36)]
ccache version 2.4 [enabled]
dev-lang/python:     2.3.5
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.5, 1.4_p6, 1.9.5, 1.6.3, 1.7.9-r1, 1.8.5-r3
sys-devel/binutils:  2.15.92.0.2-r7
sys-devel/libtool:   1.5.14
virtual/os-headers:  2.6.8.1-r4
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CFLAGS="-O2 -march=athlon-xp -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=athlon-xp -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig buildpkg ccache digest distlocks sandbox sfperms"
GENTOO_MIRRORS="http://www.gtlib.cc.gatech.edu/pub/gentoo/"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow X Xaw3d acpi alsa apm audiofile avi bcmath berkdb bitmap-fonts bonobo bzlib calendar caps cdb cdr crypt cscope ctype cups curl dba dbase dbx dedicated dga dlloader doc dvd dvdr emboss encode esd exif fbcon fftw flac flatfile font-server foomaticdb freetds ftp gd gif ginac gmp gnome gnutls gpm gtk gtk2 hardened hardenedphp imagemagick imlib inifile jack jpeg kde libwww mad mbox memlimit mhash mikmod milter mime mmap mmx mng mozilla mp3 mpeg mpi mysql ncurses nocardbus nocd odbc oggvorbis opengl oss pam pcntl pcre pda pdflib perl php pic pie plotutils png posix ppds python qt quicktime readline real samba sdl shared sharedmem simplexml sndfile sockets speex spell spl sse ssl svg sysvipc tcltk tcpd tidy tiff tokenizer truetype truetype-fonts type1-fonts usb vhosts videos wmf xine xml xml2 xmlrpc xmms xpm xsl xv xvid zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS




Comment 1


Mr. Bones. (RETIRED)






          2005-03-31 10:48:32 UTC
        

can you try it with gcc-3.3 and see if it's a gcc-3.4 issue please?




Comment 2


Michael Hill





          2005-04-01 13:49:00 UTC
        

Good call, Mr. Bones.  It compiled fine with i686-pc-linux-gnu-3.3.5 .

Should this be assigned to the gcc team?




Comment 3


Michael Hill





          2005-04-01 13:51:06 UTC
        

Oh, and is there a way to tell emerge to use gcc-3.3 for this even if gcc-config has it set to 3.4 ?




Comment 4


Mr. Bones. (RETIRED)






          2005-04-01 14:03:01 UTC
        

no, the toolchain guys probably aren't interested since it's likely to be an upstream bug.  On the other hand, if it works with different versions of gcc-3.4 they *might* be.

There's no way to have portage use a particular version of gcc to compile specific packages.  You'd need to use gcc-config to set it to 3.3, merge the package, then use gcc-config to set it back to 3.4.




Comment 5


Francesco





          2005-04-16 06:23:39 UTC
        

Can't compile it (same error!) with 3.3.5 and 3.4.3 on a machine. On other one it's all ok. No idea what could be wrong.




Comment 6


Mr. Bones. (RETIRED)






          2005-04-16 11:20:29 UTC
        

you can try "emerge -ev scummvm"





Comment 7


Mr. Bones. (RETIRED)






          2005-05-25 17:01:00 UTC
        

Is this still an issue?  I've never been able to reproduce it.




Comment 8


Michael Hill





          2005-05-29 22:14:24 UTC
        

I'll have to get back to you on that...  I tried re-emerging scummvm, but with
the same version of gcc, so (duh!) I got the same error.  Tried unmasking and
emerging gcc-3.4.3.20050110-r2, but ran out of space.  D'oh.  So I'll have to
free up some space and try building it again, and then try scummvm.




Comment 9


Michael Hill





          2005-05-30 09:31:11 UTC
        

Okay, building with gcc-3.4.3-20050110 yields the same error.  I don't know what
the right course of action is for this bug, but I do have scummvm-0.7.1 built,
so I guess it's not as critical.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

