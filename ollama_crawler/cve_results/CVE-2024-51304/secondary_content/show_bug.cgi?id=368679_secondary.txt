Title: 368679 – www-client/chromium-13.0.772.0[gnome-keyring]: attempt to free invalid pointer on startup
URL: https://bugs.gentoo.org/show_bug.cgi?id=368679

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 368679
www-client/chromium-13.0.772.0[gnome-keyring]: attempt to free invalid pointer on startup
Last modified: 2011-05-30 14:39:13 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 368679 
      - www-client/chromium-13.0.772.0[gnome-keyring]: attempt to free invalid pointer on startup


Summary:
www-client/chromium-13.0.772.0[gnome-keyring]: attempt to free invalid pointe...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Chromium Project








URL:







Whiteboard:
ht-wanted  
  


Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-05-25 11:49 UTC by Denis I. Polukarov





      Modified:
    
2011-05-30 14:39 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info www-client/chromium

              (info,5.49 KB,
                text/plain)

            
2011-05-25 11:52 UTC,

            Denis I. Polukarov




Details





Full back trace.

              (bt.txt.bz2,4.32 KB,
                application/octet-stream)

            
2011-05-30 06:29 UTC,

            Denis I. Polukarov




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Denis I. Polukarov





          2011-05-25 11:49:20 UTC
        

chromium crash on startup. On console:
xxx@xxx ~ $ chromium
[21368:21395:96837380997:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[21368:21395:96837392939:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[21368:21402:96837477051:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[21368:21402:96837503545:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[21368:21386:96837569219:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
third_party/tcmalloc/chromium/src/tcmalloc.cc:414] Attempt to free invalid pointer: 0x9df27c1
Аварийный останов
xxx@xxx ~ $

Reproducible: Always

Steps to Reproduce:
1. emerge =www-client/chromium-13.0.772.0
2. ./chromium
3.
Actual Results:  
chromium crash.

Expected Results:  
running browser.




Comment 1


Denis I. Polukarov





          2011-05-25 11:52:55 UTC
        

Created attachment 274597 [details]
emerge --info www-client/chromium




Comment 2


Paweł Hajdan, Jr. (RETIRED)






          2011-05-26 06:53:58 UTC
        

It doesn't happen on my system. Could you run this under gdb and get a stack trace?




Comment 3


Denis I. Polukarov





          2011-05-26 08:24:52 UTC
        

xxx@xxx ~ $ chromium-browser -g
[8191:8218:176156750162:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[8191:8218:176156761555:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[8191:8219:176156891107:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[8191:8217:176157006288:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
third_party/tcmalloc/chromium/src/tcmalloc.cc:414] Attempt to free invalid pointer: 0x9df27c1
Аварийный останов
xxx@xxx ~ $ gdb chromium
GNU gdb (Gentoo 7.2 p1) 7.2
Copyright (C) 2010 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.gentoo.org/>...
"/usr/bin/chromium": not in executable format: Формат файла не распознан
(gdb)
How can I start browser under gdb?




Comment 4


Paweł Hajdan, Jr. (RETIRED)






          2011-05-26 08:37:15 UTC
        

(In reply to comment #3)
> "/usr/bin/chromium": not in executable format: Формат файла не распознан
> (gdb)
> How can I start browser under gdb?

/usr/bin/chromium is a shell script. Run /usr/lib/chromium-browser/chrome under gdb, that should work.




Comment 5


Denis I. Polukarov





          2011-05-26 09:21:30 UTC
        

xxx@xxx ~ $ gdb
GNU gdb (Gentoo 7.2 p1) 7.2
Copyright (C) 2010 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.gentoo.org/>.
(gdb) run /usr/lib/chromium-browser/chrom
Starting program:  /usr/lib/chromium-browser/chrom
No executable file specified.
Use the "file" or "exec-file" command.
(gdb) file /usr/lib/chromium-browser/chrom
/usr/lib/chromium-browser/chrom: No such file or directory.
(gdb) exec-file /usr/lib/chromium-browser/chrom
/usr/lib/chromium-browser/chrom: No such file or directory.
(gdb) quit
xxx@xxx ~ $ ls -l /usr/lib/chromium-browser/
итого 40404
-rwxr-xr-x 1 root root 35545360 Май 25 12:55 chrome
-rw-r--r-- 1 root root  2763152 Май 25 12:55 chrome.pak
-rws--x--x 1 root root    13656 Май 25 12:55 chrome_sandbox
-rwxr-xr-x 1 root root      680 Май 25 12:55 chromium-launcher.sh
lrwxrwxrwx 1 root root       25 Май 25 12:55 libavcodec.so.52 -> /usr/lib/libavcodec.so.52
lrwxrwxrwx 1 root root       26 Май 25 12:55 libavformat.so.52 -> /usr/lib/libavformat.so.52
lrwxrwxrwx 1 root root       24 Май 25 12:55 libavutil.so.50 -> /usr/lib/libavutil.so.50
drwxr-xr-x 2 root root     1352 Май 25 12:55 locales
drwxr-xr-x 3 root root       80 Май 24 20:43 resources
-rw-r--r-- 1 root root  2997039 Май 25 12:55 resources.pak
xxx@xxx ~ $




Comment 6


Paweł Hajdan, Jr. (RETIRED)






          2011-05-26 09:34:40 UTC
        

(In reply to comment #4)
> /usr/bin/chromium is a shell script. Run /usr/lib/chromium-browser/chrome under
> gdb, that should work.

I think you made a typo, it's "chrome", not "chrom" (and the directory listing shows that).




Comment 7


Denis I. Polukarov





          2011-05-26 11:11:42 UTC
        

xxx@xxx ~ $ gdb
GNU gdb (Gentoo 7.2 p1) 7.2
Copyright (C) 2010 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.gentoo.org/>.
(gdb) run /usr/lib/chromium-browser/chrome
Starting program:  /usr/lib/chromium-browser/chrome
No executable file specified.
Use the "file" or "exec-file" command.
(gdb) file /usr/lib/chromium-browser/chrome
Reading symbols from /usr/lib/chromium-browser/chrome...(no debugging symbols found)...done.
(gdb) run /usr/lib/chromium-browser/chrome
Starting program: /usr/lib/chromium-browser/chrome /usr/lib/chromium-browser/chrome
[Thread debugging using libthread_db enabled]
[New Thread 0xb51aab70 (LWP 24814)]
[New Thread 0xb49a9b70 (LWP 24815)]
[New Thread 0xb3be5b70 (LWP 24816)]
[New Thread 0xb33e4b70 (LWP 24817)]
[New Thread 0xb2be3b70 (LWP 24818)]
[New Thread 0xb23e2b70 (LWP 24819)]
[New Thread 0xb13e0b70 (LWP 24821)]
[New Thread 0xb1be1b70 (LWP 24820)]
[New Thread 0xb0bdfb70 (LWP 24822)]
[New Thread 0xb03deb70 (LWP 24823)]
[New Thread 0xb03bdb70 (LWP 24824)]
[New Thread 0xafbbcb70 (LWP 24827)]
[New Thread 0xaf3bbb70 (LWP 24828)]
[New Thread 0xaebbab70 (LWP 24829)]
[Thread 0xaebbab70 (LWP 24829) exited]
[New Thread 0xaebbab70 (LWP 24830)]
[New Thread 0xae1c7b70 (LWP 24831)]
[New Thread 0xae1a5b70 (LWP 24832)]
[New Thread 0xaa121b70 (LWP 24837)]
[Thread 0xaa121b70 (LWP 24837) exited]
[New Thread 0xaa121b70 (LWP 24839)]
[New Thread 0xa9920b70 (LWP 24843)]
[24806:24823:187545628600:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[24806:24823:187545631857:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[New Thread 0xa7e98b70 (LWP 24847)]
[24806:24823:187545788602:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[24806:24832:187545969490:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[New Thread 0xa7f14b70 (LWP 24850)]
[New Thread 0xa7697b70 (LWP 24852)]
[Thread 0xa7697b70 (LWP 24852) exited]
[New Thread 0xa7ef3b70 (LWP 24857)]
[New Thread 0xa7ed2b70 (LWP 24858)]
[New Thread 0xa7697b70 (LWP 24861)]
[Thread 0xa7697b70 (LWP 24861) exited]
[New Thread 0xa835eb70 (LWP 24863)]
[Thread 0xae1a5b70 (LWP 24832) exited]
[Thread 0xae1c7b70 (LWP 24831) exited]
[New Thread 0xa7697b70 (LWP 24865)]
[Thread 0xa7f14b70 (LWP 24850) exited]
[Thread 0xa835eb70 (LWP 24863) exited]
[New Thread 0xa6e96b70 (LWP 24882)]
[Thread 0xa6e96b70 (LWP 24882) exited]
third_party/tcmalloc/chromium/src/tcmalloc.cc:414] Attempt to free invalid pointer: 0x9df27c1

Program received signal SIGABRT, Aborted.
0xb7fe1424 in __kernel_vsyscall ()
(gdb)




Comment 8


Denis I. Polukarov





          2011-05-26 11:14:01 UTC
        

Browser run, but crush after open 'preferences'.




Comment 9


Paweł Hajdan, Jr. (RETIRED)






          2011-05-26 11:14:28 UTC
        

Please run gdb again and issue "bt" command to print the backtrace.




Comment 10


Denis I. Polukarov





          2011-05-26 14:13:02 UTC
        

xxx@xxx ~ $ gdb
GNU gdb (Gentoo 7.2 p1) 7.2
Copyright (C) 2010 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-pc-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.gentoo.org/>.
(gdb) file /usr/lib/chromium-browser/chrome
Reading symbols from /usr/lib/chromium-browser/chrome...(no debugging symbols found)...done.
(gdb) run /usr/lib/chromium-browser/chrome
Starting program: /usr/lib/chromium-browser/chrome /usr/lib/chromium-browser/chrome
[Thread debugging using libthread_db enabled]
[New Thread 0xb51aab70 (LWP 30881)]
[New Thread 0xb49a9b70 (LWP 30882)]
[New Thread 0xb3be5b70 (LWP 30883)]
[New Thread 0xb33e4b70 (LWP 30884)]
[New Thread 0xb2be3b70 (LWP 30885)]
[New Thread 0xb23e2b70 (LWP 30886)]
[New Thread 0xb13e0b70 (LWP 30888)]
[New Thread 0xb1be1b70 (LWP 30887)]
[New Thread 0xb0bdfb70 (LWP 30889)]
[New Thread 0xb03deb70 (LWP 30890)]
[New Thread 0xb03bdb70 (LWP 30893)]
[New Thread 0xafbbcb70 (LWP 30894)]
[New Thread 0xaf3bbb70 (LWP 30895)]
[New Thread 0xaebbab70 (LWP 30896)]
[Thread 0xaebbab70 (LWP 30896) exited]
[New Thread 0xaebbab70 (LWP 30897)]
[New Thread 0xae1c7b70 (LWP 30898)]
[New Thread 0xae181b70 (LWP 30899)]
[New Thread 0xaa11db70 (LWP 30904)]
[Thread 0xaa11db70 (LWP 30904) exited]
[New Thread 0xaa11db70 (LWP 30906)]
[New Thread 0xa991cb70 (LWP 30910)]
[30873:30898:198395040606:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[30873:30898:198395043642:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[New Thread 0xa7e94b70 (LWP 30913)]
[30873:30898:198395211328:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[30873:30890:198395348391:ERROR:nss_ocsp.cc(581)] No URLRequestContext for OCSP handler.
[New Thread 0xa7693b70 (LWP 30920)]
[Thread 0xa7693b70 (LWP 30920) exited]
third_party/tcmalloc/chromium/src/tcmalloc.cc:414] Attempt to free invalid pointer: 0x9df27c1

Program received signal SIGABRT, Aborted.
0xb7fe1424 in __kernel_vsyscall ()
(gdb) bt
#0  0xb7fe1424 in __kernel_vsyscall ()
#1  0xb59c0f3a in raise () from /lib/libc.so.6
#2  0xb59c244c in abort () from /lib/libc.so.6
#3  0x087fb9d6 in ?? ()
#4  0x087fba7f in ?? ()
#5  0x087f4b15 in ?? ()
#6  0xb62744be in g_free () from /usr/lib/libglib-2.0.so.0
#7  0xb5bfb5f4 in gnome_keyring_attribute_list_free () from /usr/lib/libgnome-keyring.so.0
#8  0xb5bf9f9b in gnome_keyring_find_itemsv () from /usr/lib/libgnome-keyring.so.0
#9  0x0853e75b in ?? ()
#10 0x0853dacc in ?? ()
#11 0x08852ef5 in ?? ()
#12 0x0885347e in ?? ()
#13 0x0885703c in ?? ()
#14 0x0885743a in ?? ()
#15 0x08886a8f in ?? ()
#16 0x08886b0e in ?? ()
#17 0x08853981 in ?? ()
#18 0x08853a56 in ?? ()
#19 0x0808453d in ?? ()
#20 0x08075351 in ?? ()
#21 0x0807613b in ?? ()
#22 0xb59addd3 in __libc_start_main () from /lib/libc.so.6
#23 0x08074611 in ?? ()
(gdb) quit
A debugging session is active.

	Inferior 1 [process 30873] will be killed.

Quit anyway? (y or n) y
xxx@xxx ~ $

Browser crash after open 'preferences' again.




Comment 11


Paweł Hajdan, Jr. (RETIRED)






          2011-05-26 14:25:20 UTC
        

Please add "-ggdb3" to CFLAGS and CXXFLAGS, and "splitdebug" to FEATURES (all in /etc/make.conf), and re-emerge chromium. Then please get the backtrace again. It should contain more info.

Does the problem occur with USE="-gnome-keyring"?




Comment 12


Denis I. Polukarov





          2011-05-27 11:13:42 UTC
        

Emerge failed with debug flags. Browser work fine with USE="-gnome-keyring".




Comment 13


Paweł Hajdan, Jr. (RETIRED)






          2011-05-27 11:23:24 UTC
        

(In reply to comment #12)
> Emerge failed with debug flags.

Could you post the error? I guess it ran out of memory - could you try increasing swap?

> Browser work fine with USE="-gnome-keyring".

Ah, that's a very important clue. I'll rebuild with USE="gnome-keyring" and see what happens.




Comment 14


Denis I. Polukarov





          2011-05-27 11:33:24 UTC
        

Error were occur with ld (I don't save any files)... I've more space for build chromium. Before compiling I change:
xxx xxx # cat /etc/fstab | grep /var/tmp
tmpfs   /var/tmp   tmpfs   defaults   0 0 (~1Gb free)
xxx xxx #
to:
# mount -o bind /home/ /var/tmp/ (~ 200Gb free)

p.s. I'm using:
gnome-base/gnome-keyring-3.0.2-r300  USE="caps pam -debug -doc -test"
from gnome overlay (system build with gnome 3).




Comment 15


Paweł Hajdan, Jr. (RETIRED)






          2011-05-27 15:25:43 UTC
        

(In reply to comment #14)
> Error were occur with ld (I don't save any files)... I've more space for build
> chromium. Before compiling I change:

ld can fail because of lack of disk space, but it may also fail because lack of virtual memory (RAM + swap). Make sure you have both plenty of disk space and plenty of swap.

> p.s. I'm using:
> gnome-base/gnome-keyring-3.0.2-r300  USE="caps pam -debug -doc -test"
> from gnome overlay (system build with gnome 3).

That's a possible cause. I can't reproduce with gnome-base/gnome-keyring-2.32.1 from the main portage tree.

Could you compile chromium with -ggdb3 and get a full stack trace? If that's an issue with gnome-3, I think we can submit that report upstream (http://crbug.com) so that it can be fixed before we get gnome-3 in Gentoo.

Please post any upstream bug URLs here for reference.




Comment 16


Denis I. Polukarov





          2011-05-30 06:29:45 UTC
        

Created attachment 275065 [details]
Full back trace.




Comment 17


Paweł Hajdan, Jr. (RETIRED)






          2011-05-30 06:47:41 UTC
        

(In reply to comment #16)
> Created attachment 275065 [details]
> Full back trace.

Sorry, there is no backtrace there. You forgot to run "bt". Also, please do not compress the file unless it's really needed. Could you try again?




Comment 18


Denis I. Polukarov





          2011-05-30 08:55:05 UTC
        

(In reply to comment #17)
> (In reply to comment #16)
> > Created attachment 275065 [details]
> > Full back trace.
> 
> Sorry, there is no backtrace there. You forgot to run "bt". Also, please do not
> compress the file unless it's really needed. Could you try again?

I could not try again, because I've update to new version of:
gnome-base/gnome-keyring-3.0.2-r300 -> gnome-base/gnome-keyring-3.0.3-r300
gnome-base/libgnome-keyring-3.0.2 -> gnome-base/libgnome-keyring-3.0.3

and browser work.




Comment 19


Paweł Hajdan, Jr. (RETIRED)






          2011-05-30 14:39:13 UTC
        

(In reply to comment #18)
> I could not try again, because I've update to new version of:
> gnome-base/gnome-keyring-3.0.2-r300 -> gnome-base/gnome-keyring-3.0.3-r300
> gnome-base/libgnome-keyring-3.0.2 -> gnome-base/libgnome-keyring-3.0.3
> and browser work.

Closing then. Thank you for reporting back.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

