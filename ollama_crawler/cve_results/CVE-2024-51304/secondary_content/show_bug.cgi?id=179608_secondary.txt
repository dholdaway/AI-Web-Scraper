Title: 179608 – xfce-base/thunar: gamin doesn't work in thunar
URL: https://bugs.gentoo.org/show_bug.cgi?id=179608

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 179608
xfce-base/thunar: gamin doesn't work in thunar
Last modified: 2007-05-26 08:00:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 179608 
      - xfce-base/thunar: gamin doesn't work in thunar


Summary:
xfce-base/thunar: gamin doesn't work in thunar
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

XFCE Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-05-24 08:08 UTC by crusaderky





      Modified:
    
2007-05-26 08:00 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



amd64









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


crusaderky





          2007-05-24 08:08:03 UTC
        

1)open a directory in thunar
2)from a terminal, type `touch thatdir/foo` to create a new file
3)you won't see any change in thunar until you press Ctrl+R.

file change notification works fine both in nautilus and konqueror.
I'm using gamin-0.1.8 and linux-2.6.21-gentoo with inotify enabled.

$ ldd `which thunar` | grep fam
(no results)
$ ldd `which thunar` | grep gamin
        libgamin-1.so.0 => /usr/lib/libgamin-1.so.0 (0x0000003e1e800000)

 $ emerge -pv thunar
[ebuild   R   ] xfce-base/thunar-0.8.0-r3  USE="X dbus exif hal pcre plugins startup-notification -debug -doc -gnome" 0 kB 

$ emerge --info
Portage 2.1.2.2 (default-linux/amd64/2007.0/desktop, gcc-4.1.1, glibc-2.5-r2, 2.6.21-gentoo x86_64)
=================================================================
System uname: 2.6.21-gentoo x86_64 AMD Athlon(tm) 64 X2 Dual Core Processor 4600+
Gentoo Base System release 1.12.9
Timestamp of tree: Sat, 19 May 2007 14:50:01 +0000
dev-java/java-config: 1.3.7, 2.0.31-r5
dev-lang/python:     2.4.4-r4
dev-python/pycrypto: 2.0.1-r5
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64 -O2 -fomit-frame-pointer -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-march=athlon64 -O2 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="digest distlocks fixpackages metadata-transfer parallel-fetch sandbox sfperms strict userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://gentoo.virginmedia.com/ http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo/ http://gentoo.mirror.solnet.ch http://pandemonium.tiscali.de/pub/gentoo/ http://mirror.ovh.net/gentoo-distfiles/"
LC_ALL="it_IT.UTF-8"
LINGUAS="it"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="3dnow X a52 aac acl acpi alsa amd64 bash-completion berkdb bitmap-fonts bzip2 cairo cddb cdr cjk cli cracklib crypt cups curl dbus dri dts dv dvb dvd dvdr dvdread eds emboss encode evo exif fam ffmpeg firefox flac fortran ftp gdbm gif gpm gstreamer gtk hal iconv ieee1394 ipv6 isdnlog java jpeg kdeenablefinal kdehiddenvisibility kerberos ldap libg++ lm_sensors mad matroska midi mikmod mmx mng mp3 mpeg mudflap musepack mysql ncurses nls nptl nptlonly nsplugin offensive ogg opengl openmp pam pcre pdf perl php png ppds pppd python qt3 qt3support qt4 quicktime readline reflection samba scanner sdl session sndfile speex spell spl sqlite sse sse2 ssl startup-notification svg tcl tcpd theora threads tiff tk truetype truetype-fonts type1-fonts unicode usb vcd vorbis wxwindows x264 xine xml xorg xosd xprint xsl xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse joystick wacom evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="it" USERLAND="GNU" VIDEO_CARDS="vesa nvidia"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Samuli Suominen (RETIRED)






          2007-05-24 16:19:01 UTC
        

Works fine here with 0.8.0-r3 and gamin-0.1.8.




Comment 2


Samuli Suominen (RETIRED)






          2007-05-24 16:21:29 UTC
        

drac@unique ~ $ zgrep -i notify /proc/config.gz 
CONFIG_INOTIFY=y
CONFIG_INOTIFY_USER=y
CONFIG_DNOTIFY=y

16443 ?        S      0:00 /usr/libexec/gam_server





Comment 3


crusaderky





          2007-05-24 17:08:56 UTC
        

Same here.

$ zgrep -i notify /proc/config.gz 
# CONFIG_I2O_LCT_NOTIFY_ON_CHANGES is not set
CONFIG_INOTIFY=y
CONFIG_INOTIFY_USER=y
CONFIG_DNOTIFY=y

The bug appeared when I recompiled everything from scratch when I passed from my old AthlonXP to my new Athlon64, so there's the possibility that it's an amd64 specific bug.
To maximize the possibilities to reproduce it, i'd suggest to build an amd64 system from scratch.




Comment 4


crusaderky





          2007-05-24 17:10:15 UTC
        

uh-oh wait... thunar is open, yet gam_server is NOT running.

$ ps -e | grep gam_server
(no results)




Comment 5


crusaderky





          2007-05-24 17:14:11 UTC
        

to make it start gam_server, I have to
1)go to Options->Advanced->Enable volume manager
2)go to the volume manager preferences

However, even with gam_server running, thunar still doesn't detect file modifications.

Even if I leave volume manager on, gam_server will not be restarted next time thunar is restarted.




Comment 6


Samuli Suominen (RETIRED)






          2007-05-24 17:40:49 UTC
        

I suggest you create a new user and try from there. Also remember to save your session. I can't get it to state where it doesn't start..




Comment 7


Samuli Suominen (RETIRED)






          2007-05-24 17:42:07 UTC
        

(In reply to comment #3)
> To maximize the possibilities to reproduce it, i'd suggest to build an amd64
> system from scratch.

Sure if you buy me one. ;)




Comment 8


crusaderky





          2007-05-24 18:07:55 UTC
        

the user i'm using is created from scratch already.
I'm not saving the session (I don't want it to remember what applications were open), nor I see any reason it should change anything...




Comment 9


Samuli Suominen (RETIRED)






          2007-05-25 14:42:48 UTC
        

Dear amd64 arch testers and developers, could you try and reproduce this? I've been trying, and asked over dozen users to try this by now and I've been only getting responses WORKSFORME.

So.. is this a real problem, or one single case in one users amd64 system?




Comment 10


crusaderky





          2007-05-25 17:23:45 UTC
        

Upgrading thunar-volman from 0.1.2 to 0.1.3_pre20070523 fixed the problem.
Volume management is still disabled.




Comment 11


crusaderky





          2007-05-25 17:25:40 UTC
        

uh-oh last famous words. it randomly worked ONLY ONCE. next time I started thunar, the problem was there again.




Comment 12


Samuli Suominen (RETIRED)






          2007-05-25 17:34:59 UTC
        

FYI, thunar-volman and volume management has nothing to do with thunar working with gamin.




Comment 13


nm (RETIRED)






          2007-05-26 07:56:38 UTC
        

It all works for me here on my AMD64. Only difference is that I'm running gentoo-sources 2.6.18-r4. Same versions of thunar, gamin, etc. I even ran the test within gnome. Soon as I type "touch foo", file "foo" magically appears in thunar without needing to refresh the view.

RESO WORKSFORME.




Comment 14


Samuli Suominen (RETIRED)






          2007-05-26 08:00:38 UTC
        

Marking as so. 

(psst. I suggest if you plan to run 2.6.21 you also use ~amd64 linux-headers and build your glibc against it for inotify stuff. It's a wild guess but can't really offer you anything more at this stage.)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

