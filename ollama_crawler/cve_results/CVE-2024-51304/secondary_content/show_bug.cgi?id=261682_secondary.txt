Title: 261682 – <=x11-misc/slim-1.3.1-r4 does not end X with the "exit" command
URL: https://bugs.gentoo.org/show_bug.cgi?id=261682

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 261682
<=x11-misc/slim-1.3.1-r4 does not end X with the "exit" command
Last modified: 2011-10-13 20:36:06 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 261682 
      - <=x11-misc/slim-1.3.1-r4 does not end X with the "exit" command


Summary:
<=x11-misc/slim-1.3.1-r4 does not end X with the "exit" command
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       minor
      


Assignee:

Ian Stakenvicius (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-03-08 13:38 UTC by Michal Janke





      Modified:
    
2011-10-13 20:36 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



chewi
desktop-misc









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Makes slim exit as root, which seems to prevent X from coming back up.

              (exit.patch,597 bytes,
                patch)

            
2009-03-08 13:41 UTC,

            Michal Janke




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michal Janke





          2009-03-08 13:38:04 UTC
        

When issuing "exit" command (given as username), slim returns back to an empty X session. Need to close X manually afterwords. This is not what I would expect - seems logical that "exit" should leave no X running and back to the console.

Reproducible: Always

Steps to Reproduce:
1. Emerge slim.
2. Run "slim -d" manually as root, or set "XSESSION=slim" and start xdm.
3. At the slim prompt, enter "exit" as username.

Actual Results:  
Slim exits, but X restarts.

Expected Results:  
Both slim and X are closed, user back at the tty.

This has been happening for a long time, my recent upgrade to baselayout-2.0* and Openrc did not influence the behavior. Nor did adding/removing any of the listed LDFLAGS.
I've come up pwith a patch though (see next comment).

Portage 2.2_rc23 (default/linux/x86/2008.0/desktop, gcc-4.1.2, glibc-2.6.1-r0, 2.6.24-tuxonice-r9_conSomol i686)
=================================================================
System uname: Linux-2.6.24-tuxonice-r9_conSomol-i686-Intel-R-_Pentium-R-_III_Mobile_CPU_1200MHz-with-glibc2.0
Timestamp of tree: Sat, 07 Mar 2009 22:15:01 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p39
dev-java/java-config: 1.3.7-r1, 2.1.6-r1
dev-lang/python:     2.5.2-r7
dev-python/pycrypto: 2.0.1-r6
dev-util/ccache:     2.4-r7
dev-util/cmake:      2.4.8
sys-apps/baselayout: 2.0.0
sys-apps/openrc:     0.4.3-r1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.4_p6, 1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-pipe -O2 -march=pentium3m -mcpu=pentium3m -mtune=pentium3m -fomit-frame-pointer -fno-ident"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-pipe -O2 -march=pentium3m -mcpu=pentium3m -mtune=pentium3m -fomit-frame-pointer -fno-ident -fvisibility-inlines-hidden"
DISTDIR="/usr/portage/distfiles"
FEATURES="ccache distcc distlocks fixpackages notitles parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="pl_PL.UTF-8"
LC_ALL="pl_PL.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--hash-style=gnu -Wl,--as-needed"
LINGUAS="pl en_GB"
MAKEOPTS="-j6"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/mnt/windows/.portage"
PORTDIR_OVERLAY="/mnt/windows/.portage/local/layman/Eaedificata /mnt/windows/.portage/local/layman/sectools /mnt/windows/.portage/local/layman/desktop-effects /mnt/windows/.portage/local/layman/gnash-cvs /mnt/windows/.portage/local/layman/allenjb /usr/local/portage/my_added"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="X aalib acl acpi alsa atm berkdb bluetooth branding bzip2 cairo cdr cli cracklib crypt cups dbus dri drm dvd dvdr dvdread eds emboss encode evo fam fbcon ffmpeg fftw firefox fortran gcj gdbm gif glx gpm gstreamer gtk hal icc iconv isdnlog java jpeg kde ldap libnotify loop-aes mad madwifi midi mikmod mime mmx mozdom mp3 mpeg mplayer mudflap ncurses new-login nls nptl nptlonly ogg opengl openmp pam pcmcia pcre pdf perl png ppds pppd python qt3 qt3support qt4 quicktime readline reflection sdl session slang sockets socks5 spell spl sse ssl startup-notification svg synaptics sysfs tcpd tetex tiff tlen truetype unicode usb vcd vim-syntax vorbis wifi win32codecs x86 xcb xine xml xorg xosd xscreensaver xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2 canon" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="pl en_GB" LIRC_DEVICES="sir serial" USERLAND="GNU" VIDEO_CARDS="radeon"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Michal Janke





          2009-03-08 13:41:05 UTC
        

Created attachment 184331 [details, diff]
Makes slim exit as root, which seems to prevent X from coming back up.

Not sure if this is a safe solution. Please comment!




Comment 2


Michal Janke





          2009-03-08 13:51:58 UTC
        

This might also be important. I'm running:
mesa-6.5.2-r1 with xcb and nptl, driver: radeon
xorg-server-1.3.0.0-r6 nptl, sdl, dri

xorg.conf settings do not seem to have any influence. Or I haven't tried the right ones - please tell me then.




Comment 3


Lars Wendler (Polynomial-C) (RETIRED)






          2009-03-08 14:00:33 UTC
        

This might be realted to bug #261359




Comment 4


Michal Janke





          2009-03-08 14:24:28 UTC
        

(In reply to comment #3)
> This might be realted to bug #261359
> 

Nope - no such behavior on my machine.




Comment 5


Lars Wendler (Polynomial-C) (RETIRED)






          2009-03-08 14:36:13 UTC
        

(In reply to comment #3)
> This might be realted to bug #261359

stupid typos ;)

Reassigning to maintainer, CCing desktop-misc herd.






Comment 6


Jeremy Olexa (darkside) (RETIRED)








          2009-03-10 04:50:06 UTC
        

(In reply to comment #1)
> Created an attachment (id=184331) [edit]
> Makes slim exit as root, which seems to prevent X from coming back up.
> 
> Not sure if this is a safe solution. Please comment!
> 

I'll test it out soon. Thanks for the investigation. I never knew about the 'exit' user before.




Comment 7


Jeremy Olexa (darkside) (RETIRED)








          2009-03-25 03:56:15 UTC
        

(In reply to comment #1)
> Created an attachment (id=184331) [edit]
> Makes slim exit as root, which seems to prevent X from coming back up.
> 
> Not sure if this is a safe solution. Please comment!
> 

This patch doesn't do anything for me. Same behavior before and after.




Comment 8


Michal Janke





          2009-03-25 14:54:43 UTC
        

(In reply to comment #4)
> (In reply to comment #3)
> > This might be realted to bug #261359
> > 
> 
> Nope - no such behavior on my machine.
> 

Well - you were actually right here. My bad. I've just realised I had modified /etc/init.d/xdm some time ago, but totally forgot it. The modified script detects if slim is running and if so, kills it brutally.




Comment 9


Jeremy Olexa (darkside) (RETIRED)








          2009-03-25 23:56:37 UTC
        

guess it is a dupe then, thx for the reply

*** This bug has been marked as a duplicate of bug 261359 ***




Comment 10


Michal Janke





          2009-03-26 00:20:42 UTC
        

(In reply to comment #9)
> guess it is a dupe then, thx for the reply
> 
> *** This bug has been marked as a duplicate of bug 261359 ***
> 

NOT AT ALL! Might be related, but the symptoms decribed here are BY FAR different. Please read both descriptions at least twice more.




Comment 11


Michal Janke





          2009-03-26 00:30:18 UTC
        

(In reply to comment #7)
> (In reply to comment #1)
> > Created an attachment (id=184331) [edit]
> > Makes slim exit as root, which seems to prevent X from coming back up.
> > 
> > Not sure if this is a safe solution. Please comment!
> > 
> 
> This patch doesn't do anything for me. Same behavior before and after.
> 

I've tried reproducing the behavior in several ways, but didn't get the same results as before. Will try to clear that out ASAP. Right now, I'm not too convinced wether or not this patch was the reason I got slim to log out correctly. Sorry for the mess in that matter  :/




Comment 12


Ian Stakenvicius (RETIRED)






          2011-08-22 15:03:50 UTC
        

Could you confirm whether the issue still exists in slim-1.3.2-r5 ?  If not, i would like to close this bug.




Comment 13


Ian Stakenvicius (RETIRED)






          2011-10-13 20:36:06 UTC
        

Ok, this has been around long enough methinks; please reopen or file a new bug if this pops up again in the newer slims.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

