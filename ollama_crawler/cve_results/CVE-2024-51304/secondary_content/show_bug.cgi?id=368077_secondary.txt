Title: 368077 – sys-apps/openrc-0.8.2-r1: services needing net.eth0 don't wait for it when net.eth0 is hotplugged
URL: https://bugs.gentoo.org/show_bug.cgi?id=368077

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 368077
sys-apps/openrc-0.8.2-r1: services needing net.eth0 don't wait for it when net.eth0 is hotplugged
Last modified: 2013-04-25 23:08:12 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 368077 
      - sys-apps/openrc-0.8.2-r1: services needing net.eth0 don't wait for it when net.eth0 is hotplugged


Summary:
sys-apps/openrc-0.8.2-r1: services needing net.eth0 don't wait for it when ne...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Hosted Projects




Classification:

Unclassified




Component:

OpenRC

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

OpenRC Team








URL:







Whiteboard:
openrc:oldnet  
  


Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-05-19 17:33 UTC by Pacho Ramos





      Modified:
    
2013-04-25 23:08 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



DuPol









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




rc.log

              (rc.log,6.17 KB,
                text/plain)

            
2011-05-19 17:34 UTC,

            Pacho Ramos




Details





rc.conf

              (rc.conf,5.30 KB,
                text/plain)

            
2011-05-19 17:34 UTC,

            Pacho Ramos




Details





/etc/conf.d/net

              (net,1.03 KB,
                text/plain)

            
2011-05-19 17:34 UTC,

            Pacho Ramos




Details





dmesg output

              (dmesg.out,29.70 KB,
                text/plain)

            
2011-05-19 17:35 UTC,

            Pacho Ramos




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Pacho Ramos






          2011-05-19 17:33:48 UTC
        

I am experiencing issues when setting:
rc_hotplug="*"

in my /etc/rc.conf. That makes net.eth0 to be automatically started and I see the following:

net.lo               | *     127.0.0.0/8 via 127.0.0.1 ...
 [ ok ]
net.eth0             | * Bringing up interface eth0
net.eth0             | *   Starting ifplugd on eth0 ...
 [ ok ]
net.eth0             | *     Backgrounding ...
net.eth0             | * WARNING: net.eth0 has started, but is inactive


As you can see, net.eth0 is started but "inactive" => I have seen this message for a long time without issues as, later, services were waiting a bit for net.eth0 to be active but, when net.eth0 is started by hotplug instead of manually added to "boot" runlevel, other services don't wait for it failing as follows:

ntp-client           |Exiting, name server cannot be used: Temporary failure in name resolution (-3) * Failed to set clock
 [ !! ]
ntp-client           | * ERROR: ntp-client failed to start

My emerge --info:

Portage 2.1.9.47 (default/linux/amd64/10.0/desktop/gnome, gcc-4.4.5, glibc-2.11.3-r0, 2.6.38-gentoo-r1 x86_64)
=================================================================
System uname: Linux-2.6.38-gentoo-r1-x86_64-AMD_Athlon-tm-_64_Processor_3200+-with-gentoo-2.0.2
Timestamp of tree: Thu, 12 May 2011 11:30:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:          4.1_p9
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.1-r1, 3.1.3-r1
dev-util/ccache:          2.4-r9
dev-util/cmake:           2.8.4-r1
sys-apps/baselayout:      2.0.2
sys-apps/openrc:          0.8.2-r1
sys-apps/sandbox:         2.4
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:       2.20.1-r1
sys-devel/gcc:            4.4.5
sys-devel/gcc-config:     1.4.1-r1
sys-devel/libtool:        2.2.10
sys-devel/make:           3.81-r2
sys-kernel/linux-headers: 2.6.36.1 (virtual/os-headers)
sys-libs/glibc:           2.11.3
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=native -O2 -pipe"
DISTDIR="/usr/distfiles"
FEATURES="assume-digests binpkg-logs ccache distlocks fixlafiles fixpackages multilib-strict news parallel-fetch protect-owned sandbox sfperms sign split-log strict test test-fail-continue unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="ftp://ftp.free.fr/mirrors/ftp.gentoo.org http://ftp.ussg.iu.edu/linux/gentoo http://mirror.ovh.net/gentoo-distfiles/ http://ftp.heanet.ie/pub/gentoo/"
LANG="es_ES.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed -Wl,--hash-style=gnu"
LINGUAS="es es_ES en_US"
MAKEOPTS="-j2"
PKGDIR="/usr/local/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/sunrise /usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac acl acpi alsa amd64 applet avahi bash-completion berkdb branding bzip2 cairo cdda cddb cdinstall cdr cdrom cleartype cli consolekit cracklib crypt css cups cxx daap dbus djvu dri dts dvd dvdr dvi eds emboss encode evo exif fam fat ffmpeg firefox flac fortran fuse gdbm gdu gif git gnome gnome-keyring gpm gstreamer gtk hddtemp iconv java jpeg kpathsea latex lcdfilter lcms libnotify lm_sensors lyx lzma mad mmx mmxext mng modules mono mp3 mp4 mpeg mudflap multilib musicbrainz nautilus ncurses network network-cron nls nptl nptlonly ntfs nvidia ogg opengl openmp pam pango pch pcre pdf perl png policykit ppds pppd python qt3support qt4 readline reiserfs scanner sdl session sound spell sse sse2 sse3 ssl startup-notification subversion svg sysfs t1lib tcpd test threads tiff truetype udev unicode usb v4l2 vcd vorbis webkit x264 xattr xcb xml xmp xorg xpm xulrunner xv xvid zeroconf zlib" ALSA_CARDS="via82xx" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="es es_ES en_US" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nvidia vesa" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS


Reproducible: Always




Comment 1


Pacho Ramos






          2011-05-19 17:34:09 UTC
        

Created attachment 273991 [details]
rc.log




Comment 2


Pacho Ramos






          2011-05-19 17:34:26 UTC
        

Created attachment 273993 [details]
rc.conf




Comment 3


Pacho Ramos






          2011-05-19 17:34:56 UTC
        

Created attachment 273995 [details]
/etc/conf.d/net




Comment 4


Pacho Ramos






          2011-05-19 17:35:31 UTC
        

Created attachment 273997 [details]
dmesg output




Comment 5


Robin Johnson









          2011-12-27 01:33:14 UTC
        

If you disable ifplug/netplug, does it work.




Comment 6


Pacho Ramos






          2012-01-04 11:12:11 UTC
        

Looks like it works for some time without changing anything :-/









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

