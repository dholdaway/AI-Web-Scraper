Title: 325415 – sys-apps/gnome-disk-utility-2.30: fails to automount external disk if ck-launch-session is not exec
URL: https://bugs.gentoo.org/show_bug.cgi?id=325415

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 325415
sys-apps/gnome-disk-utility-2.30: fails to automount external disk if ck-launch-session is not exec
Last modified: 2010-06-28 04:35:59 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 325415 
      - sys-apps/gnome-disk-utility-2.30: fails to automount external disk if ck-launch-session is not exec


Summary:
sys-apps/gnome-disk-utility-2.30: fails to automount external disk if ck-laun...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




gnome2.30



 

        Show dependency tree





 





      Reported:
    
2010-06-24 21:56 UTC by Stelian Ionescu





      Modified:
    
2010-06-28 04:35 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



freedesktop-bugs









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Stelian Ionescu





          2010-06-24 21:56:55 UTC
        

Running latest gnome 2.30

When attaching an USB disk, I get an error dialog "Unable to mount location Not authorized".
udisks --monitor-detail shows the device being recognized but then I only get the error message; OTOH manually running «udisks --mount /dev/sdb1» as regular user works, so my guess is that something wrong is happening with polkit permissions wrt. automounting. If I try to unmount the disk using Nautilus, unmounting works but I get another error dialog: "Unable to stop drive Not authorized".

Is it possible to trace polkitd or dbus just like with the udisks daemon ?




Comment 1


Stelian Ionescu





          2010-06-24 21:57:18 UTC
        

Portage 2.2_rc67 (default/linux/x86/10.0/desktop, gcc-4.4.4, glibc-2.11.2-r0, 2.6.33-tuxonice-r2 i686)
=================================================================
System uname: Linux-2.6.33-tuxonice-r2-i686-Intel-R-_Pentium-R-_M_processor_1.73GHz-with-gentoo-2.0.1
Timestamp of tree: Thu, 24 Jun 2010 16:15:03 +0000
app-shells/bash:     4.1_p7
dev-java/java-config: 2.1.11
dev-lang/python:     2.6.5-r2
dev-util/cmake:      2.8.1-r2
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.1-r1
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.65-r1
sys-devel/automake:  1.4_p6-r1, 1.5-r1, 1.6.3-r1, 1.7.9-r2, 1.8.5-r4, 1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.4.4-r1
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.10
virtual/os-headers:  2.6.34
ACCEPT_KEYWORDS="x86 ~x86"
ACCEPT_LICENSE="* -@EULA GPL-1 GPL-2 LGPL-2 LGPL-2.1 LLGPL-2.1 FDL-1.1 MPL-1.0 MPL-1.1 Apache-2.0 Artistic BSD MIT X11 skype-eula dlj-1.1"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -ggdb -march=pentium-m -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/eselect/postgresql /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev /lib/modules"
CXXFLAGS="-O2 -ggdb -march=pentium-m -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--with-bdeps n"
FEATURES="assume-digests candy collision-protect distlocks fixpackages news parallel-fetch prelink preserve-libs protect-owned sandbox severe sfperms sign strict unmerge-logs unmerge-orphans userfetch userpriv usersandbox"
GENTOO_MIRRORS="		http://mirror.switch.ch/ftp/mirror/gentoo 		http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo 		http://gentoo.osuosl.org"
LANG="en_US.UTF-8"
LC_ALL="en_US.UTF-8"
LDFLAGS="-Wl,-O1,--hash-style=gnu,--sort-common,--reduce-memory-overheads,--as-needed,--enable-new-dtags"
LINGUAS="en"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_EXTRA_OPTS="--human-readable --progress"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp/build"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/home/hechee/lisp/gentoo-lisp-overlay /usr/local/overlays/desktop-effects /usr/local/overlays/ste"
SYNC="rsync://rsync3.fr.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi adns afs alsa apache2 automount bash-completion berkdb bluetooth branding bzip2 cairo caps cdparanoia cdr cjk cli consolekit cracklib crypt cups curl cxx dbus dga djvu dri dts dv dvb dvd dvdr dvi eds emacs emboss encode exif expat fam fbcon ffmpeg fftw flac fortran ftp fuse gd gdbm gif gmp gnome-keyring gphoto2 gpm gps graphviz gs gtk gtkhtml guile hal iconv idn ieee1394 imagemagick imap imlib ipv6 irc javascript jpeg jpeg2k kdehiddenvisibility latex lcms libffi libnotify live mad mmap mmx mng modules mp3 mp4 mpeg mudflap mysql nautilus ncurses network networkmanager nfs nls nptl nptlonly nsplugin offensive ogg openexr opengl openmp paludis_hooks_eselect pam pango pcmcia pcre pdf perl pic png postgres ppds pppd pulseaudio python qdbm qt3support qt4 readline reflection ruby samba sasl scanner sdl session slang sndfile socks5 speex spell spl sqlite sse sse2 ssl startup-notification svg sysfs syslog tetex theora threads tiff truetype udev unicode urandom usb v4l v4l2 vcd vhosts vim-syntax vorbis webkit win32codecs wmf x264 x86 xcb xft xine xml xorg xpm xulrunner xv xvid zlib zsh-completion" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="asis proxy proxy_balancer proxy_connect proxy_http" APACHE2_MPMS="prefork" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse synaptics ps2mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en" LIRC_DEVICES="all" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="radeon vesa" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS





Comment 2


Pacho Ramos






          2010-06-24 22:04:20 UTC
        

Please attach ~/.xsession-errors file just after getting the error




Comment 3


Stelian Ionescu





          2010-06-24 22:05:50 UTC
        

Found a fix on the ArchLinux
forum(http://bbs.archlinux.org/viewtopic.php?id=92506): the session should be
started with «ck-start-session gnome-session»





Comment 4


Stelian Ionescu





          2010-06-24 22:09:53 UTC
        

Oops, that should be ck-launch-session




Comment 5


Stelian Ionescu





          2010-06-24 22:18:45 UTC
        

More specifically, I created ~/.gnomerc and put «exec ck-launch-session gnome-session "${@}"» into it, and gdm now starts the session correctly




Comment 6


Pacho Ramos






          2010-06-25 13:09:00 UTC
        

Are you using gdm for login in? What gdm version are you using?




Comment 7


Pacho Ramos






          2010-06-25 13:10:59 UTC
        

Probably the same as bug 257763




Comment 8


Stelian Ionescu





          2010-06-25 13:15:18 UTC
        

I'm using gdm 2.20.11

It's probably the same bug, although I'm surprised that automounting worked until 2.30 - perhaps because previously nautilus used HAL ?




Comment 9


Stelian Ionescu





          2010-06-25 18:23:37 UTC
        

I take it back. After rebooting the system it stopped working, even if using ck-launch-session. I'll remove consolekit and recompile everything that depends on it, then try again




Comment 10


Pacho Ramos






          2010-06-26 09:15:45 UTC
        

(if I don't misremember, nautilus relies on g-d-u for this)




Comment 11


Stelian Ionescu





          2010-06-26 09:58:26 UTC
        

I checked again, and palimpsest(g-d-u's GUI) works but nautilus doesn't.
Also, nautilus-2.30-r1.ebuild doesn't depend on g-d-u at all, so I'm not sure how it's mounting disks




Comment 12


Mart Raudsepp






          2010-06-26 19:40:09 UTC
        

gvfs[gdu] pulls it in iirc




Comment 13


Pacho Ramos






          2010-06-27 11:32:54 UTC
        

(In reply to comment #2)
> Please attach ~/.xsession-errors file just after getting the error
> 

This is still missing ;-), thanks




Comment 14


Stelian Ionescu





          2010-06-27 11:35:51 UTC
        

no error message is output to ~/.xsession-errors when the mounting fails




Comment 15


Pacho Ramos






          2010-06-27 11:57:17 UTC
        

Do you suffer the same problem on a new created user account? Are you using gvfs-1.6.2 ? Have you updated your gnome packages using list attached in bug 324077 ?




Comment 16


Stelian Ionescu





          2010-06-27 17:38:29 UTC
        

All my GNOME packages were already up-to-date, including gvfs, but trying with a fresh user worked.




Comment 17


Pacho Ramos






          2010-06-27 18:00:40 UTC
        

(In reply to comment #16)
> All my GNOME packages were already up-to-date, including gvfs, but trying with
> a fresh user worked.
> 

Then this is caused by some old configuration in your home directory (and then, this bug will be closed). To see this reopened, please post exact steps for reproducing the bug on new created user account

Best regards




Comment 18


Stelian Ionescu





          2010-06-27 19:46:41 UTC
        

Any idea on how to debug this ? I'd rather not have to wipe out ~/.gconf entirely




Comment 19


Nirbheek Chauhan (RETIRED)






          2010-06-28 04:35:59 UTC
        

(In reply to comment #18)
> Any idea on how to debug this ? I'd rather not have to wipe out ~/.gconf
> entirely
> 

Try moving away various configuration files and re-trying. F.ex: mv .gnome2 .gnome2_backup; relogin; see if it works, etc. Once you find the offending directory, try it with it's sub directories and so on.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

