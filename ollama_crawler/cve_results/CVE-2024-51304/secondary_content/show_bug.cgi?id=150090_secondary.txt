Title: 150090 – gcc-4.1.1 doesn't build on amd64 due to kinds.h missing / gfortran crash
URL: https://bugs.gentoo.org/show_bug.cgi?id=150090

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 150090
gcc-4.1.1 doesn't build on amd64 due to kinds.h missing / gfortran crash
Last modified: 2007-11-19 03:08:44 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 150090 
      - gcc-4.1.1 doesn't build on amd64 due to kinds.h missing / gfortran crash


Summary:
gcc-4.1.1 doesn't build on amd64 due to kinds.h missing / gfortran crash
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-10-04 12:14 UTC by Tom Bachmann





      Modified:
    
2007-11-19 03:08 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Tom Bachmann





          2006-10-04 12:14:26 UTC
        

Emerging gcc 4.1.1 fails while building libgfortran, excerpt of the log:
config.status: executing default-1 commands
Adding multilib support to Makefile in /var/tmp/portage/gcc-4.1.1/work/gcc-4.1.1/libgfortran
with_multisubdir=32
config.status: executing gstdint.h commands
config.status: executing gstdint.h commands
make[3]: Entering directory `/var/tmp/portage/gcc-4.1.1/work/build/x86_64-pc-linux-gnu/libgfortran'
/bin/sh /var/tmp/portage/gcc-4.1.1/work/gcc-4.1.1/libgfortran/mk-sik-inc.sh '/var/tmp/portage/gcc-4.1.1/work/build/./gcc/gfortran -B/var/tmp/portage/gcc-4.1.1/work/build/./gcc/ -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include -I . -Wall -fno-repack-arrays -fno-underscoring ' > selected_int_kind.inc || rm selected_int_kind.inc
/bin/sh /var/tmp/portage/gcc-4.1.1/work/gcc-4.1.1/libgfortran/mk-srk-inc.sh '/var/tmp/portage/gcc-4.1.1/work/build/./gcc/gfortran -B/var/tmp/portage/gcc-4.1.1/work/build/./gcc/ -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include -I . -Wall -fno-repack-arrays -fno-underscoring ' > selected_real_kind.inc || rm selected_real_kind.inc
/bin/sh /var/tmp/portage/gcc-4.1.1/work/gcc-4.1.1/libgfortran/mk-kinds-h.sh '/var/tmp/portage/gcc-4.1.1/work/build/./gcc/gfortran -B/var/tmp/portage/gcc-4.1.1/work/build/./gcc/ -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include -I . -Wall -fno-repack-arrays -fno-underscoring ' > kinds.h || rm kinds.h
/var/tmp/portage/gcc-4.1.1/work/gcc-4.1.1/libgfortran/mk-kinds-h.sh: Unknown type
grep '^#' < kinds.h > kinds.inc
/bin/sh: kinds.h: Datei oder Verzeichnis nicht gefunden
make[3]: *** [kinds.inc] Fehler 1
make[3]: Leaving directory `/var/tmp/portage/gcc-4.1.1/work/build/x86_64-pc-linux-gnu/libgfortran'
make[2]: *** [all-target-libgfortran] Fehler 2
make[2]: Leaving directory `/var/tmp/portage/gcc-4.1.1/work/build'
make[1]: *** [all] Fehler 2
make[1]: Leaving directory `/var/tmp/portage/gcc-4.1.1/work/build'
make: *** [profiledbootstrap] Fehler 2

!!! ERROR: sys-devel/gcc-4.1.1 failed.
Call stack:
  ebuild.sh, line 1546:   Called dyn_compile
  ebuild.sh, line 937:   Called src_compile
  ebuild.sh, line 1255:   Called toolchain_src_compile
  toolchain.eclass, line 24:   Called gcc_src_compile
  toolchain.eclass, line 1535:   Called gcc_do_make
  toolchain.eclass, line 1409:   Called die

!!! emake failed with profiledbootstrap
!!! If you need support, post the topmost build error, and the call stack if relevant.

Digging a little deeper, the script (mk-kinds-h.sh) fails because the newly built gfortran always crashes:
/var/tmp/portage/gcc-4.1.1/work/build/./gcc/gfortran -B/var/tmp/portage/gcc-4.1.1/work/build/./gcc/ -B/usr/x86_64-pc-linux-gnu/bin/ -B/usr/x86_64-pc-linux-gnu/lib/ -isystem /usr/x86_64-pc-linux-gnu/include -isystem /usr/x86_64-pc-linux-gnu/sys-include -I . -Wall -fno-repack-arrays -fno-underscoring  -c tmp13547.f90
init2.c:38:  assertion failed: ((32 - 0)+0) == (((32 - 0)+0)/8) * 8 && sizeof(mp_limb_t) == (((32 - 0)+0)/8)
<built-in>:0: internal compiler error: Abgebrochen
Please submit a full bug report,
with preprocessed source if appropriate.
See <URL:http://bugs.gentoo.org/> for instructions.

emerge --info:
Portage 2.1.1-r1 (default-linux/amd64/2005.0, gcc-3.4.6, glibc-2.4-r3, 2.6.17-gentoo-r8 x86_64)
=================================================================
System uname: 2.6.17-gentoo-r8 x86_64 AMD Athlon(tm) 64 Processor 2800+
Gentoo Base System version 1.12.5
Last Sync: Wed, 04 Oct 2006 10:30:08 +0000
ccache version 2.3 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.2.11-r1
dev-lang/python:     2.3.5-r2, 2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64 -O3 -pipe -fomit-frame-pointer -mfpmath=sse -msse2 -mmmx -m3dnow"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-march=athlon64 -O3 -pipe -fomit-frame-pointer -mfpmath=sse -msse2 -mmmx -m3dnow"
DISTDIR="/var/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo ftp://ftp.uni-erlangen.de/pub/mirrors/gentoo"
LANG="de_DE.utf8"
LC_ALL="de_DE.utf8"
LDFLAGS="-Wl,-O1"
LINGUAS="de"
MAKEOPTS="-j2"
PKGDIR="/var/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/var/portage"
PORTDIR_OVERLAY="/usr/local/gentoo-de /usr/local/my_portage /usr/portage/local/layman/sunrise"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X aac alsa avi bash-completion berkdb bzip2 cdr crypt cups divx4linux dvd dvdr elibc_glibc encode escreen fam flac foomaticdb fortran ftp gdbm gif gpm gtk gtk2 imlib input_devices_keyboard input_devices_mouse java jpeg jpeg2k kernel_linux libg++ libwww linguas_de mad matroska mikmod mng motif mozsvg mpeg ncurses nls nptl nptlonly ogg oggvorbis openal opengl pam pdflib php phyton png quicktime readline samba sdl slang speex spell ssl svg tcpd theora tiff truetype unicode usb userland_GNU video_cards_nv vorbis xml2 xmms xv xvid zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


SpanKY






          2006-10-04 14:00:13 UTC
        

i see you're using some lame CFLAGS

rebuild mpfr/gmp with CFLAGS=-O2 and then see if gcc-4.1.1 builds




Comment 2


Tom Bachmann





          2006-10-05 07:14:38 UTC
        

(In reply to comment #1)
> rebuild mpfr/gmp with CFLAGS=-O2 and then see if gcc-4.1.1 builds
> 

Exactly the same outcome as described above.




Comment 3


Tom Bachmann





          2006-11-18 09:45:59 UTC
        

(In reply to comment #0)
> Emerging gcc 4.1.1 fails while building libgfortran, excerpt of the log:
> [...]

the same happens when emerging gcc-4.1.1-r1




Comment 4


Steve





          2007-01-04 12:21:57 UTC
        

This doesn't build on i386 either.

emerge --info
Portage 2.1.1-r2 (default-linux/x86/2006.1/desktop, gcc-4.1.1, glibc-2.4-r4, 2.6.18-gentoo-r5 i586)
=================================================================
System uname: 2.6.18-gentoo-r5 i586 AMD-K6(tm) 3D processor
Gentoo Base System version 1.12.6
Last Sync: Thu, 04 Jan 2007 19:50:01 +0000
ccache version 2.4 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.3.5-r2, 2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-Os -march=k6 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-Os -march=k6 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks fixpackages metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://gentoo.chem.wisc.edu/gentoo/ ftp://gentoo.ccccom.com"
LINGUAS="en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.us.gentoo.org/gentoo-portage"
USE="x86 X apache2 arts bash-completion berkdb bitmap-fonts browserplugin bzip2 cairo cli cracklib crypt dbus dlloader dri dvd eds elibc_glibc emboss encode esd ethereal fam firefox fortran gdbm gif gnome gpm gstreamer gtk gtk2 iconv input_devices_evdev input_devices_keyboard input_devices_mouse ipv6 isdnlog java javascript jpeg kernel_linux ldap libg++ linguas_en mad mailwrapper mikmod motif mozilla mp3 mpeg mysql mythtv ncurses nls nptl nptlonly nptlpcre nsplugin ogg opengl oss pam pcre pdf perl png ppds pppd python qt3 qt4 quicktime readline reflection samba sdl session snmp sockets spell spl ssl symlink tcl tcltk tcpd tk truetype truetype-fonts type1-fonts udev unicode userland_GNU vorbis win32codecs xml xorg xv zip zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 5


Mark Loeser (RETIRED)






          2007-11-19 03:08:44 UTC
        

I can't reproduce this with gcc-4.1.2.  Reopen if this is still a problem.  Thanks









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

