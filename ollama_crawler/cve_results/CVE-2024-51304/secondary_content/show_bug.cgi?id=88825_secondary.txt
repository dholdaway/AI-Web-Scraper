Title: 88825 – fritzcapi ebuild, produced fcusb.ko doesn't work with the old Fritzcard USB
URL: https://bugs.gentoo.org/show_bug.cgi?id=88825

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 88825
fritzcapi ebuild, produced fcusb.ko doesn't work with the old Fritzcard USB
Last modified: 2005-04-19 07:11:25 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 88825 
      - fritzcapi ebuild, produced fcusb.ko doesn't work with the old Fritzcard USB


Summary:
fritzcapi ebuild, produced fcusb.ko doesn't work with the old Fritzcard USB
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo Dialup Developers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-12 03:11 UTC by Sven Muehlberg





      Modified:
    
2005-04-19 07:11 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



sbriesen









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




output from emerge info

              (emerge_info.txt,2.45 KB,
                text/plain)

            
2005-04-13 14:02 UTC,

            Sven Muehlberg




Details





the error in syslog

              (fcusb_nok1.txt,346 bytes,
                text/plain)

            
2005-04-13 14:22 UTC,

            Sven Muehlberg




Details





ok in syslog

              (fcusb_ok.txt,553 bytes,
                text/plain)

            
2005-04-13 14:24 UTC,

            Sven Muehlberg




Details





syslog protocol for Fritz!Card USB v2.0

              (fcusb2.txt,1.66 KB,
                text/plain)

            
2005-04-13 15:18 UTC,

            Stefan Briesenick (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Sven Muehlberg





          2005-04-12 03:11:31 UTC
        

When I emerge net-dialup/fritzcapi (with fritcapi_cards=fcusb and also without) the fcusb.ko driver doesn't recognise my Fritzcard USB (Id: 057c:0c00).

If plug in the the Fritzcard the module tells me:
"Unknown device!"

If I compile the kernel module by my self and copy the fcusb.ko to /lib/modules/ (everything else the stays the same), then the driver works.


Reproducible: Always
Steps to Reproduce:
1.FRITZCAPI_CARDS="fcusb" emerge net-dialup/fritzcapi
2.modprobe fcusb
3.plug in the adapter

Actual Results:  
The kernel module tells me "Unknown device!".

Expected Results:  
The module should recognise the adapter and after capiinit i can use it.




Comment 1


Stefan Schweizer (RETIRED)






          2005-04-12 03:47:00 UTC
        

How do you compile it manually? Is there a difference in the way you build it and we build it in the ebuild?

Did you set up /etc/capi.conf correctly?

Can you please post your emerge info?




Comment 2


Sven Muehlberg





          2005-04-12 04:24:44 UTC
        

> How do you compile it manually?
1. untar the archiv fcusb-suse9.1-3.11-04.tar.gz
2. cd fritz
3. make
4. cp src/fcusb.ko /lib/modules/mykernel

> Is there a difference in the way you build it and we build it in the ebuild?
can't say now, I will look deeper into it later (when I have access to the maschine again)

> Did you set up /etc/capi.conf correctly?
Yes, I added a line 
"fcusb - - - - - -"
and it runs with the self compiled module.

> Can you please post your emerge info?
will do so later (hope I have access in about 6 hours)





Comment 3


Stefan Briesenick (RETIRED)






          2005-04-12 20:30:10 UTC
        

057c:0c00 is in the capi.usermap and it's in the capi-hotplug-script. /etc/capi.conf is not needed (should be only used if CAPI_HOTPLUG_USB=0 or =no depending on your capi4k-utils version).

I have the fcusb2 (v2.0) card. It just works. Your card should also work out-of-the-box. So either there's something different on your system compiling it manually and via fritzcapi-ebuild or we have a completely different problem.

Please do this:

emerge latest capi4k-utils (best with ~x86 so you really get the latest in portage). Unload all capi/fcusb related stuff. Then switching to system-logger output (console 12 or just tail -f /var/log/messages). Then plugin your card and watching the messages.

please post all releated messages.




Comment 4


Sven Muehlberg





          2005-04-13 14:02:04 UTC
        

Created attachment 56200 [details]
output from emerge info

This is the output from "emerge info" as requested.




Comment 5


Sven Muehlberg





          2005-04-13 14:22:50 UTC
        

Created attachment 56204 [details]
the error in syslog




Comment 6


Sven Muehlberg





          2005-04-13 14:24:52 UTC
        

Created attachment 56205 [details]
ok in syslog

this message is captured when loading the hand made module




Comment 7


Stefan Briesenick (RETIRED)






          2005-04-13 15:17:32 UTC
        

in general your setup looks sane. But something must be different.

btw: your syslog output is complete? I attach a protocol of my fcusb2 card, just for reference.

We now have to check, what's different between the ebuild and your manual compile. All I can say right now is, that the ebuild in general works for at least the Fritz!Card v2.x. But the other drivers are compiled equally.

Please try to re-compile your driver manually with CFLAGS set (so it should produce the same output) and then check the sizes between the ebuild-made driver and your self-made driver.




Comment 8


Stefan Briesenick (RETIRED)






          2005-04-13 15:18:34 UTC
        

Created attachment 56209 [details]
syslog protocol for Fritz!Card USB v2.0

just or reference.




Comment 9


Stefan Briesenick (RETIRED)






          2005-04-13 15:30:18 UTC
        

btw: modinfo fcusb

filename:       /lib/modules/2.6.11-gentoo-r6/extra/fcusb.ko
license:        Proprietary
description:    CAPI4Linux: Driver for AVM FRITZ!Card USB
vermagic:       2.6.11-gentoo-r6 preempt K7 gcc-3.4
depends:        kernelcapi,usbcore
alias:          usb:v057Cp0C00dl*dh*dc*dsc*dp*ic*isc*ip*

-rw-r--r--  1 root root 602062 14. Apr 00:26 /lib/modules/2.6.11-gentoo-r6/extra/fcusb.ko





Comment 10


Sven Muehlberg





          2005-04-14 03:27:02 UTC
        

my syslog output is smaller because I don't use hotplug and capidrv (adapter to i4l). capi20 and capifs messages are the same here, but I didn't include them.
The Fritz USB 2.0 works here to, even with the problematic kernel-module.

At the moment I have the problem, that I can't reproduce the error any more. I tried again to emerge fritzcapi an now the new compiled module (even with emerge) works (I tried before 4-5 times and it doesn't).

I will clean up my computer from isdn relatet files this evening and try then to emerge this stuff again. If the error didn't show up again, i will close this bug. Hope that is ok.






Comment 11


Sven Muehlberg





          2005-04-19 07:11:25 UTC
        

can't reproduce the error anymore.

bug closed.

thanks.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

