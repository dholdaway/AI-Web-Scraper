Title: 138496 – [glibc/build] glibc-2.3.6-r4 fails to link linuxthreads due to missing errno@GLIBC_PRIVATE
URL: https://bugs.gentoo.org/show_bug.cgi?id=138496

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 138496
[glibc/build] glibc-2.3.6-r4 fails to link linuxthreads due to missing errno@GLIBC_PRIVATE
Last modified: 2007-03-13 06:37:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 138496 
      - [glibc/build] glibc-2.3.6-r4 fails to link linuxthreads due to missing errno@GLIBC_PRIVATE


Summary:
[glibc/build] glibc-2.3.6-r4 fails to link linuxthreads due to missing errno@...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

145700

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2006-06-29 09:27 UTC by Tiago Freire





      Modified:
    
2007-03-13 06:37 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




output of readelf command as requested

              (glibc_readelf.txt,591.36 KB,
                text/plain)

            
2006-06-29 15:58 UTC,

            Tiago Freire




Details





same file, tbz2'ed

              (glibc_readelf.txt.tbz2,75.84 KB,
                application/x-bzip2)

            
2006-06-29 16:03 UTC,

            Tiago Freire




Details





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Tiago Freire





          2006-06-29 09:27:26 UTC
        

i686-pc-linux-gnu-gcc   -pie -Wl,-O1 \
   -Wl,-dynamic-linker=/lib32/ld-linux.so.2 -Wl,-z,relro -Wl,-z,now \
   -B/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/csu/ \
    \
    \
  -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/math -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/elf -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/dlfcn -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nss -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nis -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/rt -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/resolv -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/crypt -L/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/linuxthreads -Wl,-rpath-link=/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/math:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/elf:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/dlfcn:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nss:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nis:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/rt:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/resolv:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/crypt:/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/linuxthreads \
  -o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/nscd /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/nscd.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/connections.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/pwdcache.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/getpwnam_r.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/getpwuid_r.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/grpcache.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/getgrnam_r.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/getgrgid_r.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/hstcache.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/gethstbyad_r.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/gethstbynm2_r.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/dbg_log.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/nscd_conf.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/nscd_stat.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/cache.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/mem.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/nscd_setup_thread.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/xmalloc.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/xstrdup.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/aicache.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/initgrcache.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/gai.o /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/rt/librt.so /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/linuxthreads/libpthread_nonshared.a /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/linuxthreads/libpthread.so /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nis/libnsl.so  /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/libc_nonshared.a
/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/linuxthreads/libpthread.so: undefined reference to `errno@GLIBC_PRIVATE'
/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/linuxthreads/libpthread.so: undefined reference to `__libc_dl_error_tsd@GLIBC_PRIVATE'
/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/linuxthreads/libpthread.so: undefined reference to `__resp@GLIBC_PRIVATE'
/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/linuxthreads/libpthread.so: undefined reference to `h_errno@GLIBC_PRIVATE'
collect2: ld returned 1 exit status
make[2]: *** [/var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/nscd/nscd] Error 1
make[2]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r4/work/glibc-2.3.6/nscd'
make[1]: *** [nscd/others] Error 2
make[1]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r4/work/glibc-2.3.6'
make: *** [all] Error 2

!!! ERROR: sys-libs/glibc-2.3.6-r4 failed.
Call stack:
  ebuild.sh, line 1539:   Called dyn_compile
  ebuild.sh, line 939:   Called src_compile
  glibc-2.3.6-r4.ebuild, line 1107:   Called src_compile
  glibc-2.3.6-r4.ebuild, line 1118:   Called toolchain-glibc_src_compile
  glibc-2.3.6-r4.ebuild, line 217:   Called die




Comment 1


Tiago Freire





          2006-06-29 09:28:13 UTC
        

emerge info:

Portage 2.1-r1 (default-linux/amd64/2006.0, gcc-3.4.6/amd64-vanilla, glibc-2.3.6-r3, 2.6.15-gentoo-r1 x86_64)
=================================================================
System uname: 2.6.15-gentoo-r1 x86_64 AMD Athlon(tm) 64 Processor 3000+
Gentoo Base System version 1.6.15
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
dev-lang/python:     2.3.5-r2, 2.4.2
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1, 2.16.1-r2
sys-devel/gcc-config: 1.3.13-r2
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/NX/etc /usr/NX/home /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/X11/xkb /usr/lib64/mozilla/defaults/pref /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/"
CONFIG_PROTECT_MASK="/etc/env.d /etc/eselect/compiler /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-march=k8 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://mirror.datapipe.net/gentoo http://mirror.datapipe.net/gentoo http://gentoo.seren.com/gentoo ftp://gentoo.netnitco.net/pub/mirrors/gentoo/source/"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 3dnowex X a52 aac acl acpi aim aimextras alsa apache2 arts artswrappersuid authdaemond automount avi berkdb bidi bitmap-fonts bluetooth bootsplash browserplugin bzlib cairo calendar canna caps cdparanoia chroot cjki cli crypt css cups curlwrappers cvs dba dbus dga divx4linux doc dpms dri dv dvb dvd dvdr dvdread eds emboss encode evo fbcon fbsplash firefox foomaticdb fortran ftp gif gmail gmailtimestamps gnome gnutls gpm gstreamer gtk gtk2 hal i8x0 iconv imap imlib innodb interbase ipv6 isdnlog jabber java jpeg jpeg2k kde kdeenablefinal kdehiddenvisibility kerberos lm_sensors lzw lzw-tiff maildir mailwrapper matroska mime mjpeg mmap mono mozdevelop mozsvg mp3 mpeg mpeg2 mpeg4 mplayer mppe-mppc msn multislot mysql ncurses nethack nls nptl nsplugin ntfs nvidia oav odbc offensive oggvorbis openal opengl oss pam pcntl pcre pda pdf pdflib perl php pic png posix postgres povray ppds pppd prelude profile python qemu-fast qt qt3 qt4 quicktime rdesktop readline reflection rtc ruby samba sasl screen sdl sensord session shared slp sndfile snmp soap sockets sox spell spl sql sqlite ssl subp subversion svgz symlink tcpd theora threads tidy tiff tokenizer transcode truetype-fonts type1-fonts unicode usb utf8 vcd vcdimager vda vhosts vim vim-pager vim-with-x virus-scan visualization vnc wddx web webdav wifi win32 xmlrpc xorg xpm xprint xscreensaver xsl xv yahoo zlib elibc_glibc kernel_linux userland_GNU"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY





Comment 2


SpanKY






          2006-06-29 15:14:59 UTC
        

what does `emerge glibc -pv` show ?

and does this show:
readelf -s /var/tmp/portage/glibc-2.3.6-r4/work/build-x86-x86_64-pc-linux-gnu-linuxthreads/libc.so




Comment 3


Tiago Freire





          2006-06-29 15:58:39 UTC
        

Created attachment 90484 [details]
output of readelf command as requested

output of readelf command as requested.

also, emerge -pv glibc:
[ebuild     U ] sys-libs/glibc-2.3.6-r4 [2.3.6-r3] USE="nls nptl profile -build -erandom -glibc-compat20 -glibc-omitfp -hardened -nptlonly" 0 kB




Comment 4


Tiago Freire





          2006-06-29 16:03:19 UTC
        

Created attachment 90485 [details]
same file, tbz2'ed

Sorry, didn't look at the file size before submitting. same file, tbz2'ed




Comment 5


Tiago Freire





          2006-06-29 16:04:10 UTC
        

emerge -pv glibc:
[ebuild     U ] sys-libs/glibc-2.3.6-r4 [2.3.6-r3] USE="nls nptl profile -build -erandom -glibc-compat20 -glibc-omitfp -hardened -nptlonly" 0 kB




Comment 6


SpanKY






          2006-06-29 16:17:55 UTC
        

ah well the problem is libpthread.so wants errno@GLIBC_PRIVATE when really it should want errno@@GLIBC_PRIVATE




Comment 7


Benjamin W. Fisher





          2006-06-29 18:54:36 UTC
        

I have exact same problem here... there a quick workaround until it's fixed?




Comment 8


Jakub Moc (RETIRED)






          2006-08-31 05:10:14 UTC
        

*** Bug 145700 has been marked as a duplicate of this bug. ***




Comment 9


Tiago Freire





          2006-08-31 13:55:20 UTC
        

stable glibc 2.4-r1 suffers from the same malady...




Comment 10


SpanKY






          2007-03-13 06:37:38 UTC
        

these versions of glibc are no longer supported ... if glibc-2.5 shows issues, open a new bug report









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

