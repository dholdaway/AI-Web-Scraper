Title: 338082 – sys-apps/kbd installs to /usr instead of /
URL: https://bugs.gentoo.org/show_bug.cgi?id=338082

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 338082
sys-apps/kbd installs to /usr instead of /
Last modified: 2022-06-03 01:20:31 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 338082 
      - sys-apps/kbd installs to /usr instead of /


Summary:
sys-apps/kbd installs to /usr instead of /
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-09-19 23:08 UTC by Gustavo Sverzut Barbieri





      Modified:
    
2022-06-03 01:20 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



jstein
mgorny
sam









See Also:


446018





Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Gustavo Sverzut Barbieri





          2010-09-19 23:08:52 UTC
        

sys-apps/kbd should install to /bin, /lib and similar, instead of /usr, allowing people with /usr mounted on-top of / to be able to type their passwords using proper keyboard layouts, viewing text with proper files.

Reproducible: Always




Comment 1


Gustavo Sverzut Barbieri





          2010-09-19 23:16:33 UTC
        

note: I know /etc/init.d/{consolefont,keymaps} provides hack for that by storing the last values at /lib/rc/console, but still could be avoided by simply changing the package root.




Comment 2


Michał Górny









          2010-09-20 20:29:29 UTC
        

(In reply to comment #1)
> note: I know /etc/init.d/{consolefont,keymaps} provides hack for that by
> storing the last values at /lib/rc/console, but still could be avoided by
> simply changing the package root.

This so-called 'hack' doesn't help at all in the case you mention -- as setfont binary is in /usr anyway.




Comment 3


SpanKY






          2010-09-20 20:44:13 UTC
        

we're not moving the db of files out of /usr/share/.  that means the only files that could possibly be moved from /usr/bin/ to /bin/ are ones that do not need those mappings.  if your /usr isnt mounted, then fix your system and get it mounted.  this rarely (if ever) requires your font to be configured.

with that in mind, which programs exactly do you need in /bin/ ?




Comment 4


Gustavo Sverzut Barbieri





          2010-09-20 20:48:35 UTC
        

(In reply to comment #3)
> we're not moving the db of files out of /usr/share/.  that means the only files
> that could possibly be moved from /usr/bin/ to /bin/ are ones that do not need
> those mappings.  if your /usr isnt mounted, then fix your system and get it
> mounted.  this rarely (if ever) requires your font to be configured.
> 
> with that in mind, which programs exactly do you need in /bin/ ?

I don't see why this reasoning make any sense, and seems like other distros got bugs reported and fixed the situation, why shouldn't us?

the problem is easy to illustrate: if user has a pt_BR keyboard and thus c-cedilla (ç), and for some reason user want to have that in his password, he can't type it. This is also true for keyboard that define characters such as !@# and others in different positions as their "qwerty/us" counterparts.

okay, if we move the binaries to /bin (loadkeys, setfont) and copy the actual data files, then we may work around the problem, but why not solve it for once and for all? The fix is just to specify proper values for econf.






Comment 5


SpanKY






          2010-09-20 20:56:34 UTC
        

i dont think you're actually familiar with other distros.  Fedora absolutely does not support a split / and /usr.  Debian's file listing shows that all of its console mapping/fonts live in /usr.  so before you go throwing around "oh but other distros dont do this", you should actually quote a real life example.  otherwise, i'm not buying your snake oil and i'll simply punt this bug.

also, please refrain from useless quoting.  everyone can scroll up three whole lines to see what i said.  you dont need to paste it unmodified every time.




Comment 6


Gustavo Sverzut Barbieri





          2010-09-20 22:12:01 UTC
        

Well, at least in theory they do support. however I never tried to get it installed in such way.

Anyway, if this is a "solution" for you, why not just remove the stupid hack in openrc scripts that copy the file?




Comment 7


SpanKY






          2010-09-20 22:38:28 UTC
        

and Gentoo works just fine -- if your /usr and / are the same partition

i'm not against having things usable some way at early boot (before localmount).  but the answer is not "let's have kbd install entirely into / instead of /usr".  if you want to work on a solution, then go for it.  if you dont, then we can punt this bug until someone does.




Comment 8


Sam James









          2022-06-03 01:20:31 UTC
        

FWIW: https://github.com/OpenRC/openrc/commit/7eb3975543eafd44c6946ca5a76812aa0d7a7303.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

