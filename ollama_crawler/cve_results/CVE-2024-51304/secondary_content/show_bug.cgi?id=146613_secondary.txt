Title: 146613 – media-sound/listen-0.5_beta1 failes test suite
URL: https://bugs.gentoo.org/show_bug.cgi?id=146613

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 146613
media-sound/listen-0.5_beta1 failes test suite
Last modified: 2007-04-01 18:51:42 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 146613 
      - media-sound/listen-0.5_beta1 failes test suite


Summary:
media-sound/listen-0.5_beta1 failes test suite
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

José Alberto Suárez López (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-09-06 15:51 UTC by Christoph Mende (RETIRED)





      Modified:
    
2007-04-01 18:51 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




patch for listen-0.5_beta1.ebuild

              (listen-0.5_beta1.ebuild.patch,593 bytes,
                patch)

            
2006-10-13 06:06 UTC,

            Christoph Mende (RETIRED)




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Christoph Mende (RETIRED)






          2006-09-06 15:51:09 UTC
        

>>> Test phase [check]: media-sound/listen-0.4.3-r2 Checking for Python... /usr/bin/python
Checking Python version: 2.4
Checking for PyGTK >= 2.6:
Traceback (most recent call last):
File "./check.py", line 20, in ?
import gtk
File "/usr/lib64/python2.4/site-packages/gtk-2.0/gtk/__init__.py", line 45, in ?from _gtk import *
RuntimeError: could not open display
make: *** [check] Error 1

error still exists when I export DISPLAY=:0.0 before emerge or emerge per sudo.

multilib-strict error:
!!! File /var/tmp/portage/listen-0.4.3-r2/image///usr/lib/listen/mmkeys.so matches a file type that is not allowed in /usr/lib
output of file:
/var/tmp/portage/listen-0.4.3-r2/image/usr/lib/listen/mmkeys.so: ELF 64-bit LSB shared object, AMD x86-64, version 1 (SYSV), stripped

Portage 2.1-r2 (default-linux/amd64/2006.1/desktop, gcc-4.1.1, glibc-2.4-r3, 2.6.17-ck1-r3 x86_64)
=================================================================
System uname: 2.6.17-ck1-r3 x86_64 AMD Athlon(tm) 64 Processor 3000+
Gentoo Base System version 1.12.4
ccache version 2.3 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf"
CXXFLAGS="-march=k8 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache collision-test distlocks metadata-transfer multilib-strict parallel-fetch sandbox sfperms strict test"
GENTOO_MIRRORS="ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror/ ftp://ftp.uni-erlangen.de/pub/mirrors/gentoo ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo ftp://ftp.wh2.tu-dresden.de/pub/mirrors/gentoo ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo ftp://ftp-stud.fht-esslingen.de/pub/Mirrors/gentoo/ ftp://ftp.gentoo.mesh-solutions.com/gentoo/ ftp://pandemonium.tiscali.de/pub/gentoo/ "
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_EXTRA_OPTS="--exclude-from=/etc/portage/rsync_excludes"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/overlay"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="amd64 X a52 aac acpi alsa amr asf avi berkdb bitmap-fonts bzip2 cairo cdinstall cdparanoia cdr cli crypt cups dbus dlloader dri dvd dvdr dvdread emboss encode expat fam firefox fortran gdbm gif glut gpm gstreamer gtk gtk2 hal imagemagick isdnlog jpeg lcms ldap libg++ lirc mad mikmod mng mp3 mpeg musicbrainz ncurses nls nptl nptlonly ogg opengl pam pcre pdflib php png ppds pppd quicktime readline reflection sdl session socks5 spl ssl svg tcpd tiff truetype truetype-fonts type1-fonts udev unicode v4l v4l2 vorbis x264 xine xinerama xml xorg xv xvid zlib elibc_glibc input_devices_evdev input_devices_keyboard kernel_linux lirc_devices_inputlirc userland_GNU video_cards_fglrx"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS




Comment 1


José Alberto Suárez López (RETIRED)






          2006-10-13 04:05:57 UTC
        

I'm not an amd64 dev so i cannot fix it.
So you can try the 0.5beta

PD: just i cannot fix it, i don't hace an amd64 :P




Comment 2


Christoph Mende (RETIRED)






          2006-10-13 06:06:36 UTC
        

Created attachment 99528 [details, diff]
patch for listen-0.5_beta1.ebuild

The above bug fixes the multilib issues, test suite still fails with the above results, so now the AT stuff:

- emerges fine on amd64
- passes collision-test
- passes multilib-strict with attached patch
- works

Portage 2.1.1-r1 (default-linux/amd64/2006.1/desktop, gcc-4.1.1, glibc-2.5-r0, 2.6.18-ck1 x86_64)
=================================================================
System uname: 2.6.18-ck1 x86_64 AMD Athlon(tm) 64 Processor 3000+
Gentoo Base System version 1.12.5
Last Sync: Fri, 13 Oct 2006 12:30:01 +0000
ccache version 2.3 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-march=k8 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildsyspkg ccache collision-protect distlocks metadata-transfer multilib-strict parallel-fetch sandbox sfperms strict test"
GENTOO_MIRRORS="ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror/ ftp://ftp.uni-erlangen.de/pub/mirrors/gentoo ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo ftp://ftp.wh2.tu-dresden.de/pub/mirrors/gentoo ftp://ftp.join.uni-muenster.de/pub/linux/distributions/gentoo ftp://ftp-stud.fht-esslingen.de/pub/Mirrors/gentoo/ ftp://ftp.gentoo.mesh-solutions.com/gentoo/ ftp://pandemonium.tiscali.de/pub/gentoo/ "
LANG="en_US"
LC_ALL="en_US"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_EXTRA_OPTS="--exclude-from=/etc/portage/rsync_excludes"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/overlay"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X a52 aac acpi alsa amr berkdb bitmap-fonts branding bzip2 cairo cdinstall cdparanoia cdr cli crypt cups dbus divx dlloader dri dvd dvdr dvdread elibc_glibc emboss encode expat fam ffmpeg firefox fortran gdbm gif glut gnutls gpm gstreamer gtk gtk2 hal imagemagick input_devices_evdev input_devices_keyboard ipod isdnlog jpeg kernel_linux lcms ldap libg++ lirc lirc_devices_inputlirc logrotate mad mikmod mng mp3 mpeg musicbrainz ncurses nls nptl nptlonly offensive ogg opengl pam pcre php png ppds pppd quicktime readline reflection reiserfs rtc sdl session socks5 spl ssl svg symlink tcpd test tiff truetype truetype-fonts type1-fonts udev unicode userland_GNU userlocales v4l v4l2 video_cards_fglrx video_cards_radeon vim-with-x vorbis wmp xfs xine xinerama xml xorg xv xvid zlib zvbi"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, LINGUAS




Comment 3


Simon Stelling (RETIRED)






          2006-10-13 06:26:09 UTC
        

multilib-strict is fixed, the src_test failure doesn't look arch-specific, it's yours again :P




Comment 4


José Alberto Suárez López (RETIRED)






          2006-10-15 08:05:12 UTC
        

the src_test prblem still in 0.5_beta1-r1?

i cannot reproduce it.




Comment 5


Christoph Mende (RETIRED)






          2006-10-16 05:19:42 UTC
        

Checking for PyGTK >= 2.6:
Traceback (most recent call last):
  File "./check.py", line 20, in ?
    import gtk
  File "/usr/lib64/python2.4/site-packages/gtk-2.0/gtk/__init__.py", line 45, in ?
    from _gtk import *
RuntimeError: could not open display
make: *** [check] Error 1

Problem is simply that "import gtk" wants to connect to my DISPLAY, what fails.
The whole thing works when I extract the source and run `make check` as user or if I start a Xnest with -ac (disable access control restrictions) on :1 and run DISPLAY=:1 make check.




Comment 6


Christoph Mende (RETIRED)






          2006-10-16 15:57:39 UTC
        

Ha! I kinda got the test suite working. First I looked at the emerge progress, it said it's starting an Xfvb on DISPLAY :1 before configuring (probably for "Checking PyGTK >= 2.6 - the point where make check fails), so I tried DISPLAY=:1 emerge listen - still failing, I then tried to start a permanent Xvfb :1 (with -ac again) and emerged listen with DISPLAY=:1, this time it passed the test suite.
So the problem seems to be that the ebuild wants to access the Xvfb that it created (usually on :1), but this Xvfb does not run anymore.




Comment 7


José Alberto Suárez López (RETIRED)






          2006-11-21 14:41:18 UTC
        

really strange :/




Comment 8


José Alberto Suárez López (RETIRED)






          2007-01-21 19:56:09 UTC
        

any news about this?

i yet cannot reproduce it




Comment 9


José Alberto Suárez López (RETIRED)






          2007-04-01 18:51:42 UTC
        

sorry i cannot reproduce it.
Try the new version :)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

