Title: 395835 – dev-lang/php-5.3.9_rc3 with "zlib" use flag does not detect and include zlib support
URL: https://bugs.gentoo.org/show_bug.cgi?id=395835

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 395835
dev-lang/php-5.3.9_rc3 with "zlib" use flag does not detect and include zlib support
Last modified: 2011-12-27 19:40:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 395835 
      - dev-lang/php-5.3.9_rc3 with "zlib" use flag does not detect and include zlib support


Summary:
dev-lang/php-5.3.9_rc3 with "zlib" use flag does not detect and include zlib ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

PHP Bugs








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-12-23 19:31 UTC by Craig Andrews





      Modified:
    
2011-12-27 19:40 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



candrews









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Craig Andrews






          2011-12-23 19:31:50 UTC
        

# emerge \=dev-lang/php-5.3.9_rc3 -pv

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R    ] dev-lang/php-5.3.9_rc3  USE="apache2 bcmath berkdb bzip2 calendar cli crypt ctype curl exif fileinfo filter ftp gd gdbm gmp hash iconv imap inifile iodbc ipv6 json mhash mysql mysqli nls odbc pcntl pdo phar pic posix readline session simplexml snmp soap sockets spell sqlite ssl suhosin sysvipc tidy tokenizer truetype unicode xml xmlreader xmlrpc xmlwriter xpm xsl zip zlib -cdb -cgi -cjk -curlwrappers -debug -doc -embed -enchant -firebird -flatfile -fpm (-frontbase) -intl -kerberos -kolab -ldap -ldap-sasl -libedit -mssql -mysqlnd -oci8-instant-client -postgres -qdbm -recode -sharedmem -sqlite3 (-sybase-ct) -threads -wddx" 0 kB
# php -r 'var_dump(function_exists("gzopen"));'
bool(false)

Also, if I re-emerge php, the build log says:
checking for ZLIB support... no
checking if the location of ZLIB install directory is defined... no

So that's weird. It seems to me that:
1) If the "zlib" use flag is set and the configure script can't find zlib, the emerge should fail.
2) Why, if zlib is installed, and the use flag is set, is php not finding and using zlib?

Here's the zlib information:
# emerge zlib -pv

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R    ] sys-libs/zlib-1.2.5.1-r2  USE="minizip -static-libs" 0 kB

Reproducible: Always




# emerge --info
Portage 2.1.10.41 (default/linux/amd64/10.0, gcc-4.5.3, glibc-2.14.1-r1, 3.1.5-gentoo x86_64)
=================================================================
System uname: Linux-3.1.5-gentoo-x86_64-Intel-R-_Core-TM-2_Quad_CPU_Q9550_@_2.83GHz-with-gentoo-2.1
Timestamp of tree: Fri, 23 Dec 2011 18:15:01 +0000
distcc 3.1 x86_64-pc-linux-gnu [disabled]
ccache version 3.1.6 [enabled]
app-shells/bash:          4.2_p20
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.6.7-r2, 2.7.2-r3, 3.2.2
dev-util/ccache:          3.1.6
dev-util/cmake:           2.8.6-r4
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1
sys-apps/openrc:          0.9.7
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.10.3, 1.11.1-r1
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.5.3-r2
sys-devel/gcc-config:     1.5-r2
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r3
sys-kernel/linux-headers: 3.1 (virtual/os-headers)
sys-libs/glibc:           2.14.1-r1
Repositories: gentoo openrc webapp-experimental sunrise sabayon x-portage
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt /usr/share/maven-bin-3.0/conf"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -march=native -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--jobs=4 --load-average=4.5"
FEATURES="assume-digests binpkg-logs ccache distlocks ebuild-locks fixlafiles news parallel-fetch parallel-install protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch usersandbox webrsync-gpg"
FFLAGS=""
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/openrc /var/lib/layman/webapps-experimental /var/lib/layman/sunrise /var/lib/layman/sabayon /usr/local/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi aiglx alsa amd64 amr amrnb amrwb animation apache2 apng artworkextra asf aspnet2 asyncns authdaemond avahi avi bash-completion bcmath berkdb bitmap-fonts bluetooth bmp bonjour bzip2 cairo caps ccache cdda cddb cdparanoia cdr chm cli consolekit cracklib crypt css cups curl cxx daap dbus device-mapper dga dirac divx4linux dlloader dpms dri dts dv dvb dvd dvdr dvdread enca encode exif faac fam fame fat fbcondecor fbsplash ffmpeg fftw firefox flac fontconfig foomaticdb fortran freetype ftp gaim gd gdbm geoip gif gimpprint gles glib glibc-omitfp glitz glut gnome gphoto2 gpm gstreamer gstreamer10 gtk gtk2 hardenedphp hbci howl howl-compat https iconv imagemagick imap imlib innodb ipv6 java java5 jbig joystick jpeg jpeg2k junit kdehiddenvisibility kvm lapack lcms libfame libnotify libsamplerate libusb lirc live lm_sensors lzo mad maildir mdnsresponder-compat mjpeg mmap mms mmx mmxext mng modules mono motif mozilla mozsvg mp3 mpeg mpeg2 mplayer mudflap multilib musepack mysql mythtv ncurses nemesi network nls nptl nptlonly ntfs offensive ofx ogg oggvorbis openal openexr opengl openmp openvg pam pango pcre pdf pdflib perl phonon pic pie png pnp policykit ppd ppds pppd prelude pulseaudio python qt qt3 qt3support qt4 quicktime rar readline resolvconf rtc rtmp samba sasl schroedinger screensaver sctp sdl session sharedmem shout sni snmp sox speex spell sqlite sse sse2 ssl suspend2 svg sysfs tcpd theora threads tiff tls transcode truetype truetype-fonts type-fonts udev unicode unzip upnp ups usb v4l2 vaapi vcd videos vorbis webdav webservices wifi wmf wv x264 xanim xattr xcb xinerama xml2 xorg xpm xprint xrandr xv xvid xvmc zeroconf zip zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias auth_digest proxy proxy_ajp proxy_connect proxy_http reqtimeout cgi" CALLIGRA_FEATURES="kexi words flow plan stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev joystick keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en" LIRC_DEVICES="userspace" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="intel" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Ambroz Bizjak





          2011-12-26 12:55:46 UTC
        

I'm also affected by this. It breaks app-benchmark/phoronix-test-suite, which requires the Zip extension. Zip and zlib flags are enabled, but the Zip extension is not built.




Comment 2


Ole Markus With (RETIRED)






          2011-12-26 14:09:24 UTC
        

I cannot reproduce this with php 5.3,9_rc4. Could you upgrade and try again.




Comment 3


Craig Andrews






          2011-12-27 19:31:23 UTC
        

(In reply to comment #2)
> I cannot reproduce this with php 5.3,9_rc4. Could you upgrade and try again.

Confirmed - the problem appears to be solved with rc4.




Comment 4


Ole Markus With (RETIRED)






          2011-12-27 19:40:58 UTC
        

Excellent!









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

