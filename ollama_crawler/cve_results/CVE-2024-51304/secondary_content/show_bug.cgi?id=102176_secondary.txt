Title: 102176 – gnupg-1.4.2 couldn't compile
URL: https://bugs.gentoo.org/show_bug.cgi?id=102176

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 102176
gnupg-1.4.2 couldn't compile
Last modified: 2006-04-12 10:53:16 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 102176 
      - gnupg-1.4.2 couldn't compile


Summary:
gnupg-1.4.2 couldn't compile
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

Mac OSX

  (show other bugs)



Hardware:

PPC
        OS X
      







Importance:
      
High
       normal
      


Assignee:

Gentoo for Mac OS X








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-08-11 17:26 UTC by Martin Novak





      Modified:
    
2006-04-12 10:53 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin Novak





          2005-08-11 17:26:35 UTC
        

Hello, I wasn't able to compile gnupg-1.4.2 on OSX 10.4.

emerge -pv gnupg

[ebuild  N    ] app-crypt/gnupg-1.4.2-r1  -X +bzip2 (-caps) -curl -ecc +idea
-ldap +nls +readline (-selinux) -smartcard -usb +zlib 0 kB 

emerge info:
Portage 2.0.51.22-r2 (default-darwin/macos/10.4, gcc-4.0.0, libsystem-7.1-r0,
8.2.0 Power Macintosh)
=================================================================
System uname: 8.2.0 Power Macintosh powerpc
macos-20041118
distcc 2.0.1-zeroconf powerpc-apple-darwin7.0 (protocol 1) (default port 3632)
[disabled]
dev-lang/python:     [Not Present]
sys-apps/sandbox:    [Not Present]
sys-devel/autoconf:  [Not Present]
sys-devel/automake:  [Not Present]
sys-devel/binutils:  [Not Present]
sys-devel/libtool:   [Not Present]
virtual/os-headers:  7.1
ACCEPT_KEYWORDS="ppc-macos ~ppc-macos"
AUTOCLEAN="yes"
CBUILD="powerpc-apple-darwin"
CFLAGS="-O3 -pipe -mcpu=G4 -maltivec -mabi=altivec -fast -mpowerpc-gfxopt
-mtune=7450 -mpowerpc -fPIC -faltivec -ftree-vectorize"
CHOST="powerpc-apple-darwin"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config
/usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/env.d"
CXXFLAGS="-O3 -pipe -mcpu=G4 -maltivec -mabi=altivec -fast -mpowerpc-gfxopt
-mtune=7450 -mpowerpc -fPIC -faltivec -ftree-vectorize"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache collision-protect distlocks sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org
http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="ppc bash-completion bzip2 emboss idea ipv6 javascript libwww nls png
ppc-macos readline slang ssl tetex unicode zlib userland_Darwin kernel_Darwin
elibc_Darwin"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY

ERROR LOG:

then mv -f ".deps/shmtest.Tpo" ".deps/shmtest.Po"; else rm -f
".deps/shmtest.Tpo"; exit 1; fi
gcc  -O3 -pipe -mcpu=G4 -maltivec -mabi=altivec -fast -mpowerpc-gfxopt
-mtune=7450 -mpowerpc -fPIC -faltivec -ftree-vectorize -Wall -Wno-pointer-sign 
 -o bftest  bftest.o ../cipher/libcipher.a ../mpi/libmpi.a ../util/libutil.a 
/usr/lib/libiconv.dylib /usr/lib/libintl.dylib /usr/lib/libiconv.dylib
/usr/lib/libc.dylib      
/usr/bin/ld: multiple definitions of symbol _g10_opt_homedir
bftest.o definition of _g10_opt_homedir in section (__DATA,__common)
../cipher/libcipher.a(cipher.o) definition of _g10_opt_homedir in section
(__DATA,__common)
/usr/bin/ld: multiple definitions of symbol _g10_opt_verbose
bftest.o definition of _g10_opt_verbose in section (__DATA,__common)
../cipher/libcipher.a(cipher.o) definition of _g10_opt_verbose in section
(__DATA,__common)
/usr/bin/ld: multiple definitions of symbol _g10c_debug_mode
bftest.o definition of _g10c_debug_mode in section (__DATA,__common)
../cipher/libcipher.a(cipher.o) definition of _g10c_debug_mode in section
(__DATA,__common)
/usr/bin/ld: multiple definitions of symbol _iobuf_debug_mode
bftest.o definition of _iobuf_debug_mode in section (__DATA,__common)
../cipher/libcipher.a(cipher.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
/usr/bin/ld: multiple definitions of symbol _memory_debug_mode
bftest.o definition of _memory_debug_mode in section (__DATA,__common)
../cipher/libcipher.a(cipher.o) definition of _memory_debug_mode in section
(__DATA,__common)
/usr/bin/ld: multiple definitions of symbol _memory_stat_debug_mode
bftest.o definition of _memory_stat_debug_mode in section (__DATA,__common)
../cipher/libcipher.a(cipher.o) definition of _memory_stat_debug_mode in section
(__DATA,__common)
/usr/bin/ld: multiple definitions of symbol _mpi_debug_mode
bftest.o definition of _mpi_debug_mode in section (__DATA,__common)
../cipher/libcipher.a(cipher.o) definition of _mpi_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(des.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(des.o) definition of _memory_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(des.o) definition of _memory_stat_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(des.o) definition of _mpi_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(twofish.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(twofish.o) definition of _memory_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(twofish.o) definition of _memory_stat_debug_mode in
section (__DATA,__common)
../cipher/libcipher.a(twofish.o) definition of _mpi_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(blowfish.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(blowfish.o) definition of _memory_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(blowfish.o) definition of _memory_stat_debug_mode in
section (__DATA,__common)
../cipher/libcipher.a(blowfish.o) definition of _mpi_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(cast5.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(cast5.o) definition of _memory_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(cast5.o) definition of _memory_stat_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(cast5.o) definition of _mpi_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rijndael.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rijndael.o) definition of _memory_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rijndael.o) definition of _memory_stat_debug_mode in
section (__DATA,__common)
../cipher/libcipher.a(rijndael.o) definition of _mpi_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(random.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(random.o) definition of _memory_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(random.o) definition of _memory_stat_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(random.o) definition of _mpi_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rndlinux.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rndlinux.o) definition of _memory_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rndlinux.o) definition of _memory_stat_debug_mode in
section (__DATA,__common)
../cipher/libcipher.a(rndlinux.o) definition of _mpi_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rmd160.o) definition of _g10_opt_homedir in section
(__DATA,__common)
../cipher/libcipher.a(rmd160.o) definition of _g10_opt_verbose in section
(__DATA,__common)
../cipher/libcipher.a(rmd160.o) definition of _g10c_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rmd160.o) definition of _iobuf_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rmd160.o) definition of _memory_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rmd160.o) definition of _memory_stat_debug_mode in section
(__DATA,__common)
../cipher/libcipher.a(rmd160.o) definition of _mpi_debug_mode in section
(__DATA,__common)
/usr/bin/ld: warning multiple definitions of symbol _locale_charset
/usr/lib/libintl.dylib(localcharset.o) definition of _locale_charset
/usr/lib/libiconv.dylib(localcharset.o) definition of
_locale_charset/usr/bin/ld: warning suggest use of -bind_at_load, as lazy
binding may result in errors or different symbols being used
symbol _locale_charset used from dynamic library
/usr/lib/libintl.dylib(localcharset.o) not from earlier dynamic library
/usr/lib/libiconv.2.dylib(localcharset.o)
collect2: ld returned 1 exit status
make[2]: *** [bftest] Error 1
make[2]: *** Waiting for unfinished jobs....
make[1]: *** [all-recursive] Error 1
make: *** [all] Error 2

!!! ERROR: app-crypt/gnupg-1.4.2-r1 failed.


Reproducible: Always
Steps to Reproduce:
1.
2.
3.




Comment 1


Hasan Khalil (RETIRED)






          2005-08-11 20:30:50 UTC
        

Which version of gettext do you have installed, and with which use flags?

emerge -pv gettext




Comment 2


Kito (RETIRED)






          2005-08-11 20:39:37 UTC
        

Doesn't look like it has anything todo with gettext. try ditching the -fPIC flag.




Comment 3


Martin Novak





          2005-08-12 05:35:56 UTC
        

(In reply to comment #2)
> Doesn't look like it has anything todo with gettext. try ditching the -fPIC flag.

Hello, I tried to ditch -fPIC flag, and it hasn't helped

[ebuild     U ] sys-devel/gettext-0.14.4 [0.14.1-r1] (-doc) -emacs +nls 6,869 k






Comment 4


Kito (RETIRED)






          2005-08-12 09:05:30 UTC
        

did you re-emerge gettext without the -fPIC flag then try again? Alternatively, if you are going to try using 
the -fPIC flag on Darwin/OS X, you always need to add -fno-common as well, this prevents it from using 
the same symbol from multiple libs like its doing below.




Comment 5


Martin Novak





          2005-08-14 16:56:26 UTC
        

Hi I tried both - without -fPIC - I wasn't event able to compile gettext

with -fno-common I was able to compile gettext, but again not gnupg.

BTW. I have read some stuff in man gcc, and there is statement: "-fPIC is the
default on Darwin and Mac OS X."...




Comment 6


Lina Pezzella (RETIRED)






          2005-08-14 17:24:36 UTC
        

Have you tried scaling back your CFLAGS to something relatively harmless such as "-O2 -pipe"? It 
compiles fine on my machine with the CFLAGS I am using:

CFLAGS="-O3 -fgcse-sm -funroll-loops -fstrict-aliasing -fsched-interblock -falign-loops=16 -falign-
jumps=16 -falign-functions=16 -falign-jumps-max-skip=15 -falign-loops-max-skip=15 -ffast-math -
freorder-blocks -freorder-blocks-and-partition -finline-floor -mpowerpc-gpopt -force_cpusubtype_ALL 
-mcpu=7450 -fPIC -pipe -maltivec"

It looks long, but all those additional options are part of -fast -- I just needed to get rid of a few of them.




Comment 7


Fabian Groffen






          2005-08-17 11:21:41 UTC
        

I just emerged 1.4.2-r1 without any problem ?!?




Comment 8


Lina Pezzella (RETIRED)






          2005-08-17 14:27:14 UTC
        

My only suggestion is to try to upgrade world before upgrading gnupg and then retry. We unfortunately 
cannot reproduce this bug. After you've done that, sudo rm -rf /var/tmp/portage/gnupg-{version}. Then 
re-emerge gnupg with -fno-common as kito suggested.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

