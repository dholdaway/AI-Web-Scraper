Title: 317471 – app-portage/portage-utils-0.2.1: qfile doesn't work with orphaned symlink to non-orphaned file
URL: https://bugs.gentoo.org/show_bug.cgi?id=317471

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 317471
app-portage/portage-utils-0.2.1: qfile doesn't work with orphaned symlink to non-orphaned file
Last modified: 2010-05-21 09:00:52 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 317471 
      - app-portage/portage-utils-0.2.1: qfile doesn't work with orphaned symlink to non-orphaned file


Summary:
app-portage/portage-utils-0.2.1: qfile doesn't work with orphaned symlink to ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Portage Utils Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-04-27 13:06 UTC by Toralf Förster





      Modified:
    
2010-05-21 09:00 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



pchrist
tom.gl









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Toralf Förster






          2010-04-27 13:06:23 UTC
        

tfoerste@n22 ~ $ qfile /usr/lib/xorg/modules/extensions/libdri2.so

However equery works :

tfoerste@n22 ~ $ equery b /usr/lib/xorg/modules/extensions/libdri2.so
 * Searching for /usr/lib/xorg/modules/extensions/libdri2.so ... 
x11-base/xorg-server-1.7.6 (/usr/lib/opengl/xorg-x11/extensions/libdri2.so)


Reproducible: Always




Comment 1


Panagiotis Christopoulos (RETIRED)






          2010-05-03 12:30:01 UTC
        

Please, paste your emerge --info output.




Comment 2


Toralf Förster






          2010-05-03 13:10:26 UTC
        

tfoerste@n22 ~ $ emerge --info
Portage 2.1.8.3 (default/linux/x86/10.0/desktop/kde, gcc-4.3.4, glibc-2.10.1-r1, 2.6.34-rc6 i686)
=================================================================
System uname: Linux-2.6.34-rc6-i686-Intel-R-_Core-TM-2_Duo_CPU_P8600_@_2.40GHz-with-gentoo-1.12.13
Timestamp of tree: Mon, 03 May 2010 08:15:01 +0000
ccache version 2.4 [enabled]
app-shells/bash:     4.0_p37
dev-java/java-config: 2.1.10
dev-lang/python:     2.6.4-r1
dev-util/ccache:     2.4-r7
dev-util/cmake:      2.6.4-r3
sys-apps/baselayout: 1.12.13
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.8.5-r4, 1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.18-r3
sys-devel/gcc:       4.3.4
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="x86"
ACCEPT_LICENSE="* -@EULA"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -march=native -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests ccache distlocks fixpackages news parallel-fetch protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="http://mirror.netcologne.de/gentoo/ http://gentoo.mneisen.org/ http://91.121.124.139/gentoo-distfiles/ http://91.121.125.139/gentoo-distfiles/"
LDFLAGS="-Wl,-O1"
LINGUAS="en en_GB"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://linux.rz.ruhr-uni-bochum.de/gentoo-portage"
USE="X a52 aac acl acpi alsa apache2 berkdb bluetooth branding bzip2 cairo cdda cddb cdio cdr cli consolekit cracklib crypt css cups curl cxx dbus dri dts dvb dvd dvdr emboss encode exif fam fastbuild fat ffmpeg firefox flac fortran gdbm geoip gif git gmp gphoto2 gpm gtk hal hyphenation iconv ieee1394 ipv6 java jpeg kde kqemu lcms ldap libnotify lirc mad mbox mikmod mmx mng modules mp3 mp4 mpeg mudflap mysql nano-syntax ncurses nls nptl nptlonly nsplugin ntfs ogg opengl openmp pam pango pcre pdf perl png ppds pppd python qt3support qt4 rdesktop readline reflection samba sdl session slp spell spl sse sse2 ssl ssse3 startup-notification svg sysfs tcpd thinkpad tiff tk truetype udev unicode usb vcd vim-syntax vorbis wmf x264 x86 xcb xcomposite xine xml xorg xpm xscreensaver xulrunner xv xvid zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard evdev mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_GB" LIRC_DEVICES="devinput" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="intel" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS






Comment 3


TGL





          2010-05-09 16:08:06 UTC
        

I don't think this is a bug.

Here, "/usr/lib/xorg/modules/extensions/libdri2.so" is a symlink to "/usr/lib/opengl/xorg-x11/extensions/libdri2.so", but it has not been installed under Portage control.  It really is an orphan, with no CONTENTS entry.  IIRC, it's "eselect opengl" which creates it, or something like that.

I guess equery does its search with the target of the symlink instead of the symlink itself, which would explain it finds a match.




Comment 4


SpanKY






          2010-05-21 09:00:52 UTC
        

i tend to agree with TGL









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

