Title: 81329 – binutils (ld) seems to have relocation bugs still (again)
URL: https://bugs.gentoo.org/show_bug.cgi?id=81329

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 81329
binutils (ld) seems to have relocation bugs still (again)
Last modified: 2005-07-28 02:41:03 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 81329 
      - binutils (ld) seems to have relocation bugs still (again)


Summary:
binutils (ld) seems to have relocation bugs still (again)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       major
      


Assignee:

AMD64 Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-02-08 23:59 UTC by Blu3





      Modified:
    
2005-07-28 02:41 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Blu3





          2005-02-08 23:59:56 UTC
        

I am trying to build mozilla from cvs.  I just rebuilt my toolchain after upping to gcc 3.4.3 (which finally built after removing all the multi* USE flags) and ld is now giving me this.  I'm rebuilding again after switching to gcc-x-vanilla.

gmake[5]: Leaving directory `/usr/src/cvs/mozilla/security/nss/cmd/shlibsign/mangle'
Linux2.6_x86_64_glibc_PTH_64_OPT.OBJ/shlibsign -v -i /usr/src/cvs/mozilla/dist/lib/libsoftokn3.so
Linux2.6_x86_64_glibc_PTH_64_OPT.OBJ/shlibsign: Symbol `memset' causes overflow in R_X86_64_PC32 relocation
[...]
Linux2.6_x86_64_glibc_PTH_64_OPT.OBJ/shlibsign: Symbol `memcpy' causes overflow in R_X86_64_PC32 relocation
./sign.sh: line 2:  5810 Segmentation fault      ${2}/shlibsign -v -i ${4}
gmake[4]: *** [/usr/src/cvs/mozilla/dist/lib/libsoftokn3.chk] Error 139
gmake[4]: Leaving directory `/usr/src/cvs/mozilla/security/nss/cmd/shlibsign'

Note that this bug was supposedly fixed a long time ago: http://sourceware.org/bugzilla/show_bug.cgi?id=186




Comment 1


SpanKY






          2005-02-22 19:36:36 UTC
        

neglected to provide `emerge info`, re-open when you have




Comment 2


Blu3





          2005-02-23 14:17:03 UTC
        

Scott ~ # emerge info
Portage 2.0.51-r15 (default-linux/amd64/2005.0, gcc-3.4.3, glibc-2.3.4.20050125-r0, 2.6.11-rc4 x86_64)
=================================================================
System uname: 2.6.11-rc4 x86_64 AMD Opteron(tm) Processor 148
Gentoo Base System version 1.6.9
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Feb 18 2005, 03:36:23)]
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
dev-lang/python:     2.3.5
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r3
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.10
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CFLAGS="-march=opteron -O2 -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config/usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=opteron -O2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks keeptemp keepwork sandbox"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 GAPING_SECURITY_HOLE X X509 a52 aac aalib acpi acpi4linux aim alsa aotuv apache2 arts artswrappersuid artworkextra atm audiofile avantgo avi bluetooth bonobo bzip2 bzlib cairo caps cdda cddb cdf cdio cdparanoia cdr chipcard chroot cle266 codecs crypt css cups curl curlwrappers dba dbx devfs26 dga dio distcache divx4linux djbfft dnd dts dv dvb dvd dvdr dvdread dxr3 edl emoticon emul-linux encode erandom escreen ethereal exif extensions faac faad fam fame fax ffmpegfftw flac flash flexresp fmod foomaticdb fpx freetts freetype ftp ftruncate gd gdbm geoip gif gimp gimpprint glade glgd glitz glut gmail gmp gnokii gphoto2 gpmgps graphviz gs gsl gstreamer gtk gtk2 gtkhtml guile hal hbci hdf hdf5 high-ints icq ide idea idled ieee1394 imagemagick imap imlib imlib2 ipv6 irda irmc j2ee jabber jack jack-tmpfs java javacomm javamail javascript jbig jp2 jpeg jpeg2k junit kadu-modules kadu-voice kcal kde kdepim koffice-plugin lcms libgd libgda libsamplerate libwww lirc live lm_sensors ltsp lzo lzw lzw-tiff mad mbox mbrola mcal md5sum memlimit mhash mikmod mime mimencode ming mixer mjpeg mmap mng monkey motif mozcalendar mozdevelop mozilla moznoirc mozp3p mozsvg mp3 mpeg mpeg2 mpeg4 mpi mplayer mpm-leader mpm-metux mpm-peruser mpm-prefork mpm-threadpool mpm-worker msdav msn multicall mythtv nagios-dns nagios-ntp nagios-ping nagios-ssh nas ncurses netcdf network nls no-old-linux nopri nozaptel nptl nptlonly ntlm nvidia nviz oav odbc offensive ofx ogg oggvorbis openal opengl operanom2 oscar oss pam parse-clocks pcap pcntl pcre pda pdflib perl pg-hier pg-vacuumdelay php pic plotutils png pnp portaudio posix postgres ppds pthreads python quotes readline realremote rtc samba scanner sdl serial session shared sharedmem slang slp smime sms sndfile snmp snortsam soap sockets socks5 speex spell spl ssl stats stream svgsysvipc t1lib tcpd tga theora threads thumbnail tidy tiff timidity tokenizer transcode transparent-proxy truetype truetype-fonts type1 type1-fonts underscores usb userlocales uudeview v4l v4l2 vcd vidix vorbis wddx wifi wmf xface xgetdefault xine xinerama xml xml2 xmlrpc xmms xosd xpm xprint xrandr xscreensaver xv xvid xvmc yahoo yaz yv12 zlib zvbi"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS





Comment 3


SpanKY






          2005-04-27 16:06:55 UTC
        

example code at that binutils bug report works fine on my amd64 with these versions:
 [4] x86_64-pc-linux-gnu-2.15.92.0.2 *
 [5] x86_64-pc-linux-gnu-2.15.97
 [6] x86_64-pc-linux-gnu-2.16.90.0.1

does the example code there fail for you too ?




Comment 4


Simon Stelling (RETIRED)






          2005-06-26 03:43:42 UTC
        

can confirm this

blubb@aqua ~ $ make
gcc -B./ -shared -o libfoo.so lib1.o lib2.o
/usr/lib/gcc/x86_64-pc-linux-gnu/3.4.3/../../../../x86_64-pc-linux-gnu/bin/ld:
warning: creating a DT_TEXTREL in object.
/usr/lib/gcc/x86_64-pc-linux-gnu/3.4.3/../../../../x86_64-pc-linux-gnu/bin/ld:
lib2.o: relocation R_X86_64_PC32 against `msg' can not be used when making a
shared object; recompile with -fPIC
/usr/lib/gcc/x86_64-pc-linux-gnu/3.4.3/../../../../x86_64-pc-linux-gnu/bin/ld:
final link failed: Bad value
collect2: ld returned 1 exit status
make: *** [libfoo.so] Error 1
blubb@aqua ~ $ binutils-config -l
 [1] x86_64-pc-linux-gnu-2.15.92.0.2 *

Portage 2.0.51.19 (default-linux/amd64/2005.0, gcc-3.4.3, glibc-2.3.5-r0,
2.6.11-gentoo-r6 x86_64)
=================================================================
System uname: 2.6.11-gentoo-r6 x86_64 AMD Opteron(tm) Processor 242
Gentoo Base System version 1.6.12
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, May 12 2005, 21:07:15)]
dev-lang/python:     2.3.5
sys-apps/sandbox:    [Not Present]
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.9.5, 1.5, 1.8.5-r3, 1.6.3, 1.7.9-r1, 1.4_p6
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.16
virtual/os-headers:  2.6.8.1-r4
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-Os -pipe -march=opteron"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /home /usr/kde/2/share/config /usr/kde/3/share/config
/usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/env.d"
CXXFLAGS="-O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig buildpkg ccache cvs digest distlocks noinfo
sandbox sfperms userpriv usersandbox"
GENTOO_MIRRORS="http://distfiles.gentoo.org
http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/home/blubb/gentoo/repositories/gentoo-x86 /usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="amd64 X aalib acpi alsa berkdb bitmap-fonts cdr cdrom crypt cups curl dvd
eds esd fam font-server foomaticdb gdbm gif gnome gpm gstreamer gtk gtk2 imlib
jp2 jpeg lzw lzw-tiff motif mozilla mp3 mpeg ncurses network nls nptl nptlonly
ogg oggvorbis opengl pam perl png ppds readline samba sdl ssl svg tcpd tiff
truetype truetype-fonts type1-fonts usb userlocales utf8 vorbis xine xml xml2
xmms xpm xrandr xv zlib userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS




Comment 5


Simon Stelling (RETIRED)






          2005-06-26 03:56:04 UTC
        

doh, i'm an idiot. i get the expected behaviour of course... Blu3, did you try
it with -r10?




Comment 6


Simon Stelling (RETIRED)






          2005-07-28 02:41:03 UTC
        

can't reproduce, no answer from bug reporter for 30 days -> closing









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

