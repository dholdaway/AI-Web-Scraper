Title: 671538 – =x11-themes/adwaita-icon-theme-3.26.1 fails to install (core dumped /usr/bin/gtk-encode-symbolic-svg)
URL: https://bugs.gentoo.org/show_bug.cgi?id=671538

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 671538
=x11-themes/adwaita-icon-theme-3.26.1 fails to install (core dumped /usr/bin/gtk-encode-symbolic-svg)
Last modified: 2019-11-02 14:28:20 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 671538 
      - =x11-themes/adwaita-icon-theme-3.26.1 fails to install (core dumped /usr/bin/gtk-encode-symbolic-svg)


Summary:
=x11-themes/adwaita-icon-theme-3.26.1 fails to install (core dumped /usr/bin/...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




671542



 

        Show dependency tree





 





      Reported:
    
2018-11-19 21:12 UTC by Émeric Maschino





      Modified:
    
2019-11-02 14:28 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



emeric.maschino









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,749.08 KB,
                text/x-log)

            
2018-11-19 21:12 UTC,

            Émeric Maschino




Details





environment

              (environment,102.61 KB,
                text/plain)

            
2018-11-19 21:24 UTC,

            Émeric Maschino




Details





GDB backtrace

              (gdb.txt,11.85 KB,
                text/plain)

            
2019-01-06 16:29 UTC,

            Émeric Maschino




Details





GDB backtrace with =gnome-base/librsvg-2.40.20

              (gdb.txt,13.21 KB,
                text/plain)

            
2019-01-07 21:41 UTC,

            Émeric Maschino




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Émeric Maschino





          2018-11-19 21:12:36 UTC
        

Created attachment 555742 [details]
build.log

Hi,

emerge @world failed to upgrade from =x11-themes/adwaita-icon-theme-3.24.0 to 3.26.1 on my ia64 workstation.

build.log file is filled by thousands lines such as:

double free or corruption (fasttop)
/bin/sh: line 4: 22243 Aborted                 (core dumped) /usr/bin/gtk-encode-symbolic-svg ../../Adwaita/scalable/$file $size -o /var/tmp/portage/x11-themes/adwaita-icon-theme-3.26.1/image//usr/share/icons/Adwaita/$size/$context

or:

malloc(): smallbin double linked list corrupted
/bin/sh: line 4: 22272 Aborted                 (core dumped) /usr/bin/gtk-encode-symbolic-svg ../../Adwaita/scalable/$file $size -o /var/tmp/portage/x11-themes/adwaita-icon-theme-3.26.1/image//usr/share/icons/Adwaita/$size/$context

Please let me know how I can help investigate further.

Thanks,

     Émeric




Comment 1


Émeric Maschino





          2018-11-19 21:13:30 UTC
        

emerge --info output:

Portage 2.3.49 (python 3.6.5-final-0, default/linux/ia64/17.0/desktop/gnome/systemd, gcc-7.3.0, glibc-2.26-r7, 4.9.95-gentoo ia64)
=================================================================
System uname: Linux-4.9.95-gentoo-ia64-Madison-with-gentoo-2.4.1
KiB Mem:    24978336 total,  24673936 free
KiB Swap:     524272 total,    524272 free
Timestamp of repository gentoo: Thu, 25 Oct 2018 18:45:01 +0000
Head commit of repository gentoo: 1340cf0c06d0b471a45d586aae1b6800166dd502
sh bash 4.4_p12
ld GNU ld (Gentoo 2.30 p5) 2.30.0
app-shells/bash:          4.4_p12::gentoo
dev-lang/perl:            5.24.3-r1::gentoo
dev-lang/python:          2.7.15::gentoo, 3.5.5::gentoo, 3.6.5::gentoo
dev-util/cmake:           3.9.6::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.4.1-r2::gentoo
sys-apps/sandbox:         2.13::gentoo
sys-devel/autoconf:       2.13::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.15.1-r2::gentoo
sys-devel/binutils:       2.30-r4::gentoo
sys-devel/gcc:            7.3.0-r3::gentoo
sys-devel/gcc-config:     1.8-r1::gentoo
sys-devel/libtool:        2.4.6-r3::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 4.13::gentoo (virtual/os-headers)
sys-libs/glibc:           2.26-r7::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.fr.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts: 
    sync-rsync-verify-metamanifest: yes
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-jobs: 1

localrepo
    location: /usr/local/portage
    masters: gentoo

ACCEPT_KEYWORDS="ia64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="ia64-unknown-linux-gnu"
CFLAGS="-O2 -pipe"
CHOST="ia64-unknown-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe"
DISTDIR="/usr/portage/distfiles"
ENV_UNSET="DBUS_SESSION_BUS_ADDRESS DISPLAY PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync multilib-strict news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="fr_FR.utf8"
LDFLAGS="-Wl,-O1"
LINGUAS="fr_FR"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="X a52 aac acl acpi alsa berkdb branding bzip2 cairo cdda cdr cli colord crypt cups cxx dbus dri dts dvdr eds encode evo exif fam flac fortran gdbm gif glamor gnome gnome-keyring gnome-online-accounts gpm gstreamer gtk ia64 iconv introspection ipv6 jpeg lcms ldap libnotify libsecret libtirpc mad mng mp3 mp4 mpeg nautilus ncurses nls nptl ogg opengl openmp pam pango pcre pdf png policykit ppds pulseaudio readline sdl spell ssl startup-notification svg systemd tcpd tiff tracker truetype udev udisks unicode upower usb vorbis wxwidgets x264 xattr xcb xml xv xvid zlib" ALSA_CARDS="fm801" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon plan sheets stage words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="evdev" KERNEL="linux" L10N="fr" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-6 php7-1" POSTGRES_TARGETS="postgres9_5 postgres10" PYTHON_SINGLE_TARGET="python3_6" PYTHON_TARGETS="python2_7 python3_6" RUBY_TARGETS="ruby23" USERLAND="GNU" VIDEO_CARDS="fbdev radeon" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 2


Émeric Maschino





          2018-11-19 21:14:07 UTC
        

emerge -pqv output:

[ebuild     U ] x11-themes/adwaita-icon-theme-3.26.1 [3.24.0] USE="branding"




Comment 3


Émeric Maschino





          2018-11-19 21:24:22 UTC
        

Created attachment 555758 [details]
environment




Comment 4


Émeric Maschino





          2018-11-22 21:52:55 UTC
        

So breakage is more subtle in the end. Trying to reinstall =x11-themes/adwaita-icon-theme-3.24.0 fails the same. And reverting to previous =x11-libs/gtk+-3.24.0 (/usr/bin/gtk-encode-symbolic-svg belongs to) doesn't help either. Any suggestion welcome!




Comment 5


Gilles Dartiguelongue (RETIRED)






          2018-11-23 11:18:49 UTC
        

Unfortunately, I haven't seen reports of this other than yours since gtk+-3.24 was added to the tree so I guess this is arch-specific. Could you provide the backtrace ?




Comment 6


Émeric Maschino





          2019-01-06 16:29:35 UTC
        

Created attachment 560106 [details]
GDB backtrace




Comment 7


Émeric Maschino





          2019-01-06 16:32:23 UTC
        

(In reply to Gilles Dartiguelongue from comment #5)
> Unfortunately, I haven't seen reports of this other than yours since
> gtk+-3.24 was added to the tree so I guess this is arch-specific. Could you
> provide the backtrace ?

Sorry for the late replay, my Gentoo HDD crashed hard so I had to reinstall everything from scratch. Back to business ;-)

Please have a look at attachment #560106 [details] for the requested GDB backtrace and let me know how I can help further.

Thanks,

     Émeric




Comment 8


Mart Raudsepp






          2019-01-06 17:22:49 UTC
        

I don't suppose you can valgrind. Maybe try with librsvg-2.40.20?




Comment 9


Émeric Maschino





          2019-01-07 21:41:59 UTC
        

Created attachment 560336 [details]
GDB backtrace with =gnome-base/librsvg-2.40.20




Comment 10


Émeric Maschino





          2019-01-07 21:45:38 UTC
        

(In reply to Mart Raudsepp from comment #8)
> I don't suppose you can valgrind. Maybe try with librsvg-2.40.20?

No valgrind on ia64.
Not better with librsvg-2.40.20; have a look at attachment #560336 [details] if needed.
If you're confident that the problem lies in librsvg, I can try older versions.

     Émeric




Comment 11


Mart Raudsepp






          2019-01-07 22:13:29 UTC
        

Does using librsvg directly work or not? Perhaps on these SVGs or something else.
You could try converting a SVG to PNG with librsvg own tool - rsvg-convert; see if it crashes with that too.

rsvg-convert -w 16 -h 16 /var/tmp/portage/x11-themes/adwaita-icon-theme-3.24.0/work/adwaita-icon-theme-3.24.0/Adwaita/scalable/apps/preferences-desktop-display-symbolic.svg > preferences-desktop-display-symbolic.png




Comment 12


Émeric Maschino





          2019-03-01 21:23:22 UTC
        

(In reply to Mart Raudsepp from comment #11)
> Does using librsvg directly work or not? Perhaps on these SVGs or something
> else.
> You could try converting a SVG to PNG with librsvg own tool - rsvg-convert;
> see if it crashes with that too.
> 
> rsvg-convert -w 16 -h 16
> /var/tmp/portage/x11-themes/adwaita-icon-theme-3.24.0/work/adwaita-icon-
> theme-3.24.0/Adwaita/scalable/apps/preferences-desktop-display-symbolic.svg
> > preferences-desktop-display-symbolic.png

Interesting, the above command ran fine and the produced PNG file looks valid to me.

     Émeric




Comment 13


Émeric Maschino





          2019-11-02 14:28:20 UTC
        

(In reply to Émeric Maschino from comment #4)
> So breakage is more subtle in the end. Trying to reinstall
> =x11-themes/adwaita-icon-theme-3.24.0 fails the same. And reverting to
> previous =x11-libs/gtk+-3.24.0 (/usr/bin/gtk-encode-symbolic-svg belongs to)
> doesn't help either. Any suggestion welcome!

A lot of things have changed on the ia64 front for the passed months, including toolchain (updated binutils, glibc, gcc, libtool). I don't know what was the root cause of this crash (toolchain? dependency library?), but it's no more with current packages in portage tree.

I'm simply posting the output of emerge --info for future reference, just in case.

Portage 2.3.76 (python 3.6.9-final-0, default/linux/ia64/17.0/desktop/gnome/systemd, gcc-8.3.0, glibc-2.29-r2, 4.19.72-gentoo ia64)
=================================================================
System uname: Linux-4.19.72-gentoo-ia64-Madison-with-gentoo-2.6
KiB Mem:    24981712 total,  21255520 free
KiB Swap:     499696 total,    499696 free
Timestamp of repository gentoo: Sun, 27 Oct 2019 15:30:01 +0000
Head commit of repository gentoo: f39b48f3c96f1881eea8ba2bd5b3c0e19e091c4a
sh bash 4.4_p23-r1
ld GNU ld (Gentoo 2.32 p2) 2.32.0
app-shells/bash:          4.4_p23-r1::gentoo
dev-lang/perl:            5.28.2-r1::gentoo
dev-lang/python:          2.7.16::gentoo, 3.6.9::gentoo
dev-util/cmake:           3.14.6::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.6-r1::gentoo
sys-apps/sandbox:         2.13::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.16.1-r1::gentoo
sys-devel/binutils:       2.32-r1::gentoo
sys-devel/gcc:            8.3.0-r1::gentoo
sys-devel/gcc-config:     2.0::gentoo
sys-devel/libtool:        2.4.6-r3::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 4.19::gentoo (virtual/os-headers)
sys-libs/glibc:           2.29-r2::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts: 
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-metamanifest: yes
    sync-rsync-verify-jobs: 1

ACCEPT_KEYWORDS="ia64"
ACCEPT_LICENSE="@FREE"
CBUILD="ia64-unknown-linux-gnu"
CFLAGS="-O2 -pipe"
CHOST="ia64-unknown-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe"
DISTDIR="/usr/portage/distfiles"
ENV_UNSET="DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="ftp://ftp.free.fr/mirrors/ftp.gentoo.org/"
LANG="fr_FR.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="fr"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="X a52 aac acl acpi alsa berkdb branding bzip2 cairo cdda cdr cli colord crypt cups cxx dbus dri dts dvdr eds encode evo exif fam flac fortran gdbm gif glamor gnome gnome-keyring gnome-online-accounts gpm gstreamer gtk ia64 iconv icu introspection ipv6 jpeg lcms ldap libnotify libsecret libtirpc mad mng mp3 mp4 mpeg nautilus ncurses nls nptl ogg opengl openmp pam pango pcre pdf png policykit ppds pulseaudio readline sdl spell split-usr ssl startup-notification svg systemd tcpd tiff tracker truetype udev udisks unicode upower usb vorbis wayland wxwidgets x264 xattr xcb xml xv xvid zlib" ADA_TARGET="gnat_2018" ALSA_CARDS="fm801" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput" KERNEL="linux" L10N="fr" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" NETBEANS_MODULES="apisupport cnd groovy gsf harness ide identity j2ee java mobility nb php profiler soa visualweb webcommon websvccommon xml" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-2" POSTGRES_TARGETS="postgres10 postgres11" PYTHON_SINGLE_TARGET="python3_6" PYTHON_TARGETS="python2_7 python3_6" RUBY_TARGETS="ruby24" USERLAND="GNU" VIDEO_CARDS="fbdev radeon" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

