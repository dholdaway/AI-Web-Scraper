Title: 402129 – media-libs/freeglut / x11-libs/pango - /usr/lib64/libGL.so.1: undefined reference to `_glapi_tls_Dispatch'
URL: https://bugs.gentoo.org/show_bug.cgi?id=402129

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 402129
media-libs/freeglut / x11-libs/pango - /usr/lib64/libGL.so.1: undefined reference to `_glapi_tls_Dispatch'
Last modified: 2012-02-07 00:31:46 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 402129 
      - media-libs/freeglut / x11-libs/pango - /usr/lib64/libGL.so.1: undefined reference to `_glapi_tls_Dispatch'


Summary:
media-libs/freeglut / x11-libs/pango - /usr/lib64/libGL.so.1: undefined refer...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:

Bug







Depends on:







Blocks:









 





      Reported:
    
2012-02-04 03:31 UTC by Dmitri





      Modified:
    
2012-02-07 00:31 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




freeglut-2.8.0 build log

              (build.log,25.55 KB,
                text/plain)

            
2012-02-04 03:31 UTC,

            Dmitri




Details





cat /proc/cpuinfo

              (cpuinfo.txt,1.78 KB,
                text/plain)

            
2012-02-04 03:33 UTC,

            Dmitri




Details





pango build log

              (pango-1.29.4.log,17.50 KB,
                text/plain)

            
2012-02-04 23:24 UTC,

            Dmitri




Details





mesa-progs compilation log

              (mesa-progs-8.0.1.log,2.41 KB,
                text/plain)

            
2012-02-04 23:26 UTC,

            Dmitri




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Dmitri





          2012-02-04 03:31:24 UTC
        

Created attachment 300889 [details]
freeglut-2.8.0 build log

error msg as follows:

make[4]: Entering directory `/var/tmp/portage/media-libs/freeglut-2.8.0/work/freeglut-2.8.0/progs/demos/CallbackMaker'
x86_64-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I../../..    -I../../../include  -march=amdfam10 -Wall -pedantic -c -o CallbackMaker-CallbackMaker.o `test -f 'CallbackMaker.c' || echo './'`CallbackMaker.c
/bin/sh ../../../libtool --tag=CC   --mode=link x86_64-pc-linux-gnu-gcc -I../../../include  -march=amdfam10 -Wall -pedantic -export-dynamic -Wl,-O1 -Wl,--as-needed -o CallbackMaker CallbackMaker-CallbackMaker.o ../../../src/libglut.la -lGL -lXext -lX11 -lXi -lXrandr -lXxf86vm 
libtool: link: x86_64-pc-linux-gnu-gcc -I../../../include -march=amdfam10 -Wall -pedantic -Wl,-O1 -Wl,--as-needed -o .libs/CallbackMaker CallbackMaker-CallbackMaker.o -Wl,--export-dynamic  ../../../src/.libs/libglut.so -lGL -lXext -lX11 -lXi -lXrandr -lXxf86vm
/usr/lib/gcc/x86_64-pc-linux-gnu/4.5.3/../../../../lib64/libGL.so: undefined reference to `_glapi_tls_Dispatch'
collect2: ld returned 1 exit status
make[4]: *** [CallbackMaker] Error 1




Comment 1


Dmitri





          2012-02-04 03:33:05 UTC
        

Created attachment 300891 [details]
cat /proc/cpuinfo

CPU info




Comment 2


Dmitri





          2012-02-04 03:36:04 UTC
        

emerge --info 

Portage 2.1.10.44 (default/linux/amd64/10.0, gcc-4.5.3, glibc-2.14.1-r2, 3.2.2-gentoo.2012-02-02_22-00 x86_64)
=================================================================
System uname: Linux-3.2.2-gentoo.2012-02-02_22-00-x86_64-AMD_E-300_APU_with_Radeon-tm-_HD_Graphics-with-gentoo-2.1
Timestamp of tree: Fri, 03 Feb 2012 00:45:01 +0000
app-shells/bash:          4.2_p20
dev-lang/python:          2.7.2-r3, 3.1.4-r3, 3.2.2
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1
sys-apps/openrc:          0.9.8.4
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.11.2-r1
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.5.3-r2
sys-devel/gcc-config:     1.5-r2
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r3
sys-kernel/linux-headers: 3.2 (virtual/os-headers)
sys-libs/glibc:           2.14.1-r2
Repositories: gentoo
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=amdfam10"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=amdfam10"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs candy clean-logs distlocks ebuild-locks fixlafiles news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://mirror.datapipe.net/gentoo http://gentoo.netnitco.net http://gentoo.mirrors.pair.com/"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en de ru"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY=""
SYNC="rsync://rsync15.us.gentoo.org/gentoo-portage"
USE="256-color 3dnow 3dnowext 64bit X a52 aac aacplus aacs acpi addressbook adns alsa amd64 apm apng archive audio audiofile bash-completion berkdb bittorrent branding bzip2 cairo calendar cddb cdio cdparanoia cdr chm cleartype cli consolekit cracklib cscope css ctype cue cups curl cxx dbus declarative dga dio directfb dri dvd dvdr dvdread ebook enca encode exif fbcon ffmpeg flac fluidsynth fontconfig ftp gd gdbm geoip gif gnutls gpm gstreamer gtk2 gtk3 gudev hddtemp iconv icu imagemagick imap imlib ipv6 jabber javascript jbig jingle jpeg jpeg2k kde kdehiddenvisibility laptop lash lcms lm_sensors lzma mad maildir matroska mime minizip mmx mng modplug modules mp3 mpeg mudflap multilib natspec ncurses nls nptl nptlonly nsplugin ogg openal opengl openmp pam pcre pda pdf perl png policykit posix pppd python qt-faststart qt3support qt4 quicktime readline recode rss sasl semantic-desktop session skey slang sndfile speex spell sql sqlite sqlite3 sse sse2 ssl svg symlink sysfs tcpd theora threads tiff truetype unicode usb v4l v4l2 vcd video vim-syntax vorbis webkit wifi wmf x264 xface xml xorg xpm xulrunner xv xvid zeroconf zip zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw copy dmix dshare dsnoop empty extplug file hooks ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol asound asym" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en de ru" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="radeon" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 3


Dmitri





          2012-02-04 17:35:51 UTC
        

changed CFLAGS="-march=native"
emerge mesa freeglut
succeeded on mesa, failed on freeglut with the same error

changed use flags for mesa: 
+shared-dricore +shared-glapi -bindist
and rebuild ended up with the same error at freeglut
as 
... lib64/libGL.so: undefined reference to `_glapi_tls_Dispatch'...




Comment 4


Dmitri





          2012-02-04 18:21:26 UTC
        

x11-apps/mesa-progs actually failed to compile with the same error.




Comment 5


Dmitri





          2012-02-04 19:18:10 UTC
        

downgraded from mesa-7.11.2 to mesa-7.11, but freeglut-2.8.0 finished up with the same error.




Comment 6


Dmitri





          2012-02-04 19:22:33 UTC
        

mesa-7.11 and freeglut-2.6.0 ended up with the same error.




Comment 7


Dmitri





          2012-02-04 23:24:04 UTC
        

Created attachment 300929 [details]
pango build log

pango fail to build with slightly different error, but still in libGL.so

/var/tmp/portage/x11-libs/pango-1.29.4/work/pango-1.29.4/pango/pango-language-sample-table.h:52: syntax error, unexpected identifier in 'LANGUAGE(' at 'LANGUAGE'
/usr/lib64/libGL.so.1: undefined reference to `_glapi_tls_Dispatch'
collect2: ld returned 1 exit status




Comment 8


Dmitri





          2012-02-04 23:26:15 UTC
        

Created attachment 300931 [details]
mesa-progs compilation log

mesa-progs failed at libGL.so point

>>> Compiling source in /var/tmp/portage/x11-apps/mesa-progs-8.0.1/work/mesa-demos-8.0.1 ...
make -j3 'LDLIBS=-lX11 -lGL -lm' src/xdemos/glxgears src/xdemos/glxinfo 
x86_64-pc-linux-gnu-gcc -march=native  -Wl,-O1 -Wl,--as-needed  src/xdemos/glxgears.c  -lX11 -lGL -lm -o src/xdemos/glxgears
x86_64-pc-linux-gnu-gcc -march=native  -Wl,-O1 -Wl,--as-needed  src/xdemos/glxinfo.c  -lX11 -lGL -lm -o src/xdemos/glxinfo
/usr/lib/gcc/x86_64-pc-linux-gnu/4.5.3/../../../../lib64/libGL.so: undefined reference to `_glapi_tls_Dispatch'
collect2: ld returned 1 exit status
make: *** [src/xdemos/glxinfo] Error 1




Comment 9


Dmitri





          2012-02-05 03:14:33 UTC
        

rebuilding mesa after disabling all use flags except for video_card_radeon is actually allowing to build freeglut




Comment 10


Dmitri





          2012-02-05 04:13:50 UTC
        

mesa and freeglut can be build with following useflags
"classic egl llvm shared-glapi"
all others are disabled




Comment 11


Jeroen Roovers (RETIRED)






          2012-02-06 19:31:06 UTC
        

Please post your output of `eselect opengl list'.




Comment 12


Dmitri





          2012-02-07 00:31:46 UTC
        

I ended up with opengl classic only, no gallium left.

Than i got errors about gcc in a middle of firefox compilation.
at that point, i tar'ed my config files and started from scratch.

now with 
ACCEPT_KEYWORDS="amd64"
CFLAGS="-march=native -mtune=native" 
doing fresh install.
mesa, mesa-progs, freeglut are all ok
with available classic and gallium backends in opengl.

I wish, someone who have better understanding in gcc, update 
http://en.gentoo-wiki.com/wiki/Safe_Cflags
with proper values of CFLAGS for Zacate models.

i think status should be changed, to resolved, 
until someone else would get in the same trouble,
than the bug can be reopened.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

