Title: 366225 – media-gfx/gimp failed with libpng-1.5
URL: https://bugs.gentoo.org/show_bug.cgi?id=366225

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 366225
media-gfx/gimp failed with libpng-1.5
Last modified: 2011-08-07 08:34:06 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 366225 
      - media-gfx/gimp failed with libpng-1.5


Summary:
media-gfx/gimp failed with libpng-1.5
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Hanno Böck








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




libpng-1.5



 

        Show dependency tree





 





      Reported:
    
2011-05-06 13:34 UTC by renato gallo





      Modified:
    
2011-08-07 08:34 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



renatogallo









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




/var/tmp/portage/media-gfx/gimp-2.6.11-r1/temp/build.log

              (build.log.gz.gz,77.83 KB,
                application/x-gzip)

            
2011-05-07 16:42 UTC,

            renato gallo




Details





/var/tmp/portage/media-gfx/gimp-2.6.11-r2/temp/build.log

              (build.log.gz.gz,75.81 KB,
                application/x-gzip)

            
2011-05-07 16:43 UTC,

            renato gallo




Details





/var/tmp/portage/media-gfx/gimp-2.7.2/temp/build.log

              (build.log,149.69 KB,
                text/x-log)

            
2011-05-07 16:44 UTC,

            renato gallo




Details





/var/tmp/portage/media-gfx/gimp-9999/temp/build.log

              (build.log,72.39 KB,
                text/x-log)

            
2011-05-07 16:45 UTC,

            renato gallo




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


renato gallo





          2011-05-06 13:34:33 UTC
        

libtool: link: x86_64-pc-linux-gnu-gcc -I/usr/include/freetype2 -I/usr/include -O2 -pipe -march=native -Wall -Wdeclaration-after-statement -Wmissing-prototypes -Wmissing-declarations -Winit-self -Wpointer-arith -Wold-style-definition -Wl,-O1 -o .libs/file-wmf file_wmf-file-wmf.o -pthread  -Wl,--as-needed ../../libgimp/.libs/libgimpui-2.0.so ../../libgimpwidgets/.libs/libgimpwidgets-2.0.so ../../libgimpmodule/.libs/libgimpmodule-2.0.so ../../libgimp/.libs/libgimp-2.0.so ../../libgimpmath/.libs/libgimpmath-2.0.so ../../libgimpconfig/.libs/libgimpconfig-2.0.so ../../libgimpcolor/.libs/libgimpcolor-2.0.so ../../libgimpbase/.libs/libgimpbase-2.0.so -lgtk-x11-2.0 -lgdk-x11-2.0 /usr/lib64/libatk-1.0.so /usr/lib64/libgio-2.0.so -lpangoft2-1.0 -lpangocairo-1.0 -lgdk_pixbuf-2.0 -lcairo -lpng15 -lpango-1.0 /usr/lib64/libfontconfig.so /usr/lib64/libgobject-2.0.so /usr/lib64/libgmodule-2.0.so /usr/lib64/libgthread-2.0.so -lrt /usr/lib64/libglib-2.0.so -L/usr/lib64 -lwmf -lwmflite /usr/lib64/libfreetype.so -lX11 /usr/lib64/libexpat.so -ljpeg -lpng -lz -lm -pthread
/usr/lib/gcc/x86_64-pc-linux-gnu/4.4.5/../../../../x86_64-pc-linux-gnu/bin/ld: warning: libpng14.so.14, needed by /usr/lib64/libwmf.so, not found (try using -rpath or -rpath-link)
/usr/lib64/libwmf.so: undefined reference to `png_create_write_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_set_IHDR@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_create_info_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_init_io@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_row@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_info@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_end@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_destroy_write_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_set_text@PNG14_0'
collect2: ld returned 1 exit status
make[3]: *** [file-wmf] Error 1
make[3]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r1/work/gimp-2.6.11/plug-ins/common'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r1/work/gimp-2.6.11/plug-ins'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r1/work/gimp-2.6.11'
make: *** [all] Error 2
emake failed
 * ERROR: media-gfx/gimp-2.6.11-r1 failed (compile phase):

Reproducible: Always

Steps to Reproduce:
1.upgrade libpng to version 1.5
2.emerge gimp

Actual Results:  
libtool: link: x86_64-pc-linux-gnu-gcc -I/usr/include/freetype2 -I/usr/include -O2 -pipe -march=native -Wall -Wdeclaration-after-statement -Wmissing-prototypes -Wmissing-declarations -Winit-self -Wpointer-arith -Wold-style-definition -Wl,-O1 -o .libs/file-wmf file_wmf-file-wmf.o -pthread  -Wl,--as-needed ../../libgimp/.libs/libgimpui-2.0.so ../../libgimpwidgets/.libs/libgimpwidgets-2.0.so ../../libgimpmodule/.libs/libgimpmodule-2.0.so ../../libgimp/.libs/libgimp-2.0.so ../../libgimpmath/.libs/libgimpmath-2.0.so ../../libgimpconfig/.libs/libgimpconfig-2.0.so ../../libgimpcolor/.libs/libgimpcolor-2.0.so ../../libgimpbase/.libs/libgimpbase-2.0.so -lgtk-x11-2.0 -lgdk-x11-2.0 /usr/lib64/libatk-1.0.so /usr/lib64/libgio-2.0.so -lpangoft2-1.0 -lpangocairo-1.0 -lgdk_pixbuf-2.0 -lcairo -lpng15 -lpango-1.0 /usr/lib64/libfontconfig.so /usr/lib64/libgobject-2.0.so /usr/lib64/libgmodule-2.0.so /usr/lib64/libgthread-2.0.so -lrt /usr/lib64/libglib-2.0.so -L/usr/lib64 -lwmf -lwmflite /usr/lib64/libfreetype.so -lX11 /usr/lib64/libexpat.so -ljpeg -lpng -lz -lm -pthread
/usr/lib/gcc/x86_64-pc-linux-gnu/4.4.5/../../../../x86_64-pc-linux-gnu/bin/ld: warning: libpng14.so.14, needed by /usr/lib64/libwmf.so, not found (try using -rpath or -rpath-link)
/usr/lib64/libwmf.so: undefined reference to `png_create_write_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_set_IHDR@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_create_info_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_init_io@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_row@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_info@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_end@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_destroy_write_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_set_text@PNG14_0'
collect2: ld returned 1 exit status
make[3]: *** [file-wmf] Error 1
make[3]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r1/work/gimp-2.6.11/plug-ins/common'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r1/work/gimp-2.6.11/plug-ins'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r1/work/gimp-2.6.11'
make: *** [all] Error 2
emake failed
 * ERROR: media-gfx/gimp-2.6.11-r1 failed (compile phase):

Expected Results:  
it compiles successfully

emerge --info
Portage 2.1.9.42 (default/linux/amd64/10.0, gcc-4.4.5, libc-0-r0, 2.6.38-gentoo-r3 x86_64)
=================================================================
System uname: Linux-2.6.38-gentoo-r3-x86_64-Intel-R-_Core-TM-_i5_CPU_760_@_2.80GHz-with-gentoo-2.0.2
Timestamp of tree: Fri, 06 May 2011 11:45:01 +0000
app-shells/bash:     4.1_p9
dev-java/java-config: 2.1.11-r3
dev-lang/python:     2.7.1-r1, 3.1.3-r1
dev-util/cmake:      2.8.4-r1
sys-apps/baselayout: 2.0.2
sys-apps/openrc:     0.8.2-r1::poly-c
sys-apps/sandbox:    2.4
sys-devel/autoconf:  2.13, 2.65-r1
sys-devel/automake:  1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.4.5
sys-devel/gcc-config: 1.4.1-r1
sys-devel/libtool:   2.2.10
sys-devel/make:      3.81-r2
sys-kernel/linux-headers: 2.6.36.1
sys-libs/glibc:      2.11.3
virtual/os-headers:  0
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=native"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe -march=native"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks fixlafiles fixpackages news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://mirror.switch.ch/ftp/mirror/gentoo/"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="nb"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/luksans-arduino /var/lib/layman /var/lib/layman/vmware /var/lib/layman/zugaina /var/lib/layman/wirelay /var/lib/layman/stuff /var/lib/layman/sabayon /var/lib/layman/nikai /var/lib/layman/dev-zero /var/lib/layman/pentoo /var/lib/layman/damex-overlay /var/lib/layman/nelchael /var/lib/layman/pcsx2 /var/lib/layman/poly-c /var/lib/layman/sunrise /var/lib/layman/amielke-overlay /var/lib/layman/benf"
SYNC="rsync://rsync.de.gentoo.org/gentoo-portage"
USE="3dnow X a52 aac aacs aalib acl alsa amd64 apng ares atmo auto-hinter bash-completion berkdb bidi bittorrent bl bluetooth bluray bs2b bzip2 cairo cdda cddb cdparanoia cdr cjk cli cracklib crypt cups curl cxx dbus dc1394 desktopglobe devfs-compat device-mapper dga dirac directfb dri dts dv dvb dvd dvdr eds encode examples exif expat extras faac fbcon ffmpeg flac fluidsynth fontconfig fontforge foomaticdb fortran frei0r ftp gd gdbm gdu ggi gif gimp gles glsl gme gnome gnome-keyring gphoto2 gpm gsm gstreamer gtk httpd iconv id3tag ieee1394 imagemagick ipod ipv6 java jce jpeg jpeg2k kate kde kdrive ladspa lame lapack lcms ldap libass libcaca libmpeg2 libnotify libproxy libtiger libv4l2 lirc live lua lzma lzo mad matroska md5sum metalink mjpeg mmx mng modplug modules mp3 mpeg mpg123 mtp mudflap multilib musepack musicbrainz nas nautilus ncurses network nls nptl nptlonly nsplugin nspluginwrapper nut nuv odbc odk ogg openexr opengl openmp openvg optimisememory oss pam pango pasteafter pcre pdf perl phonon php plasma playlist png pnm postproc ppds pppd projectm ps pvr python qalculate qt-faststart qt4 quicktime qwt radio raw readline reiserfs remoteosd rtmp rtsp run-as-root samba schroedinger scim screensaver script scripts sdk sdl sdl-image semantic-desktop session shine shout skins smp sqlite sse sse2 ssl ssse3 startup-notification stream svg sysfs system-libvncserver taglib tcpd templates tga theora threads tiff tilepath tk tools truetype truetype-debugger twolame type3 udev unicode upnp usb utils v4l2 vaapi vcdx vdpau vix vlm vmware_guest_freebsd vmware_guest_linux vmware_guest_netware vmware_guest_solaris vmware_guest_winPre2k vmware_guest_windows vorbis vpx webkit wma-fixed wmf x264 xanim xcb xine xinerama xml xmlrpc xmp xorg xosd xv xvid xvmc yv12 zlib zvbi" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="ptp2 adc65 agfa_cl20 aox ax203 barbie canon casio_qv clicksmart310 digigr8 digita dimagev dimera3500 directory enigma13 fuji gsmart300 hp215 iclick jamcam jd11 jl2005a kodak_dc120 kodak_dc210 kodak_dc240 kodak_dc3200 kodak_ez200 konica konica_qm150 largan lg_gsm mars mustek panasonic_coolshot panasonic_dc1000 panasonic_dc1580 panasonic_l859 pccam300 pccam600 polaroid_pdc320 polaroid_pdc640 polaroid_pdc700 ricoh ricoh_g3 samsung sierra sipix_blink sipix_blink2 sipix_web2 smal sonix sony_dscf1 sony_dscf55 soundvision spca50x sq905 st2205 stv0674 stv0680 sx330z template topfield toshiba_pdrm11" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="nb" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, MAKEOPTS, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


renato gallo





          2011-05-06 14:14:48 UTC
        

libtool: link: x86_64-pc-linux-gnu-gcc -I/usr/include/freetype2 -I/usr/include -O2 -pipe -march=native -Wall -Wdeclaration-after-statement -Wmissing-prototypes -Wmissing-declarations -Winit-self -Wpointer-arith -Wold-style-definition -Wl,-O1 -o .libs/file-wmf file_wmf-file-wmf.o -pthread  -Wl,--as-needed ../../libgimp/.libs/libgimpui-2.0.so ../../libgimpwidgets/.libs/libgimpwidgets-2.0.so ../../libgimpmodule/.libs/libgimpmodule-2.0.so ../../libgimp/.libs/libgimp-2.0.so ../../libgimpmath/.libs/libgimpmath-2.0.so ../../libgimpconfig/.libs/libgimpconfig-2.0.so ../../libgimpcolor/.libs/libgimpcolor-2.0.so ../../libgimpbase/.libs/libgimpbase-2.0.so -lgtk-x11-2.0 -lgdk-x11-2.0 /usr/lib64/libatk-1.0.so /usr/lib64/libgio-2.0.so -lpangoft2-1.0 -lpangocairo-1.0 -lgdk_pixbuf-2.0 -lcairo -lpng15 -lpango-1.0 /usr/lib64/libfontconfig.so /usr/lib64/libgobject-2.0.so /usr/lib64/libgmodule-2.0.so /usr/lib64/libgthread-2.0.so -lrt /usr/lib64/libglib-2.0.so -L/usr/lib64 -lwmf -lwmflite /usr/lib64/libfreetype.so -lX11 /usr/lib64/libexpat.so -ljpeg -lpng -lz -lm -pthread
/usr/lib/gcc/x86_64-pc-linux-gnu/4.4.5/../../../../x86_64-pc-linux-gnu/bin/ld: warning: libpng14.so.14, needed by /usr/lib64/libwmf.so, not found (try using -rpath or -rpath-link)
/usr/lib64/libwmf.so: undefined reference to `png_create_write_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_set_IHDR@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_create_info_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_init_io@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_row@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_info@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_write_end@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_destroy_write_struct@PNG14_0'
/usr/lib64/libwmf.so: undefined reference to `png_set_text@PNG14_0'
collect2: ld returned 1 exit status
make[3]: *** [file-wmf] Error 1
make[3]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r2/work/gimp-2.6.11/plug-ins/common'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r2/work/gimp-2.6.11/plug-ins'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r2/work/gimp-2.6.11'
make: *** [all] Error 2
emake failed
 * ERROR: media-gfx/gimp-2.6.11-r2 failed (compile phase):




Comment 2


renato gallo





          2011-05-06 14:27:48 UTC
        

  CC     file-mng.o
file-mng.c: In function 'mng_save_image':
file-mng.c:972: error: dereferencing pointer to incomplete type
file-mng.c:984: error: dereferencing pointer to incomplete type
file-mng.c:985: error: dereferencing pointer to incomplete type
file-mng.c:986: error: dereferencing pointer to incomplete type
file-mng.c:987: error: dereferencing pointer to incomplete type
file-mng.c:992: error: dereferencing pointer to incomplete type
file-mng.c:995: error: dereferencing pointer to incomplete type
file-mng.c:998: error: dereferencing pointer to incomplete type
file-mng.c:1001: error: dereferencing pointer to incomplete type
file-mng.c:1004: error: dereferencing pointer to incomplete type
file-mng.c:1005: error: dereferencing pointer to incomplete type
file-mng.c:1006: error: dereferencing pointer to incomplete type
file-mng.c:1008: error: dereferencing pointer to incomplete type
file-mng.c:1011: error: dereferencing pointer to incomplete type
file-mng.c:1024: error: dereferencing pointer to incomplete type
file-mng.c:1026: error: dereferencing pointer to incomplete type
file-mng.c:1027: error: dereferencing pointer to incomplete type
file-mng.c:1028: error: dereferencing pointer to incomplete type
file-mng.c:1029: error: dereferencing pointer to incomplete type
file-mng.c:1030: error: dereferencing pointer to incomplete type
file-mng.c:1031: error: dereferencing pointer to incomplete type
file-mng.c:1041: error: dereferencing pointer to incomplete type
file-mng.c:1042: error: dereferencing pointer to incomplete type
file-mng.c:1068: error: dereferencing pointer to incomplete type
file-mng.c:1080: error: dereferencing pointer to incomplete type
file-mng.c:1234: warning: ignoring return value of 'fread', declared with attribute warn_unused_result
make[3]: *** [file-mng.o] Error 1
make[3]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.7.2/work/gimp-2.7.2/plug-ins/common'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.7.2/work/gimp-2.7.2/plug-ins'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.7.2/work/gimp-2.7.2'
make: *** [all] Error 2
emake failed
 * ERROR: media-gfx/gimp-2.7.2 failed (compile phase):




Comment 3


Rafał Mużyło





          2011-05-06 14:44:01 UTC
        

That looks like a mix of a few separate problems.
- libwmf seems underlinked
- libwmf is either not stated correctly as a dep of gimp or instead of revdep-rebuild, you're trying to trick the system with '--skip-first --keep-going'
- gimp 2.7.2 seems to be your own ebuild (libpng 1.5 changes got into the upstream git yesterday, therefore 2.7.2 doesn't have them of its own)

I'd say, that till you update libwmf, this is INVALID




Comment 4


renato gallo





          2011-05-06 14:51:07 UTC
        

(In reply to comment #3)
> That looks like a mix of a few separate problems.
> - libwmf seems underlinked
> - libwmf is either not stated correctly as a dep of gimp or instead of
> revdep-rebuild, you're trying to trick the system with '--skip-first
> --keep-going'
> - gimp 2.7.2 seems to be your own ebuild (libpng 1.5 changes got into the
> upstream git yesterday, therefore 2.7.2 doesn't have them of its own)
> 
> I'd say, that till you update libwmf, this is INVALID

as for 2.7.2

https://github.com/megabaks/stuff/tree/master/media-gfx/gimp




Comment 5


renato gallo





          2011-05-06 14:52:23 UTC
        

(In reply to comment #3)
> That looks like a mix of a few separate problems.
> - libwmf seems underlinked
> - libwmf is either not stated correctly as a dep of gimp or instead of
> revdep-rebuild, you're trying to trick the system with '--skip-first
> --keep-going'
> - gimp 2.7.2 seems to be your own ebuild (libpng 1.5 changes got into the
> upstream git yesterday, therefore 2.7.2 doesn't have them of its own)
> 
> I'd say, that till you update libwmf, this is INVALID

as for libwmf

/bin/sh ../../libtool --tag=CC   --mode=compile x86_64-pc-linux-gnu-gcc -DHAVE_CONFIG_H -DPACKAGE=\"libwmf\" -DVERSION=\"0.2.8\" -I. -I../.. -I../../include -I../../src  -I../..   -I/usr/include/freetype2        -O2 -pipe -march=native -MT ipa.lo -MD -MP -MF .deps/ipa.Tpo -c -o ipa.lo ipa.c
libtool: compile:  x86_64-pc-linux-gnu-gcc -DHAVE_CONFIG_H -DPACKAGE=\"libwmf\" -DVERSION=\"0.2.8\" -I. -I../.. -I../../include -I../../src -I../.. -I/usr/include/freetype2 -O2 -pipe -march=native -MT ipa.lo -MD -MP -MF .deps/ipa.Tpo -c ipa.c  -fPIC -DPIC -o .libs/ipa.o
In file included from ipa.c:47:
../../src/ipa/ipa/bmp.h: In function 'ldr_bmp_png':
../../src/ipa/ipa/bmp.h:69: error: dereferencing pointer to incomplete type
make[3]: *** [ipa.lo] Error 1
make[3]: Leaving directory `/var/tmp/portage/media-libs/libwmf-0.2.8.4-r3/work/libwmf-0.2.8.4/src/ipa'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/media-libs/libwmf-0.2.8.4-r3/work/libwmf-0.2.8.4/src'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-libs/libwmf-0.2.8.4-r3/work/libwmf-0.2.8.4'
make: *** [all] Error 2
emake failed
 * ERROR: media-libs/libwmf-0.2.8.4-r3 failed (compile phase):




Comment 6


renato gallo





          2011-05-06 14:54:09 UTC
        

(In reply to comment #5)
> (In reply to comment #3)
> > That looks like a mix of a few separate problems.
> > - libwmf seems underlinked
> > - libwmf is either not stated correctly as a dep of gimp or instead of
> > revdep-rebuild, you're trying to trick the system with '--skip-first
> > --keep-going'
> > - gimp 2.7.2 seems to be your own ebuild (libpng 1.5 changes got into the
> > upstream git yesterday, therefore 2.7.2 doesn't have them of its own)
> > 
> > I'd say, that till you update libwmf, this is INVALID
> 
> as for libwmf
> 
> /bin/sh ../../libtool --tag=CC   --mode=compile x86_64-pc-linux-gnu-gcc
> -DHAVE_CONFIG_H -DPACKAGE=\"libwmf\" -DVERSION=\"0.2.8\" -I. -I../..
> -I../../include -I../../src  -I../..   -I/usr/include/freetype2        -O2
> -pipe -march=native -MT ipa.lo -MD -MP -MF .deps/ipa.Tpo -c -o ipa.lo ipa.c
> libtool: compile:  x86_64-pc-linux-gnu-gcc -DHAVE_CONFIG_H -DPACKAGE=\"libwmf\"
> -DVERSION=\"0.2.8\" -I. -I../.. -I../../include -I../../src -I../..
> -I/usr/include/freetype2 -O2 -pipe -march=native -MT ipa.lo -MD -MP -MF
> .deps/ipa.Tpo -c ipa.c  -fPIC -DPIC -o .libs/ipa.o
> In file included from ipa.c:47:
> ../../src/ipa/ipa/bmp.h: In function 'ldr_bmp_png':
> ../../src/ipa/ipa/bmp.h:69: error: dereferencing pointer to incomplete type
> make[3]: *** [ipa.lo] Error 1
> make[3]: Leaving directory
> `/var/tmp/portage/media-libs/libwmf-0.2.8.4-r3/work/libwmf-0.2.8.4/src/ipa'
> make[2]: *** [all-recursive] Error 1
> make[2]: Leaving directory
> `/var/tmp/portage/media-libs/libwmf-0.2.8.4-r3/work/libwmf-0.2.8.4/src'
> make[1]: *** [all-recursive] Error 1
> make[1]: Leaving directory
> `/var/tmp/portage/media-libs/libwmf-0.2.8.4-r3/work/libwmf-0.2.8.4'
> make: *** [all] Error 2
> emake failed
>  * ERROR: media-libs/libwmf-0.2.8.4-r3 failed (compile phase):

again as libwmf:


http://wvware.sourceforge.net/libwmf.html#download

"libwmf is in CVS under the module name libwmf2, not libwmf which is the libwmf-0.1.* series and no longer in active development. "




Comment 7


renato gallo





          2011-05-06 19:07:51 UTC
        

(In reply to comment #3)
> That looks like a mix of a few separate problems.
> - libwmf seems underlinked
> - libwmf is either not stated correctly as a dep of gimp or instead of
> revdep-rebuild, you're trying to trick the system with '--skip-first
> --keep-going'
> - gimp 2.7.2 seems to be your own ebuild (libpng 1.5 changes got into the
> upstream git yesterday, therefore 2.7.2 doesn't have them of its own)
> 
> I'd say, that till you update libwmf, this is INVALID

WITH USE=-wmf

file-mng.c: In function 'mng_save_image':
file-mng.c:972: error: dereferencing pointer to incomplete type
file-mng.c:984: error: dereferencing pointer to incomplete type
file-mng.c:985: error: dereferencing pointer to incomplete type
file-mng.c:986: error: dereferencing pointer to incomplete type
file-mng.c:987: error: dereferencing pointer to incomplete type
file-mng.c:992: error: dereferencing pointer to incomplete type
file-mng.c:995: error: dereferencing pointer to incomplete type
file-mng.c:998: error: dereferencing pointer to incomplete type
file-mng.c:1001: error: dereferencing pointer to incomplete type
file-mng.c:1004: error: dereferencing pointer to incomplete type
file-mng.c:1005: error: dereferencing pointer to incomplete type
file-mng.c:1006: error: dereferencing pointer to incomplete type
file-mng.c:1008: error: dereferencing pointer to incomplete type
file-mng.c:1011: error: dereferencing pointer to incomplete type
file-mng.c:1024: error: dereferencing pointer to incomplete type
file-mng.c:1026: error: dereferencing pointer to incomplete type
file-mng.c:1027: error: dereferencing pointer to incomplete type
file-mng.c:1028: error: dereferencing pointer to incomplete type
file-mng.c:1029: error: dereferencing pointer to incomplete type
file-mng.c:1030: error: dereferencing pointer to incomplete type
file-mng.c:1031: error: dereferencing pointer to incomplete type
file-mng.c:1041: error: dereferencing pointer to incomplete type
file-mng.c:1042: error: dereferencing pointer to incomplete type
file-mng.c:1068: error: dereferencing pointer to incomplete type
file-mng.c:1080: error: dereferencing pointer to incomplete type
file-mng.c:1234: warning: ignoring return value of 'fread', declared with attribute warn_unused_result
make[3]: *** [file-mng.o] Error 1
make[3]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r2/work/gimp-2.6.11/plug-ins/common'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r2/work/gimp-2.6.11/plug-ins'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-gfx/gimp-2.6.11-r2/work/gimp-2.6.11'
make: *** [all] Error 2
emake failed
 * ERROR: media-gfx/gimp-2.6.11-r2 failed (compile phase):




Comment 8


Rafał Mużyło





          2011-05-07 16:05:05 UTC
        

Given that 2.7.2, mind attaching full log - just so to check if it's not yet another overlay ebuild.




Comment 9


renato gallo





          2011-05-07 16:42:43 UTC
        

Created attachment 272403 [details]
/var/tmp/portage/media-gfx/gimp-2.6.11-r1/temp/build.log




Comment 10


renato gallo





          2011-05-07 16:43:57 UTC
        

Created attachment 272405 [details]
/var/tmp/portage/media-gfx/gimp-2.6.11-r2/temp/build.log




Comment 11


renato gallo





          2011-05-07 16:44:35 UTC
        

Created attachment 272407 [details]
/var/tmp/portage/media-gfx/gimp-2.7.2/temp/build.log




Comment 12


renato gallo





          2011-05-07 16:45:10 UTC
        

Created attachment 272409 [details]
/var/tmp/portage/media-gfx/gimp-9999/temp/build.log




Comment 13


renato gallo





          2011-05-07 16:45:46 UTC
        

(In reply to comment #8)
> Given that 2.7.2, mind attaching full log - just so to check if it's not yet
> another overlay ebuild.

log added of all my attempts regarding having a working gimp




Comment 14


renato gallo





          2011-05-07 16:46:31 UTC
        

opps wrong syntax....

errata corrige:

"attempts to have a working gimp"




Comment 15


renato gallo





          2011-05-07 18:05:02 UTC
        

gimp-2.7.2 compiles with USE=-mng




Comment 16


Rafał Mużyło





          2011-05-07 21:01:44 UTC
        

Log in comment 9 is the libwmf problem, log from comment 10 while pretending to be in-tree, applies a 'png.patch' that definitely not in-tree and we already established 2.7.2 is not in the tree.




Comment 17


renato gallo





          2011-05-07 22:05:03 UTC
        

(In reply to comment #16)
> Log in comment 9 is the libwmf problem, log from comment 10 while pretending to
> be in-tree, applies a 'png.patch' that definitely not in-tree and we already
> established 2.7.2 is not in the tree.

as for the png patch you can find it here:

http://bugs.gentoo.org/attachment.cgi?id=262679




Comment 18


Rafał Mużyło





          2011-05-07 22:50:54 UTC
        

I didn't asked where did you get it from, just said it's not an in-tree patch.




Comment 19


Samuli Suominen (RETIRED)






          2011-08-07 08:34:06 UTC
        

Use at least 2.6.11-r2 and rebuild your media-libs/libwmf before media-gfx/gimp

# emerge -1 libwmf
# emerge ">=media-gfx/gimp-2.6.11-r2"

2.7.x series is not in Portage and -9999 is live version (meaning the fix will come from upstream repository when they are ready)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

