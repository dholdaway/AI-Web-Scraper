Title: 154371 – net-wireless/ipw3945 - does not work after suspend
URL: https://bugs.gentoo.org/show_bug.cgi?id=154371

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 154371
net-wireless/ipw3945 - does not work after suspend
Last modified: 2006-12-31 13:04:09 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 154371 
      - net-wireless/ipw3945 - does not work after suspend


Summary:
net-wireless/ipw3945 - does not work after suspend
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Alon Bar-Lev (RETIRED)








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

154372

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2006-11-07 07:57 UTC by Marco Dußling





      Modified:
    
2006-12-31 13:04 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



alonbl
mobile+disabled









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




hibernate-script-1.94-blacklisted-modules.patch

              (hibernate-script-1.94-blacklisted-modules.patch,415 bytes,
                patch)

            
2006-12-18 13:25 UTC,

            Marcel Klein




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Marco Dußling





          2006-11-07 07:57:53 UTC
        

Hi, I'm using sys-kernel/suspend2-sources-2.6.18 and net-wireless/ipw3945-1.1.2.  When my laptop wakes up from suspend my wireless-interface (eth1) doesn't get its IPv6 address back, IPv4 works fine and there aren't any problems with eth0...

emerge --info output:
Gentoo Base System version 1.12.6
Last Sync: Tue, 07 Nov 2006 14:30:01 +0000
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium-m -O2 -pipe -msse3 -fomit-frame-pointer -funroll-loops"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-march=pentium-m -O2 -pipe -msse3 -fomit-frame-pointer -funroll-loops"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.uni-erlangen.de/mirrors/gentoo/"
LANG="en_US.utf8"
LC_ALL="en_US.utf8"
MAKEOPTS="-j3 -s"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /usr/local/mpd-portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"




Comment 1


Jakub Moc (RETIRED)






          2006-11-07 07:59:51 UTC
        

*** Bug 154372 has been marked as a duplicate of this bug. ***




Comment 2


Christian Heim (RETIRED)






          2006-12-17 12:06:31 UTC
        

(In reply to comment #0)
> Hi, I'm using sys-kernel/suspend2-sources-2.6.18 and
> net-wireless/ipw3945-1.1.2.  When my laptop wakes up from suspend my
> wireless-interface (eth1) doesn't get its IPv6 address back, IPv4 works fine
> and there aren't any problems with eth0...
> 
> emerge --info output:
> Gentoo Base System version 1.12.6
> Last Sync: Tue, 07 Nov 2006 14:30:01 +0000
> distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632)
> [disabled]
> ccache version 2.4 [enabled]
> dev-java/java-config: 1.3.7, 2.0.30
> dev-lang/python:     2.4.4
> dev-python/pycrypto: 2.0.1-r5
> dev-util/ccache:     2.4-r6
> sys-apps/sandbox:    1.2.18.1
> sys-devel/autoconf:  2.13, 2.60
> sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
> sys-devel/binutils:  2.17
> sys-devel/gcc-config: 1.3.14
> sys-devel/libtool:   1.5.22
> virtual/os-headers:  2.6.17-r1
> ACCEPT_KEYWORDS="x86 ~x86"
> AUTOCLEAN="yes"
> CBUILD="i686-pc-linux-gnu"
> CFLAGS="-march=pentium-m -O2 -pipe -msse3 -fomit-frame-pointer -funroll-loops"
> CHOST="i686-pc-linux-gnu"
> CONFIG_PROTECT="/etc /usr/share/X11/xkb"
> CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf
> /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo"
> CXXFLAGS="-march=pentium-m -O2 -pipe -msse3 -fomit-frame-pointer
> -funroll-loops"
> DISTDIR="/usr/portage/distfiles"
> FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict"
> GENTOO_MIRRORS="ftp://ftp.uni-erlangen.de/mirrors/gentoo/"
> LANG="en_US.utf8"
> LC_ALL="en_US.utf8"
> MAKEOPTS="-j3 -s"
> PKGDIR="/usr/portage/packages"
> PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress
> --force --whole-file --delete --delete-after --stats --timeout=180
> --exclude=/distfiles --exclude=/local --exclude=/packages"
> PORTAGE_TMPDIR="/var/tmp"
> PORTDIR="/usr/portage"
> PORTDIR_OVERLAY="/usr/local/portage /usr/local/mpd-portage"
> SYNC="rsync://rsync.gentoo.org/gentoo-portage"

Sadly suspend2-sources isn't a supported kernel (as of http://www.gentoo.org/doc/en/gentoo-kernel.xml). Thus I'd like to ask you to reproduce this failure with a supported kernel (gentoo-sources).




Comment 3


Marco Dußling





          2006-12-18 12:58:26 UTC
        

What's the point of using the gentoo-sources?  I have the problem while using suspend. I could use the gentoo-sources and patch them with the suspend2 patches but that's the same like using suspend2-sources.




Comment 4


Marcel Klein





          2006-12-18 13:25:35 UTC
        

Created attachment 104310 [details, diff]
hibernate-script-1.94-blacklisted-modules.patch

Adding ipw3945 to /etc/hibernate/blacklisted-modules fixes this problem we just tested it.
Please add this patch to the hibernate-script package.




Comment 5


Christian Heim (RETIRED)






          2006-12-19 03:52:59 UTC
        

(In reply to comment #4)
> Created an attachment (id=104310) [edit]
> hibernate-script-1.94-blacklisted-modules.patch
> 
> Adding ipw3945 to /etc/hibernate/blacklisted-modules fixes this problem we just
> tested it.
> Please add this patch to the hibernate-script package.

Alon, could we get this into the next revision of hibernate-script ? Would be great.




Comment 6


Alon Bar-Lev (RETIRED)






          2006-12-19 11:13:53 UTC
        

This is very strange!
The ipw3945 should be based on ipw2200, which works fine for a year or so.

Macro, is there anything in /var/log/messages after suspend that relates to the eth1 interface?




Comment 7


Marco Dußling





          2006-12-27 11:45:45 UTC
        

Nothing special, just that the interface is coming up...
Sice I added ipw3945 into /etc/hibernate/blacklisted-modules everything just works fine.





Comment 8


Christian Heim (RETIRED)






          2006-12-27 12:29:10 UTC
        

(In reply to comment #6)
> This is very strange!
> The ipw3945 should be based on ipw2200, which works fine for a year or so.

It is, *but* it's using some weirdo regulatory daemon which sometimes freaks completely. I still like to see the blacklist in hibernate-script's blacklist (if it is by now Alon, feel free mark the bug RESOLVED).





Comment 9


Alon Bar-Lev (RETIRED)






          2006-12-27 12:52:21 UTC
        

I guessed the daemon is the source of the problem.
Please try to unload the module before hibernation, it will take down the daemon (If I remember correctly, I don't have the environment to test it now).

At common.conf:
UnloadModules ipw3945
LoadModules auto





Comment 10


Alon Bar-Lev (RETIRED)






          2006-12-29 10:50:16 UTC
        

OK.
Have a computer for testing for the next week.
The following configuration works for me.
Please try and report back.

I use net-wireless/ipw3945-1.1.3

Modify the following in /etc/hibernate/common.conf

Distribution gentoo
GentooModulesAutoload yes
UnloadModules ipw3945
LoadModules auto
StopServices ipw3945d
DownInterfaces eth1
# UpInterfaces DO NOT SPECIFY





Comment 11


Alon Bar-Lev (RETIRED)






          2006-12-31 13:04:09 UTC
        

Well... This configuration works for me, so I close this.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

