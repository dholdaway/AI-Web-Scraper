Title: 315281 – Screen completely garbled after xorg-server upgrade to 1.8
URL: https://bugs.gentoo.org/show_bug.cgi?id=315281

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 315281
Screen completely garbled after xorg-server upgrade to 1.8
Last modified: 2011-03-14 14:44:57 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 315281 
      - Screen completely garbled after xorg-server upgrade to 1.8


Summary:
Screen completely garbled after xorg-server upgrade to 1.8
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-04-14 17:23 UTC by Piotrek Juzwiak





      Modified:
    
2011-03-14 14:44 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



dennisonic
piotrek.juzwiak









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Kernel config (cat /usr/src/linux-2.6.33-r1)

              (config,60.55 KB,
                text/plain)

            
2010-04-17 18:19 UTC,

            Piotrek Juzwiak




Details





dmesg

              (dmesg,38.13 KB,
                text/plain)

            
2010-04-17 18:19 UTC,

            Piotrek Juzwiak




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Piotrek Juzwiak





          2010-04-14 17:23:27 UTC
        

Recently i got some updates to libdrm, xorg-server 1.8. I updated those. After the update i had a weird screen behaviour (graphical glitches) when desktop effects had been activated. Considering a faulty update procedure and knowing that libdrm got updated i rebuilt mesa, xorg-server and all dependant drivers, after that i rebuild kdm and kwin yet after that that graphical glitch remains.

Windows disappear, when i have a window minimised then when i click for it to reappear the "look" may stay until i move some other object and "clean" the glitch off. As if a redraw fixes it. 

Reproducible: Always

Steps to Reproduce:
1.Updated libdrm, xorg-server, xf86-* drivers, (rebuilt mesa, kdm and kwin)
2.Activated kwin desktop-effects
3.Just use the desktop

Actual Results:  
Screen is garbled, some parts "stay" on the screen, like part of a login splash stay on the screen despite minimising it, a closed window stays on the screen after the previous action

Expected Results:  
It should "redraw" the screen correctly without "ghost" residue




Comment 1


Piotrek Juzwiak





          2010-04-14 17:29:53 UTC
        

lspci | grep VGA
00:02.0 VGA compatible controller: Intel Corporation 82865G Integrated Graphics Controller (rev 02)




emerge --info
Portage 2.1.8.3 (default/linux/x86/10.0, gcc-4.4.3, glibc-2.11-r1, 2.6.33-gentoo-r1 i686)
=================================================================
System uname: Linux-2.6.33-gentoo-r1-i686-Intel-R-_Celeron-R-_CPU_2.40GHz-with-gentoo-2.0.1
Timestamp of tree: Wed, 14 Apr 2010 14:00:01 +0000
ccache version 2.4 [disabled]
app-shells/bash:     4.1_p5
dev-java/java-config: 2.1.10
dev-lang/python:     2.6.5-r1, 3.1.2-r2
dev-util/ccache:     2.4-r8
dev-util/cmake:      2.8.1
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.1-r1
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.65
sys-devel/automake:  1.10.3, 1.11.1
sys-devel/binutils:  2.20.1
sys-devel/gcc:       4.4.3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6b
virtual/os-headers:  2.6.33                                                                                                  
ACCEPT_KEYWORDS="x86 ~x86"
ACCEPT_LICENSE="*"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-Os -march=native -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-Os -march=native -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests distlocks fixpackages news parallel-fetch protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="pl_PL.utf8@euro"
LDFLAGS="-Wl,-O1"
LINGUAS="pl"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X acl alsa aspell berkdb bzip2 cli consolekit cracklib crypt cxx dbus dri dvd fortran gdbm gpm hal iconv kde laptop mmx modules mudflap ncurses nls nptl nptlonly opengl openmp pam pcre perl phonon pm-utils policykit pppd python qt3support qt4 readline reflection session spl sql sse sse2 ssl sysfs tcpd threads truetype unicode x86 xorg zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="pl" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="intel" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LC_ALL, MAKEOPTS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY


cat /var/log/Xorg.0.log | grep "(EE)"
        (WW) warning, (EE) error, (NI) not implemented, (??) unknown.
[    19.458] (EE) Failed to load module "vesa" (module does not exist, 0)
[    19.458] (EE) Failed to load module "fbdev" (module does not exist, 0)
[    21.672] (EE) No input driver/identifier specified (ignoring)


cat /var/log/Xorg.0.log | grep "(WW)"
        (WW) warning, (EE) error, (NI) not implemented, (??) unknown.
[    19.021] (WW) The directory "/usr/share/fonts/misc/" does not exist.
[    19.021] (WW) The directory "/usr/share/fonts/TTF/" does not exist.
[    19.021] (WW) The directory "/usr/share/fonts/OTF/" does not exist.
[    19.021] (WW) The directory "/usr/share/fonts/Type1/" does not exist.
[    19.021] (WW) The directory "/usr/share/fonts/100dpi/" does not exist.
[    19.021] (WW) The directory "/usr/share/fonts/75dpi/" does not exist.
[    19.457] (WW) Warning, couldn't open module vesa
[    19.458] (WW) Warning, couldn't open module fbdev

There is no xorg.conf file.




Comment 2


denysonique





          2010-04-15 03:52:54 UTC
        

I had the same issue after an upgrade to 1.8 and running a compisiting manager Compiz. I had tried restarting xorg through /etc/init.d/xdm restart and loging in again without any luck(problem persisted). Fortunately after switching to a different user via xdm(gnome new login) and returning to the previous user by logout of the newly loged in user the problem did no appear any more neither for the first user that had the problem nor for the second as the second had no compositing manager running so I was unable to notice the issue for that user.
I am not sure whether I have not done emerge -uD world before switching the users.
It could be possible that the update solved the problem.
I though that the user switching was some kind of fix but after restarting xorg and also rebooting the machine the problem did not appear any more.




Comment 3


denysonique





          2010-04-15 22:45:44 UTC
        

Sorry the problem still persists just before I started writing this comment the problem occured again. I tried loging in and out plus the user switch as described in my previous comment and none of these helped this time but  after suspending to ram xorg works again.




Comment 4


denysonique





          2010-04-15 22:50:34 UTC
        

Also I would like to add that xorg displays some black horizontal strips when rotating the compiz cube.




Comment 5


Piotrek Juzwiak





          2010-04-16 08:43:15 UTC
        

I can't add anything more since it is unusable in that state if i have desktop effects working. Windows disappear, they flash when moving and eventually also disappear...




Comment 6


Chí-Thanh Christopher Nguyễn






          2010-04-17 13:36:35 UTC
        

Also attach dmesg and kernel config, please




Comment 7


Piotrek Juzwiak





          2010-04-17 18:19:29 UTC
        

Created attachment 228195 [details]
Kernel config (cat /usr/src/linux-2.6.33-r1)




Comment 8


Piotrek Juzwiak





          2010-04-17 18:19:45 UTC
        

Created attachment 228197 [details]
dmesg




Comment 9


Chí-Thanh Christopher Nguyễn






          2010-06-24 21:26:10 UTC
        

Not sure if it will help, but

# CONFIG_X86_UP_APIC is not set

try with this option enabled (boot with lapic if dmesg tells you to)




Comment 10


Andreas K. Hüttel







          2010-11-02 23:18:33 UTC
        

Seems to be not kde-specific...




Comment 11


Theo Chatzimichos (RETIRED)








          2011-01-13 01:07:32 UTC
        

removing KDE from CC, doesn't seem like a kde bug









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

