Title: 373111 – media-gfx/imagemagick-6.6.8.5: Fails to emerge with media-libs/mesa[-egl]
URL: https://bugs.gentoo.org/show_bug.cgi?id=373111

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 373111
media-gfx/imagemagick-6.6.8.5: Fails to emerge with media-libs/mesa[-egl]
Last modified: 2011-12-11 06:25:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 373111 
      - media-gfx/imagemagick-6.6.8.5: Fails to emerge with media-libs/mesa[-egl]


Summary:
media-gfx/imagemagick-6.6.8.5: Fails to emerge with media-libs/mesa[-egl]
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Graphics Project








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

375593

      (view as bug list)
    


Depends on:







Blocks:




354943



 

        Show dependency tree





 





      Reported:
    
2011-06-26 12:35 UTC by Jeremy Murphy





      Modified:
    
2011-12-11 06:25 UTC
      (History)
    




          CC List:
        

4 
          users
          
            (show)
          



amd64
gnome
mondrillo
x11









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jeremy Murphy





          2011-06-26 12:35:10 UTC
        

If mesa has been emerged with USE="-egl" then svg.la will fail to link, at the end of compilation.


Reproducible: Always

Steps to Reproduce:
1. USE=-egl emerge -1v mesa
2. emerge -1v imagemagick

Actual Results:  
  CCLD   coders/svg.la
/usr/lib/gcc/x86_64-pc-linux-gnu/4.4.5/../../../../x86_64-pc-linux-gnu/bin/ld: cannot find -lEGL
collect2: ld returned 1 exit status
make[1]: *** [coders/svg.la] Error 1
make[1]: Leaving directory `/home/portage/media-gfx/imagemagick-6.6.8.5/work/ImageMagick-6.6.8-5'
make: *** [all] Error 2
emake failed


Expected Results:  
As far as I can tell, imagemagick requires mesa[egl], so the imagemagick ebuild should check for it and die if it is not found.  If the EGL requirement can be turned off in imagemagick via a configure flag, so much the better.


Portage 2.1.9.42 (default/linux/amd64/10.0/desktop/kde, gcc-4.4.5, libc-0-r0, 2.6.39-gentoo-r2 x86_64)
=================================================================
System uname: Linux-2.6.39-gentoo-r2-x86_64-Intel-R-_Core-TM-2_CPU_6700_@_2.66GHz-with-gentoo-2.0.2
Timestamp of tree: Sun, 26 Jun 2011 00:15:01 +0000
distcc 3.1 x86_64-unknown-linux-gnu [disabled]
app-shells/bash:     4.1_p9
dev-java/java-config: 2.1.11-r3
dev-lang/python:     2.7.1-r1, 3.1.3-r1
dev-util/cmake:      2.8.4-r1
sys-apps/baselayout: 2.0.2
sys-apps/openrc:     0.8.2-r1
sys-apps/sandbox:    2.4
sys-devel/autoconf:  2.65-r1
sys-devel/automake:  1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.4.5
sys-devel/gcc-config: 1.4.1-r1
sys-devel/libtool:   2.2.10
sys-devel/make:      3.82
sys-kernel/linux-headers: 2.6.36.1
sys-libs/glibc:      2.12.2
virtual/os-headers:  0
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA skype-eula AdobeFlash-10.1 dlj-1.1 google-talkplugin"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=core2"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe -march=core2"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks fixlafiles fixpackages news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://ftp.iinet.net.au/pub/Gentoo http://mirror.pacific.net.au/linux/Gentoo http://ftp.swin.edu.au/gentoo http://xorg.freedesktop.org/releases/individual/lib/"
LANG="en_AU.UTF-8"
LC_ALL="en_AU.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en_AU en_GB"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/home"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/sunrise /var/lib/layman/x11 /usr/local/portage"
SYNC="rsync://rsync.au.gentoo.org/gentoo-portage"
USE="X a52 aac aalib acpi alsa amd64 ao avahi bash-completion berkdb blas bluetooth branding bzip2 cairo cdda cddb cdr cli consolekit cracklib crypt css curl cxx dbus declarative djvu dri dts dvd dvdr emboss encode exif expat fam ffmpeg fftw flac fontconfig fortran gd gdbm gdu geoip gif gmp gnutls gphoto2 gpm graphviz gsl gtk iconv icq icu imagemagick imlib ipod ipv6 java java5 java6 javascript jpeg jpeg2k kde kipi ladspa lame lapack latex lcms ldap libnotify libsamplerate lm_sensors lzma lzo mad matroska mmap mmx mng modules mp3 mp4 mpeg msn mtp mudflap multilib mysql mysqli ncurses nls nptl nptlonly ntfs offensive ogg openal openexr opengl openmp pam pango pch pcre pdf perl phonon php plasma png policykit ppds pppd python qt3support qt4 readline samba sdl semantic-desktop session sharedmem smp sndfile sox speex spell sqlite sqlite3 sse sse2 ssl startup-notification subversion svg sysfs syslog taglib tcpd theora threads tiff timidity truetype udev unicode usb v4l2 vcd vorbis wavpack wmf wxwindows x264 xcb xcomposite xine xinerama xml xorg xpm xscreensaver xv xvid xvmc zeroconf zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="braindump flow karbon kexi kpresenter krita tables words" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en_AU en_GB" PHP_TARGETS="php5-3" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="radeon r600" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Jeremy Murphy





          2011-06-26 13:09:02 UTC
        

Oh, I should mention that this only applies to mesa in the x11 overlay, oops.  :)




Comment 2


Chí-Thanh Christopher Nguyễn






          2011-07-10 04:01:46 UTC
        

What is the current status of this bug? If you build mesa-7.11_rc1 with USE="-egl" and then run revdep-rebuild, does imagemagick still fail?




Comment 3


Rafal Lalik





          2011-07-12 20:57:07 UTC
        

Yes, it still fails. The same is for gtk+, pango, cairo, librsvg and others. List of broken packages you can obtain using revdep-rebuild.

Unfortunately ./configure for gtk+ doesn't allow you (or I missed this option) to compile without libEGL thus it seems that mentioned above ebuilds should force mesa with USE="egl".

Any ideas?




Comment 4


Chí-Thanh Christopher Nguyễn






          2011-07-12 21:01:12 UTC
        

I think it is rather cairo with (another) automagic dependency which makes all packages building against it require egl.




Comment 5


Pacho Ramos






          2011-07-20 09:26:18 UTC
        

*** Bug 375593 has been marked as a duplicate of this bug. ***




Comment 6


Pacho Ramos






          2011-07-20 09:27:14 UTC
        

This is also annoying when building emul packages :S




Comment 7


Samuli Suominen (RETIRED)






          2011-12-11 06:25:58 UTC
        

Looks like broken .la files in combination with bug 391251.
Workaround is to remove it first.

emerge -C imagemagick
emerge imagemagick

Closing this in favour of bug 391251









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

