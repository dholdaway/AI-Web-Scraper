Title: 158326 – sys-power/apcupsd-3.10.18-r1 does not abort when build fails
URL: https://bugs.gentoo.org/show_bug.cgi?id=158326

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 158326
sys-power/apcupsd-3.10.18-r1 does not abort when build fails
Last modified: 2007-01-08 22:10:08 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 158326 
      - sys-power/apcupsd-3.10.18-r1 does not abort when build fails


Summary:
sys-power/apcupsd-3.10.18-r1 does not abort when build fails
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Michael Imhof (RETIRED)








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

160963

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2006-12-16 15:13 UTC by Michele Schiavo





      Modified:
    
2007-01-08 22:10 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



84984973
base-system









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




the output of "emerge apcupsd >& emerge.log"

              (emerge.log,46.90 KB,
                text/plain)

            
2006-12-19 06:09 UTC,

            Luiz C. B. Mostaço-Guidolin




Details





emerge log in /dev/shm

              (emerge.log,56.76 KB,
                text/plain)

            
2006-12-19 11:48 UTC,

            Michele Schiavo




Details





emerge log in /var/tmp

              (emerge_2.log,49.67 KB,
                text/plain)

            
2006-12-19 11:49 UTC,

            Michele Schiavo




Details





emerge in /dev/shm stopped before finish

              (Documento 1 non salvato,2.29 KB,
                text/plain)

            
2006-12-19 11:53 UTC,

            Michele Schiavo




Details





emerge in /dev/shm without distcc

              (emerge.log,43.39 KB,
                text/plain)

            
2006-12-19 12:55 UTC,

            Michele Schiavo




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michele Schiavo





          2006-12-16 15:13:13 UTC
        

equery f apcupsd 
[ Searching for packages matching apcupsd... ]
* Contents of sys-power/apcupsd-3.10.18-r1:
/etc
/etc/apache2
/etc/apache2/modules.d
/etc/apache2/modules.d/60_apcupsd.conf
/etc/apcupsd
/etc/apcupsd/apccontrol
/etc/apcupsd/apcupsd.conf
/etc/apcupsd/changeme
/etc/apcupsd/commfailure
/etc/apcupsd/commok
/etc/apcupsd/mainsback
/etc/apcupsd/masterconnect
/etc/apcupsd/mastertimeout
/etc/apcupsd/onbattery
/etc/apcupsd/powerout -> onbattery
/etc/apcupsd/safe.apccontrol
/etc/init.d
/etc/init.d/apcupsd
/usr
/usr/man
/usr/man/man8
/usr/man/man8/apcupsd.8
/usr/sbin
/var
/var/www
/var/www/apcupsd


/etc/init.d/apcupsd restart
 * Starting APC UPS daemon ...
/sbin/start-stop-daemon: stat /usr/sbin/apcupsd: No such file or directory (No such file or directory)                          [ !! ]




emerge --info
Portage 2.1.1-r2 (default-linux/amd64/2006.1/desktop, gcc-4.1.1, glibc-2.4-r4, 2.6.18-gentoo-r4 x86_64)
=================================================================
System uname: 2.6.18-gentoo-r4 x86_64 Intel(R) Pentium(R) D CPU 3.40GHz
Gentoo Base System version 1.12.6
Last Sync: Sat, 16 Dec 2006 20:50:01 +0000
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
ccache version 2.3 [disabled]
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -mtune=nocona -march=nocona -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/bind /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/splash /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O2 -mtune=nocona -march=nocona -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg collision-protect_ distcc distlocks maketest_ metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.rnl.ist.utl.pt/pub/gentoo/ ftp://ftp.gentoo.mesh-solutions.com/gentoo/ ftp://fido.online.kz/gentoo/pub http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="it_IT.UTF-8"
LINGUAS="en en_GB es es_ES it it_IT"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/dev/shm"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="amd64 16bit 64bit X a52 aac aalib acpi aiglx aim alsa apache2 apm audiofile avi bash-completion berkdb bidi bitmap-fonts bittorrent bluetooth bonobo browserplugin bzip2 cairo caps cdda cddb cdr cgi chroot cjk cli cracklib crypt css cups curl dbus divx dlloader dri dts dv dvd dvdr dvdread dvi dynamic eds elibc_glibc em emboss encode esd ethereal evo evolution exif expat extensions extrafilters faillog fam fame fbsplash ffmpeg firefox flac flash fontconfig foomaticdb fortran fping freetds freetype gaim gcc64 gd gdbm gdm gif gimp gimpprint glitz glut gmp gno gnome gnutls gphoto2 gpm gsm gstreamer gtk gtk2 gtkhtml guile hal hddtemp howl iconv idea idn ieee1394 imagemagick imap imlib input_devices_keyboard input_devices_mouse ipv6 isdnlog ithreads java jpeg kernel_linux lcms libcaca libclamav libedit libg++ libwww linguas_en linguas_en_GB linguas_es linguas_es_ES linguas_it linguas_it_IT live lm_sensors logrotate logwatch lzo lzw lzw-tiff mad maildir maildrop matroska mhash mikmod mime ming mjpeg mng motif mozilla mozsvg mp3 mpeg mplayer mpm-prefork msn musicbrainz mysql nautilus ncurses new-login nfs ng nls nptl nptlonly nsplugin ogg oggvorbis opengl opensslcrypt pam pcre pda pdflib perl php png pop ppds pppd python qmail qt4 quicktime quotas readline recode reflection rtc samba scanner sdl server session slang smp sndfile sound sox spamassassin speex spell spl ssl subtitles svg symlink sysfs syslog tcltk tcpd tetex theora threads tiff toolbar truetype truetype-fonts type1-fonts udev unicode usb userland_GNU v4l v4l2 vcd vhosts video_cards_fglrx vim-syntax vnc vorbis wmf wmp wxgtk1 wxwindows xcomposite xml xml2 xorg xpm xscreensaver xv xvid zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Michele Schiavo





          2006-12-16 15:14:19 UTC
        

 emerge apcupsd -pv

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] sys-power/apcupsd-3.10.18-r1  USE="apache2 cgi ncurses nls threads usb -doc -snmp" 0 kB 





Comment 2


SpanKY






          2006-12-16 16:03:12 UTC
        

post the output of `emerge apcupsd >& log` as an attachment




Comment 3


Luiz C. B. Mostaço-Guidolin





          2006-12-19 06:09:21 UTC
        

Created attachment 104360 [details]
the output of "emerge apcupsd >& emerge.log"

This was the second time I emerged the apcupsd




Comment 4


Luiz C. B. Mostaço-Guidolin





          2006-12-19 06:19:23 UTC
        

Te first time I emerged it I got the same problem. The I reemerged it to produce the emerge.log then it got fixed. I've posted the emerge.log as attachement.

Here are my outputs:

equery f apcupsd
[ Searching for packages matching apcupsd... ]
* Contents of sys-power/apcupsd-3.10.18-r1:
/etc
/etc/apcupsd
/etc/apcupsd/apccontrol
/etc/apcupsd/apcupsd.conf
/etc/apcupsd/changeme
/etc/apcupsd/commfailure
/etc/apcupsd/commok
/etc/apcupsd/mainsback
/etc/apcupsd/masterconnect
/etc/apcupsd/mastertimeout
/etc/apcupsd/onbattery
/etc/apcupsd/powerout -> onbattery
/etc/apcupsd/safe.apccontrol
/etc/init.d
/etc/init.d/apcupsd
/usr
/usr/man
/usr/man/man8
/usr/man/man8/apcupsd.8
/usr/sbin
/usr/sbin/apcaccess
/usr/sbin/apcnisd
/usr/sbin/apctest
/usr/sbin/apcupsd
/usr/sbin/powerflute
/usr/sbin/smtp

my emerge --info:
Portage 2.1.1-r2 (default-linux/amd64/2006.1, gcc-4.1.1, glibc-2.4-r4, 2.6.17-r8-20061107c2 x86_64)
=================================================================
System uname: 2.6.17-r8-20061107c2 x86_64 AMD Athlon(tm)64 X2 Dual Core Processor  4400+
Gentoo Base System version 1.12.6
Last Sync: Sat, 16 Dec 2006 13:00:01 +0000
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O3 -mtune=athlon64 -march=athlon64 -mmmx -msse -m3dnow -pipe -funroll-all-loops -fpeel-loops -ftracer -funswitch-loops -ftree-vectorize"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-O3 -mtune=athlon64 -march=athlon64 -mmmx -msse -m3dnow -pipe -funroll-all-loops -fpeel-loops -ftracer -funswitch-loops -ftree-vectorize"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer parallel-fetch sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LINGUAS="en_US pt_BR"
MAKEOPTS="-j3"
PKGDIR="/srv/pkgdir"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X alsa apache2 bash-completion berkdb bitmap-fonts bzip2 cddb cdparanoia cli cracklib crypt cups divx4linux dri dvd dvdr elibc_glibc firefox gdbm gimp gimpprint gnome gpm iconv input_devices_keyboard input_devices_mouse isdnlog javascript jpeg kernel_linux ldap libg++ linguas_en_US linguas_pt_BR md5sum mozdevelop ncurses network nls nptl nptlonly nsplugin nvidia opengl pam pcre perl png postgres ppds pppd python readline reflection session smp spl ssl tcpd threads tiff tk truetype-fonts type1-fonts udev unicode usb userland_GNU video_cards_nv video_cards_vmware wmf xml xorg xprint xvid zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY

hope it helps.




Comment 5


Michele Schiavo





          2006-12-19 11:48:00 UTC
        

I did it.

The problem is my PORTAGE_TMPDIR="/dev/shm"

mount
....
none on /dev/shm type tmpfs (rw)

if I emerge using /dev/shm , there is the problem.





Comment 6


Michele Schiavo





          2006-12-19 11:48:42 UTC
        

Created attachment 104376 [details]
emerge log in /dev/shm




Comment 7


Michele Schiavo





          2006-12-19 11:49:16 UTC
        

Created attachment 104377 [details]
emerge log in /var/tmp




Comment 8


Michele Schiavo





          2006-12-19 11:53:11 UTC
        

Created attachment 104378 [details]
emerge in /dev/shm stopped before finish




Comment 9


Michele Schiavo





          2006-12-19 12:53:03 UTC
        

the problem is distcc and /dev/shm

Here a log 




Comment 10


Michele Schiavo





          2006-12-19 12:55:26 UTC
        

Created attachment 104388 [details]
emerge in /dev/shm without distcc

The problem is distcc AND /dev/shm

emerge in /var/tmp is good
emerge in /dev/shm without distcc is good
emerge in /dev/tmp with distcc is good
emerge in /dev/shm with distcc is wrong.




Comment 11


Michele Schiavo





          2006-12-19 13:01:23 UTC
        

Sorry, problem is /dev/shm with or without distcc




Comment 12


SpanKY






          2006-12-19 14:07:43 UTC
        

if the summary change wasnt a hint, this isnt a bug in apcupsd

tmpfs is known to have issues in older kernels with timestamps, so stop using it until you upgrade to 2.6.19+




Comment 13


SpanKY






          2006-12-19 14:09:43 UTC
        

the tmpfs issue is tracked elsewhere and the parallel build issues are tracked at Bug 156980




Comment 14


Jakub Moc (RETIRED)






          2007-01-08 22:10:08 UTC
        

*** Bug 160963 has been marked as a duplicate of this bug. ***









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

