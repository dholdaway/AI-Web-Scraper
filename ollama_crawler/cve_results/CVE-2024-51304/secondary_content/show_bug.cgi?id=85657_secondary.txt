Title: 85657 – *DEPEND problem after every few emerge syncs
URL: https://bugs.gentoo.org/show_bug.cgi?id=85657

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 85657
*DEPEND problem after every few emerge syncs
Last modified: 2005-06-05 07:51:53 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 85657 
      - *DEPEND problem after every few emerge syncs


Summary:
*DEPEND problem after every few emerge syncs
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        All
      







Importance:
      
High
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-03-17 09:07 UTC by Jonathan Smith (RETIRED)





      Modified:
    
2005-06-05 07:51 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



langthang









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge -d sync

              (sync.log,92.41 KB,
                text/plain)

            
2005-04-17 08:52 UTC,

            Jonathan Smith (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jonathan Smith (RETIRED)






          2005-03-17 09:07:13 UTC
        

smithj ~ # emerge -pvuD --newuse world

These are the packages that I would merge, in order:

Calculating world dependencies \
emerge: there are no ebuilds to satisfy ">=x11-libs/motif-config-0.5".


!!! Problem with ebuild x11-misc/xscreensaver-4.20
!!! Possibly a DEPEND/*DEPEND problem.

!!! Depgraph creation failed.


Portage 2.0.51.19 (default-linux/x86/2004.3, gcc-3.4.3-20050110, glibc-2.3.4.20050125-r1, 2.6.11.3 i686)
=================================================================
System uname: 2.6.11.3 i686 Intel(R) Celeron(R) CPU 2.00GHz
Gentoo Base System version 1.6.10
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Feb 21 2005, 07:49:53)]
ccache version 2.4 [enabled]
dev-lang/python:     2.3.5
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.9.5, 1.5, 1.8.5-r3, 1.6.3, 1.7.9-r1, 1.4_p6
sys-devel/binutils:  2.15.92.0.2-r6
sys-devel/libtool:   1.5.14
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CFLAGS="-O2 -march=pentium4 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=pentium4 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.us.gentoo.org/gentoo-portage"
USE="x86 X aalib acpi aim alsa apache2 apm arts avi berkdb bitmap-fonts cdr crypt cups curl dba doc dvd emboss encode esd fam flac fluxbox font-server foomaticdb fortran ftp gd gd-external gdbm gif gnome gpm gstreamer gtk gtk2 icq idea imagemagick imap imlib java jikes jpeg junit libg++ libwww mad mbox mikmod mmx mmx2 motif mozilla mp3 mpeg ncurses nls nptl nptlonly oggvorbis opengl pam pcmcia pdflib perl php png posix python qt quicktime readline ruby samba sdl spell sse sse2 ssl svga tcltk tcpd tetex tiff truetype truetype-fonts type1-fonts udev usb vim xml2 xmms xprint xv xvid zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS



my last rsync was literally 3 minutes ago. i see no bugs, so i am assuming this hasn't been fixed yet




Comment 1


Heinrich Wendel (RETIRED)






          2005-03-17 10:53:29 UTC
        

strange, remove your PORTDIR_OVERLAY, do an emerge sync and try again, all files should be there




Comment 2


Jonathan Smith (RETIRED)






          2005-03-17 11:35:14 UTC
        

doing emerge sync again fixed it. NO IDEA what the problem was. sorry for the trouble




Comment 3


Jonathan Smith (RETIRED)






          2005-03-18 09:32:42 UTC
        

gah! its back. i did another emerge sync and now i get, again:

smithj ~ # emerge -pvuD --newuse world

These are the packages that I would merge, in order:

Calculating world dependencies |
emerge: there are no ebuilds to satisfy ">=x11-libs/motif-config-0.5".


!!! Problem with ebuild x11-misc/xscreensaver-4.20
!!! Possibly a DEPEND/*DEPEND problem.

!!! Depgraph creation failed.


maybe i am doing something wrong? i just type emerge sync...




Comment 4


Jonathan Smith (RETIRED)






          2005-03-18 10:40:51 UTC
        

ok, so yet another emerge sync fixed it again. it seems to be only doing this on odd-numbered syncs. WHAT IN THE WORLD?!? sorry, i can't really give any more information, because this totally unexplainable to me...




Comment 5


Heinrich Wendel (RETIRED)






          2005-03-22 08:18:42 UTC
        

still a problem sometimes?




Comment 6


Jonathan Smith (RETIRED)






          2005-03-24 09:02:28 UTC
        

I HAVE NO IDEA! portage is just going crazy on me. maybe i accidentally messed something up, but i don't know what or how to fix it.


the title of this bug has been changed from "xscreensaver-4.20 ebuild is broken, possible problem with motif-config" to ""DEPEND/*DEPEND problem" after every few emerge syncs". maybe it should be reassigned? sorry for having to reopen again...

---

!!! ERROR: sys-apps/debianutils-2.13.1-r1 failed.
!!! Function , Line 1702, Exitcode 1
!!! error sourcing ebuild
!!! If you need support, post the topmost build error, NOT this status message.


aux_get(): (0) Error in sys-apps/debianutils-2.13.1-r1 ebuild. (1)
               Check for syntax error or corruption in the ebuild. (--debug)
                                                                                                                   /
!!! All ebuilds that could satisfy ">=www-client/mozilla-1.7.3" have been masked.
!!! One of the following masked packages is required to complete your request:
- www-client/mozilla-1.7.5 (masked by: missing keyword)
- www-client/mozilla-1.7.5-r1 (masked by: missing keyword)
- www-client/mozilla-1.7.6-r1 (masked by: missing keyword)

For more information, see MASKED PACKAGES section in the emerge man page or 
section 2.2 "Software Availability" in the Gentoo Handbook.
!!!    (dependency required by "www-client/epiphany-1.6.0-r2" [ebuild])


!!! Problem with ebuild gnome-base/gnome-2.10_pre0
!!! Possibly a DEPEND/*DEPEND problem.

!!! Depgraph creation failed.





Comment 7


Heinrich Wendel (RETIRED)






          2005-03-24 09:14:47 UTC
        

try to comment your PORTDIR_OVERLAY in make.conf




Comment 8


Jonathan Smith (RETIRED)






          2005-03-24 10:00:04 UTC
        

oh, and i just tried again, same thing. once again, however, emerge sync temporarily cured the problem...

it will, however, be back




Comment 9


Jonathan Smith (RETIRED)






          2005-03-24 10:01:50 UTC
        

sorry, that post was slightly incoherent. what i meant to say:

i tried (once again) to comment out the portage overlay, and it didn't work. however, when i sync'd again, all is temporarily well




Comment 10


Jonathan Smith (RETIRED)






          2005-03-26 11:56:07 UTC
        

the bug still appears on a fairly random basis, after an emerge sync...

i reemerged portage, no effect. commented out my overlay, no effect

it seems to pick on a different package each time (this time it was glibc), though it SEEMS to always be packages i have installed (which makes sense, as the command is "emerge -avuDN world")




Comment 11


Heinrich Wendel (RETIRED)






          2005-04-13 11:06:56 UTC
        

still a problem=




Comment 12


Jonathan Smith (RETIRED)






          2005-04-13 12:06:56 UTC
        

yes, still a problem

i can't figure out how to reproduce, though, as i can't even identify a pattern




Comment 13


Jason Stubbs (RETIRED)






          2005-04-14 04:15:31 UTC
        

fsck -f, emerge -d sync





Comment 14


Jonathan Smith (RETIRED)






          2005-04-14 06:25:48 UTC
        

updated emerge --info:

Portage 2.0.51.19 (default-linux/x86, gcc-3.4.3-20050110, glibc-2.3.4.20050125-r1, 2.6.12-rc2 i686)
=================================================================
System uname: 2.6.12-rc2 i686 Intel(R) Celeron(R) CPU 2.00GHz
Gentoo Base System version 1.6.10
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Apr 13 2005, 16:12:59)]
ccache version 2.4 [enabled]
dev-lang/python:     2.3.5
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.5, 1.6.3, 1.7.9-r1, 1.4_p6, 1.9.5, 1.8.5-r3
sys-devel/binutils:  2.15.92.0.2-r8
sys-devel/libtool:   1.5.14
virtual/os-headers:  2.6.8.1-r4
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CFLAGS="-Os -march=pentium4 -pipe -fno-omit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/texmf/web2c /etc/env.d"
CXXFLAGS="-Os -march=pentium4 -pipe -fno-omit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.us.gentoo.org/gentoo-portage"
USE="x86 X aalib acpi aim alsa apache2 apm arts avi berkdb bitmap-fonts cdr crypt cups curl dba debug dvd emboss encode esd fam flac fluxbox font-server foomaticdb fortran ftp gd gd-external gdbm gif gnome gpm gstreamer gtk gtk2 icq idea imagemagick imap imlib java jikes jpeg junit libg++ libwww mad mbox mikmod mmx mmx2 motif mozilla mp3 mpeg ncurses nls nptl nptlonly ogg oggvorbis opengl pam pcmcia pdflib perl php pic png posix python qt quicktime readline ruby samba sdl snmp spell sse sse2 ssl svga tcltk tcpd tetex tiff truetype truetype-fonts type1-fonts udev usb vim vorbis xml2 xmms xprint xv xvid zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS


---

fdisk -f:

smithj ~ # fsck -f /dev/hdc1
fsck 1.37 (21-Mar-2005)
e2fsck 1.37 (21-Mar-2005)
Pass 1: Checking inodes, blocks, and sizes
Pass 2: Checking directory structure
Pass 3: Checking directory connectivity
Pass 4: Checking reference counts
Pass 5: Checking group summary information
/dev/hdc1: 24/10040 files (8.3% non-contiguous), 4296/40128 blocks
smithj ~ # fsck -f /dev/hdc3
fsck 1.37 (21-Mar-2005)


i am syncing with debug now, and will attach when completed (it takes me a long time to rebuild cache due to crappy hardware). i will also do `emerge -dpvuDN world` the next time the issue occurs




Comment 15


Jonathan Smith (RETIRED)






          2005-04-14 12:54:21 UTC
        

blar! my school's network isn't allowing syncs at the moment (it is majorly b0rked for some odd reason. windows servers anyone?!?)

will update when situation returns to normal




Comment 16


Jonathan Smith (RETIRED)






          2005-04-17 08:52:43 UTC
        

Created attachment 56522 [details]
emerge -d sync




Comment 17


Jason Stubbs (RETIRED)






          2005-04-17 16:20:44 UTC
        

Perhaps I should have been more specific. emerge -d sync will just ensure that your portage tree really is correct by using stricter checking of files. The question is can you reproduce the original bug now?




Comment 18


Jonathan Smith (RETIRED)






          2005-05-06 19:12:12 UTC
        

emerge -d sync _always_ fails with an IO error. it goes through 3 attempts, and then gives up.

i am still having to sync normally, and the problem is still occuring




Comment 19


Jason Stubbs (RETIRED)






          2005-05-06 19:28:16 UTC
        

Have you tried deleting the entire portage tree at all? emerge -d sync will just add an option to check md5s to rsync. Deleting the portage tree would be sufficient as well. However, seeing things like the following would generally mean that you are getting fs corruption or your disks are dying. Do you see anything in dmesg to that effect?


!!! ERROR: sys-apps/debianutils-2.13.1-r1 failed.
!!! Function , Line 1702, Exitcode 1
!!! error sourcing ebuild
!!! If you need support, post the topmost build error, NOT this status message.


aux_get(): (0) Error in sys-apps/debianutils-2.13.1-r1 ebuild. (1)
               Check for syntax error or corruption in the ebuild. (--debug)
                                                                                                                   /





Comment 20


Jonathan Smith (RETIRED)






          2005-05-06 20:46:21 UTC
        

i've _never_ seen an emerge fail due to a bad md5 on the ebuild.

i scanned dmesg, and didn't notice anything unusual, but i don't really know what to grep for when dealing with harddrive corruption. i use xfs if it matters.

i am deleting the portage tree and resyncing now. i will update when/if the problem reoccurs




Comment 21


Jason Stubbs (RETIRED)






          2005-05-06 20:57:49 UTC
        

Not the md5 from the digest. Normally, rsync just compares mtimes and sizes of the local files and remote files. Adding --debug will make rsync also compare the md5s of the local and remote files as well.

Are you overclocked? Agressive timings in BIOS? Experience random segfaults in other applications? Unusual network card that has a buggy driver perhaps? These errors indicate corruption somewhere.




Comment 22


Jonathan Smith (RETIRED)






          2005-05-07 07:48:18 UTC
        

Are you overclocked? no

Agressive timings in BIOS? i don't even know what this means, so no

Experience random segfaults in other applications? none which aren't due to ~x86 keywords and which other users experience

Unusual network card that has a buggy driver perhaps? prism 2.5 pcmcia using kernel drivers. its never borked on my before, but is this "unusual"?




Comment 23


Jonathan Smith (RETIRED)






          2005-05-09 18:14:31 UTC
        

possibly related:

now rsync fails 3/4 times by freezing on x11-wm/fluxbox/files (_not_ using emerge -d sync)

when i wipe the portage tree, before hand, rsync sucessfully finishes.

very odd...




Comment 24


Denis Ranger





          2005-05-15 07:47:50 UTC
        

Maybe this will help. I emerged a bunch of stuff yesterday. This morning, I did the old 'emerge sync && emerge --newuse -uD world' and got the DEPEND/*DEPEND problem.

'revdep-rebuild' found and fixed a problem in sys-fs/cryptsetup. Same error still, but then I noticed a 'no ebuild satisfies virtual/utempter', which was odd since utempter was there and up-to-date. An 'emerge --oneshot utempter' fixed it: '-uD world' worked from there on...




Comment 25


Tuan Van (RETIRED)






          2005-05-15 18:40:41 UTC
        

@ comment #24
if you are on hardened profile, your problem isn't related to this bugs. I filed bug #92750 wrt virtual/utempter.




Comment 26


Jonathan Smith (RETIRED)






          2005-06-05 07:51:53 UTC
        

it automagically stopped happening, so i am going to close. if anyone else has
the problem, reopen or email me to do so if you can't









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

