Title: 142286 – gaim-2.0.0_beta3-r1 segfaults when mouse leaves chat window
URL: https://bugs.gentoo.org/show_bug.cgi?id=142286

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 142286
gaim-2.0.0_beta3-r1 segfaults when mouse leaves chat window
Last modified: 2006-09-10 15:01:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 142286 
      - gaim-2.0.0_beta3-r1 segfaults when mouse leaves chat window


Summary:
gaim-2.0.0_beta3-r1 segfaults when mouse leaves chat window
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo Net-im project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-07-31 08:10 UTC by Jamie Anderson





      Modified:
    
2006-09-10 15:01 UTC
      (History)
    




          CC List:
        

6 
          users
          
            (show)
          



asheldon
chris
free.perception
lostlogic
ullum
world.root









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




backtrace and debug output from gaim

              (gaimfault,51.58 KB,
                text/plain)

            
2006-07-31 15:48 UTC,

            Manu Eder




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jamie Anderson





          2006-07-31 08:10:51 UTC
        

gdb backtrace:

(gdb) backtrace
#0  0xffffe410 in __kernel_vsyscall ()
#1  0xb74fd661 in raise () from /lib/libc.so.6
#2  0xb74fecb9 in abort () from /lib/libc.so.6
#3  0x0810e1eb in main ()
(gdb) quit

emerge --info:

Portage 2.1.1_pre3-r4 (default-linux/x86/2006.0, gcc-4.1.1/vanilla, glibc-2.4-r3, 2.6.17-gentoo-r4 i686)
=================================================================
System uname: 2.6.17-gentoo-r4 i686 Genuine Intel(R) CPU           T2500  @ 2.00GHz
Gentoo Base System version 1.12.1
ccache version 2.4 [enabled]
app-admin/eselect-compiler: 2.0.0_rc2-r1
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r2
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.17
sys-devel/gcc-config: 2.0.0_rc1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r5
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=pentium-m -mtune=pentium-m -msse3 -mfpmath=sse -fomit-frame-pointer -fprefetch-loop-arrays -fforce-addr -ftracer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf"
CXXFLAGS="-O3 -march=pentium-m -mtune=pentium-m -msse3 -mfpmath=sse -fomit-frame-pointer -fprefetch-loop-arrays -fforce-addr -ftracer -pipe -fvisibility-inlines-hidden"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict userpriv usersandbox"
GENTOO_MIRRORS="http://mirror.phy.olemiss.edu/mirror/gentoo http://mirror.datapipe.net/gentoo http://gentoo.chem.wisc.edu/gentoo/"
LINGUAS="en_US"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="x86 X alsa apache2 apm avi berkdb bitmap-fonts cli crypt cups dbus dlloader dri eds emboss encode firefox foomaticdb fortran gdbm gif gnome gpm gstreamer gtk gtk2 hal imlib ipv6 isdnlog jpeg libg++ libwww mad mikmod mmx motif mp3 mpeg ncurses nls nptl nptlonly ogg opengl pam pcmcia pcre pdflib perl png pppd python quicktime readline reflection samba sdl session spell spl sse sse2 sse3 ssl tcpd truetype truetype-fonts type1-fonts udev vorbis xinerama xml xmms xorg xscreensaver xv zlib elibc_glibc input_devices_keyboard input_devices_mouse kernel_linux linguas_en_US userland_GNU video_cards_i810"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS

I set the following additional flags in /etc/portage/package.use for Gaim:
net-im/gaim                             bonjour gnutls msn startup-notification

It might also be worth noting that I have USE="glitz" set for cairo.




Comment 1


Manu Eder





          2006-07-31 15:48:37 UTC
        

Created attachment 93156 [details]
backtrace and debug output from gaim

I'm having the same problem. I recently recompiled all of my system with gcc-4.1.1 and this is when this started happening - I had the same behaviour with gaim 1.5.0 and this is why I tried out the beta-release.
Recompiling just gaim with a lower version of gcc did not remedy the problem, so I am not sure, whether this is actually a bug in gaim - it might be in the dependencies. Or gaim might be incompatible with a new version of one of it's dependencies.

The backtrace & debug output is in the attachment. I noticed it says there is no symbol table info available. I did compile gaim with USE="debug" and removed all C[XX]FLAGS except -march=pentium-m from my make.conf before emerging, so I guess this has got to be in one of the libraries?
Please tell me if you need me to recompile any of them with special settings, or if you need any other kind of info.


This is the output from emerge --info:
Portage 2.1-r1 (default-linux/x86/2006.0, gcc-4.1.1/vanilla, glibc-2.4-r3, 2.6.18-rc1-mm2 i686)
=================================================================
System uname: 2.6.18-rc1-mm2 i686 Intel(R) Pentium(R) M processor 1.73GHz
Gentoo Base System version 1.6.15
ccache version 2.3 [enabled]
app-admin/eselect-compiler: 2.0.0_rc2-r1
dev-lang/python:     2.3.5, 2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.17
sys-devel/gcc-config: 2.0.0_rc1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium-m"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/"
CONFIG_PROTECT_MASK="/etc/env.d /etc/eselect/compiler /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-march=pentium-m"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://gentoo.inode.at/ ftp://gentoo.inode.at/source/ http://gd.tuwien.ac.at/opsys/linux/gentoo/ ftp://gd.tuwien.ac.at/opsys/linux/gentoo/"
LINGUAS="en de fi es ru en_GB en_US de_DE de_AT es_ES fi_FI ru_RU"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage /usr/portage/local/layman/portage-xgl"
SYNC="rsync://rsync.de.gentoo.org/gentoo-portage"
USE="x86 X a52 aac acpi aim alsa apache2 avi bash-completion bcmath berkdb bitmap-fonts blas bluetooth bzip2 cdparanoia cdr cjk cli crypt cups dbx dhcp directfb dlloader doc dri dvd dvdr dvdread eds emacs encode examples exif fbcon ffmpg firefox flac flash foomaticdb ftp gdbm gif ginac gmp gnutls gphoto2 gpm graphviz gstreamer gtk gtk2 icc icq ieee1394 imap imlib ipv6 irc isdnlog ithreads jabber java javascript jpeg jpeg2k libg++ libwww mad mikmod mime ming mmx mng motif mozilla mp3 mpeg msn mule mysql mysqli ncurses nls nptl nptlonly ocaml offensive ogg opengl oscar pam pcmcia pcre pdf pdflib perl php png posix pppd python qt qt3 qt4 quicktime readline reflection samba scanner sdl session simplexml socks5 speex spell spl sql sse sse2 ssl svg tcpd theora tiff truetype truetype-fonts type1-fonts udev unicode usb vcd vorbis wifi win32codecs wmf x264 xemacs xine xinerama xml xmms xorg xpm xscreensaver xsl xv xvid zlib elibc_glibc input_devices_keyboard input_devices_mouse input_devices_synaptics kernel_linux linguas_en linguas_de linguas_fi linguas_es linguas_ru linguas_en_GB linguas_en_US linguas_de_DE linguas_de_AT linguas_es_ES linguas_fi_FI linguas_ru_RU userland_GNU video_cards_fbdev video_cards_fglrx video_cards_vesa video_cards_radeon"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 2


Manu Eder





          2006-08-05 06:09:26 UTC
        

Someone seems to have posted something that looks like the same bug to me on gaim's sf page:

http://sourceforge.net/tracker/index.php?func=detail&aid=1508790&group_id=235&atid=100235

There is a backtrace that looks more meaningful than mine there as well.




Comment 3


Brandon Low (RETIRED)






          2006-08-06 08:00:01 UTC
        

I am also experiencing a similar problem, I've tried both gaim-2.0.0_beta3 and gaim-1.5.0 and also experimented with different versions of gtk+ (including the masked 2.10.1 version, 2.8.20-r1 and 2.8.19) to no avail.  It doesn't seem to be actually when the mouse leaves the conversation window, but whenever the mouse hovers over text in the conversation window, or in an away message window.

The fault appears in gtk_text_insert for me.




Comment 4


Manu Eder





          2006-08-06 17:19:46 UTC
        

I can confirm the hovering thing.
It doesn't always seem to happen immediately though, especially if I move the mouse slowly.
Moving the cursor across the line, that seperates the text of an old session from the rest (this text is inserted by a history-plugin I think) always seems to crash it immediately though.
I have also tried the SVN version to no avail - same problem.




Comment 5


Brandon Low (RETIRED)






          2006-08-10 04:56:15 UTC
        

Another (almost definitely related) bug on sourceforge is: http://sourceforge.net/tracker/index.php?func=detail&aid=1535181&group_id=235&atid=100235

This looks to me like a gcc-4.1.1 issue, either in gtk+ or gaim.

Is everyone seeing this problem indeed using gcc-4.1.1 and did it indeed start close to the time of the upgrade to 4.1.1?

Can anyone tell what library or libraries were upgraded on their system between the gcc-4.1.1 installation and the start of this gaim bug?

Thanks.




Comment 6


Jamie Anderson





          2006-08-11 17:53:40 UTC
        

In my case, it was on a brand-new install built using the stage 1/3 method, so everything was built and linked with gcc-4.1.1 and binutils-2.17.1.  I have noticed some problems with other software (namely Evolution), but nothing as severe or consistant as what Gaim is doing.  However, I guess we should all hope it is not a Gaim issue, since I have read the other bug reports and the Gaim devs are quite clear that they have no intention of troubleshooting the problem, let alone fixing it.

(In reply to comment #5)
> Another (almost definitely related) bug on sourceforge is:
> http://sourceforge.net/tracker/index.php?func=detail&aid=1535181&group_id=235&atid=100235
> 
> This looks to me like a gcc-4.1.1 issue, either in gtk+ or gaim.
> 
> Is everyone seeing this problem indeed using gcc-4.1.1 and did it indeed start
> close to the time of the upgrade to 4.1.1?
> 
> Can anyone tell what library or libraries were upgraded on their system between
> the gcc-4.1.1 installation and the start of this gaim bug?
> 
> Thanks.
> 






Comment 7


Brandon Low (RETIRED)






          2006-08-12 08:26:37 UTC
        

The Gaim devs will troubleshoot it if it can be proven to be a bug in gaim as opposed to the system.  Due to Gentoo's nature as a build-it-yourself distro, they will not even approach a problem until a Gentoo developer can demonstrate that the problem exists in Gaim itself.




Comment 8


Michael Mikhulya





          2006-08-18 04:58:00 UTC
        

Very similar issue happens for me.

I found that gaim craches only with particular gnome themes, e.g. for "Myst" I have following error in console just before crash happens:
<QUOTE>** CRITICAL **: mist_draw_border: assertion `shadow_type != GTK_SHADOW_NONE' failed</QUOTE>

Crash doesn't happen with "ClearLooks" theme at all.
Also "ClearLooks" theme make inkscape don't crush in "About" dialog.
But inkscape still crushes in other places with error like
<QUOTE>Gtk-CRITICAL **: gtk_style_detach: assertion `style->attach_count > 0' failed</QUOTE>

May be this info will help other to avoid crashes and motivate somebody to look into gnome-theme code.
PS. I have gnome-themes-2.15.91.1 installed on my box.




Comment 9


Brandon Low (RETIRED)






          2006-08-18 09:03:08 UTC
        

I use openbox, not gnome, so no help there, interesting the variety of situations which cause this crash for different people.




Comment 10


Brandon Low (RETIRED)






          2006-08-27 20:41:49 UTC
        

recent either gtk+ or xorg upgrade has solved this for me.  reopen this bug if it's still occuring for others.




Comment 11


Mihai Moldovan





          2006-09-07 14:17:25 UTC
        

First of all -- do NOT USE -O3 OR -march=pentium-m OR -fomit-frame-pointer WHEN EMERGING gtk+ OR gaim. It seems like both of them hate it. Re-emering with really safe CFLAGS and CXXFLAGS (-O2 -march=i686) did the trick.

Secondly: this has to be fixed anyways since these are my standard CFLAGS, too :P




Comment 12


Mihai Moldovan





          2006-09-07 21:33:41 UTC
        

(In reply to comment #11)
> First of all -- do NOT USE -O3 OR -march=pentium-m OR -fomit-frame-pointer WHEN
> EMERGING gtk+ OR gaim. It seems like both of them hate it. Re-emering with
> really safe CFLAGS and CXXFLAGS (-O2 -march=i686) did the trick.
> 
> Secondly: this has to be fixed anyways since these are my standard CFLAGS, too
> :P
> 

Ok, I tried experimenting a bit on this and found a more or less convinient solution: set the CFLAGS and CXXFLAGS to "-O2 -march=pentium-m -pipe", then re-emerge gtk+ (stable version) and gaim (Beta 3.1) w/ "emerge gtk+ gaim" and the problems are not orcurring anymore.

Though, it's weird that GCC 4.1.1 has such problems with -O3 -- it worked very fine with GCC 3.4.6. Next time try to remove the ricer flags before reporting any bug and re-emerge all dependencies and the programm itself.

Thanks.




Comment 13


Joël





          2006-09-10 15:01:58 UTC
        

I suspect this is a duplicate of bug #133469.

Please try workaround described there:
http://bugs.gentoo.org/show_bug.cgi?id=133469#c43

Basically, appending "-fno-inline-functions" to CFLAGS and re-emerging gtk+ should solve the problem (for me it does) :-)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

