Title: 566872 – app-misc/ca-certificates unable to specify PYTHON_TARGETS
URL: https://bugs.gentoo.org/show_bug.cgi?id=566872

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 566872
app-misc/ca-certificates unable to specify PYTHON_TARGETS
Last modified: 2015-12-07 15:44:24 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 566872 
      - app-misc/ca-certificates unable to specify PYTHON_TARGETS


Summary:
app-misc/ca-certificates unable to specify PYTHON_TARGETS
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2015-11-26 02:31 UTC by Anton Bolshakov





      Modified:
    
2015-12-07 15:44 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



kensington









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Anton Bolshakov





          2015-11-26 02:31:33 UTC
        

I'm trying to keep my server python2 free, see bug #460526 for details.

Somehow, the current python implementation in the ebuild does not allow to specify python target and "+cacert libressl" are the only flags visible.

Could you please fix it?

Thank you.




Comment 1


Brian Evans (RETIRED)






          2015-11-30 18:03:21 UTC
        

Please attach a build.log demonstrating a failed build to this bug and show `emerge --info` in a comment




Comment 2


Anton Bolshakov





          2015-12-01 00:25:02 UTC
        

ca-certs ebuilds are not broken and compiles just fine.

The best to demonstrate the problem would be the eix output:

bash$ eix ca-certificates
[I] app-misc/ca-certificates
     Available versions:  20140927.3.17.2 ~20141019.3.17.4 ~20141019.3.19 ~20141019.3.19-r1 ~20150426.3.20 ~20150426.3.20-r1 {+cacert libressl}

bash$ eix portage

 sys-apps/portage
     Available versions:  2.2.8-r2 2.2.20.1 ~2.2.23 (~)2.2.24 ~2.2.25 ~2.2.26 **9999 {build doc epydoc +ipc pypy2_0 python2 python3 selinux xattr LINGUAS="ru" PYTHON_TARGETS="pypy pypy2_0 python2_6 python2_7 python3_2 python3_3 python3_4 python3_5"}


As you can see, PYTHON_TARGETS flags are not available in the ca-certificates
However, if you check ca-certs ebuild it supports both 2 and 3 python:

EAPI="4"
PYTHON_COMPAT=( python{2_7,3_3,3_4} )




Comment 3


Michael Palimaka (kensington)






          2015-12-06 18:31:07 UTC
        

Which version of ca-certificates is causing the issue? Only later versions have python 3 support.




Comment 4


Anton Bolshakov





          2015-12-07 00:18:45 UTC
        

(In reply to Michael Palimaka (kensington) from comment #3)
> Which version of ca-certificates is causing the issue? Only later versions
> have python 3 support.

It's not about a python version. I tried both the current stable version 20140927.3.17.2 and the latest available ~20150426.3.20-r1.

Could it be EAPI="4" issue? I haven't tried fixing it myself.




Comment 5


Michael Palimaka (kensington)






          2015-12-07 10:52:02 UTC
        

(In reply to Anton Bolshakov from comment #4)
> (In reply to Michael Palimaka (kensington) from comment #3)
> > Which version of ca-certificates is causing the issue? Only later versions
> > have python 3 support.
> 
> It's not about a python version. I tried both the current stable version
> 20140927.3.17.2 and the latest available ~20150426.3.20-r1.
> 
> Could it be EAPI="4" issue? I haven't tried fixing it myself.

What is the issue then? ca-certificates uses python-any-r1 which doesn't expose PYTHON_TARGETS because it's not necessary.




Comment 6


Anton Bolshakov





          2015-12-07 14:20:28 UTC
        

(In reply to Michael Palimaka (kensington) from comment #5)
> What is the issue then? ca-certificates uses python-any-r1 which doesn't
> expose PYTHON_TARGETS because it's not necessary.

Right. So to disable python2 dep, I'm using set USE="-python_targets_python2_7" as advised in bug #460526. ca-certificates seems the only package which prevents me from doing so.

Is any better way?




Comment 7


Michael Palimaka (kensington)






          2015-12-07 14:27:02 UTC
        

From the metadata:

app-misc/ca-certificates-20140927.3.17.2:DEPEND=|| ( >=dev-lang/python-2.7.5-r2:2.7 )
app-misc/ca-certificates-20141019.3.17.4:DEPEND=|| ( >=dev-lang/python-2.7.5-r2:2.7 )
app-misc/ca-certificates-20141019.3.19:DEPEND=|| ( >=dev-lang/python-2.7.5-r2:2.7 )
app-misc/ca-certificates-20141019.3.19-r1:DEPEND=|| ( >=dev-lang/python-2.7.5-r2:2.7 )
app-misc/ca-certificates-20150426.3.20:DEPEND=|| ( >=dev-lang/python-2.7.5-r2:2.7 dev-lang/python:3.4 >=dev-lang/python-3.3.2-r2:3.3 )
app-misc/ca-certificates-20150426.3.20-r1:DEPEND=|| ( >=dev-lang/python-2.7.5-r2:2.7 dev-lang/python:3.4 >=dev-lang/python-3.3.2-r2:3.3 )

So the later versions will be satisfied by having just python3.




Comment 8


Anton Bolshakov





          2015-12-07 15:44:24 UTC
        

Hm..... I tried to run emerge -DNupv world again today. Surprisingly, python2 is not getting pulled anymore. Since I didn't change anything on that server, I guess something changed in python* eclasses since 26 of Nov.

I'm closing this issue as the problem has disappeared.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

