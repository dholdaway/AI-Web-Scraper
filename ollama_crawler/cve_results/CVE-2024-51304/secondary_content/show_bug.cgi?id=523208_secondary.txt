Title: 523208 – x11-drivers/xf86-video-intel depends on || ( x11-libs/glamor x11-base/xorg-server[glamor] )
URL: https://bugs.gentoo.org/show_bug.cgi?id=523208

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 523208
x11-drivers/xf86-video-intel depends on || ( x11-libs/glamor x11-base/xorg-server[glamor] )
Last modified: 2014-09-22 02:58:31 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 523208 
      - x11-drivers/xf86-video-intel depends on || ( x11-libs/glamor x11-base/xorg-server[glamor] )


Summary:
x11-drivers/xf86-video-intel depends on || ( x11-libs/glamor x11-base/xorg-se...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-09-19 09:38 UTC by Jeff Zacher





      Modified:
    
2014-09-22 02:58 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jeff Zacher





          2014-09-19 09:38:13 UTC
        

When doing an emerge -avuND world --with-bdeps=y --reinstall=changed-use, emerge -avuND world, or  emerge -av --oneshot =x11-base/xorg-server-1.16.0.901 glamor blocks the upgrade even after an emerge --unmerge glamor. Glamor is only installed on system from USE flags.....

Reproducible: Always




Block and graph info:

[blocks B      ] x11-libs/glamor ("x11-libs/glamor" is blocking x11-base/xorg-server-1.16.0.901)

Total: 47 packages (6 upgrades, 1 new, 40 reinstalls), Size of downloads: 142,353 kB
Conflict: 1 block (1 unsatisfied)

!!! Multiple package instances within a single package slot have been pulled
!!! into the dependency graph, resulting in a slot conflict:

x11-base/xorg-server:0

  (x11-base/xorg-server-1.16.0.901::gentoo, ebuild scheduled for merge) pulled in by
    (no parents that aren't satisfied by other packages in this slot)

  (x11-base/xorg-server-1.16.0::gentoo, ebuild scheduled for merge) pulled in by
    x11-base/xorg-server:0/1.16.0= required by (x11-drivers/xf86-video-intel-2.21.15::gentoo, installed)
    x11-base/xorg-server:0/1.16.0= required by (x11-drivers/xf86-input-synaptics-1.7.4::gentoo, installed)
    x11-base/xorg-server:0/1.16.0= required by (x11-drivers/xf86-input-evdev-2.8.2::gentoo, installed)

...

 * Error: The above package list contains packages which cannot be
 * installed at the same time on the same system.

  (x11-libs/glamor-0.6.0::gentoo, ebuild scheduled for merge) pulled in by
    x11-libs/glamor required by (x11-drivers/xf86-video-intel-2.21.15::gentoo, installed)


emerge --info
Portage 2.2.8-r1 (default/linux/amd64/13.0/desktop/kde, gcc-4.7.3, glibc-2.19-r1, 3.14.14-gentoo x86_64)
=================================================================
System uname: Linux-3.14.14-gentoo-x86_64-Intel-R-_Pentium-R-_Dual_CPU_T3200_@_2.00GHz-with-gentoo-2.2
KiB Mem:     3983364 total,   1140692 free
KiB Swap:    6062076 total,   6015652 free
Timestamp of tree: Fri, 19 Sep 2014 04:00:01 +0000
ld GNU ld (GNU Binutils) 2.23.2
app-shells/bash:          4.2_p45
dev-java/java-config:     2.2.0
dev-lang/python:          2.7.7, 3.3.5-r1
dev-util/cmake:           2.8.12.2-r1
dev-util/pkgconfig:       0.28-r1
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.12.4
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.69
sys-devel/automake:       1.10.3, 1.11.6, 1.12.6, 1.13.4
sys-devel/binutils:       2.23.2
sys-devel/gcc:            4.7.3-r1
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4.2-r1
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.13 (virtual/os-headers)
sys-libs/glibc:           2.19-r1
Repositories: gentoo sunrise science niftyrepo proaudio kde x-portage
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/themes/oxygen-gtk/gtk-2.0 /usr/share/themes/oxygen-gtk/gtk-3.0 /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=k8 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/sunrise /var/lib/layman/science /var/lib/layman/niftyrepo /var/lib/layman/pro-audio /var/lib/layman/kde /usr/local/portage"
USE="X a52 aac acl acpi alsa amd64 berkdb bindist bluetooth branding bzip2 cairo cdda cdr cli consolekit cracklib crypt cups cxx dbus declarative dri dts dvd dvdr emboss encode exif fam firefox flac fortran gdbm gif glamor gpm iconv ipv6 jack jpeg kde kipi ladspa lcms ldap libnotify lirc lua mad midi mmx mng modules mp3 mp4 mpeg multilib ncurses nls nptl ogg opengl openmp oss pam pango pcre pdf phonon plasma png policykit ppds pulseaudio qt3support qt4 readline sdl semantic-desktop session spell sse sse2 sse3 ssl ssse3 startup-notification svg tcpd tiff truetype udev udisks unicode upower usb vaapi vorbis wxwidgets x264 xcb xcomposite xine xinerama xml xscreensaver xv xvid zlib" ABI_X86="64" ALSA_CARDS="hda-intel" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="evdev synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="nlpsolver presenter-console presenter-minimizer report-builder scripting-beanshell scripting-javascript wiki-publisher" LIRC_DEVICES="devinput" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-5" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_3" RUBY_TARGETS="ruby19 ruby20" USERLAND="GNU" VIDEO_CARDS="intel i965" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
USE_PYTHON="2.7 3.3"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, SYNC




Comment 1


Jeroen Roovers (RETIRED)






          2014-09-19 09:45:54 UTC
        

You need to enable USE=glamor globally, and then x11-drivers/xf86-video-intel should resolve to x11-libs/glamor /OR/ x11-base/xorg-server[glamor]. If not immediately, then uninstall x11-libs/glamor first.




Comment 2


Jeff Zacher





          2014-09-19 11:06:02 UTC
        

Still no dice. Added us flag globally (probably have a better X/driver stack that way anyhow)....

Portage 2.2.8-r1 (default/linux/amd64/13.0/desktop/kde, gcc-4.7.3, glibc-2.19-r1, 3.14.14-gentoo x86_64)
=================================================================
System uname: Linux-3.14.14-gentoo-x86_64-Intel-R-_Pentium-R-_Dual_CPU_T3200_@_2.00GHz-with-gentoo-2.2
KiB Mem:     3983364 total,    692148 free
KiB Swap:    6062076 total,   6007988 free
Timestamp of tree: Fri, 19 Sep 2014 04:00:01 +0000
ld GNU ld (GNU Binutils) 2.23.2
app-shells/bash:          4.2_p45
dev-java/java-config:     2.2.0
dev-lang/python:          2.7.7, 3.3.5-r1
dev-util/cmake:           2.8.12.2-r1
dev-util/pkgconfig:       0.28-r1
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.12.4
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.69
sys-devel/automake:       1.10.3, 1.11.6, 1.12.6, 1.13.4
sys-devel/binutils:       2.23.2
sys-devel/gcc:            4.7.3-r1
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4.2-r1
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.13 (virtual/os-headers)
sys-libs/glibc:           2.19-r1
Repositories: gentoo sunrise science niftyrepo proaudio kde x-portage
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/themes/oxygen-gtk/gtk-2.0 /usr/share/themes/oxygen-gtk/gtk-3.0 /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=k8 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/sunrise /var/lib/layman/science /var/lib/layman/niftyrepo /var/lib/layman/pro-audio /var/lib/layman/kde /usr/local/portage"
USE="X a52 aac acl acpi alsa amd64 berkdb bindist bluetooth branding bzip2 cairo cdda cdr cli consolekit cracklib crypt cups cxx dbus declarative dri dts dvd dvdr emboss encode exif fam firefox flac fortran gdbm gif glamor gpm iconv ipv6 jack jpeg kde kipi ladspa lcms ldap libnotify lirc lua mad midi mmx mng modules mp3 mp4 mpeg multilib ncurses nls nptl ogg opengl openmp oss pam pango pcre pdf phonon plasma png policykit ppds pulseaudio qt3support qt4 readline sdl semantic-desktop session spell sse sse2 sse3 ssl ssse3 startup-notification svg tcpd tiff truetype udev udisks unicode upower usb vaapi vorbis wxwidgets x264 xcb xcomposite xine xinerama xml xscreensaver xv xvid zlib" ABI_X86="64" ALSA_CARDS="hda-intel" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="evdev synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="nlpsolver presenter-console presenter-minimizer report-builder scripting-beanshell scripting-javascript wiki-publisher" LIRC_DEVICES="devinput" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-5" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_3" RUBY_TARGETS="ruby19 ruby20" USERLAND="GNU" VIDEO_CARDS="intel i965" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
USE_PYTHON="2.7 3.3"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, SYNC

And even with "glamor" flag removed everywhere in package.use, glamor unmerged, intel drivers re-emerged. Yet still, a --oneshot of xorg-server-1.16.0.901 yeilds:

[ebuild     U ~] x11-base/xorg-server-1.16.0.901:0/1.16.0.901 [1.16.0:0/1.16.0] USE="glamor* ipv6 nptl suid udev wayland xorg xvfb -dmx -doc -kdrive -minimal (-selinux) -static-libs -systemd -tslib -unwind -xnest" 5,666 kB
[blocks B      ] x11-libs/glamor ("x11-libs/glamor" is blocking x11-base/xorg-server-1.16.0.901)

Total: 1 package (1 upgrade), Size of downloads: 5,666 kB
Conflict: 1 block (1 unsatisfied)

!!! Multiple package instances within a single package slot have been pulled
!!! into the dependency graph, resulting in a slot conflict:

x11-base/xorg-server:0

  (x11-base/xorg-server-1.16.0.901::gentoo, ebuild scheduled for merge) pulled in by
    =x11-base/xorg-server-1.16.0.901

  (x11-base/xorg-server-1.16.0::gentoo, installed) pulled in by
    x11-base/xorg-server:0/1.16.0= required by (x11-drivers/xf86-video-intel-2.21.15::gentoo, installed)
    x11-base/xorg-server:0/1.16.0= required by (x11-drivers/xf86-input-evdev-2.8.2::gentoo, installed)
    x11-base/xorg-server:0/1.16.0= required by (x11-drivers/xf86-input-synaptics-1.7.4::gentoo, installed)
    x11-base/xorg-server:0/1.16.0= required by (x11-libs/glamor-0.6.0::gentoo, installed)


It may be possible to solve this problem by using package.mask to
prevent one of those packages from being selected. However, it is also
possible that conflicting dependencies exist such that they are
impossible to satisfy simultaneously.  If such a conflict exists in
the dependencies of two different packages, then those packages can
not be installed simultaneously. You may want to try a larger value of
the --backtrack option, such as --backtrack=30, in order to see if
that will solve this conflict automatically.

For more information, see MASKED PACKAGES section in the emerge man
page or refer to the Gentoo Handbook.


 * Error: The above package list contains packages which cannot be
 * installed at the same time on the same system.

  (x11-libs/glamor-0.6.0::gentoo, installed) pulled in by
    x11-libs/glamor required by (x11-drivers/xf86-video-intel-2.21.15::gentoo, installed)




Comment 3


Jouni Kosonen





          2014-09-20 11:26:37 UTC
        

From looking at the ebuilds themselves, to use xorg-server[glamor] you need to use xf86-video-intel-2.99.912 or higher.




Comment 4


Jeff Zacher





          2014-09-21 00:34:48 UTC
        

"From looking at the ebuilds themselves, to use xorg-server[glamor] you need to use xf86-video-intel-2.99.912 or higher."

Perhaps I need an accept_keywords to get the right intel driver package? But then, why isn't portage complaining?

What I did was:
1. unmerged xf86-video-intel to make sure it isn't in my world file and is pulled in by xorg-server. Also removed glamor from the world set.
2. redo my world update with -glamor and all of the packages and dependencies in the stack affected by this flag were rebuilt (x11-drivers/xf86-video-intel-2.21.15:0 was installed with x11-base/xorg-server-1.16.0.901:0/1.16.0.901.) 
3. Change the flag back to glamor and attempted to rebuild. Still had the block.
4. added -glamor to xorg-server in package.use

With -glamor in xorg-server I get:
Calculating dependencies... done!
[ebuild  N     ] x11-libs/glamor-0.6.0  USE="gles xv -static-libs" 0 kB
[ebuild   R    ] x11-drivers/xf86-video-intel-2.21.15  USE="dri glamor* sna udev uxa xvmc" 0 kB

Total: 2 packages (1 new, 1 reinstall), Size of downloads: 0 kB

I read on a thread that xorg-server glamor is mutually exclusive to the actual glamor package(!?) (see last entry of this thread https://forums.gentoo.org/viewtopic-t-996032-start-0.html)
so I am really confused. I think I need glamor at least on my driver for some graphing software I am using....




Comment 5


Jouni Kosonen





          2014-09-21 19:01:47 UTC
        

(In reply to Jeff Zacher from comment #4)
> I think I need glamor at least on my driver for some graphing software 
> I am using....

That would be provided by either x11-base/xorg-server-1.15 with x11-libs/glamor or x11-base/xorg-server-1.16[glamor] with media-libs/libepoxy and media-libs/mesa[egl,gbm]. 

> Perhaps I need an accept_keywords to get the right intel driver package? 
> But then, why isn't portage complaining?

It is, it's just not very clear about it. That's what those !!! -lines are.

With USE="glamor" you can't mix stable x11-drivers/xf86-video-intel with unstable x11-base/xorg-server, you need to keyword both or neither.

You'll likely need to keyword newer versions of some other packages as well if you go that route, I'd guess at least media-libs/libepoxy, x11-base/xorg-drivers and x11-proto/fontsproto .




Comment 6


Jeff Zacher





          2014-09-22 02:58:31 UTC
        

I went back through my accept_keywords and it looks like the root of my problem was the version of input-synaptics I needed for whatever reason asked for a higher/unstable version of xorg-server. x11-proto/fontsproto did indeed make the accept_keywords cut to unstable.

However, since you have been kind enough to clear up exactly WHY this is happening I believe I can try to fall back to stable and see what happens, or as you suggest, just go ahead and bring the rest of the xorg-server to the same versions.

Amazingly even with the glamor flag on the video driver and not on X everything seems stable, so man, Linux has come a long ways in the 15 or so years I have been using it.

Thanks again!









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

