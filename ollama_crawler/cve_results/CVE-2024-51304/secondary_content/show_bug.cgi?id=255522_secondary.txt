Title: 255522 – emerge -DuN system fails on python-2.5.2-r7
URL: https://bugs.gentoo.org/show_bug.cgi?id=255522

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 255522
emerge -DuN system fails on python-2.5.2-r7
Last modified: 2009-05-22 14:42:52 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 255522 
      - emerge -DuN system fails on python-2.5.2-r7


Summary:
emerge -DuN system fails on python-2.5.2-r7
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Python Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-01-19 17:26 UTC by Mark Knecht





      Modified:
    
2009-05-22 14:42 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



Manfred.Knick









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Mark Knecht





          2009-01-19 17:26:36 UTC
        

On two machines I've had the same failure emerging python. (As part of an emerge -DuN system)

Reproducible: Always

Steps to Reproduce:
1. emerge -DuN system


Actual Results:  
gandalf ~ # tail -20 /var/tmp/portage/dev-lang/python-2.5.2-r7/temp/build.log
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xml/sax/saxutils.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xml/sax/xmlreader.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xmllib.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xmlrpclib.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/zipfile.py ...
make: *** [libinstall] Error 1
 * 
 * ERROR: dev-lang/python-2.5.2-r7 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_install
 *             environment, line 3439:  Called die
 * The specific snippet of code:
 *       make DESTDIR="${D}" altinstall maninstall || die;
 *  The die message:
 *   (no error message)
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * A complete build log is located at '/var/tmp/portage/dev-lang/python-2.5.2-r7/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/dev-lang/python-2.5.2-r7/temp/environment'.
 * 
gandalf ~ # 

Expected Results:  
Should have emerged cleanly

gandalf ~ # emerge --info
Portage 2.1.6.4 (default/linux/x86/2008.0/desktop, gcc-4.1.2, glibc-2.6.1-r0, 2.6.27-gentoo-r4 i686)
=================================================================
System uname: Linux-2.6.27-gentoo-r4-i686-AMD_Athlon-tm-_XP_2500+-with-glibc2.0
Timestamp of tree: Tue, 13 Jan 2009 20:00:01 +0000
app-shells/bash:     3.2_p39
dev-java/java-config: 1.3.7-r1, 2.1.6-r1
dev-lang/python:     2.4.4-r6
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=athlon-xp -funroll-loops -fprefetch-loop-arrays -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O3 -march=athlon-xp -funroll-loops -fprefetch-loop-arrays -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--with-bdeps y"
FEATURES="distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://gentoo.osuosl.org/ http://gentoo.seren.com/gentoo ftp://gentoo.mirrors.tds.net/gentoo"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,-O1"
LINGUAS="en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X Xi acl acpi alsa apache2 audiofile berkdb bluetooth branding bzip2 cairo cdparanoia cdr cjk cli cpudetection cracklib crypt cups dbus dri dvd dvdr dvdread eds emboss encode evo fam firefox flac fortran gdbm gif gimp gimpprint gnome gpm gstreamer gtk gtk2 hal i8x0 iconv ipv6 isdnlog jpeg kde ldap libnotify mad midi mikmod mjpeg mmx mmxext mozilla mp3 mpeg mudflap mysql mythtv ncurses nls nptl nptlonly nvidia ogg opengl openmp pam pcre pdf perl png ppds pppd python qt3 qt3support qt4 quicktime readline realmedia reflection sdl session sndfile spell spl sse ssl startup-notification svg sysfs tcltk tcpd threads tiff transcode truetype unicode usb v4l v4l2 vorbis win32codecs x86 xml xorg xscreensaver xulrunner xv xvid zlib" ALSA_CARDS="intel8x0" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en" USERLAND="GNU" VIDEO_CARDS="nv nvidia vesa"
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY

gandalf ~ #




Comment 1


Manfred Knick





          2009-02-11 16:42:01 UTC
        

In my case, it fails with a different error:

#  tail -20 /var/tmp/portage/dev-lang/python-2.5.2-r7/temp/build.log
x86_64-pc-linux-gnu-gcc -pthread -c -fno-strict-aliasing -DNDEBUG -march=athlon64 -O2 -pipe -fwrapv  -I. -IInclude -I./Include  -fPIC -DPy_BUILD_CORE -o Python/compile.o Python/compile.c
x86_64-pc-linux-gnu-gcc -pthread -c -fno-strict-aliasing -DNDEBUG -march=athlon64 -O2 -pipe -fwrapv  -I. -IInclude -I./Include  -fPIC -DPy_BUILD_CORE -o Python/symtable.o Python/symtable.c
Python/graminit.c:1163:26: Warnung: Kein Newline am Dateiende
Python/graminit.c:1163: Fehler: expected expression at end of input
make: *** [Python/graminit.o] Fehler 1
make: *** Warte auf noch nicht beendete Prozesse...
 *
 * ERROR: dev-lang/python-2.5.2-r7 failed.
 * Call stack:
 *               ebuild.sh, line   49:  Called src_compile
 *             environment, line 3485:  Called die
 * The specific snippet of code:
 *       emake || die "Parallel make failed"
 *  The die message:
 *   Parallel make failed
 ...


# emerge --info
Portage 2.1.6.4 (default/linux/amd64/2008.0, gcc-4.1.2, glibc-2.6.1-r0, 2.6.27-gentoo-r8 x86_64)
=================================================================
System uname: Linux-2.6.27-gentoo-r8-x86_64-AMD_Phenom-tm-_9350e_Quad-Core_Processor-with-glibc2.2.5
Timestamp of tree: Wed, 11 Feb 2009 15:45:01 +0000
app-shells/bash:     3.2_p39
dev-lang/python:     2.5.2-r7
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.63
sys-devel/automake:  1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=athlon64      -O2 -pipe "
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-march=athlon64      -O2 -pipe "
...
FEATURES="distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
...
LDFLAGS="-Wl,-O1"
...
MAKEOPTS="-j5"
...





Comment 2


Manfred Knick





          2009-02-11 16:58:44 UTC
        

(In reply to comment #1)
> In my case, it fails with a different error:

Update:

Just commanding again:

-->  emerge -auDN  --jobs=2  --load-average=3.0  --keep-going   system world

emerge succeeds!

VERY STRANGE.
Unfortunately  don't see a chance to continue investigation now ...

Anyone else ?





Comment 3


Mark Knecht





          2009-02-12 01:32:30 UTC
        

In my case one machine got fixed somewhere along the way but the original machine that had the problem still has the problem. It's very frustrating as this is the 2.5 slot of python which is so crucial to moving forward and I cannot get it built so the machine seems stuck.

Because Manfred got his system working I gave this machine another try today with the command

emerge -e @system

and it failed. Here is the end of the log file:


Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xml/sax/_exceptions.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xml/sax/expatreader.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xml/sax/handler.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xml/sax/saxutils.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xml/sax/xmlreader.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xmllib.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/xmlrpclib.py ...
Compiling /var/tmp/portage/dev-lang/python-2.5.2-r7/image//usr/lib/python2.5/zipfile.py ...
make: *** [libinstall] Error 1
 ^[[31;01m*^[[0m
 ^[[31;01m*^[[0m ERROR: dev-lang/python-2.5.2-r7 failed.
 ^[[31;01m*^[[0m Call stack:
 ^[[31;01m*^[[0m               ebuild.sh, line   49:  Called src_install
 ^[[31;01m*^[[0m             environment, line 3469:  Called die
 ^[[31;01m*^[[0m The specific snippet of code:
 ^[[31;01m*^[[0m       make DESTDIR="${D}" altinstall maninstall || die;
 ^[[31;01m*^[[0m  The die message:
 ^[[31;01m*^[[0m   (no error message)
 ^[[31;01m*^[[0m
 ^[[31;01m*^[[0m If you need support, post the topmost build error, and the call stack if relevant.
 ^[[31;01m*^[[0m A complete build log is located at '/var/tmp/portage/dev-lang/python-2.5.2-r7/temp/build.log'.
 ^[[31;01m*^[[0m The ebuild environment file is located at '/var/tmp/portage/dev-lang/python-2.5.2-r7/temp/environment'.
 ^[[31;01m*^[[0m

It's not a disk space issue as far as I Can tell:

gandalf ~ # df
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/sda3              4892408   2417740   2226148  53% /
udev                     10240        92     10148   1% /dev
/dev/sda9              4806552   3372752   1189640  74% /usr
/dev/sda6              9612604    820584   8303724   9% /usr/portage
/dev/sda8              9612604   3233368   5890940  36% /home/herb
/dev/sdb2            278827992     32820 264631468   1% /TVstorage
none                    257920         0    257920   0% /dev/shm
gandalf ~ # 

I'm raising the severity to critical (it is for me!) after having the problem for more than a month and not understanding how to work around it. 





Comment 4


Manfred Knick





          2009-02-12 08:05:22 UTC
        

(In reply to comment #3)

> In my case one machine got fixed somewhere along the way but the original
> machine that had the problem still has the problem. 

Comparing, I just realized your 

> CFLAGS="-O3 -march=athlon-xp -funroll-loops -fprefetch-loop-arrays -pipe"

Perhaps you might consider cross-testing with very conservative settings, e.g.

> CFLAGS="-O2 -pipe"

Looking forward to hearing your result!
Kind regards
Manfred





Comment 5


Mark Knecht





          2009-02-12 15:02:23 UTC
        

I removed these flags from CFLAGS

-funroll-loops
-fprefetch-loop-arrays

and it emerged fine. These flags have been in place for 6 years so I'm surprised it matters but it does.

Setting severity back to normal. Personally I wouldn't call this fixed but I no longer have the problem









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

