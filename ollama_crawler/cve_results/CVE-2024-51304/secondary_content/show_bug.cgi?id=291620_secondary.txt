Title: 291620 – >=x11-base/xorg-server-1.7.1 xinerama bug
URL: https://bugs.gentoo.org/show_bug.cgi?id=291620

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 291620
>=x11-base/xorg-server-1.7.1 xinerama bug
Last modified: 2010-09-12 18:54:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 291620 
      - >=x11-base/xorg-server-1.7.1 xinerama bug


Summary:
>=x11-base/xorg-server-1.7.1 xinerama bug
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo X packagers








URL:



http://bugs.freedesktop.org/show_bug....
        




Whiteboard:




Keywords:









Duplicates (1):
    

295953

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2009-11-02 20:02 UTC by Ronny





      Modified:
    
2010-09-12 18:54 UTC
      (History)
    




          CC List:
        

9 
          users
          
            (show)
          



cardoe
cctsurf
gentoo
newchief
plasm
Sascha
urs.hunkeler
x11
ZGold550









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




nvidia-bug-report.log.gz

              (nvidia-bug-report.log.gz,34.69 KB,
                application/octet-stream)

            
2009-11-05 14:13 UTC,

            Ronny




Details





nvidia Bug Report

              (nvidia-bug-report.log.gz,34.35 KB,
                text/plain)

            
2010-05-03 04:14 UTC,

            James




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ronny





          2009-11-02 20:02:09 UTC
        

hi,
i upgraded to x11-base/xorg-server-1.7.1 and now i have got an Problem with my third screen.

Everytime i enter my third screen, connected to the second gpu, the xorg freezes and the cursor is jumping between the third and second screen.

This Problem first happened since i updated my system.

If i select move window on a windows placed on the third screen, the window jumps to an other screen with the cursor. There is also no error message. Thats why i think that this is a Bug with xinerama and or randr.

Reproducible: Always

Steps to Reproduce:
1. Starting Xorg with any Windowmanager
2. Moving the cursor to the screen connected to the second GPU
3. watch the jumping cursor and freezing windows.




emerge --info:
Portage 2.1.7.2 (default/linux/amd64/10.0/desktop, gcc-4.4.2, glibc-2.10.1-r0, 2.6.31-gentoo-r4 x86_64)
=================================================================
System uname: Linux-2.6.31-gentoo-r4-x86_64-Intel-R-_Core-TM-_i7_CPU_975_@_3.33GHz-with-gentoo-2.0.1
Timestamp of tree: Mon, 02 Nov 2009 01:30:01 +0000
app-shells/bash:     4.0_p35
dev-java/java-config: 2.1.9-r1
dev-lang/python:     2.5.4-r2, 2.6.3, 3.1.1-r1
dev-python/pycrypto: 2.0.1-r8
dev-util/cmake:      2.6.4-r3
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.5.2-r1
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.63-r1
sys-devel/automake:  1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2, 1.11
sys-devel/binutils:  2.20
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6a
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -msse4 -msse4.1 -msse4.2 -O2 -pipe -mfpmath=sse -fomit-frame-pointer -fno-ident -msahf"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-march=core2 -msse4 -msse4.1 -msse4.2 -O2 -pipe -mfpmath=sse -fomit-frame-pointer -fno-ident -msahf"
DISTDIR="/mnt/nfs_portage/distfiles"
FEATURES="assume-digests distlocks fixpackages news parallel-fetch protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LDFLAGS="-Wl,-O1"
LINGUAS="de en"
MAKEOPTS="-j9"
PKGDIR="/mnt/nfs_portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/mnt/nfs_portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/webapps-experimental /usr/portage/local/layman/vdr-experimental /usr/portage/local/layman/liquidx /usr/portage/local/layman/vdr-testing /usr/portage/local/layman/zugaina /usr/portage/local/layman/sunrise /usr/portage/local/layman/maggu2810_overlay /usr/portage/local/layman/lottanzb /usr/portage/local/layman/vdr-devel /usr/portage/local/layman/berkano /usr/portage/local/layman/x11 /usr/portage/local/layman/vmware /usr/portage/local/layman/kde3 /usr/portage/local/layman/voyageur /usr/portage/local/layman/devnull /usr/local/overlays/xmms-overlay /usr/local/overlays/myoverlay"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="7zip X Xaw3d a52 a62 aac aalib acl acpi ada addbookmarks additions aften aiglx aio akode alias alsa amd64 amrnb amrwb ao aoss apache ares artswrappersuid asf automount avahie bash-completion berkdb bidi big-tables bigpatch blender-game bluetooth boost branding bzip2 cairo cdaudio cdda cddb cdio cdparanoia cdr clearcase cleartype cli connectionstatus consolekit contactnotes cracklib crypt css ctype cups cupsddk curl custom-optimization cvs divx djvu dmx dri dts dvbplayer dvd dvdr dvdread eac3 editor eds embedded embedded-fuseiso emboss emoticons-manager emovix emulation encode evo expat extras faac faad fam fame fasttrack fat fbcon ffmpeg figlet firefox firefpx flac fontconfig fortran fpm ftp fuse gcj gdbm geoip ggi gif gimp gimpprint glib glitz gmplayer gnome gnutils gnutls gphoto2 gpm gs gstreamer gtk gtk2 gtkhtml h264 hal haskell hddtemp hfs history hpcups hpijs httpd i8x0 iconv icotools icoutils icq imagemagick imlib injection insecure-patches ipv6 ithreads jabber jack java javascript jfs joystick jpeg jpeg2k jumpplay kde kdrive konqueror kqemu lame lcms ldap libcaca libextractor libgcrypt libnotify libsamplerate live livebuffer lm_sensors logitech-mouse lua lzo mad maps md5 md5sum metalink mikmod mjpeg mmap mmx mmxext mng mod modperl modplug modules monoglibc-omitfp mozdevelop mp2 mp3 mp3tunes mp4 mp4live mpeg mpeg2 mplayer msn mudflap multilib musepack musicbrainz mysql mysqli nas ncurses network network_manager nfs nis nls nptl nptlonly ntfs nvidia oav objc objc++ objc-gc odk ogg old-daemons openal opengl openmp optimisememory oscar oss pam pascal passwordsave pcre pdf pds perforce perl php pie player plotutils png pnm postproc ppds pppd premiereepgfix projectx psyrdo psytrellis python qt qt3 qt3support qt4 quicktime quotas rar rdesktop readline reflection reiser4 reiserfs rtsp ruby run-as-root samba sametime sasl scanner screen script sdk sdl session setup setup-plugin sftp shout silc skins slp smp sms sndfile snmp sockets socks5 sound source sourcecaps speex spell spl sql sqlite sse sse-filters sse2 sse3 ssl ssse3 startup-notification stream subtitles subversion svg swat swscaler symlink sysfs taglib tcl tcltk tcpd templates test-programs tetex tga themes theora threads threadsafe thunar thunderbird tiff timidity tk toolbar tools trace truehd truetype twolame udev unicode usb userlocales utempter utils v4l v4l2 vboxbfe vcd vcdx vdpau vim-with-x visualization vlm vnc vorbis wavpack webdav webkit webpresence winbind winetools winetriks wma wmf wmp wxwidgets wxwindows x264 x64 xanim xcb xcomposite xfs xine xinerama xml xorg xosd xpm xscreensaver xulrunner xv xvid xvmc yaepg yv12 zip zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de en" USERLAND="GNU" VIDEO_CARDS="fbdev nv nvidia vesa"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPT

xorg.conf:
Section "ServerLayout"
    Identifier     "X.org Configured"
    Screen      0  "Screen0" 1920 0
    Screen      1  "Screen1" 3840 0
    Screen      2  "Screen2" LeftOf "Screen0"
    InputDevice    "Mouse0" "CorePointer"
    InputDevice    "Keyboard0" "CoreKeyboard"
EndSection

Section "Files"
    ModulePath      "/usr/lib64/xorg/modules"
    FontPath        "/usr/share/fonts/misc/"
    FontPath        "/usr/share/fonts/TTF/"
    FontPath        "/usr/share/fonts/OTF"
    FontPath        "/usr/share/fonts/Type1/"
    FontPath        "/usr/share/fonts/100dpi/"
    FontPath        "/usr/share/fonts/75dpi/"
EndSection

Section "Module"
    Load           "glx"
    Load           "extmod"
    Load           "record"
    Load           "dbe"
    Load           "wfb"
    Load           "xtrap"
EndSection

Section "ServerFlags"
    Option         "DontZap" "false"
    Option         "Xinerama" "1"
    Option         "AutoAddDevices"   "off"
EndSection

Section "InputDevice"
    Identifier     "Keyboard0"
    Driver         "kbd"
    Option         "Protocol" "Standard"
    Option         "XkbLayout" "de"
    Option         "XkbModel" "pc105"
    Option         "XkbRules" "xorg"
    Option         "XkbVariant" "nodeadkeys"
    Option         "XkbOptions" "terminate:ctrl_alt_bksp"
EndSection

Section "InputDevice"
    Identifier     "Mouse0"
    Driver         "mouse"
    Option         "Buttons" "5"
    Option         "Device" "/dev/input/mice"
    Option         "Name" "USB-Mouse;NetScrollPS/2 on USB"
    Option         "Protocol" "IMPS/2"
    Option         "ZAxisMapping" "4 5"
EndSection

Section "Monitor"
    Identifier     "Monitor0"
    VendorName     "Unknown"
    ModelName      "Samsung SyncMaster"
    HorizSync       30.0 - 81.0
    VertRefresh     56.0 - 75.0
EndSection

Section "Monitor"
    Identifier     "Monitor1"
    VendorName     "Unknown"
    ModelName      "Samsung SyncMaster"
    HorizSync       30.0 - 81.0
    VertRefresh     56.0 - 75.0
EndSection

Section "Monitor"
    Identifier     "Monitor2"
    VendorName     "Unknown"
    ModelName      "Samsung SyncMaster"
    HorizSync       30.0 - 81.0
    VertRefresh     56.0 - 75.0
EndSection

Section "Device"
    Identifier     "Device0"
    Driver         "nvidia"
    VendorName     "NVIDIA Corporation"
    BoardName      "GeForce GTX 295"
    Option         "NoLogo" "0"
    Option         "DRI" "true"
    Option         "Coolbits" "1"
    Option         "TripleBuffer" "1"
    Option         "DamageEvents" "1"
    Option         "BackingStore" "1"
    Option         "UseCompositeWrapper" "True"
    Option         "AddARGBGLXVisuals" "True"
#    Option         "UseEvents" "True"
    Option         "OnDemandVBlankInterrupts" "True"
    Option         "PixmapCacheSize" "16777216"
    Option         "RenderAccel" "true"
    Option         "RegistryDwords" "PowerMizerLevel=0x3"
    BusID          "PCI:5:0:0"
    Screen          0
EndSection

Section "Device"
    Identifier     "Device1"
    Driver         "nvidia"
    VendorName     "NVIDIA Corporation"
    BoardName      "GeForce GTX 295"
    Option         "NoLogo" "0"
    Option         "DRI" "true"
    Option         "Coolbits" "1"
    Option         "TripleBuffer" "1"
    Option         "DamageEvents" "1"
    Option         "BackingStore" "1"
    Option         "UseCompositeWrapper" "True"
    Option         "AddARGBGLXVisuals" "True"
#    Option         "UseEvents" "True"
    Option         "OnDemandVBlankInterrupts" "True"
    Option         "PixmapCacheSize" "16777216"
    Option         "RenderAccel" "true"
    Option         "RegistryDwords" "PowerMizerLevel=0x3"
    BusID          "PCI:5:0:0"
    Screen          1
EndSection

Section "Device"
    Identifier     "Device2"
    Driver         "nvidia"
    VendorName     "NVIDIA Corporation"
    BoardName      "GeForce GTX 295"
    Option         "NoLogo" "0"
    Option         "DRI" "true"
    Option         "Coolbits" "1"
    Option         "TripleBuffer" "1"
    Option         "DamageEvents" "1"
    Option         "BackingStore" "1"
    Option         "UseCompositeWrapper" "True"
    Option         "AddARGBGLXVisuals" "True"
#    Option         "UseEvents" "True"
    Option         "OnDemandVBlankInterrupts" "True"
    Option         "PixmapCacheSize" "16777216"
    Option         "RenderAccel" "true"
    Option         "RegistryDwords" "PowerMizerLevel=0x3"
    BusID          "PCI:4:0:0"
EndSection

Section "Screen"
    Identifier     "Screen0"
    Device         "Device0"
    Monitor        "Monitor0"
    DefaultDepth    24
    Option         "AddARGBGLXVisuals" "True"
    Option         "TwinView" "0"
    Option         "metamodes" "DFP-0: nvidia-auto-select +0+0"
    SubSection     "Display"
        Depth       24
    EndSubSection
EndSection

Section "Screen"
    Identifier     "Screen1"
    Device         "Device1"
    Monitor        "Monitor1"
    DefaultDepth    24
    Option         "TwinView" "0"
    Option         "metamodes" "DFP-1: nvidia-auto-select +0+0"
    SubSection     "Display"
        Depth       24
    EndSubSection
EndSection

Section "Screen"
    Identifier     "Screen2"
    Device         "Device2"
    Monitor        "Monitor2"
    DefaultDepth    24
    Option         "TwinView" "0"
    Option         "metamodes" "nvidia-auto-select +0+0"
    SubSection     "Display"
        Depth       24
    EndSubSection
EndSection

Section "Extensions"
    Option         "Composite" "Enable"
EndSection




Comment 1


Sascha Cunz





          2009-11-04 20:18:26 UTC
        

Hey Ronny,

i've updated about 10 multihead systems to xorg 1.7. Half of them suffered from this bug.

Though solutions seems quite simple: The "LeftOf" has problems in xorg 1.7. I simple changed monitor connectors and replaced "LeftOf" with "RightOf"; but as your example shows giving absolute positions might also do it.

Sascha




Comment 2


Ronny





          2009-11-04 20:29:44 UTC
        

hi Sascha
thanks for reply, 
i will try tomorrow and post if this solves the problem.

Ronny







Comment 3


Rémi Cardona (RETIRED)






          2009-11-04 21:03:40 UTC
        

Keeping x11 as a CC because I'm not ruling out a server bug here.

Thanks




Comment 4


Doug Goldstein (RETIRED)






          2009-11-05 04:23:29 UTC
        

What version of nvidia-drivers? please include the output of nvidia-bug-report.sh




Comment 5


Ronny





          2009-11-05 14:13:39 UTC
        

Created attachment 209334 [details]
nvidia-bug-report.log.gz

first: the hint of Sascha helped, its just a bit ugly because we main monitor isn't the one in the middle anymore... but it works temporary


> What version of nvidia-drivers? 
This happens with every Version, its a bug which occours if the Screens are not in chronological order.
like screen0 1024 0 and screen1 0 0.




Comment 6


Zach Goldberg





          2009-11-23 15:15:54 UTC
        

That happens for me as well.  The "reorganize your screens to be in order inside xorg.conf" advise worked for me too, although again it is a fairly ugly fix.




Comment 7


Zach Goldberg





          2009-11-23 15:18:47 UTC
        

(In reply to comment #6)
> That happens for me as well.  The "reorganize your screens to be in order
> inside xorg.conf" advise worked for me too, although again it is a fairly ugly
> fix.
> 

I apologize, I guess I should've mentioned my setup as well.  I am using the nvidia proprietary driver (190.xx) with xorg 1.7.1.  I have two different nvdia cards powering four monitors together connected via Xinerama (XRandR *STILL* doesn't do multi gpu afaik)




Comment 8


Doug Goldstein (RETIRED)






          2009-11-23 19:08:13 UTC
        

I don't have the bug/ml post handy right now but from something I read this weekend, its an xorg-server bug that they don't intend on fixing because Xrandr is going to handle it at some point.




Comment 9


Tim Yamin





          2009-12-29 19:00:36 UTC
        

I've posted a patch that fixes the problem for me here [https://bugs.freedesktop.org/show_bug.cgi?id=24986]; can you please try it?

Tim




Comment 10


Lars Wendler (Polynomial-C) (RETIRED)






          2010-01-18 16:52:51 UTC
        

*** Bug 295953 has been marked as a duplicate of this bug. ***




Comment 11


Paul Osmialowski





          2010-04-10 14:33:36 UTC
        

I have the same after today's update to x11-base/xorg-server-1.7.6
My graphics hardware is:
01:00.0 VGA compatible controller: nVidia Corporation NV44A [GeForce 6200] (rev a1) (using nvidia-drivers-195.36.15)
03:01.0 VGA compatible controller: nVidia Corporation NV5M64 [RIVA TNT2 Model 64/Model 64 Pro] (rev 15) (using xf86-video-nv-2.1.17)





Comment 12


James





          2010-05-03 04:12:16 UTC
        

I'm running 1.8.0, and I'm getting the same problem on a newly built system, is there any workaround to this bug?




Comment 13


James





          2010-05-03 04:14:28 UTC
        

Created attachment 230107 [details]
nvidia Bug Report

It always seems to be happening when I put some stress on the system, I started jack_test tonight, otherwise, when I run emerge with xorg running, I should know better by now.




Comment 14


James





          2010-05-11 14:45:58 UTC
        

Tim's patch makes my system stable, please put this patch in the repository!




Comment 15


Doug Goldstein (RETIRED)






          2010-05-12 23:04:31 UTC
        

It appears that the patch has been modified in the ticket and the final result works for other people.

x11 herd: (remi): can you prod Peter to review this and merge it in to xorg-server?




Comment 16


Tomáš Chvátal (RETIRED)






          2010-08-27 09:17:31 UTC
        

Altho it is not in stable version it is fixed in any xorg-server older than 1.8.1.

Should the bug be closed then?




Comment 17


Tim Yamin





          2010-08-27 12:53:36 UTC
        

Yes, I think it makes sense to close this -- I've been using 1.8.1.902 for a while now and it works just fine.




Comment 18


Chí-Thanh Christopher Nguyễn






          2010-09-12 18:54:58 UTC
        

Resolving as WORKSFORME per comment 17.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

