Title: 790221 – dev-libs/nss-3.64: nsinstall: cannot set times of dist/private/nss/baset.h: Invalid argument
URL: https://bugs.gentoo.org/show_bug.cgi?id=790221

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 790221
dev-libs/nss-3.64: nsinstall: cannot set times of dist/private/nss/baset.h: Invalid argument
Last modified: 2021-05-28 18:31:53 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 790221 
      - dev-libs/nss-3.64: nsinstall: cannot set times of dist/private/nss/baset.h: Invalid argument


Summary:
dev-libs/nss-3.64: nsinstall: cannot set times of dist/private/nss/baset.h: I...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Mozilla Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-05-14 15:00 UTC by James L. Hammons





      Modified:
    
2021-05-28 18:31 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



ionen
sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




strace log

              (nsinstall.log,18.10 KB,
                text/plain)

            
2021-05-27 15:51 UTC,

            James L. Hammons




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


James L. Hammons





          2021-05-14 15:00:21 UTC
        

Like it says on the tin, nss-3.64 fails to build on a multilib system.

N.B.: dev-libs/nss-3.63.1 fails to build in pretty much the same way.

Reproducible: Always

Steps to Reproduce:
1. emerge nss
2.
3.



# emerge --info
Portage 3.0.14 (python 3.8.8-final-0, default/linux/amd64/17.1, gcc-8.4.0, glibc-2.33, 5.1.2 x86_64)
=================================================================
System uname: Linux-5.1.2-x86_64-AMD_Ryzen_5_1600X_Six-Core_Processor-with-glibc2.2.5
KiB Mem:    16434184 total,    408264 free
KiB Swap:   16777212 total,  16776436 free
Timestamp of repository gentoo: Sat, 01 May 2021 16:30:01 +0000
Head commit of repository gentoo: b2accfc39e58bc146a7bc3225c9c43ac002c252c
sh bash 5.1_p4
ld GNU ld (Gentoo 2.34 p6) 2.34.0
app-shells/bash:          5.1_p4::gentoo
dev-java/java-config:     2.3.1::gentoo
dev-lang/perl:            5.32.0-r1::gentoo
dev-lang/python:          2.7.18_p8::gentoo, 3.7.10_p1::gentoo, 3.8.8_p1::gentoo, 3.9.2_p1::gentoo
dev-lang/rust:            1.48.0::gentoo
dev-util/cmake:           3.19.4::gentoo
sys-apps/baselayout:      2.7-r2::gentoo
sys-apps/openrc:          0.42.1-r1::gentoo
sys-apps/sandbox:         2.20::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r5::gentoo
sys-devel/automake:       1.11.6-r3::gentoo, 1.16.3-r1::gentoo
sys-devel/binutils:       2.34-r2::gentoo, 2.35.1-r1::gentoo, 2.36.1-r1::gentoo
sys-devel/gcc:            8.4.0-r1::gentoo, 9.3.0-r2::gentoo
sys-devel/gcc-config:     2.3.3::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.3::gentoo
sys-kernel/linux-headers: 5.10::gentoo (virtual/os-headers)
sys-libs/glibc:           2.33::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts: 
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-metamanifest: no
    sync-rsync-verify-jobs: 1

Local-Portage-Overlay
    location: /usr/local/portage
    masters: gentoo
    priority: 0

ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/maven-bin-3.6/conf"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe"
DISTDIR="/mnt/filestore/distfiles"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j13"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
USE="10bit 12bit X a52 aac aacs acl alsa amd64 apng berkdb bzip2 cairo cli crypt cups dbus djvu dri dvd elogind faad fdk flac fluidsynth fortran gdbm gentoo-vm gif gstreamer iconv javafx jpeg jpeg2k jumbo-build lcms libglvnd libtirpc matroska midi mikmod minizip mng mod modplug mp3 mp4 mpeg multilib ncurses nls nptl numa ofx ogg opengl openmp opus pam pcre pcre16 pdfimport plasma png postscript qt5 readline scripttools seccomp smpeg speex split-usr sqlite ssl svg system-av1 system-cairo system-harfbuzz system-icu system-jpeg system-lcms system-libevent system-sqlite system-zlib taglib tahoma tcpd text theora threads tiff truetype udisks unicode usb vorbis wav x264 x265 xattr xcb xkb xvid zip zlib" ABI_X86="64" ADA_TARGET="gnat_2018" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_core authn_dbm authn_file authz_core authz_dbm authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir env expires ext_filter file_cache filter headers include info log_config logio mime mime_magic negotiation rewrite setenvif socache_shmcb speling status unique_id unixd userdir usertrack vhost_alias authn_dbd dbd access_compat" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext sse sse2" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-3 php7-4" POSTGRES_TARGETS="postgres10 postgres11" PYTHON_SINGLE_TARGET="python3_8" PYTHON_TARGETS="python2_7 python3_7 python3_8" RUBY_TARGETS="ruby26" USERLAND="GNU" VIDEO_CARDS="amdgpu radeonsi radeon r600" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq proto steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, LINGUAS, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, RUSTFLAGS




Comment 1


Sam James









          2021-05-14 15:01:39 UTC
        

Full build.log please?




Comment 2


James L. Hammons





          2021-05-14 15:08:46 UTC
        

Sorry for the paste, I get an 'Internal Server Error' when I try to add this as an attachment this to the bug.

[32;01m * [39;49;00mPackage:    dev-libs/nss-3.64
[32;01m * [39;49;00mRepository: gentoo
[32;01m * [39;49;00mMaintainer: mozilla@gentoo.org
[32;01m * [39;49;00mUSE:        abi_x86_32 abi_x86_64 amd64 elibc_glibc kernel_linux userland_GNU
[32;01m * [39;49;00mFEATURES:   network-sandbox preserve-libs sandbox userpriv usersandbox
>>> Unpacking source...
>>> Unpacking nss-3.64.tar.gz to /var/tmp/portage/dev-libs/nss-3.64/work
>>> Source unpacked in /var/tmp/portage/dev-libs/nss-3.64/work
>>> Preparing source in /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss ...
 [32;01m*[0m Applying nss-3.53-gentoo-fixups.patch ...
patching file Makefile
patching file config/Makefile
patching file config/nss-config.in
patching file config/nss.pc.in
patching file manifest.mn
Hunk #1 succeeded at 10 with fuzz 2.
[A[72C [34;01m[ [32;01mok[34;01m ][0m
 [32;01m*[0m Applying nss-3.21-gentoo-fixup-warnings.patch ...
[A[72C [34;01m[ [32;01mok[34;01m ][0m
 [32;01m*[0m Applying nss-3.23-hppa-byte_order.patch ...
[A[72C [34;01m[ [32;01mok[34;01m ][0m
 [32;01m*[0m Will copy sources from /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss
 [32;01m*[0m abi_x86_32.x86: copying to /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86
 [32;01m*[0m abi_x86_64.amd64: copying to /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_64.amd64
>>> Source prepared.
>>> Configuring source in /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss ...
 [32;01m*[0m abi_x86_32.x86: running multilib-minimal_abi_src_configure
 [32;01m*[0m abi_x86_64.amd64: running multilib-minimal_abi_src_configure
>>> Source configured.
>>> Compiling source in /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss ...
 [32;01m*[0m abi_x86_32.x86: running multilib-minimal_abi_src_compile
make -j13 -j1 -C coreconf 'CC=x86_64-pc-linux-gnu-gcc -m32' 
make: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf'
../coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
make[1]: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf/nsinstall'
../../coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
x86_64-pc-linux-gnu-gcc -m32 -o Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall.o -c -std=c99 -O2 -fno-strict-aliasing -fPIC -Di386 -m32 -pipe -ffunction-sections -fdata-sections -DHAVE_STRERROR -DLINUX -Dlinux -Wall -Wshadow -DNSS_NO_GCC48 -DXP_UNIX -DXP_UNIX -UDEBUG -DNDEBUG -D_DEFAULT_SOURCE -D_BSD_SOURCE -D_POSIX_SOURCE -DSQL_MEASURE_USE_TEMP_DIR -D_REENTRANT -UDEBUG -DNDEBUG -D_DEFAULT_SOURCE -D_BSD_SOURCE -D_POSIX_SOURCE -DSQL_MEASURE_USE_TEMP_DIR -D_REENTRANT -DNSS_DISABLE_AVX2 -DNSS_NO_INIT_SUPPORT -DSEED_ONLY_DEV_URANDOM -DUSE_UTIL_DIRECTLY -DNO_NSPR_10_SUPPORT -DSSL_DISABLE_DEPRECATED_CIPHER_SUITE_NAMES -I../../dist/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/include -I../../dist/public/coreconf -I../../dist/private/coreconf -I../../dist/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/include/dbm  nsinstall.c
x86_64-pc-linux-gnu-gcc -m32 -o Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/pathsub.o -c -std=c99 -O2 -fno-strict-aliasing -fPIC -Di386 -m32 -pipe -ffunction-sections -fdata-sections -DHAVE_STRERROR -DLINUX -Dlinux -Wall -Wshadow -DNSS_NO_GCC48 -DXP_UNIX -DXP_UNIX -UDEBUG -DNDEBUG -D_DEFAULT_SOURCE -D_BSD_SOURCE -D_POSIX_SOURCE -DSQL_MEASURE_USE_TEMP_DIR -D_REENTRANT -UDEBUG -DNDEBUG -D_DEFAULT_SOURCE -D_BSD_SOURCE -D_POSIX_SOURCE -DSQL_MEASURE_USE_TEMP_DIR -D_REENTRANT -DNSS_DISABLE_AVX2 -DNSS_NO_INIT_SUPPORT -DSEED_ONLY_DEV_URANDOM -DUSE_UTIL_DIRECTLY -DNO_NSPR_10_SUPPORT -DSSL_DISABLE_DEPRECATED_CIPHER_SUITE_NAMES -I../../dist/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/include -I../../dist/public/coreconf -I../../dist/private/coreconf -I../../dist/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/include/dbm  pathsub.c
rm -f Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall
x86_64-pc-linux-gnu-gcc -m32 -o Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall -O2 -fno-strict-aliasing -fPIC -Di386 -m32 -pipe -ffunction-sections -fdata-sections -DHAVE_STRERROR -DLINUX -Dlinux -Wall -Wshadow -DNSS_NO_GCC48 -DXP_UNIX -DXP_UNIX -UDEBUG -DNDEBUG -D_DEFAULT_SOURCE -D_BSD_SOURCE -D_POSIX_SOURCE -DSQL_MEASURE_USE_TEMP_DIR -D_REENTRANT -UDEBUG -DNDEBUG -D_DEFAULT_SOURCE -D_BSD_SOURCE -D_POSIX_SOURCE -DSQL_MEASURE_USE_TEMP_DIR -D_REENTRANT -DNSS_DISABLE_AVX2 -DNSS_NO_INIT_SUPPORT -DSEED_ONLY_DEV_URANDOM -DUSE_UTIL_DIRECTLY -DNO_NSPR_10_SUPPORT -DSSL_DISABLE_DEPRECATED_CIPHER_SUITE_NAMES -I../../dist/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/include -I../../dist/public/coreconf -I../../dist/private/coreconf -I../../dist/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/include/dbm  Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall.o Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/pathsub.o -m32 -z noexecstack -m32 -z noexecstack -m32 -z noexecstack -m32 -z noexecstack   -lpthread  -ldl -lc
true -m 775 Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall ../../dist/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/bin
make[1]: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf/nsinstall'
make: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf'
make -j13 -j1 'CC=x86_64-pc-linux-gnu-gcc -m32' 'CCC=x86_64-pc-linux-gnu-g++ -m32' 'AR=x86_64-pc-linux-gnu-ar rc $@' RANLIB=x86_64-pc-linux-gnu-ranlib OPTIMIZER= NSINSTALL=/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/./coreconf/nsinstall/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall -C . OS_TEST=i686 
make: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86'
coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
make all
make[1]: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86'
coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
# no real way to encode these in any sensible way
make -C coreconf/nsinstall program
make[2]: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf/nsinstall'
../../coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
true -m 775 Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall ../../dist/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/bin
make[2]: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf/nsinstall'
make export
make[2]: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86'
coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
make[3]: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf'
../coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
make[4]: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf/nsinstall'
../../coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
make[4]: Nothing to be done for 'export'.
make[4]: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf/nsinstall'
make[3]: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/coreconf'
make[3]: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/lib'
../coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
make[4]: Entering directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/lib/base'
../../coreconf/config.mk:138: CPU_ARCH is not x86_64, disabling -mavx2
/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/./coreconf/nsinstall/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall -t -m 444 baset.h ../../dist/private/nss
nsinstall: cannot set times of /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/dist/private/nss/baset.h: Invalid argument
make[4]: *** [../../coreconf/rules.mk:390: ../../dist/private/nss/baset.h] Aborted
make[4]: *** Deleting file '../../dist/private/nss/baset.h'
make[4]: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/lib/base'
make[3]: *** [../coreconf/rules.mk:44: base] Error 2
make[3]: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/lib'
make[2]: *** [coreconf/rules.mk:44: lib] Error 2
make[2]: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86'
make[1]: *** [manifest.mn:26: prepare_build] Error 2
make[1]: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86'
make: *** [Makefile:53: nss_build_all] Error 2
make: Leaving directory '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86'
 [31;01m*[0m ERROR: dev-libs/nss-3.64::gentoo failed (compile phase):
 [31;01m*[0m   emake failed
 [31;01m*[0m 
 [31;01m*[0m If you need support, post the output of `emerge --info '=dev-libs/nss-3.64::gentoo'`,
 [31;01m*[0m the complete build log and the output of `emerge -pqv '=dev-libs/nss-3.64::gentoo'`.
 [31;01m*[0m The complete build log is located at '/var/tmp/portage/dev-libs/nss-3.64/temp/build.log'.
 [31;01m*[0m The ebuild environment file is located at '/var/tmp/portage/dev-libs/nss-3.64/temp/environment'.
 [31;01m*[0m Working directory: '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86'
 [31;01m*[0m S: '/var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss'




Comment 3


Sam James









          2021-05-14 15:14:24 UTC
        

(The internal error usually happens when the user your browser is running as lacks permissions to access the file. Try moving it elsewhere to reduce confusion and chowning.)

I’m on mobile so I can’t quite easily but the invalid argument part hints to me that /var/tmp/portage may be on a weird file system or your kernel lacks support for some needed attributes.

Anything interesting about your system?

(Also, as a Hail Mary, check your clock.)




Comment 4


James L. Hammons





          2021-05-14 15:23:38 UTC
        

The root filesystem is of type ext4, and nothing is split out.  Other than that, it's a pretty standard system.  It is a Ryzen 5 1600X, if that makes any difference.

One thing that *might* be of interest is that it pulls its distfiles from an NFS 4.1 share on the server (so that all the Gentoo systems can share downloads).  I could unmount the share and try again, but I seriously doubt it would make any difference.




Comment 5


James L. Hammons





          2021-05-14 15:37:19 UTC
        

Also, time on my system is synchronized thru NTP (via net-misc/chrony); not sure why it's giving the "cannot set times of" error (other than the "Invalid argument" hint at the end of that line).




Comment 6


Thomas Deutschmann (RETIRED)






          2021-05-14 15:42:35 UTC
        

Which file system are you using for /var/tmp/portage/dev-libs/nss-3.64/work/?




Comment 7


James L. Hammons





          2021-05-15 04:08:15 UTC
        

As I mentioned in comment #4, the entire filesystem is ext4.




Comment 8


James L. Hammons





          2021-05-27 14:40:12 UTC
        

How can I help debug this?  This is holding up world updates on my system.




Comment 9


Thomas Deutschmann (RETIRED)






          2021-05-27 15:33:40 UTC
        

Install strace. When you hit this error, run

> su portage --shell /bin/bash
> cd /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/lib/base
> strace -o /tmp/nsinstall.log -s 4096 -tt -- /var/tmp/portage/dev-libs/nss-3.64/work/nss-3.64/nss-abi_x86_32.x86/./coreconf/nsinstall/Linux5.1_x86_x86_64-pc-linux-gnu-gcc_glibc_PTH_OPT.OBJ/nsinstall -t -m 444 baset.h ../../dist/private/nss

Attach /tmp/nsinstall.log to this bug.




Comment 10


James L. Hammons





          2021-05-27 15:51:17 UTC
        

Created attachment 711765 [details]
strace log

strace log, as requested.




Comment 11


Sam James









          2021-05-27 17:34:03 UTC
        

This probably isn’t it but is there a reason you’re running a very EOL kernel (5.1.x)?




Comment 12


Thomas Deutschmann (RETIRED)






          2021-05-28 13:17:35 UTC
        

Your tv_sec/tv_nsec values are looking wrong/mixed. I have no idea what can cause this. I would start by rebuilding @system against up-to-date linux-headers (which should include glibc!). But just a blind guess...




Comment 13


James L. Hammons





          2021-05-28 14:10:41 UTC
        

Vis-a-vis the kernel, I didn't realize it was EOL'ed.  So the steps I'll take to try to resolve this are as follows:

1) Update kernel to latest stable version (gentoo-sources-5.10.27)
2) Rebuild @system as suggested.

Will update this bug once that's finished.




Comment 14


James L. Hammons





          2021-05-28 18:31:53 UTC
        

Well, after upgrading the kernel and rebuilding glibc and @system, nss builds and installs.  Thanks for the help in figuring this out.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

