Title: 727216 – No network on r8169 systems with Gentoo minimal install
URL: https://bugs.gentoo.org/show_bug.cgi?id=727216

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 727216
No network on r8169 systems with Gentoo minimal install
Last modified: 2020-06-05 13:11:06 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 727216 
      - No network on r8169 systems with Gentoo minimal install


Summary:
No network on r8169 systems with Gentoo minimal install
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Release Media




Classification:

Unclassified




Component:

InstallCD

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       critical
      


Assignee:

Gentoo Release Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-06-05 07:50 UTC by Martin Kuchta





      Modified:
    
2020-06-05 13:11 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



bkohler









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin Kuchta





          2020-06-05 07:50:18 UTC
        

Gen too minimal install currently suffers from a bug where genkernel does not correctly generate initramfs with realtek.ko loaded before r8169.ko. This makes network and hence the whole install image unusable on these systems.

Please see https://bugzilla.kernel.org/show_bug.cgi?id=204343




Comment 1


Ben Kohler






          2020-06-05 11:00:38 UTC
        

Which installcd is this?

AFAIK this issue was fixed already by disabling loading of NET modules by default in genkernel-4.  Even if net modules are to be loaded (for "dosshd" for example), this commit should have fixed realtek:

https://gitweb.gentoo.org/proj/genkernel.git/commit/?id=63f7d255e2dc2956f293f1e7f5f7b4c503951fb0

If this is still failing on a brand new installcd, please share the dmesg output.

(unloading & reloading r8169 can get you back online, to aid in sharing logs from the booted installcd)




Comment 2


Ben Kohler






          2020-06-05 11:08:34 UTC
        

I have just booted install-amd64-minimal-20200603T214508Z.iso and it does not load r8169 in initramfs




Comment 3


Martin Kuchta





          2020-06-05 13:08:43 UTC
        

This was install-amd64-minimal-20200531T214503Z.iso

However it gets a bit trickier than I thought.

Originally this system had some version on arch on it in the past. When I tried using the above installcd it would be posting same error messages in dmesg and exhibiting same behaviour as described in the kernel bug referenced above. Reloading the module did not help.

I had to resort to digging out an old install-amd64-minimal that I had lying around on an old laptop. Using this I compiled the r8169 and realtek in-kernel.

When I tried booting install-amd64-minimal-20200531T214503Z.iso now, after successfully running with the in-kernel drivers, the installcd boots fine!

Sorry, I didn't expect this twist. Feel free to close the bug as I can't prove it and you'd have to take my word for it.




Comment 4


Ben Kohler






          2020-06-05 13:11:06 UTC
        

I believe you that something happened and there was a failure.  I do not believe that it was the same as the kernel.org bug or the same problem you think it is.

I do not hold any of this against you, feel free to reopen the bug if you can reproduce this and provide logs =)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

