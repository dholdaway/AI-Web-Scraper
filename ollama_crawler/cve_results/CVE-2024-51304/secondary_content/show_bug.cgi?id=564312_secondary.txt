Title: 564312 – sys-devel/crossdev: parsing of repos.conf is failing
URL: https://bugs.gentoo.org/show_bug.cgi?id=564312

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 564312
sys-devel/crossdev: parsing of repos.conf is failing
Last modified: 2015-11-11 02:38:28 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 564312 
      - sys-devel/crossdev: parsing of repos.conf is failing


Summary:
sys-devel/crossdev: parsing of repos.conf is failing
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Embedded Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2015-10-28 12:16 UTC by Thomas Capricelli





      Modified:
    
2015-11-11 02:38 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



ahferroin7









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Thomas Capricelli





          2015-10-28 12:16:19 UTC
        

I'd like to get the avr cross-compiler. I've issued "crossdev avr" using sys-devel/crossdev-20150716 on an otherwise uptodate ~amd64 system. I've used crossdev before and it had mostly worked. this time i get this. The worrying part is the warning about no LIBC being available for this platform.


I tried removing all ebuild cross* created in my overlay and i removed /usr/avr/ to be sure to start from a clean env.


# crossdev avr
!!! Repository 'x-portage-overlay' is missing masters attribute in '/usr/portage-overlay/metadata/layout.conf'
!!! Set 'masters = gentoo' in this file for future compatibility
!!! Repository 'x-portage-overlay' is missing masters attribute in '/usr/portage-overlay/metadata/layout.conf'
!!! Set 'masters = gentoo' in this file for future compatibility
gawk: riga com.:8: (FILENAME=- FNR=1) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=5) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=14) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=22) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=30) attenzione: gensub: il terzo argomento `' trattato come 1
-------------------------------------------------------------------------------------------------------------------------------------------------------
 * crossdev version:      20150716
 * Host Portage ARCH:     amd64
 * Target Portage ARCH:   *
 * Target System:         avr
 * Stage:                 4 (C/C++ compiler)
 * ABIs:                  default
                                                                                                                                                       
 * binutils:              binutils-[latest]
 * gcc:                   gcc-[latest]
 * libc:                  avr-libc-[latest]

 * CROSSDEV_OVERLAY:      /usr/portage-overlay
 * PORT_LOGDIR:           /var/log/portage
 * PORTAGE_CONFIGROOT:    
 * Portage flags:         
  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  - 
 * enabling thin-manifests due to /var/lib/layman/qt
  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  - 
gawk: riga com.:8: (FILENAME=- FNR=1) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=5) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=11) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=20) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=28) attenzione: gensub: il terzo argomento `' trattato come 1
!!! WARNING - Cannot auto-configure CHOST avr;
!!! You should edit /usr/avr/etc/portage/make.conf
!!! by hand to complete your configuration.
!!!  No LIBC is known for this target.
 * Log: /var/log/portage/cross-avr-binutils.log
 * Emerging cross-binutils ...
^C
 * binutils failed :(
 * If you file a bug, please attach the following logfiles:
 * /var/log/portage/cross-avr-info.log
 * /var/log/portage/cross-avr-binutils.log.xz
 * /var/tmp/portage/cross-avr/binutils*/temp/binutils-config.logs.tar.xz
falco ~ # ll vi /usr/avr/etc/portage/make.conf 
ls: impossibile accedere a vi: File o directory non esistente
-rw-r--r-- 1 root root 482 28 ott 11.40 /usr/avr/etc/portage/make.conf
falco ~ # vi /usr/avr/etc/portage/make.conf    
falco ~ # eix crossdev
[I] sys-devel/crossdev
     Available versions:  20100814 20101011 20110310 20110705 20110819 (~)20111011 20111018 20111118 20111221 (~)20120214 (~)20120227 (~)20120228 (~)20120229 (~)20120301 20120305 (~)20120529 20120531 20120721 20120913 20130628 20131011 20131107 20140118 (~)20140729 20140917 20141030 (~)20150521 (~)20150525 (~)20150526 (~)20150527 20150602 (~)20150716 **99999999
     Installed versions:  20150716(13:26:30 12/09/2015)
     Homepage:            https://www.gentoo.org/
     Description:         Gentoo Cross-toolchain generator

falco ~ # lrt /usr/avr/
totale 12
drwxr-xr-x  3 root root 4096 15 feb  2014 etc
drwxr-xr-x 17 root root 4096 28 ott 11.40 ..
drwxr-xr-x  3 root root 4096 28 ott 11.40 .
falco ~ # rm -Rf^Cusr/avr/
falco ~ # tree /usr/avr/
/usr/avr/
└── etc
    └── portage
        ├── make.conf
        ├── make.profile -> /usr/portage/profiles/embedded
        └── profile
            └── package.provided

4 directories, 2 files
falco ~ # rm /usr/avr/ -Rf
falco ~ # crossdev avr
gawk: riga com.:8: (FILENAME=- FNR=1) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=5) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=11) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=20) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=28) attenzione: gensub: il terzo argomento `' trattato come 1
-------------------------------------------------------------------------------------------------------------------------------------------------------
 * crossdev version:      20150716
 * Host Portage ARCH:     amd64
 * Target Portage ARCH:   *
 * Target System:         avr
 * Stage:                 4 (C/C++ compiler)
 * ABIs:                  default

 * binutils:              binutils-[latest]
 * gcc:                   gcc-[latest]
 * libc:                  avr-libc-[latest]

 * CROSSDEV_OVERLAY:      /usr/portage-overlay
 * PORT_LOGDIR:           /var/log/portage
 * PORTAGE_CONFIGROOT:    
 * Portage flags:         
  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  - 
 * leaving sys-devel/binutils in /usr/portage-overlay
 * leaving sys-devel/gcc in /usr/portage-overlay
 * leaving dev-embedded/avr-libc in /usr/portage-overlay
 * leaving sys-devel/gdb in /usr/portage-overlay
 * enabling thin-manifests due to /var/lib/layman/qt
  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  -  ~  -  _  - 
gawk: riga com.:8: (FILENAME=- FNR=1) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=5) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=11) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=20) attenzione: gensub: il terzo argomento `' trattato come 1
gawk: riga com.:8: (FILENAME=- FNR=28) attenzione: gensub: il terzo argomento `' trattato come 1
!!! WARNING - Cannot auto-configure CHOST avr;
!!! You should edit /usr/avr/etc/portage/make.conf
!!! by hand to complete your configuration.
!!!  No LIBC is known for this target.
 * Log: /var/log/portage/cross-avr-binutils.log
 * Emerging cross-binutils ...                                                                                                                   [ ok ]
 * Log: /var/log/portage/cross-avr-gcc-stage1.log
 * Emerging cross-gcc-stage1 ...

(gcc failed, but that's another story)

Reproducible: Always




Comment 1


Austin S. Hemmelgarn





          2015-11-03 17:57:50 UTC
        

Same issue here.




Comment 2


SpanKY






          2015-11-10 19:02:58 UTC
        

please post the output of:
  portageq repositories_configuration /

also, the error here is not the LIBC line, it's gcc failing.  and that's probably a dupe of an existing bug (which is probably binutils at its heart).




Comment 3


Thomas Capricelli





          2015-11-10 19:06:17 UTC
        

There were lot of changes regarding all of this recently.
I've tested again after updating the tree, and it works now.




Comment 4


SpanKY






          2015-11-10 23:22:25 UTC
        

(In reply to Thomas Capricelli from comment #3)

can you post the output of that repos command ?  crossdev shouldn't be spewing gawk errors.




Comment 5


Thomas Capricelli





          2015-11-10 23:42:53 UTC
        

Sorry, i hadn't seen the question. Here it is :

[DEFAULT]
auto-sync = yes
main-repo = gentoo

[freehackers]
auto-sync = yes
location = /usr/portage-overlay
masters = gentoo
priority = 0

[gentoo]
auto-sync = yes
location = /usr/portage
masters = 
priority = -1000
sync-type = rsync
sync-uri = rsync://freehackers.org/gentoo-portage
sync-rsync-extra-opts = --exclude ChangeLog

[kde]
auto-sync = yes
location = /var/lib/layman/kde
masters = gentoo
priority = 50
sync-type = laymansync
sync-uri = git://anongit.gentoo.org/proj/kde.git

[qt]
auto-sync = yes
location = /var/lib/layman/qt
masters = gentoo
priority = 50
sync-type = laymansync
sync-uri = git://anongit.gentoo.org/proj/qt.git




Comment 6


SpanKY






          2015-11-11 01:19:44 UTC
        

thanks ... i think i fixed this in git, but haven't pushed a new snap yet:
http://gitweb.gentoo.org/proj/crossdev.git/commit/?id=ed170f96178b3e5060d6c7eecce79036b14c9f1e




Comment 7


Thomas Capricelli





          2015-11-11 02:38:28 UTC
        

I've modified (by hand) my /usr/bin/crossdev according to your patch, and i don't have the warning anymore. Great ! :)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

