Title: 535982 – app-editors/emacs-24.4-r1[motif]: emacsclient -c -a "": consumes CPU after window manager terminates
URL: https://bugs.gentoo.org/show_bug.cgi?id=535982

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 535982
app-editors/emacs-24.4-r1[motif]: emacsclient -c -a "": consumes CPU after window manager terminates
Last modified: 2015-01-12 00:26:02 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 535982 
      - app-editors/emacs-24.4-r1[motif]: emacsclient -c -a "": consumes CPU after window manager terminates


Summary:
app-editors/emacs-24.4-r1[motif]: emacsclient -c -a "": consumes CPU after wi...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Emacs project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2015-01-08 02:25 UTC by Javran Cheng





      Modified:
    
2015-01-12 00:26 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge info

              (info,17.70 KB,
                text/plain)

            
2015-01-08 09:38 UTC,

            Javran Cheng




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Javran Cheng





          2015-01-08 02:25:21 UTC
        

my window manager is xmonad, see "steps to reproduce" for detail.

related packages:

app-editors/emacs-24.4-r1:24  USE="X Xaw3d acl alsa dbus gif gpm gtk3 inotify jpeg motif png svg tiff xft xpm zlib (-aqua) -athena -games -gconf -gfile -gnutls -gsettings -gtk -gzip-el -hesiod -imagemagick -kerberos -libxml2 -livecd -m17n-lib -pax_kernel (-selinux) -sound -source -toolkit-scroll-bars -wide-int"
app-emacs/emacs-daemon-0.21



Reproducible: Always

Steps to Reproduce:
1. login and start emacs by `emacsclient -c -a ""`
2. log out (as xmonad's default behavior of logging out is simply terminating itself without sending any EWMH messages)

Actual Results:  
login using either X server or tty, and might find emacs taking one of the CPU core to full load, `emacsclient -c -a ""` shows "Waiting for Emacs..." and keep waiting forever.




Comment 1


Jeroen Roovers (RETIRED)






          2015-01-08 09:18:50 UTC
        

Please post your `emerge --info app-editors/emacs' output in a comment.




Comment 2


Javran Cheng





          2015-01-08 09:38:01 UTC
        

Created attachment 393462 [details]
emerge info




Comment 3


Ulrich Müller






          2015-01-08 22:25:39 UTC
        

I'm unable to reproduce the problem, neither by logging out (xfce4 here, though) nor by killing the Emacs window with xkill.

(In reply to Javran Cheng from comment #0)
> app-editors/emacs-24.4-r1:24  USE="X Xaw3d acl alsa dbus gif gpm gtk3
> inotify jpeg motif png svg tiff xft xpm zlib (-aqua) -athena -games -gconf
> -gfile -gnutls -gsettings -gtk -gzip-el -hesiod -imagemagick -kerberos
> -libxml2 -livecd -m17n-lib -pax_kernel (-selinux) -sound -source
> -toolkit-scroll-bars -wide-int"

Does the bug still occur if you build emacs with USE="-motif" (and all other flags unchanged)?




Comment 4


Javran Cheng





          2015-01-08 22:48:10 UTC
        

(In reply to Ulrich Müller from comment #3)
> I'm unable to reproduce the problem, neither by logging out (xfce4 here,
> though) nor by killing the Emacs window with xkill.
> 
> (In reply to Javran Cheng from comment #0)
> > app-editors/emacs-24.4-r1:24  USE="X Xaw3d acl alsa dbus gif gpm gtk3
> > inotify jpeg motif png svg tiff xft xpm zlib (-aqua) -athena -games -gconf
> > -gfile -gnutls -gsettings -gtk -gzip-el -hesiod -imagemagick -kerberos
> > -libxml2 -livecd -m17n-lib -pax_kernel (-selinux) -sound -source
> > -toolkit-scroll-bars -wide-int"
> 
> Does the bug still occur if you build emacs with USE="-motif" (and all other
> flags unchanged)?

the bug still occurs with USE="-motif", I notice the bug only occurs when xmoand quits with emacs window opened - if I close emacs when quiting, the bug doesn't occur. Can you try to kill the xfce4 session? I think loging out xfce4 would send close message to emacs so it gets terminated properly.




Comment 5


Javran Cheng





          2015-01-08 22:53:06 UTC
        

I have xfce4 installed, can confirm that if you "pkill -9 xfce4-session" and relogin, the bug would occur.




Comment 6


Ulrich Müller






          2015-01-08 23:55:05 UTC
        

I still cannot reproduce the problem. Setup here is:
- emacs-24.1-r1, USE flags identical to yours
- xfsession-4.11.0-r2, USE="nls upower xscreensaver -debug -systemd"
- xfwm4-4.11.2, USE="dri startup-notification xcomposite -debug"
- no ~/.emacs file
- empty X resources ("xrdb </dev/null")




Comment 7


Javran Cheng





          2015-01-09 01:06:25 UTC
        

(In reply to Ulrich Müller from comment #6)
> I still cannot reproduce the problem. Setup here is:
> - emacs-24.1-r1, USE flags identical to yours
> - xfsession-4.11.0-r2, USE="nls upower xscreensaver -debug -systemd"
> - xfwm4-4.11.2, USE="dri startup-notification xcomposite -debug"
> - no ~/.emacs file
> - empty X resources ("xrdb </dev/null")

weird, I'm using exactly the same version of packages & USE flags as yours.
I tried several combinations, the problem persisted with and without customization (~/.emacs.d/).
but after a reboot, suddenly the problem is gone. not sure if it has something to do with the -motif flag.




Comment 8


Ulrich Müller






          2015-01-12 00:26:02 UTC
        

Not much I can do if I cannot reproduce the problem. Therefore closing the bug, for the time being. Feel free to reopen when you see the problem again.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

