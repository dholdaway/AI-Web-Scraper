Title: 916636 – sys-devel/llvm-17.0.4: file RPATH_CHANGE could not write new RPATH: $ORIGIN/../lib64
URL: https://bugs.gentoo.org/show_bug.cgi?id=916636

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 916636
sys-devel/llvm-17.0.4: file RPATH_CHANGE could not write new RPATH: $ORIGIN/../lib64
Last modified: 2023-11-04 20:08:13 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 916636 
      - sys-devel/llvm-17.0.4: file RPATH_CHANGE could not write new RPATH: $ORIGIN/../lib64


Summary:
sys-devel/llvm-17.0.4: file RPATH_CHANGE could not write new RPATH: $ORIGIN/....
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

LLVM support project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2023-11-01 17:12 UTC by Kostadin Shishmanov





      Modified:
    
2023-11-04 20:08 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build log compressed with xz

              (build.log.xz,169.73 KB,
                application/x-xz)

            
2023-11-01 17:12 UTC,

            Kostadin Shishmanov




Details





another log where it fails at an other file

              (build2.log.xz,170.85 KB,
                application/x-xz)

            
2023-11-01 17:13 UTC,

            Kostadin Shishmanov




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Kostadin Shishmanov





          2023-11-01 17:12:06 UTC
        

Created attachment 873819 [details]
build log compressed with xz

sys-devel/llvm-17.0.4 fails to install each time at a different "subpackage" but with the same message:

CMake Error at cmake_install.cmake:55 (file):
  file RPATH_CHANGE could not write new RPATH:

    $ORIGIN/../lib64

  to the file:

    /var/tmp/portage/sys-devel/llvm-17.0.4/image/usr/lib/llvm/17/bin/llvm-libtool-darwin

  The file format is not recognized.
Call Stack (most recent call first):
  /var/tmp/portage/sys-devel/llvm-17.0.4/work/llvm_build-abi_x86_64.amd64/tools/cmake_install.cmake:247 (include)
  /var/tmp/portage/sys-devel/llvm-17.0.4/work/llvm_build-abi_x86_64.amd64/cmake_install.cmake:122 (include)


FAILED: tools/llvm-libtool-darwin/CMakeFiles/install-llvm-libtool-darwin /var/tmp/portage/sys-devel/llvm-17.0.4/work/llvm_build-abi_x86_64.amd64/tools/llvm-libtool-darwin/CMakeFiles/install-llvm-libtool-darwin 
cd /var/tmp/portage/sys-devel/llvm-17.0.4/work/llvm_build-abi_x86_64.amd64/tools/llvm-libtool-darwin && /usr/bin/cmake -DCMAKE_INSTALL_COMPONENT="llvm-libtool-darwin" -P /var/tmp/portage/sys-devel/llvm-17.0.4/work/llvm_build-abi_x86_64.amd64/cmake_install.cmake

all of llvm/clang is built with a custom env file with the following inside of it:

COMMON_FLAGS="-march=raptorlake -O2 -pipe -flto=thin"
CFLAGS="${COMMON_FLAGS}"
CXXFLAGS="${COMMON_FLAGS}"
LDFLAGS="-fuse-ld=lld -Wl,-O2,--as-needed"
CC="clang"
CXX="clang++"
AR="llvm-ar"
NM="llvm-nm"
RANLIB="llvm-ranlib"




Comment 1


Kostadin Shishmanov





          2023-11-01 17:12:20 UTC
        

Portage 3.0.54 (python 3.11.5-final-0, default/linux/amd64/17.1/desktop/plasma/systemd/merged-usr, gcc-14, glibc-2.37-r7, 6.6.0-gentoo x86_64)
=================================================================
System uname: Linux-6.6.0-gentoo-x86_64-13th_Gen_Intel-R-_Core-TM-_i5-13600KF-with-glibc2.37
KiB Mem:    16243504 total,   9025772 free
KiB Swap:   16242684 total,  14295676 free
Timestamp of repository gentoo: Wed, 01 Nov 2023 11:31:54 +0000
Head commit of repository gentoo: 21127bc1acb7bdb2e4bee8f06801d5c425119998

Head commit of repository brave-overlay: d9ffc8d9b19dc3eee282a6bbe334f1e40c8be5ca

Timestamp of repository guru: Wed, 01 Nov 2023 08:16:46 +0000
Head commit of repository guru: 49c6bcbfeb51b41a748388e16997bcfc944b20ea

Timestamp of repository steam-overlay: Mon, 30 Oct 2023 19:02:02 +0000
Head commit of repository steam-overlay: c738cf4be600cc674dd666d9dc0ac50f0bc87067

sh bash 5.1_p16-r6
ld GNU ld (Gentoo 2.40 p5) 2.40.0
app-misc/pax-utils:        1.3.5::gentoo
app-shells/bash:           5.1_p16-r6::gentoo
dev-java/java-config:      2.3.1-r1::gentoo
dev-lang/perl:             5.38.0-r1::gentoo
dev-lang/python:           3.11.5::gentoo
dev-lang/rust:             1.73.0::gentoo
dev-util/cmake:            3.27.7::gentoo
dev-util/meson:            1.2.1-r1::gentoo
sys-apps/baselayout:       2.14::gentoo
sys-apps/sandbox:          2.38::gentoo
sys-apps/systemd:          254.5::gentoo
sys-devel/autoconf:        2.13-r7::gentoo, 2.71-r6::gentoo
sys-devel/automake:        1.16.5-r1::gentoo
sys-devel/binutils:        2.40-r5::gentoo
sys-devel/binutils-config: 5.5::gentoo
sys-devel/clang:           17.0.3::gentoo
sys-devel/gcc:             14.0.0_pre20231029::gentoo
sys-devel/gcc-config:      2.11::gentoo
sys-devel/libtool:         2.4.7-r1::gentoo
sys-devel/lld:             17.0.3::gentoo
sys-devel/llvm:            17.0.3::gentoo
sys-devel/make:            4.4.1-r1::gentoo
sys-kernel/linux-headers:  6.1::gentoo (virtual/os-headers)
sys-libs/glibc:            2.37-r7::gentoo
Repositories:

gentoo
    location: /var/db/repos/gentoo
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/gentoo.git
    priority: -1000
    volatile: False

brave-overlay
    location: /var/db/repos/brave-overlay
    sync-type: git
    sync-uri: https://gitlab.com/jason.oliveira/brave-overlay.git
    masters: gentoo
    volatile: False

guru
    location: /var/db/repos/guru
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/guru.git
    masters: gentoo
    volatile: False

local
    location: /var/db/repos/local
    masters: gentoo
    volatile: False

steam-overlay
    location: /var/db/repos/steam-overlay
    sync-type: git
    sync-uri: https://github.com/gentoo-mirror/steam-overlay.git
    masters: gentoo
    volatile: False

Binary Repositories:

gentoobinhost
    priority: 1
    sync-uri: https://gentoo.osuosl.org/releases/amd64/binpackages/17.1/x86-64

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=raptorlake -O2 -pipe -flto=auto -Werror=odr -Werror=lto-type-mismatch -Werror=strict-aliasing"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d"
CXXFLAGS="-march=raptorlake -O2 -pipe -flto=auto -Werror=odr -Werror=lto-type-mismatch -Werror=strict-aliasing"
DISTDIR="/var/cache/distfiles"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GDK_PIXBUF_MODULE_FILE GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR XDG_STATE_HOME"
FCFLAGS="-march=raptorlake -O2 -pipe -flto=auto -Werror=odr -Werror=lto-type-mismatch -Werror=strict-aliasing"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs binpkg-multi-instance buildpkg-live config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox pkgdir-index-trusted preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-march=raptorlake -O2 -pipe -flto=auto -Werror=odr -Werror=lto-type-mismatch -Werror=strict-aliasing"
GENTOO_MIRRORS="http://tux.rainside.sk/gentoo/     http://gentoo.mirror.root.lu/     ftp://tux.rainside.sk/gentoo/     http://ftp.vectranet.pl/gentoo/"
LANG="en_GB.utf8"
LDFLAGS="-Wl,-O1,--as-needed -Werror=odr -Werror=lto-type-mismatch -Werror=strict-aliasing"
LEX="flex"
MAKEOPTS="-j20 -l20"
PKGDIR="/var/cache/binpkgs"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
RUSTFLAGS="-C target-cpu=raptorlake -C opt-level=2"
SHELL="/bin/bash"
USE="X aac acl acpi activities amd64 branding bzip2 cairo cdr cli crypt cups dbus declarative dri dvdr encode exif flac fortran gdbm gif gtk gui iconv icu jpeg kde kwallet lcms libnotify libtirpc mad mng mp3 mp4 mpeg multilib ncurses networkmanager nls nptl ogg opengl openmp pam pango pcre pdf pipewire plasma png policykit ppds pulseaudio qml qt5 readline screencast sdl seccomp sound ssl startup-notification svg systemd test-rust tiff truetype udev udisks unicode upower usb vaapi vulkan wayland widgets wxwidgets x264 xattr xcb xft xml xv zlib zstd" ABI_X86="64" ADA_TARGET="gnat_2021" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext sse sse2 aes avx avx2 f16c fma3 pclmul popcnt rdrand sha sse3 sse4_1 sse4_2 ssse3" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" GRUB_PLATFORMS="efi-64" INPUT_DEVICES="libinput" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php8-1" POSTGRES_TARGETS="postgres15" PYTHON_SINGLE_TARGET="python3_11" PYTHON_TARGETS="python3_11" RUBY_TARGETS="ruby31" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq proto steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  ADDR2LINE, AR, ARFLAGS, AS, ASFLAGS, CC, CCLD, CONFIG_SHELL, CPP, CPPFLAGS, CTARGET, CXX, CXXFILT, ELFEDIT, EMERGE_DEFAULT_OPTS, EXTRA_ECONF, F77FLAGS, FC, GCOV, GPROF, INSTALL_MASK, LC_ALL, LD, LFLAGS, LIBTOOL, LINGUAS, MAKE, MAKEFLAGS, NM, OBJCOPY, OBJDUMP, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, RANLIB, READELF, SIZE, STRINGS, STRIP, YACC, YFLAGS




Comment 2


Kostadin Shishmanov





          2023-11-01 17:13:00 UTC
        

Created attachment 873820 [details]
another log where it fails at an other file




Comment 3


Kostadin Shishmanov





          2023-11-01 17:15:04 UTC
        

(In reply to Kostadin Shishmanov from comment #2)
> Created attachment 873820 [details]
> another log where it fails at an other file

Forgot to add that in the second log i built llvm with commented AR, NM and RANLIB from the env file, so it should've used GCC's ones




Comment 4


Kostadin Shishmanov





          2023-11-04 20:08:13 UTC
        

It has started installing fine all of a sudden. Initially, I thought it might be because most of my system was still on stable, then I moved to ~amd64, tried to rebuild llvm again, didn't work with the same issue. And now it has started installing fine all of a sudden.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

