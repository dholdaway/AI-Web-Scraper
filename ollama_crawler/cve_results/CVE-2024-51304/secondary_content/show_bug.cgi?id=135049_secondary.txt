Title: 135049 – kdelibs-3.5.2-r6 doesn't compile in /khtml
URL: https://bugs.gentoo.org/show_bug.cgi?id=135049

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 135049
kdelibs-3.5.2-r6 doesn't compile in /khtml
Last modified: 2006-06-02 09:10:20 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 135049 
      - kdelibs-3.5.2-r6 doesn't compile in /khtml


Summary:
kdelibs-3.5.2-r6 doesn't compile in /khtml
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       minor
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-05-31 08:16 UTC by Raphael Marichez (Falco) (RETIRED)





      Modified:
    
2006-06-02 09:10 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



biowooolf









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Raphael Marichez (Falco) (RETIRED)






          2006-05-31 08:16:24 UTC
        

Hi,

i've a compilation problem while emerging kdelibs for ~x86 (stable gcc)

i don't find the error, i can't explain the problem.

Since i have few kde applications installed (knode, kmail, and dependencies), this may be a dependencies problem.

make[3]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2/khtml/ecma'
Making all in .
make[3]: Entering directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2/khtml'

(...)

/usr/qt/3/bin/moc htmlpageinfo.h -o htmlpageinfo.moc
rm -f htmlpageinfo.cc
echo '#include <kdialog.h>' > htmlpageinfo.cc
echo '#include <klocale.h>' >> htmlpageinfo.cc
/usr/qt/3/bin/uic -nounload -tr tr2i18n -i htmlpageinfo.h ./htmlpageinfo.ui > htmlpageinfo.cc.temp ; ret=$?; \
/usr/bin/perl -pe "s,tr2i18n( \"\" ),QString::null,g" htmlpageinfo.cc.temp | /usr/bin/perl -pe "s,tr2i18n( \"\"\, \"\" ),QString::null,g" | /usr/bin/perl -pe "s,image([0-9][0-9]*)_data,img\$1_htmlpageinfo,g" | /usr/bin/perl -pe "s,: QWizard\(,: KWizard(,g" >> htmlpageinfo.cc ;\
rm -f htmlpageinfo.cc.temp ;\
if test "$ret" = 0; then echo '#include "htmlpageinfo.moc"' >> htmlpageinfo.cc; else rm -f htmlpageinfo.cc ; exit $ret ; fi
/bin/sh ../libtool --silent --tag=CXX --mode=compile i686-pc-linux-gnu-g++ -DHAVE_CONFIG_H -I. -I. -I.. -I../dcop -I../kdecore -I../kio/kssl -I../kjs -I../kjs -I../kjs -I../kimgio -I./java -I../dcop -I./misc -I./dom -I./xml -I./html -I./css -I../libltdl -I../kio/kssl -I../kio/kssl -I../kdeprint -I../interfaces -I../interfaces/kregexpeditor -I../kwallet/client -I../kutils -I.. -I../dcop -I../libltdl -I../kdefx -I../kdecore -I../kdecore -I../kdeui -I../kio -I../kio/kio -I../kio/kfile -I.. -I/usr/qt/3/include -I. -I/usr/kde/3.5/include   -DQT_THREAD_SUPPORT  -D_REENTRANT  -Wno-long-long -Wundef -ansi -D_XOPEN_SOURCE=500 -D_BSD_SOURCE -Wcast-align -Wconversion -Wchar-subscripts -Wall -W -Wpointer-arith -DNDEBUG -DNO_DEBUG -O2 -O2 -march=pentium3 -pipe -fomit-frame-pointer -frename-registers -g -Wformat-security -Wmissing-format-attribute -Wno-non-virtual-dtor -fno-exceptions -fno-check-new -fno-common  -DQT_CLEAN_NAMESPACE -DQT_NO_ASCII_CAST -DQT_NO_STL -DQT_NO_COMPAT -DQT_NO_TRANSLATION  -c -o htmlpageinfo.lo htmlpageinfo.cc
/bin/sh ../libtool --silent --tag=CXX --mode=link i686-pc-linux-gnu-g++  -Wno-long-long -Wundef -ansi -D_XOPEN_SOURCE=500 -D_BSD_SOURCE -Wcast-align -Wconversion -Wchar-subscripts -Wall -W -Wpointer-arith -DNDEBUG -DNO_DEBUG -O2 -O2 -march=pentium3 -pipe -fomit-frame-pointer -frename-registers -g -Wformat-security -Wmissing-format-attribute -Wno-non-virtual-dtor -fno-exceptions -fno-check-new -fno-common  -DQT_CLEAN_NAMESPACE -DQT_NO_ASCII_CAST -DQT_NO_STL -DQT_NO_COMPAT -DQT_NO_TRANSLATION    -o libkhtml.la -rpath /usr/kde/3.5/lib -version-info 6:0:2 -no-undefined -Wl,--no-undefined -Wl,--allow-shlib-undefined -Wl,--version-script=./libkhtml.map -L/usr/kde/3.5/lib -L/usr/qt/3/lib -L/usr/lib    khtmlview.lo khtml_part.lo khtml_run.lo khtml_factory.lo khtml_settings.lo khtml_events.lo khtml_ext.lo khtml_pagecache.lo khtml_iface.lo khtml_printsettings.lo khtmlimage.lo khtml_iface_skel.lo kjserrordlg.lo htmlpageinfo.lo ./xml/libkhtmlxml.la ./html/libkhtmlhtml.la ./rendering/libkhtmlrender.la ./css/libkhtmlcss.la ./misc/libkhtmlmisc.la ecma/libkjs_html.la ./dom/libkhtmldom.la  ../kparts/libkparts.la  ../kdeprint/libkdeprint.la ../kutils/libkutils.la ../kwallet/client/libkwalletclient.la
collect2: ld returned 1 exit status
make[3]: *** [libkhtml.la] Error 1
make[3]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2/khtml'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2/khtml'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2'
make: *** [all] Error 2

!!! ERROR: kde-base/kdelibs-3.5.2-r6 failed.
Call stack:
  ebuild.sh, line 1531:   Called dyn_compile
  ebuild.sh, line 931:   Called src_compile
  kdelibs-3.5.2-r6.ebuild, line 127:   Called kde_src_compile
  kde.eclass, line 143:   Called kde_src_compile 'all'
  kde.eclass, line 276:   Called kde_src_compile 'myconf' 'configure' 'make'
  kde.eclass, line 272:   Called die

!!! died running emake, kde_src_compile:make



Portage 2.1_rc3-r2 (default-linux/x86/2006.0, gcc-3.4.6, glibc-2.3.6-r3, 2.6.17-rc1-lufs i686)
=================================================================
System uname: 2.6.17-rc1-lufs i686 Intel(R) Pentium(R) M processor 1400MHz
Gentoo Base System version 1.12.0_pre19
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.3 [disabled]
dev-lang/python:     2.4.2
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1-r2
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-Os -march=pentium3 -pipe -fomit-frame-pointer -frename-registers -g"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-Os -march=pentium3 -pipe -fomit-frame-pointer -frename-registers -g"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict userpriv"
GENTOO_MIRRORS="http://gentoo.mirror.sdv.fr/ http://trumpetti.atm.tut.fi/gentoo/ http://gentoo.oregonstate.edu http://www.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_EXTRA_OPTS=" --exclude-from=/etc/portage/rsync_excludes --timeout=5 "
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="x86 X alsa apache2 apm avi bitmap-fonts cli crypt cups dri eds emboss encode ffmpeg flac foomaticdb fortran gdbm gpm gstreamer gtk gtk2 imap imlib isdnlog jpeg kde libg++ libwww mad maildir mbox mikmod mmx motif mp3 mpeg nas ncurses nls nptl ogg opengl oss pam pcmcia pcre pdflib perl png pppd python qt quicktime readline reflection sdl session socks5 spell spl sse ssl tcpd truetype truetype-fonts type1-fonts udev vorbis xinerama xml xmms xorg xv zlib elibc_glibc kernel_linux userland_GNU"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS



emerge -pv kdelibs :
[ebuild     U ]  kde-base/kdelibs-3.5.2-r6 [3.5.2-r5] USE="alsa cups spell ssl xinerama -acl -arts -debug -doc -jpeg2k -kdeenablefinal -kdehiddenvisibility% -kerberos -legacyssl -openexr -tiff -zeroconf" 0 kB




Comment 1


Todd Marimon





          2006-05-31 12:47:29 UTC
        

Same problem here. I'm running on a Pentium2, and recently upgraded to gcc-4.1.1 (I believe it's being unmasked very soon anyway)

Error:
kjs_binding.cpp:(.text+0x2801): undefined reference to `__cxa_get_exception_ptr'
ecma/.libs/libkjs_html.a(kjs_binding.o): In function `KJS::DOMFunction::get(KJS::ExecState*, KJS::Identifier const&) const':
kjs_binding.cpp:(.text+0x2b83): undefined reference to `__cxa_get_exception_ptr'
ecma/.libs/libkjs_html.a(kjs_binding.o):kjs_binding.cpp:(.text+0x2f06): more undefined references to `__cxa_get_exception_ptr' follow
collect2: ld returned 1 exit status
make[3]: *** [libkhtml.la] Error 1
make[3]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2/khtml'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2/khtml'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2'
make: *** [all] Error 2

!!! ERROR: kde-base/kdelibs-3.5.2-r6 failed.
!!! Function kde_src_compile, Line 272, Exitcode 2
!!! died running emake, kde_src_compile:make
!!! If you need support, post the topmost build error, NOT this status message.

emerge info:
Portage 2.0.54-r2 (default-linux/x86/2005.1, gcc-4.1.1, glibc-2.3.6-r3, 2.6.15-gentoo-r1 i686)
=================================================================
System uname: 2.6.15-gentoo-r1 i686 Celeron (Mendocino)
Gentoo Base System version 1.6.14
dev-lang/python:     2.3.5-r2, 2.4.2
dev-python/pycrypto: [Not Present]
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=pentium2 -mtune=pentium2 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde
/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /usr/spool/PBS"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=pentium2 -mtune=pentium2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X acpi aim alsa apache2 arts audiofile avi berkdb big-tables bitmap-fonts browserplugin bzip2 cdr cli 
crypt cups curl dedicated dri eds emacs emboss encode esd exif expat fam ffmpeg flash foomaticdb fortran ftp gd
 gdbm gif glut gmp gnome gpm gstreamer gtk gtk2 gtkhtml idn imagemagick imap imlib ipv6 isdnlog java jpeg kde l
cms libg++ libwww mad mhash mikmod ming mmx mng motif mozilla mp3 mpeg mysql ncurses nls nptl offensive ogg ogg
vorbis opengl oss pam pcre pdflib perl php png pppd python qt quicktime readline reflection ruby samba sdl sess
ion snmp soap spell spl ssl tcltk tcpd tiff truetype truetype-fonts type1-fonts udev vorbis xml xml2 xmms xorg xsl xv yahoo zlib userland_GNU kernel_linux elibc_glibc"
Unset:  CTARGET, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS, PORTAGE_RSYNC_OPTS, PORTDIR_OVERLAY

Please fix this asap. It's holding back a lot of upgrades for me, which I want to complete soon in order to recompile the whole system with gcc-4.1.1.




Comment 2


Raphael Marichez (Falco) (RETIRED)






          2006-06-01 07:36:51 UTC
        

i have continued the "emerge world" with the other packages, in particular :
tiff
baselayout
glibmm
libglademm
kuickshow
kphone
qt-4.1.3 (which has failed with the same issue, "collect2: ld")

then i have continued with :
nss
echant
sys-libs/lib-compat-1.4.1 (from sys-libs/lib-compat-1.4)

Then QT succeded, then kdelibs finally succeded.

I suppose the upgrade of lib-compat has relation with this.

is it possible there would be a problem between kdelibs-3.5.2-r6 or qt-4.1.2 and the old lib-compat-1.4 ?


To Todd: apparently you have not the same problem. Since you have the ~ gcc (recently unmasked indeed), it may be very different.





Comment 3


Todd Marimon





          2006-06-01 10:40:24 UTC
        

I'm going to try emerging tiff, lib-compat, and qt. As of right now, I don't actually have lib-compat and qt installed. I don't actually use KDE on my system (I use fluxbox), but I use a few apps from kde, such as kdevelope.

So, I'll see if emerging these things will help compile kdelibs.




Comment 4


Gregorio Guidi (RETIRED)






          2006-06-01 13:01:56 UTC
        

The problem in comment 1 is different, see bug 123065.
It seems the original problem is not reproducible anymore, closing for now.




Comment 5


Kaji Ryoji





          2006-06-01 23:26:41 UTC
        

Yeah, it's defenetly lib-compat dependency issue! 
I had a similar compile error which has gone after emerging lib-compat:
----
/bin/sh ../../libtool --silent --tag=CXX --mode=compile i686-pc-linux-gnu-g++ -DHAVE_CONFIG_H -I. -I. -I../.. -I../../dcop -I../../kdecore -I../../kio/kssl -I../../kjs -I../../kimgio -I../../kio -I../../dcop -I../../khtml -I../.. -I../../kwallet/client -I../../kutils -I../../kjs -I../../dcop -I../../libltdl -I../../kdefx -I../../kdecore -I../../kdecore -I../../kdeui -I../../kio -I../../kio/kio -I../../kio/kfile -I../.. -I/usr/qt/3/include -I. -I/usr/kde/3.5/include   -DQT_THREAD_SUPPORT  -D_REENTRANT  -Wno-long-long -Wundef -ansi -D_XOPEN_SOURCE=500 -D_BSD_SOURCE -Wcast-align -Wconversion -Wchar-subscripts -Wall -W -Wpointer-arith -DNDEBUG -DNO_DEBUG -O2 -O2 -march=i686 -pipe -Wformat-security -Wmissing-format-attribute -Wno-non-virtual-dtor -fno-exceptions -fno-check-new -fno-common  -DQT_CLEAN_NAMESPACE -DQT_NO_ASCII_CAST -DQT_NO_STL -DQT_NO_COMPAT -DQT_NO_TRANSLATION  -c -o dom_nodeimpl.lo dom_nodeimpl.cpp
dom_nodeimpl.cpp: In member function `virtual DOM::NodeImpl* DOM::NodeListImpl::item(long unsigned int) const':
dom_nodeimpl.cpp:1578: warning: comparison between signed and unsigned integer expressions
dom_nodeimpl.cpp: In member function `virtual DOM::NodeImpl* DOM::NodeBaseImpl::appendChild(DOM::NodeImpl*, int&)':
dom_nodeimpl.cpp:1265: internal compiler error: in final_scan_insn, at final.c:1790
Please submit a full bug report,
with preprocessed source if appropriate.
See <URL:http://bugs.gentoo.org/> for instructions.
The bug is not reproducible, so it is likely a hardware or OS problem.
make[3]: *** [dom_nodeimpl.lo] Error 1
make[3]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2/khtml/xml'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2/khtml'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/kdelibs-3.5.2-r6/work/kdelibs-3.5.2'
make: *** [all] Error 2
----




Comment 6


Todd Marimon





          2006-06-02 09:10:20 UTC
        

Ok, problem fixed. Apparently, I didn't actually upgrade gcc properly. Now that I've done so it compiles just fine. Just follow the guide here: http://www.gentoo.org/doc/en/gcc-upgrading.xml and you should be all set.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

