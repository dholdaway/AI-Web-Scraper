Title: 171612 – gentoo-sources-2.6.19-gentoo-r5 fails under stage3 uclibc (gettext error)
URL: https://bugs.gentoo.org/show_bug.cgi?id=171612

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 171612
gentoo-sources-2.6.19-gentoo-r5 fails under stage3 uclibc (gettext error)
Last modified: 2007-03-21 05:09:18 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 171612 
      - gentoo-sources-2.6.19-gentoo-r5 fails under stage3 uclibc (gettext error)


Summary:
gentoo-sources-2.6.19-gentoo-r5 fails under stage3 uclibc (gettext error)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Embedded Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-03-20 21:05 UTC by James Crow





      Modified:
    
2007-03-21 05:09 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


James Crow





          2007-03-20 21:05:50 UTC
        

While trying to setup an embedded Gentoo the kernel fails when running make menuconfig. Google shows that it is a gettext error. I have gettext installed.

Reproducible: Always

Steps to Reproduce:
1. Download/unzip stage3-x86-uclibc-2006.1.tar.bz2; chroot
2. emerge gentoo-sources
3. cd /usr/src/linux; make menuconfig

Actual Results:  
(chroot) localhost linux-2.6.19-gentoo-r5 # make menuconfig
  HOSTLD  scripts/kconfig/mconf
scripts/kconfig/mconf.o: In function `show_help':
mconf.c:(.text+0x847): undefined reference to `libintl_gettext'
scripts/kconfig/mconf.o: In function `conf':
mconf.c:(.text+0x916): undefined reference to `libintl_gettext'
mconf.c:(.text+0x9a1): undefined reference to `libintl_gettext'
mconf.c:(.text+0x9d0): undefined reference to `libintl_gettext'
mconf.c:(.text+0x9f0): undefined reference to `libintl_gettext'
scripts/kconfig/mconf.o:mconf.c:(.text+0xa20): more undefined references to `libintl_gettext' follow
scripts/kconfig/mconf.o: In function `main':
mconf.c:(.text+0x10e7): undefined reference to `libintl_bindtextdomain'
mconf.c:(.text+0x10f3): undefined reference to `libintl_textdomain'
mconf.c:(.text+0x1136): undefined reference to `libintl_gettext'
mconf.c:(.text+0x12fc): undefined reference to `libintl_gettext'
mconf.c:(.text+0x1339): undefined reference to `libintl_gettext'
mconf.c:(.text+0x1365): undefined reference to `libintl_gettext'
mconf.c:(.text+0x138e): undefined reference to `libintl_gettext'
scripts/kconfig/zconf.tab.o:zconf.tab.c:(.text+0x4162): more undefined references to `libintl_gettext' follow
collect2: ld returned 1 exit status
make[1]: *** [scripts/kconfig/mconf] Error 1
make: *** [menuconfig] Error 2


Expected Results:  
Kernel configuration

linux-2.6.19-gentoo-r5 # emerge -pv gentoo-sources gettext

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] sys-kernel/gentoo-sources-2.6.19-r5  USE="-build -symlink" 0 kB
[ebuild   R   ] sys-devel/gettext-0.16.1  USE="-doc -emacs (-nls) -nocxx" 0 kB

Total: 2 packages (2 reinstalls), Size of downloads: 0 kB

linux-2.6.19-gentoo-r5 # emerge --info
Portage 2.1.2.2 (uclibc/x86, gcc-4.1.1, uclibc-0.9.28.1-r0, 2.6.19-gentoo-r5 i686)
=================================================================
System uname: 2.6.19-gentoo-r5 i686 Intel(R) Pentium(R) 4 CPU 3.20GHz
Gentoo Base System release 1.12.9
Timestamp of tree: Mon, 19 Mar 2007 11:30:01 +0000
ccache version 2.4 [enabled]
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.6.3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i386-gentoo-linux-uclibc"
CFLAGS="-Os -pipe"
CHOST="i386-gentoo-linux-uclibc"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/mozilla/defaults/pref /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/terminfo"
CXXFLAGS="-Os -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg ccache distlocks metadata-transfer nodoc noinfo noman sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LDFLAGS="-Wl,-z,relro"
PKGDIR="/packages/uclibc"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X aac alsa amr bitmap-fonts cdparanoia cli cpudetection cracklib dri dv dvd dvdread encode flac gif jpeg midi minimal ncurses ogg pcre png readline reflection rtc sdl session speex spl theora truetype-fonts type1-fonts uclibc v4l v4l2 vorbis win32codecs x86 xorg xv xvid xvmc zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="uclibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="fbdev v4l trident vesa vga via s3 s3virge chip cirrus"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LINGUAS, MAKEOPTS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


solar (RETIRED)






          2007-03-20 22:43:32 UTC
        

I used the following to work around it. 

--- scripts/kconfig/mconf.c     2007-02-14 02:42:28 +0000
+++ scripts/kconfig/mconf.c     2007-03-07 19:23:43 +0000
@@ -863,11 +863,11 @@
   struct symbol *sym;
   char *mode;
   int res;
-
+#if 0
   setlocale(LC_ALL, "");
   bindtextdomain(PACKAGE, LOCALEDIR);
   textdomain(PACKAGE);
-
+#endif
   conf_parse(av[1]);
   conf_read(NULL);
 
--- scripts/kconfig/lkc.h       2007-02-14 02:42:28 +0000
+++ scripts/kconfig/lkc.h       2007-03-07 19:09:48 +0000
@@ -34,7 +34,7 @@
 #define PACKAGE "linux"
 #define LOCALEDIR "/usr/share/locale"
 
-#define _(text) gettext(text)
+#define _(text) text
 #define N_(text) (text)
 
 
-------

The kernel is supposed to support NLS on/off switching or so.

Try with "-DKBUILD_NO_NLS" in HOSTCFLAGS,CFLAGS




Comment 2


SpanKY






          2007-03-21 05:09:18 UTC
        

there's nothing to be done in the portage tree about this ... patches go to mainline, not into our kernel sources ...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

