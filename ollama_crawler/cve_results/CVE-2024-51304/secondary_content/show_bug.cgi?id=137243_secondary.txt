Title: 137243 – revdep-rebuild asks for openldap endlessly
URL: https://bugs.gentoo.org/show_bug.cgi?id=137243

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 137243
revdep-rebuild asks for openldap endlessly
Last modified: 2007-02-13 11:39:57 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 137243 
      - revdep-rebuild asks for openldap endlessly


Summary:
revdep-rebuild asks for openldap endlessly
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo LDAP project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-06-19 03:51 UTC by Ilya Hegai





      Modified:
    
2007-02-13 11:39 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



esigra









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (info.txt,2.75 KB,
                text/plain)

            
2006-06-19 03:55 UTC,

            Ilya Hegai




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ilya Hegai





          2006-06-19 03:51:02 UTC
        

after upgrading from net-nds/openldap-2.2.28-r3 to net-nds/openldap-2.3.24-r1
revdep-rebuild -pv --library liblber-2.2.so.7 asks for rebuilding openldap itself endlessly




Comment 1


Ilya Hegai





          2006-06-19 03:55:30 UTC
        

Created attachment 89520 [details]
emerge --info




Comment 2


Carsten Lohrke (RETIRED)






          2006-06-19 04:16:28 UTC
        

Of course it does. Assuming the ebuild's postistall information is misleading!?




Comment 3


Markus Ullmann (RETIRED)






          2006-07-17 13:23:58 UTC
        

Yep, you have to remove the libs by hand as said in the instructions, it is safe to do so.

As it keeps the lib if the file exists, it tells you that over and over again.

There's no other option for it, sorry :(
We'd end up breaking updater's boxes if we change something (back)...

Resolving as worksforme for the solution given




Comment 4


Markus Ullmann (RETIRED)






          2006-07-17 14:03:47 UTC
        

Well after thinking about it again, I'll implement a has_version >2.3 for it. So that way we keep libs if unless we're updating within the 2.3 branch




Comment 5


Erik





          2007-02-13 11:39:57 UTC
        

This does not work for me. I got these instructions at the end of "emerge openldap":
 * Old versions of installed libraries were detected on your system.
 * In order to avoid breaking packages that depend on these old libs,
 * the libraries are not being removed.  You need to run revdep-rebuild
 * in order to remove these old dependencies.  If you do not have this
 * helper program, simply emerge the 'gentoolkit' package.
 *
 *   # revdep-rebuild --library libldap.so.2.0.130
 * Old versions of installed libraries were detected on your system.
 * In order to avoid breaking packages that depend on these old libs,
 * the libraries are not being removed.  You need to run revdep-rebuild
 * in order to remove these old dependencies.  If you do not have this
 * helper program, simply emerge the 'gentoolkit' package.
 *
 *   # revdep-rebuild --library libldap_r.so.2.0.130
 * Old versions of installed libraries were detected on your system.
 * In order to avoid breaking packages that depend on these old libs,
 * the libraries are not being removed.  You need to run revdep-rebuild
 * in order to remove these old dependencies.  If you do not have this
 * helper program, simply emerge the 'gentoolkit' package.
 *
 *   # revdep-rebuild --library libldap-2.2.so.7
 * Old versions of installed libraries were detected on your system.
 * In order to avoid breaking packages that depend on these old libs,
 * the libraries are not being removed.  You need to run revdep-rebuild
 * in order to remove these old dependencies.  If you do not have this
 * helper program, simply emerge the 'gentoolkit' package.
 *
 *   # revdep-rebuild --library libldap_r-2.2.so.7

I executed all the requested revdep-rebuild commands, made sure that there are no old versions of those libraries and emerged openldap again. But still revdep-rebuild wants to emerge openldap endlessly.
# revdep-rebuild -pv
Configuring search environment for revdep-rebuild

Checking reverse dependencies...

Packages containing binaries and libraries broken by a package update
will be emerged.

Collecting system binaries and libraries... using existing /root/.revdep-rebuild.1_files.

Collecting complete LD_LIBRARY_PATH... using existing /root/.revdep-rebuild.2_ldpath.

Checking dynamic linking consistency...
  broken /usr/lib/libldap-2.2.so.7 (requires  liblber-2.2.so.7)
  broken /usr/lib/libldap_r-2.2.so.7 (requires  liblber-2.2.so.7)
  broken /usr/lib/libldap_r.so.2.0.130 (requires  liblber.so.2)
  broken /usr/lib/libldap.so.2.0.130 (requires  liblber.so.2)
  broken /usr/lib/gcc/i686-pc-linux-gnu/3.4.6/lib-org-w3c-dom.la (requires /usr/lib/libgcj.la)
  broken /usr/lib/gcc/i686-pc-linux-gnu/3.4.6/lib-org-xml-sax.la (requires /usr/lib/libgcj.la)
  broken /usr/lib/gcc/i686-pc-linux-gnu/4.1.1/libgij.la (requires /usr/lib/libgcj.la)
 done.
  (/root/.revdep-rebuild.3_rebuild)

Assigning files to ebuilds... done.
  (/root/.revdep-rebuild.4_ebuilds)

Evaluating package order... done.
  (/root/.revdep-rebuild.5_order)

All prepared. Starting rebuild...
emerge --oneshot -pv =net-nds/openldap-2.3.30-r2 =sys-devel/gcc-4.1.1-r3 =sys-devel/gcc-3.4.6-r2
..........

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] net-nds/openldap-2.3.30-r2  USE="berkdb crypt ipv6 kerberos odbc perl readline samba sasl slp ssl tcpd -debug -gdbm -minimal -overlays (-selinux) -smbkrb5passwd" 0 kB
[ebuild   R   ] sys-devel/gcc-4.1.1-r3  USE="doc fortran gcj nls (-altivec) -bootstrap -build -gtk (-hardened) -ip28 -ip32r10k -mudflap (-multilib) -multislot (-n32) (-n64) -nocxx -objc -objc++ -objc-gc -test -vanilla" 51 kB
[ebuild   R   ] sys-devel/gcc-3.4.6-r2  USE="doc fortran gcj nls (-altivec) -bootstrap -boundschecking -build -gtk (-hardened) -ip28 -ip32r10k (-multilib) -multislot (-n32) (-n64) -nocxx -nopie -nossp -objc -test -vanilla" 0 kB

Total: 3 packages (3 reinstalls), Size of downloads: 51 kB
Build finished correctly. Removing temporary files...
You can re-run revdep-rebuild to verify that all libraries and binaries
are fixed. If some inconsistency remains, it can be orphaned file, deep
dependency, binary package or specially evaluated library.
# ls -l /usr/lib/liblber* /usr/lib/libldap*
lrwxrwxrwx 1 root root     21 13 feb 12.22 /usr/lib/liblber-2.3.so.0 -> liblber-2.3.so.0.2.18
-rwxr-xr-x 1 root root  47892 13 feb 12.22 /usr/lib/liblber-2.3.so.0.2.18
-rw-r--r-- 1 root root  72900 13 feb 12.22 /usr/lib/liblber.a
-rw-r--r-- 1 root root    809 13 feb 12.22 /usr/lib/liblber.la
lrwxrwxrwx 1 root root     21 13 feb 12.22 /usr/lib/liblber.so -> liblber-2.3.so.0.2.18
-rwxr-xr-x 1 root root 228976 13 feb 12.22 /usr/lib/libldap-2.2.so.7
lrwxrwxrwx 1 root root     21 13 feb 12.22 /usr/lib/libldap-2.3.so.0 -> libldap-2.3.so.0.2.18
-rwxr-xr-x 1 root root 240536 13 feb 12.22 /usr/lib/libldap-2.3.so.0.2.18
-rw-r--r-- 1 root root 357114 13 feb 12.22 /usr/lib/libldap.a
-rw-r--r-- 1 root root    887 13 feb 12.22 /usr/lib/libldap.la
-rwxr-xr-x 1 root root 240832 13 feb 12.22 /usr/lib/libldap_r-2.2.so.7
lrwxrwxrwx 1 root root     23 13 feb 12.22 /usr/lib/libldap_r-2.3.so.0 -> libldap_r-2.3.so.0.2.18
-rwxr-xr-x 1 root root 255588 13 feb 12.22 /usr/lib/libldap_r-2.3.so.0.2.18
-rw-r--r-- 1 root root 387072 13 feb 12.22 /usr/lib/libldap_r.a
-rw-r--r-- 1 root root    901 13 feb 12.22 /usr/lib/libldap_r.la
lrwxrwxrwx 1 root root     23 13 feb 12.22 /usr/lib/libldap_r.so -> libldap_r-2.3.so.0.2.18
lrwxrwxrwx 1 root root     20 13 feb 00.10 /usr/lib/libldap_r.so.2 -> libldap_r.so.2.0.130
-rwxr-xr-x 1 root root 231680 13 feb 12.22 /usr/lib/libldap_r.so.2.0.130
lrwxrwxrwx 1 root root     21 13 feb 12.22 /usr/lib/libldap.so -> libldap-2.3.so.0.2.18
lrwxrwxrwx 1 root root     18 13 feb 00.10 /usr/lib/libldap.so.2 -> libldap.so.2.0.130
-rwxr-xr-x 1 root root 220720 13 feb 12.22 /usr/lib/libldap.so.2.0.130
# equery b /usr/lib/liblber* /usr/lib/libldap*
[ Searching for file(s) /usr/lib/liblber-2.3.so.0,/usr/lib/liblber-2.3.so.0.2.18,/usr/lib/liblber.a,/usr/lib/liblber.la,/usr/lib/liblber.so,/usr/lib/libldap-2.2.so.7,/usr/lib/libldap-2.3.so.0,/usr/lib/libldap-2.3.so.0.2.18,/usr/lib/libldap.a,/usr/lib/libldap.la,/usr/lib/libldap_r-2.2.so.7,/usr/lib/libldap_r-2.3.so.0,/usr/lib/libldap_r-2.3.so.0.2.18,/usr/lib/libldap_r.a,/usr/lib/libldap_r.la,/usr/lib/libldap_r.so,/usr/lib/libldap_r.so.2,/usr/lib/libldap_r.so.2.0.130,/usr/lib/libldap.so,/usr/lib/libldap.so.2,/usr/lib/libldap.so.2.0.130 in *... ]
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap_r-2.3.so.0 -> libldap_r-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap-2.3.so.0 -> libldap-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/liblber.la)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap.la)
net-nds/openldap-2.3.30-r2 (/usr/lib/liblber-2.3.so.0 -> liblber-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/liblber.so -> liblber-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap_r.la)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap_r.so.2.0.130)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap-2.2.so.7)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap_r.so -> libldap_r-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/liblber-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap_r.a)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap.so -> libldap-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap.a)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap.so.2.0.130)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap_r-2.2.so.7)
net-nds/openldap-2.3.30-r2 (/usr/lib/libldap_r-2.3.so.0.2.18)
net-nds/openldap-2.3.30-r2 (/usr/lib/liblber.a)


Where does it say what I have to remove by hand to fix this?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

