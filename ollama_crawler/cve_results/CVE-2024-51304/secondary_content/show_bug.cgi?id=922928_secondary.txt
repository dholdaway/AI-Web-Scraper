Title: 922928 – net-im/neochat: media-plugins/gst-plugins-libav required for playing embedded MP4 files
URL: https://bugs.gentoo.org/show_bug.cgi?id=922928

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 922928
net-im/neochat: media-plugins/gst-plugins-libav required for playing embedded MP4 files
Last modified: 2024-10-13 14:40:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 922928 
      - net-im/neochat: media-plugins/gst-plugins-libav required for playing embedded MP4 files


Summary:
net-im/neochat: media-plugins/gst-plugins-libav required for playing embedded...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2024-01-25 21:58 UTC by Jesús P Rey (Chuso)





      Modified:
    
2024-10-13 14:40 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



gentoo
ionen
jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jesús P Rey (Chuso)





          2024-01-25 21:58:12 UTC
        

It's possible and common in Matrix chats to embed videos which are usually encoded in MP4 (H.264) format, but I was finding that videos were not playing for me in Neochat and I was only getting the audio instead.

Also, Neochat was writing this line in the console while trying to reproduce the video:

Warning: "No decoder available for type 'video/x-h264, stream-format=(string)avc, alignment=(string)au, level=(string)3, profile=(string)high, codec_data=(buffer)0164001effe100136764001eac1b1a81e06da6a0202020f08846a001000468ea43cb, width=(int)480, height=(int)864, pixel-aspect-ratio=(fraction)1/1, colorimetry=(string)bt709, framerate=(fraction)0/1, chroma-format=(string)4:2:0, bit-depth-luma=(uint)8, bit-depth-chroma=(uint)8, parsed=(boolean)true'."

Which seems to indicate a missing GStreamer decoder.
That matches comments on the Internet[1] that state that the libav plugin for GStreamer was missing.
Indeed, that was fixed for me after merging media-plugins/gst-plugins-libav

I don't know how this should be fixed. Either with an unconditional dependency, an optfeature or a conditional dependency based on the x264 USE flag, but given that bug 918509 rejected the possibility of making GStreamer dependency conditional, I guess that it makes sense making the media-plugins/gst-plugins-libav dependency also unconditional to make the GStreamer support as much complete as possible for the most common use cases.
And for net-im/neochat to be able to effectively use media-plugins/gst-plugins-libav to decode H.264 videos, I guess it would need to make sure FFMpeg has been compiled with H.264 support by depending on media-video/ffmpeg[x264]

[1] https://stackoverflow.com/a/54940466




Comment 1


Andreas Sturmlechner






          2024-10-02 19:38:13 UTC
        

Current versions of net-im/neochat (KF6-based) no longer directly depend on dev-qt/qtmultimedia[gstreamer], since dev-qt/qtmultimedia now by default provides ffmpeg alternatively. I suspect that alone will already "fix" that bug, although it may still be present when using qtmultimedia:6[gstreamer,-ffmpeg].




Comment 2


Ionen Wolkens






          2024-10-03 01:38:50 UTC
        

*could* have qtmultimedia[gstreamer] depend on gst-plugins-meta, albeit gst-plugins-meta won't install libav by default either (USE=ffmpeg is default-off)

Afaik you should be able to play these without libav though, unless you were missing gst-plugins-good/base as well or so (these would always be installed by the plugins meta). If -good works without -libav guess it'd solve it still.

Tend to wonder if gstreamer itself should instead have the meta in PDEPEND or so though, so that each gstreamer consumers don't have to be in charge of pulling it. Albeit I hate arguing about any changes with gstreamer semi-maintainers.




Comment 3


Ionen Wolkens






          2024-10-03 01:49:00 UTC
        

Ah wait, actually I'm not sure what does h264 in gstreamer..? It think it actually requires libav because of the non-free nature.

Pulling the meta wouldn't solve this then.

>media-video/ffmpeg[x264]
x264 is for encoding, and not decoding btw




Comment 4


Ionen Wolkens






          2024-10-03 01:52:36 UTC
        

in all I think I'd rather rely on the fact that USE=ffmpeg is default on qtmultimedia now, so I think this can be considered mostly fixed




Comment 5


Jesús P Rey (Chuso)





          2024-10-13 14:40:58 UTC
        

Sorry, I am on a business trip far away from my Gentoo laptop for the whole month, so I cannot test this.
But yes, based on what you mention, it sounds sensible to close this off.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

