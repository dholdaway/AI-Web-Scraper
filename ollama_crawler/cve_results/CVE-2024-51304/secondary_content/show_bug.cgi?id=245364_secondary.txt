Title: 245364 – sys-kernel/gentoo-sources-2.6.25-r7, sys-kernel/gentoo-sources-2.6.26-r3: hangs on boot on ata_piix
URL: https://bugs.gentoo.org/show_bug.cgi?id=245364

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 245364
sys-kernel/gentoo-sources-2.6.25-r7, sys-kernel/gentoo-sources-2.6.26-r3: hangs on boot on ata_piix
Last modified: 2008-12-02 01:39:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 245364 
      - sys-kernel/gentoo-sources-2.6.25-r7, sys-kernel/gentoo-sources-2.6.26-r3: hangs on boot on ata_piix


Summary:
sys-kernel/gentoo-sources-2.6.25-r7, sys-kernel/gentoo-sources-2.6.26-r3: han...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo Kernel Bug Wranglers and Kernel Maintainers








URL:







Whiteboard:
linux-2.6.27  
  


Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-11-03 06:36 UTC by sa wu





      Modified:
    
2008-12-02 01:39 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


sa wu





          2008-11-03 06:36:41 UTC
        

Sometimes when booting system just hangs and does not seem to do anything, apparently something with the serial ata drivers goes awry.
Happens regardless of hibernation or regular boot but not always. Power button and new boot fixes the issue after several tries, ranging from 1 to more than a dozen tries.
I have waited up to 30min to see if anything would happen but to no avail.
I don't really know where the problem lies and what outputs i should add.
Last lines seen on screen before hangup:

Uniform Multi-Platform E-IDE driver
ide: Assuming 33 MHz System bus speed for PIO mode; override with idebus=xx
Driver 'sd' needs updating - please use bus_type method
Driver 'sr' needs updating - please use bus_type method
ACPI: PCI Interrupt 0000:00:1f.2(B) -> GSI 19 (level,low) -> IRQ 19
ata_piix 0000:00:1f.2: MAP [P0 P2 IDE IDE]

ide controller lspci -v output
00:1f.2 IDE interface: Intel Corporation Mobile SATA IDE Controller (rev 03) (prog-if 80 [Master])
        Subsystem: Samsung Electronics Co Ltd Device c031
        Flags: bus master, 66MHz, medium devsel, latency 0, IRQ 19
        I/O ports at 01f0 [size=8]
        I/O ports at 03f4 [size=1]
        I/O ports at 0170 [size=8]
        I/O ports at 0374 [size=1]
        I/O ports at 18e0 [size=16]
        I/O ports at 18d0 [size=16]
        Capabilities: [70] Power Management version 3
        Kernel driver in use: ata_piix

Happens on my samsung aura r70 deluis laptop. hard drive seems to be (according to dmesg):
ata1.00: ATA-8: WDC WD3200BEVT-22ZCT0, 11.01A11, max UDMA/133

I am currently using sys-kernel/gentoo-sources-2.6.25-r7 on an amd64 no-multilib box.

Reproducible: Sometimes

Steps to Reproduce:
1. boot machine
2.
3.

Actual Results:  
hangs when outputting line

ata_piix 0000:00:1f.2: MAP [P0 P2 IDE IDE]

Expected Results:  
system running after some time




Comment 1


Mike Pagano






          2008-11-23 19:46:27 UTC
        

Does this happen with gentoo-sources 2.6.26 or 2.6.27?




Comment 2


Leonid Podolny





          2008-11-23 20:23:55 UTC
        

(In reply to comment #1)
> Does this happen with gentoo-sources 2.6.26 or 2.6.27?
> 
The problem existed before, than dissapeared at git-sources-2.6.26-rc6, and now appeared back at gentoo-sources-2.6.27-rc4.





Comment 3


Leonid Podolny





          2008-11-23 21:12:35 UTC
        

(In reply to comment #2)
> (In reply to comment #1)
> > Does this happen with gentoo-sources 2.6.26 or 2.6.27?
> > 
> The problem existed before, than dissapeared at git-sources-2.6.26-rc6, and now
> appeared back at gentoo-sources-2.6.27-rc4.
> 

Sorry, wrong bug




Comment 4


sa wu





          2008-11-26 00:29:58 UTC
        

Still got the same bug using sys-kernel/gentoo-sources-2.6.26-r3.




Comment 5


Nicolas Sebrecht





          2008-11-26 02:39:46 UTC
        

(In reply to comment #4)
> Still got the same bug using sys-kernel/gentoo-sources-2.6.26-r3.

Ok. Please try the last sys-kernel/gentoo-sources-2.6.27-r4 and attach the output of smartcl -a /dev/?d?.
If the bug still remains, try adding irqpoll, noacpi and noapic at the end of the boot command line.
The dmesg output after a long intensive use would be great as well as a long SMART test. IMHO, this bug looks more like a disk controller dying. Did it appear after a kernel update ?





Comment 6


sa wu





          2008-11-26 04:17:21 UTC
        

switched to sys-kernel/gentoo-sources-2.6.27-r4 and at first glance (~30 reboots)
seems to fix the problem for me, will add some data after more runs.

smartctl output:

# smartctl -a /dev/sda
smartctl version 5.38 [x86_64-pc-linux-gnu] Copyright (C) 2002-8 Bruce Allen
Home page is http://smartmontools.sourceforge.net/

=== START OF INFORMATION SECTION ===
Device Model:     WDC WD3200BEVT-22ZCT0
Serial Number:    WD-WXHZ07336286
Firmware Version: 11.01A11
User Capacity:    320.072.933.376 bytes
Device is:        Not in smartctl database [for details use: -P showall]
ATA Version is:   8
ATA Standard is:  Exact ATA specification draft version not indicated
Local Time is:    Wed Nov 26 05:14:50 2008 CET
SMART support is: Available - device has SMART capability.
SMART support is: Enabled

=== START OF READ SMART DATA SECTION ===
SMART overall-health self-assessment test result: PASSED

General SMART Values:
Offline data collection status:  (0x00) Offline data collection activity
                                        was never started.
                                        Auto Offline Data Collection: Disabled.
Self-test execution status:      (   0) The previous self-test routine completed
                                        without error or no self-test has ever 
                                        been run.
Total time to complete Offline 
data collection:                 (10800) seconds.
Offline data collection
capabilities:                    (0x7b) SMART execute Offline immediate.
                                        Auto Offline data collection on/off support.
                                        Suspend Offline collection upon new
                                        command.
                                        Offline surface scan supported.
                                        Self-test supported.
                                        Conveyance Self-test supported.
                                        Selective Self-test supported.
SMART capabilities:            (0x0003) Saves SMART data before entering
                                        power-saving mode.
                                        Supports SMART auto save timer.
Error logging capability:        (0x01) Error logging supported.
                                        General Purpose Logging supported.
Short self-test routine 
recommended polling time:        (   2) minutes.
Extended self-test routine
recommended polling time:        ( 127) minutes.
Conveyance self-test routine
recommended polling time:        (   5) minutes.
SCT capabilities:              (0x303f) SCT Status supported.
                                        SCT Feature Control supported.
                                        SCT Data Table supported.

SMART Attributes Data Structure revision number: 16
Vendor Specific SMART Attributes with Thresholds:
ID# ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE
  1 Raw_Read_Error_Rate     0x002f   200   200   051    Pre-fail  Always       -       0
  3 Spin_Up_Time            0x0027   187   186   021    Pre-fail  Always       -       1650
  4 Start_Stop_Count        0x0032   100   100   000    Old_age   Always       -       466
  5 Reallocated_Sector_Ct   0x0033   200   200   140    Pre-fail  Always       -       0
  7 Seek_Error_Rate         0x002e   100   253   051    Old_age   Always       -       0
  9 Power_On_Hours          0x0032   099   099   000    Old_age   Always       -       1280
 10 Spin_Retry_Count        0x0033   100   100   051    Pre-fail  Always       -       0
 11 Calibration_Retry_Count 0x0032   100   100   000    Old_age   Always       -       0
 12 Power_Cycle_Count       0x0032   100   100   000    Old_age   Always       -       449
192 Power-Off_Retract_Count 0x0032   200   200   000    Old_age   Always       -       20
193 Load_Cycle_Count        0x0032   191   191   000    Old_age   Always       -       28185
194 Temperature_Celsius     0x0022   109   096   000    Old_age   Always       -       38
196 Reallocated_Event_Count 0x0032   200   200   000    Old_age   Always       -       0
197 Current_Pending_Sector  0x0032   200   200   000    Old_age   Always       -       0
198 Offline_Uncorrectable   0x0030   100   253   000    Old_age   Offline      -       0
199 UDMA_CRC_Error_Count    0x0032   200   200   000    Old_age   Always       -       1
200 Multi_Zone_Error_Rate   0x0009   100   253   051    Pre-fail  Offline      -       0

SMART Error Log Version: 1
No Errors Logged

SMART Self-test log structure revision number 1
No self-tests have been logged.  [To run self-tests, use: smartctl -t]


SMART Selective self-test log data structure revision number 1
 SPAN  MIN_LBA  MAX_LBA  CURRENT_TEST_STATUS
    1        0        0  Not_testing
    2        0        0  Not_testing
    3        0        0  Not_testing
    4        0        0  Not_testing
    5        0        0  Not_testing
Selective self-test flags (0x0):
  After scanning selected spans, do NOT read-scan remainder of disk.
If Selective self-test is pending on power-up, resume after 0 minute delay.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

