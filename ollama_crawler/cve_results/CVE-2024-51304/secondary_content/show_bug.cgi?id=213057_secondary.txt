Title: 213057 – x11-apps/xmessage-1.0.2 attempts to install files outside of prefix
URL: https://bugs.gentoo.org/show_bug.cgi?id=213057

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 213057
x11-apps/xmessage-1.0.2 attempts to install files outside of prefix
Last modified: 2008-05-13 19:02:11 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 213057 
      - x11-apps/xmessage-1.0.2 attempts to install files outside of prefix


Summary:
x11-apps/xmessage-1.0.2 attempts to install files outside of prefix
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

Prefix Support

  (show other bugs)



Hardware:

All
        All
      







Importance:
      
High
       major
      


Assignee:

Gentoo non-Linux Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-03-11 18:14 UTC by Stuart Shelton





      Modified:
    
2008-05-13 19:02 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Stuart Shelton





          2008-03-11 18:14:03 UTC
        

>>> Install xmessage-1.0.2 into /usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image/opt/portage/ category x11-apps
make[1]: Entering directory `/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'
test -z "/opt/portage/usr/bin" || mkdir -p -- "/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//opt/portage/usr/bin"
  /opt/portage/usr/bin/install -c 'xmessage' '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//opt/portage/usr/bin/xmessage'
test -z "" || mkdir -p -- "/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image/"
 /opt/portage/usr/bin/install -c -m 644 'Xmessage' '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//Xmessage'
 /opt/portage/usr/bin/install -c -m 644 'Xmessage-color' '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//Xmessage-color'
test -z "/opt/portage/usr/share/man/man1" || mkdir -p -- "/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//opt/portage/usr/share/man/man1"
 /opt/portage/usr/bin/install -c -m 644 'xmessage.1' '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//opt/portage/usr/share/man/man1/xmessage.1'
make[1]: Leaving directory `/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'
>>> Completed installing xmessage-1.0.2 into /usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image/opt/portage/

ecompressdir: bzip2 -9 /opt/portage/usr/share/doc
ecompressdir: bzip2 -9 /opt/portage/usr/share/man
 * QA Notice: the following files are outside of the prefix:
 * /Xmessage
/Xmessage-color
 * ERROR: x11-apps/xmessage-1.0.2 failed:
 *   Aborting due to QA concerns: there are files installed outside the prefix
 * 
 * Call stack:
 *       misc-functions.sh:733: <call install_qa_check>
 *       misc-functions.sh:242:                       die "Aborting due to QA concerns: there are files installed outside the prefix"
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * build log: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/temp/build.log'
 * ebuild environment: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/temp/environment'
 * S: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'
!!! install_qa_check failed; exiting.




Comment 1


Fabian Groffen






          2008-03-11 18:26:09 UTC
        

I cannot reproduce this :/

# $Header: /var/cvsroot/gentoo-x86/x11-apps/xmessage/xmessage-1.0.2.ebuild,v 1. 9 2008/01/13 09:36:07 vapier Exp $




Comment 2


Stuart Shelton





          2008-03-12 00:52:26 UTC
        


I've just tried again twice, once with USE=xprint and once without, and both fail identically.

The ebuild ID is the same as quoted: "# $Header: /var/cvsroot/gentoo-x86/x11-apps/xmessage/xmessage-1.0.2.ebuild,v 1.9 2008/01/13 09:36:07 vapier Exp $"

$ USE="xprint" emerge -v xmessage

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild  N    ] x11-apps/xmessage-1.0.2  USE="xprint -debug" 0 kB 

Total: 1 package (1 new), Size of downloads: 0 kB

>>> Verifying ebuild Manifests...

>>> Emerging (1 of 1) x11-apps/xmessage-1.0.2 to /
 * xmessage-1.0.2.tar.bz2 RMD160 SHA1 SHA256 size ;-) ...                 [ ok ]
 * checking ebuild checksums ;-) ...                                      [ ok ]
 * checking auxfile checksums ;-) ...                                     [ ok ]
 * checking miscfile checksums ;-) ...                                    [ ok ]
 * checking xmessage-1.0.2.tar.bz2 ;-) ...                                [ ok ]
>>> Unpacking source...
>>> Unpacking xmessage-1.0.2.tar.bz2 to /usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work
>>> Source unpacked.
>>> Compiling source in /usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2 ...
 * econf: updating /xmessage-1.0.2/config.guess with /opt/portage/usr/share/gnuconfig/config.guess
 * econf: updating /xmessage-1.0.2/config.sub with /opt/portage/usr/share/gnuconfig/config.sub
./configure --prefix=/opt/portage/usr --host=mips-sgi-irix6.5 --mandir=/opt/portage/usr/share/man --infodir=/opt/portage/usr/share/info --datadir=/opt/portage/usr/share --sysconfdir=/opt/portage/etc --localstatedir=/opt/portage/var/lib --prefix=/opt/portage/usr --datadir=/opt/portage/usr/share --enable-xprint --build=mips-sgi-irix6.5
checking for a BSD-compatible install... /opt/portage/usr/bin/install -c
checking whether build environment is sane... yes
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking whether to enable maintainer-specific portions of Makefiles... no
checking for mips-sgi-irix6.5-gcc... cc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables... 
checking for suffix of object files... o
checking whether we are using the GNU C compiler... no
checking whether cc accepts -g... yes
checking for cc option to accept ANSI C... none needed
checking for style of include used by make... GNU
checking dependency style of cc... sgi
checking for a BSD-compatible install... /opt/portage/usr/bin/install -c
checking for mips-sgi-irix6.5-pkg-config... no
checking for pkg-config... /opt/portage/usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for TMP_XAW... yes
./configure[3160]: test: argument expected
checking for APPDEFS... yes
checking build system type... mips-sgi-irix6.5
checking host system type... mips-sgi-irix6.5
configure: creating ./config.status
config.status: creating Makefile
config.status: creating config.h
config.status: executing depfiles commands
make  all-am
make[1]: Entering directory `/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'
source='makeform.c' object='xmessage-makeform.o' libtool=no \
        DEPDIR=.deps depmode=sgi /bin/sh ./depcomp \
        cc -DHAVE_CONFIG_H -I. -I. -I.    -I/opt/portage/usr/include   -c99 -O2 -n32 -mips4 -r14000 -float_const -use_readonly_const -TARG:isa=mips4:platform=ip35:processor=r14000 -TENV:zeroinit_in_bss=ON -OPT:fast_io=ON:Olimit=8192:reorg_common=ON:swp=ON -LNO:auto_dist=ON:fusion_peeling_limit=8:gather_scatter=2 -woff 1174,1183,1185,1552,3968,3970 -c -o xmessage-makeform.o `test -f 'makeform.c' || echo './'`makeform.c
source='readfile.c' object='xmessage-readfile.o' libtool=no \
        DEPDIR=.deps depmode=sgi /bin/sh ./depcomp \
        cc -DHAVE_CONFIG_H -I. -I. -I.    -I/opt/portage/usr/include   -c99 -O2 -n32 -mips4 -r14000 -float_const -use_readonly_const -TARG:isa=mips4:platform=ip35:processor=r14000 -TENV:zeroinit_in_bss=ON -OPT:fast_io=ON:Olimit=8192:reorg_common=ON:swp=ON -LNO:auto_dist=ON:fusion_peeling_limit=8:gather_scatter=2 -woff 1174,1183,1185,1552,3968,3970 -c -o xmessage-readfile.o `test -f 'readfile.c' || echo './'`readfile.c
source='xmessage.c' object='xmessage-xmessage.o' libtool=no \
        DEPDIR=.deps depmode=sgi /bin/sh ./depcomp \
        cc -DHAVE_CONFIG_H -I. -I. -I.    -I/opt/portage/usr/include   -c99 -O2 -n32 -mips4 -r14000 -float_const -use_readonly_const -TARG:isa=mips4:platform=ip35:processor=r14000 -TENV:zeroinit_in_bss=ON -OPT:fast_io=ON:Olimit=8192:reorg_common=ON:swp=ON -LNO:auto_dist=ON:fusion_peeling_limit=8:gather_scatter=2 -woff 1174,1183,1185,1552,3968,3970 -c -o xmessage-xmessage.o `test -f 'xmessage.c' || echo './'`xmessage.c
cc  -c99 -O2 -n32 -mips4 -r14000 -float_const -use_readonly_const -TARG:isa=mips4:platform=ip35:processor=r14000 -TENV:zeroinit_in_bss=ON -OPT:fast_io=ON:Olimit=8192:reorg_common=ON:swp=ON -LNO:auto_dist=ON:fusion_peeling_limit=8:gather_scatter=2 -woff 1174,1183,1185,1552,3968,3970  -Wl,-v,-s,-x,-n32,-mips4,-rdata_shared,-allow_jump_at_eop,-rpath,/opt/portage/usr/lib:/opt/portage/lib -o xmessage  xmessage-makeform.o xmessage-readfile.o xmessage-xmessage.o -L/opt/portage/usr/lib -lXaw8 -lXmu -lXt -lX11 -lSM -lICE -lXau   
cp Xmessage.ad Xmessage
cp Xmessage-color.ad Xmessage-color
sed -e 's|__vendorversion__|"xmessage 1.0.2" "X Version 11"|' -e 's|__xorgversion__|"xmessage 1.0.2" "X Version 11"|' -e 's|__xservername__|Xorg|g' -e 's|__xconfigfile__|xorg.conf|g' -e 's|__projectroot__|/opt/portage/usr|g' -e 's|__apploaddir__||' -e 's|__appmansuffix__|1|g' -e 's|__libmansuffix__|3|g' -e 's|__adminmansuffix__|8|g' -e 's|__miscmansuffix__|7|g' -e 's|__filemansuffix__|5|g' < xmessage.man > xmessage.1
make[1]: Leaving directory `/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'
>>> Source compiled.
>>> Test phase [not enabled]: x11-apps/xmessage-1.0.2

>>> Install xmessage-1.0.2 into /usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image/opt/portage/ category x11-apps
make[1]: Entering directory `/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'
test -z "/opt/portage/usr/bin" || mkdir -p -- "/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//opt/portage/usr/bin"
  /opt/portage/usr/bin/install -c 'xmessage' '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//opt/portage/usr/bin/xmessage'
test -z "" || mkdir -p -- "/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image/"
 /opt/portage/usr/bin/install -c -m 644 'Xmessage' '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//Xmessage'
 /opt/portage/usr/bin/install -c -m 644 'Xmessage-color' '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//Xmessage-color'
test -z "/opt/portage/usr/share/man/man1" || mkdir -p -- "/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//opt/portage/usr/share/man/man1"
 /opt/portage/usr/bin/install -c -m 644 'xmessage.1' '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image//opt/portage/usr/share/man/man1/xmessage.1'
make[1]: Leaving directory `/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'
>>> Completed installing xmessage-1.0.2 into /usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/image/opt/portage/

ecompressdir: bzip2 -9 /opt/portage/usr/share/doc
ecompressdir: bzip2 -9 /opt/portage/usr/share/man
 * QA Notice: the following files are outside of the prefix:
 * /Xmessage
/Xmessage-color
 * ERROR: x11-apps/xmessage-1.0.2 failed:
 *   Aborting due to QA concerns: there are files installed outside the prefix
 * 
 * Call stack:
 *       misc-functions.sh:733: <call install_qa_check>
 *       misc-functions.sh:242:                       die "Aborting due to QA concerns: there are files installed outside the prefix"
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * build log: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/temp/build.log'
 * ebuild environment: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/temp/environment'
 * S: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'
!!! install_qa_check failed; exiting.

 * Messages for package x11-apps/xmessage-1.0.2:

 * ERROR: x11-apps/xmessage-1.0.2 failed:
 *   Aborting due to QA concerns: there are files installed outside the prefix
 * 
 * Call stack:
 *       misc-functions.sh:733: <call install_qa_check>
 *       misc-functions.sh:242:                        die "Aborting due to QA concerns: there are files installed outside the prefix"
 * 
 * If you need support, post the topmost build error, and the call stack if relevant.
 * build log: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/temp/build.log'
 * ebuild environment: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/temp/environment'
 * S: '/usr/opt/portage/var/tmp/portage/x11-apps/xmessage-1.0.2/work/xmessage-1.0.2'






Comment 3


Stuart Shelton





          2008-03-12 00:54:40 UTC
        

$ emerge --info
!!! No gcc found. You probably need to 'source /etc/profile'
!!! to update the environment of this terminal and possibly
!!! other terminals also.
Portage 2.2.00.9450-prefix (default-prefix/irix/6.5/mips, [unavailable], unavailable, 6.5 IP35)
=================================================================
System uname: 6.5 IP35 mips
Timestamp of tree: Tue, 11 Mar 2008 12:12:55 +0000
app-shells/bash:     3.2_p33
dev-lang/python:     2.5.1-r5
sys-devel/autoconf:  2.13, 2.61-r01.1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.1
sys-devel/libtool:   1.5.26
ACCEPT_KEYWORDS="mips-irix mips-linux ppc-macos sparc-solaris x86-solaris ~mips-irix ~mips-linux ~ppc-macos ~sparc-solaris ~x86-solaris"
CBUILD="mips-sgi-irix6.5"
CFLAGS="-c99 -O2 -n32 -mips4 -r14000 -float_const -use_readonly_const -TARG:isa=mips4:platform=ip35:processor=r14000 -TENV:zeroinit_in_bss=ON -OPT:fast_io=ON:Olimit=8192:reorg_common=ON:swp=ON -LNO:auto_dist=ON:fusion_peeling_limit=8:gather_scatter=2 -woff 1174,1183,1185,1552,3968,3970"
CHOST="mips-sgi-irix6.5"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-J2 -O2 -n32 -mips4 -r14000 -float_const -use_readonly_const -TARG:isa=mips4:platform=ip35:processor=r14000 -TENV:zeroinit_in_bss=ON -OPT:fast_io=ON:Olimit=8192:reorg_common=ON:swp=ON -LNO:auto_dist=ON:fusion_peeling_limit=8:gather_scatter=2 -FE:eliminate_duplicate_inline_copies:template_in_elf_section -woff 1174,1183,1185,1552,3968,3970"
DISTDIR="/opt/portage/usr/portage/distfiles"
EPREFIX="/opt/portage"
FEATURES="distlocks fixpackages metadata-transfer nostrip parallel-fetch preserve-libs sfperms strict unmerge-orphans userfetch userpriv"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="en_GB"
LDFLAGS="-Wl,-v,-s,-x,-n32,-mips4,-rdata_shared,-allow_jump_at_eop,-rpath,/opt/portage/usr/lib:/opt/portage/lib"
PKGDIR="/opt/portage/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/opt/portage/var/tmp"
PORTDIR="/opt/portage/usr/portage"
SYNC="svn+http://overlays.gentoo.org/svn/proj/alt/trunk/prefix-overlay"
USE="bash-completion berkdb bzip2 cracklib crypt expat gdbm ipv6 ithreads midi mips-irix ncurses nls pcre perl png prefix python readline slang sqlite3 ssl tcl test threads unicode urandom vim-pager vim-syntax zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="IRIX" INPUT_DEVICES="keyboard mouse" KERNEL="IRIX" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, LINGUAS, MAKEOPTS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY






Comment 4


Fabian Groffen






          2008-03-12 10:28:47 UTC
        

I tried another machine wehre it also works.  I see a difference with your output, though:

sed -e 's|__vendorversion__|"xmessage 1.0.2" "X Version 11"|' -e 's|__xorgversion__|"xmessage 1.0.2" "X Version 11"|' -e 's|__xservername__|Xorg|g' -e 's|__xconfigfile__|xorg.conf|g' -e 's|__projectroot__|/ufs/fabian/scratch/programs/gentoo/usr|g' -e 's|__apploaddir__|/ufs/fabian/scratch/programs/gentoo/usr/share/X11/app-defaults|' -e 's|__appmansuffix__|1|g' -e 's|__libmansuffix__|3|g' -e 's|__adminmansuffix__|8|g' -e 's|__miscmansuffix__|7|g' -e 's|__filemansuffix__|5|g' < xmessage.man > xmessage.1

(__apploaddir__ is set, whereas for you it is empty...)

I suspect this is a depending package that's causing the difference.




Comment 5


Jeremy Olexa (darkside) (RETIRED)








          2008-05-13 19:02:11 UTC
        

Works here too (x86-linux), resolving as WORKSFORME. Please re-open if the problem continues or you can figure out the issue.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

