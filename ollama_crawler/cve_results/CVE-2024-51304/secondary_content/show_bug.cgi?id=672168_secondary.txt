Title: 672168 – net-im/swift-4.0.2-r1: crash on attempt to receive image file
URL: https://bugs.gentoo.org/show_bug.cgi?id=672168

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 672168
net-im/swift-4.0.2-r1: crash on attempt to receive image file
Last modified: 2018-12-10 12:05:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 672168 
      - net-im/swift-4.0.2-r1: crash on attempt to receive image file


Summary:
net-im/swift-4.0.2-r1: crash on attempt to receive image file
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Conrad Kostecki








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2018-11-28 14:18 UTC by Martin Samek





      Modified:
    
2018-12-10 12:05 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



andrey_utkin
proxy-maint









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin Samek





          2018-11-28 14:18:15 UTC
        

Swift crashes on attempt to receive image offered by remote party.

BackTrack:

(gdb) bt
#0  0x00007ffff73ff926 in Swift::UnixNetworkEnvironment::getNetworkInterfaces() const () from /usr/lib64/libSwiften.so.4
#1  0x00007ffff74913e5 in Swift::SOCKS5BytestreamServerManager::getHostAddressPorts() const () from /usr/lib64/libSwiften.so.4
#2  0x00007ffff7462d7e in Swift::LocalJingleTransportCandidateGenerator::emitOnLocalTransportCandidatesGenerated() () from /usr/lib64/libSwiften.so.4
#3  0x00007ffff74636d1 in Swift::LocalJingleTransportCandidateGenerator::handlePortForwardingSetup(bool) () from /usr/lib64/libSwiften.so.4
#4  0x00005555558bc51a in boost::signals2::detail::signal_impl<void (bool), boost::signals2::optional_last_value<void>, int, std::less<int>, boost::function<void (bool)>, boost::function<void (boost::signals2::connection const&, bool)>, boost::signals2::mutex>::operator()(bool) ()
#5  0x00005555558bc51a in boost::signals2::detail::signal_impl<void (bool), boost::signals2::optional_last_value<void>, int, std::less<int>, boost::function<void (bool)>, boost::function<void (boost::signals2::connection const&, bool)>, boost::signals2::mutex>::operator()(bool) ()
#6  0x00007ffff7492c51 in Swift::SOCKS5BytestreamServerManager::handleForwardPortResult(boost::optional<Swift::NATPortMapping>) () from /usr/lib64/libSwiften.so.4
#7  0x00007ffff7493992 in boost::detail::function::void_function_obj_invoker1<boost::_bi::bind_t<void, boost::_mfi::mf1<void, Swift::SOCKS5BytestreamServerManager, boost::optional<Swift::NATPortMapping> >, boost::_bi::list2<boost::_bi::value<Swift::SOCKS5BytestreamServerManager*>, boost::arg<1> > >, void, boost::optional<Swift::NATPortMapping> >::invoke(boost::detail::function::function_buffer&, boost::optional<Swift::NATPortMapping>) () from /usr/lib64/libSwiften.so.4
#8  0x00007ffff73f334d in boost::signals2::detail::signal_impl<void (boost::optional<Swift::NATPortMapping>), boost::signals2::optional_last_value<void>, int, std::less<int>, boost::function<void (boost::optional<Swift::NATPortMapping>)>, boost::function<void (boost::signals2::connection const&, boost::optional<Swift::NATPortMapping>)>, boost::signals2::mutex>::operator()(boost::optional<Swift::NATPortMapping>) ()
   from /usr/lib64/libSwiften.so.4
#9  0x00007ffff73f3724 in boost::detail::function::void_function_obj_invoker0<boost::_bi::bind_t<boost::_bi::unspecified, boost::reference_wrapper<boost::signals2::signal<void (boost::optional<Swift::NATPortMapping>), boost::signals2::optional_last_value<void>, int, std::less<int>, boost::function<void (boost::optional<Swift::NATPortMapping>)>, boost::function<void (boost::signals2::connection const&, boost::optional<Swift::NATPortMapping>)>, boost::signals2::mutex> >, boost::_bi::list1<boost::_bi::value<boost::optional<Swift::NATPortMapping> > > >, void>::invoke(boost::detail::function::function_buffer&) ()
   from /usr/lib64/libSwiften.so.4
#10 0x00007ffff72a2f78 in Swift::invokeCallback(Swift::Event const&) () from /usr/lib64/libSwiften.so.4
#11 0x00007ffff72a2938 in Swift::EventLoop::handleNextEvents() () from /usr/lib64/libSwiften.so.4
#12 0x000055555571ed50 in ?? ()
#13 0x00007ffff0fc2d8c in QApplicationPrivate::notify_helper(QObject*, QEvent*) () from /usr/lib64/libQt5Widgets.so.5
#14 0x00007ffff0fca34f in QApplication::notify(QObject*, QEvent*) () from /usr/lib64/libQt5Widgets.so.5
#15 0x00007ffff4ee4817 in QCoreApplication::notifyInternal2(QObject*, QEvent*) () from /usr/lib64/libQt5Core.so.5
#16 0x00007ffff4ee7671 in QCoreApplicationPrivate::sendPostedEvents(QObject*, int, QThreadData*) () from /usr/lib64/libQt5Core.so.5
#17 0x00007ffff4f37813 in ?? () from /usr/lib64/libQt5Core.so.5
#18 0x00007fffeccb1517 in g_main_context_dispatch () from /usr/lib64/libglib-2.0.so.0
#19 0x00007fffeccb1780 in ?? () from /usr/lib64/libglib-2.0.so.0
#20 0x00007fffeccb182c in g_main_context_iteration () from /usr/lib64/libglib-2.0.so.0
#21 0x00007ffff4f375ff in QEventDispatcherGlib::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) () from /usr/lib64/libQt5Core.so.5
#22 0x00007fffdfc95731 in ?? () from /usr/lib64/libQt5XcbQpa.so.5
#23 0x00007ffff4ee360a in QEventLoop::exec(QFlags<QEventLoop::ProcessEventsFlag>) () from /usr/lib64/libQt5Core.so.5
#24 0x00007ffff4eebff0 in QCoreApplication::exec() () from /usr/lib64/libQt5Core.so.5
---Type <return> to continue, or q <return> to quit--- 
#25 0x00005555556b083a in main ()


Reproducible: Always

Steps to Reproduce:
1. start Swift
2. let another party send you a picture
3. open Save file dialog
4. click Save
5. crash follows in couple seconds




Comment 1


Conrad Kostecki






          2018-11-28 17:10:20 UTC
        

Hi Martin,
are we talking about a normal file transfer or profile image?

Cheers
Conrad




Comment 2


Martin Samek





          2018-11-28 18:02:10 UTC
        

Hi, it is a normal file transfer. Other party is Conversations client at the Android and sharing photo from camera.




Comment 3


Conrad Kostecki






          2018-11-30 16:51:57 UTC
        

Hi Martin,
upstream asks, what error gets shown before you execute 'bt'.
Is there more logged, like last time?

Cheers
Conrad




Comment 4


Martin Samek





          2018-11-30 20:08:48 UTC
        

Hi, at this moment I'm unable to replicate conditions to crash Swift. This problem seems to be dependent on the type of network connectivity:

1) when both parties are in the same network - file is transferred correctly
2) when I'm behind NAT (home cable) and, another party is at 4G mobile connection - file transfer negotiation fails, but Swift survives
3) when I'm in the office (the gdb bt) with public IP address and other party is behind the NAT Swift crashes during transfer negotiation

I will check 3) on Monday.




Comment 5


Conrad Kostecki






          2018-12-08 23:20:18 UTC
        

Any news for me?




Comment 6


Martin Samek





          2018-12-10 10:45:36 UTC
        

Sadly I'm unable to replicate crash anymore. I conducted a couple of tests with receiving and sending files/photos, but Swift survive.




Comment 7


Conrad Kostecki






          2018-12-10 12:05:47 UTC
        

Hi Martin,
thanks for your reply.
So I will close this ticket. If you can reproduce it again, feel free to reopen.

Conrad









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

