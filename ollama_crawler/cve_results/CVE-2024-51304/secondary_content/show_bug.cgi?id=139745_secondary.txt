Title: 139745 – mesa won't compile in a modular X install
URL: https://bugs.gentoo.org/show_bug.cgi?id=139745

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 139745
mesa won't compile in a modular X install
Last modified: 2006-07-25 20:06:00 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 139745 
      - mesa won't compile in a modular X install


Summary:
mesa won't compile in a modular X install
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-07-09 02:33 UTC by Wayne





      Modified:
    
2006-07-25 20:06 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



eradicator









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Full output while trying to emerge mesa

              (emerge_output,14.10 KB,
                text/plain)

            
2006-07-09 02:35 UTC,

            Wayne




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Wayne





          2006-07-09 02:33:31 UTC
        

Compilation ends with this
../../src/mesa/glapi -I../../../src/mesa/drivers/dri/common `pkg-config --cflags libdrm` -I/usr/X11R6/include -Wall -Wmissing-prototypes -march=k8 -O2 -pipe -fno-strict-aliasing -fPIC -m64 -DGLX_USE_TLS -D_POSIX_SOURCE -D_POSIX_C_SOURCE=199309L -D_SVID_SOURCE -D_BSD_SOURCE -D_GNU_SOURCE -DPTHREADS -DUSE_EXTERNAL_DXTN_LIB=1 -DIN_DRI_DRIVER -DGLX_DIRECT_RENDERING -DHAVE_ALIAS -DDEFAULT_DRIVER_DIR='"/usr/lib64/dri"' -DUSE_X86_64_ASM -std=c99 -ffast-math  -DXF86VIDMODE -D_REENTRANT -UIN_DRI_DRIVER glxcmds.c -o glxcmds.o
glxcmds.c: In function `glXBindTexImageEXT':
glxcmds.c:2670: error: `X_GLXvop_BindTexImageEXT' undeclared (first use in this function)
glxcmds.c:2670: error: (Each undeclared identifier is reported only once
glxcmds.c:2670: error: for each function it appears in.)
glxcmds.c: In function `glXReleaseTexImageEXT':
glxcmds.c:2711: error: `X_GLXvop_ReleaseTexImageEXT' undeclared (first use in this function)
make[3]: *** [glxcmds.o] Error 1
make[3]: Leaving directory `/var/tmp/portage/mesa-6.5-r3/work/Mesa-6.5/src/glx/x11'
make[2]: *** [subdirs] Error 1
make[2]: Leaving directory `/var/tmp/portage/mesa-6.5-r3/work/Mesa-6.5/src'
make[1]: *** [default] Error 1
make[1]: Leaving directory `/var/tmp/portage/mesa-6.5-r3/work/Mesa-6.5'
make: *** [linux-dri-x86-64] Error 2

!!! ERROR: media-libs/mesa-6.5-r3 failed.


But there's a whole lot of crap that looks like this

makedepend: warning:  glcontextmodes.c (reading /usr/X11R6/include/gentoo-multilib/amd64/bits/types.h, line 31): cannot find include file "stddef.h"
        not in ./stddef.h
        not in ../../../include/stddef.h
        not in ../../../include/GL/internal/stddef.h
        not in ../../../src/mesa/main/stddef.h
        not in ../../../src/mesa/glapi/stddef.h
        not in ../../../src/mesa/drivers/dri/common/stddef.h
        not in /usr/include/drm/stddef.h
        not in /usr/X11R6/include/stddef.h
        not in /usr/include/stddef.h

in the beginning. 

 emerge --info
Portage 2.1-r1 (default-linux/amd64/2006.0, gcc-3.4.6, glibc-2.3.6-r4, 2.6.15-gentoo-r7 x86_64)
=================================================================
System uname: 2.6.15-gentoo-r7 x86_64 AMD Athlon(tm) 64 Processor 3200+
Gentoo Base System version 1.12.1
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
dev-lang/python:     2.3.5-r2, 2.4.2
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/fax /usr/share/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/spool/fax/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/splash /etc/terminfo"
CXXFLAGS="-march=k8 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.rucus.ru.ac.za/pub/linux/gentoo http://gentoo.blueyonder.co.uk ftp://ftp.gentoo.mesh-solutions.com/gentoo/ http://gentoo.mirror.icd.hu/ ftp://gentoo.blueyonder.co.uk/mirrors/gentoo http://gentoo.seren.com/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X aac alsa apache2 arts avi bash-completion berkdb bitmap-fonts browserplugin bzip2 bzlib calendar cdb cdda cddb cdparanoia clamav clamd cli cpudetection crypt css cups dbase dlloader doc dri dvd dvdr dvdread eds emboss encode examples exif fam firefox flash foomaticdb fortran gif gimpprint gkrellm gnome gphoto2 gpm gps gsm gstreamer gtk gtk2 hal httpd imlib ipv6 isdnlog java javacomm jpeg jpeg2k kde kerberos ldap lm_sensors lzw lzw-tiff maildir mime mp3 mpeg mpeg4 mpi mplayer msn ncurses nls nptl nvidia oav offensive oggvorbis opengl pam pcre pdflib perl png posix ppds pppd python qt qt3 qt4 quicktime readline reflection reiserfs rss ruby samba sasl sdl session sftp spell spl sql ssl subversion tcpd threads tiff transcode truetype truetype-fonts type1-fonts unicode usb utf8 videos vorbis xgetdefault xml xmlrpc xorg xpm xprint xscreensaver xv zlib elibc_glibc input_devices_keyboard input_devices_mouse kernel_linux userland_GNU video_cards_nv video_cards_nvidia video_cards_vesa"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Wayne





          2006-07-09 02:35:29 UTC
        

Created attachment 91262 [details]
Full output while trying to emerge mesa




Comment 2


Jakub Moc (RETIRED)






          2006-07-09 02:43:27 UTC
        

Looks like your glproto is outdated.

*** This bug has been marked as a duplicate of 130174 ***




Comment 3


Wayne





          2006-07-09 03:49:43 UTC
        

I'm running 1.4.7, there doesn't seem to be anything newer. Should I downgrade?




Comment 4


Donnie Berkholz (RETIRED)






          2006-07-09 12:22:58 UTC
        

Run this: eselect opengl set --impl-headers xorg-x11, then try again.




Comment 5


Wayne





          2006-07-09 14:45:22 UTC
        

No luck, everything seems to fail the same way.




Comment 6


Joshua Baergen (RETIRED)






          2006-07-09 20:37:12 UTC
        

Try re-merging linux-headers.

Also, you should drop the PORTDIR_OVERLAY line from make.conf, since it points to the same place as PORTDIR.




Comment 7


Wayne





          2006-07-10 00:53:20 UTC
        

No luck I'm afraid :(




Comment 8


Zoltán B. Vadász





          2006-07-10 18:07:55 UTC
        

I faced with this error today when I tried to compile xserver-xorg. 
The problem is that the selected opengl include belongs to the 32 bit version not to amd64.

eselect makes a bad choince.

The solution was:
1., Start emerge of xorg-xserver
2., After it writes to console at the begining that it selected xorg-x11 as opengl implementation do what I found in the XGL HowTo:
cd /usr/include/GL
ln -sf /usr/lib64/opengl/global/include/glext.h glext.h
ln -sf /usr/lib64/opengl/xorg-x11/include/gl.h gl.h
ln -sf /usr/lib64/opengl/global/include/glxext.h glxext.h
ln -sf /usr/lib64/opengl/xorg-x11/include/glx.h glx.h
ln -sf /usr/lib64/opengl/xorg-x11/include/glxmd.h glxmd.h
ln -sf /usr/lib64/opengl/xorg-x11/include/glxproto.h glxproto.h
ln -sf /usr/lib64/opengl/xorg-x11/include/glxtokens.h glxtokens.h


So this bug maybe is not the duplicate of bug 130174.

My mesa version is: 6.4.2, glproto: 1.4.7




Comment 9


Wayne





          2006-07-11 04:35:17 UTC
        

Good call! That did the trick :) Now the next logical question is, where did I go wrong? Is it an eselect bug or did I just mess something up somewhere?




Comment 10


Joshua Baergen (RETIRED)






          2006-07-25 20:06:00 UTC
        

Sounds like a possible eselect bug (which may have been filed already).  I'll CC Jeremy so he sees this.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

