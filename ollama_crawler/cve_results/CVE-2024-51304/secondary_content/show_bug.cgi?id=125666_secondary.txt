Title: 125666 – Groff-1.19.1-r2 emerge fails with gcc-4.1.0
URL: https://bugs.gentoo.org/show_bug.cgi?id=125666

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 125666
Groff-1.19.1-r2 emerge fails with gcc-4.1.0
Last modified: 2006-03-10 11:25:23 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 125666 
      - Groff-1.19.1-r2 emerge fails with gcc-4.1.0


Summary:
Groff-1.19.1-r2 emerge fails with gcc-4.1.0
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




117482



 

        Show dependency tree





 





      Reported:
    
2006-03-09 22:20 UTC by Steve Warren





      Modified:
    
2006-03-10 11:25 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



tiago.freire









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Steve Warren





          2006-03-09 22:20:39 UTC
        

Groff emerge fails with the folloing error message when compiled with GCC-4.1.0:

input.cpp: In function 'void exit_troff()':
input.cpp:2365: error: 'process_input_stack' was not declared in this scope
input.cpp:2369: error: 'process_input_stack' was not declared in this scope
input.cpp:2370: error: 'end_diversions' was not declared in this scope
input.cpp: In function 'void process_input_stack()':
input.cpp:2661: error: 'title' was not declared in this scope
make[2]: *** [input.o] Error 1
make[2]: Leaving directory `/var/tmp/portage/groff-1.19.1-r2/work/groff-1.19.1/src/roff/troff'
make[1]: *** [src/roff/troff] Error 2
make[1]: *** Waiting for unfinished jobs....
Making tbl.n from tbl.man
i686-pc-linux-gnu-g++ -O3 -march=pentium4 -fforce-addr -fomit-frame-pointer -ftracer -pipe -D_FILE_OFFSET_BITS=64 -fvisibility-inlines-hidden  -o tbl main.o table.o /var/tmp/portage/groff-1.19.1-r2/work/groff-1.19.1/src/libs/libgroff/libgroff.a
make[2]: Leaving directory `/var/tmp/portage/groff-1.19.1-r2/work/groff-1.19.1/src/preproc/tbl'
make[1]: Leaving directory `/var/tmp/portage/groff-1.19.1-r2/work/groff-1.19.1'
make: *** [all] Error 2

!!! ERROR: sys-apps/groff-1.19.1-r2 failed.
!!! Function src_compile, Line 86, Exitcode 2
!!! (no error message)
!!! If you need support, post the topmost build error, NOT this status message.

emerge --info
Portage 2.0.54 (default-linux/x86/2006.0, gcc-4.1.0, glibc-2.3.6-r0, 2.6.15-01 i686)
=================================================================
System uname: 2.6.15-01 i686 Intel(R) Pentium(R) 4 CPU 3.20GHz
Gentoo Base System version 1.6.14
dev-lang/python:     2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=pentium4 -fforce-addr -fomit-frame-pointer -ftracer -pipe -D_FILE_OFFSET_BITS=64"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=pentium4 -fforce-addr -fomit-frame-pointer -ftracer -pipe -D_FILE_OFFSET_BITS=64 -fvisibility-inlines-hidden"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict userpriv usersandbox"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 alsa apache2 apm arts avi bash-completion berkdb bitmap-fonts bzip2 crypt cups dri eds emboss encode esd expat foomaticdb fortran gdbm gif gmp gnome gpm gstreamer gtk gtk2 imlib ipv6 jpeg kde libg++ libwww mad mikmod motif mp3 mpeg ncurses nls nptl ogg opengl oss pam pdflib perl png python qt quicktime readline sdl spell ssl tcpd truetype truetype-fonts type1-fonts udev usb vorbis xml xmms xv zlib userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY

This same version of Groff compiles fine with GCC-3.4.5 and the same CFLAGS/CXXFLAGS




Comment 1


SpanKY






          2006-03-10 06:04:24 UTC
        

works fine for me with 4.1.0

why dont you try dropping that crap from your CFLAGS and see if it works




Comment 2


Tiago Freire





          2006-03-10 07:14:31 UTC
        

amd64, shining new chroot made to test gcc:
CFLAGS="-O2  -march=k8 -ftracer -fprefetch-loop-arrays -pipe"
Failed too.

CFLAGS="-O2  -march=k8 -fprefetch-loop-arrays -pipe"
Failed too.

CFLAGS="-O2  -march=k8 -ftracer -pipe"
Failed too.

CFLAGS="-O2  -march=k8 -pipe"
Failed too.

emerge info:
Portage 2.0.54 (default-linux/amd64/2006.0, gcc-4.1.0, glibc-2.3.6-r3, 2.6.15-gentoo-r1 x86_64)
=================================================================
System uname: 2.6.15-gentoo-r1 x86_64 AMD Athlon(tm) 64 Processor 3000+
Gentoo Base System version 1.6.14
dev-lang/python:     2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2  -march=k8 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib64/mozilla/defaults/pref /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2  -march=k8 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LINGUAS="pt_BR en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://portage.cert-id.com.br/portage"
USE="amd64 X alsa avi berkdb bitmap-fonts bzip2 crypt cups dri eds emboss encode expat foomaticdb fortran gif gmp gnome gpm gstreamer gtk gtk2 imlib ipv6 jpeg kde lzw lzw-tiff mp3 mpeg ncurses nls nptl opengl pam pdflib perl png python qt quicktime readline sdl spell ssl symlinks tcpd tiff truetype-fonts type1-fonts udev usb userlocales xpm xv zlib linguas_pt_BR linguas_en userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, PORTDIR_OVERLAY




Comment 3


Tiago Freire





          2006-03-10 07:19:16 UTC
        

Just for the record, I removed ALL CFLAGS and the problem persists.




Comment 4


SpanKY






          2006-03-10 07:44:36 UTC
        

"-O2 -march=k8" works for me with gcc-4.1.0

post a full error log:
MAKEOPTS=-j1 emerge groff >& log




Comment 5


Steve Warren





          2006-03-10 08:12:09 UTC
        

groff-1.19.2-r1 works with gcc-4.1.0.  

CFLAGS="-O3 -march=pentium4 -fforce-addr -fomit-frame-pointer -ftracer -pipe -D_FILE_OFFSET_BITS=64"
CXXFLAGS="-O3 -march=pentium4 -fforce-addr -fomit-frame-pointer -ftracer -pipe -D_FILE_OFFSET_BITS=64 -fvisibility-inlines-hidden"

The errors that I listed are coding errors in the input.cpp file and have nothing to do with CFLAGS/CXXFLAGS.  Apparently gcc-4.1.0 needs cleaner code than gcc-3.4.x.  For now groff-1.19.2-r1 is marked ~x86, but it comiles whereas the 'stable' version does not.




Comment 6


Guillaume Pujol





          2006-03-10 08:34:19 UTC
        

I confirm, groff-1.19.1-r2 fails to compile with GCC 4.1.0 whereas groff-1.19.2-r1 sucesses. (CFLAGS="-Os -march=athlon-xp -mtune=athlon-xp -pipe -fomit-frame-pointer")
This seems to be simply "syntax related", like g++ and Steve just say.




Comment 7


SpanKY






          2006-03-10 10:26:35 UTC
        

indeed, i'm building 1.19.2 here, not 1.19.1




Comment 8


Tiago Freire





          2006-03-10 11:02:11 UTC
        

I think gcc-4.1.0 should block groff 1.19.1.
1.19.2-r1 compiled fine here too.




Comment 9


SpanKY






          2006-03-10 11:25:23 UTC
        

not going to happen









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

