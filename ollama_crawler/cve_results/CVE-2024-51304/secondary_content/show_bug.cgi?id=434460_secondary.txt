Title: 434460 – sys-kernel/gentoo-sources-3.5.3 - kernel BUG at drivers/ata/libata-sff.c:1299! // invalid opcode: 0000 [#1]
URL: https://bugs.gentoo.org/show_bug.cgi?id=434460

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 434460
sys-kernel/gentoo-sources-3.5.3 - kernel BUG at drivers/ata/libata-sff.c:1299! // invalid opcode: 0000 [#1]
Last modified: 2012-12-20 14:54:42 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 434460 
      - sys-kernel/gentoo-sources-3.5.3 - kernel BUG at drivers/ata/libata-sff.c:1299! // invalid opcode: 0000 [#1]


Summary:
sys-kernel/gentoo-sources-3.5.3 - kernel BUG at drivers/ata/libata-sff.c:1299...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Kernel Bug Wranglers and Kernel Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-09-09 14:26 UTC by Michail





      Modified:
    
2012-12-20 14:54 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



bruce
gokturk









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




boot and panic

              (panic.log,40.21 KB,
                text/plain)

            
2012-09-09 14:26 UTC,

            Michail




Details





/proc/config.gz as requested

              (config.gz,16.95 KB,
                application/octet-stream)

            
2012-10-01 06:19 UTC,

            Michail




Details





'dmesg' output

              (dmesg.10_06_2012,52.32 KB,
                text/plain)

            
2012-10-06 07:24 UTC,

            Michail




Details





Patch to debug hsm state

              (debug_hsm_state.patch,406 bytes,
                patch)

            
2012-10-06 20:18 UTC,

            Göktürk Yüksek




Details
            | Diff





kernel panic with patch to debug hsm state

              (11oct2012.txt,49.20 KB,
                text/plain)

            
2012-10-11 20:31 UTC,

            Michail




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Michail





          2012-09-09 14:26:17 UTC
        

Created attachment 323306 [details]
boot and panic

There is a kernel panic in the gentoo-sources-3.5.3. Sometimes it happens within ~30 min after boot, sometimes it don't. Log with netconsole in the attachment.




Comment 1


Michail





          2012-09-09 14:34:45 UTC
        

Portage 2.2.0_alpha123 (default/linux/amd64/10.0, gcc-4.5.4, glibc-2.15-r2, 3.5.3-gentoo x86_64)
=================================================================
System uname: Linux-3.5.3-gentoo-x86_64-AMD_Phenom-tm-_II_X4_955_Processor-with-gentoo-2.1
Timestamp of tree: Wed, 05 Sep 2012 04:45:01 +0000
distcc 3.1 x86_64-pc-linux-gnu [disabled]
app-shells/bash:          4.2_p37
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.3-r2, 3.2.3
dev-util/cmake:           2.8.8-r3
dev-util/pkgconfig:       0.27
sys-apps/baselayout:      2.1-r1
sys-apps/openrc:          0.9.8.4
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.8.5-r4, 1.9.6-r2, 1.10.3, 1.11.6
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.3.4, 4.4.4-r2, 4.5.4
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82-r3
sys-kernel/linux-headers: 3.4-r2 (virtual/os-headers)
sys-libs/glibc:           2.15-r2
Repositories: gentoo berkano science voyageur gnustep kde rion pcsx2 multimedia games enlightenment-niifaq sage-on-gentoo kde-sunset lisp zugaina njw x11 pure-funtoo qt sunrise roslin my gamerlay-stable
Installed sets: @kde-4.8, @kde-4.9, @kdebase, @plasmoids
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA dlj-1.1"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-pipe -O2"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-pipe -O2"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles news parallel-fetch parse-eapi-ebuild-head preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://91.121.125.139/gentoo-distfiles/ http://gentoo.mneisen.org/ http://91.121.124.139/gentoo-distfiles/"
LANG="ru_RU.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en ru"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/berkano /usr/portage/local/layman/science /usr/portage/local/layman/voyageur /usr/portage/local/layman/gnustep /usr/portage/local/layman/kde-testing /usr/portage/local/layman/rion /usr/portage/local/layman/pcsx2 /usr/portage/local/layman/multimedia /usr/portage/local/layman/games /usr/portage/local/layman/enlightenment-niifaq /usr/portage/local/layman/sage-on-gentoo /usr/portage/local/layman/kde-sunset /usr/portage/local/layman/lisp /usr/portage/local/layman/zugaina /usr/portage/local/layman/njw /usr/portage/local/layman/x11 /usr/portage/local/layman/pure-funtoo /usr/portage/local/layman/qt /usr/portage/local/layman/sunrise /usr/portage/local/layman/roslin /usr/portage/local/my /usr/portage/local/layman/gamerlay"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="3dnow X a52 aac aalib accessibility acl acpi alsa amd64 ao berkdb bidi bzip2 cairo cdparanoia cjk cli cracklib crypt cups curl cvs cxx dbus dga djvu dri dvb dvd examples exif fam ffmpeg fftw flac fontconfig fortran ftp gcj gdbm ggi gif gimp gnutls gphoto2 gpm gps graphviz gsm gstreamer hal hdf5 iconv icu idn ieee1394 imagemagick imlib ipv6 java jbig joystick jpeg jpeg2k kerberos ladspa lapack latex lcms ldap libcaca libsamplerate lm_sensors lua lzo mad matroska mikmod mmap mmx mng modules mp3 mpeg mpi mudflap multilib musepack musicbrainz mysql ncurses netcdf nls nntp nptl nsplugin ofx ogg openal openexr opengl openmp oscar pam pch pcre pdf plasma plotutils png policykit portaudio postscript ppds pppd pulseaudio python qt3 qt3support qt4 raw readline rss samba scanner sdl semantic-desktop session slang smp sndfile speex spell sqlite sse sse2 ssl startup-notification subversion svg tcl tcpd theora threads tiff timidity tk truetype unicode usb v4l v4l2 vaapi vcd vdpau videos vim-syntax vorbis wavpack wmf x264 xcb xcomposite xface xft xml xpm xscreensaver xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump" CAMERAS="canon" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" FOO2ZJS_DEVICES="hp1018 hp1215" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LINGUAS="en ru" PHP_TARGETS="php5-3" PYTHON_TARGETS="python3_2 python2_7" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="radeon vesa" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON




Comment 2


Göktürk Yüksek







          2012-09-26 18:33:16 UTC
        

I don't see any ata related messages in dmesg. Can you upload your .config and try enabling 'CONFIG_ATA_VERBOSE_ERROR'. Something useful may come up. This may be related to [0], since you hit the BUG in the same function. The call stack also share similarities.

[0] https://bugzilla.redhat.com/show_bug.cgi?id=524243




Comment 3


Michail





          2012-10-01 06:19:37 UTC
        

Created attachment 325440 [details]
/proc/config.gz as requested




Comment 4


Michail





          2012-10-01 06:21:34 UTC
        

'CONFIG_ATA_VERBOSE_ERROR' is set in kernel.

anything else I can do?




Comment 5


Göktürk Yüksek







          2012-10-03 15:49:11 UTC
        

(In reply to comment #4)
> 'CONFIG_ATA_VERBOSE_ERROR' is set in kernel.
> 
> anything else I can do?

Anything noteworthy in dmesg? any ATA warnings or errors?




Comment 6


Michail





          2012-10-06 07:20:50 UTC
        

I'll attach a 'dmesg' command output. There is no kernel panic, just normal boot process. There is something about ata:
ata1: softreset failed(device not ready)
ata1: applying PMP SRST workaround and retrying




Comment 7


Michail





          2012-10-06 07:24:37 UTC
        

Created attachment 325766 [details]
'dmesg' output




Comment 8


mingdao





          2012-10-06 12:45:55 UTC
        

See http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=b6931c1fbaf7fda9ea7f120228a96600d7090049




Comment 9


Göktürk Yüksek







          2012-10-06 20:18:14 UTC
        

Created attachment 325830 [details, diff]
Patch to debug hsm state

If you want to debug this further, please apply this patch. It's nothing but a simple print function to print out the hsm state just before you hit the line that triggers the panic.

If you believe this is a regression, you can also bisect it.

In my opinion this looks like a hardware issue.




Comment 10


Michail





          2012-10-11 20:31:20 UTC
        

Created attachment 326328 [details]
kernel panic with patch to debug hsm state

this machine is dualboot(linux and winxp).
winxp works flawlessly, so I dunno about hardware issue
(well, it can be hardware issue, but with windows there wasn't any evidence)




Comment 11


Mike Pagano






          2012-12-19 19:28:23 UTC
        

It's been 2 months, is this still an issue with the latest kernel, which is 3.7.1 as of this writing?




Comment 12


Michail





          2012-12-20 08:30:04 UTC
        

This error stopped from appearing some time ago.
Probably it is a hardware issue after all.




Comment 13


Mike Pagano






          2012-12-20 14:54:42 UTC
        

ok, thanks for responding. Closing at this time.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

