Title: 196613 – Unable to load a correct keyboard layout on xorg-x11-7.2
URL: https://bugs.gentoo.org/show_bug.cgi?id=196613

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 196613
Unable to load a correct keyboard layout on xorg-x11-7.2
Last modified: 2007-10-22 08:11:03 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 196613 
      - Unable to load a correct keyboard layout on xorg-x11-7.2


Summary:
Unable to load a correct keyboard layout on xorg-x11-7.2
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-10-21 14:28 UTC by garfungiloops





      Modified:
    
2007-10-22 08:11 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


garfungiloops





          2007-10-21 14:28:18 UTC
        

when starting X, I always have the warning in the Xorg.0.log:

(WW) Couldn't load XKB keymap, falling back to pre-XKB keymap 

When trying to set up the default model/layout:

setxkbmap -model pc105 -layout us -variant dvorak -v 10 
Setting verbose level to 10
locale is C
Applied rules from xorg:
model: pc105
layout: us
variant: dvorak
Trying to build keymap using the following components:
keycodes: xfree86+aliases(qwerty)
types: complete
compat: complete
symbols: pc/pc(pc105)+pc/us(dvorak)
geometry: pc(pc105)
Error loading new keyboard description

This problem appears with the upgrade to 7.2
on the previous stable xorg it was ok with opions pc105/us

Reproducible: Always




root:~# emerge --info
Portage 2.1.3.9 (default-linux/x86/2006.1, gcc-4.1.2, glibc-2.6.1-r0, 2.6.22-gentoo-r8 i686)
=================================================================
System uname: 2.6.22-gentoo-r8 i686 AMD Athlon(tm) XP 3100+
Timestamp of tree: Thu, 18 Oct 2007 18:32:01 +0000
app-shells/bash:     3.2_p17
dev-java/java-config: 1.3.7, 2.1.2-r1
dev-lang/python:     2.3.5-r3, 2.4.4-r5
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 1.12.9-r2
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.3.16
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.22-r2
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=athlon-xp -pipe -fomit-frame-pointer -mfpmath=sse"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O3 -march=athlon-xp -pipe -fomit-frame-pointer -mfpmath=sse"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://mirror.switch.ch/mirror/gentoo/ http://distfiles.gentoo.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
LANG="en_US.UTF-8"
LC_ALL="en_US.UTF-8"
LINGUAS="en ru de"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow X a52 aac alsa berkdb bidi bitmap-fonts cdr cli clucene cracklib crypt cups cvs dbus directfb divx4linux dri dvd dvdr dvdread encode exif faad fbcon ffmpeg fortran gdbm gif gimpprint glitz gpm gtk hal icc iconv imagemagick imlib ipv6 isdnlog jack jpeg kde mad matroska midi mjpeg mmx mozilla mp3 mpeg mudflap ncurses nls nptl nptlonly nvidia ogg opengl openmp oss pam pcre pdf perl png ppds pppd python qt qt3 qt4 readline real reflection session slang spl sql sqlite3 sse ssl tcpd threads tiff truetype truetype-fonts type1-fonts unicode usb v4l v4l2 vidix vorbis win32codecs wxwindows x86 xcomposite xine xml xorg xv xvid zlib" ALSA_CARDS="intel8x0 usb-audio" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en ru de" USERLAND="GNU" VIDEO_CARDS="nvidia"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, MAKEOPTS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Jakub Moc (RETIRED)






          2007-10-21 14:32:05 UTC
        

xkeyboard-config version? xorg-server version? 




Comment 2


garfungiloops





          2007-10-21 16:52:22 UTC
        

(In reply to comment #1)
> xkeyboard-config version? xorg-server version? 
> 

x11-base/xorg-server-1.3.0.0-r1
x11-misc/xkbdata-1.0.1

with xkeyboard-config it's also a problem
but different error




Comment 3


Jakub Moc (RETIRED)






          2007-10-21 17:23:47 UTC
        

We don't support xkbdata; sorry. The ebuild will be removed. Please file a new bug about xkeyboard-config is you have issues with that.




Comment 4


garfungiloops





          2007-10-22 07:40:17 UTC
        

Ok,

unmerged xkbdata, emerged x11-misc/xkeyboard-config-0.9 (last stable)

Now the error is:
root:~# setxkbmap -v 10
Setting verbose level to 10
locale is C
Couldn't find rules file (xorg)

Also when you follow the official manual:
http://www.gentoo.org/proj/en/desktop/x/x11/modular-x-howto.xml
and try to get your KB model from "xorg.lst", it's impossible
because this file seems binary now. The right one is xorg i guess.
So we need to change the manual as well.





Comment 5


Jakub Moc (RETIRED)






          2007-10-22 07:46:26 UTC
        

Attach an strace here, you have some symlinks messed up on your system.





Comment 6


garfungiloops





          2007-10-22 08:03:20 UTC
        

Ok,

Perhaps it was just a problem that I've forgot "etc-update".
Anyway I've installed the newer x11-misc/xkeyboard-config-1.1
Now I have the same problem as at the beginning:

root:/usr/share/X11/xkb/rules# setxkbmap -v 10
Setting verbose level to 10
locale is C
Applied rules from xorg:
model:      pc105
layout:     us
variant:    dvorak
Trying to build keymap using the following components:
keycodes:   xfree86+aliases(qwerty)
types:      complete
compat:     complete
symbols:    pc+us(dvorak)
geometry:   pc(pc105)
Error loading new keyboard description


Do you still want to see strace?




Comment 7


Jakub Moc (RETIRED)






          2007-10-22 08:11:03 UTC
        

No, that's dupe of Bug 194026, upgrade your xorg-server to 1.3.0.0-r2









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

