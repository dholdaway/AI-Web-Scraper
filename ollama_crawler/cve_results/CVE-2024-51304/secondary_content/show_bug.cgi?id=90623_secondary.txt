Title: 90623 – hercules-3.0.2 fails to compile
URL: https://bugs.gentoo.org/show_bug.cgi?id=90623

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 90623
hercules-3.0.2 fails to compile
Last modified: 2007-04-07 14:34:57 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 90623 
      - hercules-3.0.2 fails to compile


Summary:
hercules-3.0.2 fails to compile
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

s390 team








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

90624

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2005-04-27 08:15 UTC by Rene Zbinden





      Modified:
    
2007-04-07 14:34 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jmaynard









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Patch for hercules-3.02.ebuild 

              (hercules-3.02.patch,330 bytes,
                patch)

            
2005-05-24 07:20 UTC,

            Rene Zbinden




Details
            | Diff





Patch for hercules-3.02.ebuild

              (hercules-3.02.patch,379 bytes,
                patch)

            
2005-05-25 00:07 UTC,

            Rene Zbinden




Details
            | Diff





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Rene Zbinden





          2005-04-27 08:15:08 UTC
        

I get the following error during comile:
<snip>
if /bin/sh ./libtool --mode=compile i686-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I
. -I.  -I. -I./intl   -O2 -march=pentium4 -mtune=pentium4 -fforce-addr -momit-le
af-frame-pointer -fomit-frame-pointer -ftracer -pipe -W -Wall  -MT io.lo -MD -MP
 -MF ".deps/io.Tpo" \
  -c -o io.lo `test -f 'io.c' || echo './'`io.c; \
then mv -f ".deps/io.Tpo" ".deps/io.Plo"; \
else rm -f ".deps/io.Tpo"; exit 1; \
fi
 i686-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I. -I. -I. -I./intl -O2 -march=penti
um4 -mtune=pentium4 -fforce-addr -momit-leaf-frame-pointer -fomit-frame-pointer 
-ftracer -pipe -W -Wall -MT io.lo -MD -MP -MF .deps/io.Tpo -c io.c  -fPIC -DPIC 
-o .libs/io.o
if /bin/sh ./libtool --mode=compile i686-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I. -I.  -I. -I./intl   -O2 -march=pentium4 -mtune=pentium4 -fforce-addr -momit-leaf-frame-pointer -fomit-frame-pointer -ftracer -pipe -W -Wall  -MT chsc.lo -MD -MP -MF ".deps/chsc.Tpo" \
  -c -o chsc.lo `test -f 'chsc.c' || echo './'`chsc.c; \
then mv -f ".deps/chsc.Tpo" ".deps/chsc.Plo"; \
else rm -f ".deps/chsc.Tpo"; exit 1; \
fi
 i686-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I. -I. -I. -I./intl -O2 -march=pentium4 -mtune=pentium4 -fforce-addr -momit-leaf-frame-pointer -fomit-frame-pointer -ftracer -pipe -W -Wall -MT chsc.lo -MD -MP -MF .deps/chsc.Tpo -c chsc.c  -fPIC -DPIC -o .libs/chsc.o
control.c: In function `s390_program_return':
control.c:3150: error: impossible register constraint in `asm'
control.c:3150: error: impossible register constraint in `asm'
control.c:3150: error: impossible register constraint in `asm'
control.c:3150: error: impossible register constraint in `asm'
control.c:3370: error: unrecognizable insn:
(insn:HI 2242 2494 2243 1 control.c:3342 (parallel [
            (set (reg/v:SI 2 cx [orig:118 n ] [118])
                (asm_operands/v:SI ("cld
        movl    %0,%%edx
        shrl    $2,%%ecx
        rep     stosl
        movl    %%edx,%0
        andl    $3,%0
        rep     stosb
        ") ("=&c") 0 [
                        (reg/v/f:SI 5 di [orig:116 to ] [116])
                        (reg:SI 29 mm0)
                        (reg/v:SI 2 cx [orig:118 n ] [118])
                    ]
                     [
                        (asm_input:SI ("1"))
                        (asm_input:SI ("ax"))
                        (asm_input:SI ("0"))
                    ] ("control.c") 3150))
            (set (reg/v/f:SI 5 di [orig:116 to ] [116])
                (asm_operands/v:SI ("cld
        movl    %0,%%edx
        shrl    $2,%%ecx
        rep     stosl
        movl    %%edx,%0
        andl    $3,%0
        rep     stosb
        ") ("=&D") 1 [
                        (reg/v/f:SI 5 di [orig:116 to ] [116])
                        (reg:SI 29 mm0)
                        (reg/v:SI 2 cx [orig:118 n ] [118])
                    ]
                     [
                        (asm_input:SI ("1"))
                        (asm_input:SI ("ax"))
                        (asm_input:SI ("0"))
                    ] ("control.c") 3150))
            (clobber (reg:QI 19 dirflag))
            (clobber (reg:QI 18 fpsr))
            (clobber (reg:QI 17 flags))
            (clobber (mem:BLK (scratch) [0 A8]))
            (clobber (reg:QI 1 dx))
        ]) -1 (insn_list 2239 (insn_list 2241 (nil)))
    (nil))
control.c:3370: confused by earlier errors, bailing out
make[2]: *** [control.lo] Error 1
make[2]: *** Waiting for unfinished jobs....
make[2]: Leaving directory `/var/tmp/portage/hercules-3.02/work/hercules-3.02'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/hercules-3.02/work/hercules-3.02'
make: *** [all] Error 2

!!! ERROR: app-emulation/hercules-3.02 failed.
!!! Function src_compile, Line 35, Exitcode 2
!!! emake failed


Reproducible: Always
Steps to Reproduce:
1.emerge hercules
2.
3.

Actual Results:  
Did not compile.

Expected Results:  
Should compile.

Portage 2.0.51.19 (default-linux/x86/2005.0, gcc-3.4.3-20050110, glibc-2.3.5-r0,
 2.6.11-gentoo-r6 i686)
=================================================================
System uname: 2.6.11-gentoo-r6 i686 Intel(R) Pentium(R) 4 CPU 2.40GHz
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Apr 19 2005, 22:47:59)
]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r7
sys-devel/libtool:   1.5.16
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-O2 -march=pentium4 -mtune=pentium4 -fforce-addr -momit-leaf-frame-point
er -fomit-frame-pointer -ftracer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env /usr/kde/3.3/share
/config /usr/kde/3.3/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/shar
e/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O2 -march=pentium4 -mtune=pentium4 -fforce-addr -momit-leaf-frame-poi
nter -fomit-frame-pointer -ftracer -pipe -fvisibility-inlines-hidden"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://mirror.switch.ch/mirror/gentoo/ ftp://mirror.switch.ch/mi
rror/gentoo/"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages/sys-apps"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X alsa apm arts avi berkdb bitmap-fonts cdr crypt cups curl divx4linux 
emboss encode esd fam flac foomaticdb fortran gdbm gif gnome gpm gtk gtk2 imagem
agick imlib ipv6 ithreads java jpeg lcms libg++ libwww mad mikmod motif mozilla 
mp3 mpeg ncurses nls nocd nptl ogg oggvorbis opengl pam pdflib perl png pthreads
 python quicktime readline samba scanner sdl spell sse ssl svga tcltk tcpd tiff 
truetype truetype-fonts type1-fonts usb vorbis xml2 xmms xv xvid zlib video_card
s_radeon"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS




Comment 1


Jakub Moc (RETIRED)






          2005-04-27 08:44:46 UTC
        

*** Bug 90624 has been marked as a duplicate of this bug. ***




Comment 2


Georg Müller





          2005-05-10 03:14:56 UTC
        

Same here.

But it compiles fine on amd64.




Comment 3


Rene Zbinden





          2005-05-24 07:20:22 UTC
        

Created attachment 59702 [details, diff]
Patch for hercules-3.02.ebuild 

With that patch the ebuild compiles fine on my system. The problem whas that I
had to replace the -march=pentium4 flag with -mcpu=pentium4 flag.




Comment 4


Rene Zbinden





          2005-05-25 00:07:47 UTC
        

Created attachment 59762 [details, diff]
Patch for hercules-3.02.ebuild

The same issue for the march=pentium-m flag. replaced with mcpu=pentium-m. this
solved the compiling error.




Comment 5


Jakub Moc (RETIRED)






          2005-10-10 23:39:40 UTC
        

Re-assign wrt Bug 44756... If someone picks this up, please remove killsoft from
metadata.xml.




Comment 6


Jay Maynard





          2005-12-20 10:56:21 UTC
        

Fixed with 3.03. Note that the 3.03 ebuild does not attempt to use 
the user's CFLAGS, so this will not be an issue there.




Comment 7


Alec Warner (RETIRED)








          2006-08-03 16:33:39 UTC
        

old




Comment 8


SpanKY






          2007-04-07 14:34:47 UTC
        

that isnt a bug in hercules, it's a bug in the compiler ... upgrade to current stable









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

