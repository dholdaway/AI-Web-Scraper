Title: 275407 – dev-util/subversion-1.6.3 segfaults with kde use flag when accessing wallet
URL: https://bugs.gentoo.org/show_bug.cgi?id=275407

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 275407
dev-util/subversion-1.6.3 segfaults with kde use flag when accessing wallet
Last modified: 2010-02-27 16:02:24 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 275407 
      - dev-util/subversion-1.6.3 segfaults with kde use flag when accessing wallet


Summary:
dev-util/subversion-1.6.3 segfaults with kde use flag when accessing wallet
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        All
      







Importance:
      
High
       normal
      


Assignee:

Arfrever Frehtes Taifersar Arahesis (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-06-25 14:59 UTC by Clint Valusek





      Modified:
    
2010-02-27 16:02 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



dilfridge
kde
ludek_h









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Clint Valusek





          2009-06-25 14:59:18 UTC
        

When running svn up, subversion segfaults as it accesses the wallet.  The wallet appears, ask for you password, then subversion segfaults.  My kde version is 4.2.4 and this entry would be a new entry to the wallet I believe because my wallet was settings were recently reset.  The wallet does work in other scenarios.

Temporary solution is to compile subversion without the kde use flag.

I am filing this as critical because the software is crashing, but feel free to downgrade the severity.

Reproducible: Always

Steps to Reproduce:
1. Compile and setup kde 4.2.4
2. Compile subversion with kde use flag.
3. Open a terminal and cd to a svn repo.
4. Run an svn up on the repo.

Actual Results:  
subversion segfaults

Expected Results:  
updated the repository

Portage 2.1.6.13 (default/linux/x86/2008.0, gcc-4.3.2, glibc-2.8_p20080602-r1, 2.6.29-gentoo-r5 i686)
=================================================================                                    
System uname: Linux-2.6.29-gentoo-r5-i686-Intel-R-_Core-TM-2_Duo_CPU_P8400_@_2.26GHz-with-glibc2.0   
Timestamp of tree: Wed, 24 Jun 2009 14:00:01 +0000                                                   
ccache version 2.4 [enabled]                                                                         
app-shells/bash:     3.2_p39                                                                         
dev-java/java-config: 2.1.7                                                                          
dev-lang/python:     2.5.4-r2                                                                        
dev-util/ccache:     2.4-r7                                                                          
dev-util/cmake:      2.6.4
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.5, 1.7.9-r1, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=i686 -pipe -s"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O3 -march=i686 -pipe -s"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests ccache digests distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LDFLAGS="-Wl,-O1"
LINGUAS="en"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X acl alsa apache2 berkdb bzip2 cdr cli cracklib crypt cups dbus dri dvd fortran gdbm gpm iconv ipv6 isdnlog jpeg kde laptop midi mmx mmxext mudflap mysql ncurses nls nptl nptlonly opengl openmp pam pcre perl php5 png pppd python qt3 qt4 readline reflection session spl sse sse2 ssl ssse3 sysfs tcpd unicode webkit x86 xcomposite xinerama xorg zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" APACHE2_MPMS="worker" ELIBC="glibc" INPUT_DEVICES="keyboard synaptics mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en" USERLAND="GNU" VIDEO_CARDS="intel"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Maciej Mrozowski






          2009-06-27 03:44:47 UTC
        

Do you have some valuable backtrace to attach as well?

CC-ing upstream

(btw, who assigned it to KDE team :P)




Comment 2


Clint Valusek





          2009-06-27 03:53:05 UTC
        

i assigned kde because i thought it was probably a kde specific issue, i will see if i can get a stack backtrace as well

if we need to move the bug to a more appropriate team please do so =0)




Comment 3


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2009-06-27 10:07:15 UTC
        

Rebuild dev-util/subversion and kde-base/kdelibs with:
CFLAGS="-ggdb3 -march=i686 -pipe"
CXXFLAGS="-ggdb3 -march=i686 -pipe"
FEATURES="nostrip"

Next attach the output of running:
gdb --args svn ${COMMAND} ${OPTIONS}
r




Comment 4


Arfrever Frehtes Taifersar Arahesis (RETIRED)






          2009-06-27 10:09:14 UTC
        

If you don't have 'gdb' program, then install sys-devel/gdb.




Comment 5


anomen





          2009-07-31 19:39:10 UTC
        

#0  0x00007f1b84640da0 in kwallet_password_set () from /usr/lib/libsvn_auth_kwallet-1.so.0
#1  0x00007f1b87fc9f90 in svn_auth__simple_save_creds_helper () from /usr/lib64/libsvn_subr-1.so.0
#2  0x00007f1b84640570 in kwallet_simple_save_creds () from /usr/lib/libsvn_auth_kwallet-1.so.0
#3  0x00007f1b87faec31 in svn_auth_save_credentials () from /usr/lib64/libsvn_subr-1.so.0
#4  0x00007f1b895cff53 in svn_ra_neon__do_get_uuid () from /usr/lib64/libsvn_ra_neon-1.so.0
#5  0x00007f1b8adf2b27 in svn_ra_open3 () from /usr/lib64/libsvn_ra-1.so.0
#6  0x00007f1b8b278197 in svn_client__open_ra_session_internal () from /usr/lib64/libsvn_client-1.so.0
#7  0x00007f1b8b27d1ab in svn_client__update_internal () from /usr/lib64/libsvn_client-1.so.0
#8  0x00007f1b8b24fd6e in svn_client__checkout_internal () from /usr/lib64/libsvn_client-1.so.0
#9  0x00007f1b8b25b0dd in svn_client_checkout3 () from /usr/lib64/libsvn_client-1.so.0
#10 0x0000000000406ffb in svn_cl__checkout ()
#11 0x000000000040e42d in main ()

Program received signal SIGSEGV, Segmentation fault.
0x00007f1b84641060 in kwallet_password_set () from /usr/lib/libsvn_auth_kwallet-1.so.0

rip            0x7f1b84641060   0x7f1b84641060 <kwallet_password_set(apr_hash_t*, char const*, char const*, char const*, apr_hash_t*, int, apr_pool_t*)+704>

right now i dont't have source line numbers available, but after disassembly, i think it's one of the wallet->...folder() method calls (presumably the first one)





Comment 6


Andreas K. Hüttel







          2010-01-23 17:31:54 UTC
        

Do you know if it also crashes if the wallet is already open, or only if the wallet has to be opened for svn?





Comment 7


anomen





          2010-01-23 18:34:50 UTC
        

cannot reproduce with dev-util/subversion-1.6.6-r10 & kde-4.3.3,
seems to work fine.





Comment 8


Andreas K. Hüttel







          2010-02-21 17:47:06 UTC
        

(In reply to comment #7)
> cannot reproduce with dev-util/subversion-1.6.6-r10 & kde-4.3.3,
> seems to work fine.
> 

Same here. 

I've seen this occur sometime last year (i.e. many updates ago), but now I am using kde-4.4.0 and subversion-1.6.6-r10 all the time and nothing bad happened for weeks...





Comment 9


Andreas K. Hüttel







          2010-02-27 16:02:24 UTC
        

Not in tree anymore, resolving.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

