Title: 723650 – net-p2p/syncthing-1.5.0 build fails with go - used for two different module paths
URL: https://bugs.gentoo.org/show_bug.cgi?id=723650

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 723650
net-p2p/syncthing-1.5.0 build fails with go - used for two different module paths
Last modified: 2020-05-20 09:55:03 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 723650 
      - net-p2p/syncthing-1.5.0 build fails with go - used for two different module paths


Summary:
net-p2p/syncthing-1.5.0 build fails with go - used for two different module p...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Marek Szuba (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-05-18 09:50 UTC by simon





      Modified:
    
2020-05-20 09:55 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge info

              (syncthing_emerge_info,6.32 KB,
                text/plain)

            
2020-05-18 09:50 UTC,

            simon




Details





build log

              (net-p2p:syncthing-1.5.0:20200518-092129.log,17.53 KB,
                text/x-log)

            
2020-05-18 09:53 UTC,

            simon




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


simon





          2020-05-18 09:50:03 UTC
        

packagefile internal/race=/usr/lib/go/pkg/linux_amd64/internal/race.a
EOF
mkdir -p $WORK/b001/exe/
cd .
/usr/lib/go/pkg/tool/linux_amd64/link -o $WORK/b001/exe/build -importcfg $WORK/b001/importcfg.link -s -w -buildmode=exe -buildid=SHRXP0ekGy9MHz1d-NE7/jqxybGeekr6aVeModQ_g/LJnZnff3UuIaDHlDWjZW/SHRXP0ekGy9MHz1d-NE7 -extld=x86_64-pc-linux-gnu-gcc $WORK/b001/_pkg_.a
$WORK/b001/exe/build -version v1.5.0 -no-upgrade install
go: github.com/twmb/murmur3@v1.1.3 used for two different module paths (github.com/spaolacci/murmur3 and github.com/twmb/murmur3)
exit status 1
exit status 1
 * ERROR: net-p2p/syncthing-1.5.0::gentoo failed (compile phase):
 *   build failed


Reproducible: Always

Steps to Reproduce:
1. emerge =syncthing-1.5.0
2. 
3.
Actual Results:  
build fails




Comment 1


simon





          2020-05-18 09:50:55 UTC
        

Created attachment 640040 [details]
emerge info




Comment 2


simon





          2020-05-18 09:53:34 UTC
        

Created attachment 640042 [details]
build log




Comment 3


Marek Szuba (RETIRED)







          2020-05-19 12:27:11 UTC
        

I cannot reproduce this, regardless of whether I install syncthing-1.5.0 (which is the one using twmb/murmur3) on a clean system or upgrade from 1.4.2 (which is the one using spaolacci/murmur3). Are you sure you haven't got a copy of the latter lying around somewhere where Go can pick it up?




Comment 4


simon





          2020-05-20 09:39:39 UTC
        

Thanks for the reply:

yes and no. I don't have murmur installed any more on that system.
I tried to search for remainders and found some in /var/lib/murmur (not sure why because i use emerge for de-installation as well).
I moved that folder away but that did not change the result.
Outside portage i have murmur hints as shown below. 
Could you hint me on how the build in go can be influenced so i can precise my search what influences this on my machine?
The error only refers to URLs and not locations in my build environment or my local installations.

locate murmur | grep -v portage

/etc/config-archive/etc/murmur
/etc/config-archive/etc/murmur/murmur.ini
/etc/config-archive/etc/murmur/murmur.ini.dist
/usr/include/libavutil/murmur3.h
/usr/lib64/node_modules/npm/node_modules/imurmurhash
/usr/lib64/node_modules/npm/node_modules/imurmurhash/imurmurhash.js
/usr/lib64/node_modules/npm/node_modules/imurmurhash/imurmurhash.min.js
/usr/lib64/node_modules/npm/node_modules/imurmurhash/package.json
/usr/share/nmap/scripts/murmur-version.nse
/var/log/murmur
/var/log/murmur/murmur.log
/var/log/murmur/murmur.log-20130203

the lib64 seems to be owned by nodejs
net-libs/nodejs-12.16.1 (/usr/lib64/node_modules/npm/node_modules/imurmurhash)




Comment 5


simon





          2020-05-20 09:55:03 UTC
        

after sending my question i found out that i was still using go-1.13.10.
Once i updated to current stable 1.14.2 also the build error for syncthing was gone. 
Not sure if such things are/should be expressed as dependency somehow. Please consider. For me the issue is resolved and Thanks for the work here.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

