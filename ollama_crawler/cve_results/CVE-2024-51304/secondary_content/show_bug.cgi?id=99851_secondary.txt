Title: 99851 – xmlto won't build; "failed to load (...) docboc.xsl"
URL: https://bugs.gentoo.org/show_bug.cgi?id=99851

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 99851
xmlto won't build; "failed to load (...) docboc.xsl"
Last modified: 2006-06-07 09:12:50 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 99851 
      - xmlto won't build; "failed to load (...) docboc.xsl"


Summary:
xmlto won't build; "failed to load (...) docboc.xsl"
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Text-Markup Team (OBSOLETE)








URL:







Whiteboard:




Keywords:









Duplicates (3):
    

116255 130152 133432

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2005-07-21 16:24 UTC by Tobias Brox





      Modified:
    
2006-06-07 09:12 UTC
      (History)
    




          CC List:
        

8 
          users
          
            (show)
          



37
gentoo
gregkh
jakub
jsado_sc3
mark-gentoo
t.hirsch
ufechner









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




/etc/xml/docbook, as requested

              (docbook,10.87 KB,
                text/plain)

            
2005-07-22 03:32 UTC,

            Tobias Brox




Details





/etc/xml/catalog, as requested

              (catalog,1.09 KB,
                text/plain)

            
2005-07-22 03:32 UTC,

            Tobias Brox




Details





Output from merging docbook-xsl-stylesheets, as requested

              (emergelog,250.27 KB,
                text/plain)

            
2005-07-22 08:46 UTC,

            Tobias Brox




Details





/etc/xml/docbook from ufechner

              (docbook,10.69 KB,
                text/plain)

            
2005-07-26 12:04 UTC,

            Uwe Fechner




Details





/etc/xml/catalog from ufechner

              (catalog,1.09 KB,
                text/plain)

            
2005-07-26 12:07 UTC,

            Uwe Fechner




Details





my /etc/xml/docbook

              (docbook,13.35 KB,
                text/plain)

            
2006-05-03 15:08 UTC,

            Mark Glines




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Tobias Brox





          2005-07-21 16:24:38 UTC
        

$ sudo emerge xmlto
(...)
make[1]: Entering directory `/tmp/portage/xmlto-0.0.18/work/xmlto-0.0.18'
if i686-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I. -I.     -march=pentium4 -O3
-pipe -MT xmlif/xmlif.o -MD -MP -MF "xmlif/.deps/xmlif.Tpo" -c -o xmlif/xmlif.o
`test -f 'xmlif/xmlif.c' || echo './'`xmlif/xmlif.c; \
then mv -f "xmlif/.deps/xmlif.Tpo" "xmlif/.deps/xmlif.Po"; else rm -f
"xmlif/.deps/xmlif.Tpo"; exit 1; fi
i686-pc-linux-gnu-gcc  -march=pentium4 -O3 -pipe   -o xmlif/xmlif  xmlif/xmlif.o
for xml in xmlif.xml xmlto.xml; do \
  FORMAT_DIR=./format XSL_DIR=./xsl \
   bash ./xmlto -o man/man1 man ./doc/$xml ; \
done || ( RC=$?; cat ./FAQ; exit $RC )
warning: failed to load external entity
"http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"
compilation error: file /var/tmp/portage/xmlto-0.0.18/temp/xmlto-xsl.pHSaEt line
4 element import
xsl:import : unable to load
http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl
warning: failed to load external entity
"http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"
compilation error: file /var/tmp/portage/xmlto-0.0.18/temp/xmlto-xsl.f58Yl4 line
4 element import
xsl:import : unable to load
http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl

Q: I'm trying to build xmlto on my Debian box, but it doesn't work.

A: If you get `Attempt to load network entity' errors when building
   xmlto, your system does not have the required support for XML
   Catalogs
   (http://www.oasis-open.org/committees/entity/spec-2001-08-06.html).
   In particular, Debian has no support for these.  Try the Fedora
   Project <http://fedora.redhat.com>.
make[1]: *** [man/man1/xmlto.1] Error 1
make[1]: Leaving directory `/tmp/portage/xmlto-0.0.18/work/xmlto-0.0.18'
make: *** [all] Error 2

!!! ERROR: app-text/xmlto-0.0.18 failed.
!!! Function src_compile, Line 27, Exitcode 2
!!! (no error message)
!!! If you need support, post the topmost build error, NOT this status message.


Reproducible: Always
Steps to Reproduce:





$ emerge info
Portage 2.0.51.22-r2 (default-linux/x86/2005.0, gcc-3.4.4, glibc-2.3.5-r0,
2.6.11-gentoo-r6 i686)
=================================================================
System uname: 2.6.11-gentoo-r6 i686 Intel(R) Pentium(R) M processor 1.50GHz
Gentoo Base System version 
dev-lang/python:     2.2.3-r1, 2.3.5, 2.4.1-r1
sys-apps/sandbox:    1.2.11
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.18-r1
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium4 -O3 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.2/share/config
/usr/kde/3.3/share/config:/usr/kde/3.3/env:/usr/kde/3.3/shutdown
/usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref
/usr/share/config /usr/share/texmf/dvipdfm/config/
/usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/
/usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/bind
/var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=pentium4 -O3 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks sfperms strict"
GENTOO_MIRRORS="http://ftp.linux.ee/pub/gentoo/distfiles/
http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo/
http://ftp.uni-erlangen.de/pub/mirrors/gentoo http://mirror.pudas.net/gentoo
http://mirror.switch.ch/mirror/gentoo/ http://ftp.rhnet.is/pub/gentoo/
http://mir.zyrianes.net/gentoo/ http://ftp.du.se/pub/os/gentoo
http://ftp-stud.fht-esslingen.de/pub/Mirrors/gentoo/
http://ftp.snt.utwente.nl/pub/os/linux/gentoo"
LANG="en_US"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.nl.gentoo.org/gentoo-portage"
USE="x86 16bit 3ds 7zip X aac aalib acl acpi ada aim alsa amarok amd amr apache
apache2 arts asterisk async atlas audiofile authdaemond automount avi
bash-completion berkdb bidi bitmap-fonts bl blender-game bluetooth bmp boo
browserplugin buffysize buttons calendar cap caps cardbus cdda cddb cdf cdio
cdparanoia cdr cdrom cgi chroot clearcase clisp cln cpudetection crypt cscope
css csv ctype cups curl curlwrappers custom-cflags cvsgraph db2 dba dbase dbcp
dbm dbmaker dbx dga dhcp disk-cache distribution divx4linux doc dpms dv dvb dvd
dvdr dvdread dvi eds emacs emboss encode epson erandom escreen esd extras fam
ffmpeg flac foomaticdb fortran ftp gb gd gdbm geometry gg ggi gif gimp gimpprint
ginac glibc-compat20 glut gnome gphoto2 gpm gstreamer gtk gtk2 guile icq
imagemagick imap imlib ipv6 jack java jpeg junit kde libg++ libwww lirc m17n-lib
mad mail maildrop make-symlinks mapeditor maps math matroska mbox mcal mccp mcve
md5sum memlimit messages mew mhash mikmod milter mime mimencode ming mixer mjpeg
motif mozcalendar mozilla mp3 mp4live mpeg mpeg2 mpeg4 mplayer msn msnextras
multi-tty multicall multislot multitarget music mysql mythtv nagios-dns
nagios-game nagios-ntp nagios-ping nagios-ssh nas ncurses net netbeans netboot
nethack network new-login nfs nls nntp nptl nsplugin ntlm numeric nvidia objc
ocaml octave odbc offensive ogg oggvorbis openal opengl openntpd openssh openssl
oss pam pam_chroot pam_console pam_timestamp pango parse-clocks pascal passfile
password patented pbs pcmcia pcntl pcre pdf pdfkit pdflib perforce perl perlsuid
pfpro pg-hier pg-vacuumdelay php physfs player plotutils plugin png pnp posix
postfix postgres print priority procmail python qt quicktime quotas quotes
readline real reiserfs remix remote resperl rhino rogue rplay rrdtool rss rtc
ruby samba sasl scanner screen sdl sendmail sensord shaper simplexml slang sms
smtp speex spell sqlite sse ssl subject-rewrite subtitles subversion svga svgz
sysfs syslog sysvipc szip tcltk tcpd tetex text threads tiff truetype
truetype-fonts type1-fonts unicode vorbis xine xml xml2 xmms xv zlib
userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


Leonardo Boshell (RETIRED)






          2005-07-21 21:28:18 UTC
        

Something's wrong with your XML catalogs. What version of
docbook-xsl-stylesheets do you have?

Also, please attach the contents of the files /etc/xml/catalog and
/etc/xml/docbook in your system.




Comment 2


Tobias Brox





          2005-07-22 03:31:20 UTC
        

(In reply to comment #1)
> Something's wrong with your XML catalogs. What version of
> docbook-xsl-stylesheets do you have?

I think it was 1.65, I was maybe a bit too quick to do "emerge
docbook-xsl-stlesheets".  By now I have 1.68.1-r1.  First time I got the error,
I actually did an "emerge -e system", so I suppose there is some missing
dependencies here?

Anyway, it did not help, still getting the same error.

> 
> Also, please attach the contents of the files /etc/xml/catalog and
> /etc/xml/docbook in your system.

ok




Comment 3


Tobias Brox





          2005-07-22 03:32:09 UTC
        

Created attachment 64044 [details]
/etc/xml/docbook, as requested




Comment 4


Tobias Brox





          2005-07-22 03:32:32 UTC
        

Created attachment 64045 [details]
/etc/xml/catalog, as requested




Comment 5


Tobias Brox





          2005-07-22 03:33:34 UTC
        

Just checked one more thing, I have no ._cfg* files in /etc/xml ...




Comment 6


Mamoru KOMACHI (RETIRED)






          2005-07-22 04:55:31 UTC
        

Do you have any internet connection on this box?




Comment 7


Tobias Brox





          2005-07-22 05:02:52 UTC
        

Yes, though nothing permanent as it's my laptop :-)




Comment 8


Mamoru KOMACHI (RETIRED)






          2005-07-22 05:15:26 UTC
        

All right, thanks. We got a bug report saying that xmlto
fails to build if you do not have internet access during emerge,
so I thought this bug could be related to that one.




Comment 9


Tobias Brox





          2005-07-22 05:20:16 UTC
        

I'm slow today, I didn't figure out why you asked until right before I got your
message :-)  The internet connection at my current location is a bit unstable,
but it would be very unlikely to fail three times.  I will check again that I
really have access to the resources.




Comment 10


Tobias Brox





          2005-07-22 05:23:52 UTC
        

Trying with "wget", I get the files right away.  But, if telnetting to any web
servers at port 80, I find that some firewall has redirected the query to some
web proxy.  Maybe the download mechanism used is not proxy-aware?




Comment 11


Leonardo Boshell (RETIRED)






          2005-07-22 08:36:27 UTC
        

It shouldn't require an internet connection, the catalog system should handle
the redirections. In your case, something's very strange as the resources for
docbook XSL stylesheets are pointing to file:///usr/share/sgml/docbook/yelp/docbook.

Could you please run "emerge docbook-xsl-stylesheets" and attach the complete
output here?

Thanks.




Comment 12


Tobias Brox





          2005-07-22 08:43:22 UTC
        

> Could you please run "emerge docbook-xsl-stylesheets" and attach the complete
> output here?

Ok, I'm on it.

Maybe worth to mention, I had a rather weird disk crash some days ago, with
arbritrary files missing or corrupted (that's why I did an 'emerge -e system' in
the first place).





Comment 13


Tobias Brox





          2005-07-22 08:46:33 UTC
        

Created attachment 64062 [details]
Output from merging docbook-xsl-stylesheets, as requested




Comment 14


Tobias Brox





          2005-07-22 08:52:40 UTC
        

It seems like the last attachment got a bit messed up due to my redirection of
stderr to stdout (stderr is always flushed, stdout is not, classical mistake. 
How do I enforce correct order in the output?).





Comment 15


Leonardo Boshell (RETIRED)






          2005-07-22 08:59:21 UTC
        

Mmm, strange indeed. What do you get if your run the following?

  ls -l /usr/share/sgml/docbook/yelp/docbook
  equery b /usr/share/sgml/docbook/yelp/docbook





Comment 16


Tobias Brox





          2005-07-22 12:02:23 UTC
        

(In reply to comment #15)
> Mmm, strange indeed. What do you get if your run the following?
> 
>   ls -l /usr/share/sgml/docbook/yelp/docbook

<cbook/yelp/docbook                                          
total 6
drwxr-xr-x  2 root root 1176 Apr  5  2004 common
drwxr-xr-x  3 root root  352 Apr  5  2004 dtd
drwxr-xr-x  2 root root 1392 Apr  5  2004 html
drwxr-xr-x  2 root root  224 Apr  5  2004 images
drwxr-xr-x  2 root root   72 Apr  5  2004 lib
-rw-r--r--  1 root root  180 Aug 12  2002 VERSION


>   equery b /usr/share/sgml/docbook/yelp/docbook

nothing.  Closest thing is

$ equery b /usr/share/sgml/docbook/yelp        
[ Searching for file(s) /usr/share/sgml/docbook/yelp in *... ]
gnome-extra/yelp-2.6.5 (/usr/share/sgml/docbook/yelp)

docbook-xls-stylesheet is only installing to
/usr/share/sgml/docbook/xsl-stylesheets-1.68.1 as far as I can see.



> 






Comment 17


Uwe Fechner





          2005-07-24 09:49:54 UTC
        

Same problem here:

   bash ./xmlto -o man/man1 man ./doc/$xml ; \
done || ( RC=$?; cat ./FAQ; exit $RC )
warning: failed to load external entity
"http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"
compilation error: file /var/tmp/portage/xmlto-0.0.18/temp/xmlto-xsl.dHnvSM line
4 element import
xsl:import : unable to load
http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl
warning: failed to load external entity
"http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"
compilation error: file /var/tmp/portage/xmlto-0.0.18/temp/xmlto-xsl.m6dLGk line
4 element import
xsl:import : unable to load
http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl

Q: I'm trying to build xmlto on my Debian box, but it doesn't work.

A: If you get `Attempt to load network entity' errors when building
   xmlto, your system does not have the required support for XML
   Catalogs
   (http://www.oasis-open.org/committees/entity/spec-2001-08-06.html).
   In particular, Debian has no support for these.  Try the Fedora
   Project <http://fedora.redhat.com>.
make[1]: *** [man/man1/xmlto.1] Error 1
make[1]: Leaving directory `/var/tmp/portage/xmlto-0.0.18/work/xmlto-0.0.18'
make: *** [all] Error 2

!!! ERROR: app-text/xmlto-0.0.18 failed.
!!! Function src_compile, Line 27, Exitcode 2
!!! (no error message)
!!! If you need support, post the topmost build error, NOT this status message.

-bash-3.00# esearch xmlto
[ Results for search key : xmlto ]
[ Applications found : 1 ]

*  app-text/xmlto
      Latest version available: 0.0.18
      Latest version installed: [ Not Installed ]
      Size of downloaded files: 89 kB
      Homepage:    http://cyberelk.net/tim/xmlto/
      Description: A bash script for converting XML and DocBook formatted
documents to a variety of output formats
      License:     GPL-20

No solution found yet.
Same problem with app-office/dia-0.94-r2

Uwe Fechner




Comment 18


Leonardo Boshell (RETIRED)






          2005-07-25 23:32:14 UTC
        

Tobias,
What version of app-text/build-docbook-catalog do you have in your system?

Uwe,
We can't know for sure if yours is the same problem. Please see comment #1 for
instructions on what to do next. Also, please remember to always include the
output from "emerge --info" when reporting bugs.

Thanks.




Comment 19


Uwe Fechner





          2005-07-26 12:04:49 UTC
        

Created attachment 64370 [details]
/etc/xml/docbook from ufechner

/etc/xml/docbook as requested




Comment 20


Uwe Fechner





          2005-07-26 12:07:00 UTC
        

Created attachment 64371 [details]
/etc/xml/catalog from ufechner

/etc/xml/catalog as requested




Comment 21


Uwe Fechner





          2005-07-26 12:14:55 UTC
        

My xsl-stylesheets:

-bash-3.00# esearch docbook-xsl-stylesheets
[ Results for search key : docbook-xsl-stylesheets ]
[ Applications found : 1 ]

*  app-text/docbook-xsl-stylesheets
      Latest version available: 1.68.1-r1
      Latest version installed: 1.68.1-r1
      Size of downloaded files: 944 kB
      Homepage:    http://docbook.sourceforge.net/projects/xsl/index.html
      Description: XSL Stylesheets for Docbook
      License:     || ( as-is BSD )


-bash-3.00#           

ufechner




Comment 22


Uwe Fechner





          2005-07-26 12:16:21 UTC
        

Result of emerge --info as requested:

-bash-3.00# emerge --info
Portage 2.0.51.22-r2 (default-linux/x86/2005.0, gcc-3.3.5-20050130,
glibc-2.3.4.20040808-r1, 2.6.9 i686)
=================================================================
System uname: 2.6.9 i686 AMD Athlon(tm) XP 2800+
Gentoo Base System version 1.6.13
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
ccache version 2.3 [enabled]
dev-lang/python:     2.2.3-r5, 2.3.5
sys-apps/sandbox:    1.2.11
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.5
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.18-r1
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=athlon-xp -O2 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.1/share/config
/usr/kde/3.2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config
/usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config
/usr/kde/3.4/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb
/usr/lib/mozilla/defaults/pref /usr/share/config
/usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/
/usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/
/usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=athlon-xp -O2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distcc distlocks fixpackages sandbox sfperms strict"
GENTOO_MIRRORS="http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo/"
LANG="de_DE@euro"
LC_ALL="de_DE@euro"
LDFLAGS="-Wl,-O1"
LINGUAS="de"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.de.gentoo.org/gentoo-portage"
USE="x86 3dnow X alsa apache2 apm arts audiofile avi berkdb bitmap-fonts bonobo
c++ cdparanoia cdr crypt cups curl doc dvd dvdr emboss encode esd f77 fam flac
foomaticdb fortran gd gdbm gif gimpprint gnome gphoto2 gpm gstreamer gtk gtk+
gtk2 gtkhtml guile imagemagick imlib ipv6 jack jack-tmpfs java jpeg junit kde
ldap libg++ libwww mad mikmod mmx motif mozilla mp3 mpeg mysql ncurses nls ogg
oggvorbis opengl oss pam pdflib perl plugin png postgres python qt quicktime
readline samba scanner sdl slang speex spell sqlite ssl svga tcltk tcpd tetex
tiff truetype truetype-fonts type1-fonts usb vorbis xbase xine xml xml2 xmms xv
zlib linguas_de userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET

-bash-3.00#            

ufechner




Comment 23


Leonardo Boshell (RETIRED)






          2005-07-26 13:46:54 UTC
        

Uwe,
It looks like you do have the same problem. What version of
app-text/build-docbook-catalog do you have in your system?




Comment 24


Uwe Fechner





          2005-07-26 19:41:07 UTC
        

The following version:

-bash-3.00# esearch build-docbook-catalog
[ Results for search key : build-docbook-catalog ]
[ Applications found : 1 ]

*  app-text/build-docbook-catalog
      Latest version available: 1.2
      Latest version installed: 1.2
      Size of downloaded files: 3 kB
      Homepage:
      Description: DocBook XML catalog auto-updater
      License:     GPL-2


-bash-3.00#

Uwe




Comment 25


Tobias Brox





          2005-07-27 05:12:20 UTC
        

I have the same.  I'm trying to reemerge it now.

> *  app-text/build-docbook-catalog
>       Latest version available: 1.2
>       Latest version installed: 1.2





Comment 26


Tobias Brox





          2005-07-27 05:14:20 UTC
        

What packages/files should be in /usr/share/sgml/docbook/yelp/docbook?  As I
checked earlier, I have files there, but they don't seem to be owned by any
gentoo packages.




Comment 27


Uwe Fechner





          2005-07-29 08:56:48 UTC
        

Sorry, I can't answer the last question.

Some more pieces of info from the libxml2 mailing list:

>So I ask again:
>> How can debug the catalog usage of libxslt ?


  http://xmlsoft.org/catalog.html#validate
  "How to debug catalog processing: ..."

And  William M. Break (successful user of xmlto on gentoo) wrote:

I believe that your problem is most likely a "gentoo" problem, and not a
libxml2 / libxslt problem.  According to the error messages which you posted,
the "emerge" is unable to find a required xsl stylesheet.  However, if things
are working properly (as they are on my system, but apparently not on your
system), when the stylesheet is required, the software (probably xsltproc)
will try to use the "catalog" to locate it.  On my system, in the directory
/etc/xml, there are two files (named 'catalog' and 'docbook').  The file
'docbook' has the information necessary to "map" the request to the actual
file, which is located in
/usr/share/sgml/docbook/xsl-stylesheets-1.68.1/manpages/docbook.xsl (which
comes from app-text/docbook-xsl-stylesheets ).

----------------------

I think that this problem MIGHT be related to changes to the catalog api 
of libxml2/ libxslt.

What is your result of xsltproc -V ?

My result of xsltproc -V:
xsltproc -V
Using libxml 20619, libxslt 10114 and libexslt 812
xsltproc was compiled against libxml 20619, libxslt 10114 and libexslt 812
libxslt 10114 was compiled against libxml 20619
libexslt 812 was compiled against libxml 20619 

Further investigation needed.

Uwe




Comment 28


Uwe Fechner





          2005-07-29 09:30:52 UTC
        

Hello,

problem nearly solved.
The reason was a wrong entry in the /etc/xml/docbook file:
line 33 and 34 of the attached file are wrong.

Wrong:
 <rewriteSystem
systemIdStartString="http://docbook.sourceforge.net/release/xsl/current"
rewritePrefix="file:///usr/share/sgml/docbook/yelp/docbook"/>
  <rewriteURI  <rewriteSystem
systemIdStartString="http://docbook.sourceforge.net/release/xsl/current"
rewritePrefix="file:///usr/share/sgml/docbook/yelp/docbook"/>
 
Right:
 <rewriteSystem
systemIdStartString="http://docbook.sourceforge.net/release/xsl/current"
rewritePrefix="file:///usr/share/sgml/docbook/xsl-stylesheets-1.68.1"/>
  <rewriteURI  <rewriteSystem
systemIdStartString="http://docbook.sourceforge.net/release/xsl/current"
rewritePrefix="file:///usr/share/sgml/docbook/xsl-stylesheets-1.68.1"/>

(I hope I got it right.)

So where is the bug?
Which package is responsible for correct entries to the docbook catalog?
(I didn't make any manual changes).

But xmlto emerged allright now!

Regards:

Uwe Fechner





Comment 29


Tobias Brox





          2005-07-29 14:36:14 UTC
        

(In reply to comment #28)
> The reason was a wrong entry in the /etc/xml/docbook file:
> line 33 and 34 of the attached file are wrong.
(...)
> (I hope I got it right.)

not entirely, but at least I managed to emerge this package now.

I also did no manual operations towards this file.





Comment 30


Greg Kroah-Hartman (RETIRED)






          2005-08-08 10:59:03 UTC
        

I have this same issue, anything that I can provide to help?




Comment 31


Uwe Fechner





          2005-08-08 14:55:43 UTC
        

Greg wrote:
> ... anything that I can provide to help?

Well, a lot of things:

- create an attachment with the correct /etc/xml/catalog file
- check the package docbook-xsl-stylesheets, I suppose that there was a change
some releases ago regarding the directory, where the stylesheets are stored.
Ask the maintainer of this package
- check the package app-text/build-docbook-catalog. Ask the maintainer, what it
is doing, and why it is building the catalog file wrong

(Sorry, I don't have much time right now.)

Regards:

Uwe Fechner




Comment 32


Mark Moss





          2005-08-16 19:03:13 UTC
        

I also have (had?) this problem.  The work-around shown in comment #28 allowed
me to emerge xmlto succesfully.  This is especially important, as xmlto is
needed by sys-kernel/gentoo-sources-2.6.12-r6.




Comment 33


Norman Warthmann





          2005-09-04 09:41:48 UTC
        

(In reply to comment #0)
> $ sudo emerge xmlto
> (...)
> make[1]: Entering directory `/tmp/portage/xmlto-0.0.18/work/xmlto-0.0.18'
> if i686-pc-linux-gnu-gcc -DHAVE_CONFIG_H -I. -I. -I.     -march=pentium4 -O3
> -pipe -MT xmlif/xmlif.o -MD -MP -MF "xmlif/.deps/xmlif.Tpo" -c -o xmlif/xmlif.o
> `test -f 'xmlif/xmlif.c' || echo './'`xmlif/xmlif.c; \
> then mv -f "xmlif/.deps/xmlif.Tpo" "xmlif/.deps/xmlif.Po"; else rm -f
> "xmlif/.deps/xmlif.Tpo"; exit 1; fi
> i686-pc-linux-gnu-gcc  -march=pentium4 -O3 -pipe   -o xmlif/xmlif  xmlif/xmlif.o
> for xml in xmlif.xml xmlto.xml; do \
>   FORMAT_DIR=./format XSL_DIR=./xsl \
>    bash ./xmlto -o man/man1 man ./doc/$xml ; \
> done || ( RC=$?; cat ./FAQ; exit $RC )
> warning: failed to load external entity
> "http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"
> compilation error: file /var/tmp/portage/xmlto-0.0.18/temp/xmlto-xsl.pHSaEt line
> 4 element import
> xsl:import : unable to load
> http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl
> warning: failed to load external entity
> "http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"
> compilation error: file /var/tmp/portage/xmlto-0.0.18/temp/xmlto-xsl.f58Yl4 line
> 4 element import
> xsl:import : unable to load
> http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl
> 
> Q: I'm trying to build xmlto on my Debian box, but it doesn't work.
> 
> A: If you get `Attempt to load network entity' errors when building
>    xmlto, your system does not have the required support for XML
>    Catalogs
>    (http://www.oasis-open.org/committees/entity/spec-2001-08-06.html).
>    In particular, Debian has no support for these.  Try the Fedora
>    Project <http://fedora.redhat.com>.
> make[1]: *** [man/man1/xmlto.1] Error 1
> make[1]: Leaving directory `/tmp/portage/xmlto-0.0.18/work/xmlto-0.0.18'
> make: *** [all] Error 2
> 
> !!! ERROR: app-text/xmlto-0.0.18 failed.
> !!! Function src_compile, Line 27, Exitcode 2
> !!! (no error message)
> !!! If you need support, post the topmost build error, NOT this status message.
> 
> 
> Reproducible: Always
> Steps to Reproduce:
> 
> 
> 
> 
> 
> $ emerge info
> Portage 2.0.51.22-r2 (default-linux/x86/2005.0, gcc-3.4.4, glibc-2.3.5-r0,
> 2.6.11-gentoo-r6 i686)
> =================================================================
> System uname: 2.6.11-gentoo-r6 i686 Intel(R) Pentium(R) M processor 1.50GHz
> Gentoo Base System version 
> dev-lang/python:     2.2.3-r1, 2.3.5, 2.4.1-r1
> sys-apps/sandbox:    1.2.11
> sys-devel/autoconf:  2.13, 2.59-r7
> sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6
> sys-devel/binutils:  2.16.1
> sys-devel/libtool:   1.5.18-r1
> virtual/os-headers:  2.6.11-r2
> ACCEPT_KEYWORDS="x86 ~x86"
> AUTOCLEAN="yes"
> CBUILD="i686-pc-linux-gnu"
> CFLAGS="-march=pentium4 -O3 -pipe"
> CHOST="i686-pc-linux-gnu"
> CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.2/share/config
> /usr/kde/3.3/share/config:/usr/kde/3.3/env:/usr/kde/3.3/shutdown
> /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref
> /usr/share/config /usr/share/texmf/dvipdfm/config/
> /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/
> /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/bind
> /var/qmail/control"
> CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
> CXXFLAGS="-march=pentium4 -O3 -pipe"
> DISTDIR="/usr/portage/distfiles"
> FEATURES="autoconfig ccache distlocks sfperms strict"
> GENTOO_MIRRORS="http://ftp.linux.ee/pub/gentoo/distfiles/
> http://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo/
> http://ftp.uni-erlangen.de/pub/mirrors/gentoo http://mirror.pudas.net/gentoo
> http://mirror.switch.ch/mirror/gentoo/ http://ftp.rhnet.is/pub/gentoo/
> http://mir.zyrianes.net/gentoo/ http://ftp.du.se/pub/os/gentoo
> http://ftp-stud.fht-esslingen.de/pub/Mirrors/gentoo/
> http://ftp.snt.utwente.nl/pub/os/linux/gentoo"
> LANG="en_US"
> MAKEOPTS="-j1"
> PKGDIR="/usr/portage/packages"
> PORTAGE_TMPDIR="/var/tmp"
> PORTDIR="/usr/portage"
> SYNC="rsync://rsync.nl.gentoo.org/gentoo-portage"
> USE="x86 16bit 3ds 7zip X aac aalib acl acpi ada aim alsa amarok amd amr apache
> apache2 arts asterisk async atlas audiofile authdaemond automount avi
> bash-completion berkdb bidi bitmap-fonts bl blender-game bluetooth bmp boo
> browserplugin buffysize buttons calendar cap caps cardbus cdda cddb cdf cdio
> cdparanoia cdr cdrom cgi chroot clearcase clisp cln cpudetection crypt cscope
> css csv ctype cups curl curlwrappers custom-cflags cvsgraph db2 dba dbase dbcp
> dbm dbmaker dbx dga dhcp disk-cache distribution divx4linux doc dpms dv dvb dvd
> dvdr dvdread dvi eds emacs emboss encode epson erandom escreen esd extras fam
> ffmpeg flac foomaticdb fortran ftp gb gd gdbm geometry gg ggi gif gimp gimpprint
> ginac glibc-compat20 glut gnome gphoto2 gpm gstreamer gtk gtk2 guile icq
> imagemagick imap imlib ipv6 jack java jpeg junit kde libg++ libwww lirc m17n-lib
> mad mail maildrop make-symlinks mapeditor maps math matroska mbox mcal mccp mcve
> md5sum memlimit messages mew mhash mikmod milter mime mimencode ming mixer mjpeg
> motif mozcalendar mozilla mp3 mp4live mpeg mpeg2 mpeg4 mplayer msn msnextras
> multi-tty multicall multislot multitarget music mysql mythtv nagios-dns
> nagios-game nagios-ntp nagios-ping nagios-ssh nas ncurses net netbeans netboot
> nethack network new-login nfs nls nntp nptl nsplugin ntlm numeric nvidia objc
> ocaml octave odbc offensive ogg oggvorbis openal opengl openntpd openssh openssl
> oss pam pam_chroot pam_console pam_timestamp pango parse-clocks pascal passfile
> password patented pbs pcmcia pcntl pcre pdf pdfkit pdflib perforce perl perlsuid
> pfpro pg-hier pg-vacuumdelay php physfs player plotutils plugin png pnp posix
> postfix postgres print priority procmail python qt quicktime quotas quotes
> readline real reiserfs remix remote resperl rhino rogue rplay rrdtool rss rtc
> ruby samba sasl scanner screen sdl sendmail sensord shaper simplexml slang sms
> smtp speex spell sqlite sse ssl subject-rewrite subtitles subversion svga svgz
> sysfs syslog sysvipc szip tcltk tcpd tetex text threads tiff truetype
> truetype-fonts type1-fonts unicode vorbis xine xml xml2 xmms xv zlib
> userland_GNU kernel_linux elibc_glibc"
> Unset:  ASFLAGS, CTARGET, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY

(In reply to comment #32)
> I also have (had?) this problem.  The work-around shown in comment #28 allowed
> me to emerge xmlto succesfully.  This is especially important, as xmlto is
> needed by sys-kernel/gentoo-sources-2.6.12-r6.

(following up comment #32 and #28)

hi there, 
very helpful suggestions. but it seems still not fixed. comment #28 helped me a
lot, but in my /etc/xml/docbookfile the rewritePrefixes in lines 33 and 34 are
consistent now, but all are wrong. all rewritePrefixes read
"xsl-stylesheets-1.66.1" and should apparently be reading
"xsl-stylesheets-1.68.1" since my  
 ls -l /usr/share/sgml/docbook reads this:
total 60
drwxr-xr-x   3 root root 4096 Mar 19  2004 dsssl-stylesheets
drwxr-xr-x   9 root root 4096 Sep  4 16:42 dsssl-stylesheets-1.79
drwxr-xr-x   2 root root 4096 Sep  4 16:40 sgml-dtd-3.0
drwxr-xr-x   2 root root 4096 Feb 15  2005 sgml-dtd-3.1
drwxr-xr-x   2 root root 4096 Feb 15  2005 sgml-dtd-4.0
drwxr-xr-x   2 root root 4096 Feb 15  2005 sgml-dtd-4.1
drwxr-xr-x   5 root root 4096 Feb 15  2005 utils-0.6.14
drwxr-xr-x   3 root root 4096 Feb 13  2005 xml-dtd-4.1.2
drwxr-xr-x   3 root root 4096 Jan 26  2004 xml-dtd-4.2
drwxr-xr-x   3 root root 4096 Jul 29  2004 xml-dtd-4.3
drwxr-xr-x   3 root root 4096 Sep  4 17:26 xml-dtd-4.4
drwxr-xr-x   2 root root 4096 Feb 22  2004 xml-simple-dtd-1.0
drwxr-xr-x   3 root root 4096 Feb 15  2005 xml-simple-dtd-4.1.2.4
drwxr-xr-x  16 root root 4096 Sep  4 16:14 xsl-stylesheets-1.68.1
drwxr-xr-x   2 root root 4096 Jul 28  2004 yelp


  The emerge I was trying is  dev-libs/glib-2.6.5 and I used to get the error
warning: failed to load external entity "http://docbook.sourceforge.net/release/
xsl/current/html/chunk.xsl"
ever since I changed all "1.66.1" to "1.68.1", it works. I guess thats a bug,
but I am happy to hear that I forgot to update a package or did not run some
...-update because I feel a little uncomfortable now having edited a
configuration file on my own. 
I am using 
app-text/docbook-xsl-stylesheets 1.68.1-r1
app-text/docbook-xml-simple-dtd 4.1.2.4-r2

thank you for your time
regards

Norman




Comment 34


Leonardo Boshell (RETIRED)






          2005-10-04 19:57:11 UTC
        

So the problem is that /etc/xml/docbook wasn't updated correctly. However, I
can't reproduce the problem, so we're going to need more information about this.

Please, if you find the reason why that file was not updated (or was modified to
a broken state), let us know.




Comment 35


Oliver Stieber





          2005-10-28 11:30:26 UTC
        

I'm still getting this problem, 

The fix of updating /etx/xml/docbook replacing /yelp/docbook with
/xsl-stylesheets-1.68.1 works for me.


before correcting /etc/xml/docbook the file listed
http://docbook.sourceforge.net/release/xsl/1.39 upto 1.50 and current as being
in the yelp/docbook directory


Why is this resolved invalid?





Comment 36


Jakub Moc (RETIRED)






          2005-12-21 03:10:59 UTC
        

*** Bug 116255 has been marked as a duplicate of this bug. ***




Comment 37


Jakub Moc (RETIRED)






          2005-12-21 03:14:17 UTC
        

Reopen; someone please clarify the solution/fix the dependencies/whatever...




Comment 38


Thorsten Hirsch





          2005-12-21 06:10:39 UTC
        

Hi, I'm the one who opened Bug 116255, because I'm not quite sure if it's the same problem. I already updated /etc/xml/docbook and changed the following:

old: rewritePrefix="file:///usr/share/sgml/docbook/xsl-stylesheets-1.65.1"/>

new: rewritePrefix="file:///usr/share/sgml/docbook/xsl-stylesheets-1.69.1"/>

So, you see, there were no entries with yelp in the file, but only the old version of xsl-stylesheets, whose directory doesn't exist anymore. However, this did not help, I still can't compile xmlto, getting the same error as before, which is the same as here in this bug. And btw. equery is telling me that /etc/xml/docbook doesn't belong to any package.




Comment 39


Martin Stubenschrott





          2006-01-03 10:55:38 UTC
        

Thanks a lot, changing the "rewritePrefix" also helped me finally emerging my new kernel which depends on xmlto if compiled with +doc




Comment 40


Gavin





          2006-01-16 23:13:09 UTC
        

FYI, this bug has rematerialized with
app-text/docbook-xsl-stylesheets-1.69.1

Remove ~ from your ACCEPT_KEYWORDS, and emerge 1.68.1-r1, then everything look ok.  None of the advice above worked for me when trying to emerge  docbook-xsl-stylesheets-1.69.1




Comment 41


Leonardo Boshell (RETIRED)






          2006-03-30 15:50:20 UTC
        

(In reply to comment #37)
> Reopen; someone please clarify the solution/fix the dependencies/whatever...
> 

Please see comment #34. There is no solution yet because nobody has been able to spot the reason why /etc/xml/docbook is being messed with, and we can't reproduce the problem. If people are still being affected by this bug, please take the time to debug it and find what is going on when you install/update stuff and the way /etc/xml/docbook is edited in the process.




Comment 42


gilhad





          2006-04-02 06:11:08 UTC
        

I had the same problem, /etc/xml/docbook pointing to
file:///usr/share/sgml/docbook/xsl-stylesheets-1.65.1
instead of correct 
file:///usr/share/sgml/docbook/xsl-stylesheets-1.68.1


The problem is in build-docbook-catalog (my version 1.2)
where the line 261 should be
 avail=$(find ${DOCBOOKDIR%/*}/ -name chunk.xsl | head -n 1)
insted of
 avail=$(find ${DOCBOOKDIR%/*} -name chunk.xsl | head -n 1)

as find probabely scans the subtree only if path ends with / 
(maybe because on my system the /usr/share/sgml is symlink)

[root@LiTin(2) share]# find /usr/share/sgml  -name chunk.xsl
[root@LiTin(2) share]# find /usr/share/sgml/  -name chunk.xsl
/usr/share/sgml/docbook/xsl-stylesheets-1.68.1/html/chunk.xsl
/usr/share/sgml/docbook/xsl-stylesheets-1.68.1/xhtml/chunk.xsl




Comment 43


Leonardo Boshell (RETIRED)






          2006-04-04 11:30:23 UTC
        

(In reply to comment #42)
>> The problem is in build-docbook-catalog (..)

It's quite possible that there is an actual bug in build-docbook-catalog, but it doesn't seem to be the one you describe. The trailing slash in the find call shouldn't make a difference.


Now, in summary, and for future reference for people finding this bug: the problem seems to show up in two forms:

1) Old versions of yelp (e.g. 2.6.5) install files under /usr/share/sgml/docbook that mess up the file /etc/xml/docbook because of the logic used by build-docbook-catalog. Hopefully this should no longer be relevant with recent versions of yelp, or we could make build-docbook-catalog a little more robust so it doesn't get fooled as easy (patches are welcome :).

2) When upgrading docbook-xsl-stylesheets, apparently the file /etc/xml/docbook is not updated correctly, so it ends up pointing to old versions of docbook-xsl-stylesheets.


Personally I haven't been able to reproduce case #2, so I'd appreciate it if someone affected by this bug attached the contents of /etc/xml/docbook on their system, and mentioned the version of docbook-xsl-stylesheets they have installed.

Thanks.




Comment 44


Jakub Moc (RETIRED)






          2006-04-16 04:12:11 UTC
        

*** Bug 130152 has been marked as a duplicate of this bug. ***




Comment 45


Mark Glines





          2006-05-03 15:08:07 UTC
        

Created attachment 86094 [details]
my /etc/xml/docbook

(In reply to comment #43)
> Personally I haven't been able to reproduce case #2, so I'd appreciate it if
> someone affected by this bug attached the contents of /etc/xml/docbook on their
> system, and mentioned the version of docbook-xsl-stylesheets they have
> installed.

*  app-text/docbook-xsl-stylesheets
      Latest version available: 1.69.1
      Latest version installed: 1.69.1
      Size of files: 1,034 kB
      Homepage:      http://docbook.sourceforge.net/projects/xsl/index.html
      Description:   XSL Stylesheets for Docbook
      License:       || ( as-is BSD )

Here's some more info, if you want it.  Sorry if this info is useless; I know very little about xslt, xmlto, etc.

The xmlto Makefile ends up running a shell script, "bash ./xmlto", which in turn tries to run xsltproc:

[pid 30619] execve("/usr/bin/xsltproc", ["xsltproc", "--nonet", "--xinclude", "-o", "/tmp/xmlto.gwEJwS/xmlif.proc", "/tmp/xmlto-xsl.5lfTGQ", "/var/tmp/portage/xmlto-0.0.18/wo"...], [/* 55 vars */]) = 0

...which eventually dies.  (isn't it supposed to be doing a web fetch for the following URL, not a local file access?):
[pid 30619] stat64("http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl", 0xbfb0dfd0) = -1 ENOENT (No such file or directory)
[pid 30619] stat64("http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl", 0xbfb0df40) = -1 ENOENT (No such file or directory)
[pid 30619] stat64("/etc/xml/catalog", {st_mode=S_IFREG|0644, st_size=1120, ...}) = 0
[pid 30619] open("/etc/xml/catalog", O_RDONLY) = 3
[pid 30619] fstat64(3, {st_mode=S_IFREG|0644, st_size=1120, ...}) = 0
[pid 30619] mmap2(NULL, 131072, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7edc000
[pid 30619] read(3, "<?xml version=\"1.0\"?>\n<!DOCTYPE "..., 131072) = 1120
[pid 30619] read(3, "", 131072)         = 0
[pid 30619] _llseek(3, 0, [1120], SEEK_CUR) = 0
[pid 30619] _llseek(3, 0, [0], SEEK_SET) = 0
[pid 30619] read(3, "<?xml version=\"1.0\"?>\n<!DOCTYPE "..., 131072) = 1120
[pid 30619] read(3, "", 131072)         = 0
[pid 30619] read(3, "", 131072)         = 0
[pid 30619] close(3)                    = 0
[pid 30619] munmap(0xb7edc000, 131072)  = 0
[pid 30619] stat64("/etc/xml/docbook", {st_mode=S_IFREG|0644, st_size=12412, ...}) = 0
[pid 30619] open("/etc/xml/docbook", O_RDONLY) = 3
[pid 30619] fstat64(3, {st_mode=S_IFREG|0644, st_size=12412, ...}) = 0
[pid 30619] mmap2(NULL, 131072, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0xb7edc000
[pid 30619] read(3, "<?xml version=\"1.0\"?>\n<!DOCTYPE "..., 131072) = 12412
[pid 30619] read(3, "", 131072)         = 0
[pid 30619] _llseek(3, 0, [12412], SEEK_CUR) = 0
[pid 30619] _llseek(3, 0, [0], SEEK_SET) = 0
[pid 30619] read(3, "<?xml version=\"1.0\"?>\n<!DOCTYPE "..., 131072) = 12412
[pid 30619] read(3, "", 131072)         = 0
[pid 30619] read(3, "", 131072)         = 0
[pid 30619] close(3)                    = 0
[pid 30619] munmap(0xb7edc000, 131072)  = 0
[pid 30619] stat64("/usr/share/sgml/docbook/xsl-stylesheets-1.50.0/manpages/docbook.xsl", 0xbfb0df40) = -1 ENOENT (No such file or directory)
[pid 30619] stat64("/usr/share/sgml/docbook/xsl-stylesheets-1.50.0/manpages/docbook.xsl", 0xbfb0df10) = -1 ENOENT (No such file or directory)
[pid 30619] stat64("/usr/share/sgml/docbook/xsl-stylesheets-1.50.0/manpages/docbook.xsl", 0xbfb0df10) = -1 ENOENT (No such file or directory)
[pid 30619] stat64("/usr/share/sgml/docbook/xsl-stylesheets-1.50.0/manpages/docbook.xsl", 0xbfb0de50) = -1 ENOENT (No such file or directory)
[pid 30619] stat64("/usr/share/sgml/docbook/xsl-stylesheets-1.50.0/manpages/docbook.xsl", 0xbfb0de50) = -1 ENOENT (No such file or directory)
[pid 30619] stat64("/usr/share/sgml/docbook/xsl-stylesheets-1.50.0/manpages/docbook.xsl", 0xbfb0de50) = -1 ENOENT (No such file or directory)
[pid 30619] write(2, "warning: ", 9warning: )    = 9
[pid 30619] write(2, "failed to load external entity \""..., 105failed to load external entity "http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl"
) = 105
[pid 30619] write(2, "compilation error: file /tmp/xml"..., 68compilation error: file /tmp/xmlto-xsl.5lfTGQ line 4 element import
) = 68
[pid 30619] write(2, "xsl:import : unable to load http"..., 100xsl:import : unable to load http://docbook.sourceforge.net/release/xsl/current/manpages/docbook.xsl
) = 100


My /usr/share/sgml/docbook/xsl-stylesheets-1.50.0/ has no "manpages" subdirectory.  However, /usr/share/sgml/docbook/xsl-stylesheets-1.69.1/manpages/docbook.xsl does exist.

Full strace log of the xmlto shell script is at http://squawk.glines.org/xmlto-fails.log if you want it.  I haven't fixed my /etc/xml/docbook on this machine, I'm just using emerge --skipfirst to skip xmlto for now, so I can do further tests if needed.

Mark




Comment 46


Leonardo Boshell (RETIRED)






          2006-05-03 19:52:58 UTC
        

(In reply to comment #45)
> Created an attachment (id=86094) [edit]
> my /etc/xml/docbook

Thanks for all that information Mark.

It is still quite strange that xsltproc is mapping the URL to something under /usr/share/sgml/docbook/xsl-stylesheets-1.50.0.

Does that directory exist in your machine? If so, could you check which package installed it or how it ended up there? (you could use e.g. "equery b").

Also, what version of libxslt do you have installed?

Thanks.




Comment 47


Jakub Moc (RETIRED)






          2006-05-15 19:25:59 UTC
        

*** Bug 133432 has been marked as a duplicate of this bug. ***




Comment 48


Mark Glines





          2006-05-26 10:03:01 UTC
        

Sorry for the late reply, I forgot to add myself to the CC list and didn't see your questions.

Yes, /usr/share/sgml/docbook/xsl-stylesheets-1.50.0 exists, it just doesn't contain a manpages subdirectory.  It has lots of other stuff, though.

ribbit ~ # equery b /usr/share/sgml/docbook/xsl-stylesheets-1.50.0
[ Searching for file(s) /usr/share/sgml/docbook/xsl-stylesheets-1.50.0 in *... ]
app-text/docbook-xsl-stylesheets-1.50.0 (/usr/share/sgml/docbook/xsl-stylesheets-1.50.0)

I seem to have two versions of docbook-xsl-stylesheets installed: 1.50.0 and 1.69.0.  See http://squawk.glines.org/xsl-stylesheets-ls-lR.txt if you want to see the contents of /usr/share/sgml/docbook/xsl-stylesheets*.  1.69.0 has a manpages/ subdirectory; 1.50.0 does not.

I can try removing 1.50.0, if you think it'll help.  I can also quickpkg it, if you want to analyze it.

Mark





Comment 49


Mark Glines





          2006-05-26 10:20:57 UTC
        

(In reply to comment #46)
> Also, what version of libxslt do you have installed?

For whatever reason, there are 2 versions installed, too.  dev-libs/libxslt-1.0.18 and dev-libs/libxslt-1.1.16.  The libxslt.so (and so forth) symlinks point to libxslt-1.1.16.

I'm not sure why I'd have two versions of these packages installed.  Some other package depended on the old version, perhaps?  Do you think this could be why things break?

Mark





Comment 50


Leonardo Boshell (RETIRED)






          2006-06-07 08:04:26 UTC
        

Mark,
You certainly should have only one version of docbook-xsl-stylesheets and libxslt installed, so I suggest you start by doing:

  $ emerge -C docbook-xsl-stylesheets libxslt
  $ emerge libxslt docbook-xsl-stylesheets

The fact that you have such old versions make me think that you might be affected by some serious problems with the SGML/XML catalog systems that were breaking systems constantly in the past (years ago), so if there's any chance you can test on a fresh system, please do, otherwise this might be very tricky to debug.




Comment 51


Mark Glines





          2006-06-07 08:18:07 UTC
        

(In reply to comment #50)
> Mark,
> You certainly should have only one version of docbook-xsl-stylesheets and
> libxslt installed, so I suggest you start by doing:
> 
>   $ emerge -C docbook-xsl-stylesheets libxslt
>   $ emerge libxslt docbook-xsl-stylesheets

After issuing these commands, xmlto built fine.  It doesn't shed any light as to how the problem arose in the first place.  I've quickpkg'd the old packages if you want a copy of them... Otherwise, I'm not really sure what I can do to help.  My /var/log/emerge.log doesn't go back that far...


> The fact that you have such old versions make me think that you might be
> affected by some serious problems with the SGML/XML catalog systems that were
> breaking systems constantly in the past (years ago), so if there's any chance
> you can test on a fresh system, please do, otherwise this might be very tricky
> to debug.

Xmlto installed fine on every machine I have except this one.  I just wish I knew why two versions were installed to begin with.  (An answer to why /etc/xml/docbook was trying to use nonexistent files from the old version wouldn't hurt, either.)

If you have ideas for tests I can try, I'm happy to try them.

Mark





Comment 52


Leonardo Boshell (RETIRED)






          2006-06-07 09:12:50 UTC
        

I'm afraid I can't help you any further. None of us seem to know how those old packages got into your system, so this may be one for the ages.. :)

Since xmlto installs correctly for you now, we're back to WORKSFORME.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

