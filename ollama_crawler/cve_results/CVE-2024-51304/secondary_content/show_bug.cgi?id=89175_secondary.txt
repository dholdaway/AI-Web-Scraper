Title: 89175 – pthreads is corrupt
URL: https://bugs.gentoo.org/show_bug.cgi?id=89175

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 89175
pthreads is corrupt
Last modified: 2005-04-25 04:30:09 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 89175 
      - pthreads is corrupt


Summary:
pthreads is corrupt
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       blocker
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-15 06:01 UTC by Douglas Pollock





      Modified:
    
2005-04-25 04:30 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




GTK+ config.log

              (gtk-config.log,57.34 KB,
                text/plain)

            
2005-04-16 09:31 UTC,

            Douglas Pollock




Details





glib config.log

              (glib-config.log,144.59 KB,
                text/plain)

            
2005-04-16 09:32 UTC,

            Douglas Pollock




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Douglas Pollock





          2005-04-15 06:01:53 UTC
        

I have been keeping my system up to date on a semi-regular basis.  At some point about three or four weeks ago, I stopped being able to update packages.  Well, to be more correct, it appears as though the pthreads install has become corrupt in some way.  Glib refuses to install, complaining of an incorrectly pthreads installation.  Re-merging glibc does nothing.  Anything dependent on glib also fails to install.

When this problem first started, I was using 2004.3.  Now my profile is set to 2005.0.  This has changed nothing.



bash-2.05b$ emerge --info
Portage 2.0.51.19 (default-linux/x86/2005.0, gcc-3.3.5, glibc-2.3.4.20041102-r1, 2.6.10-gentoo-r6 i686)
=================================================================
System uname: 2.6.10-gentoo-r6 i686 Intel(R) Pentium(R) 4 CPU 2.80GHz
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb 10 2005, 11:57:24)]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r1
sys-devel/libtool:   1.5.14
virtual/os-headers:  2.6.8.1-r1, 2.6.8.1-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-O3 -march=pentium4 -funroll-loops -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.1/share/config /usr/kde/3.2/share/config /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=pentium4 -funroll-loops -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms"
GENTOO_MIRRORS="ftp://ftp.ussg.iu.edu/pub/linux/gentoo ftp://gentoo.mirrors.pair.com/ http://gentoo.mirrors.pair.com/ http://mirrors.tds.net/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow 3dnowex X aac aalib acpi acpi4linux alsa amd arts artswrappersuid artworkextra async avi bash-completion berkdb bitmap-fonts bonobo bootsplash bzip2 bzlib cdparanoia cdr cdrom crypt cups curl devmap dhcp directfb divx4linux doc droproot dvd dvdread emboss encode esd ethereal evms2 evo ext-png ext-zlib faad fam fbcon flac foomaticdb fortran freetype gcj gdbm gif gimpprint glut gmailgnokii gnome gphoto2 gpm gstreamer gtk gtk2 imagemagick imlib ipv6 irc irda jabber java javacomm javadoc javamail javascript jce jp2 jpeg jpeg2k junit kde kdepim lcd libg++ libwww lirc logitech-mouse mad maildir mbox mikmod mmx motif mozilla moznocompose moznoirc moznomail mozplaintext mp3 mpeg mpeg4 mplayer msn nagios-dns nagios-ntp nagios-ping nagios-ssh native ncurses netbeans nls no-old-linuxnptl nvidia offensive ogg oggvorbis opengl operanom2 oscar oss pam pcmcia pdflib perl pic png pnp ppds pwdb python qt quicktime readline rtc samba silc slang smime sms spamassassin spell sse sse2 ssl svg svga tcpd tetex threads tiff truetype truetype-fonts trusted type1 type1-fonts usb vorbis wifi xine xinerama xml xml2 xmms xscreensaver xv xvid xvmc yahoo zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS




Comment 1


Alec Warner (RETIRED)








          2005-04-15 07:47:37 UTC
        

Probably going to want an error message of some sort, could you paste one?




Comment 2


Douglas Pollock





          2005-04-15 11:45:44 UTC
        

checking for GLIB - version >= 2.6.0... no
*** Could not run GLIB test program, checking why...
*** The test program failed to compile or link. See the file config.log for the
*** exact error that occured. This usually means GLIB is incorrectly installed.
configure: error:
*** GLIB 2.6.0 or better is required. The latest version of
*** GLIB is always available from ftp://ftp.gtk.org/pub/gtk/.

!!! Please attach the config.log to your bug report:
!!! /var/tmp/portage/gtk+-2.6.4-r1/work/gtk+-2.6.4/config.log

!!! ERROR: x11-libs/gtk+-2.6.4-r1 failed.
!!! Function econf, Line 485, Exitcode 0
!!! econf failed
!!! If you need support, post the topmost build error, NOT this status message.






Comment 3


Douglas Pollock





          2005-04-15 11:52:55 UTC
        

checking thread related cflags... -D_REENTRANT
checking for pthread_create/pthread_join... no
checking for pthread_create/pthread_join in -lpthread... no
checking for pthread_create/pthread_join in -lpthread32... no
checking for pthread_create/pthread_join in -lpthreads... no
checking for pthread_create/pthread_join in -lthread... no
checking for pthread_create/pthread_join in -ldce... no
configure: error: I can't find the libraries for the thread implementation
                posix. Please choose another thread implementation or
                provide information on your thread implementation.
                You can also run 'configure --disable-threads'
                to compile without thread support.

!!! Please attach the config.log to your bug report:
!!! /var/tmp/portage/glib-2.6.2-r1/work/glib-2.6.2/config.log

!!! ERROR: dev-libs/glib-2.6.2-r1 failed.
!!! Function econf, Line 485, Exitcode 0
!!! econf failed
!!! If you need support, post the topmost build error, NOT this status message.




Comment 4


SpanKY






          2005-04-15 13:10:58 UTC
        

too bad you didnt attach the config.log file like the error message told you to :P

we cant tell you what the real issue is here until you do, so re-open once you have




Comment 5


Douglas Pollock





          2005-04-16 09:31:50 UTC
        

Created attachment 56458 [details]
GTK+ config.log

Haha.  Very clever.




Comment 6


Douglas Pollock





          2005-04-16 09:32:12 UTC
        

Created attachment 56459 [details]
glib config.log




Comment 7


Douglas Pollock





          2005-04-16 09:35:19 UTC
        

It is unclear that "If you need support, post the topmost build error, NOT this status message" means to also include the config.log.  The two messages saying what to do just confused me a bit.  Do both?  Do one?  The last one?  The first one?





Comment 8


SpanKY






          2005-04-16 15:55:20 UTC
        

here's the actual error:

configure:32555: i686-pc-linux-gnu-gcc -o conftest -O3 -march=pentium4 -funroll-loops -pipe -Wall  -D_REENTRANT -D_POSIX4_DRAFT_SOURCE -D_POSIX4A_DRAFT10_SOURCE -U_OSF_SOURCE  conftest.c -lpthread   >&5
conftest.c: In function `main':
conftest.c:121: warning: implicit declaration of function `exit'
/lib/libpthread.so.0: undefined reference to `errno@GLIBC_PRIVATE'
/lib/libpthread.so.0: undefined reference to `__libc_dl_error_tsd@GLIBC_PRIVATE'
/lib/libpthread.so.0: undefined reference to `__libc_fork@GLIBC_2.1.2'
/lib/libpthread.so.0: undefined reference to `__resp@GLIBC_PRIVATE'
/lib/libpthread.so.0: undefined reference to `h_errno@GLIBC_PRIVATE'
collect2: ld returned 1 exit status




Comment 9


SpanKY






          2005-04-16 15:55:30 UTC
        

what does `ls -l /lib/libpthread*` show ?




Comment 10


Douglas Pollock





          2005-04-17 19:34:23 UTC
        

bash-2.05b$ ls -l /lib/libpthread*
-rwxr-xr-x  1 root root 141794 Apr 14 13:07 /lib/libpthread-0.10.so
-rwxr-xr-x  1 root root  65592 Feb 16  2004 /lib/libpthread-0.60.so
lrwxr-xr-x  1 root root     18 Apr 14 13:10 /lib/libpthread.so.0 -> libpthread-0.60.so





Comment 11


Jeremy Huddleston (RETIRED)






          2005-04-25 04:30:09 UTC
        

get rid of /lib/libpthread-0.60.so and run ldconfig.  It wasn't properly removed when you upgraded glibc at some point









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

