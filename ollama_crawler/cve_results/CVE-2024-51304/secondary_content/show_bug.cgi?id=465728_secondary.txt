Title: 465728 – mail-client/thunderbird, www-client/firefox build failure: File 'nsIDOMElement.idl' not found
URL: https://bugs.gentoo.org/show_bug.cgi?id=465728

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 465728
mail-client/thunderbird, www-client/firefox build failure: File 'nsIDOMElement.idl' not found
Last modified: 2015-02-15 13:08:30 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 465728 
      - mail-client/thunderbird, www-client/firefox build failure: File 'nsIDOMElement.idl' not found


Summary:
mail-client/thunderbird, www-client/firefox build failure: File 'nsIDOMElemen...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Mozilla Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-04-13 01:16 UTC by Alex Xu (Hello71)





      Modified:
    
2015-02-15 13:08 UTC
      (History)
    




          CC List:
        

6 
          users
          
            (show)
          



dan
dlan
israel.lugo
qa
spiderx
zerochaos









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log (bz2, too big)

              (build.log.bz2,47.06 KB,
                application/x-bzip2)

            
2013-04-13 01:16 UTC,

            Alex Xu (Hello71)




Details





build.log, bzip2'ed

              (build.log.bz2,48.36 KB,
                application/x-bzip2)

            
2013-05-19 23:41 UTC,

            Israel G. Lugo




Details





make DOM build serially

              (patch,688 bytes,
                patch)

            
2013-09-20 20:24 UTC,

            Ian Stakenvicius (RETIRED)




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alex Xu (Hello71)





          2013-04-13 01:16:17 UTC
        

Created attachment 345418 [details]
build.log (bz2, too big)

Using Python 3.3.0:

/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/config/nsinstall -R -m 644 /var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/mozilla/dom/interfaces/smil/nsIDOMElementTimeControl.idl /var/tmp/portage/mail-client/thunderbird-17. 0.5/work/comm-esr17/mozilla/dom/interfaces/smil/nsIDOMTimeEvent.idl ../../../dist/idl
nsIDOMElementTimeControl.idl
/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/_virtualenv/bin/python /var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/mozilla/config/pythonpath.py \
  -I/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/mozilla/other-licenses/ply \
  /var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/dist/sdk/bin/header.py -I/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/mozilla/dom/interfaces/smil -I../../../dist/idl -I/var/tmp/portage/mail-client/thunderbird-17.0.5/    work/comm-esr17/mozilla/dom/interfaces/events -I/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/mozilla/dom/interfaces/svg  /var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/mozilla/dom/interfaces/smil/nsIDOMElementTimeControl.idl -d .deps/ nsIDOMElementTimeControl.h.pp -o _xpidlgen/nsIDOMElementTimeControl.h
nsIDOMTimeEvent.idl
Traceback (most recent call last):
  File "/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/mozilla/config/pythonpath.py", line 56, in <module>
    main(sys.argv[1:])
  File "/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/mozilla/config/pythonpath.py", line 48, in main
    execfile(script, frozenglobals)
  File "/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/dist/sdk/bin/header.py", line 513, in <module>
    idl.resolve(options.incdirs, p)
  File "/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/dist/sdk/bin/xpidl.py", line 287, in resolve
    p.resolve(self)
  File "/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/dist/sdk/bin/xpidl.py", line 251, in resolve
    self.IDL.resolve(parent.incdirs, parent.parser)
  File "/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/dist/sdk/bin/xpidl.py", line 287, in resolve
    p.resolve(self)
  File "/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/dist/sdk/bin/xpidl.py", line 257, in resolve
    raise IDLError("File '%s' not found" % self.filename, self.location)
xpidl.IDLError: error: File 'nsIDOMElement.idl' not found, ../../../dist/idl/nsIDOMSVGElement.idl line 6:0
#include "nsIDOMElement.idl"
^
make[6]: *** [_xpidlgen/nsIDOMElementTimeControl.h] Error 1
make[6]: *** Deleting file `_xpidlgen/nsIDOMElementTimeControl.h'
make[6]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/dom/interfaces/smil'
make[5]: *** [interfaces/smil_export] Error 2
make[5]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla/dom'
make[4]: *** [export_tier_platform] Error 2
make[4]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla'
make[3]: *** [tier_platform] Error 2
make[3]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla'
make[2]: *** [default] Error 2
make[2]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird/mozilla'
make[1]: *** [default] Error 2
make[1]: INTERNAL: Exiting with 11 jobserver tokens available; should be 10!
make[1]: Leaving directory `/var/tmp/portage/mail-client/thunderbird-17.0.5/work/comm-esr17/tbird'
make: *** [build] Error 2
emake failed
 * ERROR: mail-client/thunderbird-17.0.5 failed (compile phase)




Comment 1


Alex Xu (Hello71)





          2013-04-13 01:16:43 UTC
        

Portage 2.1.11.55 (default/linux/amd64/13.0/desktop/kde, gcc-4.7.2, glibc-2.15-r3, 3.9.0-rc6+ x86_64)
=================================================================
System uname: Linux-3.9.0-rc6+-x86_64-Intel-R-_Core-TM-_i5_CPU_750_@_2.67GHz-with-gentoo-2.2
KiB Mem:     8163692 total,   2358260 free
KiB Swap:          0 total,         0 free
Timestamp of tree: Fri, 12 Apr 2013 20:45:01 +0000
ld GNU gold (GNU Binutils 2.22) 1.11
distcc 3.1 x86_64-pc-linux-gnu [enabled]
ccache version 3.1.9 [disabled]
app-shells/bash:          4.2_p37
dev-java/java-config:     2.1.12-r1
dev-lang/python:          2.7.3-r3, 3.2.3-r2, 3.3.0-r1
dev-util/ccache:          3.1.9
dev-util/cmake:           2.8.9
dev-util/pkgconfig:       0.28
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.11.8
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.10.3, 1.11.6, 1.12.6
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.7.2-r1
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.7 (virtual/os-headers)
sys-libs/glibc:           2.15-r3
Repositories:

gentoo
    location: /usr/portage
    sync: rsync://mirror.csclub.uwaterloo.ca/gentoo-portage
    priority: -1000

gamerlay
    location: /var/lib/layman/gamerlay
    masters: gentoo
    priority: 0

systemd
    location: /var/lib/layman/systemd
    masters: gentoo
    priority: 1

local_overlay
    location: /usr/local/portage
    masters: gentoo
    priority: 2

ABI="amd64"
ABI_X86="64"
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA"
ACCEPT_PROPERTIES="*"
ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci"
ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol"
APACHE2_MODULES="actions alias authz_host autoindex cache cgi cgid deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack"
ARCH="amd64"
AUTOCLEAN="yes"
BLENDER_SYSTEM_DATAFILES="/usr/share/blender/2.66/datafiles"
BLENDER_SYSTEM_PLUGINS="/usr/lib64/plugins"
BLENDER_SYSTEM_SCRIPTS="/usr/share/blender/2.66/scripts"
BOOTSTRAP_USE="cxx unicode python_targets_python3_2 python_targets_python2_7 multilib"
CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump"
CAMERAS="ptp2"
CBUILD="x86_64-pc-linux-gnu"
CCACHE_DIR="/var/tmp/portage/.ccache"
CFLAGS="-O2 -pipe -march=corei7 -mcx16 -msahf -mno-movbe -mpopcnt -mno-abm -mno-lwp -mno-fma -mno-fma4 -mno-xop -mno-bmi -mno-tbm --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=8192"
CFLAGS_amd64="-m64"
CFLAGS_x32="-mx32"
CFLAGS_x86="-m32"
CHOST="x86_64-pc-linux-gnu"
CHOST_amd64="x86_64-pc-linux-gnu"
CHOST_x32="x86_64-pc-linux-gnux32"
CHOST_x86="i686-pc-linux-gnu"
CLEAN_DELAY="0"
COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog"
COLLISION_IGNORE="/lib/modules/* *.py[co] *$py.class"
CONFIG_PROTECT="/etc /etc/init.d/net.he-ipv6 /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/polkit-1/actions /usr/share/themes/oxygen-gtk/gtk-2.0"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe -march=corei7 -mcx16 -msahf -mno-movbe -mpopcnt -mno-abm -mno-lwp -mno-fma -mno-fma4 -mno-xop -mno-bmi -mno-tbm --param l1-cache-size=32 --param l1-cache-line-size=64 --param l2-cache-size=8192"
DCCC_PATH="/usr/lib64/distcc/bin"
DEFAULT_ABI="amd64"
DISPLAY=":0"
DISTCC_LOG=""
DISTCC_VERBOSE=""
DISTDIR="/usr/portage/distfiles"
EDITOR="/usr/bin/vi"
ELIBC="glibc"
EMERGE_DEFAULT_OPTS="--ask --ask-enter-invalid --jobs=5 --autounmask-write --keep-going --verbose"
EMERGE_WARNING_DELAY="10"
EPREFIX=""
EROOT="/"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs candy compressdebug config-protect-if-modified distcc distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch parallel-install protect-owned sandbox sfperms splitdebug strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FETCHCOMMAND="wget -t 3 -T 60 --passive-ftp -O "${DISTDIR}/${FILE}" "${URI}""
FETCHCOMMAND_RSYNC="rsync -avP "${URI}" "${DISTDIR}/${FILE}""
FETCHCOMMAND_SFTP="bash -c "x=\${2#sftp://} ; host=\${x%%/*} ; port=\${host##*:} ; host=\${host%:*} ; [[ \${host} = \${port} ]] && port=22 ; exec sftp -P \${port} \"\${host}:/\${x#*/}\" \"\$1\"" sftp "${DISTDIR}/${FILE}" "${URI}""
FETCHCOMMAND_SSH="bash -c "x=\${2#ssh://} ; host=\${x%%/*} ; port=\${host##*:} ; host=\${host%:*} ; [[ \${host} = \${port} ]] && port=22 ; exec rsync --rsh=\"ssh -p\${port}\" -avP \"\${host}:/\${x#*/}\" \"\$1\"" rsync "${DISTDIR}/${FILE}" "${URI}""
FFLAGS="-O2 -pipe"
GCC_SPECS=""
GENTOO_MIRRORS="ftp://mirror.csclub.uwaterloo.ca/gentoo-distfiles"
GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx"
GRUB_PLATFORMS=""
GUILE_LOAD_PATH="/usr/share/guile/1.8"
HG="/usr/bin/hg"
HOME="/root"
INFOPATH="/usr/share/info:/usr/share/gcc-data/x86_64-pc-linux-gnu/4.7.2/info:/usr/share/binutils-data/x86_64-pc-linux-gnu/2.22/info"
INPUT_DEVICES="evdev wacom"
IUSE_IMPLICIT="prefix"
KDE_IS_PRELINKED="1"
KERNEL="linux"
LANG="en_CA.UTF-8"
LANGUAGE=""
LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LDFLAGS_amd64="-m elf_x86_64"
LDFLAGS_x32="-m elf32_x86_64"
LDFLAGS_x86="-m elf_i386"
LESS="-R -M --shift 5"
LESSOPEN="|lesspipe %s"
LIBDIR_amd64="lib64"
LIBDIR_amd64_fbsd="lib64"
LIBDIR_n32="lib32"
LIBDIR_n64="lib64"
LIBDIR_o32="lib"
LIBDIR_ppc="lib32"
LIBDIR_ppc64="lib64"
LIBDIR_s390="lib32"
LIBDIR_s390x="lib64"
LIBDIR_sparc32="lib32"
LIBDIR_sparc64="lib64"
LIBDIR_x32="libx32"
LIBDIR_x86="lib32"
LIBDIR_x86_fbsd="lib32"
LIBGL_DRIVERS_PATH="/usr/lib64/dri:/usr/lib32/dri"
LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer"
LINGUAS="en en_US en_GB en_CA"
LOGNAME="root"
LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=01;05;37;41:mi=01;05;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lz=01;31:*.xz=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.axv=01;35:*.anx=01;35:*.ogv=01;35:*.ogx=01;35:*.pdf=00;32:*.ps=00;32:*.txt=00;32:*.patch=00;32:*.diff=00;32:*.log=00;32:*.tex=00;32:*.doc=00;32:*.aac=00;36:*.au=00;36:*.flac=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.axa=00;36:*.oga=00;36:*.spx=00;36:*.xspf=00;36:"
MAIL="/var/mail/root"
MAKEOPTS="-j10 -l6.0"
MANPATH="/usr/local/share/man:/usr/share/man:/usr/share/gcc-data/x86_64-pc-linux-gnu/4.7.2/man:/usr/share/binutils-data/x86_64-pc-linux-gnu/2.22/man:/etc/java-config-2/current-system-vm/man/"
MULTILIB_ABIS="amd64 x86"
MULTILIB_STRICT_DENY="64-bit.*shared object"
MULTILIB_STRICT_DIRS="/lib32 /lib /usr/lib32 /usr/lib /usr/kde/*/lib32 /usr/kde/*/lib /usr/qt/*/lib32 /usr/qt/*/lib /usr/X11R6/lib32 /usr/X11R6/lib"
MULTILIB_STRICT_EXEMPT="(perl5|gcc|gcc-lib|binutils|eclipse-3|debug|portage|udev)"
MULTIOSDIRS="../lib64:../lib32"
NETBEANS="apisupport cnd groovy gsf harness ide identity j2ee java mobility nb php profiler soa visualweb webcommon websvccommon xml"
OFFICE_IMPLEMENTATION="libreoffice"
OPENCL_PROFILE="amd"
OPENGL_PROFILE="ati"
PATH="/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/opt/bin"
PHP_TARGETS="php5-3"
PKGDIR="/usr/portage/packages"
PORTAGE_ARCHLIST="ppc sparc64-freebsd ppc-openbsd x86-openbsd ppc64 x86-winnt x86-fbsd ppc-aix alpha arm x86-freebsd s390 amd64 arm-linux x86-macos x64-openbsd ia64-hpux hppa x86-netbsd ppc64-linux x86-cygwin amd64-linux ia64-linux x86 sparc-solaris x64-freebsd sparc64-solaris x86-linux x64-macos sparc m68k-mint ia64 mips ppc-macos x86-interix hppa-hpux amd64-fbsd x64-solaris m68k sh x86-solaris sparc-fbsd"
PORTAGE_BIN_PATH="/usr/lib64/portage/bin"
PORTAGE_COMPRESS_EXCLUDE_SUFFIXES="css gif htm[l]? jp[e]?g js pdf png"
PORTAGE_CONFIGROOT="/"
PORTAGE_DEBUG="0"
PORTAGE_DEPCACHEDIR="/var/cache/edb/dep"
PORTAGE_ELOG_CLASSES="log warn error"
PORTAGE_ELOG_MAILFROM="portage@localhost"
PORTAGE_ELOG_MAILSUBJECT="[portage] ebuild log for ${PACKAGE} on ${HOST}"
PORTAGE_ELOG_MAILURI="root"
PORTAGE_ELOG_SYSTEM="save_summary:log,warn,error,qa echo"
PORTAGE_FETCH_CHECKSUM_TRY_MIRRORS="5"
PORTAGE_FETCH_RESUME_MIN_SIZE="350K"
PORTAGE_GID="250"
PORTAGE_GPG_SIGNING_COMMAND="gpg --sign --digest-algo SHA256 --clearsign --yes --default-key "${PORTAGE_GPG_KEY}" --homedir "${PORTAGE_GPG_DIR}" "${FILE}""
PORTAGE_INST_GID="0"
PORTAGE_INST_UID="0"
PORTAGE_INTERNAL_CALLER="1"
PORTAGE_NICENESS="10"
PORTAGE_OVERRIDE_EPREFIX=""
PORTAGE_PYM_PATH="/usr/lib64/portage/pym"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_RSYNC_RETRIES="-1"
PORTAGE_SYNC_STALE="30"
PORTAGE_TMPDIR="/tmp"
PORTAGE_VERBOSE="1"
PORTAGE_WORKDIR_MODE="0700"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/gamerlay /var/lib/layman/systemd /usr/local/portage"
PORT_LOGDIR_CLEAN="find "${PORT_LOGDIR}" -type f ! -name "summary.log*" -mtime +7 -delete"
PRELINK_PATH="/usr/local/bin:/usr/local/sbin"
PRELINK_PATH_MASK="/usr/lib64/libfreebl3.so:/usr/lib64/libnssdbm3.so:/usr/lib64/libsoftokn3.so"
PROFILE_ONLY_VARIABLES="ARCH ELIBC IUSE_IMPLICIT KERNEL USERLAND USE_EXPAND_IMPLICIT USE_EXPAND_UNPREFIXED USE_EXPAND_VALUES_ARCH USE_EXPAND_VALUES_ELIBC USE_EXPAND_VALUES_KERNEL USE_EXPAND_VALUES_USERLAND"
PYTHONDONTWRITEBYTECODE="1"
PYTHONPATH="/usr/lib/portage/pym"
PYTHON_SINGLE_TARGET="python2_7"
PYTHON_TARGETS="python2_7 python3_2 python3_3 pypy2_0"
QT_GRAPHICSSYSTEM="native"
QT_PLUGIN_PATH="/usr/lib64/kde4/plugins"
RESUMECOMMAND="wget -c -t 3 -T 60 --passive-ftp -O "${DISTDIR}/${FILE}" "${URI}""
RESUMECOMMAND_RSYNC="rsync -avP "${URI}" "${DISTDIR}/${FILE}""
RESUMECOMMAND_SSH="bash -c "x=\${2#ssh://} ; host=\${x%%/*} ; port=\${host##*:} ; host=\${host%:*} ; [[ \${host} = \${port} ]] && port=22 ; exec rsync --rsh=\"ssh -p\${port}\" -avP \"\${host}:/\${x#*/}\" \"\$1\"" rsync "${DISTDIR}/${FILE}" "${URI}""
ROOT="/"
ROOTPATH="/opt/bin:/usr/x86_64-pc-linux-gnu/gcc-bin/4.7.2"
RPMDIR="/usr/portage/rpm"
RUBYOPT="-rauto_gem"
RUBY_TARGETS="ruby19"
SHELL="/bin/zsh"
SUDO_COMMAND="/usr/bin/emerge --info"
SUDO_GID="1000"
SUDO_UID="1000"
SUDO_USER="alex"
SYMLINK_LIB="yes"
SYNC="rsync://mirror.csclub.uwaterloo.ca/gentoo-portage"
TERM="xterm"
UNINSTALL_IGNORE="/lib/modules/*"
USE="X acl acpi alsa amd64 berkdb branding bzip2 cairo caps cli consolekit cracklib crypt cups cxx dbus declarative dri encode exif firefox flac gif git gpm gtk iconv ipv6 jpeg kde kipi libnotify mad mmx mng modules mp3 mp4 mpeg mudflap multilib ncurses nptl ogg opengl openmp pango pch pcre pdf pgo phonon plasma png policykit ppds qt3support qt4 readline sdl session smp sound spell sse sse2 sse3 sse4 ssl ssse3 startup-notification svg system-sqlite systemd tiff truetype udev unicode usb v4l vim-syntax vorbis xcb xcomposite xinerama xml xscreensaver xv zlib zsh-completion" ABI_X86="64" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias authz_host autoindex cache cgi cgid deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev wacom" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LINGUAS="en en_US en_GB en_CA" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-3" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_2 python3_3 pypy2_0" RUBY_TARGETS="ruby19" USERLAND="GNU" VIDEO_CARDS="fglrx" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
USER="root"
USERLAND="GNU"
USERNAME="root"
USE_EXPAND="ABI_X86 ALSA_CARDS ALSA_PCM_PLUGINS APACHE2_MODULES APACHE2_MPMS CALLIGRA_FEATURES CAMERAS COLLECTD_PLUGINS CROSSCOMPILE_OPTS CURL_SSL DRACUT_MODULES DVB_CARDS ELIBC ENLIGHTENMENT_MODULES FCDSL_CARDS FFTOOLS FOO2ZJS_DEVICES FRITZCAPI_CARDS GPSD_PROTOCOLS GRUB_PLATFORMS INPUT_DEVICES KERNEL LCD_DEVICES LIBREOFFICE_EXTENSIONS LINGUAS LIRC_DEVICES MISDN_CARDS NETBEANS_MODULES NGINX_MODULES_HTTP NGINX_MODULES_MAIL OFED_DRIVERS OFFICE_IMPLEMENTATION OPENMPI_FABRICS OPENMPI_OFED_FEATURES OPENMPI_RM PHP_TARGETS PYTHON_SINGLE_TARGET PYTHON_TARGETS QEMU_SOFTMMU_TARGETS QEMU_USER_TARGETS RUBY_TARGETS SANE_BACKENDS USERLAND VIDEO_CARDS VOICEMAIL_STORAGE XFCE_PLUGINS XTABLES_ADDONS"
USE_EXPAND_HIDDEN="CROSSCOMPILE_OPTS ELIBC KERNEL USERLAND"
USE_EXPAND_IMPLICIT="ARCH ELIBC KERNEL USERLAND"
USE_EXPAND_UNPREFIXED="ARCH"
USE_EXPAND_VALUES_ARCH="alpha amd64 amd64-fbsd amd64-linux arm arm-linux hppa hppa-hpux ia64 ia64-hpux ia64-linux m68k m68k-mint mips ppc ppc64 ppc64-linux ppc-aix ppc-macos ppc-openbsd s390 sh sparc sparc64-freebsd sparc64-solaris sparc-fbsd sparc-solaris x64-freebsd x64-macos x64-openbsd x64-solaris x86 x86-cygwin x86-fbsd x86-freebsd x86-interix x86-linux x86-macos x86-netbsd x86-openbsd x86-solaris x86-winnt"
USE_EXPAND_VALUES_ELIBC="AIX Cygwin Darwin FreeBSD glibc HPUX Interix mintlib NetBSD OpenBSD SunOS uclibc Winnt"
USE_EXPAND_VALUES_KERNEL="AIX Cygwin Darwin FreeBSD freemint HPUX Interix linux NetBSD OpenBSD SunOS Winnt"
USE_EXPAND_VALUES_USERLAND="BSD GNU"
USE_ORDER="env:pkg:conf:defaults:pkginternal:repo:env.d"
VBOX_APP_HOME="/usr/lib64/virtualbox"
VIDEO_CARDS="fglrx"
VISUAL="/usr/bin/vi"
XDG_CONFIG_DIRS="/etc/xdg"
XDG_DATA_DIRS="/usr/local/share:/usr/share"
XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"




Comment 2


Jory A. Pratt






          2013-04-13 02:30:02 UTC
        

disable disstcc and try again. You are using python-2.7 in all mozilla products.




Comment 3


Alex Xu (Hello71)





          2013-04-13 02:33:38 UTC
        

I don't have any other hosts connected to distcc. I can try, though.




Comment 4


Alex Xu (Hello71)





          2013-04-13 03:08:58 UTC
        

It appears to work without distcc.

Previously, without distcc, www-client/firefox build failed (same error) only *some* of the time though, so it might be a transient failure unrelated (or partially related) to distcc.




Comment 5


Israel G. Lugo





          2013-05-19 23:40:04 UTC
        

Confirmed here. NOT using distcc.

# emerge --info www-client/firefox
Portage 2.1.11.62 (default/linux/amd64/13.0/desktop, gcc-4.6.3, glibc-2.15-r3, 3.7.10-gentoo-r1 x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-3.7.10-gentoo-r1-x86_64-Intel-R-_Core-TM-_i5-2400_CPU_@_3.10GHz-with-gentoo-2.2
KiB Mem:     8152440 total,    889860 free
KiB Swap:    8388604 total,   8376832 free
Timestamp of tree: Sun, 19 May 2013 21:15:02 +0000
ld GNU ld (GNU Binutils) 2.22
app-shells/bash:          4.2_p45
dev-java/java-config:     2.1.12-r1
dev-lang/python:          2.6.8-r1, 2.7.3-r3, 3.1.5-r1, 3.2.3-r2
sys-devel/make:           3.82-r4
dev-util/cmake:           2.8.10.2-r2
dev-util/pkgconfig:       0.28
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.11.8
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.8.5-r4, 1.9.6-r3, 1.10.3, 1.11.6, 1.12.6
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.5.4, 4.6.3
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.7 (virtual/os-headers)
sys-libs/glibc:           2.15-r3
Repositories: gentoo gamerlay x-capi
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=native -msse4.1 -msse4.2 -mavx -maes -mfpmath=sse -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/maven-bin-3.0/conf /usr/share/polkit-1/actions /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -march=native -msse4.1 -msse4.2 -mavx -maes -mfpmath=sse -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--complete-graph=y --jobs=4 --load-average=5.00 --with-bdeps=y"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://ftp.rnl.ist.utl.pt/pub/gentoo/gentoo-distfiles/ http://darkstar.ist.utl.pt/gentoo/ http://cesium.di.uminho.pt/pub/gentoo/ ftp://cesium.di.uminho.pt/pub/gentoo/ http://ftp.dei.uc.pt/pub/linux/gentoo/ ftp://ftp.dei.uc.pt/pub/linux/gentoo/"
LANG="en_US.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j5 --load-average=5"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/gamerlay /var/lib/layman/capi"
SYNC="rsync://ftp.rnl.ist.utl.pt/pub/gentoo/gentoo-portage"
USE="X a52 aac aalib acl acpi adns aften akode alsa amd64 amr amrnb amrwb ao avx bash-completion berkdb bluetooth bluray branding bzip2 cairo caps cdda cddb cdparanoia cdr chm cli clisp consolekit cracklib crypt cscope css cups curl cxx dbus dia djvu dri dts dv dvd dvdr dvdread dvi emboss encode exif expat fam fame ffmpeg fftw firefox flac fortran fpx gd gdbm gif gimp gimpprint glib glitz gpac gphoto2 gpm graphviz gs gtk gtkhtml hal hdri iconv icu id3tag idea ieee1394 imagemagick imlib inkjar ipv6 jbig jpeg jpeg2k kde kdeenablefinal kdehiddenvisibility kpathsea lame lcms libass libcaca libnotify libsamplerate lm_sensors log4j logrotate lzo mad matroska mikmod mjpeg mmx mmxext mng modules motif mp2 mp3 mp4 mpeg mudflap multilib musepack ncurses new-clx nls nptl ogg oggvorbis openal openexr opengl openmp pam pango pch pcre pda pdf pg-intdatetime physfs plotutils png pnm policykit portaudio postgres postscript ppds pyste qt qt3support qt4 quicktime rar readline samba scanner schroedinger sdl session silc smp sndfile solver soundtouch sox speex spell sqlite sqlite3 srt sse sse2 sse3 sse4 ssl ssse3 startup-notification static-libs svg t1lib tcpd tetex theora threads tiff timidity truetype tta twolame udev udisks unicode upower usb v4l2 vaapi vamp vcd vim-syntax vorbis vpx wavpack wma wmf wxwidgets x264 xanim xattr xcb xetex xml xmp xpm xv xvid xvmc zlib zoran" ABI_X86="64" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2 samsung canon casio_qv panasonic_coolshot panasonic_dc1000 panasonic_1580 panasonic_l859 sony_dscf1 sony_dscf55" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev keyboard mouse wacom" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="pdfimport" LINGUAS="en" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-3" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_2" QEMU_SOFTMMU_TARGETS="x86_64 arm i386 mips mips64" QEMU_USER_TARGETS="x86_64 arm i386 mips mips64 armeb" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="fglrx vesa" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON

=================================================================
                        Package Settings
=================================================================

www-client/firefox-17.0.5 was built with the following:
USE="alsa dbus jit libnotify minimal (multilib) startup-notification -bindist -custom-cflags -custom-optimization -debug -gstreamer (-pgo) (-selinux) -system-sqlite -wifi" ABI_X86="64" LINGUAS="-af -ak -ar -as -ast -be -bg -bn_BD -bn_IN -br -bs -ca -cs -csb -cy -da -de -el -en_GB -en_ZA -eo -es_AR -es_CL -es_ES -es_MX -et -eu -fa -fi -fr -fy_NL -ga_IE -gd -gl -gu_IN -he -hi_IN -hr -hu -hy_AM -id -is -it -ja -kk -km -kn -ko -ku -lg -lt -lv -mai -mk -ml -mr -nb_NO -nl -nn_NO -nso -or -pa_IN -pl -pt_BR -pt_PT -rm -ro -ru -si -sk -sl -son -sq -sr -sv_SE -ta -ta_LK -te -th -tr -uk -vi -zh_CN -zh_TW -zu"
CFLAGS="-march=native -pipe -mno-avx"
CXXFLAGS="-march=native -pipe -mno-avx"




Comment 6


Israel G. Lugo





          2013-05-19 23:41:47 UTC
        

Created attachment 348704 [details]
build.log, bzip2'ed




Comment 7


Rick Farina (Zero_Chaos)






          2013-09-20 01:06:41 UTC
        

I'm able to verify this on 17.0.9 it fails reliably with MAKEOPTS="-j4 -l4"

QA team, why is it okay for the mozilla products to be marked stable if they have a bug like this?  It's a simple fix to add -j1 to the ebuild but I was told specifically by the maintainer that he doesn't want to slow down builds for a "corner case failure"




Comment 8


Ulrich Müller






          2013-09-20 06:48:40 UTC
        

(In reply to Rick Farina (Zero_Chaos) from comment #7)
> QA team, why is it okay for the mozilla products to be marked stable if they
> have a bug like this?  It's a simple fix to add -j1 to the ebuild but I was
> told specifically by the maintainer that he doesn't want to slow down builds
> for a "corner case failure"

<QA hat>
Our policy on this seems to be clear:
"Builds should be tested with various -j settings in MAKEOPTS to ensure that the build parallelises properly. If a package does not parallelise cleanly, it should be patched.
If patching really isn't an option, emake -j1 should be used. However, when doing this please remember that you are seriously hurting build times for many non-x86 users in particular. Forcing a -j1 can increase build times from a few minutes to an hour on some MIPS and SPARC systems."
<http://devmanual.gentoo.org/ebuild-writing/functions/src_compile/building/index.html>

So preferably, the build system should be fixed. If nobody can come up with a fix (within one month, I'd suggest, given the time this bug is open), adding the -j1 option should be considered.

I notice that two of the three emake calls in src_compile are emake -j1 already. Has an upstream bug been filed for those?
</QA hat>




Comment 9


Alex Xu (Hello71)





          2013-09-20 10:49:59 UTC
        

I have never encountered this bug in over 100 (just a guess) builds using mach off of mozilla-central.

current mozconfig (has changed over time):

export CC="clang"
export CXX="clang++"

# build firefox
ac_add_options --enable-application=browser

# try to make it not so horribly slow
ac_add_options --enable-optimize="-O2"
ac_add_options --with-ccache

# gstreamer for H.264 support
ac_add_options --enable-gstreamer

# compiling for myself only
ac_add_options --with-arch=native
ac_add_options --enable-official-branding

# various features
ac_add_options --disable-gio
ac_add_options --disable-gconf
ac_add_options --disable-accessibility
ac_add_options --disable-parental-controls
ac_add_options --disable-safe-browsing

# make sure we have symbols; recompiling takes FAR too long
ac_add_options --enable-debug-symbols
ac_add_options --disable-install-strip

# Add the static checker
ac_add_options --enable-clang-plugin

ac_add_options --enable-warnings-as-errors




Comment 10


Jory A. Pratt






          2013-09-20 18:10:57 UTC
        

(In reply to Ulrich Müller from comment #8)
> (In reply to Rick Farina (Zero_Chaos) from comment #7)
> > QA team, why is it okay for the mozilla products to be marked stable if they
> > have a bug like this?  It's a simple fix to add -j1 to the ebuild but I was
> > told specifically by the maintainer that he doesn't want to slow down builds
> > for a "corner case failure"
> 
> <QA hat>
> Our policy on this seems to be clear:
> "Builds should be tested with various -j settings in MAKEOPTS to ensure that
> the build parallelises properly. If a package does not parallelise cleanly,
> it should be patched.
> If patching really isn't an option, emake -j1 should be used. However, when
> doing this please remember that you are seriously hurting build times for
> many non-x86 users in particular. Forcing a -j1 can increase build times
> from a few minutes to an hour on some MIPS and SPARC systems."
> <http://devmanual.gentoo.org/ebuild-writing/functions/src_compile/building/
> index.html>
> 
> So preferably, the build system should be fixed. If nobody can come up with
> a fix (within one month, I'd suggest, given the time this bug is open),
> adding the -j1 option should be considered.
> 
> I notice that two of the three emake calls in src_compile are emake -j1
> already. Has an upstream bug been filed for those?
> </QA hat>

The emake calls are in extensions completely acceptable as is only way to ensure they continue to build for everyone. These are known to break on a regular basis. The problem comes down to no way to reproduce this on multiple machines. A simple failure no a few machines does not mean it fails for the majority.




Comment 11


Jory A. Pratt






          2013-09-20 18:13:26 UTC
        

(In reply to Rick Farina (Zero_Chaos) from comment #7)
> I'm able to verify this on 17.0.9 it fails reliably with MAKEOPTS="-j4 -l4"
> 
> QA team, why is it okay for the mozilla products to be marked stable if they
> have a bug like this?  It's a simple fix to add -j1 to the ebuild but I was
> told specifically by the maintainer that he doesn't want to slow down builds
> for a "corner case failure"

As many are aware setting MAKEOPTS="-j4 -l4" is not realistic, a simple compile can become bottle necked with a load setting so load with so many jobs, especially when dealing with C++/javascript




Comment 12


Rick Farina (Zero_Chaos)






          2013-09-20 19:09:34 UTC
        

(In reply to Jory A. Pratt from comment #10)
> (In reply to Ulrich Müller from comment #8)
> > (In reply to Rick Farina (Zero_Chaos) from comment #7)
> > > QA team, why is it okay for the mozilla products to be marked stable if they
> > > have a bug like this?  It's a simple fix to add -j1 to the ebuild but I was
> > > told specifically by the maintainer that he doesn't want to slow down builds
> > > for a "corner case failure"
> > 
> > <QA hat>
> > Our policy on this seems to be clear:
> > "Builds should be tested with various -j settings in MAKEOPTS to ensure that
> > the build parallelises properly. If a package does not parallelise cleanly,
> > it should be patched.
> > If patching really isn't an option, emake -j1 should be used. However, when
> > doing this please remember that you are seriously hurting build times for
> > many non-x86 users in particular. Forcing a -j1 can increase build times
> > from a few minutes to an hour on some MIPS and SPARC systems."
> > <http://devmanual.gentoo.org/ebuild-writing/functions/src_compile/building/
> > index.html>
> > 
> > So preferably, the build system should be fixed. If nobody can come up with
> > a fix (within one month, I'd suggest, given the time this bug is open),
> > adding the -j1 option should be considered.
> > 
> > I notice that two of the three emake calls in src_compile are emake -j1
> > already. Has an upstream bug been filed for those?
> > </QA hat>
> 
> The emake calls are in extensions completely acceptable as is only way to
> ensure they continue to build for everyone. These are known to break on a
> regular basis. The problem comes down to no way to reproduce this on
> multiple machines. A simple failure no a few machines does not mean it fails
> for the majority.

And since when is "compiles for the majority of people" how we determine what is stable? Last I heard it is expected to be a good bit more reliable than this...




Comment 13


Rick Farina (Zero_Chaos)






          2013-09-20 19:12:51 UTC
        

(In reply to Jory A. Pratt from comment #11)
> As many are aware setting MAKEOPTS="-j4 -l4" is not realistic, a simple
> compile can become bottle necked with a load setting so load with so many
> jobs, especially when dealing with C++/javascript

It was my understanding that load of 1 per cpu was a top end of desirable not a bottle neck.  From my own testing when load goes over numcpu I notice the system seems to thrash considerably so I've limited the load (and by extension the jobs) to prevent this thrashing.  If you have a good resource to point me to, I'd be happy to learn more...




Comment 14


Ian Stakenvicius (RETIRED)






          2013-09-20 20:24:07 UTC
        

Created attachment 359148 [details, diff]
make DOM build serially

So in theory, this change to thunderbird-17.0.9.ebuild (and a similar one to firefox-17.x ebuilds, iirc you just drop '/mozilla' from the file path) makes all IDL elements build in serial rather than parallel.

For anyone having issues, please give it a try.  I have yet to reproduce a single build failure no matter what combination of -j and -l I use, so I can't test it.




Comment 15


Jory A. Pratt






          2013-09-21 16:54:43 UTC
        

(In reply to Rick Farina (Zero_Chaos) from comment #13)
> (In reply to Jory A. Pratt from comment #11)
> > As many are aware setting MAKEOPTS="-j4 -l4" is not realistic, a simple
> > compile can become bottle necked with a load setting so load with so many
> > jobs, especially when dealing with C++/javascript
> 
> It was my understanding that load of 1 per cpu was a top end of desirable
> not a bottle neck.  From my own testing when load goes over numcpu I notice
> the system seems to thrash considerably so I've limited the load (and by
> extension the jobs) to prevent this thrashing.  If you have a good resource
> to point me to, I'd be happy to learn more...

When the system is heavily loaded, you will probably want to run fewer jobs than when it is lightly loaded. You can use the ‘-l’ option to tell make to limit the number of jobs to run at once, based on the load average. The ‘-l’ or ‘--max-load’ option is followed by a floating-point number. For example,

     -l 2.5

will not let make start more than one job if the load average is above 2.5. The ‘-l’ option with no following number removes the load limit, if one was given with a previous ‘-l’ option.

More precisely, when make goes to start up a job, and it already has at least one job running, it checks the current load average; if it is not lower than the limit given with ‘-l’, make waits until the load average goes below that limit, or until all the other jobs finish.

By default, there is no load limit. 

http://www.gnu.org/software/make/manual/html_node/Parallel.html




Comment 16


Rick Farina (Zero_Chaos)






          2013-09-22 03:45:29 UTC
        

(In reply to Jory A. Pratt from comment #15)
> (In reply to Rick Farina (Zero_Chaos) from comment #13)
> > (In reply to Jory A. Pratt from comment #11)
> > > As many are aware setting MAKEOPTS="-j4 -l4" is not realistic, a simple
> > > compile can become bottle necked with a load setting so load with so many
> > > jobs, especially when dealing with C++/javascript
> > 
> > It was my understanding that load of 1 per cpu was a top end of desirable
> > not a bottle neck.  From my own testing when load goes over numcpu I notice
> > the system seems to thrash considerably so I've limited the load (and by
> > extension the jobs) to prevent this thrashing.  If you have a good resource
> > to point me to, I'd be happy to learn more...
> 
> When the system is heavily loaded, you will probably want to run fewer jobs
> than when it is lightly loaded. You can use the ‘-l’ option to tell make to
> limit the number of jobs to run at once, based on the load average. The ‘-l’
> or ‘--max-load’ option is followed by a floating-point number. For example,
> 
>      -l 2.5
> 
> will not let make start more than one job if the load average is above 2.5.
> The ‘-l’ option with no following number removes the load limit, if one was
> given with a previous ‘-l’ option.
> 
> More precisely, when make goes to start up a job, and it already has at
> least one job running, it checks the current load average; if it is not
> lower than the limit given with ‘-l’, make waits until the load average goes
> below that limit, or until all the other jobs finish.
> 
> By default, there is no load limit. 
> 
> http://www.gnu.org/software/make/manual/html_node/Parallel.html

Yes, I'm very well aware of what -l does, I have it in my MAKEOPTS because 1.) I know what it does and 2.) I feel it is a very desirable effect.

My question to you is why you felt -l4 on a quad core system was unacceptably low. (comment 11)




Comment 17


Alex Xu (Hello71)





          2015-02-15 13:08:30 UTC
        

Hm. I don't seem to be getting this anymore since about 31.x or so. Feel free to reopen if this still affects you.

P.S. I checked and I didn't specify -j1 in p.env.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

