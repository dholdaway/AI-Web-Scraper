Title: 148886 – ImageMagick-6.2.9.5 USE flag "png" does not work
URL: https://bugs.gentoo.org/show_bug.cgi?id=148886

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 148886
ImageMagick-6.2.9.5 USE flag "png" does not work
Last modified: 2006-09-26 21:35:21 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 148886 
      - ImageMagick-6.2.9.5 USE flag "png" does not work


Summary:
ImageMagick-6.2.9.5 USE flag "png" does not work
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Other
      







Importance:
      
High
       normal
      


Assignee:

Karol Wojtaszek (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-09-23 23:14 UTC by Christopher Byrne





      Modified:
    
2006-09-26 21:35 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



graphics+disabled









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Output of build process

              (imagemagick.txt,342.82 KB,
                text/plain)

            
2006-09-23 23:20 UTC,

            Christopher Byrne




Details





Output of "convert  -list format"

              (convert.txt,9.43 KB,
                text/plain)

            
2006-09-23 23:23 UTC,

            Christopher Byrne




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Christopher Byrne





          2006-09-23 23:14:05 UTC
        

If ImageMagick is compiled with USE="png", png support isn't actually enabled. The build process does pass the correct flags: during the ./configure, it shows its enabled, and even "convert -list format"  shows it there, but it doesn't work: 

convert xc:black png:-
convert: no encode delegate for this image format `png:-'.

ldd shows libpng not being linked in:

ldd `which convert`
linux-gate.so.1 =>  (0xffffe000)
libMagick.so.10 => /usr/lib/libMagick.so.10 (0xb7e9e000)
libWand.so.10 => /usr/lib/libWand.so.10 (0xb7e07000)
libjpeg.so.62 => /usr/lib/libjpeg.so.62 (0xb7de8000)
libbz2.so.1 => /lib/libbz2.so.1 (0xb7dd8000)
libpthread.so.0 => /lib/libpthread.so.0 (0xb7dc5000)
libfreetype.so.6 => /usr/lib/libfreetype.so.6 (0xb7d59000)
libz.so.1 => /lib/libz.so.1 (0xb7d46000)
libdl.so.2 => /lib/libdl.so.2 (0xb7d42000)
libm.so.6 => /lib/libm.so.6 (0xb7d1d000)
libc.so.6 => /lib/libc.so.6 (0xb7bfe000)
/lib/ld-linux.so.2 (0xb7fc4000)




Comment 1


Christopher Byrne





          2006-09-23 23:17:12 UTC
        

Gentoo Base System version 1.12.5
Portage 2.1.1 (default-linux/x86/2006.1, gcc-4.1.1, glibc-2.4-r3, 2.6.17-gentoo-r8 i686)
=================================================================
System uname: 2.6.17-gentoo-r8 i686 AMD Athlon(tm) XP 2000+
Last Sync: Sun, 24 Sep 2006 04:30:08 +0000
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: [Not Present]
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-mtune=i686 -O2 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-mtune=i686 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LINGUAS=""
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 berkdb bitmap-fonts bzip2 caps cli crypt cups dbus dlloader dri elibc_glibc fam fortran gdbm gnutls gpm input_devices_evdev input_devices_keyboard input_devices_mouse ipv6 isdnlog kernel_linux libg++ logrotate ncurses nls nptl nptlonly pam pcre perl ppds pppd python readline reflection samba session spl ssl tcpd truetype-fonts type1-fonts udev unicode userland_GNU video_cards_fbdev video_cards_savage xorg zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, MAKEOPTS, PORTAGE_RSYNC_EXTRA_OPTS

Note that "png" isn't in the USE flag, but it is listed in my /etc/portage/package.use file:

media-gfx/imagemagick jpeg png gs truetype

Portage correctly shows png as being enabled for this package




Comment 2


Christopher Byrne





          2006-09-23 23:20:35 UTC
        

Created attachment 97917 [details]
Output of build process

The output of the build process. The interesting parts are scattered all over.




Comment 3


Christopher Byrne





          2006-09-23 23:23:16 UTC
        

Created attachment 97918 [details]
Output of "convert  -list format"

THis is the output of "convert  -list format"




Comment 4


Christopher Byrne





          2006-09-26 21:35:21 UTC
        

Well, now, suddenly (without me even re-emerging it) the problem has fixed itself.

"convert" not being linked to libpng was a red herring - it must dlopen() it instead.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

