Title: 186031 – emerge of php-5.2.2-r1 ignores some use flags
URL: https://bugs.gentoo.org/show_bug.cgi?id=186031

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 186031
emerge of php-5.2.2-r1 ignores some use flags
Last modified: 2008-01-13 21:54:37 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 186031 
      - emerge of php-5.2.2-r1 ignores some use flags


Summary:
emerge of php-5.2.2-r1 ignores some use flags
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

PHP Bugs








URL:







Whiteboard:




Keywords:









Duplicates (2):
    

186035 205677

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2007-07-20 21:28 UTC by snoopdugiedog





      Modified:
    
2008-01-13 21:54 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



jocke
snoopdugiedog









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


snoopdugiedog





          2007-07-20 21:28:51 UTC
        

After emerging php-5.2.2-r1 with the pcre use flag I still cannot use pcre functions. phpinfo() confirms that php was compiled with '--without-pcre-regex'. Also, some other use flags disagree with the eventual configuration. 

Reproducible: Always

Steps to Reproduce:
1. Set use flags for php to: apache2 berkdb cgi cli crypt ctype mysql ncurses nls pcre pic readline session ssl suhosin unicode zlib
(maybe the fact that I'm running a hardened system has something to do with it too)
2.emerge "=dev-lang/php-5.2.2-r1"
3.run a php script with "<?php phpinfo(); ?> or try to use pcre functions

Actual Results:  
The pcre fuctions return the error: 
Fatal error: Call to undefined function preg_match_all() 

The configure options end up having the incorrect options:
'--disable-ctype' '--without-pcre-regex' '--disable-session'
Although, I'm not sure which one is supposed to be there for the mysql use flag, but since everything that might be it is disabled, it is also not in there.

While all the other options are correct:
'--prefix=/usr/lib/php5' '--host=i486-pc-linux-gnu' '--mandir=/usr/lib/php5/man' '--infodir=/usr/lib/php5/info' '--sysconfdir=/etc' '--cache-file=./config.cache' '--disable-cli' '--with-apxs2=/usr/sbin/apxs2' '--with-config-file-path=/etc/php/apache2-php5' '--with-config-file-scan-dir=/etc/php/apache2-php5/ext-active' '--without-pear' '--disable-bcmath' '--without-bz2' '--disable-calendar' '--without-curl' '--without-curlwrappers' '--disable-dbase' '--disable-dom' '--disable-exif' '--without-fbsql' '--without-fdftk' '--disable-filter' '--disable-ftp' '--with-gettext' '--without-gmp' '--disable-hash' '--without-iconv' '--disable-ipv6' '--disable-json' '--without-kerberos' '--disable-libxml' '--disable-mbstring' '--with-mcrypt' '--without-mhash' '--without-msql' '--without-mssql' '--with-ncurses' '--with-openssl' '--with-openssl-dir=/usr' '--disable-pcntl' '--disable-pdo' '--without-pgsql' '--disable-posix' '--without-pspell' '--without-recode' '--disable-reflection' '--disable-simplexml' '--disable-shmop' '--without-snmp' '--disable-soap' '--disable-sockets' '--disable-spl' '--without-sybase' '--without-sybase-ct' '--disable-sysvmsg' '--disable-sysvsem' '--disable-sysvshm' '--without-tidy' '--disable-tokenizer' '--disable-wddx' '--disable-xml' '--disable-xmlreader' '--disable-xmlwriter' '--without-xmlrpc' '--without-xsl' '--disable-zip' '--with-zlib' '--disable-debug' '--enable-dba' '--without-cdb' '--with-db4' '--without-flatfile' '--without-gdbm' '--without-inifile' '--without-qdbm' '--without-freetype-dir' '--without-t1lib' '--disable-gd-jis-conv' '--without-jpeg-dir' '--without-png-dir' '--without-xpm-dir' '--without-gd' '--without-mysqli' '--with-readline' '--without-libedit' '--without-sqlite' '--with-pic'

Also: I did grep "pcre-regex" on the log for the emerge and it returned:
 *  Enabling pcre-regex
 *  Enabling pcre-regex
 *  Enabling pcre-regex


Expected Results:  
'--without-pcre-regex', and others should not be set as so in the configure options, or at least an error to pop up during the emerge process, notifying me that certain use flags could not be enabled for whatever reason




Comment 1


Jakub Moc (RETIRED)






          2007-07-20 21:36:09 UTC
        

Kindly post emerge -pv php output.





Comment 2


Jakub Moc (RETIRED)






          2007-07-20 21:39:07 UTC
        

*** Bug 186035 has been marked as a duplicate of this bug. ***




Comment 3


snoopdugiedog





          2007-07-20 21:44:07 UTC
        

These are the packages that would be merged, in order: 

Calculating dependencies ...... done! 

[ebuild R ] dev-lang/php-5.2.2-r1 USE="apache2 berkdb cgi cli crypt ctype mysql ncurses nls pcre pic readline session ssl suhosin unicode zlib -adabas -bcmath -birdstep -bzip2 -calendar -cdb -cjk -concurrentmodphp -curl -curlwrappers -db2 -dbase -dbmaker -debug -discard-path -doc -empress -empress-bcs -esoob -exif -fastbuild -fdftk -filter -firebird -flatfile -force-cgi-redirect -frontbase -ftp -gd -gd-external -gdbm -gmp -hash -iconv -imap -inifile -interbase -iodbc -ipv6 -java-external -json -kerberos -ldap -ldap-sasl -libedit -mcve -mhash -msql -mssql -mysqli -oci8 (-oci8-instant-client) -odbc -pcntl -pdo -pdo-external -posix -postgres -qdbm -recode -reflection -sapdb -sharedext -sharedmem -simplexml -snmp -soap -sockets -solid -spell -spl -sqlite -sybase -sybase-ct -sysvipc -threads -tidy -tokenizer -truetype -wddx -xml -xmlreader -xmlrpc -xmlwriter -xpm -xsl -yaz -zip -zip-external" 0 kB Total: 1 package (1 reinstall), Size of downloads: 0 kB




Comment 4


Jakub Moc (RETIRED)






          2007-07-20 22:15:46 UTC
        

Attach the complete compile log here, please.




Comment 5


snoopdugiedog





          2007-07-20 22:58:45 UTC
        

You can find the compile log at http://www.cs.rpi.edu/~dugass/php.log (it's slightly over 1000kb so it won't let me attach it)




Comment 6


Jakub Moc (RETIRED)






          2007-07-21 10:45:38 UTC
        

Uhm; pcre is clearly enabled there. 

stat /usr/bin/php /usr/bin/php-cgi /usr/bin/phpize /usr/bin/php-config | grep File





Comment 7


snoopdugiedog





          2007-07-21 16:03:41 UTC
        

Here's the output from "stat /usr/bin/php /usr/bin/php-cgi /usr/bin/phpize /usr/bin/php-config | grep File":

File: `/usr/bin/php' -> `/usr/lib/php5/bin/php' 
File: `/usr/bin/php-cgi' -> `/usr/lib/php5/bin/php-cgi' 
File: `/usr/bin/phpize' -> `/usr/lib/php5/bin/phpize' 
File: `/usr/bin/php-config' -> `/usr/lib/php5/bin/php-config'




Comment 8


snoopdugiedog





          2007-07-23 18:58:37 UTC
        

Restarting Apache appears to have made it start working.




Comment 9


Jakub Moc (RETIRED)






          2007-07-23 19:21:59 UTC
        

Eh...




Comment 10


Jakub Moc (RETIRED)






          2008-01-13 21:54:37 UTC
        

*** Bug 205677 has been marked as a duplicate of this bug. ***









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

