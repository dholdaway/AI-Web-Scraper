Title: 798780 – sys-devel/gcc-11.1.0-r1: ICE compiling llvm12 in rust-1.53.0 - tools/llvm-objcopy/CMakeFiles/llvm-objcopy.dir/wasm/WasmObjcopy.cpp.o
URL: https://bugs.gentoo.org/show_bug.cgi?id=798780

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 798780
sys-devel/gcc-11.1.0-r1: ICE compiling llvm12 in rust-1.53.0 - tools/llvm-objcopy/CMakeFiles/llvm-objcopy.dir/wasm/WasmObjcopy.cpp.o
Last modified: 2021-06-28 10:21:08 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 798780 
      - sys-devel/gcc-11.1.0-r1: ICE compiling llvm12 in rust-1.53.0 - tools/llvm-objcopy/CMakeFiles/llvm-objcopy.dir/wasm/WasmObjcopy.cpp.o


Summary:
sys-devel/gcc-11.1.0-r1: ICE compiling llvm12 in rust-1.53.0 - tools/llvm-obj...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-06-26 12:01 UTC by HougeLangley





      Modified:
    
2021-06-28 10:21 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



herrtimson
rust
sam









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge-info.txt,8.15 KB,
                text/plain)

            
2021-06-26 12:01 UTC,

            HougeLangley




Details





build_log

              (rust-build.log,866.53 KB,
                text/x-log)

            
2021-06-26 12:01 UTC,

            HougeLangley




Details





build_envirnoment

              (rust-build-environment.txt,161.55 KB,
                text/plain)

            
2021-06-26 12:02 UTC,

            HougeLangley




Details





emerge --info

              (emerge--info.txt,6.12 KB,
                text/plain)

            
2021-06-27 13:07 UTC,

            HougeLangley




Details





build_log

              (build.log,533.42 KB,
                text/x-log)

            
2021-06-27 13:08 UTC,

            HougeLangley




Details





build_envirnoment

              (environment,161.32 KB,
                text/plain)

            
2021-06-27 13:08 UTC,

            HougeLangley




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


HougeLangley





          2021-06-26 12:01:22 UTC
        

Reinstall rust building failed

FAILED: tools/llvm-objcopy/CMakeFiles/llvm-objcopy.dir/wasm/WasmObjcopy.cpp.o

Reproducible: Always




Comment 1


HougeLangley





          2021-06-26 12:01:40 UTC
        

Created attachment 719403 [details]
emerge --info




Comment 2


HougeLangley





          2021-06-26 12:01:56 UTC
        

Created attachment 719406 [details]
build_log




Comment 3


HougeLangley





          2021-06-26 12:02:12 UTC
        

Created attachment 719409 [details]
build_envirnoment




Comment 4


Georgy Yakovlev







          2021-06-27 06:21:59 UTC
        

does it segfault at random bits of code or the same one every time?
what about llvm:12, does it fail at same files with wasm target enabled?


try with -O2 instead of -O3 btw.




Comment 5


Georgy Yakovlev







          2021-06-27 06:23:32 UTC
        

actually, it does not really need wasm target enabled. just llvm:12 is ok.




Comment 6


Georgy Yakovlev







          2021-06-27 06:26:04 UTC
        

and it's not really a bug in rust, it's a segfault in gcc while compiling llvm.
re-assigning to toolchain, leaving rust in CC.




Comment 7


HougeLangley





          2021-06-27 13:07:23 UTC
        

I reinstall my Gentoo System, but, still failed




Comment 8


HougeLangley





          2021-06-27 13:07:43 UTC
        

Created attachment 719568 [details]
emerge --info




Comment 9


HougeLangley





          2021-06-27 13:08:00 UTC
        

Created attachment 719571 [details]
build_log




Comment 10


HougeLangley





          2021-06-27 13:08:10 UTC
        

Created attachment 719574 [details]
build_envirnoment




Comment 11


HougeLangley





          2021-06-27 13:08:34 UTC
        

This time I using -O2




Comment 12


HougeLangley





          2021-06-27 16:47:15 UTC
        

I changed LLVM_TARGETS in my make.conf. Origion is LLVM_TARGETS="X86 AMDGPU". Now, it's LLVM_TARGETS="X86"

rust, llvm building successed.




Comment 13


Sam James









          2021-06-27 16:56:54 UTC
        

(In reply to HougeLangley from comment #12)
> I changed LLVM_TARGETS in my make.conf. Origion is LLVM_TARGETS="X86
> AMDGPU". Now, it's LLVM_TARGETS="X86"
> 
> rust, llvm building successed.

That doesn't mean the ICE is fixed though.




Comment 14


Georgy Yakovlev







          2021-06-28 08:51:28 UTC
        

in the second log it failed at a different file.

this usually means hardware problem, not a compiler bug.

check your RAM with memtest, if you overclocked CPU or/and RAM - try to lower it a bit.

you will keep seeing random ICEs if you don't down-clock system or find faulty RAM.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

