Title: 320995 – Consolekit doesn't start
URL: https://bugs.gentoo.org/show_bug.cgi?id=320995

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 320995
Consolekit doesn't start
Last modified: 2011-01-03 13:03:12 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 320995 
      - Consolekit doesn't start


Summary:
Consolekit doesn't start
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

346967

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2010-05-22 06:35 UTC by S.Holzbach





      Modified:
    
2011-01-03 13:03 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



jamesbroadhead
jarausch
lucs12









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


S.Holzbach





          2010-05-22 06:35:47 UTC
        

Consolekit doesn't start because PID file already in place and init-script complaines that consolekit ia already running. In consequence depending services (e.g hal) also not starting

Reproducible: Sometimes

Steps to Reproduce:
1. boot machine
2. use and shutdown
3. start machine next morning

Actual Results:  
consolekit not starting

Expected Results:  
consolekit starting




Comment 1


S.Holzbach





          2010-05-22 06:41:22 UTC
        

FOund in Logfile:

May 22 08:27:58 Hydra console-kit-daemon[3904]: WARNING: Failed to acquire org.freedesktop.ConsoleKit
May 22 08:27:58 Hydra console-kit-daemon[3904]: WARNING: Could not acquire name; bailing out

Maybe consolekit failes to start at first




Comment 2


Wormo (RETIRED)






          2010-05-27 06:47:03 UTC
        

Please post your 'emerge --info' output, and output from 'emerge -pv consolekit'

Also, could you show a little more context around those messages from your logfile?




Comment 3


S.Holzbach





          2010-05-27 19:29:30 UTC
        

(In reply to comment #2)
emerge --info:
Portage 2.1.8.3 (default/linux/amd64/10.0, gcc-4.4.3, glibc-2.11.1-r0, 2.6.33-gentoo x86_64)
=================================================================
System uname: Linux-2.6.33-gentoo-x86_64-AMD_Phenom-tm-_9550_Quad-Core_Processor-with-gentoo-2.0.1
Timestamp of tree: Thu, 27 May 2010 18:30:01 +0000
distcc 3.1 x86_64-pc-linux-gnu [enabled]
app-shells/bash:     4.1_p7
dev-java/java-config: 2.1.11
dev-lang/python:     2.6.5-r2, 3.1.2-r3
dev-util/cmake:      2.8.1-r1
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.6.1-r1
sys-apps/sandbox:    2.2
sys-devel/autoconf:  2.13, 2.65
sys-devel/automake:  1.8.5-r4, 1.9.6-r3, 1.10.3, 1.11.1
sys-devel/binutils:  2.20.1-r1
sys-devel/gcc:       4.3.4, 4.4.3-r2
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.7b
virtual/os-headers:  2.6.33
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA PUEL dlj-1.1"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=amdfam10 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=amdfam10 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--with-bdeps=y"
FEATURES="assume-digests distcc distlocks fixpackages metadata-transfer news parallel-fetch protect-owned sandbox sfperms splitdebug strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="rsync://gentoo.tiscali.nl/gentoo/ rsync://mirror.leaseweb.com/gentoo/ ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror/ rsync://de-mirror.org/gentoo/ rsync://ftp-stud.hs-esslingen.de/gentoo/ http://mirror.leaseweb.com/gentoo/ ftp://ftp-stud.hs-esslingen.de/pub/Mirrors/gentoo/ ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo http://gentoo.mirror.web4u.cz/ ftp://91.121.125.139/gentoo-distfiles/"
LANG="de_DE.UTF-8"
LC_ALL="de_DE.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="de"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/x11 /usr/local/portage/layman/qting-edge /usr/local/portage/layman/kde /usr/local/portage /usr/local/portage/myEbuilds"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext 64bit X a52 aac accessibility acl acpi additions alsa altenburgcards amd64 apache2 apm archive asf audiofile automount bash-completion bluetooth bzip2 cardbus cdparanoia cdr cgi cli clucene consolekit cpudetection cracklib crypt css ctype cups curl cvs cxx dar64 dbus dga dri dvd dvdr embedded encode extensions extra fam fbcon fbcondecor fbsplash festival ffmpeg filter firefox flac foomaticdb fts3 gd gdbm gif git glib glitz gnutls gpm graphite graphviz gs gtk gzip hal hbci iconv icq id3tag imagemagick imlib inotify java java6 javascript jpeg jpeg2k json kdcraw kde kde-qt kipi kolab kontact kpathsea lame latex lcms lm_sensors mad mbrola mime mjpeg mmap mmx mmxext mng modules mp3 mpeg mplayer mudflap multilib musicbrainz mysql mysqli ncurses new-hpcups nls nptl nptlonly nsplugin odbc offensive ogg opengl openmp osc oscar oss pam pch pcre pdf pdo perl phonon php plasma png policykit ppds python qmake qt3support qt4 qthelp quicktime raster rdesktop readline redeyes reflection samba sasl scanner sdl secure-delete semantic-desktop sensord server session smbclient sndfile soap sox speex spell spl sql sqlite sqlite3 sse sse2 sse3 ssl svg sysfs sysvipc tcpd theora threads tidy tiff tokenizer truetype udev unicode usb vcd virtuoso vnc vorbis webdav webkit wmf xcb xcomposite xine xinerama xinetd xml xmlreader xmlrpc xmlwriter xorg xpm xprint xscreensaver xv xvid xvmc yv12 zip zlib" ALSA_CARDS="hda-intel usb-audio" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic auth_digest authn_anon authn_dbd authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so speling status unique_id userdir usertrack vhost_alias worker" APACHE2_MPMS="worker" ELIBC="glibc" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de" RUBY_TARGETS="ruby18" SANE_BACKENDS="mustek_usb" USERLAND="GNU" VIDEO_CARDS="radeon r600 r300" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPT

emerge -pv consolekit:
These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R   ] sys-auth/consolekit-0.4.1  USE="pam policykit -debug -doc" 0 kB

Here all lines around the problem:
May 25 07:26:36 Hydra /etc/init.d/consolekit[3121]: start-stop-daemon: /usr/sbin/console-kit-daemon is already running
May 25 07:26:36 Hydra /etc/init.d/consolekit[3111]: ERROR: consolekit failed to start
May 25 07:26:36 Hydra /etc/init.d/hald[3125]: ERROR: cannot start hald as consolekit would not start
May 25 07:26:37 Hydra kernel: [   26.260913] fbcondecor: console 0 using theme 'natural_gentoo'
May 25 07:26:55 Hydra console-kit-daemon[3296]: WARNING: Failed to acquire org.freedesktop.ConsoleKit
May 25 07:26:55 Hydra console-kit-daemon[3296]: WARNING: Could not acquire name; bailing out





Comment 4


Rafał Mużyło





          2010-05-30 18:39:03 UTC
        

It seems to be a problem with the order services start.
What's the output of rc-config list' ?

Are hal and consolekit started as system services ?




Comment 5


S.Holzbach





          2010-05-30 18:55:41 UTC
        

Today it happened again. /var/log/messages show:

May 30 17:10:33 Hydra /etc/init.d/consolekit[3121]: start-stop-daemon: /usr/sbin/console-kit-daemon is already running
May 30 17:10:33 Hydra /etc/init.d/consolekit[3111]: ERROR: consolekit failed to start
May 30 17:10:33 Hydra /etc/init.d/hald[3125]: ERROR: cannot start hald as consolekit would not start
[...]
May 30 17:11:05 Hydra console-kit-daemon[3296]: WARNING: Failed to acquire org.freedesktop.ConsoleKit
May 30 17:11:05 Hydra console-kit-daemon[3296]: WARNING: Could not acquire name; bailing out


rc-config list:
Available init scripts
  acpid                     default
  alsasound                 boot
  apache2                   default
  bluetooth                 
  bootmisc                  boot
  consolefont               boot
  consolekit                
  crypto-loop               
  cupsd                     default
  dbus                      default
  dcc                       
  ddclient                  default
  devfs                     sysinit
  device-mapper             boot
  dhcpcd                    
  distccd                   default
  dmcrypt                   
  dmesg                     sysinit
  dmeventd                  
  dnsextd                   
  eposd                     
  fancontrol                
  fbcondecor                boot
  festival                  
  fsck                      boot
  fuse                      
  git-daemon                
  gpm                       
  hald                      default
  hdparm                    
  hostname                  boot
  hsqldb                    
  hwclock                   boot
  keymaps                   boot
  keytouch                  
  killprocs                 shutdown
  lm_sensors                
  local                     default
  localmount                boot
  lvm                       
  mdadm                     boot
  mdnsd                     
  mDNSResponderPosix        
  mdraid                    
  modules                   boot
  mount-ro                  shutdown
  mtab                      boot
  mysql                     default
  mysqlmanager              
  net.eth0                  default
  net.lo                    boot
  netmount                  default
  network                   
  nscd                      
  ntp-client                default
  ntpd                      
  numlock                   
  pciparm                   
  powernowd                 default
  procfs                    boot
  pwcheck                   
  pydoc-2.6                 
  pydoc-3.1                 
  root                      boot
  rpcbind                   
  rsyncd                    
  samba                     
  saslauthd                 
  savecache                 shutdown
  sensord                   
  slpd                      
  smartd                    
  spamd                     default
  speech-dispatcher         
  sshd                      default
  staticroute               
  svnserve                  
  swap                      boot
  swclock                   
  sysctl                    boot
  sysfs                     
  syslog-ng                 default
  termencoding              boot
  udev                      sysinit
  udev-dev-tarball          
  udev-mount                
  udev-postmount            default
  urandom                   boot
  vixie-cron                default
  xdm                       default
  xdm-setup                 
  xinetd                    default

Strange... as I post this list I see that consolekit isn't member of any runlevel anymore... I don't know why it's gone from default, but I am sure I added it to default upon installation. Should I add it to default and check if problems are gone ?




Comment 6


Andrea





          2010-06-06 23:33:19 UTC
        

I've the same problem.
The strange situation is that if I compile and try to start consolekit it start, but at next restart want not execute.

my rc-config list default

Init scripts to be started by runlevel default

  acpid
  consolekit
  cpufreqd
  cupsd
  dbus
  hald
  local
  netmount
  syslog-ng
  timidity
  udev-postmount
  vixie-cron
  wicd
  xdm

my emerge --info

emerge --info
Portage 2.2_rc67 (default/linux/x86/10.0/desktop/kde, gcc-4.4.3, glibc-2.10.1-r1, 2.6.32-gentoo-r7 i686)
=================================================================                                       
System uname: Linux-2.6.32-gentoo-r7-i686-Intel-R-_Pentium-R-_M_processor_1.86GHz-with-gentoo-1.12.13   
Timestamp of tree: Sun, 06 Jun 2010 22:55:01 +0000                                                      
ccache version 2.4 [enabled]                                                   
app-shells/bash:   4.0_p37                                                      
dev-java/java-config: 2.1.10                                                  
dev-lang/python:     2.6.4-r1, 3.1.2-r3                    
dev-util/ccache:     2.4-r7    
dev-util/cmake:      2.6.4-r3                             
sys-apps/baselayout: 1.12.13   
sys-apps/sandbox:    2.2     
sys-devel/autoconf:  2.13, 2.65 
sys-devel/automake:  1.8.5-r4, 1.9.6-r3, 1.10.3, 1.11.1 
sys-devel/binutils:  2.18-r3     
sys-devel/gcc:       4.4.3-r2   
sys-devel/gcc-config: 1.4.1   
sys-devel/libtool:   2.2.6b     
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="x86"
ACCEPT_LICENSE="* -@EULA PUEL dlj-1.1 sun-bcla-java-vm skype-eula googleearth"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium-m -O3 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=pentium-m -O3 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests ccache distlocks fixpackages news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
GENTOO_MIRRORS="http://ftp.uni-erlangen.de/pub/mirrors/gentoo"
LANG="it_IT.UTF-8"
LC_ALL="it_IT.UTF-8"
LDFLAGS="-Wl,-O1"
LINGUAS="it"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/science /usr/local/portage/layman/pro-audio /usr/local/portage/layman/desktop-effects /usr/local/portage/layman/armagetron"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac aalib acl acpi alsa audiofile berkdb bluetooth branding bzip2 cairo cdparanoia cdr cli consolekit cpudetection cracklib crypt cups cxx dbus dri dts dv dvd dvdr dvdread emboss encode exif fam flac foomatic foomaticdb fortran gdbm gif gimp gpm gtk hal i8x0 iconv innodb java java6 jpeg jpeg2k kde lcms ldap libnotify mad mikmod mmx mmxext mng mod_php modules mp3 mp4 mpeg mudflap musepack ncurses nls nptl nptlonly ogg opengl openmp pam pango pcre pdf perl png ppds pppd python qt3support qt4 quicktime raw readline reflection samba sdl session spell spl sse sse2 ssl startup-notification svg sysfs tcpd threads tiff timidity truetype usb vorbis wifi win32codecs wmf x264 x86 xcb xine xml xml2 xorg xulrunner xv xvid zlib" ALSA_CARDS="intel8x0" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="synaptics evdev mouse keyboard" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="it" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="radeon" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 7


S.Holzbach





          2010-06-07 06:02:00 UTC
        

adding ConsoleKit to runlevel default solved the problems for me. 




Comment 8


James Broadhead





          2010-12-01 15:28:46 UTC
        

*** Bug 346967 has been marked as a duplicate of this bug. ***




Comment 9


James Broadhead





          2010-12-07 12:50:29 UTC
        

(In reply to comment #7)
> adding ConsoleKit to runlevel default solved the problems for me. 

Didn't fix this for me. More details in my duplicate report. 

This happens on my machine with rc_parallel="yes" and  rc_parallel="no" and with consolekit in and not in the default runlevel. It is now happening every boot. 

I have:
sys-auth/consolekit-0.4.2-r4
sys-apps/baselayout-2.0.1-r1
sys-apps/openrc-0.65


Please reopen. 





Comment 10


Helmut Jarausch





          2010-12-18 07:29:27 UTC
        

(In reply to comment #7)
> adding ConsoleKit to runlevel default solved the problems for me. 
> 

It doesn't work for me either.
on ~amd64
consolekit-0.4.3
baselayout-2.0.1-r1
openrc-0.6.8





Comment 11


Helmut Jarausch





          2010-12-18 08:36:51 UTC
        

(In reply to comment #10)
> (In reply to comment #7)
> > adding ConsoleKit to runlevel default solved the problems for me. 
> > 
> 
> It doesn't work for me either.
> on ~amd64
> consolekit-0.4.3
> baselayout-2.0.1-r1
> openrc-0.6.8
> 

In addition, after the system has come up
hald is not running
1 # /etc/init.d/consolekit start
 * Starting ConsoleKit daemon ...
 * start-stop-daemon: /usr/sbin/console-kit-daemon is already running     [ !! ]
 * ERROR: consolekit failed to start

2 # stop 
 * WARNING: consolekit is already stopped

3 # /etc/init.d/consolekit restart
 * Starting ConsoleKit daemon ...
 * start-stop-daemon: /usr/sbin/console-kit-daemon is already running     [ !! ]
 * ERROR: consolekit failed to start

killall console-kit-daemon
/etc/init.d/consolekit start
/etc/init.d/hald start

started both





Comment 12


lucs12





          2010-12-29 05:03:46 UTC
        

try a  emerge -av --oneshot dbus dbus-glib, that fixed worked for me.




Comment 13


Rafał Mużyło





          2010-12-30 21:58:41 UTC
        

(In reply to comment #12)
> try a  emerge -av --oneshot dbus dbus-glib, that fixed worked for me.
> 

If that did help, it may have been a dupe of bug 297483.




Comment 14


James Broadhead





          2010-12-31 13:38:44 UTC
        

(In reply to comment #12)
> try a  emerge -av --oneshot dbus dbus-glib, that fixed worked for me.
> 

Didn't work for me the first time, but after an emerge -uDavN world, then another emerge -av1 dbus dbus-glib worked. Something else must have been required. Still, working for me now - thanks for the hint!




Comment 15


James Broadhead





          2011-01-03 13:03:12 UTC
        

(In reply to comment #14)
> Didn't work for me the first time, but after an emerge -uDavN world, then
> another emerge -av1 dbus dbus-glib worked. Something else must have been
> required. Still, working for me now - thanks for the hint!

Apologies - this post was in error. consolekit is still not working on my system, but with xorg-server-1.9 no longer requiring hal, xdm now starts correctly. 

This bug should be re-opened.











Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

