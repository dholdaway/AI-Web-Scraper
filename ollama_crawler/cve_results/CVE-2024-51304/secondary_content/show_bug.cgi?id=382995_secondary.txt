Title: 382995 – media-libs/mesa-7.11: Fails to emerge with sys-devel/llvm[udis86]
URL: https://bugs.gentoo.org/show_bug.cgi?id=382995

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 382995
media-libs/mesa-7.11: Fails to emerge with sys-devel/llvm[udis86]
Last modified: 2011-11-01 00:27:09 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 382995 
      - media-libs/mesa-7.11: Fails to emerge with sys-devel/llvm[udis86]


Summary:
media-libs/mesa-7.11: Fails to emerge with sys-devel/llvm[udis86]
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       minor
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-09-14 20:41 UTC by Anthoine Bourgeois





      Modified:
    
2011-11-01 00:27 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



voyageur









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




By moving LDFLAGS in group with LIBS, the link doesn't make problem anymore.

              (7.11-mesa-gallium-libs.patch,667 bytes,
                patch)

            
2011-09-17 18:15 UTC,

            Anthoine Bourgeois




Details
            | Diff





A patch to mesa ebuild. Maybe a mesa-7.11-r1.ebuild

              (mesa-7.11.ebuild.patch,537 bytes,
                patch)

            
2011-09-17 18:20 UTC,

            Anthoine Bourgeois




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Anthoine Bourgeois





          2011-09-14 20:41:40 UTC
        

If llvm has been emerged with USE="udis86" then lp_test_format will fail to link with libLLVMSupport.a, at the end of compilation of mesa-7.11 .



Reproducible: Always

Steps to Reproduce:
1. USE=udis86 emerge -1v llvm
2. emerge -1v mesa

Actual Results:  
i686-pc-linux-gnu-g++ -Wl,-O1 -Wl,--as-needed -L/usr/lib/llvm  -ludis86 -lpthread -lffi -ldl -lm  lp_test_format.o lp_test_main.o -o lp_test_format -Wl,--start-group  -L../../auxiliary/ -lgallium libllvmpipe.a -lLLVMObject -lLLVMMCJIT -l
LLVMMCDisassembler -lLLVMXCoreCodeGen -lLLVMXCoreInfo -lLLVMSystemZCodeGen -lLLVMSystemZInfo -lLLVMSparcCodeGen -lLLVMSparcInfo -lLLVMPowerPCCodeGen -lLLVMPowerPCInfo -lLLVMPowerPCAsmPrinter -lLLVMPTXCodeGen -lLLVMPTXInfo -lLLVMMipsCodeG
en -lLLVMMipsInfo -lLLVMMSP430CodeGen -lLLVMMSP430Info -lLLVMMSP430AsmPrinter -lLLVMMBlazeDisassembler -lLLVMMBlazeAsmParser -lLLVMMBlazeCodeGen -lLLVMMBlazeAsmPrinter -lLLVMMBlazeInfo -lLLVMLinker -lLLVMipo -lLLVMInterpreter -lLLVMInstr
umentation -lLLVMJIT -lLLVMExecutionEngine -lLLVMCppBackend -lLLVMCppBackendInfo -lLLVMCellSPUCodeGen -lLLVMCellSPUInfo -lLLVMCBackend -lLLVMCBackendInfo -lLLVMBlackfinCodeGen -lLLVMBlackfinInfo -lLLVMBitWriter -lLLVMX86Disassembler -lLL
VMX86AsmParser -lLLVMX86CodeGen -lLLVMX86AsmPrinter -lLLVMX86Utils -lLLVMX86Info -lLLVMAsmParser -lLLVMARMDisassembler -lLLVMARMAsmParser -lLLVMARMCodeGen -lLLVMARMAsmPrinter -lLLVMARMInfo -lLLVMArchive -lLLVMBitReader -lLLVMAlphaCodeGen
 -lLLVMSelectionDAG -lLLVMAsmPrinter -lLLVMMCParser -lLLVMCodeGen -lLLVMScalarOpts -lLLVMInstCombine -lLLVMTransformUtils -lLLVMipa -lLLVMAnalysis -lLLVMTarget -lLLVMCore -lLLVMAlphaInfo -lLLVMMC -lLLVMSupport -lstdc++  -lXext -lXdamage 
-lXfixes -lXxf86vm -lX11-xcb -lX11 -lxcb-glx -lxcb   -ldrm   -lm -lpthread -ldl -Wl,--end-group
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x28c): undefined reference to `ud_init'
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x2a8): undefined reference to `ud_set_input_buffer'
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x2b8): undefined reference to `ud_set_mode'
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x2d4): undefined reference to `ud_set_pc'
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x2da): undefined reference to `ud_translate_att'
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x2e6): undefined reference to `ud_set_syntax'
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x372): undefined reference to `ud_disassemble'
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x37e): undefined reference to `ud_insn_asm'
/usr/lib/llvm/libLLVMSupport.a(Disassembler.o): In function `llvm::sys::disassembleBuffer(unsigned char*, unsigned int, unsigned long long)':
(.text+0x388): undefined reference to `ud_insn_off'
collect2: ld a retourné 1 code d'état d'exécution
gmake[4]: *** [lp_test_format] Erreur 1
gmake[4] : on quitte le répertoire « /var/tmp/portage/media-libs/mesa-7.11/work/Mesa-7.11/src/gallium/drivers/llvmpipe »
gmake[3]: *** [default] Erreur 1
gmake[3] : on quitte le répertoire « /var/tmp/portage/media-libs/mesa-7.11/work/Mesa-7.11/src/gallium/drivers »
gmake[2]: *** [default] Erreur 1
gmake[2] : on quitte le répertoire « /var/tmp/portage/media-libs/mesa-7.11/work/Mesa-7.11/src/gallium »
make[1]: *** [subdirs] Erreur 1
make[1] : on quitte le répertoire « /var/tmp/portage/media-libs/mesa-7.11/work/Mesa-7.11/src »
make: *** [default] Erreur 1
emake failed

Expected Results:  
As far as I can tell, mesa[llvm] requires llvm[-udis86], so the mesa ebuild
should check for its absence and die if it is found.


Portage 2.1.10.11 (hardened/linux/x86, gcc-4.4.5, glibc-2.12.2-r0, 2.6.36-hardened-r6 i686)
=================================================================
                        System Settings
=================================================================
System uname: Linux-2.6.36-hardened-r6-i686-AMD_Athlon-tm-_II_X2_240_Processor-with-gentoo-2.0.3
Timestamp of tree: Mon, 12 Sep 2011 21:30:01 +0000
app-shells/bash:          4.1_p9
dev-lang/python:          2.7.1-r1, 3.1.3-r1
dev-util/cmake:           2.8.4-r1
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.0.3
sys-apps/openrc:          0.8.3-r1
sys-apps/sandbox:         2.4
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.9.6-r3, 1.11.1
sys-devel/binutils:       2.20.1-r1
sys-devel/gcc:            4.4.5
sys-devel/gcc-config:     1.4.1-r1
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82-r1
sys-kernel/linux-headers: 2.6.36.1 (virtual/os-headers)
sys-libs/glibc:           2.12.2
Repositories: gentoo x11 sunrise aluco
ACCEPT_KEYWORDS="x86"
ACCEPT_LICENSE="*"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=amdfam10 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -march=amdfam10 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks ebuild-locks fixlafiles fixpackages news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="ftp://ftp.free.fr/mirrors/ftp.gentoo.org/ "
LANG="fr_FR.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="fr"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/x11 /var/lib/layman/sunrise /home/asa/gentoo"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac abm acl acpi alsa audiofile bash-completion berkdb bzip2 cairo cdda cddb cdio cdr cli consolekit cracklib crypt cscope cups cxx dbus device-mapper dri dvd dvdr dvdread encode esd exif fbcon ffmpeg firefox flac gdbm gdu gif git gnome gnutls gpm gstreamer gtk hardened iconv id3 jpeg jpeg2k lame libnotify lzma mad mmx mng modules mp3 mpeg mudflap musepack nautilus ncurses nls nptl nptlonly nsplugin ogg openal openexr opengl openmp pam pax_kernel pcre pdf perl pic png policykit popcnt pppd pulseaudio python qt3support readline sdl session sqlite sse sse2 sse3 sse4a ssl svg svga sysfs taglib tcpd theora tiff udev urandom vorbis x264 x86 xine xorg xulrunner xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="fr" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="radeon" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

media-libs/mesa-7.11 was built with the following:
USE="classic egl gallium llvm nptl pax_kernel pic shared-glapi -bindist -debug -gbm -gles -motif -openvg (-selinux) -shared-dricore" VIDEO_CARDS="radeon -intel -mach64 -mga -nouveau -r128 -savage -sis -tdfx -via -vmware"
CFLAGS="-O2 -march=amdfam10 -pipe -ffast-math"
CXXFLAGS="-O2 -march=amdfam10 -pipe -ffast-math"




Comment 1


Matt Turner






          2011-09-16 18:30:47 UTC
        

It looks to me like what's happening is -ludis86 is appearing before
-lLLVMSupport on the command line and since both are static libraries, it's getting undefined references.




Comment 2


Matt Turner






          2011-09-16 18:51:49 UTC
        

Unable to reproduce with =dev-libs/udis86-1.7, =sys-devel/llvm-2.9-r2, and either mesa-7.11 or mesa-9999.




Comment 3


Anthoine Bourgeois





          2011-09-16 20:47:39 UTC
        

(In reply to comment #1)
> It looks to me like what's happening is -ludis86 is appearing before
> -lLLVMSupport on the command line and since both are static libraries, it's
> getting undefined references.

You're right. I unpack and confgure mesa with the ebuild command and I compile the llvmpipe driver within its directory with the same problem as describe above. If I take the command line and move -ludis86 at the end of the LLVM libs it works.
How can I fix it ?




Comment 4


Matt Turner






          2011-09-16 21:09:50 UTC
        

(In reply to comment #3)
> (In reply to comment #1)
> > It looks to me like what's happening is -ludis86 is appearing before
> > -lLLVMSupport on the command line and since both are static libraries, it's
> > getting undefined references.
> 
> You're right. I unpack and confgure mesa with the ebuild command and I compile
> the llvmpipe driver within its directory with the same problem as describe
> above. If I take the command line and move -ludis86 at the end of the LLVM libs
> it works.
> How can I fix it ?

I don't know. I can't reproduce it on my amd64 box or my x86 chroot. I think the problem is something local on your system.

Try reinstalling udis86 and llvm?




Comment 5


Anthoine Bourgeois





          2011-09-16 22:35:08 UTC
        

> 
> Try reinstalling udis86 and llvm?

Yes, it doesn't help. Can you give me your command line of lp_test_format to compare ?




Comment 6


Matt Turner






          2011-09-17 17:01:31 UTC
        

x86_64-pc-linux-gnu-g++ -Wl,-O1 -Wl,--as-needed -L/usr/lib64/llvm  -ludis86 -lpthread -lffi -ldl -lm  lp_test_format.o lp_test_main.o -o lp_test_format -Wl,--start-group  -L../../auxiliary/ -lgallium libllvmpipe.a -lLLVMObject -lLLVMMCJIT -lLLVMMCDisassembler -lLLVMLinker -lLLVMipo -lLLVMInterpreter -lLLVMInstrumentation -lLLVMJIT -lLLVMExecutionEngine -lLLVMBitWriter -lLLVMX86Disassembler -lLLVMX86AsmParser -lLLVMX86CodeGen -lLLVMSelectionDAG -lLLVMX86AsmPrinter -lLLVMX86Utils -lLLVMX86Info -lLLVMAsmPrinter -lLLVMMCParser -lLLVMCodeGen -lLLVMScalarOpts -lLLVMInstCombine -lLLVMTransformUtils -lLLVMipa -lLLVMAsmParser -lLLVMArchive -lLLVMBitReader -lLLVMAnalysis -lLLVMTarget -lLLVMMC -lLLVMCore -lLLVMSupport -lstdc++  -lXext -lXdamage -lXfixes -lXxf86vm -lX11-xcb -lX11 -lxcb-glx -lxcb   -ldrm   -lm -lpthread -ldl -Wl,--end-group




Comment 7


Anthoine Bourgeois





          2011-09-17 17:31:26 UTC
        

Same problem with your command line. It's very strange. Can you give me your --info and your ld version ?




Comment 8


Matt Turner






          2011-09-17 17:35:55 UTC
        

localhost mattst88 # emerge --info
Portage 2.1.10.3 (default/linux/amd64/10.0, gcc-4.6.1, glibc-2.12.2-r0, 3.1.0-rc2+ x86_64)
=================================================================
System uname: Linux-3.1.0-rc2+-x86_64-Intel-R-_Core-TM-_i5-2500K_CPU_@_3.30GHz-with-gentoo-2.0.3
Timestamp of tree: Fri, 16 Sep 2011 20:00:01 +0000
distcc 3.1 x86_64-pc-linux-gnu [disabled]
app-shells/bash:          4.1_p9
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.1-r1, 3.1.3-r1
dev-util/cmake:           2.8.4-r1
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.0.3
sys-apps/openrc:          0.8.3-r1
sys-apps/sandbox:         2.4
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.9.6-r3, 1.11.1
sys-devel/binutils:       2.21
sys-devel/gcc:            4.5.2, 4.6.1
sys-devel/gcc-config:     1.4.1-r1
sys-devel/libtool:        2.4-r1
sys-devel/make:           3.82
sys-kernel/linux-headers: 2.6.38 (virtual/os-headers)
sys-libs/glibc:           2.12.2
Repositories: gentoo x11 gnome xhub x-mattst88
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA AdobeFlash-10.1 Q3AEULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -march=native -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -march=native -pipe"
DISTDIR="/var/portage/distfiles"
FEATURES="assume-digests binpkg-logs distlocks ebuild-locks fixlafiles fixpackages news parallel-fetch protect-owned sandbox sfperms sign strict unknown-features-warn unmerge-logs unmerge-orphans userfetch"
FFLAGS=""
GENTOO_MIRRORS="http://gentoo.osuosl.org"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en en_US"
MAKEOPTS="-j5"
PKGDIR="/var/portage/packages/sandybridge"
PORTAGE_BZIP2_COMMAND="lbzip2"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/x11 /usr/portage/local/layman/gnome /usr/portage/local/layman/xhub /usr/portage/local/mattst88"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acpi alsa amd64 bash-completion bzip2 cairo cdparanoia cdr cli consolekit cracklib crypt cscope cups curl cxx dbus dhclient dri dvd encode exif expat ffmpeg flac fontconfig fuse gconf gd gdu gif gimp git gnome gnome-keyring gnutls gpg gphoto2 graphite gstreamer gtk iconv icu java jpeg jpeg2k lcms libnotify lm_sensors lto lzo mad mbox mmap mmx mmxext mng modules mp3 mpeg mudflap multilib nautilus ncurses nfs nls nptl nptlonly nsplugin ogg openal opengl openmp pam pch pcre pdf perl png policykit ppds pppd pstricks pulseaudio python rar readline samba sdl session sndfile spell sqlite sse sse2 sse3 sse4 ssl ssse3 svg sysfs system-sqlite tcpd theora threads tiff truetype udev unicode urandom v4l v4l2 vaapi vdpau vorbis x264 xcb xetex xml xorg xv xvid xvmc zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_US" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" SANE_BACKENDS="hp" USERLAND="GNU" VIDEO_CARDS="intel" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account" 
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS


I have binutils-2.21 while you have 2.20.1-r1. Try updating to binutils-2.21 or newer.




Comment 9


Anthoine Bourgeois





          2011-09-17 18:15:18 UTC
        

Created attachment 286813 [details, diff]
By moving LDFLAGS in group with LIBS, the link doesn't make problem anymore.




Comment 10


Anthoine Bourgeois





          2011-09-17 18:19:22 UTC
        

I got a patch but I don't know why by it works every where except for me by default. Install a newer binutils doesn't help. And I don't know why llvmpipe is built with mesa because the driver doesn't appear in configure options (--with-dri-drivers=,swrast,radeon,r200,r300,r600 --with-gallium-drivers=,swrast,r300,r600). Is it build always by default ?




Comment 11


Anthoine Bourgeois





          2011-09-17 18:20:10 UTC
        

Created attachment 286815 [details, diff]
A patch to mesa ebuild. Maybe a mesa-7.11-r1.ebuild




Comment 12


Matt Turner






          2011-09-17 18:25:16 UTC
        

(In reply to comment #10)
> And I don't know why llvmpipe
> is built with mesa because the driver doesn't appear in configure options
> (--with-dri-drivers=,swrast,radeon,r200,r300,r600
> --with-gallium-drivers=,swrast,r300,r600). Is it build always by default ?

softpipe (gallium3d software rasterizer, or swrast) uses LLVM with USE=llvm and then is called llvmpipe.




Comment 13


Matt Turner






          2011-11-01 00:27:09 UTC
        

I'm going to close as WORKSFORME, since I don't know what else I can do.

I really think it's something weird about your setup.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

