Title: 134510 – transcode-1.0.2-r2 compilation failure due to missing libdpstk.la, libdps.la and libpsres.la
URL: https://bugs.gentoo.org/show_bug.cgi?id=134510

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 134510
transcode-1.0.2-r2 compilation failure due to missing libdpstk.la, libdps.la and libpsres.la
Last modified: 2006-10-15 00:58:33 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 134510 
      - transcode-1.0.2-r2 compilation failure due to missing libdpstk.la, libdps.la and libpsres.la


Summary:
transcode-1.0.2-r2 compilation failure due to missing libdpstk.la, libdps.la ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Media-video project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-05-27 05:02 UTC by Alain





      Modified:
    
2006-10-15 00:58 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



jakub
markknecht









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




.revdep-rebuild.3_rebuild

              (.revdep-rebuild.3_rebuild,2.14 KB,
                text/plain)

            
2006-05-27 05:32 UTC,

            Alain




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Alain





          2006-05-27 05:02:53 UTC
        

The compilation of transcode-1.0.2-r2 failed for me due to missing .la files in xorg:

In /usr/X11R6/lib and /usr/lib the following files seem to be needed:
libdpstk.la, libdps.la and libpsres.la

Here's the compilation error:

grep: /usr/lib/libdpstk.la: Too many levels of symbolic links
/bin/sed: can't read /usr/lib/libdpstk.la: Too many levels of symbolic links
libtool: link: `/usr/lib/libdpstk.la' is not a valid libtool archive
make[3]: *** [import_im.la] Fehler 1
make[3]: *** Warte auf noch nicht beendete Prozesse...
grep: /usr/lib/libdpstk.la: Too many levels of symbolic links
/bin/sed: can't read /usr/lib/libdpstk.la: Too many levels of symbolic links
libtool: link: `/usr/lib/libdpstk.la' is not a valid libtool archive

I found these files by googling and had to adjust them to my system and now compilation works.

Steps to reproduce:
1. emerge transcode


regards

Alain

>emerge info
Portage 2.0.54-r2 (default-linux/x86/2006.0, gcc-3.4.5, glibc-2.3.5-r2, 2.6.15-g
entoo-r1 i686)
=================================================================
System uname: 2.6.15-gentoo-r1 i686 Intel(R) Pentium(R) M processor 1.73GHz
Gentoo Base System version 1.6.14
dev-lang/python:     2.2.3-r1, 2.3.5, 2.4.2
dev-python/pycrypto: 2.0.1-r4
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.4.3-r1, 1.5.22
virtual/os-headers:  2.4.19, 2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=pentium-m -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.1/share/config /usr/kde/
3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config 
/usr/lib/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/t
exmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/pla
tex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/eselect/compiler /etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=pentium-m -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://sunsite.cnlab-switch.ch/ftp/mirror/gentoo/ ftp://sunsite.
cnlab-switch.ch/mirror/gentoo/"
LC_ALL="de_CH.ISO-8859-1"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X a52 aac aalib alsa apache2 apm arts audiofile automount avi berkdb bi
tmap-fonts bonobo bzip2 cdr cli crypt css cups curl dri dv dvd dvdr dvdread eds 
emboss encode esd exif expat fam ffmpeg firefox flac foomaticdb fortran gdbm gif
 gimpprint glut gpm gstreamer gtk gtk2 gtkhtml guile hal i8x0 idn ieee1394 image
magick imap imlib ipv6 isdnlog jack java jikes jpeg junit kde lcms ldap libg++ l
ibwww lirc mad matrox mikmod mmx mmxext mng motif mozilla mp3 mpeg mysql ncurses
 nls nptl ogg opengl oss pam pcre pdflib perl php pic png pppd python qt quickti
me readline reflection samba sblive scanner sdl session slang spell spl sql sse 
sse2 ssl subversion svg svga tcltk tcpd tetex tiff truetype truetype-fonts type1
-fonts udev usb vcd video_cards_i810 vorbis win32codecs wmf xine xinerama xml xm
l2 xmms xorg xv xvid zlib video_cards_i830 video_cards_i915 video_cards_fbdev us
erland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, INSTALL_MASK, LANG, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EX
TRA_OPTS, PORTAGE_RSYNC_OPTS




Comment 1


Alain





          2006-05-27 05:04:25 UTC
        

Compilation works after adding needed files




Comment 2


Jakub Moc (RETIRED)






          2006-05-27 05:06:54 UTC
        

(In reply to comment #0)
> I found these files by googling and had to adjust them to my system and now
> compilation works.

Meh, that for sure isn't a valid fix. :-) Also, you seem to have some weird symlining in /usr...




Comment 3


Diego Elio Pettenò (RETIRED)






          2006-05-27 05:23:14 UTC
        

You tried revdep-rebuild already?





Comment 4


Alain





          2006-05-27 05:26:07 UTC
        

Sure it's not a valid fix, that's why I'm posting ;-) But I can't spend mor time on the topic right now. If you need more info, please tell me.

I didn't change any of my symlinking in /usr/lib in first place, but then I was trying some things... ;-)

It seems to me the script is looking for the .la files in both paths even if there are no symlinks. But, really - I don't know shit about this problem. I'm just happy to have transcode now....

Thanks for your incredibly quick reply!

revdep-rebuild isr running right now, thanks for the hint.

Alain




Comment 5


Jakub Moc (RETIRED)






          2006-05-27 05:28:07 UTC
        

(In reply to comment #4)
> revdep-rebuild isr running right now, thanks for the hint.

Well, for revdep-rebuild to have a chance to spot and fix this, you'll need to remove the googled .la files you did put there first. :)




Comment 6


Alain





          2006-05-27 05:32:29 UTC
        

Created attachment 87636 [details]
.revdep-rebuild.3_rebuild

here's part of the ouptut of revdep-rebuild. But nothing about libdpstk




Comment 7


Alain





          2006-05-27 05:33:20 UTC
        

ok, I'll remove the googled files...




Comment 8


Alain





          2006-05-27 05:59:15 UTC
        

ok, so I ran 
>revdep-rebuild -X

A lot of broken libs were there, but no ebuilds were rebuilt. I'm using this script for the first time, so I don't know what's supposed to happen.

Here's the end of my output:


Cleaning list of packages to rebuild... done.
  (/home/brenzi/.revdep-rebuild.4_packages)

Assigning packages to ebuilds... done.
  (/home/brenzi/.revdep-rebuild.4_ebuilds)

Evaluating package order... done.
  (/home/brenzi/.revdep-rebuild.5_order)

Dynamic linking on your system is consistent... All done. 





Comment 9


Mark Knecht





          2006-07-22 17:15:23 UTC
        

I think I probably ran into the same bug today. This was as a result of doing a revdep-rebuild operation. I decided to get rid of a few ~x86 packages while cleaning up. Here is the commad revdep-rebuild created for me:

dragonfly ~ # emerge --oneshot =sys-devel/gcc-3.4.6-r1 =media-gfx/imagemagick-6.2.8.0 =app-office/abiword-2.2.11 =media-gfx/gimp-print-4.2.7 =media-libs/libcddb-1.2.1 =media-libs/t1lib-5.0.2 =media-video/transcode-1.0.2-r2 =net-im/gaim-1.5.0


When I executed it I got this error:

libfame                        no
imagemagick                    no
libjpeg                        yes
bsdav                          no
iconv                          yes

ERROR: option '--enable-libquicktime' failed: cannot compile quicktime.h
quicktime.h can be found in the following packages:
  libquicktime  http://libquicktime.sourceforge.net/


Please see the INSTALL file in the top directory of the
transcode sources for more information about building
transcode with this configure script.


!!! Please attach the following file when filing a report to bugs.gentoo.org:
!!! /home/portage_temp/portage/transcode-1.0.2-r2/work/transcode-1.0.2/config.log

!!! ERROR: media-video/transcode-1.0.2-r2 failed.
Call stack:
  ebuild.sh, line 1539:   Called dyn_compile
  ebuild.sh, line 939:   Called src_compile
  transcode-1.0.2-r2.ebuild, line 98:   Called econf '--disable-altivec' '--disable-netstream' '--enable-freetype2' '--enable-v4l' '--enable-lame' '--enable-ogg' '--enable-vorbis' '--disable-theora' '--enable-libdvdread' '--disable-libdv' '--enable-libquicktime' '--disable-lzo' '--disable-a52' '--enable-libmpeg3' '--enable-libxml2' '--enable-mjpegtools' '--enable-sdl' '--enable-gtk' '--disable-libfame' '--disable-imagemagick' '--enable-libjpeg' '--with-mod-path=/usr/lib/transcode' '--with-x' '--with-default-xvid=xvid4' '--enable-mmx' '--disable-3dnow' '--enable-sse' '--enable-sse2' '--with-libpostproc-builddir=//usr/lib' '--with-lzo-includes=/usr/include/lzo' '--disable-avifile'
  ebuild.sh, line 541:   Called die

!!! econf failed
!!! If you need support, post the topmost build error, and the call stack if relevant.

dragonfly ~ #


dragonfly ~ # emerge --info
Portage 2.1-r1 (default-linux/x86/2006.0, gcc-3.4.6, glibc-2.3.6-r4, 2.6.17-gentoo-r2 i686)
=================================================================
System uname: 2.6.17-gentoo-r2 i686 Intel(R) Pentium(R) 4 CPU 3.00GHz
Gentoo Base System version 1.6.15
app-admin/eselect-compiler: [Not Present]
dev-lang/python:     2.3.5-r2, 2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=pentium4 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-O2 -march=pentium4 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://gentoo.osuosl.org/ http://gentoo.seren.com/gentoo ftp://gentoo.mirrors.tds.net/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/home/portage_temp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/root/EBUILDS"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X alsa apache2 audiofile avi berkdb bitmap-fonts caps cdr cli crypt cups dlloader dri dvd dvdr dvdread eds emboss encode firebird flac fluidsynth foomaticdb fortran gdbm gif gimp gimpprint gnome gpm gstreamer gtk gtk2 i8x0 imlib ipv6 isdnlog jack jack-tmpfs jpeg kde ladcca ladspa libg++ libwww mad mikmod mjpeg mmx motif mp3 mpeg mysql mythtv ncurses nls nptl nptlonly ogg opengl oss pam pcre pdflib perl png ppds pppd python qt qt3 qt4 quicktime readline reflection sdl session sndfile spell spl sse sse2 ssl tcltk tcpd threads transcodei truetype truetype-fonts type1-fonts udev usb userlocales v4l v4l2 vorbis xml xmms xorg xscreensaver xv xvid zlib elibc_glibc input_devices_keyboard input_devices_mouse kernel_linux userland_GNU video_cards_i810 video_cards_mesa"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS
dragonfly ~ #





Comment 10


Mark Knecht





          2006-07-22 19:12:57 UTC
        

I'm sure it's obvious but emerging with -quicktime is an intermediate work around until someone finds the real root cause and pushes it out to the servers.

Cheers




Comment 11


Rick Harris





          2006-10-14 18:29:03 UTC
        

Two entirely different bugs in this report.

To the first bug:
These files look to be old and stale files/symlinks hanging around from an earlier version of Xorg. This is a problem with portage and some apps. where the *.la lib-archive files are left untracked.
Perhaps because they are sometimes created by a process external to portage (ldconfig ?)

Suggest cleaning your system using the following:

emerge --sync
emerge gentoolkit
emerge portage-utils

Using a combination of:
find /lib /usr/lib -type f -name "*.la*" -print0 | xargs -0 qfile -o | xargs ls -lh

AND

find /lib /usr/lib -type f -name "*.so*" -print0 | xargs -0 qfile -o | xargs ls -lh

Delete old and stale libs carefully.
Any libs installed external to portage (eg. one's you have compiled manually yourself), will also show in this list.
Look at the file's creation date and double check a file's need with:
equery b <lib_name>

When finished, run an `env-update` and `revdep-rebuild -X`.


To the second bug:
Cannot reproduce the bug.
Are you still getting the problem ?
Does re-emerging media-libs/libquicktime fix the problem ?
What version of media-libs/libquicktime are you using ?

Please post the full configure output. Particularly intereseted in the lines:

checking whether libquicktime support is requested... yes
checking for pkgconfig support for libquicktime... yes
checking for lqt-config... /usr/bin/lqt-config
checking how to determine LIBQUICKTIME_CFLAGS... pkg-config
checking quicktime.h usability... yes
checking quicktime.h presence... yes
checking for quicktime.h... yes
checking how to determine LIBQUICKTIME_LIBS... pkg-config
checking for quicktime_open in -lquicktime... yes
checking for lqt_encode_video in -lquicktime... yes

Does the file /usr/include/lqt/quicktime.h exist ?
If so, what does `lqt-config --clfags ` and `pkg-config libquicktime --cflags` say?





Comment 12


Mark Knecht





          2006-10-14 21:00:07 UTC
        

I'm sorry. This bug was posted 5 months ago and has been fixed by subsequent updates. Nothing to look at at this time.

Thanks




Comment 13


Jakub Moc (RETIRED)






          2006-10-15 00:58:33 UTC
        

Well, this in not a transcode bug, you simply need to delete orphaned stale .la files and fix your symlinks, transcode compiles perfectly fine with modular X.

Closing.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

