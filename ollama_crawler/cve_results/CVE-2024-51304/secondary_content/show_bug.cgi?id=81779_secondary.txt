Title: 81779 – xorg-x11-6.8.2 fails on Function check_migrate_return
URL: https://bugs.gentoo.org/show_bug.cgi?id=81779

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 81779
xorg-x11-6.8.2 fails on Function check_migrate_return
Last modified: 2005-02-13 22:41:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 81779 
      - xorg-x11-6.8.2 fails on Function check_migrate_return


Summary:
xorg-x11-6.8.2 fails on Function check_migrate_return
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-02-12 13:00 UTC by Benjamin Judas (RETIRED)





      Modified:
    
2005-02-13 22:41 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



fadlouni









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Output of "find /usr/lib/X11/xkb"

              (find_usrlibX11xkb,12.19 KB,
                text/plain)

            
2005-02-13 13:47 UTC,

            Benjamin Judas (RETIRED)




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Benjamin Judas (RETIRED)






          2005-02-12 13:00:42 UTC
        

>>> Completed installing xorg-x11-6.8.2 into /var/tmp/portage/xorg-x11-6.8.2/image/

>>> Merging x11-base/xorg-x11-6.8.2 to /
 * Migrating from /usr/X11R6/bin to /usr/bin...
 * Migration method is rsync.
 *     /usr/X11R6/bin is a symlink, not migrating
 * Migrating from /usr/X11R6/include to /usr/include...
 * Migration method is rsync.
 *     /usr/X11R6/include is a symlink, not migrating
 * Migrating from /usr/X11R6/lib to /usr/lib...
 * Migration method is rsync.
 *   /usr/X11R6/lib isn't a symlink, migrating...

!!! ERROR: x11-base/xorg-x11-6.8.2 failed.
!!! Function check_migrate_return, Line 1512, Exitcode 1
!!! rsync failed. Exit code: 23.
!!! If you need support, post the topmost build error, NOT this status message.

!!! FAILED preinst: 1
root@antares /home/benni %                                                                                          (1)


Reproducible: Always
Steps to Reproduce:
1. emerge -u xorg-x11
2.
3.

Actual Results:  
It compiled fine, but it refuses to complete the installation


[22:00:09 root@antares.hausnetz:/home/benni] emerge --info                     
                                   (ok)
Portage 2.0.51.16 (default-linux/x86/2004.3, gcc-3.3.4,
glibc-2.3.4.20041102-r0,glibc-2.3.4.20040808-r0, 2.6.10-gentoo-r4 i686)
=================================================================
System uname: 2.6.10-gentoo-r4 i686 AMD Athlon(TM)
Gentoo Base System version 1.6.9
Python:              dev-lang/python-2.2.3-r5,dev-lang/python-2.3.4-r1 [2.3.4
(#1, Feb  7 2005, 18:10:11)]
distcc 2.16 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
ccache version 2.3 [enabled]
dev-lang/python:     2.2.3-r5, 2.3.4-r1
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.8.5-r1, 1.8.5-r3, 1.9.4
sys-devel/binutils:  2.14.90.0.8-r1, 2.15.92.0.2-r2
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-march=athlon-tbird -O2 -pipe -mmmx -m3dnow"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /etc/conf.d/ /etc/modules.autoload.d/ /etc/modules.d/
/usr/kde/2/share/config /usr/kde/3.1/share/config /usr/kde/3.2/share/config
/usr/kde/3.3/env /usr/kde/3.3/share/config /usr/kde/3.3/shutdown
/usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref
/usr/share/config /var/qmail/alias /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=athlon-tbird -O2 -pipe -mmmx -m3dnow"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig candy ccache distcc distlocks keepwork noauto
sandbox sfperms userpriv usersandbox"
GENTOO_MIRRORS="ftp://ftp6.uni-muenster.de/pub/linux/distributions/gentoo/
ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo
ftp://sunsite.dk/mirrors/gentoo ftp://ftp.tu-clausthal.de/pub/linux/gentoo
http://www.ibiblio.org/pub/Linux/distributions/gentoo"
LANG="de_DE.UTF-8"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portdir-overlay"
SYNC="rsync://vega/portage"
USE="x86 X Xaw3d aalib adns alsa apache apache2 apm arts avi berkdb bitmap-fonts
bonobo cdr crypt cscope cups dga directfb dvd emacs encode esd f77 fam flac
flash font-server foomaticdb fortran gb gd gdbm gif glx gnome gpm gstreamer gtk
gtk2 gtkhtml guile imagemagick imap imlib informix innodb ipv6 jack jikes jpeg
kde kerberos ldap libg++ libwww lirc mad maildir mbox mikmod mmmx motif mozilla
mpeg mysql ncurses nls nocardbus nofbc nptl oggvorbis opengl oss pam pdflib perl
png postgres python qt quicktime readline samba sasl scanner sdl slang snmp
speex spell ssl svga tcltk tcpd tiff truetype truetype-fonts type1-fonts unicode
usb wmf xml xml2 xmms xprint xv zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LC_ALL, LDFLAGS




Comment 1


Donnie Berkholz (RETIRED)






          2005-02-12 13:37:10 UTC
        

Attach ${T}/migrate-* please




Comment 2


Benjamin Judas (RETIRED)






          2005-02-12 17:41:45 UTC
        

Sorry, I can't anthing on my system that would fit this 'regex'. Neither in ${T} nor anywhere (not even on my windows-partitions)




Comment 3


Donnie Berkholz (RETIRED)






          2005-02-12 22:09:58 UTC
        

There should be a bunch of files in /var/tmp/portage/xorg-x11-6.8.2/temp/ with migrate in the name.




Comment 4


Benjamin Judas (RETIRED)






          2005-02-13 01:15:05 UTC
        

Yeah....next time I should remember that zsh needs a bit more excessive quoting than bash sometimes ;)

[10:12:51 root@antares.hausnetz:~] find /var/tmp/portage/xorg-x11-6.8.2/temp/ -name "*migrate*"                    (ok)
/var/tmp/portage/xorg-x11-6.8.2/temp/migrate--usr-X11R6-lib.log
[10:13:08 root@antares.hausnetz:~] cat /var/tmp/portage/xorg-x11-6.8.2/temp/migrate--usr-X11R6-lib.log             (ok)
building file list ... 
8 files to consider
delete_file: rmdir "/usr/lib/X11/xkb" failed: Directory not empty
symlink "/usr/lib/X11/xkb" -> "/usr/lib/X11/xkb/" failed: File exists

Number of files: 8
Number of files transferred: 0
Total file size: 67 bytes
Total transferred file size: 0 bytes
Literal data: 0 bytes
Matched data: 0 bytes
File list size: 242
Total bytes written: 254
Total bytes read: 20

wrote 254 bytes  read 20 bytes  548.00 bytes/sec
total size is 67  speedup is 0.24
rsync error: some files could not be transferred (code 23) at main.c(632)
[10:13:10 root@antares.hausnetz:~]                                                                                 (ok)





Comment 5


Donnie Berkholz (RETIRED)






          2005-02-13 13:29:20 UTC
        

`find /usr/lib/X11/xkb`




Comment 6


Benjamin Judas (RETIRED)






          2005-02-13 13:47:04 UTC
        

Created attachment 51155 [details]
Output of "find /usr/lib/X11/xkb"

Output of find /usr/lib/X11/xkb




Comment 7


Donnie Berkholz (RETIRED)






          2005-02-13 14:25:31 UTC
        

If that's a text file, could you fix the mime type?




Comment 8


Juergen Kaetzler





          2005-02-13 14:42:41 UTC
        

I did an update of xorg on my 2 PCs:

The first one had x11-libs/xorg-6.8.1.902 installed, updating to xorg-6.8.2 did not give any errors.

The second machine had  x11-libs/xorg-6.8.1.904 installed, updating to xorg-6.8.2 gave the error described above (some kind of migrating error).

I tried a dirty and quick workaround that I found at the Gentoo Forums:
http://forums.gentoo.org/viewtopic-t-292162-highlight-xorg+symlink+migrating.html

I moved the /usr/X11R6 into /tmp and then xorg-6.8.2 merged without any problems. This workaround was for amd64, it worked for me on x86.




Comment 9


Benjamin Judas (RETIRED)






          2005-02-13 14:44:55 UTC
        

mime-type fixed.




Comment 10


Donnie Berkholz (RETIRED)






          2005-02-13 18:10:36 UTC
        

beejay, do you have both /usr/lib/X11/xkb and /usr/X11R6/lib/X11/xkb? ls -ld and readlink -f on both of them please

This usually fails because there's a symlink in one place and a directory in another -- that's about the only case.




Comment 11


Benjamin Judas (RETIRED)






          2005-02-13 20:34:30 UTC
        

[5:31:27 root@antares.hausnetz:/home/benni] ls -ld /usr/lib/X11/xkb                                                (ok)
drwxr-xr-x  10 root root 4096 14. Okt 07:50 /usr/lib/X11/xkb
[5:31:46 root@antares.hausnetz:/home/benni] readlink -f /usr/lib/X11/xkb/                                          (ok)
/usr/lib/X11/xkb
[5:31:54 root@antares.hausnetz:/home/benni] ls -ld /usr/X11R6/lib/X11/xkb                                          (ok)
lrwxrwxrwx  1 root root 17  6. Jan 02:11 /usr/X11R6/lib/X11/xkb -> /usr/lib/X11/xkb/
[5:32:03 root@antares.hausnetz:/home/benni] readlink -f /usr/X11R6/lib/X11/xkb                                     (ok)
/usr/lib/X11/xkb
[5:32:19 root@antares.hausnetz:/home/benni]                                                                        (ok)


/usr/X11R6/lib/X11/xkb is a symlink pointing to /usr/lib/X11/xkb/




Comment 12


Donnie Berkholz (RETIRED)






          2005-02-13 20:54:25 UTC
        

I can't figure out where that symlink could have possibly been created by xorg-x11. Perhaps you did it manually at some point trying to fix some other problem?

If you delete the symlink then remerge, it ought to work fine. If it doesn't, reopen. If you have an idea what created that symlink, reopen.

Thanks




Comment 13


Benjamin Judas (RETIRED)






          2005-02-13 22:41:38 UTC
        

No, you're completely right. That fixed it, xorg-x11-6.8.2 just installed fine. Thanks for your assistance. I don't know where that symlink came from...honestly...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

