Title: 82642 – ssh keys are not used properly on new installs for x86 or amd64
URL: https://bugs.gentoo.org/show_bug.cgi?id=82642

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 82642
ssh keys are not used properly on new installs for x86 or amd64
Last modified: 2008-02-13 00:43:45 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 82642 
      - ssh keys are not used properly on new installs for x86 or amd64


Summary:
ssh keys are not used properly on new installs for x86 or amd64
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo's Team for Core System packages








URL:



http://forums.gentoo.org/viewtopic.ph...
        




Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-02-19 21:18 UTC by Chad Granum





      Modified:
    
2008-02-13 00:43 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



aliz
spamwhole









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge info output

              (emerge-info,6.63 KB,
                text/plain)

            
2006-02-24 07:14 UTC,

            Rob K




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Chad Granum





          2005-02-19 21:18:45 UTC
        

the given site lists 2 problems that I beleave are seperate bugs, one amd64 specific, so here is the cross platform one:

ssh keys tested for a year or 2 now
I have setup ssh key systems before

ssh ekys work to connect to remote systems and from remote to other remote, but not when connected to eather of my new installs.

specifics:
from both new and old installs I can use keys to connect to old installs
from eather new or old installs I cannot connect to new installs with keys
problem is occuring on recently reformatted amd64 in 64 bit mode AND pentium4 (32-bit of course)
key setup is checked many times over exact copies from systems that work
config files have been edited, reset, reset then edited, and copied from known good configurations
ssh and ssl versions match across both systems that work and ones that don't, not sure if made from same ebuild version however, afraid to try and update ssh on systems known to be working.

I have reformatted the amd64 system twice the past week, both reformats used different make.conf but experianced same issue

Reproducible: Always
Steps to Reproduce:
1.install from clean slate on pentium4 or amd64
2.setup ssh keys on the 2 systems in a known good configuration
3.try to login to the recently setup system using the keys, it will still promp for password

Actual Results:  
it prompted me for the password seeming to ignore keys completely

Expected Results:  
should have connected using keys in the known good configuration (checked and
rechecked) so that I would nto need to manually enter my password

the AMD64 system:
Portage 2.0.51-r15 (default-linux/amd64/2004.3, gcc-3.4.2,
glibc-2.3.4.20041102-r0, 2.6.10-gentoo-r7-Exodist-Athlon64 x86_64)
=================================================================
System uname: 2.6.10-gentoo-r7-Exodist-Athlon64 x86_64 AMD Athlon(tm) 64
Processor 3500+
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb 20 2005, 08:23:15)]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r1
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.6.8.1-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-O3 -march=athlon64 -fomit-frame-pointer -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config
/var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=athlon64 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox"
GENTOO_MIRRORS="http://distfiles.gentoo.org
http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X aac aalib acpi aim alsa audiofile avi bash-completion berkdb
bitmap-fonts bzlib cdr crypt cups curl divx4linux dvd dvdr encode esd f77 fam
flac flash font-server fortran ftp gif gpm gtk gtk2 imagemagick imap imlib ipv6
java jp2 jpeg live lzw lzw-tiff matroska mozilla multilib ncurses nls nvidia
oggvorbis openal opengl oscar oss pam pcre perl png python qt quicktime readline
samba sdl ssl tcpd theora tiff truetype truetype-fonts type1-fonts usb
userlocales v4l v4l2 xanim xinerama xml2 xmms xpm xrandr xv xvid xvmc zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, PORTDIR_OVERLAY

pentium4 system:
Portage 2.0.51-r15 (default-linux/x86/2004.3, gcc-3.3.5,
glibc-2.3.4.20040808-r1, 2.6.10-gentoo-r6-Exodist-Pentium4 i686)
=================================================================
System uname: 2.6.10-gentoo-r6-Exodist-Pentium4 i686 Intel(R) Pentium(R) 4 CPU
2.20GHz
Gentoo Base System version 1.4.16
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb 14 2005, 09:25:14)]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r1
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.4.21-r1
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CFLAGS="-O3 -march=pentium4 -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config
/var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=pentium4 -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms"
GENTOO_MIRRORS="http://distfiles.gentoo.org
http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 X aac aalib acpi aim alsa apm arts audiofile avi bash-completion berkdb
bitmap-fonts bzlib cdr crypt cups curl divx4linux dvd dvdr encode esd f77 fam
flac flash font-server foomaticdb fortran ftp gdbm gif gnome gpm gtk gtk2
imagemagick imap imlib ipv6 java jpeg kde libg++ libwww live mad matroska mikmod
motif mozilla mpeg ncurses nls nvidia oggvorbis openal opengl oscar oss pam pcre
pdflib perl png python qt quicktime readline real samba sdl spell ssl svga tcpd
theora tiff truetype truetype-fonts type1-fonts usb v4l v4l2 xanim xinerama xml2
xmms xv xvid xvmc zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, PORTDIR_OVERLAY




Comment 1


Chad Granum





          2005-02-20 16:05:10 UTC
        

I abandoned my old keys, and decided to go with rsa only, I generated a new key and now the athlon64 system and my other systems I have propegated the key too all work fine, however my pentium4 system (still gentoo) now segfaults with the new key, though the athlon64 and pentium3 (both gentoo) use it fine, so does a remote bsd box I uploaded my public key to.




Comment 2


Jakub Moc (RETIRED)






          2005-11-11 09:43:10 UTC
        

Re-assign.




Comment 3


SpanKY






          2005-11-12 20:16:14 UTC
        

what version of openssh ?

does 4.2_p1




Comment 4


Rob K





          2006-02-24 07:14:25 UTC
        

Created attachment 80604 [details]
emerge info output

I have exactly the same problem.  

When ssh'ing from local to remote machine I'm prompted for the ssh (dsa) key password, as expected.  When ssh'ing from remote to local I merely get prompted for the user password, not as expected (even when I ssh to localhost I have the same problem).

My ssh configuration (with the exception of the keys) is identical on both machines, (/etc/ssh/* & ~/.ssh/authorized_keys2).

I can attach strace's or sshd & ssh in debug (-vvv) mode if these would be of any help.

My system is fully upto date as of a couple of hours ago.  I'm using the ~amd64 branch.




Comment 5


Jakub Moc (RETIRED)






          2008-02-13 00:43:45 UTC
        

Dead bug and can't reproduce at all.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

