Title: 520530 – dev-db/hsqldb-1.8.1.3-r1 fails with "java-config --classpath=servlet-api-2.5 failed".
URL: https://bugs.gentoo.org/show_bug.cgi?id=520530

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 520530
dev-db/hsqldb-1.8.1.3-r1 fails with "java-config --classpath=servlet-api-2.5 failed".
Last modified: 2015-06-15 00:12:35 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 520530 
      - dev-db/hsqldb-1.8.1.3-r1 fails with "java-config --classpath=servlet-api-2.5 failed".


Summary:
dev-db/hsqldb-1.8.1.3-r1 fails with "java-config --classpath=servlet-api-2.5 ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Java

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Java team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-08-22 12:00 UTC by Henrik Grubbström





      Modified:
    
2015-06-15 00:12 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Henrik Grubbström





          2014-08-22 12:00:49 UTC
        

Emerging of dev-db/hsqldb-1.8.1.3-r1 fails with:
[...]
>>> Failed to emerge dev-db/hsqldb-1.8.1.3-r1, Log file:

>>>  '/var/tmp/portage/dev-db/hsqldb-1.8.1.3-r1/temp/build.log'

 * Messages for package dev-db/hsqldb-1.8.1.3-r1:

 * ERROR: dev-db/hsqldb-1.8.1.3-r1::gentoo failed (prepare phase):
 *   java-config --classpath=servlet-api-2.5 failed
 * 
 * Call stack:
 *     ebuild.sh, line   93:  Called src_prepare
 *   environment, line 4330:  Called java-pkg-2_src_prepare
 *   environment, line 2142:  Called java-utils-2_src_prepare
 *   environment, line 3523:  Called java_prepare
 *   environment, line 3538:  Called eant '-q' '-f' 'build/build.xml' 'cleanall'
 *   environment, line  585:  Called java-pkg_getjars 'servlet-api-2.5'
 *   environment, line 2867:  Called die
 * The specific snippet of code:
 *       [[ $? != 0 ]] && die "java-config --classpath=${pkgs} failed";


Reproducible: Always

Steps to Reproduce:
# emerge -duD world
[...]
+ for atom in '${gcp}'
++ java-pkg_getjars servlet-api-2.5
++ debug-print-function java-pkg_getjars servlet-api-2.5
++ debug-print 'java-pkg_getjars: entering function, parameters: servlet-api-2.5'
++ [[ prepare = depend ]]
++ [[ ! -d /var/tmp/portage/dev-db/hsqldb-1.8.1.3-r1/temp ]]
++ [[ 1 -eq 0 ]]
++ [[ '' == on ]]
++ [[ -n '' ]]
++ [[ -w /var/tmp/portage/dev-db/hsqldb-1.8.1.3-r1/temp ]]
++ printf '%s\n' 'java-pkg_getjars: entering function, parameters: servlet-api-2.5'
++ chgrp portage /var/tmp/portage/dev-db/hsqldb-1.8.1.3-r1/temp/eclass-debug.log
++ chmod g+w /var/tmp/portage/dev-db/hsqldb-1.8.1.3-r1/temp/eclass-debug.log
++ local build_only=
++ local deep=
++ [[ prepare == \t\e\s\t ]]
++ [[ servlet-api-2.5 == --* ]]
++ [[ 1 -ne 1 ]]
++ local pkgs=servlet-api-2.5
++ [[ 5 == \1 ]]
+++ java-config --classpath=servlet-api-2.5
!!! ERROR: Package servlet-api-2.5 was not found!
[...]

>>> Failed to emerge dev-db/hsqldb-1.8.1.3-r1, Log file:

>>>  '/var/tmp/portage/dev-db/hsqldb-1.8.1.3-r1/temp/build.log'

 * Messages for package dev-db/hsqldb-1.8.1.3-r1:

 * ERROR: dev-db/hsqldb-1.8.1.3-r1::gentoo failed (prepare phase):
 *   java-config --classpath=servlet-api-2.5 failed
 * 
 * Call stack:
 *     ebuild.sh, line   93:  Called src_prepare
 *   environment, line 4330:  Called java-pkg-2_src_prepare
 *   environment, line 2142:  Called java-utils-2_src_prepare
 *   environment, line 3523:  Called java_prepare
 *   environment, line 3538:  Called eant '-q' '-f' 'build/build.xml' 'cleanall'
 *   environment, line  585:  Called java-pkg_getjars 'servlet-api-2.5'
 *   environment, line 2867:  Called die
 * The specific snippet of code:
 *       [[ $? != 0 ]] && die "java-config --classpath=${pkgs} failed";



Expected Results:  
I expect hsqldb to build and install.

I have rebuilt multiple packages that seem to be related to servlet-api-2.5, but that has not had any effect.

java-config --classpath=servlet-api-2.5 seems to work fine when run from the same shell:

# java-config --classpath=servlet-api-2.5 
/usr/share/tomcat-servlet-api-2.5/lib/jsp-api.jar:/usr/share/tomcat-servlet-api-2.5/lib/servlet-api.jar
# echo $?
0
# ls -l /usr/share/tomcat-servlet-api-2.5/lib/jsp-api.jar /usr/share/tomcat-servlet-api-2.5/lib/servlet-api.jar
-rw-r--r-- 1 root root 63131 Aug 22 11:57 /usr/share/tomcat-servlet-api-2.5/lib/jsp-api.jar
-rw-r--r-- 1 root root 77683 Aug 22 11:57 /usr/share/tomcat-servlet-api-2.5/lib/servlet-api.jar

# emerge --info '=dev-db/hsqldb-1.8.1.3-r1::gentoo'
Portage 2.2.8-r1 (default/linux/amd64/13.0/desktop/kde, gcc-4.7.3, glibc-2.19-r1, 3.10.7-gentoo-r1 x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-3.10.7-gentoo-r1-x86_64-Intel-R-_Core-TM-2_CPU_6400_@_2.13GHz-with-gentoo-2.2
KiB Mem:     6043308 total,   1603392 free
KiB Swap:   12582908 total,  12352096 free
Timestamp of tree: Fri, 22 Aug 2014 07:45:01 +0000
ld GNU ld (GNU Binutils) 2.23.2
app-shells/bash:          4.2_p45
dev-java/java-config:     2.2.0
dev-lang/python:          2.7.7, 3.2.5-r3, 3.3.5-r1
dev-util/cmake:           2.8.12.2
dev-util/pkgconfig:       0.28-r1
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.12.4
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.11.6, 1.12.6, 1.13.4
sys-devel/binutils:       2.23.2
sys-devel/gcc:            4.5.4, 4.6.3, 4.7.3-r1
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        1.3.5, 2.4.2-r1
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.13 (virtual/os-headers)
sys-libs/glibc:           2.19-r1
Repositories: gentoo pike
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="* -@EULA google-chrome"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /var/bind"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="ftp://ftp.ds.karen.hj.se/gentoo/ http://ftp.ds.karen.hj.se/gentoo/ http://ftp.df.lth.se/pub/gentoo/ rsync://ftp.df.lth.se/pub/gentoo/ ftp://ftp.df.lth.se/pub/gentoo/ ftp://mirror.mdfnet.se/gentoo http://mirror.mdfnet.se/gentoo"
LANG="C"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/pike"
SYNC="rsync://rsync.de.gentoo.org/gentoo-portage"
USE="X Xaw3d a52 aac acl acpi alsa amd64 bash-completion berkdb bluetooth branding bzip2 cairo canna cdda cdparanoia cdr cjk clamav cli consolekit cpudetection cracklib crypt ctype cups curl curlwrappers cxx dbus declarative directfb dri dts dvd dvdr emacs emboss encode exif fam ffmpeg fftw firefox flac fontconfig fortran freetds freewnn ftp gcrypt gdbm gif git glut gmp gnutls gpm gtk icc iconv idn ieee1394 imagemagick imap imlib iodbc ipv6 jadetex java javascript jpeg jpeg2k kde kipi lame lcms ldap libnotify mad maildir mbox mhash mime mjpeg mmx mng modules mp3 mp4 mpeg mplayer mule multilib mysql mysqli ncurses nis nls no-gnome nptl nsplugin odbc ogg opengl openmp pam pango pcre pdf phonon pike plasma png policykit posix postgres ppds qt3support qt4 quicktime rdesktop readline recode resolvconf samba sasl sdl semantic-desktop session smartcard snmp soap sockets spell sqlite sse sse2 ssl startup-notification subversion svg syslog tcpd thora threads tiff tk truetype udev udisks unicode upower usb video vorbis webdav wxwidgets x264 x86_64 xcb xcomposite xinerama xml xmlrpc xscreensaver xsl xulrunner xv xvid zlib" ABI_X86="64" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-5" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_3" RUBY_TARGETS="ruby19 ruby20" USERLAND="GNU" VIDEO_CARDS="ati r300 mach64 r128 vesa vmware fbdev" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, MAKEOPTS, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON

# emerge -pqv '=dev-db/hsqldb-1.8.1.3-r1::gentoo'
[ebuild  N    ] dev-db/hsqldb-1.8.1.3-r1  USE="-doc -source {-test}"

# equery list servletapi
 * Searching for servletapi ...
[IP-] [  ] dev-java/servletapi-2.2-r3:2.2
[IP-] [  ] dev-java/servletapi-2.3-r3:2.3
[IP-] [  ] dev-java/servletapi-2.4-r5:2.4
# equery list servlet-api
 * Searching for servlet-api ...
[IP-] [  ] java-virtuals/servlet-api-2.3:2.3
[IP-] [  ] java-virtuals/servlet-api-2.5-r1:2.5
[IP-] [  ] java-virtuals/servlet-api-3.0-r1:3.0
# equery list tomcat-servlet-api
 * Searching for tomcat-servlet-api ...
[IP-] [  ] dev-java/tomcat-servlet-api-4.1.36:2.3
[IP-] [  ] dev-java/tomcat-servlet-api-5.5.27-r1:2.4
[IP-] [  ] dev-java/tomcat-servlet-api-6.0.37:2.5
[IP-] [  ] dev-java/tomcat-servlet-api-7.0.42:3.0
# java-config -Jcjtfv
/opt/icedtea-bin-6.1.13.3/bin/java
/opt/icedtea-bin-6.1.13.3/bin/javac
/opt/icedtea-bin-6.1.13.3/bin/jar
/opt/icedtea-bin-6.1.13.3/lib/tools.jar
icedtea-bin-6
java version "1.6.0_31"
OpenJDK Runtime Environment (IcedTea6 1.13.3) (Gentoo build 1.6.0_31-b31)
OpenJDK 64-Bit Server VM (build 23.25-b01, mixed mode)




Comment 1


Patrice Clement (RETIRED)






          2015-06-15 00:12:35 UTC
        

>>> Completed installing hsqldb-1.8.1.3-r1 into /var/tmp/portage/dev-db/hsqldb-1.8.1.3-r1/image/

I cannot reproduce this error. 

monsieurp@epsilon ~/gentoo-x86/dev-db/hsqldb $ grep -A 2 -B 2 'servlet-api' hsqldb-1.8.1.3-r1.ebuild

CDEPEND="
        java-virtuals/servlet-api:2.5"
RDEPEND="${CDEPEND}
        >=virtual/jre-1.5"
--
EANT_BUILD_TARGET="jar jarclient jarsqltool jarutil"
EANT_DOC_TARGET="javadocdev"
EANT_GENTOO_CLASSPATH="servlet-api-2.5"

src_test() {

This is unlikely to happen since servlet-api-2.5 is correctly set in both EANT_GENTOO_CLASSPATH and CDEPEND. I see no mistakes.

Please sync your sources and try again.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

