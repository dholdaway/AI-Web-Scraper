Title: 336752 – net-print/cups-1.4.4-r2: USE +gnutls -dbus results in "Secure Connection Failed"
URL: https://bugs.gentoo.org/show_bug.cgi?id=336752

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 336752
net-print/cups-1.4.4-r2: USE +gnutls -dbus results in "Secure Connection Failed"
Last modified: 2012-03-26 16:16:11 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 336752 
      - net-print/cups-1.4.4-r2: USE +gnutls -dbus results in "Secure Connection Failed"


Summary:
net-print/cups-1.4.4-r2: USE +gnutls -dbus results in "Secure Connection Failed"
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Printing Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-09-10 18:17 UTC by Toralf Förster





      Modified:
    
2012-03-26 16:16 UTC
      (History)
    




          CC List:
        

5 
          users
          
            (show)
          



da5id2001
fauli
flyser42
kripton
nbowler









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Toralf Förster






          2010-09-10 18:17:46 UTC
        

Compiling cups with that USE flag gives :

Secure Connection Failed

An error occurred during a connection to n22:631.

SSL received a record that exceeded the maximum permissible length.

(Error code: ssl_error_rx_record_too_long)

    *   The page you are trying to view can not be shown because the 
authenticity of the received data could not be verified.

    *   Please contact the web site owners to inform them of this problem. 
Alternatively, use the command found in the help menu to report this broken 
site.

Reproducible: Always




Comment 1


Fabian Henze





          2010-10-06 14:10:15 UTC
        

confirmed.
Debian seems to have fixed this bug:
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=590610




Comment 2


Toralf Förster






          2010-10-06 14:31:14 UTC
        

Withi cupsd log I found only
"E [06/Oct/2010:16:30:28 +0200] Bad request line "" from 192.168.0.254!"




Comment 3


Timo Gurr (RETIRED)






          2010-10-06 14:35:12 UTC
        

Does (re-)building CUPS with USE="-threads" fix it?




Comment 4


Fabian Henze





          2010-10-06 14:55:44 UTC
        

Not for me. I am back to USE="-gnutls ssl threads" and everything works fine.




Comment 5


Toralf Förster






          2010-10-06 15:04:31 UTC
        

(In reply to comment #4)
> Not for me. I am back to USE="-gnutls ssl threads" and everything works fine.
> 
And can you print from firefox ? (B/c AFAIK that was the reason to activate +gnutls)





Comment 6


Toralf Förster






          2010-10-06 15:06:44 UTC
        

(In reply to comment #3)
> Does (re-)building CUPS with USE="-threads" fix it?
> 
Yes! I restarted apache2 and cups after re-emerging cups with these flags :

n22 ~ # grep cups /etc/portage/package.use/misc 
net-print/cups                  gnutls -threads

and now it workes. FWIW I had to accept a new SSL certificate of cups - that was all.





Comment 7


Brandon Penglase





          2011-01-15 01:59:29 UTC
        

I was following this bug as I had the issue before, however with 1.4.6 and these use flags (USE="X acl dbus gnutls java jpeg pam perl png python samba ssl threads tiff usb -debug -kerberos -ldap -php -slp -static-libs -xinetd") It seems to be working fine. Someone else confirm and maybe it's another bug closed? :D




Comment 8


Toralf Förster






          2011-01-15 09:21:24 UTC
        

Well, in the mean while - with version 1.4.6  I do not have any special use flags anymore for cups set in package.use/* and it works (X acl dbus java jpeg ldap pam perl png python samba ssl threads tiff usb).




Comment 9


Christian Faulhammer (RETIRED)






          2011-01-27 14:39:53 UTC
        

Closing this bug as fixed as 1.4.6 will be a possible stable target.  Yell, if you disagree.




Comment 10


Nick Bowler





          2011-01-27 15:21:48 UTC
        

Doesn't look fixed to me:

  [ebuild   R   ] net-print/cups-1.4.6  USE="X acl gnutls jpeg pam perl png python ssl threads tiff usb -dbus -debug -java -kerberos -ldap -php -samba -slp -static-libs -xinetd" LINGUAS="ja -da -de -es -eu -fi -fr -id -it -ko -nl -no -pl -pt -pt_BR -ru -sv -zh -zh_TW" 0 kB
  
  Secure Connection Failed
  
  An error occurred during a connection to emergent:631.
  
  SSL received a record that exceeded the maximum permissible length.
  
  (Error code: ssl_error_rx_record_too_long)
  
      * The page you are trying to view can not be shown because the authenticity of the received data could not be verified.
  
      * Please contact the web site owners to inform them of this problem. Alternatively, use the command found in the help menu to report this broken site.




Comment 11


Christian Faulhammer (RETIRED)






          2011-01-27 16:21:27 UTC
        

(In reply to comment #10)
> Doesn't look fixed to me:

 As Thoralf reported it ok, I closed it...Gnargl.  Reopen.




Comment 12


Timo Gurr (RETIRED)






          2011-01-27 16:41:23 UTC
        

I can't reproduce this issue with CUPS 1.4.6 USE="gnutls ssl threads" and accessing the cups webinterface via Firefox using https://localhost:631/. It only takes quite some time to generate the ssl certificates (old bug #202224).




Comment 13


Andreas K. Hüttel







          2011-06-06 22:06:38 UTC
        

(In reply to comment #10)
> Doesn't look fixed to me:
> 
>   [ebuild   R   ] net-print/cups-1.4.6  USE="X acl gnutls jpeg pam perl png
> python ssl threads tiff usb -dbus -debug -java -kerberos -ldap -php -samba -slp
> -static-libs -xinetd" LINGUAS="ja -da -de -es -eu -fi -fr -id -it -ko -nl -no
> -pl -pt -pt_BR -ru -sv -zh -zh_TW" 0 kB

Nick, are you sure you re-started the daemon after upgrading? Sorry, I know, but I have to ask...

Which cups version are you running now, and do you still have the problem?




Comment 14


Andreas K. Hüttel







          2011-06-11 19:26:12 UTC
        

I cannot reproduce this problem with net-print/cups-1.4.6-r2 either. I'll keep the bug open but remove it from the list of stabilization blockers.




Comment 15


Nick Bowler





          2011-06-11 22:48:41 UTC
        

(In reply to comment #13)
> Nick, are you sure you re-started the daemon after upgrading? Sorry, I know,
> but I have to ask...

Yes, quite certain.

> Which cups version are you running now, and do you still have the problem?

Yup, the problem still occurs with:

  [ebuild   R    ] net-print/cups-1.4.6-r21  USE="X acl gnutls jpeg pam perl png python samba ssl threads tiff usb -dbus -debug -java -kerberos -ldap -php -slp -static-libs -xinetd" LINGUAS="ja -da -de -es -eu -fi -fr -id -it -ko -nl -no -pl -pt -pt_BR -ru -sv -zh -zh_TW" 0 kB

and setting USE="-gnutls" corrects the issue.




Comment 16


Andreas K. Hüttel







          2011-06-11 23:19:17 UTC
        

(In reply to comment #15)
> Yup, the problem still occurs with:
> 
>   [ebuild   R    ] net-print/cups-1.4.6-r21  USE="X acl gnutls jpeg pam perl
> png python samba ssl threads tiff usb -dbus -debug -java -kerberos -ldap -php
> -slp -static-libs -xinetd" LINGUAS="ja -da -de -es -eu -fi -fr -id -it -ko -nl
> -no -pl -pt -pt_BR -ru -sv -zh -zh_TW" 0 kB
> 
> and setting USE="-gnutls" corrects the issue.

From testing here, it seems like gnutls only works properly if *dbus* is enabled as well.

Will investigate more tomorrow.




Comment 17


Brandon Penglase





          2011-07-09 15:34:40 UTC
        

I actually just reloaded my desktop (been many, many years and some package conflicts and such were creeping up, so decided to clean house).

Anywho, fresh install of cups-1.4.6-r21 with USE: USE="X acl dbus gnutls java jpeg ldap pam perl png python ssl threads tiff usb -debug -kerberos -php -samba -slp -static-libs -xinetd"  (no linguas defined). 

I have cupsd and dbus starting at default. First time I hit on https, it took a bit, and I got a few errors in error_log, but it generated a local cert, and presented me the webpage over SSL.
So this seems to be working for me. Maybe it has something to do with dbus as Andreas suggested.




Comment 18


Andreas K. Hüttel







          2012-02-19 22:04:49 UTC
        

OK... resolving this as worksforme for the moment









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

