Title: 133669 – gnome-terminal-2.14* "looses" displayed text on reset and clear
URL: https://bugs.gentoo.org/show_bug.cgi?id=133669

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 133669
gnome-terminal-2.14* "looses" displayed text on reset and clear
Last modified: 2006-07-17 18:50:41 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 133669 
      - gnome-terminal-2.14* "looses" displayed text on reset and clear


Summary:
gnome-terminal-2.14* "looses" displayed text on reset and clear
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] GNOME

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




119872



 

        Show dependency tree





 





      Reported:
    
2006-05-18 02:46 UTC by Martin Wegner





      Modified:
    
2006-07-17 18:50 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



ruud









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Martin Wegner





          2006-05-18 02:46:04 UTC
        

I'm using gnome-terminal-2.14.1 but also encountered this with 2.14.0:

1) When I select Terminal > Reset and clear from the menu all displayed text within the screen running inside disappears. When hitting ^L prompt is there again, but then cursor positions in zshcomplists go crazy.
2) This happens occasionally (on various escape sequences, I guess) too, for example with emerge output, but this is not reproducible.

The apps are a gnome-terminal with a screen with a zsh in it. The config files of screen and zsh can be found here: http://files.mgeek.de/dotfiles.tar.bz2.

But the first is also reproducible with a bash with default configuration in it.

Screenshots demonstrating it:

(1) Terminal with shell it, not yet the error
(2) After Reset and clear
(3) After ^L
(4) Error with cursor on completion (only zsh, bash ok)

screen and zsh:
(1) http://files.mgeek.de/Screenshot-screen-zsh-0.png
(2) http://files.mgeek.de/Screenshot-screen-zsh-1.png
(3) http://files.mgeek.de/Screenshot-screen-zsh-2.png
(4) http://files.mgeek.de/Screenshot-screen-zsh-3.png

bash:
(1) http://files.mgeek.de/Screenshot-bash-0.png
(2) http://files.mgeek.de/Screenshot-bash-1.png
(3) http://files.mgeek.de/Screenshot-bash-2.png
(4) http://files.mgeek.de/Screenshot-bash-3.png

I do not know how I can track down this error better, so please guide me if it's needed.

Gentoo Base System version 1.12.0_pre19
Portage 2.1_rc1-r2 (default-linux/x86/2005.1, gcc-3.4.6, glibc-2.4-r3, 2.6.14-mw-laptop i686)
=================================================================
System uname: 2.6.14-mw-laptop i686 Intel(R) Pentium(R) M processor 1.73GHz
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
dev-lang/python:     2.3.5-r2, 2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r2
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r5
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=pentium-m -O3 -pipe -mmmx -msse -msse2 -mfpmath=sse -ftracer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.4/env /usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/kde/3/share/config /usr/share/X11/xkb /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/eselect/compiler /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/env.d"
CXXFLAGS="-march=pentium-m -O3 -pipe -mmmx -msse -msse2 -mfpmath=sse -ftracer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig candy distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="C"
MAKEOPTS="-j1"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.de.gentoo.org/gentoo-portage"
USE="x86 X Xaw3d aac acl acpi alsa apache2 avi bash-completion berkdb bitmap-fonts browserplugin bzip2 bzlib cdparanoia cdr cli crypt cups dba dedicated dga divx4linux doc dri dvd dvdr dvi eds emboss encode escreen exif fbcon ffmpeg firefox flac foomaticdb ftp gd gdbm gif gimpprint gnome gstreamer gtk gtk2 i8x0 imap imlib insecure-savers ipv6 isdnlog jabber java jpeg jpeg2k libcaca libg++ libwww mad mbox mmx mmxext motif mozdevelop mozsvg mp3 mpeg mysql ncurses nls no-htdocs nptl nptlonly nsplugin offensive ogg oggvorbis opengl oscar oss pam pcre pdflib pear perl png postfix pppd python quicktime readline real reflection rtc samba sdl session silverxp spell spl sse sse2 ssl stencil-buffer svg tcltk tcpd theora tiff truetype truetype-fonts type1-fonts usb userlocales vim-with-x visualization vorbis win32codecs wmf xanim xchattext xml xml2 xmms xorg xprint xsl xv xvid zlib elibc_glibc input_devices_keyboard input_devices_mouse input_devices_synaptics kernel_linux userland_GNU video_cards_fglrx video_cards_radeon"
Unset:  ASFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Patrick McLean






          2006-05-18 08:18:03 UTC
        

I don't see anything abnormal in any of the bash screens, what exactly is the problem here? Reset and clear does what it is supposed to to, it resets the terminal to the defaults and clears the screen, this includes clearing the prompt text. Hitting ctrl-c or enter should cause the shell to draw a new prompt.

Also, I don't really know zsh, what is the expected behaviour and how does what happens differ?




Comment 2


Martin Wegner





          2006-05-18 08:47:22 UTC
        

Ok, if that is the normal behaviour of reset and clear, ok. But this also happens ramdomly when any output of any other program in the gnome-terminal is done. For example, during an emerge process, text disappears in the same way. I get then the same as it can be seen on screenshot (3) for zsh, so you know there is an emerge process making much output, but no text is displayed. This happens also with ls, grep, ...

The sad thing is that I cannot reproduce it. But it happens several times a day and therefore is very annoying ...




Comment 3


Ruud Althuizen





          2006-05-20 04:33:34 UTC
        

You could run something in script(1) and maybe find out what the cause of the problem is.




Comment 4


Martin Wegner





          2006-05-22 14:33:21 UTC
        

When I'm right, script just logs the commands, but I do not think, that it is caused by a specific command ...

I just had this error again when I quit a "less <file>" (http://files.mgeek.de/Screenshot-error.png), the screenshot shows the terminal immediately after I hit Q.

I tried to reproduce it with the same less call, but could't.

I wonder if this maybe is related to zsh since I use Unicode but the latest version in portage may be not capable of unicode?




Comment 5


Ruud Althuizen





          2006-05-22 23:06:27 UTC
        

script logs everything that is put to the screen, so it might let us see what is going on.

zsh-4.3.2 support UTF-8, so you could use that one. But that probably isn't causing the problem since I've been using zsh+UTF-8 prior to that version.




Comment 6


Martin Wegner





          2006-05-24 02:47:06 UTC
        

Hm, that's weird, zsh and unicode is _not_ working here for me.

If I type several unicode chars:

http://files.mgeek.de/Screenshot-unicode-0.png

and the delete them,

http://files.mgeek.de/Screenshot-unicode-1.png

zle deletes charaktes equal to the number of bytes of the unicode chars:

http://files.mgeek.de/Screenshot-unicode-2.png

If I type many unicode chars,

http://files.mgeek.de/Screenshot-unicode2-0.png

multiline does not work and weird "question mark" charakters appear when first right prompt

http://files.mgeek.de/Screenshot-unicode2-1.png

and then the left prompt disappear, multiline displaying of the typed chars does not happen, they are displayed in the same line:

http://files.mgeek.de/Screenshot-unicode2-2.png

I think this issue is related to this behaviour, since for example multiline commands with unicode chars in them, are totally wrong displayed due to this ...




Comment 7


Martin Wegner





          2006-05-24 02:54:27 UTC
        

Ah, sorry, I just remember that the disappearing of text in gnome-terminal also happened before I switched my system to unicode a few weeks ago. So I will log my sessions with script(1), the zsh/unicode problem seems to be not related although it would be nice if someone (for example Ruud) could take a look at this ...




Comment 8


Martin Wegner





          2006-05-24 02:59:20 UTC
        

When I run script, I get an error:

$ script log-20060524
Script started, file is log-20060524
zsh: No such file or directory

and then script hangs.

Also

script -c /bin/zsh log-20060524

leads to the same error ...




Comment 9


Martin Wegner





          2006-05-24 03:20:25 UTC
        

Sometimes the problem is located between computer and chair ;)

The problem with Unicode is solved now, I still had LC_CTYPE="de_DE@euro" set, but it should be de_DE.utf8 . Now it works.

But since I think the issue of this bug report is not related to the (now solved) unicode problem with my zsh, any hint how to get script(1) running is still welcome ...




Comment 10


Saleem Abdulrasool (RETIRED)






          2006-05-29 12:18:04 UTC
        

marking invalid as the issue was caused by setting an invalid locale.




Comment 11


Martin Wegner





          2006-05-29 12:45:48 UTC
        

I disagree with marking invalid. As I stated above in comment #9 the problem with encoding is solved, yes, but it solved not the bug I originally described here. It was a side effect that I thought could be the reason for it.

I'm still awaiting any response to my problem with script(1) described in comment #8, since I'm not able to provide the information requested in comment #3 and comment #5.




Comment 12


Martin Wegner





          2006-07-13 05:16:29 UTC
        

I have not seen this bug for a longer time now. So I think it is somehow fixed for me. I'm not sure what resultion to set, so I leave it up to you.




Comment 13


John N. Laliberte (RETIRED)






          2006-07-17 18:50:41 UTC
        

marking worksforme since reporter says he can no longer reproduce it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

