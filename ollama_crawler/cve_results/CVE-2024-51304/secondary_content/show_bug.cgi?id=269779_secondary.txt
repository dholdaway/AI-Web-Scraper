Title: 269779 – Gramps 3.1.1 fails to emerge
URL: https://bugs.gentoo.org/show_bug.cgi?id=269779

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 269779
Gramps 3.1.1 fails to emerge
Last modified: 2009-05-15 11:09:22 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 269779 
      - Gramps 3.1.1 fails to emerge


Summary:
Gramps 3.1.1 fails to emerge
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:



N/A




Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-05-14 05:54 UTC by Robert Bradbury





      Modified:
    
2009-05-15 11:09 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



SebastianLuther









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




config.log from gramps emerge attempt

              (config.log,22.45 KB,
                text/plain)

            
2009-05-14 05:56 UTC,

            Robert Bradbury




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Robert Bradbury





          2009-05-14 05:54:41 UTC
        

Gramps-3.1.1 fails to emerege.  There are at least 2 problems:
1. It fails to find pygtk
2. It may fail to recognize python-2.6 in some cases.

The error for #1 (from the emerge output) is:
... preceeding configure output ...
checking for python version... 2.6
checking for python platform... linux2
checking for python script directory... ${prefix}/lib/python2.6/site-packages
checking for python extension module directory... ${exec_prefix}/lib/python2.6/site-packages
checking for sh... /bin/sh
checking Python bindings for gtk 2.10 (pygtk2>=2.10.0)... configure: error:

**** The python bindings for gtk 2.10 (pygtk2>=2.10.0) could not be found.

Error #2 may not be a "hard" error, since the unmodified configure seems to find python2.6, but the code is wrong in that line 6456 om the configure file says:
  for am_cv_pathless_PYTHON in python python2 python2.5 python2.4...
is missing python2.6.  However adding this and rerunning configure does not fix the gtk problem.


Reproducible: Always

Steps to Reproduce:
1. emerge gramps


Actual Results:  
It cannot emerge due to a failure to find pygtk (or misidentifies the version).

Expected Results:  
The configure should work and it should emerge properly.

After identification of the gtk problem, I re-emerged pygtk-2.14.1.

It properly put the updated gtk libraries in /usr/lib/python2.6/site-packages/gtk-2.0.  However, it did not create /usr/lib/python2.6/site-packages/pygtk.pth and pygtk.py and the files they point to.  Instead it recreated the symbolic links in /usr/lib/python2.5/site-packages!  So there is a problem with emerging pygtk not getting its installation process straight -- it puts the binaries in the right place but it updates their locations in the previous version files.  (Very strange).

Even after I put the correct files into /usr/lib/python2.6/site-packages emerging gramps still could not find pygtk2>=2.10.0 -- so there is still something wrong with the configure file in its attempt to locate where pygtk is or how to varify its version.




Comment 1


Robert Bradbury





          2009-05-14 05:56:41 UTC
        

Created attachment 191226 [details]
config.log from gramps emerge attempt

Shows the problem finding the python bindings for gtk 2.10 (pygtk>=2.10.0).




Comment 2


Robert Bradbury





          2009-05-14 06:02:39 UTC
        

And yes, before you ask, python-updater has been run.  Whether it worked completely or not I do not know.  It takes 3+ hours to run and produces a 6.6 megabyte (~67,000 line) output file (which I'm not about to review).




Comment 3


Sebastian Luther (few)





          2009-05-14 08:00:22 UTC
        

Please provide the environment file (see the end of emerge's output).




Comment 4


Robert Bradbury





          2009-05-15 11:04:47 UTC
        

Ok, gramps will finally emerge.  The trick was to get pygtk properly installed with python2.6.  As noted in other bugs, my attempt to install pygtk led to a situation where the python2.6/gtk-2.0 files were properly updated but the top level gtk files that point to the gtk-2.0 directory were placed in /usr/lib/python2.5.  This was fixed by copying the files and symlinks into the /usr/lib/python2.6 directory.

As a side note, python-updater gives seems to give no indications with respect to all of the "old" python "site-packages" which need to be re-installed following a python upgrade (I still haven't found all I suspect are required on my system -- the number is probably 20+ packages).  The portage/python packages should keep track of all packages installed into python#.#/site-packages and inform the user of the need for re-emerges when python is upgraded.  It would be nice if this were "optional" (kind of like etc-update) since the user may not want to "move forward" all old packages due to the disk space consumption.  There should also be a way to delete old python version packages as one becomes more confident in the stability of the new python version.




Comment 5


Robert Bradbury





          2009-05-15 11:09:22 UTC
        

Changed status to FIXED.  Perhaps there should be some "OTHER PACKAGE" option indicative of the problem being resolved in another package (in this case pygtk) to indicate that gramps is not at fault.

I would still note that the configure file needs to be patched to include python2.6 in the list of python versions it scans in an attempt to find python on systems where it cannot be identified by more "standard" means.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

