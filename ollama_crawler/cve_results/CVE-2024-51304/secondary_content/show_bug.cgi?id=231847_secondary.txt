Title: 231847 – media-video/ffmpeg-0.4.9_p20080326 give Segmentation fault
URL: https://bugs.gentoo.org/show_bug.cgi?id=231847

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 231847
media-video/ffmpeg-0.4.9_p20080326 give Segmentation fault
Last modified: 2008-08-18 06:19:58 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 231847 
      - media-video/ffmpeg-0.4.9_p20080326 give Segmentation fault


Summary:
media-video/ffmpeg-0.4.9_p20080326 give Segmentation fault
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Media-video project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-07-15 08:48 UTC by xraver





      Modified:
    
2008-08-18 06:19 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


xraver





          2008-07-15 08:48:30 UTC
        

ffmpeg give me on the most Codecs a Segmentation fault. Only mpeg will work correct. mpg4 or ogg give me Segmentation faul ;(.

Sample:
ffmpeg -vcodec huffyuv -f x11grab -s 800x600 -r 25 -i :0.0 aout.avi
FFmpeg version UNKNOWN, Copyright (c) 2000-2008 Fabrice Bellard, et al.
  configuration: --prefix=/usr --libdir=/usr/lib64 --shlibdir=/usr/lib64 --mandir=/usr/share/man --enable-static --enable-shared --cc=x86_64-pc-linux-gnu-gcc --disable-altivec --disable-debug --disable-optimizations --enable-libfaac --enable-libmp3lame --enable-libvorbis --enable-libtheora --enable-libx264--enable-libxvid --enable-liba52 --enable-pthreads --enable-x11grab --enable-libfaad --enable-gpl --enable-postproc --enable-avfilter --enable-avfilter-lavf --enable-swscale --disable-stripping
  libavutil version: 49.6.0
  libavcodec version: 51.53.0
  libavformat version: 52.12.0
  libavdevice version: 52.0.0
  libavfilter version: 0.0.0
  built on Jul 15 2008 10:04:53, gcc: 4.3.1
[x11grab @ 0x7ff69f0b6f40]device: :0.0 -> display: :0.0 x: 0 y: 0 width: 800 height: 600
[x11grab @ 0x7ff69f0b6f40]shared memory extension  found
Input #0, x11grab, from ':0.0':
  Duration: N/A, start: 1216111341.347826, bitrate: 384000 kb/s
    Stream #0.0: Video: huffyuv, rgb32, 800x600, 384000 kb/s, 25.00 tb(r)
File 'aout.avi' already exists. Overwrite ? [y/N] y
Output #0, avi, to 'aout.avi':
    Stream #0.0: Video: mpeg4, yuv420p, 800x600, q=2-31, 200 kb/s, 25.00 tb(c)
Stream mapping:
  Stream #0.0 -> #0.0
Press [q] to stop encoding
Segmentation fault

The Kernelog says:
ffmpeg[9972]: segfault at 0 ip 7ff69e939769 sp 7fffa74e0820 error 6 in libavcodec.so.51.53.0[7ff69e7b1000+373000]


Here is the backtrace log from gdb:
#0  0x00007f151f2f9769 in ?? () from /usr/lib/libavcodec.so.51
#1  0x00007f151f1c4bab in avcodec_decode_video () from /usr/lib/libavcodec.so.51
#2  0x00000000004083aa in _start ()                                             
The program being debugged has been started already.                            
Start it from the beginning? (y or n) Starting program: /usr/bin/ffmpeg -vcodec huffyuv -f x11grab -s 800x600 -r 25 -i :0.0 aout.avi
(no debugging symbols found)                                                                                                        
(no debugging symbols found)                                                                                                        
(no debugging symbols found)                                                                                                        
(no debugging symbols found)                                                                                                        
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[Thread debugging using libthread_db enabled]
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
[New Thread 0x7f3825f966f0 (LWP 9904)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7f3825f966f0 (LWP 9904)]
0x00007f3825419769 in ?? () from /usr/lib/libavcodec.so.51
#0  0x00007f3825419769 in ?? () from /usr/lib/libavcodec.so.51
#1  0x00007f38252e4bab in avcodec_decode_video () from /usr/lib/libavcodec.so.51
#2  0x00000000004083aa in _start ()



Reproducible: Always

Steps to Reproduce:
1. compile from ffmpeg cvs 
2. compile the gentoo system+world with safe cflags




Comment 1


Carsten Lohrke (RETIRED)






          2008-07-15 15:47:34 UTC
        

The information you provide unfortunately isn't sufficient. Please provide `emerge --info` output and a useful backtrace. See here¹ how to achieve this.


[1] http://www.gentoo.org/proj/en/qa/backtraces.xml




Comment 2


xraver





          2008-07-15 15:52:16 UTC
        

I follow the Steps from [1] - thats all what gdb give.

My emerge --info

Portage 2.2_rc1 (default-linux/amd64/2007.0, gcc-4.3.1, glibc-2.8_p20080602-r0, 2.6.25-gentoo-r6 x86_64)
=================================================================                                       
System uname: Linux-2.6.25-gentoo-r6-x86_64-Intel-R-_Core-TM-2_CPU_6600_@_2.40GHz-with-glibc2.2.5       
Timestamp of tree: Tue, 15 Jul 2008 09:34:01 +0000                                                      
app-shells/bash:     3.2_p39                                                                            
dev-java/java-config: 1.3.7, 2.1.6-r1                                                                   
dev-lang/python:     2.4.4-r13, 2.5.2-r5                                                                
dev-python/pycrypto: 2.0.1-r6                                                                           
sys-apps/baselayout: 2.0.0                                                                              
sys-apps/openrc:     0.2.5                                                                              
sys-apps/sandbox:    1.2.18.1-r3                                                                        
sys-devel/autoconf:  2.13, 2.62-r1                                                                      
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.1-r1                                            
sys-devel/binutils:  2.18.50.0.7                                                                        
sys-devel/gcc-config: 1.4.0-r4                                                                          
sys-devel/libtool:   2.2.4                                                                              
virtual/os-headers:  2.6.25-r4                                                                          
ACCEPT_KEYWORDS="amd64 ~amd64"                                                                          
CBUILD="x86_64-pc-linux-gnu"                                                                            
CFLAGS="-O2 -pipe -march=native -fomit-frame-pointer"                                                   
CHOST="x86_64-pc-linux-gnu"                                                                             
CONFIG_PROTECT="/etc /usr/kde/svn/env /usr/kde/svn/share/config /usr/kde/svn/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O2 -pipe -march=native -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer parallel-fetch preserve-libs sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://ftp.gentoo.mesh-solutions.com/gentoo/ http://gentoo.cites.uiuc.edu/pub/gentoo/ ftp://gentoo.cites.uiuc.edu/pub/gentoo/"
LANG="de_DE.UTF-8"
LC_ALL="de_DE.UTF-8"
LDFLAGS="-Wl,-O1 -Wl,--hash-style=gnu"
LINGUAS="de"
MAKEOPTS="-j3 -s"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/desktop-effects /usr/portage/local/layman/zen-overlay /usr/portage/local/layman/jokey /usr/portage/local/layman/kdesvn-portage /usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac acl acpi alsa amd64 apache2 berkdb bzip2 cairo caps captury cli cracklib crypt css ctype cups curl dbus dga dri dvb dvdr dvdread encode exif ffmpeg fortran gdbm gif glitz gnutls gtk hal history iconv ipv6 isdnlog ithreads jack java jpeg jpeg2k kde kdehiddenvisibility lzo mdnsresponder-compatmidi mmx mng mozdevelop mp2 mp3 mp4 mpeg mtp mudflap mysql ncurses network nls nptl nptlonly nsplugin ogg opengl openmp pam pcre pdf perl plasma png pppdpulseaudio python qt4 readline reflection sasl sdl session smp spl sqlite sqlite3 sse sse2 ssl ssse3 statistics suid svg symlink tcpd theora threads truetype unicode usb vim-with-x vorbis x264 xattr xcomposite xorg xv xvid zip zlib" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse joystick" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="de" USERLAND="GNU" VIDEO_CARDS="nvidia"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS


(In reply to comment #1)
> The information you provide unfortunately isn't sufficient. Please provide
> `emerge --info` output and a useful backtrace. See here¹ how to achieve this.
> 
> 
> [1] http://www.gentoo.org/proj/en/qa/backtraces.xml
> 






Comment 3


Alexis Ballier






          2008-08-17 23:24:38 UTC
        

funily enough:
ffmpeg -s 800x600 -r 25 -f x11grab -i :0.0 -vcodec huffyuv aout.avi
works while:
ffmpeg -vcodec huffyuv -f x11grab -s 800x600 -r 25 -i :0.0 aout.avi
fails.
This might or might not be a bug in ffmpeg's way of parsing options.





Comment 4


Alexis Ballier






          2008-08-17 23:28:36 UTC
        

From the help I see:
usage: ffmpeg [[infile options] -i infile]... {[outfile options] outfile}...
infile options are supposed to be:
-s 800x600 -r 25 -f x11grab
then -i :0.0
then outfile options:
-vcodec huffyuv
then the outfile: aout.avi

So this is, at least, documented :/




Comment 5


xraver





          2008-08-18 06:19:26 UTC
        

(In reply to comment #3)
> funily enough:
> ffmpeg -s 800x600 -r 25 -f x11grab -i :0.0 -vcodec huffyuv aout.avi
> works while:
> ffmpeg -vcodec huffyuv -f x11grab -s 800x600 -r 25 -i :0.0 aout.avi
> fails.
> This might or might not be a bug in ffmpeg's way of parsing options.
> 

Hallo,
i test it and it works.
Nice. Thanks for this information.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

