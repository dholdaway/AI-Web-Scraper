Title: 924988 – app-emulation/qemu-8.2.1 fails to compile: ERROR: -static-pie not available due to missing toolchain support
URL: https://bugs.gentoo.org/show_bug.cgi?id=924988

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 924988
app-emulation/qemu-8.2.1 fails to compile: ERROR: -static-pie not available due to missing toolchain support
Last modified: 2024-02-20 09:04:30 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 924988 
      - app-emulation/qemu-8.2.1 fails to compile: ERROR: -static-pie not available due to missing toolchain support


Summary:
app-emulation/qemu-8.2.1 fails to compile: ERROR: -static-pie not available d...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Virtualization Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2024-02-19 16:18 UTC by Agostino Sarubbo





      Modified:
    
2024-02-20 09:04 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



ajak
dilfridge









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,51.25 KB,
                text/plain)

            
2024-02-19 16:18 UTC,

            Agostino Sarubbo




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Agostino Sarubbo






          2024-02-19 16:18:41 UTC
        

https://blogs.gentoo.org/ago/2020/07/04/gentoo-tinderbox/

Issue: app-emulation/qemu-8.2.1 fails to compile.
Discovered on: arm (internal ref: tinderbox_arm)

Info about the issue:
https://wiki.gentoo.org/wiki/Project:Tinderbox/Common_Issues_Helper#CF0014




Comment 1


Agostino Sarubbo






          2024-02-19 16:18:42 UTC
        

Created attachment 885424 [details]
build.log

build log and emerge --info




Comment 2


John Helmert III









          2024-02-19 21:28:43 UTC
        

ERROR: -static-pie not available due to missing toolchain support

That's weird, because the ebuild only adds that flag if the toolchain suports it:

    # We always want to attempt to build with PIE support as it results
    # in a more secure binary. But it doesn't work with static or if
    # the current GCC doesn't have PIE support.
    if [[ ${static_flag} != "none" ]] && use ${static_flag}; then
        conf_opts+=( --static --disable-pie )
    else
        tc-enables-pie && conf_opts+=( --enable-pie )
    fi

While the configure script has:

  if compile_prog "-Werror -fPIE -DPIE" "$pie_ldflags"; then
    pie="yes"
  elif test "$pie" = "yes"; then
    error_exit "-static-pie not available due to missing toolchain support"
  else
    echo "Disabling PIE due to missing toolchain support"
    pie="no"
  fi

Can you share the associated config.log?




Comment 3


Agostino Sarubbo






          2024-02-20 09:04:30 UTC
        

really strange because on the same environment I can't reproduce anymore. So I suppose that it was cause by something else.
Let's mark as WORKSFORME for now









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

