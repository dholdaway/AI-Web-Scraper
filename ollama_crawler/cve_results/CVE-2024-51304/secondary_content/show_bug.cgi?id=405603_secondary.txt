Title: 405603 – dev-libs/cyrus-sasl-2.1.25-r2 fails to unpack
URL: https://bugs.gentoo.org/show_bug.cgi?id=405603

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 405603
dev-libs/cyrus-sasl-2.1.25-r2 fails to unpack
Last modified: 2013-01-12 18:48:51 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 405603 
      - dev-libs/cyrus-sasl-2.1.25-r2 fails to unpack


Summary:
dev-libs/cyrus-sasl-2.1.25-r2 fails to unpack
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Net-Mail Packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-02-24 15:38 UTC by Paul Moore





      Modified:
    
2013-01-12 18:48 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



cancellettopugno
mkyral









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




strace -f -o strace.txt tar xf /usr/portage/distfiles/cyrus-sasl-2.1.25.tar.gz

              (strace.txt,707.03 KB,
                text/plain)

            
2012-02-26 20:46 UTC,

            frank




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Paul Moore





          2012-02-24 15:38:06 UTC
        

When trying to update my system, emerge has problems unpacking cyrus-sasl, see "Actual Results" below.

I have seen similar problems with dev-libs/cyrus-sasl-2.1.25 and dev-libs/cyrus-sasl-2.1.25-r1.


Reproducible: Always

Steps to Reproduce:
1. emerge -1v dev-libs/cyrus-sasl

Actual Results:  

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild     U  ] dev-libs/cyrus-sasl-2.1.25-r2 [2.1.23-r6] USE="berkdb gdbm java pam ssl -authdaemond -kerberos -ldapdb% -mysql -openldap -postgres -sample -sqlite% -srp -static-libs% -urandom (-crypt%*) (-ntlm_unsupported_patch%)" 0 kB

Total: 1 package (1 upgrade), Size of downloads: 0 kB


>>> Verifying ebuild manifests

>>> Emerging (1 of 1) dev-libs/cyrus-sasl-2.1.25-r2
 * cyrus-sasl-2.1.25.tar.gz RMD160 SHA1 SHA256 size ;-) ...                                                                               [ ok ]
 * Using: sun-jdk-1.6
>>> Unpacking source...
>>> Unpacking cyrus-sasl-2.1.25.tar.gz to /var/tmp/portage/dev-libs/cyrus-sasl-2.1.25-r2/work

gzip: stdout: Broken pipe
 * ERROR: dev-libs/cyrus-sasl-2.1.25-r2 failed (unpack phase):
 *   failure unpacking cyrus-sasl-2.1.25.tar.gz
 * 
 * Call stack:
 *               ebuild.sh, line   85:  Called src_unpack
 *             environment, line 5015:  Called _eapi0_src_unpack
 *        phase-helpers.sh, line  530:  Called unpack 'cyrus-sasl-2.1.25.tar.gz'
 *        phase-helpers.sh, line  309:  Called _unpack_tar 'gzip -d'
 *        phase-helpers.sh, line  282:  Called assert_sigpipe_ok 'failure unpacking cyrus-sasl-2.1.25.tar.gz'
 *   isolated-functions.sh, line   37:  Called die
 * The specific snippet of code:
 *              [[ $x -ne 0 && $x -ne ${PORTAGE_SIGPIPE_STATUS:-141} ]] && die "$@"
 * 
 * If you need support, post the output of 'emerge --info =dev-libs/cyrus-sasl-2.1.25-r2',
 * the complete build log and the output of 'emerge -pqv =dev-libs/cyrus-sasl-2.1.25-r2'.
!!! When you file a bug report, please include the following information:
GENTOO_VM=sun-jdk-1.6  CLASSPATH="" JAVA_HOME="/opt/sun-jdk-1.6.0.31"
JAVACFLAGS="-source 1.4 -target 1.4" COMPILER=""
and of course, the output of emerge --info
 * The complete build log is located at '/var/tmp/portage/dev-libs/cyrus-sasl-2.1.25-r2/temp/build.log'.
 * The ebuild environment file is located at '/var/tmp/portage/dev-libs/cyrus-sasl-2.1.25-r2/temp/environment'.
 * S: '/var/tmp/portage/dev-libs/cyrus-sasl-2.1.25-r2/work/cyrus-sasl-2.1.25'

>>> Failed to emerge dev-libs/cyrus-sasl-2.1.25-r2, Log file:

>>>  '/var/tmp/portage/dev-libs/cyrus-sasl-2.1.25-r2/temp/build.log'


Expected Results:  
Successful emerge.

# emerge --info =dev-libs/cyrus-sasl-2.1.25-r2
Portage 2.1.10.49 (default/linux/amd64/10.0/desktop/kde, gcc-4.5.3, glibc-2.14.1-r2, 3.2.5-gentoo x86_64)
=================================================================
                        System Settings
=================================================================
System uname: Linux-3.2.5-gentoo-x86_64-Intel-R-_Core-TM-_i7_CPU_Q_840_@_1.87GHz-with-gentoo-2.1
Timestamp of tree: Fri, 24 Feb 2012 00:45:01 +0000
app-shells/bash:          4.2_p20
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.2-r3, 3.1.4-r3, 3.2.2
dev-util/cmake:           2.8.7-r3
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1
sys-apps/openrc:          0.9.8.4
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.9.6-r3, 1.10.3, 1.11.3
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.5.3-r2
sys-devel/gcc-config:     1.5-r2
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r3
sys-kernel/linux-headers: 3.2 (virtual/os-headers)
sys-libs/glibc:           2.14.1-r2
Repositories: gentoo local
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA @FREE @EULA @BINARY-REDISTRIBUTABLE"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/openvpn/easy-rsa /usr/share/themes/oxygen-gtk/gtk-2.0 /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=native -O2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--autounmask=n --quiet-build=n"
FEATURES="assume-digests binpkg-logs distlocks ebuild-locks fixlafiles news parallel-fetch protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch xattr"
FFLAGS=""
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en en_US"
MAKEOPTS="-j8"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_EXTRA_OPTS="--timeout=10"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://server.lan/gentoo-portage"
USE="X X509 a52 aac acl acpi aiglx aim alsa amarok amazon amd64 amr amrnb amrwb animgif async avantgo berkdb bittorrent bl bluetooth branding buttons bzip2 cairo calendar cdb cdda cddb cdr cdrom cli colordiff connectionstatus consolekit cpudetection cracklib crypt cscope css cups cxx dbus declarative dga dhcpcd divx dnd doc dri dts dv dvb dvd dvdnav dvdr embedded emboss encode eolconv examples exif fam fat fbcon fbsplash ffmpeg firefox flac fontconfig fortran ftp g3dvl gd gdbm gdu geos gif gimp glep glut gmedia gphoto2 gpm gtk hdri highlight htmlhandbook http iconv icu id3 id3tag ieee1394 imagemagick imap ipv6 irc jabber java javascript jpeg jpeg2k kde kipi lame laptop lastfm lcms ldap libass libnotify libproxy libv4l2 libwww live logitech-mouse lzo lzw mad matrox mime mjpeg mmap mmx mmxext mng modules moznocompose moznoirc moznomail moznoroaming mp3 mp4 mpeg mpeg2 mplayer msn mtp mudflap multilib musicbrainz na_dd na_icons ncurses netmeeting networkmanager nfs nls nokia nptl nptlonly nsplugin nspluginwrapper nss ofx ogdi ogg openexr opengl openmp pam pango pcre pda pdf perl phonon plasma pmu png pnm policykit posix ppds pppd pulseaudio python qemu qt3support qt4 rdesktop rdesktop-vrdp readline realmedia rss rtc rtsp ruby samba scanner sdl sdl-image secure-delete semantic-desktop session sftp sharedmem shout slp smbclient smp sms snmp sockets sound spell spice sse sse2 sse3 ssl ssse3 startup-notification subversion svg sysfs syslog taglib tagwriting tcpd templates threads thumbnail tiff tivo translator truetype udev unicode usb utils uudeview v4l v4l2 vaapi vboxwebsrv vcd vim-with-x virtualbox visualization vnc vorbis webdav webkit wifi wma wmf wmp x264 xanim xattr xcb xcomposite xext xft xim xine xinerama xml xml2 xorg xpm xscreensaver xulrunner xv xvid xvmc yahoo yv12 zeroconf zip zlib zvbi" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan stage tables krita karbon braindump" CAMERAS="ptp2 canon" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="evdev keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en en_US" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby18" SANE_BACKENDS="hp" USERLAND="GNU" VIDEO_CARDS="nvidia vesa" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LANG, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS




Comment 1


Jeroen Roovers (RETIRED)






          2012-02-24 16:29:17 UTC
        

Looks like something is wrong with either of these:

1) gzip
2) The source tarball, but that would imply the checksum had magically changed
   too.
3) The filesystem you are unpacking the tarball on.




Comment 2


Paul Moore





          2012-02-24 16:52:02 UTC
        

(In reply to comment #1)
> Looks like something is wrong with either of these:

Do you have any specific tests I could try to narrow down the issue?  I haven't noticed anything else unusual on the system and the simple tests I've tried (below) all seem to indicate everything is okay ...

[SIDE NOTE: I've also removed the source tarball and re-downloaded it multiple times to no avail]

> 1) gzip

olly ~ # date > /var/tmp/portage/foo
olly ~ # cat /var/tmp/portage/foo
Fri Feb 24 11:37:08 EST 2012
olly ~ # md5sum /var/tmp/portage/foo > /var/tmp/portage/foo.md5sum
olly ~ # cat /var/tmp/portage/foo.md5sum 
0dabbfa780d21d4c56487f7ee1916387  /var/tmp/portage/foo
olly ~ # gzip /var/tmp/portage/foo
olly ~ # ls -l /var/tmp/portage/foo*
-rw-r--r-- 1 root root 53 Feb 24 11:37 /var/tmp/portage/foo.gz
olly ~ # gunzip /var/tmp/portage/foo.gz
olly ~ # md5sum -c /var/tmp/portage/foo.md5sum 
/var/tmp/portage/foo: OK
olly ~ # cat /var/tmp/portage/foo
Fri Feb 24 11:37:08 EST 2012

> 2) The source tarball, but that would imply the checksum had magically changed
>    too.

olly ~ # ls -l /usr/portage/distfiles/cyrus-sasl-2.1.25.tar.gz             
-rw-rw-r-- 1 portage portage 5209240 Nov 30 11:50 /usr/portage/distfiles/cyrus-sasl-2.1.25.tar.gz
olly ~ # grep "cyrus-sasl-2.1.25.tar.gz" /usr/portage/dev-libs/cyrus-sasl/Manifest | awk '{ print $7 " " $2 }'
b6c34426012d9b5d448d5646cbecd818a5eeacbf cyrus-sasl-2.1.25.tar.gz
olly ~ # sha1sum /usr/portage/distfiles/cyrus-sasl-2.1.25.tar.gz
b6c34426012d9b5d448d5646cbecd818a5eeacbf  /usr/portage/distfiles/cyrus-sasl-2.1.25.tar.gz
olly ~ # gunzip -c /usr/portage/distfiles/cyrus-sasl-2.1.25.tar.gz | tar -tf - | wc -l
712

gzip: stdout: Broken pipe

> 3) The filesystem you are unpacking the tarball on.

My /var/tmp/portage is current part of my root filesystem, and as I've said earlier, I haven't noticed any other problems - and that includes several other 'emerge -uDv world' operations over the past several weeks.  While it is possible that there is a problem with the filesystem, it seems unlikely that it would only be affecting this package.




Comment 3


frank





          2012-02-26 20:46:22 UTC
        

Created attachment 303417 [details]
strace -f -o strace.txt tar xf /usr/portage/distfiles/cyrus-sasl-2.1.25.tar.gz

+1 on x86 install
it happens only with cyrus-sasl-2.1.25.tar.gz
if i first gunzip and then untar no errors are reported
if i repack the the package no errors are reported however the checksum changes
strangely on another gentoo amd64 box with same tar and gzip versions i can't reproduce it...




Comment 4


Marian Kyral





          2012-03-03 10:39:29 UTC
        

Hi,
I've  the same issue on two my systems, both are amd64.

# emerge --info
Portage 2.2.0_alpha89 (default/linux/amd64/10.0/desktop/kde, gcc-4.5.3, glibc-2.14.1-r2, 3.2.6-gentoo x86_64)
=================================================================
System uname: Linux-3.2.6-gentoo-x86_64-Intel-R-_Core-TM-2_Duo_CPU_P8400_@_2.26GHz-with-gentoo-2.1
Timestamp of tree: Sat, 03 Mar 2012 08:15:01 +0000
app-shells/bash:          4.2_p20
dev-java/java-config:     2.1.11-r3
dev-lang/python:          2.7.2-r3, 3.2.2
dev-util/cmake:           2.8.7-r3
dev-util/pkgconfig:       0.26
sys-apps/baselayout:      2.1
sys-apps/openrc:          0.9.9.2
sys-apps/sandbox:         2.5
sys-devel/autoconf:       2.13, 2.68
sys-devel/automake:       1.9.6-r3, 1.11.3
sys-devel/binutils:       2.22-r1
sys-devel/gcc:            4.5.3-r2
sys-devel/gcc-config:     1.5.1
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r3
sys-kernel/linux-headers: 3.2-r1 (virtual/os-headers)
sys-libs/glibc:           2.14.1-r2
Repositories: gentoo kde mozilla sunrise overlay
Installed sets: 
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/maven-bin-3.0/conf /usr/share/openvpn/easy-rsa /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.4/ext-active/ /etc/php/cgi-php5.4/ext-active/ /etc/php/cli-php5.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-march=native -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--keep-going"
FEATURES="assume-digests binpkg-logs distlocks ebuild-locks fixlafiles news parallel-fetch preserve-libs protect-owned sandbox sfperms splitdebug strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv"
FFLAGS=""
GENTOO_MIRRORS="http://ftp.fi.muni.cz/pub/linux/gentoo/ rsync://ftp.fi.muni.cz/pub/linux/gentoo/ ftp://ftp.fi.muni.cz/pub/linux/gentoo/ http://gentoo.mirror.dkm.cz/pub/gentoo/ ftp://gentoo.mirror.dkm.cz/pub/gentoo/ rsync://gentoo.mirror.dkm.cz/gentoo/ http://gentoo.mirror.web4u.cz/ ftp://gentoo.mirror.web4u.cz/"
LANG="cs_CZ.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="cs"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_EXTRA_OPTS="--quiet"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/kde /var/lib/layman/mozilla /var/lib/layman/sunrise /usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="7zip X a52 aac acl acpi alsa amd64 berkdb bluetooth branding bzip2 cairo cdda cdr cli consolekit cracklib crypt cups cxx dbus declarative dri dts dvd dvdr emboss encode exif faad fam ffmpeg firefox flac fortran gdbm gdu gif git gpm gstreamer iconv imagemagick ipv6 jpeg jpeg2k kde kde4 kipi lame lcms ldap libnotify logrotate lzma lzo mad matroska mmx mmxext mng modules mozilla mp3 mp4 mpeg mplayer msql mudflap multilib ncurses nls nptl nptlonly ogg opengl openmp pam pango pcre pdf phonon plasma png policykit ppds pppd python qt3support qt4 quicktime raw readline samba sdl semantic-desktop session smp spell sqlite sqlite3 sse sse2 ssl ssse3 startup-notification subversion svg sysfs tcpd theora threads thumbnail thunderbird tiff truetype udev unicode unzip usb vim-syntax vorbis webkit wmf wmp x264 xcb xcomposite xine xinerama xml xorg xscreensaver xulrunner xv xvid zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan stage tables krita karbon braindump" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" FOO2ZJS_DEVICES="oki3200" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse synaptics evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="cs" PHP_TARGETS="php5-3" RUBY_TARGETS="ruby19" USERLAND="GNU" VIDEO_CARDS="nvidia vesa" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS




Comment 5


Eray Aslan






          2012-03-04 10:55:10 UTC
        

Looks like an upstream issue.
http://www.gzip.org/#faq7
https://bugs.gentoo.org/show_bug.cgi?id=309001

What does the following command output on a failing system?
$ gzip -d -c -- cyrus-sasl-2.1.25.tar.gz | tar xof -
$ echo ${PIPESTATUS[@]}




Comment 6


Marian Kyral





          2012-03-04 12:14:02 UTC
        

(In reply to comment #5)
> Looks like an upstream issue.
> http://www.gzip.org/#faq7
> https://bugs.gentoo.org/show_bug.cgi?id=309001
> 
> What does the following command output on a failing system?
> $ gzip -d -c -- cyrus-sasl-2.1.25.tar.gz | tar xof -
> $ echo ${PIPESTATUS[@]}

# gzip -d -c -- /usr/portage/distfiles/cyrus-sasl-2.1.25.tar.gz | tar xof -

gzip: stdout: Broken pipe
# echo ${PIPESTATUS[@]}
1 0

But later I found out that it works correctly with my normal user. Then I went to a lunch and after lunch, I was not able to reproduce it. Cyrus-sasl is currently recompiling. 

There was nothing changed during the lunch. No compilation was running.




Comment 7


Paul Moore





          2012-03-04 13:47:06 UTC
        

(In reply to comment #5)
> Looks like an upstream issue.
> http://www.gzip.org/#faq7
> https://bugs.gentoo.org/show_bug.cgi?id=309001
> 
> What does the following command output on a failing system?
> $ gzip -d -c -- cyrus-sasl-2.1.25.tar.gz | tar xof -
> $ echo ${PIPESTATUS[@]}

The output as requested:

# gzip -d -c -- cyrus-sasl-2.1.25.tar.gz | tar xof -
# echo ${PIPESTATUS[@]}
141 0

Also, like the other commenter posted, the package is now building (it made it past the unpacking stage).  Based on the gzip FAQ, it appears that this is something that will happen on occasion; is there anything we can do to prevent it?




Comment 8


Eray Aslan






          2012-03-04 13:59:19 UTC
        

> is there anything we can do to prevent it?

Portage does have a check for broken pipe.  It does check PIPESTATUS output after unpacking and ignores 141 - 141 being the return code for SIGPIPE (128+13).  So, as long as PIPESTATUS is 0 or 141, we are fine.

I am - somewhat reluctantly - closing this as WORKSFORME.  Please do reopen if there are any suggestions.




Comment 9


Francisco J. Vazquez





          2013-01-05 10:23:58 UTC
        

I was bitten by this bug today (changed an USE flag). Annoying. Had to uncompress, re-compress and ebuild manifest tu build successfully. The original tar.gz is 5MB, my recompressed tar.gz is less than 2MB, so THERE IS something wrong with the official package.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

