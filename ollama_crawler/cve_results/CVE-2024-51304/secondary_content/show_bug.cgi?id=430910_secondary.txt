Title: 430910 – sys-kernel/dracut-022 "could not boot"
URL: https://bugs.gentoo.org/show_bug.cgi?id=430910

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 430910
sys-kernel/dracut-022 "could not boot"
Last modified: 2012-08-31 13:50:53 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 430910 
      - sys-kernel/dracut-022 "could not boot"


Summary:
sys-kernel/dracut-022 "could not boot"
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Amadeusz Żołnowski (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2012-08-11 11:20 UTC by Andre Reinke





      Modified:
    
2012-08-31 13:50 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



andre.reinke
ibuyandtrade0+bugs.gentoo.org









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info sys-kernel/dracut

              (dracut.info,5.44 KB,
                text/plain)

            
2012-08-11 11:20 UTC,

            Andre Reinke




Details





init.log of dracut

              (init.log,83.86 KB,
                text/plain)

            
2012-08-11 11:21 UTC,

            Andre Reinke




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andre Reinke





          2012-08-11 11:20:12 UTC
        

I have installed sys-kernel/dracut-022 and generated an initramfs. Generated initramfs won't start my machine.

Steps to reproduce:

1. Install dracut, generate initramfs
2. Boot machine
3. drop to shell

More information:


antarctica / # blkid /dev/sda4
/dev/sda4: UUID="d2e58627-654c-42cb-bc20-64ef2f5263fc" TYPE="crypto_LUKS"


antarctica / # blkid /dev/mapper/root 
/dev/mapper/root: UUID="7b33c380-32e0-4ba5-b2f7-83694d54a581" TYPE="ext4"

This is booted with genkernels initramfs.




Comment 1


Andre Reinke





          2012-08-11 11:20:37 UTC
        

Created attachment 320990 [details]
emerge --info sys-kernel/dracut




Comment 2


Andre Reinke





          2012-08-11 11:21:19 UTC
        

Created attachment 320992 [details]
init.log of dracut




Comment 3


Andre Reinke





          2012-08-17 21:04:23 UTC
        

Well, at least I found two things out:

1. This issue occurs when trying with command: dracut -H -f
2. This issue does _NOT_ occur when trying with command: dracut /boot/file.img kernel -f




Comment 4


Amadeusz Żołnowski (RETIRED)






          2012-08-26 11:36:02 UTC
        

(In reply to comment #3)
> Well, at least I found two things out:
> 
> 1. This issue occurs when trying with command: dracut -H -f
> 2. This issue does _NOT_ occur when trying with command: dracut
> /boot/file.img kernel -f

Please paste content of all files in /etc/cmdline.d/ from the initramfs. To get them you can use lsinitrd tool as follows:

lsinitrd /your/dracut/initramfs.img | grep cmdline\.d

and for each file:

lsinitrd /your/dracut/initramfs.img /etc/cmdline.d/file.conf




Comment 5


Andre Reinke





          2012-08-27 17:17:12 UTC
        

(In reply to comment #4)
> (In reply to comment #3)
> > Well, at least I found two things out:
> > 
> > 1. This issue occurs when trying with command: dracut -H -f
> > 2. This issue does _NOT_ occur when trying with command: dracut
> > /boot/file.img kernel -f
> 
> Please paste content of all files in /etc/cmdline.d/ from the initramfs. To
> get them you can use lsinitrd tool as follows:
> 
> lsinitrd /your/dracut/initramfs.img | grep cmdline\.d
> 
> and for each file:
> 
> lsinitrd /your/dracut/initramfs.img /etc/cmdline.d/file.conf


antarctica boot # lsinitrd initramfs-3.5.2.img | grep cmdline\.d
drwxr-xr-x   2 root     root            0 Aug 27 19:13 etc/cmdline.d
-rw-r--r--   1 root     root            3 Aug 27 19:13 etc/cmdline.d/base.conf
-rw-r--r--   1 root     root           57 Aug 27 19:13 etc/cmdline.d/90crypt.conf


There's no cmdline.d folder over here to issue the second command successfully.




Comment 6


Andre Reinke





          2012-08-27 17:29:05 UTC
        

Stupid me :(

Here's the output:

antarctica boot # lsinitrd initramfs-3.5.2.img /etc/cmdline.d/base.conf
ro
antarctica boot # lsinitrd initramfs-3.5.2.img /etc/cmdline.d/90crypt.conf
 rd.luks.uuid=luks-6c52cfe4-a483-433a-9555-b9e315bda6ce




Comment 7


Amadeusz Żołnowski (RETIRED)






          2012-08-31 11:37:06 UTC
        

As far as I see, you have:

root=UUID=d2e58627-654c-42cb-bc20-64ef2f5263fc

which is UUID of /dev/sda4.  This is NOT your target device.  What you want is UUID of target decrypted device, which is UUID="7b33c380-32e0-4ba5-b2f7-83694d54a581", as far as I see.  When you have specified d2e58262* dracut tried to mount this device which is impossible, of course.




Comment 8


Andre Reinke





          2012-08-31 12:04:52 UTC
        

(In reply to comment #7)
> As far as I see, you have:
> 
> root=UUID=d2e58627-654c-42cb-bc20-64ef2f5263fc
> 
> which is UUID of /dev/sda4.  This is NOT your target device.  What you want
> is UUID of target decrypted device, which is
> UUID="7b33c380-32e0-4ba5-b2f7-83694d54a581", as far as I see.  When you have
> specified d2e58262* dracut tried to mount this device which is impossible,
> of course.

You're so right. I tried again using "dracut -H" and it seems to work now.

Blame on me I opened this bug report.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

