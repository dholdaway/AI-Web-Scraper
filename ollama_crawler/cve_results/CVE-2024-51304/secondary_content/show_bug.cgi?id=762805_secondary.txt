Title: 762805 – bootstrap-prefix.sh fails to emerge sys-libs/readline-8.1 on macOS 11.1 Big Sur
URL: https://bugs.gentoo.org/show_bug.cgi?id=762805

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 762805
bootstrap-prefix.sh fails to emerge sys-libs/readline-8.1 on macOS 11.1 Big Sur
Last modified: 2021-08-28 08:42:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 762805 
      - bootstrap-prefix.sh fails to emerge sys-libs/readline-8.1 on macOS 11.1 Big Sur


Summary:
bootstrap-prefix.sh fails to emerge sys-libs/readline-8.1 on macOS 11.1 Big Sur
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

Prefix Support

  (show other bugs)



Hardware:

AMD64
        OS X
      







Importance:
      
Normal
       major
      


Assignee:

Gentoo Prefix








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2020-12-31 15:50 UTC by ash





      Modified:
    
2021-08-28 08:42 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log

              (build.log,77.78 KB,
                text/plain)

            
2020-12-31 15:52 UTC,

            ash




Details





bash build.log

              (build.log,262.61 KB,
                text/plain)

            
2020-12-31 19:03 UTC,

            ash




Details





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


ash





          2020-12-31 15:50:52 UTC
        

bootstrap-prefix.sh fails at the point of emerging sys-libs/readline-8.1.  Exporting DARWIN_USE_GCC=1 did not help.  Setting MAKEOPTS=-j1 did not help.

Reproducible: Always

Steps to Reproduce:
1.  ./bootstrap-prefix.sh
Actual Results:  
 * QA Notice: command not found:
 * 
 * 	/Users/ash/Gentoo/tmp/var/tmp/portage/sys-libs/readline-8.1/temp/environment: line 2588: pkg-config: command not found
 * 	/Users/ash/Gentoo/tmp/var/tmp/portage/sys-libs/readline-8.1/temp/environment: line 2581: pkg-config: command not found
 * 	/Users/ash/Gentoo/tmp/var/tmp/portage/sys-libs/readline-8.1/temp/environment: line 2288: pkg-config: command not found
 * 	/Users/ash/Gentoo/tmp/var/tmp/portage/sys-libs/readline-8.1/temp/environment: line 2325: pkg-config: command not found
/Users/ash/Gentoo/tmp/usr/lib/portage/bin/ecompress: line 65: declare: -A: invalid option
declare: usage: declare [-afFirtx] [-p] [name[=value] ...]
/Users/ash/Gentoo/tmp/usr/lib/portage/bin/ecompress: line 35: /Users/ash/Gentoo/tmp/var/tmp/portage/sys-libs/readline-8.1/temp/.ecompress_skip_files: Interrupted system call
 * ERROR: sys-libs/readline-8.1::gentoo_prefix failed:
 *   (no error message)
 * 



System had plenty of free memory and low CPU utilization during bootstrap; this is not an overheating/overloading issue.




Comment 1


ash





          2020-12-31 15:52:14 UTC
        

Created attachment 680446 [details]
build.log




Comment 2


Sam James









          2020-12-31 15:54:16 UTC
        

“Interrupted system call” is still scary here. The only other case we’ve seen that in was an overloaded box.

Does Console show anything at the time?




Comment 3


ash





          2020-12-31 17:53:19 UTC
        

…What just happened?  I tried this a dozen times before filing a bug report, now it works with Console open.

Now bootstrap failed with a similar error when emerging bash-5.1, similar to bug 757381.  This is an iMac Pro with 14 cores and 128GB of RAM, I'm only running 8 parallel compile jobs, the CPU is mostly idle when not bootstrapping.  How is the system getting overloaded?

Only thing in Console that happens while emerging are lines in system.log like:
Dec 31 11:47:06 abby com.apple.xpc.launchd[1] (com.apple.mdworker.shared.17000000-0500-0000-0000-000000000000[44217]): Service exited due to SIGKILL | sent by mds[92]




Comment 4


ash





          2020-12-31 19:03:41 UTC
        

Created attachment 680470 [details]
bash build.log




Comment 5


ash





          2020-12-31 19:06:34 UTC
        

Tried stopping various malware protection services, doesn't help.




Comment 6


Fabian Groffen






          2021-01-06 09:52:27 UTC
        

This is really unexplainable, you could attempt to run bootstrap-prefix using the nohup utility, but I doubt this is going to make a difference.  Is the system configured to go to sleep or something?  (Not that it should make a difference, I've got that myself, and never've seen this happening.)




Comment 7


Fabian Groffen






          2021-08-28 08:42:38 UTC
        

I successfully bootstrapped yesterday on a virgin BigSur install









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

