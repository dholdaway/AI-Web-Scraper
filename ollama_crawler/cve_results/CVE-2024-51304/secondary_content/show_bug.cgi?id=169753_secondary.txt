Title: 169753 – media-gfx/sane-backends - scanimage doesn't recognise Epson Perfection 640U scanner
URL: https://bugs.gentoo.org/show_bug.cgi?id=169753

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 169753
media-gfx/sane-backends - scanimage doesn't recognise Epson Perfection 640U scanner
Last modified: 2007-04-13 10:55:40 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 169753 
      - media-gfx/sane-backends - scanimage doesn't recognise Epson Perfection 640U scanner


Summary:
media-gfx/sane-backends - scanimage doesn't recognise Epson Perfection 640U s...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Patrick Kursawe (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2007-03-07 12:49 UTC by Peter Humphrey





      Modified:
    
2007-04-13 10:55 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



amd64
peter









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




strace -f -o log scanimage -L

              (log,23.53 KB,
                text/plain)

            
2007-03-07 12:50 UTC,

            Peter Humphrey




Details





strace -f -o log scanimage -L

              (log,34.17 KB,
                text/plain)

            
2007-03-09 12:13 UTC,

            Peter Humphrey




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Peter Humphrey





          2007-03-07 12:49:19 UTC
        

(This bug is similar to 90598, but I'm not offered an option to reopen that one so I'm starting a new one.)

I can't get my Epson Perfection 640U recognised properly:

# sane-find-scanner -q
found USB scanner (vendor=0x04b8 [EPSON], product=0x010c [Perfection640  ]) at libusb:002:002

but:

# scanimage -L

No scanners were identified. If you were expecting something different,
check that the scanner is plugged in, turned on and detected by the
sane-find-scanner tool (if appropriate). Please read the documentation
which came with this software (README, FAQ, manpages).

# lsusb
Bus 001 Device 001: ID 0000:0000
Bus 002 Device 002: ID 04b8:010c Seiko Epson Corp. Perfection 640
Bus 002 Device 004: ID 0482:000e Kyocera Corp. FS-1020D Printer
Bus 002 Device 003: ID 046d:c50b Logitech, Inc. Cordless Desktop Optical
Bus 002 Device 001: ID 0000:0000

I've attached an strace output. I'm no Linux programmer, but I can't reconcile the two sets of file-open calls in lines 248 to 277 and 318 to 322. I assume that the name of backend to use has been established in line 280, but it looks as though it hasn't been translated to the right entry in /usr/lib64/sane/.

# emerge --info
Portage 2.1.2.1 (default-linux/amd64/2006.1, gcc-4.1.2, glibc-2.5-r0, 2.6.20-gentoo x86_64)
=================================================================
System uname: 2.6.20-gentoo x86_64 AMD Opteron(tm) Processor 246
Gentoo Base System release 1.12.9
Timestamp of tree: Tue, 06 Mar 2007 05:20:01 +0000
distcc 2.18.3 x86_64-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
ccache version 2.4 [enabled]
dev-java/java-config: 1.3.7, 2.0.31-r4
dev-lang/python:     2.4.4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r6
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.61
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.15
sys-devel/libtool:   1.5.23b
virtual/os-headers:  2.6.20-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=opteron -Os -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=opteron -Os -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg ccache distlocks fixpackages metadata-transfer parallel-fetch sandbox sfperms strict userfetch userpriv usersandbox"
GENTOO_MIRRORS="http://gentoo.blueyonder.co.uk         http://ftp.easynet.nl/mirror/gentoo         http://trumpetti.atm.tut.fi/gentoo/         ftp://sunsite.informatik.rwth-aachen.de/pub/Linux/gentoo         http://distfiles.gentoo.org"
LANG="en_GB.UTF-8"
LC_ALL="en_GB.UTF-8"
LINGUAS="en_GB"
MAKEOPTS="-j5"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://gate.prhnet/gentoo-portage"
USE="X aac aalib acpi alsa amd64 arts bash-completion berkdb bitmap-fonts bzip2 cairo cdr cli cracklib crypt cups dbus dri dvd dvdr encode fam ffmpeg firefox fortran gdbm gif gpm gs iconv ipv6 ithreads java javascript jpeg jpeg2k kde kdeenablefinal lcms libg++ lm_sensors logitech-mouse logrotate midi mng mp3 mpeg ncurses nls nptl nptlonly nvidia ogg opengl pam pcre pdf perl png ppds pppd python qt3 qt4 quicktime readline reflection samba sample scanner sdl session smp spell spl ssl svg tcpd tetex tiff truetype truetype-fonts type1-fonts unicode usb userlocales vorbis wmf xml xml2 xorg zlib" ALSA_CARDS="intel8x0" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mulaw multi null plug rate route share shm softvol" CAMERAS="fuji" ELIBC="glibc" INPUT_DEVICES="keyboard mouse" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en_GB" USERLAND="GNU" VIDEO_CARDS="nv nvidia"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Peter Humphrey





          2007-03-07 12:50:35 UTC
        

Created attachment 112399 [details]
strace -f -o log scanimage -L




Comment 2


Peter Humphrey





          2007-03-08 09:36:07 UTC
        

I've found that putting SANE_BACKENDS="epson" into /etc/make.conf, remerging sane-backends and restarting udev enabled the scanner to be found.

I suggest that this bug should be closed, and instead a how-to be written to explain what needs to be done. None of the documents I found are at all helpful.




Comment 3


Peter Humphrey





          2007-03-09 10:18:00 UTC
        

Please see this discussion for further details:

http://forums.gentoo.org/viewtopic-p-3949604.html#3949604





Comment 4


Patrick Kursawe (RETIRED)






          2007-03-09 10:40:35 UTC
        

(In reply to comment #3)
> Please see this discussion for further details:
> 
> http://forums.gentoo.org/viewtopic-p-3949604.html#3949604

Very strange. Could you please do me two favours:
- build sane-backends without SANE_BACKENDS set and give me the list of backends actually installed on your system.
- give me the strace log of a successful scanimage -L

Thank you.




Comment 5


Peter Humphrey





          2007-03-09 12:13:24 UTC
        

Created attachment 112699 [details]
strace -f -o log scanimage -L

Successful strace before remerging sane-backends with SANE_BACKENDS unset.




Comment 6


Peter Humphrey





          2007-03-09 12:14:15 UTC
        

Ok, no problem.

After commenting-out the SANE_BACKENDS entry in make.conf, I captured this screen output during "emerge sane-backends":

-> Variables used for compilation/linking:
CPPFLAGS=" -D_REENTRANT -I/usr/include/gphoto2 -I/usr/include/libexif -DPATH_SANE_CONFIG_DIR=$(configdir) -DPATH_SANE_DATA_DIR=$(datadir) -DPATH_SANE_LOCK_DIR=$(locksanedir) -DV_MAJOR=1 -DV_MINOR=0"
CFLAGS="-march=opteron -Os -pipe -W -Wall"
LDFLAGS=" "
LIBS="-lusb -lpthread -lm -ljpeg -ltiff -lieee1284 -lgphoto2 -lgphoto2_port -lexif -lm -lusb"
-> Installation directories:
Configuration: /etc
Libraries:     /usr/lib64
Binaries:      /usr/bin and /usr/sbin
Manpages:      /usr/share/man
Documentation: /usr/doc/sane-1.0.18
Lockfiles:     Feature is disabled!
-> Network parameters:
Build saned:   yes
IPv6 support:  yes
-> The following backends will be built:
abaton agfafocus apple artec as6e avision bh brother canon canon630u coolscan coolscan2 dc25 dmc epson fujitsu genesys gt68xx hp leo lexmark matsushita microtek microtek2 mustek mustek_usb nec pie pixma plustek plustek_pp ricoh s9036 sceptre sharp sp15c st400 tamarack test teco1 teco2 teco3 umax umax_pp umax1220u artec_eplus48u ma1509 ibm hp5400 u12 snapscan niash sm3840 hp4200 sm3600 hp3500 stv680 dc210 dc240 canon_pp hpsj5s mustek_pp dell1600n_net gphoto2 qcam v4l net mustek_usb2

After that emerge (no backend set in the environment of emerge):

# ls -1 /usr/lib64/sane | cut -d . -f 1 | uniq
libsane-abaton
libsane-agfafocus
libsane-apple
libsane-artec_eplus48u
libsane-artec
libsane-as6e
libsane-avision
libsane-bh
libsane-brother
libsane-canon630u
libsane-canon
libsane-canon_pp
libsane-canon
libsane-coolscan2
libsane-coolscan
libsane-dc210
libsane-dc240
libsane-dc25
libsane-dell1600n_net
libsane-dll
libsane-dmc
libsane-epson
libsane-fujitsu
libsane-genesys
libsane-gphoto2
libsane-gt68xx
libsane-hp3500
libsane-hp4200
libsane-hp5400
libsane-hp
libsane-hpsj5s
libsane-hp
libsane-ibm
libsane-leo
libsane-lexmark
libsane-ma1509
libsane-matsushita
libsane-microtek2
libsane-microtek
libsane-mustek
libsane-mustek_pp
libsane-mustek
libsane-mustek_usb2
libsane-mustek_usb
libsane-nec
libsane-net
libsane-niash
libsane-pie
libsane-pixma
libsane-plustek
libsane-plustek_pp
libsane-plustek
libsane-qcam
libsane-ricoh
libsane-s9036
libsane-sceptre
libsane-sharp
libsane-sm3600
libsane-sm3840
libsane-snapscan
libsane-sp15c
libsane-st400
libsane-stv680
libsane-tamarack
libsane-teco1
libsane-teco2
libsane-teco3
libsane-test
libsane-u12
libsane-umax1220u
libsane-umax
libsane-umax_pp
libsane-umax
libsane-v4l

Now I get a successful scan-image -L. I'll reboot and then try again.





Comment 7


Matteo Azzali (RETIRED)






          2007-04-03 17:39:34 UTC
        

Do you have installed hotplug? I found that it should actually be in the dependances, as the /etc/udev/rules.d files for scanner recognition are inside
the hotplug package.....




Comment 8


Matteo Azzali (RETIRED)






          2007-04-03 17:41:16 UTC
        

Ops , sorry my fault, they were updated in my system after an 
emerge -1 sane-backend , try it yourself and if you need an etc-update
you're there.




Comment 9


Peter Humphrey





          2007-04-04 09:31:57 UTC
        

(In reply to comment #6)

> Now I get a successful scan-image -L. I'll reboot and then try again.

Oops! Sorry folks - I forgot to report back. In fact, the scanner works just fine now.

No, I don't have either hotplug or coldplug installed.

As far as I can see, I've finished up with exactly the same system as before, with the one exception that my scanner wasn't detected before but it is now. I can't explain that.






Comment 10


Patrick Kursawe (RETIRED)






          2007-04-13 10:55:40 UTC
        

No idea, either. But since it works now - closing.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

