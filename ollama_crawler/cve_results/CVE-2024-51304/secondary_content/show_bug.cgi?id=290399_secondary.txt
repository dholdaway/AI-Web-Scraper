Title: 290399 – media-video/transcode-1.1.4 does not compile w/ gcc-4.4.2 because of missing libgomp.la
URL: https://bugs.gentoo.org/show_bug.cgi?id=290399

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 290399
media-video/transcode-1.1.4 does not compile w/ gcc-4.4.2 because of missing libgomp.la
Last modified: 2009-11-05 12:25:23 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 290399 
      - media-video/transcode-1.1.4 does not compile w/ gcc-4.4.2 because of missing libgomp.la


Summary:
media-video/transcode-1.1.4 does not compile w/ gcc-4.4.2 because of missing ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Library

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-10-24 17:27 UTC by Andreas Sturmlechner





      Modified:
    
2009-11-05 12:25 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



rogerx.oss









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andreas Sturmlechner






          2009-10-24 17:27:31 UTC
        

Compiling transcode-1.1.4 fails because of a missing libgomp.la in /usr/lib64/

That file does exist though: /usr/lib/gcc/x86_64-pc-linux-gnu/4.4.2/libgomp.la

So my temporary (and working) fix is: ln -s /usr/lib64/gcc/x86_64-pc-linux-gnu/4.4.2/libgomp.la /usr/lib64/libgomp.la

Reproducible: Always

Steps to Reproduce:
Install gcc-4.4.2, make it your system gcc and try to recompile transcode-1.1.4.



emerge --info (stripped to relevance):

Portage 2.2_rc46 (default/linux/amd64/10.0/desktop, gcc-4.4.2, glibc-2.10.1-r0, 2.6.31-zen4 x86_64)
=================================================================
System uname: Linux-2.6.31-zen4-x86_64-Intel-R-_Core-TM-2_Duo_CPU_L9400_@_1.86GHz-with-gentoo-2.0.1
Timestamp of tree: Sat, 24 Oct 2009 10:00:17 +0000
app-shells/bash:     4.0_p33
dev-java/java-config: 2.1.9-r1
dev-lang/python:     2.6.2-r2
dev-util/cmake:      2.6.4-r3
sys-apps/baselayout: 2.0.1
sys-apps/openrc:     0.5.2-r1
sys-apps/sandbox:    2.1
sys-devel/autoconf:  2.63-r1
sys-devel/automake:  1.9.6-r2, 1.10.2, 1.11
sys-devel/binutils:  2.20
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   2.2.6a
virtual/os-headers:  2.6.30-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CXXFLAGS="-march=core2 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="assume-digests distlocks fixpackages news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch"
LANG="en_GB.UTF-8"
LDFLAGS="-Wl,-O1"
LINGUAS="en_GB en de"
MAKEOPTS="-j2"



last words:

libtool: link: x86_64-pc-linux-gnu-gcc -shared  .libs/export_ffmpeg_la-export_ffmpeg.o .libs/export_ffmpeg_la-aud_aux.o .libs/export_ffmpeg_la-ffmpeg_cfg.o   -lavcodec -L/usr/lib /usr/lib64/libmp3lame.so -lm -lz -ldl  -march=core2 -Wl,-O1   -Wl,-soname -Wl,export_ffmpeg.so -o .libs/export_ffmpeg.so
/bin/grep: /usr/lib/../lib64/libgomp.la: No such file or directory
/bin/sed: can't read /usr/lib/../lib64/libgomp.la: No such file or directory
libtool: link: `/usr/lib/../lib64/libgomp.la' is not a valid libtool archive
make[2]: *** [export_im.la] Error 1
make[2]: *** Waiting for unfinished jobs....
libtool: link: ( cd ".libs" && rm -f "export_ffmpeg.la" && ln -s "../export_ffmpeg.la" "export_ffmpeg.la" )
make[2]: Leaving directory `/var/tmp/portage/media-video/transcode-1.1.4/work/transcode-1.1.4/export'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-video/transcode-1.1.4/work/transcode-1.1.4'
make: *** [all] Error 2
 * ERROR: media-video/transcode-1.1.4 failed:
 *   emake failed
 *
 * Call stack:
 *     ebuild.sh, line   49:  Called src_compile
 *   environment, line 3156:  Called _eapi2_src_compile
 *     ebuild.sh, line  647:  Called die
 * The specific snippet of code:
 *              emake || die "emake failed"




Comment 1


emerald





          2009-10-24 17:45:48 UTC
        

run
# fix_libtool_files.sh 4.4.1
(replace 4.4.1 with the old gcc version)
and it should be alright again.





Comment 2


Andreas Sturmlechner






          2009-10-24 18:19:29 UTC
        

(In reply to comment #1)
> run
> # fix_libtool_files.sh 4.4.1
> (replace 4.4.1 with the old gcc version)
> and it should be alright again.
> 

I had 4.4.2_pre9999 running long ago and 4.4.1_pre9999 just before that. I did run fix_libtool_files.sh before and it didn't change a thing.




Comment 3


Andreas Sturmlechner






          2009-10-24 18:23:56 UTC
        

(In reply to comment #2)
> (In reply to comment #1)
> > run
> > # fix_libtool_files.sh 4.4.1
> > (replace 4.4.1 with the old gcc version)
> > and it should be alright again.
> > 
> 
> I had 4.4.2_pre9999 running long ago and 4.4.1_pre9999 just before that. I did
> run fix_libtool_files.sh before and it didn't change a thing.
> 

Ok, it turns out I missed the change from 4.4.0_pre9999 to 4.4.1_pre9999, or rather mis-used fix_libtool_files.sh

fix_libtool_files.sh 4.4.0* (instead of 4.4.0 back then) did the trick. Thanks for the help, I'll mark that bug as fixed now.




Comment 4


Roger





          2009-11-03 00:21:19 UTC
        

My error reads "usr/lib/gcc/i686-pc-linux-gnu/4.3.4"... Looks like the beginning top folder designator is stripped.  ...unlike your original posting.

=sys-apps/portage-2.2_rc46


libtool: link: i686-pc-linux-gnu-gcc -shared  .libs/export_ffmpeg_la-export_ffmpeg.o .libs/export_ffmpeg_la-aud_aux.o .libs/export_ffmpeg_la-ffmpeg_cfg.o   -lavcodec -L/usr/lib /usr/lib/libmp3lame.so -lm -lz -ldl  -march=pentium3 -Wl,-O1   -Wl,-soname -Wl,export_ffmpeg.so -o .libs/export_ffmpeg.so
../libtool: line 6427: cd: usr/lib/gcc/i686-pc-linux-gnu/4.3.4: No such file or directory
libtool: link: warning: cannot determine absolute directory name of `usr/lib/gcc/i686-pc-linux-gnu/4.3.4'
/bin/grep: usr/lib/gcc/i686-pc-linux-gnu/4.3.4/libgomp.la: No such file or directory
/bin/sed: can't read usr/lib/gcc/i686-pc-linux-gnu/4.3.4/libgomp.la: No such file or directory
libtool: link: `usr/lib/gcc/i686-pc-linux-gnu/4.3.4/libgomp.la' is not a valid libtool archive
make[2]: *** [export_im.la] Error 1
make[2]: *** Waiting for unfinished jobs....
libtool: link: ( cd ".libs" && rm -f "export_ffmpeg.la" && ln -s "../export_ffmpeg.la" "export_ffmpeg.la" )
make[2]: Leaving directory `/var/tmp/portage/media-video/transcode-1.1.4/work/transcode-1.1.4/export'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/var/tmp/portage/media-video/transcode-1.1.4/work/transcode-1.1.4'
make: *** [all] Error 2





Comment 5


Rafał Mużyło





          2009-11-05 12:25:23 UTC
        

Explaining why WORKSFORME:
both reporter and comment 4 are effects of similar source of problem
- gcc la files.
Both were caused by mistakes in either gcc ebuild or one of
the used eclasses, that have been long  fixed in the tree.

The problems now are caused by the broken la files, so
either reemerge gcc of edit those la files
- you should edit libgomp.la and set libdir to
the one la file is in, then either revdep-rebuild
or (this may not be enough) correct libMagickWand.la
and LibMagickCore.la









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

