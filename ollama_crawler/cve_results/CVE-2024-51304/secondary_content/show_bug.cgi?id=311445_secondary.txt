Title: 311445 – kde-base/kopete-4.4.1 Yahoo module DOSes Knotify4!
URL: https://bugs.gentoo.org/show_bug.cgi?id=311445

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 311445
kde-base/kopete-4.4.1 Yahoo module DOSes Knotify4!
Last modified: 2010-06-08 15:10:39 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 311445 
      - kde-base/kopete-4.4.1 Yahoo module DOSes Knotify4!


Summary:
kde-base/kopete-4.4.1 Yahoo module DOSes Knotify4!
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] KDE

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-03-26 14:16 UTC by Navid Zamani





      Modified:
    
2010-06-08 15:10 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info kopete

              (emerge --info kopete.txt,6.17 KB,
                text/plain)

            
2010-03-26 14:18 UTC,

            Navid Zamani




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Navid Zamani





          2010-03-26 14:16:58 UTC
        

About every second time I log in, Kopete pops up a ton of modal message dialog boxes (I had over 300 here!!), which flood RAM and bring the system to a halt.
Turns out it does this trough Knotify4. (Perhaps because each window makes a sound when opening.)

Reproducible: Sometimes

Steps to Reproduce:
1. Be sure you run on KDE 4.4.1
2. Install Kopete (4.4.1)
3. Go to systemsettings, and configure a short sound for window and dialog opening. (Because you won’t see all the dialogs, and without the sound, the DOSing is harder so notice.)
4. Enable a Yahoo account.
5. Let it store the password in the digital wallet, so that that one asks for a password.
6. If everything runs, completely close Kopete, and start it again in a matter of seconds. (Just to be sure.)
7. Enter the digital wallet’s password.
Actual Results:  
8. A ton of dialogs about a problem with Yahoo pop up, making the configured sound in a pingpingpingpingpingpingpingpingpingpingpingpingpingping…
9. Notice memory usage going way up, flooding RAM, and slowing the system to a crawl because of swapping. (Including the ping sounds.)
10. Quickly (!!!) switch to a virtual terminal (e.g. Ctrl-Alt-F2).
11. killall kopete # make haste!
12. Notice how the flood of sounds stopped, but the RAM usage by Knotify4 is still extreme (e.g. 1.8 GB here).
13. killall knotify4
14. Notice how memory usage normalizes, and switch back to X.
15. WAIT before restarting Kopete, and prepare to eventually get the same thing again.

Expected Results:  
9. Kopete logs in normally, and nothing special happens.

My guess is, that either this happens every time I restart Kopete, right after closing it, or it happens if you wait too long between starting Kopete, and entering the wallet’s password (and then perhaps also restart Kopete “too” quickly).

It’s extremely annoying, and right now i open this bug, because it not only lost the history of what I wrote, but also crashed my PIM suite in the middle of saving, causing massive corruption, which I now have to restore via backup, losing a lengthy project plan I just had finished writing and was about to save in its final state. (The backup was this night, before I started to write the plan.)




Comment 1


Navid Zamani





          2010-03-26 14:18:47 UTC
        

Created attachment 225327 [details]
emerge --info kopete




Comment 2


Maciej Mrozowski






          2010-03-27 13:13:08 UTC
        

What message is shown in this notification?




Comment 3


Navid Zamani





          2010-03-28 16:44:39 UTC
        

Actually, there is no message shown, since a new dialog pops up on top of it, before its contents are rendered, and since that seems to never stop, there is never a text visible here. :/ (People with a very fast CPU might have more chance, but it’s unlikely.)

The title of the windows is shown though. I can post the exact text when it happens the next time. (Right now I need my system working, so I won’t provoke it.) But for now, I can tell you that it includes the words “Kopete”, “Yahoo”, “error” and a number, like in “<302>”, where 302 is the number of dialogs open or messages, as far as I can tell, since it increases with every opening dialog.




Comment 4


Navid Zamani





          2010-03-28 16:46:19 UTC
        

Sorry for not being able to give more details. Is it hard to reproduce?




Comment 5


Jorge Manuel B. S. Vicetto (RETIRED)






          2010-04-04 15:54:08 UTC
        

Please test kopete-4.4.2-r1 as there were some recent updates to the yahoo code and I just applied a patch that fixes the issue with stealth mode.




Comment 6


Navid Zamani





          2010-04-04 20:48:22 UTC
        

(In reply to comment #5)
I just updated, and I can’t trigger the bug anymore. So unless it will happen again, I’ll mark the bug as fixed. Thx.





Comment 7


Navid Zamani





          2010-04-05 12:58:53 UTC
        

Ok, I’m sorry to say this, but I had the bug again, just 30 seconds ago.
Is there any way I can help tracking this down?




Comment 8


Navid Zamani





          2010-04-05 13:03:47 UTC
        

Oh, I should note, that this time, it happened right after the start of the system. I logged is, I entered the password for the wallet as soon as it opened, and there it was. Didn’t kill knotify4 this time, because I wanted to see the dialogs, but they did go away with Kopete (obviously, since they were Kopete dialogs), and the sound for closing windows played of all of them.

BUT: Memory usage didn’t go back to normal, until I killed knotify4! Seems that knotify4 doesn’t free the sound data from memory and also doesn’t re-use the same files when they already are in memory.




Comment 9


Jorge Manuel B. S. Vicetto (RETIRED)






          2010-04-05 13:04:35 UTC
        

Please read the backtrace guide[1] and see if you can get some meaningful info.
You can also open an upstream bug about this and attach there the backtrace. If you open the upstream bug, please add the link to the URL field in this bug.




Comment 10


Navid Zamani





          2010-04-05 13:13:36 UTC
        

Ok, I just restarted Kopete, after killing it as described. And it happened *again*. By the way, the exact text is:
“Yahoo-Modul — Kopete <x>”
where “x” is the number. There is no text inside the window.

I also noticed something important: It doesn’t happen at login. It happens when the status of the contacts is read at the beginning. When Kopete starts, first it shows everyone who is online as online, no matter their real status. And then the little status icons of your friends in the list go from “online” to e.g. “away”, which is the real status. That’s the exact moment when it’s happening.
In my exact case, the Yahoo icon for one friend of mine, who was the only one online, went to this red stop sign that is described an “busy” in the status editor dialog.
Maybe that makes reproducing it easier.




Comment 11


Navid Zamani





          2010-04-05 14:16:00 UTC
        

(In reply to comment #9)
> Please read the backtrace guide[1] and see if you can get some meaningful info.
I’ll do that, as soon as I can find a way to reliably trigger the bug myself.

If you can also not find anything, feel free to set the bug to NEEDINFO or something like that.




Comment 12


Jorge Manuel B. S. Vicetto (RETIRED)






          2010-04-05 18:47:00 UTC
        

(In reply to comment #11)
> If you can also not find anything, feel free to set the bug to NEEDINFO or
> something like that.

Unfortunately I don't have an yahoo account, so I can't test this issue.
I'll leave the bug open to see if someone can help debug this.





Comment 13


Navid Zamani





          2010-04-06 15:29:28 UTC
        

Something I found, that turns up in .xsession-errors for each Yahoo window that opens:

kwin(6245) KWin::Client::readUserTimeMapTimestamp: User timestamp, initial: 5533740
kwin(6245) KWin::Client::readUserTimeMapTimestamp: User timestamp, ASN: 5533740
kwin(6245) KWin::Client::readUserTimeMapTimestamp: User timestamp, final: 'ID: 62925071 ;WMCLASS: "kopete" : "kopete" ;Caption: "Yahoo-Modul – Kopete <81><200e>" ' : 5533740
kwin(6245) KWin::Workspace::allowClientActivation: Activation: Belongs to active application
kwin(6245) KWin::Workspace::updateClientArea: screens:  2 desktops:  3
kwin(6245) KWin::Workspace::updateClientArea: Done.





Comment 14


Jorge Manuel B. S. Vicetto (RETIRED)






          2010-06-06 23:26:48 UTC
        

Did you open an upstream bug about this issue?




Comment 15


Navid Zamani





          2010-06-08 15:10:39 UTC
        

(In reply to comment #14)
> Did you open an upstream bug about this issue?

I had planned to do it, but shortly thereafter I guess I did an update, and it did not occur anymore. I say „I guess“, because I forgot about it. Which means it did not happen anymore.

Thank you for reminding me that this bug still existed. Well, right now it works for me. Which means it very likely got fixed. So let’s close it. When it really turns up again, or someone else sees it, we can still re-open it

Thank you. :)
> 











Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

