Title: 930646 – dev-qt/qtwebengine-6.7.0 fails test tst_qwebenginedownloadrequest
URL: https://bugs.gentoo.org/show_bug.cgi?id=930646

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 930646
dev-qt/qtwebengine-6.7.0 fails test tst_qwebenginedownloadrequest
Last modified: 2024-05-06 01:30:53 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 930646 
      - dev-qt/qtwebengine-6.7.0 fails test tst_qwebenginedownloadrequest


Summary:
dev-qt/qtwebengine-6.7.0 fails test tst_qwebenginedownloadrequest
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Qt Bug Alias








URL:







Whiteboard:




Keywords:

TESTFAILURE







Depends on:







Blocks:









 





      Reported:
    
2024-04-25 00:35 UTC by Jonathan Lovelace





      Modified:
    
2024-05-06 01:30 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



ionen
kingjon3377









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




dev-qt:qtwebengine-6.7.0:20240424-054317.log.bz2

              (dev-qt:qtwebengine-6.7.0:20240424-054317.log.bz2,783.96 KB,
                text/plain; charset=utf-8)

            
2024-04-25 00:35 UTC,

            Jonathan Lovelace




Details





emerge-info.txt

              (emerge-info.txt,9.62 KB,
                text/plain; charset=utf-8)

            
2024-04-25 00:36 UTC,

            Jonathan Lovelace




Details





LastTest.log

              (LastTest.log,212.44 KB,
                text/plain; charset=utf-8)

            
2024-04-25 00:37 UTC,

            Jonathan Lovelace




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jonathan Lovelace





          2024-04-25 00:35:16 UTC
        

=dev-qt/qtwebengine-6.7.0 is failing its test phase for me, specifically the test tst_qwebenginedownloadrequest. Here's the relevant snippet of that test's output in the LastTest.log:

********* Start testing of tst_QWebEngineDownloadRequest *********
Config: Using QtTest library 6.7.0, Qt 6.7.0 (x86_64-little_endian-lp64 shared (dynamic) release build; by GCC 13.2.1 20240210), gentoo 2.14
QWARN  : tst_QWebEngineDownloadRequest::initTestCase() WebEngineContext is used before QtWebEngineQuick::initialize() or OpenGL context creation failed.
QWARN  : tst_QWebEngineDownloadRequest::initTestCase() Path override failed for key base::DIR_APP_DICTIONARIES and path '/var/tmp/portage/dev-qt/qtwebengine-6.7.0/work/qtwebengine-everywhere-src-6.7.0_build/tests/auto/widgets/qwebenginedownloadrequest/qtwebengine_dictionaries'
Path override failed for key base::DIR_APP_DICTIONARIES and path '/var/tmp/portage/dev-qt/qtwebengine-6.7.0/work/qtwebengine-evePath override failed for key base::DIR_APP_DICTIONARIES and path '/var/tmp/portage/dev-qt/qtwebengine-6.7.0/work/qtwebengine-everywhere-src-6.7.0_build/lib64/qt6/libexec/qtwebengine_dictionaries'
rywhere-src-6.7.0_build/lib64/qt6/libexec/qtwebengine_dictionaries'
PASS   : tst_QWebEngineDownloadRequest::initTestCase()
[3355:3375:0424/144206.719033:ERROR:zygote_host_impl_linux.cc(281)] Failed to adjust OOM score of renderer with pid 3376: Permission denied (13)
QINFO  : tst_QWebEngineDownloadRequest::downloadLink(save link to empty file) HttpServer: GET / 200 53
QINFO  : tst_QWebEngineDownloadRequest::downloadLink(save link to empty file) HttpServer: GET /foo.txt 200 0
PASS   : tst_QWebEngineDownloadRequest::downloadLink(save link to empty file)
QINFO  : tst_QWebEngineDownloadRequest::downloadLink(save link to text file) HttpServer: GET / 200 53
QINFO  : tst_QWebEngineDownloadRequest::downloadLink(save link to text file) HttpServer: GET /foo.txt 200 3
PASS   : tst_QWebEngineDownloadRequest::downloadLink(save link to text file)
QINFO  : tst_QWebEngineDownloadRequest::downloadLink(save link to text file (attribute)) HttpServer: GET / 200 61
FAIL!  : tst_QWebEngineDownloadRequest::downloadLink(save link to text file (attribute)) Compared values are not the same
   Actual   (menuSpy.size()): 0
   Expected (1)             : 1
   Loc: [/var/tmp/portage/dev-qt/qtwebengine-6.7.0/work/qtwebengine-everywhere-src-6.7.0/tests/auto/widgets/qwebenginedownloadrequest/tst_qwebenginedownloadrequest.cpp(142)]
FAIL!  : tst_QWebEngineDownloadRequest::downloadLink(save link to text file (attribute)) Compared values are not the same
   Actual   (acceptedCount): 0
   Expected (1)            : 1
   Loc: [/var/tmp/portage/dev-qt/qtwebengine-6.7.0/work/qtwebengine-everywhere-src-6.7.0/tests/auto/widgets/qwebenginedownloadrequest/tst_qwebenginedownloadrequest.cpp(471)]
QINFO  : tst_QWebEngineDownloadRequest::downloadLink(save link to text file (attachment)) HttpServer: GET / 200 53




Comment 1


Jonathan Lovelace





          2024-04-25 00:35:47 UTC
        

Created attachment 891674 [details]
dev-qt:qtwebengine-6.7.0:20240424-054317.log.bz2




Comment 2


Jonathan Lovelace





          2024-04-25 00:36:26 UTC
        

Created attachment 891675 [details]
emerge-info.txt




Comment 3


Jonathan Lovelace





          2024-04-25 00:37:20 UTC
        

Created attachment 891676 [details]
LastTest.log




Comment 4


Ionen Wolkens






          2024-04-25 15:44:50 UTC
        

Can't reproduce. I tried using an hardened toolchain, same CXXFLAGS, and same USE but passes fine still:

    QINFO  : tst_QWebEngineDownloadRequest::downloadLink(save link to text file (attribute)) HttpServer: GET / 200 61
    QINFO  : tst_QWebEngineDownloadRequest::downloadLink(save link to text file (attribute)) HttpServer: GET /foo.txt 200 3
    PASS   : tst_QWebEngineDownloadRequest::downloadLink(save link to text file (attribute)) 

I tried on ~amd64, but given it was stabilized not that long ago it should be passing in stable too.

I don't see reports about this test on Qt's issue tracker either.

...so I don't really have any ideas what happened for you, perhaps it's a flaky test that (rarely) randomly fail. In such a case I'd skip it rather than worry about it downstream but given can't reproduce I don't know if it's that. Maybe try again?




Comment 5


Ionen Wolkens






          2024-05-06 01:30:53 UTC
        

>Maybe try again?
Still no idea how to reproduce and haven't heard back, so guess I'll close this for now.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

