Title: 497230 – Fails to rebuild some preserved packages
URL: https://bugs.gentoo.org/show_bug.cgi?id=497230

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 497230
Fails to rebuild some preserved packages
Last modified: 2014-01-06 17:11:52 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 497230 
      - Fails to rebuild some preserved packages


Summary:
Fails to rebuild some preserved packages
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-01-06 10:04 UTC by Dirkjan Ochtman (RETIRED)





      Modified:
    
2014-01-06 17:11 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Dirkjan Ochtman (RETIRED)






          2014-01-06 10:04:14 UTC
        

!!! existing preserved libs:
>>> package: media-libs/libpng-1.6.8
 *  - /usr/lib/libpng15.so.15
 *  - /usr/lib/libpng15.so.15.17.0
 *      used by /usr/lib/ImageMagick-6.8.6/modules-Q16/coders/png.so (media-gfx/imagemagick-6.8.6.8)
 *      used by /usr/lib/libgd.so.2.0.0 (media-libs/gd-2.0.35-r3)
Use emerge @preserved-rebuild to rebuild packages using these libraries

djc@enrai ~ $ sudo emerge -uavD --changed-use @preserved-rebuild

These are the packages that would be merged, in order:

Calculating dependencies... done!

Total: 0 packages, Size of downloads: 0 kB

Nothing to merge; quitting.




Comment 1


Chí-Thanh Christopher Nguyễn






          2014-01-06 10:47:20 UTC
        

(In reply to Dirkjan Ochtman from comment #0)
> emerge -uavD

I think -u won't work unless there is actually a package to upgrade in preserved-rebuild set.

What is the output of:
# emerge -pv @preserved-rebuild
?




Comment 2


Dirkjan Ochtman (RETIRED)






          2014-01-06 12:14:37 UTC
        

djc@enrai vjk-admin $ sudo emerge -pv @preserved-rebuild

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild   R    ] media-libs/gd-2.0.35-r3:2  USE="zlib -fontconfig* -jpeg* -png* -static-libs -truetype* -xpm" 0 kB
[ebuild   R    ] media-gfx/imagemagick-6.8.6.8:0/6.8.6.8  USE="bzip2 fontconfig jpeg openmp png truetype zlib -X -autotrace -corefonts -cxx -djvu -fftw -fpx -graphviz -hdri -jbig -jpeg2k -lcms -lqr -lzma -opencl -openexr -pango -perl -postscript -q32 -q64 -q8 -raw -static-libs -svg {-test} -tiff -webp -wmf -xml" 0 kB

Total: 2 packages (2 reinstalls), Size of downloads: 0 kB

!!! Multiple package instances within a single package slot have been pulled
!!! into the dependency graph, resulting in a slot conflict:

media-libs/gd:2

  (media-libs/gd-2.0.35-r3::gentoo, ebuild scheduled for merge) pulled in by
    (no parents that aren't satisfied by other packages in this slot)

  (media-libs/gd-2.0.35-r3::gentoo, installed) pulled in by
    >=media-libs/gd-2.0.28[fontconfig,jpeg,png,truetype,zlib] required by (media-gfx/graphviz-2.26.3-r4::gentoo, installed)
    media-libs/gd[jpeg,png] required by (app-text/dvipng-1.14::gentoo, installed)


!!! Enabling --newuse and --update might solve this conflict.
!!! If not, it might help emerge to give a more specific suggestion.




Comment 3


Sebastian Luther (few)





          2014-01-06 15:47:52 UTC
        

You changed some use flags for gd. This means that after reinstalling it, it wouldn't satisfy dependencies of some installed packages. (flags: fontconfig,jpeg,png,truetype)




Comment 4


Dirkjan Ochtman (RETIRED)






          2014-01-06 15:56:23 UTC
        

Okay, well, can we transform this bug to be about improving the error message?

!!! Multiple package instances within a single package slot have been pulled
!!! into the dependency graph, resulting in a slot conflict:

"Multiple package instances" is pretty vague in this context. Can we have it say something about USE flags specifically?




Comment 5


Sebastian Luther (few)





          2014-01-06 17:11:41 UTC
        

(In reply to Dirkjan Ochtman from comment #4)
> Okay, well, can we transform this bug to be about improving the error
> message?
> 
> !!! Multiple package instances within a single package slot have been pulled
> !!! into the dependency graph, resulting in a slot conflict:
> 
> "Multiple package instances" is pretty vague in this context. Can we have it
> say something about USE flags specifically?

Well, if you keep reading it tells you that there are two instances of gd. An ebuild from ::gentoo and an installed package.

It also tells you that there are some dependencies which can only be satisfied by the installed package.

If you view that in a terminal with color support, it even highlights the use flags that cause the problem in the dependency atom.

Anyway, if you have some suggestion to improve the message, go ahead.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

