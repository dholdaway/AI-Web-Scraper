Title: 267619 – dev-vcs/cvs-1.12.12-r6 compilation hangs on checking for working mktime...
URL: https://bugs.gentoo.org/show_bug.cgi?id=267619

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 267619
dev-vcs/cvs-1.12.12-r6 compilation hangs on checking for working mktime...
Last modified: 2011-12-23 02:58:22 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 267619 
      - dev-vcs/cvs-1.12.12-r6 compilation hangs on checking for working mktime...


Summary:
dev-vcs/cvs-1.12.12-r6 compilation hangs on checking for working mktime...
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Maintainers for cvs, and cvs related tools (the version control system) [OBSOLETE]








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:




220040



 

        Show dependency tree





 





      Reported:
    
2009-04-27 04:56 UTC by Ronald





      Modified:
    
2011-12-23 02:58 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



rhill
SebastianLuther
vapier









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




cvs-1.12.12-mktime-overflow.patch

              (cvs-1.12.12-mktime-overflow.patch,443 bytes,
                patch)

            
2011-07-09 09:23 UTC,

            Ryan Hill (RETIRED)




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ronald





          2009-04-27 04:56:33 UTC
        

Whenever I try to compile CVS (dev-util/cvs-1.12.12-r6) it hangs. The last output lines are:

>>>snip<<<
checking for stdlib.h... (cached) yes
checking for sys/time.h... (cached) yes
checking for unistd.h... (cached) yes
checking for alarm... yes
checking for working mktime... 


Reproducible: Always

Steps to Reproduce:
1. emerge cvs
Actual Results:  
Hangs when checking for working mktime.

Expected Results:  
Should detect a working mktime (or not) and continue

This system is build from stage3 just yesterday. I already searched bugzilla for this, and found this *probably* related bug: http://bugs.gentoo.org/show_bug.cgi?id=220040 . The patch is applied to the version of bash that I'm using, I might be the cause...

Emerge info:

Portage 2.1.6.7 (default/linux/x86/2008.0, gcc-4.3.2, glibc-2.8_p20080602-r1, 2.6.28-gentoo-r5 i686)
=================================================================
System uname: Linux-2.6.28-gentoo-r5-i686-AMD_Athlon-tm-_64_Processor_3200+-with-glibc2.0
Timestamp of tree: Sun, 26 Apr 2009 05:00:01 +0000
app-shells/bash:     3.2_p39
dev-java/java-config: 2.1.7
dev-lang/python:     2.4.4-r13, 2.5.4-r2
dev-python/pycrypto: 2.0.1-r8
dev-util/cmake:      2.6.2-r1
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.7.9-r1, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.28-r1
ACCEPT_KEYWORDS="x86"
ALSA_CARDS="intel8x0"
ALSA_PCM_PLUGINS="asym dmix empty ioplug plug rate softvol route"
APACHE2_MODULES=""
ARCH="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=k8 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CLEAN_DELAY="5"
COLLISION_IGNORE="/lib/modules"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/udev/rules.d"
CVS_RSH="ssh"
CXXFLAGS="-O2 -march=k8 -pipe -fomit-frame-pointer"
DISPLAY=":0.0"
DISTDIR="/usr/portage/distfiles"
EDITOR="/bin/nano"
ELIBC="glibc"
EMERGE_WARNING_DELAY="10"
FEATURES="distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
FETCHCOMMAND="/usr/bin/wget -t 5 -T 60 --passive-ftp -O "${DISTDIR}/${FILE}" "${URI}""
GCC_SPECS=""
GDK_USE_XFT="1"
GENTOO_MIRRORS="http://ftp.snt.utwente.nl/pub/os/linux/gentoo ftp://ftp.snt.utwente.nl/pub/os/linux/gentoo http://gentoo.tiscali.nl/ ftp://gentoo.tiscali.nl/pub/mirror/gentoo/ http://mirror.muntinternet.net/pub/gentoo/ ftp://mirror.muntinternet.net/pub/gentoo/ http://mirror.cambrium.nl/pub/os/linux/gentoo/ ftp://mirror.cambrium.nl/pub/os/linux/gentoo/ http://mirror.leaseweb.com/gentoo/ ftp://mirror.leaseweb.com/gentoo/"
HOME="/root"
HZ="100"
INFOPATH="/usr/share/info:/usr/share/binutils-data/i686-pc-linux-gnu/2.18/info:/usr/share/gcc-data/i486-pc-linux-gnu/4.1.2/info:/usr/share/gcc-data/i686-pc-linux-gnu/4.3.2/info"
INPUT_DEVICES="evdev"
JAVAC="/etc/java-config-2/current-system-vm/bin/javac"
JAVA_HOME="/etc/java-config-2/current-system-vm"
JDK_HOME="/etc/java-config-2/current-system-vm"
KERNEL="linux"
LCD_DEVICES=""
LDFLAGS="-Wl,-O1"
LESS="-R -M --shift 5"
LESSOPEN="|lesspipe.sh %s"
LOGNAME="root"
LS_COLORS="rs=0:di=01;34:ln=01;36:hl=44;37:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=01;05;37;41:mi=01;05;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.lzma=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.bz2=01;31:*.bz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.rar=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.axv=01;35:*.anx=01;35:*.ogv=01;35:*.ogx=01;35:*.pdf=00;32:*.ps=00;32:*.txt=00;32:*.patch=00;32:*.diff=00;32:*.log=00;32:*.tex=00;32:*.doc=00;32:*.aac=00;36:*.au=00;36:*.flac=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.axa=00;36:*.oga=00;36:*.spx=00;36:*.xspf=00;36:"
MANPATH="/etc/java-config-2/current-system-vm/man:/usr/local/share/man:/usr/share/man:/usr/share/binutils-data/i686-pc-linux-gnu/2.18/man:/usr/share/gcc-data/i486-pc-linux-gnu/4.1.2/man:/usr/share/gcc-data/i686-pc-linux-gnu/4.3.2/man:/etc/java-config/system-vm/man/"
NETBEANS="apisupport cnd groovy gsf harness ide identity j2ee java mobility nb php profiler soa visualweb webcommon websvccommon xml"
OPENGL_PROFILE="xorg-x11"
PAGER="/usr/bin/less"
PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/i486-pc-linux-gnu/gcc-bin/4.1.2:/usr/i686-pc-linux-gnu/gcc-bin/4.3.2"
PKGDIR="/usr/portage/packages"
PORTAGE_ARCHLIST="ppc s390 amd64 x86 ppc64 x86-fbsd m68k arm sparc sh mips ia64 alpha hppa amd64-fbsd sparc-fbsd"
PORTAGE_BINHOST_CHUNKSIZE="3000"
PORTAGE_BIN_PATH="/usr/lib/portage/bin"
PORTAGE_COMPRESS_EXCLUDE_SUFFIXES="css gif htm[l]? jp[e]?g js pdf png"
PORTAGE_CONFIGROOT="/"
PORTAGE_COUNTER_HASH="4ef0e387b6243066ac6794909b718313"
PORTAGE_DEBUG="0"
PORTAGE_DEPCACHEDIR="/var/cache/edb/dep"
PORTAGE_ELOG_CLASSES="log warn error"
PORTAGE_ELOG_MAILFROM="portage@localhost"
PORTAGE_ELOG_MAILSUBJECT="[portage] ebuild log for ${PACKAGE} on ${HOST}"
PORTAGE_ELOG_MAILURI="root"
PORTAGE_ELOG_SYSTEM="save_summary echo"
PORTAGE_FETCH_CHECKSUM_TRY_MIRRORS="5"
PORTAGE_FETCH_RESUME_MIN_SIZE="350K"
PORTAGE_GID="250"
PORTAGE_INST_GID="0"
PORTAGE_INST_UID="0"
PORTAGE_PYM_PATH="/usr/lib/portage/pym"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_RSYNC_RETRIES="3"
PORTAGE_TMPDIR="/var/tmp"
PORTAGE_VERBOSE="1"
PORTAGE_WORKDIR_MODE="0700"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/layman/nouveau"
PRELINK_PATH_MASK="/usr/lib/klibc"
PROFILE_ONLY_VARIABLES="ARCH ELIBC KERNEL USERLAND"
PWD="/root"
RESUMECOMMAND="/usr/bin/wget -c -t 5 -T 60 --passive-ftp -O "${DISTDIR}/${FILE}" "${URI}""
ROOT="/"
ROOTPATH="/opt/bin:/usr/i486-pc-linux-gnu/gcc-bin/4.1.2:/usr/i686-pc-linux-gnu/gcc-bin/4.3.2"
RPMDIR="/usr/portage/rpm"
SHELL="/bin/bash"
SHLVL="1"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
TERM="rxvt-unicode"
USE="3dnow 3dnowext X acpi crypt custom-cflags custom-cxxflags dbus dri gnutls gtk hal libnotify lm_sensors mmap mmx mmxext nls nptl opengl session sharedmem sndfile sse sse2 startup-notification symlink syslog threads truetype unicode win32codecs x86 xcb xft xscreensaver xulrunner" ALSA_CARDS="intel8x0" ALSA_PCM_PLUGINS="asym dmix empty ioplug plug rate softvol route" ELIBC="glibc" INPUT_DEVICES="evdev" KERNEL="linux" USERLAND="GNU" VIDEO_CARDS="nouveau"
USER="root"
USERLAND="GNU"
USE_EXPAND="ALSA_CARDS ALSA_PCM_PLUGINS APACHE2_MODULES APACHE2_MPMS CAMERAS CROSSCOMPILE_OPTS DVB_CARDS ELIBC FCDSL_CARDS FOO2ZJS_DEVICES FRITZCAPI_CARDS INPUT_DEVICES KERNEL LCD_DEVICES LINGUAS LIRC_DEVICES MISDN_CARDS NETBEANS_MODULES USERLAND VIDEO_CARDS"
USE_EXPAND_HIDDEN="CROSSCOMPILE_OPTS ELIBC KERNEL USERLAND"
USE_ORDER="env:pkg:conf:pkginternal:env.d"
VIDEO_CARDS="nouveau"
_="/usr/bin/emerge"




Comment 1


Sebastian Luther (few)





          2009-04-27 07:26:08 UTC
        

Does it continue after some minutes? Please provide the output of emerge -pqv cvs.




Comment 2


Ronald





          2009-04-27 07:46:59 UTC
        

(In reply to comment #1)
> Does it continue after some minutes? Please provide the output of emerge -pqv
> cvs.
> 

Sorry, I should have mentionend this because it did in the other bug. No, this one *completely* stops. It does not continue whatsoever. A process called conftest completely hogs the CPU when it hangs.

I kept it running for 30 minutes to be sure :)

Alpha ~ # emerge -pqv cvs
[ebuild  N    ] dev-util/cvs-1.12.12-r6  USE="crypt nls -doc -kerberos -pam -server" 




Comment 3


Sebastian Luther (few)





          2009-04-27 08:08:40 UTC
        

I have the same behaviour as in http://bugs.gentoo.org/show_bug.cgi?id=220040 . (running amd64)




Comment 4


Ronald





          2009-04-27 09:31:09 UTC
        

I'll throw in my package.use and package.keywords file which could help (or not). I'm thinking that the problem might be elsewhere or arch dependant (32 vs 64 bit) ???

>>><<<
cat /etc/portage/package.use
x11-base/xorg-server sdl xorg
x11-misc/xscreensaver jpeg
net-wireless/bluez-utils usb
x11-misc/xbindkeys tk
dev-java/sun-jre-bin alsa nsplugin
mail-client/claws-mail spell ssl
app-office/openoffice binfilter cups gstreamer java nsplugin
app-text/epdfview cups

media-sound/exaile alsa mad
dev-lang/python sqlite

media-video/ffmpeg aac alsa amr dirac encode gsm mp3 network schroedinger speex theora vorbis x264 xvid zlib
media-sound/easytag aac flac mp3 speex vorbis wavpack
media-sound/audacity alsa ffmpeg flac id3tag libsamplerate mp3 soundtouch twolame vamp vorbis

media-gfx/gimp alsa curl exif mng pdf png svg tiff wmf
app-text/poppler-bindings cairo

media-gfx/imagemagick bzip2 corefonts djvu fontconfig fpx graphviz gs hdri jbig jpeg jpeg2k openexr png raw svg tiff wmf zlib
media-sound/streamripper vorbis

media-gfx/mirage
x11-libs/gtk+ jpeg tiff jpeg2k

app-cdr/recorder dvdr
media-video/vlc a52 aac alsa cdda cddax cddb cdio dirac dts dvd dvdnav ffmpeg flac fontconfig id3tag libass libgcrypt live matroska mp3 mpeg musepack nsplugin ogg png rtsp samba schroedinger shout speex stream svg taglib theora twolame vcdinfo vcdx vorbis x264 xv
media-video/mplayer a52 aac alsa amrnb amrwb ass cddb cdio cdparanoia dirac dts dvd dvdnav enca encode ftp gif -gtk iconv jpeg live lzo mad md5sum mng mp2 mp3 musepack png pnm quicktime rar real rtc samba schroedinger speex theora vorbis x264 xv xvid xvmc
media-sound/mp3splt-gtk gstreamer
sys-power/suspend fbsplash
app-emulation/wine alsa cups gecko jpeg samba
app-emulation/virtualbox-ose alsa qt4
x11-misc/x11vnc jpeg ssl zlib
net-fs/samba async cups fam
net-ftp/vsftpd ssl
net-misc/tor bundledlibevent
net-proxy/privoxy zlib
#net-dns/pdnsd urandom
www-servers/lighttpd bzip2 fam ssl webdav
net-p2p/amule geoip
net-misc/openvpn ssl
net-misc/cadaver ssl
sys-apps/busybox -dynamic static
app-admin/conky hddtemp
#app-admin/conky hddtemp wifi
app-admin/gkrellm hddtemp

x11-misc/adesklets fontconfig python
media-libs/imlib2 gif jpeg png tiff
dev-lang/python ssl

net-print/cups jpeg png samba tiff
app-text/ghostscript-gpl cups
net-print/hplip cupsddk
net-print/foomatic-filters cups
x11-libs/gtk+ cups

# Fails otherwise XD
x11-libs/pixman -sse2
media-sound/alsa-utils midi
media-libs/alsa-lib midi
>>><<<

>>><<<
cat /etc/portage/package.keywords
=x11-misc/pcmanfm-0.5
=media-sound/mp3splt-gtk-0.5.2
=sys-power/suspend-0.8
=x11-misc/hsetroot-1.0.2
=media-libs/libmp3splt-0.5.2
=x11-misc/xdg-user-dirs-0.10
=app-cdr/recorder-1.4.1

=x11-misc/stalonetray-0.7.6
=sys-kernel/gentoo-sources-2.6.28-r5
=sys-kernel/linux-headers-2.6.28-r1

=app-emulation/virtualbox-ose-2.2.0
=app-emulation/virtualbox-modules-2.2.0
=app-emulation/virtualbox-ose-additions-2.2.0
=dev-util/kbuild-0.1.5-r1

#nodig voor tkdiff
=dev-lang/tk-8.4.18-r1

=x11-base/x11-drm-99999999 **
=x11-drivers/xf86-video-nouveau-9999 **
=x11-libs/libdrm-9999 **
>>><<<




Comment 5


SpanKY






          2009-05-19 03:00:27 UTC
        

most likely your system is messed up.  in the shell you're running the emerge (and thus see the hang), run `cat /proc/self/status` and post the output.  if SIGALRM is being blocked for some reason, this test will sleep for quite a while.




Comment 6


Ronald





          2009-05-19 06:15:58 UTC
        

(In reply to comment #5)
> most likely your system is messed up.  in the shell you're running the emerge
> (and thus see the hang), run `cat /proc/self/status` and post the output.  if
> SIGALRM is being blocked for some reason, this test will sleep for quite a
> while.
> 

I don't get it anymore, I tried again to check `cat /proc/self/status` and while figuring that out how to do that in the shell where emerge was running it suddenlycontinued. It took a little while (about 30 seconds) but this time it at least continued.

That will be one thing less to workaround during installation, anyways thanks :)




Comment 7


Ryan Hill (RETIRED)






          2011-07-09 09:22:49 UTC
        

The configure test is broken wrt signed overflow.  This was fixed in autoconf about 5 years ago.

See:
http://lists.gnu.org/archive/html/bug-gnulib/2006-12/msg00084.htmlhttp://lists.gnu.org/archive/html/bug-gnulib/2006-12/msg00084.html




Comment 8


Ryan Hill (RETIRED)






          2011-07-09 09:23:46 UTC
        

Created attachment 279489 [details, diff]
cvs-1.12.12-mktime-overflow.patch




Comment 9


Ryan Hill (RETIRED)






          2011-12-23 02:58:22 UTC
        

Wrong bug.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

