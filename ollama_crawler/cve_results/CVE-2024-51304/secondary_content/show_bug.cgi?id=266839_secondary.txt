Title: 266839 – sys-apps/qingy-0.9.7: GUI not working with dev-libs/DirectFB-1.2.7
URL: https://bugs.gentoo.org/show_bug.cgi?id=266839

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 266839
sys-apps/qingy-0.9.7: GUI not working with dev-libs/DirectFB-1.2.7
Last modified: 2010-03-11 16:07:47 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 266839 
      - sys-apps/qingy-0.9.7: GUI not working with dev-libs/DirectFB-1.2.7


Summary:
sys-apps/qingy-0.9.7: GUI not working with dev-libs/DirectFB-1.2.7
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Unspecified

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Michele Noberasco (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-04-20 10:26 UTC by Dustin Polke





      Modified:
    
2010-03-11 16:07 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



base-system









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




qingy-0.9.9.ebuild.diff

              (qingy-0.9.9.ebuild.diff,2.78 KB,
                patch)

            
2010-02-23 15:38 UTC,

            Dustin Polke




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Dustin Polke





          2009-04-20 10:26:43 UTC
        

After update to DirectFB-1.2.7, qingy's GUI stopped working. I just get a blank screen and only working key is the power button to shutdown the system. If I switch during boot to a tty configured not to run qingy, I can log into my box. ssh works as well. 

I recompiled qingy after updating DirectFB as well. Downgrading DirectFB to 1.2.6 and recompiling qingy yields a fully working GUI.

Here is the relevant part of the debug log:
Apr 20 12:15:20 legolas qingy(tty1)[15478]: You chose a screen saver timeout of 5 minutes.
Apr 20 12:15:20 legolas qingy(tty1)[15478]: You chose a screen power management timeout of 30 minutes.
Apr 20 12:15:20 legolas qingy(tty1)[15478]: Added '/home/dustin/Photos/USA200705' to screen saver options...
Apr 20 12:15:20 legolas qingy(tty1)[15478]: added keybinding: 'win' will switch to left tty...
Apr 20 12:15:20 legolas qingy(tty1)[15478]: added keybinding: 'menu' will switch to right tty...
Apr 20 12:15:20 legolas qingy(tty1)[15478]: added keybinding: 'ALT-p' will poweroff machine...
Apr 20 12:15:20 legolas qingy(tty1)[15478]: added keybinding: 'ALT-r' will reboot machine...
Apr 20 12:15:20 legolas qingy(tty1)[15478]: added keybinding: 'ALT-s' will activate screen saver...
Apr 20 12:15:20 legolas qingy(tty1)[15478]: added keybinding: 'ALT-z' will put machine to sleep...
Apr 20 12:15:20 legolas qingy(tty1)[15478]: added keybinding: 'CTRL-ESC' will revert to text mode...
Apr 20 12:15:20 legolas qingy(tty1)[15478]: The following logging facilities will be used: FILE SYSLOG 
Apr 20 12:15:20 legolas qingy(tty1)[15478]: Session locking is NOT enabled.
Apr 20 12:15:20 legolas qingy(tty1)[15478]: Native theme resolution is '1024x768'
Apr 20 12:15:20 legolas qingy(tty1)[15478]: Framebuffer resolution is '1024x768'.
Apr 20 12:15:20 legolas qingy(tty1)[15478]: firing up GUI
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: You chose a screen saver timeout of 5 minutes.
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: You chose a screen power management timeout of 30 minutes.
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: Added '/home/dustin/Photos/USA200705' to screen saver options...
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: added keybinding: 'win' will switch to left tty...
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: added keybinding: 'menu' will switch to right tty...
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: added keybinding: 'ALT-p' will poweroff machine...
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: added keybinding: 'ALT-r' will reboot machine...
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: added keybinding: 'ALT-s' will activate screen saver...
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: added keybinding: 'ALT-z' will put machine to sleep...
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: added keybinding: 'CTRL-ESC' will revert to text mode...
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: The following logging facilities will be used: FILE SYSLOG 
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: Session locking is NOT enabled.
Apr 20 12:15:20 legolas qingy-DirectFB([15505]: redirected stderr to logging facilities...
Apr 20 12:15:21 legolas qingy-DirectFB([15506]:    ~~~~~~~~~~~~~~~~~~~~~~~~~~| DirectFB 1.2.7 |~~~~~~~~~~~~~~~~~~~~~~~~~~
Apr 20 12:15:21 legolas qingy-DirectFB([15506]:         (c) 2001-2008  The world wide DirectFB Open Source Community
Apr 20 12:15:21 legolas qingy-DirectFB([15506]:         (c) 2000-2004  Convergence (integrated media) GmbH
Apr 20 12:15:21 legolas qingy-DirectFB([15506]:       ----------------------------------------------------------------
Apr 20 12:15:21 legolas qingy-DirectFB([15506]: (*) DirectFB/Core: Single Application Core. (2009-04-20 09:51) 
Apr 20 12:15:21 legolas qingy-DirectFB([15506]: (*) Direct/Memcpy: Using Generic 64bit memcpy()
Apr 20 12:15:21 legolas qingy-DirectFB([15506]: (*) Direct/Thread: Started 'Keyboard Input' (-1) [INPUT OTHER/OTHER 0/0] <8388608>...
Apr 20 12:15:21 legolas qingy-DirectFB([15506]: (*) DirectFB/Input: Keyboard 0.9 (directfb.org)
Apr 20 12:15:21 legolas qingy-DirectFB([15506]: (*) DirectFB/Genefx: MMX detected and enabled
Apr 20 12:15:21 legolas qingy-DirectFB([15506]: (!) [15505:    0.000] --> Caught signal 6 (unknown origin) <--


Reproducible: Always

Steps to Reproduce:
1. Update to DirectFB-1.2.7
2. Recompile qingy-0.9.7
3. restart




Portage 2.1.6.7 (default/linux/amd64/2008.0, gcc-4.3.2, glibc-2.8_p20080602-r1, 2.6.26-gentoo_dazuko-patch-r4-stable x86_64)
=================================================================
System uname: Linux-2.6.26-gentoo_dazuko-patch-r4-stable-x86_64-Intel-R-_Core-TM-2_Duo_CPU_T8100_@_2.10GHz-with-glibc2.2.5
Timestamp of tree: Mon, 20 Apr 2009 07:45:01 +0000
app-shells/bash:     3.2_p39
dev-java/java-config: 2.1.7
dev-lang/python:     2.5.4-r2
dev-python/pycrypto: 2.0.1-r8
dev-util/cmake:      2.6.2-r1
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core2 -O2 -pipe -msse4.1 -ggdb"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/bin/mygenkernel /usr/sbin/run-crons /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/sandbox.d /etc/splash /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-march=core2 -O2 -pipe -msse4.1 -ggdb"
DISTDIR="/usr/portage/distfiles"
FEATURES="collision-protect distlocks fixpackages multilib-strict parallel-fetch protect-owned sandbox sfperms splitdebug strict test unmerge-orphans userfetch userpriv usersandbox"
GENTOO_MIRRORS="ftp://linux.rz.ruhr-uni-bochum.de/gentoo-mirror/                ftp://gd.tuwien.ac.at/opsys/linux/gentoo/               ftp://gentoo.inode.at/source/           ftp://ftp-stud.fht-esslingen.de/pub/Mirrors/gentoo/"
LANG="C"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en de"
MAKEOPTS="-j5"
PKGDIR="/home/ftp/binpkg/"
PORTAGE_COMPRESS=""
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_EXTRA_OPTS="--timeout=500"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/portage/local/modified /usr/portage/local/own /usr/portage/local/layman/alon-barlev /usr/portage/local/layman/science /usr/portage/local/layman/desktop-effects /usr/portage/local/layman/sunrise"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="X X509 Xaw3d a52 aac aalib accessibility acl acpi alsa amd64 amr amrnb amrr amrwb apm async audacious audiofile bash-completion battery berkdb bindist bl bluetooth branding bzip2 cairo cardbus cdinstall cjk cli cpufreq cracklib crypt css ctype cups dbus dga directfb divx dri dts dv dvd dvdr dvdread eds encode evo exif exiv2 fam fame fbcon fbcondecor fbsplash ffmpeg flac fontforge foomaticdb force-cgi-redirect fortran ftp gd gdbm gif gimp glade glitz gmedia gmp gnutls gphoto2 gs gsm gstreamer gtk gtkhtml guile hal hddtemp hdf5 iconv icq icu idn ieee1394 imagemagick imap imlib iproute2 isdnlog jack java javascript jikes jpeg jpeg2k kerberos keyscrub kino kpathsea lame laptop latex lcms ldap libcaca libnotify libsamplerate libsexy libv4l2 libwww live lm_sensors logrotate loop-aes lzma lzo mad memlimit midi mikmod mime mjpeg mmx mmxext mng mono motif mp2 mp3 mp4 mpeg mplayer mudflap multilib musepack ncurses nls nntp nowin nptl nptlonly nsplugin ntp nuv nvidia ogg opengl openmp opensslcrypto pam pch pcmcia pcre pda pdf perl plotutils png posix ppds pppd print python quicktime readline realmedia reflection rtsp ruby rubytests samba sasl sdl server session simplexml slang sndfile soap sockets sou speex spell spl sse sse2 sse3 sse4.1 ssl ssse3 startup-notification stream svg swat sysfs syslog tcpd tetex tga theora threads tiff truetype unicode usb userlocales v4l v4l2 vcd vim-syntax vim-with-x vorbis wifi winbind wma wmf wmp wxwindows x264 xanim xcomposite xfce xinetd xml xmp xorg xpm xsl xulrunner xv xvid xvmc zlib" ALSA_CARDS="hda-intel mpu401" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CAMERAS="fuji ptp2" ELIBC="glibc" INPUT_DEVICES="keyboard evdev synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en de" USERLAND="GNU" VIDEO_CARDS="nvidia"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LC_ALL, PORTAGE_COMPRESS_FLAGS




Comment 1


Michele Noberasco (RETIRED)






          2009-04-27 12:56:20 UTC
        

I cannot reproduce your issue, qingy is running fine here with DirectFB 1.2.7.
Make sure you reemerge qingy against the new version of DirectFB...




Comment 2


Dustin Polke





          2009-04-27 16:00:01 UTC
        

(In reply to comment #1)
> I cannot reproduce your issue, qingy is running fine here with DirectFB 1.2.7.
> Make sure you reemerge qingy against the new version of DirectFB...

As I stated before, I did recompile qingy after updating to DirectFB-1.2.7.
Don't know how to investigate this further. If you can give me some directions, I will try things out. Otherwise I keep DirectFB-1.2.7 masked.

BTW, could it be connected with the kernel I am using? I have not updated to latest stable because I need dazuko which supports only kernels up to 2.6.26.




Comment 3


Dustin Polke





          2009-06-02 08:01:47 UTC
        

Update: I am using now gentoo-sources-2.6.28-gentoo-r5, qingy-0.9.9 and DirectFB-1.2.7 without any issue yet. I don't know what caused the failure before, but for me this issue is FIXED.

I suggest to mark qingy-0.9.9 stable as soon as possible. It'll be 30 days in tree in 10 days from now and atm there are no bugs against 0.9.9.

Michele, if you agree, feel free to recycle this bug as stabilization tracker later on.

BR,
Dustin




Comment 4


Michele Noberasco (RETIRED)






          2009-06-08 13:26:51 UTC
        

(In reply to comment #3)
> Michele, if you agree, feel free to recycle this bug as stabilization tracker
> later on.
Agreed ;-)




Comment 5


Dustin Polke





          2009-06-17 17:27:44 UTC
        

(In reply to comment #4)
> (In reply to comment #3)
> > Michele, if you agree, feel free to recycle this bug as stabilization tracker
> > later on.
> Agreed ;-)

Michele, get this rolling then?




Comment 6


Michele Noberasco (RETIRED)






          2009-06-18 07:21:13 UTC
        

(In reply to comment #5)
> Michele, get this rolling then?
As soon as possible... I'm abroad with limited connectivity (http proxy only) until next week...




Comment 7


Dustin Polke





          2009-07-07 15:12:31 UTC
        

Some update here concerning restricted USE="X":

qingy[X] works together with DirectFB[X,fusion] on my box on first view without problem.

However, DirectFB does not work with linux-fusion-8.1.1 which is in portage tree due to API change. I am using linux-fusion-8.0.3 right now. Will file a seperate bug because DirectFB-1.2.7 does not DEPEND on linux-fusion with USE="fusion" yet.

BR,
Dustin




Comment 8


Dustin Polke





          2009-07-07 18:36:56 UTC
        

(In reply to comment #7)
> Some update here concerning restricted USE="X":

Sorry for the noise, just forget about that.

I was playing around with that hoping to get rid of some annoyances (keyboard layout was sometimes b0rked in xfce4 started from qingy but not from console with startx). But it became worse, pressing left ctrl key results in X session crash returning to qingy login screen. I finally downgraded to qingy-0.9.7 and DirectFB-1.2.7 and with gentoo-sources-2.6.28-r5 everything is fine now.

Concerning original bug, this seems to be fixed right now, but I am afraid that this is in a very fragile state right now...

Since qingy-0.9.9 introduced crashing X session while qingy-0.9.8 behaves fine, I would not abide pushing 0.9.9 to stable soon.




Comment 9


Michele Noberasco (RETIRED)






          2010-02-23 11:09:17 UTC
        

Sorry about my (lack of) timely updates, free time is really getting short for me :-(
Any news on this one? I still can't reproduce the issue, and have qingy 0.9.9 working fine along with DirectFB 1.2.7 and X USE flag enabled. And I have no problems with qingy started X sessions....




Comment 10


Dustin Polke





          2010-02-23 15:32:43 UTC
        

(In reply to comment #9)
> Sorry about my (lack of) timely updates, free time is really getting short for
> me :-(
> Any news on this one? I still can't reproduce the issue, and have qingy 0.9.9
> working fine along with DirectFB 1.2.7 and X USE flag enabled. And I have no
> problems with qingy started X sessions....

I unmask qingy-0.9.9 and compiled it against current stable DirectFB-1.4.2.
At the moment, I cannot see any problems with this configuration. I tested as well qingy-0.9.9 with DirectFB-1.4.2[X] which works again for me.
I reworked a bit the ebuild to use EAPI="2" for USE deps while doing my tests.
As DirectFB-1.2.{6,7} have left the tree, maybe remove support for these versions conmpletely.

Further, I would just warn about openssl and opensslcrypt useflag being set together and then fall-back to the more preferred implementation.

I will attach a diff to your original ebuild for consideration.

Dustin





Comment 11


Dustin Polke





          2010-02-23 15:38:22 UTC
        

Created attachment 220847 [details, diff]
qingy-0.9.9.ebuild.diff




Comment 12


Michele Noberasco (RETIRED)






          2010-03-11 16:07:47 UTC
        

Applied your changes to qingy 0.9.9 ebuild. Thanks for your efforts :-)
About this bug, I think it can not be closed...









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

