Title: 90569 – app-office/abiword-2.2.5 crashes on "format->paragraph" menu option
URL: https://bugs.gentoo.org/show_bug.cgi?id=90569

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 90569
app-office/abiword-2.2.5 crashes on "format->paragraph" menu option
Last modified: 2005-11-02 02:25:42 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 90569 
      - app-office/abiword-2.2.5 crashes on "format->paragraph" menu option


Summary:
app-office/abiword-2.2.5 crashes on "format->paragraph" menu option
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

GNOME Office (OBSOLETE)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-04-26 20:11 UTC by postmodern





      Modified:
    
2005-11-02 02:25 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



coredumb
miltondp









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




This patch seems to correct the problem. Please check it.

              (2.2.8-format-paragraph.patch,3.68 KB,
                patch)

            
2005-06-28 20:07 UTC,

            João Rafael Moraes Nicola




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


postmodern





          2005-04-26 20:11:01 UTC
        

app-office/abiword-2.2.5 crashes on "format->paragraph" menu option.

Reproducible: Always
Steps to Reproduce:
1. Select the menu option Format -> Paragraph
2.
3.

Actual Results:  
Abort.

Expected Results:  
Me being able to format my 5-6 page paper to double spaced paragraphs.

Gentoo Base System version 1.4.16
Portage 2.0.51.19 (default-linux/amd64/2004.3, gcc-3.4.3,
glibc-2.3.4.20041102-r1, 2.6.11-gentoo-r6 x86_64)
=================================================================
System uname: 2.6.11-gentoo-r6 x86_64 AMD Athlon(tm) 64 Processor 3400+
Python:              dev-lang/python-2.3.4-r1 [2.3.4 (#1, Feb  7 2005, 03:24:22)]
dev-lang/python:     2.3.4-r1
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.4
sys-devel/binutils:  2.15.92.0.2-r7
sys-devel/libtool:   1.5.14
virtual/os-headers:  2.6.8.1-r4
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-pipe -O3 -march=k8"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-pipe -O3 -march=k8"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org
http://distro.ibiblio.org/pub/Linux/distributions/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X aac acpi alsa berkdb bitmap-fonts cdr crypt curl dvd encode esd fam
flac font-server fortran gif gpm gstreamer gtk gtk2 imlib ipv6 java jp2 jpeg lzw
lzw-tiff mad motif mp3 multilib ncurses network nls ogg oggvorbis opengl pam
perl png python readline samba sdl softmmu speex spell sqlite ssl tcpd theora
tiff truetype truetype-fonts type1-fonts usb userlocales vorbis xml xml2 xpm
xrandr xv zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


postmodern





          2005-04-26 20:25:08 UTC
        

Upgrading to abiword-2.2.7 does not resolve the issue.




Comment 2


Simon Stelling (RETIRED)






          2005-04-27 00:41:06 UTC
        

i can confirm that:

 $ abiword-2.2
*** glibc detected *** corrupted double-linked list: 0x000000000116afa0 ***
Killed

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 46912585101504 (LWP 7384)]
0x00002aaaae9b3b4c in free () from /lib/tls/libc.so.6
(gdb) bt
#0  0x00002aaaae9b3b4c in free () from /lib/tls/libc.so.6
#1  0x00002aaaae9b5192 in malloc () from /lib/tls/libc.so.6
#2  0x00002aaaada56799 in fribidi_set_debug () from /usr/lib/libfribidi.so.0
#3  0x00002aaaada57297 in fribidi_log2vis () from /usr/lib/libfribidi.so.0
#4  0x0000000000602951 in UT_bidiReorderString ()
#5  0x000000000056b64f in AP_Preview_Paragraph::_appendLine ()
#6  0x000000000056b3ef in AP_Preview_Paragraph::_appendBlock ()
#7  0x000000000056b003 in AP_Preview_Paragraph::draw ()
#8  0x0000000000711cbb in AP_UnixDialog_Paragraph::_syncControls ()
#9  0x0000000000711c0c in AP_UnixDialog_Paragraph::runModal ()
#10 0x000000000051e6c4 in ap_EditMethods::dlgParagraph ()
#11 0x000000000061a0c9 in EV_EditMethod::Fn ()
#12 0x000000000061b768 in EV_Menu::invokeMenuMethod ()
#13 0x000000000061ead1 in EV_UnixMenu::menuEvent ()
#14 0x00002aaaad15305a in g_closure_invoke () from /usr/lib/libgobject-2.0.so.0
#15 0x00002aaaad166aca in g_signal_has_handler_pending () from /usr/lib/libgobject-2.0.so.0
#16 0x00002aaaad1679be in g_signal_emit_valist () from /usr/lib/libgobject-2.0.so.0
#17 0x00002aaaad167d23 in g_signal_emit () from /usr/lib/libgobject-2.0.so.0
#18 0x00002aaaac3d4142 in gtk_widget_activate () from /usr/lib/libgtk-x11-2.0.so.0
#19 0x00002aaaac304f60 in gtk_menu_shell_activate_item () from /usr/lib/libgtk-x11-2.0.so.0
#20 0x00002aaaac30526b in gtk_menu_shell_activate_item () from /usr/lib/libgtk-x11-2.0.so.0
#21 0x00002aaaac2f68e6 in gtk_marshal_VOID__UINT_STRING () from /usr/lib/libgtk-x11-2.0.so.0
#22 0x00002aaaad15305a in g_closure_invoke () from /usr/lib/libgobject-2.0.so.0
#23 0x00002aaaad16662f in g_signal_has_handler_pending () from /usr/lib/libgobject-2.0.so.0
#24 0x00002aaaad167723 in g_signal_emit_valist () from /usr/lib/libgobject-2.0.so.0
#25 0x00002aaaad167d23 in g_signal_emit () from /usr/lib/libgobject-2.0.so.0
#26 0x00002aaaac3d42a0 in gtk_widget_activate () from /usr/lib/libgtk-x11-2.0.so.0
#27 0x00002aaaac2f4cd1 in gtk_propagate_event () from /usr/lib/libgtk-x11-2.0.so.0
#28 0x00002aaaac2f500c in gtk_main_do_event () from /usr/lib/libgtk-x11-2.0.so.0
---Type <return> to continue, or q <return> to quit---
#29 0x00002aaaaca6edc0 in gdk_event_get_graphics_expose () from /usr/lib/libgdk-x11-2.0.so.0
#30 0x00002aaaad4b30f5 in g_main_context_dispatch () from /usr/lib/libglib-2.0.so.0
#31 0x00002aaaad4b4bd5 in g_main_context_acquire () from /usr/lib/libglib-2.0.so.0
#32 0x00002aaaad4b4f5a in g_main_loop_run () from /usr/lib/libglib-2.0.so.0
#33 0x00002aaaac2f44f1 in gtk_main () from /usr/lib/libgtk-x11-2.0.so.0
#34 0x000000000050b300 in AP_UnixApp::main ()
#35 0x00002aaaae9677b8 in __libc_start_main () from /lib/tls/libc.so.6
#36 0x000000000050737a in _start ()
#37 0x00007ffffffff3b8 in ?? ()
#38 0x000000000000001c in ?? ()
#39 0x0000000000000001 in ?? ()

?? () continues up to #430




Comment 3


Alessio D'Ascanio





          2005-05-03 00:50:24 UTC
        

more info about this bug at
http://bugzilla.abisource.com/show_bug.cgi?id=8685




Comment 4


João Rafael Moraes Nicola





          2005-06-28 11:53:22 UTC
        

I am also experiencing this error in 2.2.7 and 2.2.8. It occurs even in a new
(clean) document. I'll try to get a stack trace. However, the program does not
crash but locks up.

Portage 2.0.51.19 (default-linux/amd64/2005.0, gcc-3.4.3,
glibc-2.3.4.20041102-r1, 2.6.11-gentoo-r11 x86_64)
=================================================================
System uname: 2.6.11-gentoo-r11 x86_64 AMD Athlon(tm) 64 Processor 3000+
Gentoo Base System version 1.6.12
Python:              dev-lang/python-2.3.5 [2.3.5 (#1, Jun 18 2005, 23:17:20)]
ccache version 2.3 [enabled]
dev-lang/python:     2.3.5
sys-apps/sandbox:    [Not Present]
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.7.9-r1, 1.8.5-r3, 1.5, 1.4_p6, 1.6.3, 1.9.5
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.16
virtual/os-headers:  2.6.8.1-r4
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CFLAGS="-O3 -march=athlon64 -pipe -fomit-frame-pointer -funit-at-a-time
-ffast-math -funroll-loops -fpeel-loops -funswitch-loops -fprefetch-loop-arrays
-frerun-loop-opt -frerun-cse-after-loop"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.3/env
/usr/kde/3.3/share/config /usr/kde/3.3/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config
/usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/
/usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/
/usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=athlon64 -pipe -fomit-frame-pointer -funit-at-a-time
-ffast-math -funroll-loops -fpeel-loops -funswitch-loops -fprefetch-loop-arrays
-frerun-loop-opt -frerun-cse-after-loop"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distcc distlocks sandbox sfperms strict"
GENTOO_MIRRORS="ftp://130.59.10.34/mirror/gentoo/
http://130.59.10.35/mirror/gentoo/ http://130.59.10.34/mirror/gentoo/
ftp://130.59.10.35/mirror/gentoo/"
LANG="pt_BR.UTF-8"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X acpi alsa amd64 arts berkdb bitmap-fonts cdr crypt eds esd fam floppyd
font-server fortran freetype gdbm gif gimpprint gmp gnome gpgme gpm graphviz
gstreamer gtk gtk2 ieee1394 imagemagick imap imlib ipv6 java javascript jce
jikes jp2 jpeg libwww lm_sensors ltsp lzw lzw-tiff maildir mdb mime mozilla mp3
mysql ncurses nls nptl ntlm odbc ofx opengl oss pam pcre perl png postgres
python qt quotas readline reiserfs rpc samba smime spell ssh ssl svg sysfs tcpd
tetex tidy tiff truetype truetype-fonts type1-fonts unicode ups usb userlocales
utf8 vim vim-pager vim-with-x wxwindows xml2 xpm xrandr xv zlib userland_GNU
kernel_linux elibc_glibc"
Unset:  ASFLAGS, CBUILD, CTARGET, LC_ALL, LDFLAGS, LINGUAS





Comment 5


João Rafael Moraes Nicola





          2005-06-28 20:07:49 UTC
        

Created attachment 62215 [details, diff]
This patch seems to correct the problem. Please check it.

This patch corrected my abiword-2.2.8, and it is based on a patch I found
somewhere (form fribidi) and the CVS head of abiword at AbiSource. Since I
don't have much experience with diff and with ebuilds, someone should check it
before using it at a ebuild.




Comment 6


foser (RETIRED)






          2005-07-02 05:20:58 UTC
        

what we probably need to do is add fribidi-0.10.5 (iirc) to get the fixed
fribidi. Now fribidi is not gnome herded, so coredumb, if you could have a look ?




Comment 7


Milton Pividori





          2005-08-23 08:41:57 UTC
        

why fribidi 0.10.4 is available as the only choice? why don't you update to
0.10.5? abiword is still crashing...




Comment 8


postmodern





          2005-08-25 21:29:19 UTC
        

app-office/abiword-2.2.8-r1 has improved a bit. A minor bug about the width of
the spellcheck dialog box was fixed, and the Format->Paragraph window actually
appears but it's contents fails to appear.




Comment 9


postmodern





          2005-08-25 22:01:08 UTC
        

I should clarify that now abiword-2.2.8-r1 (with debugging options and symbols)
outputs this to stdout when invoking "Format->Paragraph".

**** (1) Assert ****
**** (1) sizeof(UT_UCS4Char) == sizeof(FriBidiChar) at ut_string.cpp:1601 ****
**** (1) Continue ? (y/n) [y] : 

After answering y the window pops up and a glibc malloc() error occures, thus
rendering the window as half-drawn grey and white.

*** glibc detected *** malloc(): memory corruption: 0x0000000001101a50 ***

A backgtrace of the error follows...

#0  0x00002aaaaebecc09 in kill () from /lib/libc.so.6
#1  0x00002aaaac89f891 in pthread_kill () from /lib/libpthread.so.0
#2  0x00002aaaac89fc12 in raise () from /lib/libpthread.so.0
#3  0x00002aaaaebec902 in raise () from /lib/libc.so.6
#4  0x00002aaaaebedc42 in abort () from /lib/libc.so.6
#5  0x00002aaaaec1ff8e in __fsetlocking () from /lib/libc.so.6
#6  0x00002aaaaec24e60 in malloc_usable_size () from /lib/libc.so.6
#7  0x00002aaaaec25ee5 in free () from /lib/libc.so.6
#8  0x00002aaaaec27702 in malloc () from /lib/libc.so.6
#9  0x00002aaaae1ecd24 in XftFontCheckGlyph () from /usr/lib/libXft.so.2
#10 0x00002aaaae1ed1e4 in XftGlyphRender () from /usr/lib/libXft.so.2
#11 0x00002aaaae1e7089 in XftDrawGlyphs () from /usr/lib/libXft.so.2
#12 0x00002aaaae1e73fc in XftDrawString32 () from /usr/lib/libXft.so.2
#13 0x000000000066dc88 in GR_UnixGraphics::drawChars (this=0x10ffa50, 
    pChars=0x1101240, iCharOffset=0, iLength=8, xoff=12, yoff=6, 
    pCharWidths=0x0) at gr_UnixGraphics.cpp:852
#14 0x0000000000581108 in AP_Preview_Paragraph::_appendLine (this=0x11003a0, 
    words=0x1100570, widths=0x1100590, startWithWord=0, left=720, right=8, 
    align=align_LEFT, y=100) at ap_Preview_Paragraph.cpp:763
#15 0x0000000000580d48 in AP_Preview_Paragraph::_appendBlock (this=0x11003a0, 
    block=0x1100530) at ap_Preview_Paragraph.cpp:613
#16 0x0000000000580994 in AP_Preview_Paragraph::draw (this=0x11003a0)
    at ap_Preview_Paragraph.cpp:526
#17 0x00000000007b2bc9 in AP_UnixDialog_Paragraph::_syncControls (
    this=0x10dccb0, changed=id_MENU_ALIGNMENT, bAll=true)
    at ap_UnixDialog_Paragraph.cpp:1099

The backtrace was edited to function call #17 since it goes on seemingly for ever.




Comment 10


Pacho Ramos






          2005-10-05 09:40:29 UTC
        

Have you tried to use the latest abiword (2.2.10)?

Please, notify us your results with this version for close, if it's fixed, this bug

Thanks a lot :)




Comment 11


Milton Pividori





          2005-10-05 09:51:29 UTC
        

I compiled and installed Abiword 2.2.10, and it is still crashing.

$ emerge --info
Portage 2.0.51.22-r2 (default-linux/amd64/2005.1, gcc-3.4.4, glibc-2.3.5-r1,
2.6.12-gentoo-r10 x86_64)
=================================================================
System uname: 2.6.12-gentoo-r10 x86_64 AMD Athlon(tm) 64 Processor 2800+
Gentoo Base System version 1.6.13
ccache version 2.3 [enabled]
dev-lang/python:     2.3.5-r2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.18-r1
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3.4/env
/usr/kde/3.4/share/config /usr/kde/3.4/shutdown /usr/kde/3/share/config
/usr/lib/X11/xkb /usr/lib64/mozilla/defaults/pref /usr/share/config
/var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=k8 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg ccache distlocks fixpackages sandbox sfperms strict"
GENTOO_MIRRORS="http://distro.ibiblio.org/pub/linux/distributions/gentoo/
http://www.las.ic.unicamp.br/pub/gentoo/"
LANG="en_US"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.us.gentoo.org/gentoo-portage"
USE="amd64 X alsa apache2 avi berkdb bitmap-fonts cdr crypt cups curl dvd dvdr
eds emboss encode esd fam foomaticdb fortran gif gimpprint gnome gpm gstreamer
gtk gtk2 hal howl imagemagick imlib ipv6 java jpeg libwww lzw lzw-tiff mad
mozilla mp3 mpeg mysql ncurses nls nvidia ogg oggvorbis opengl pam pdflib perl
png postgres python quicktime readline sdl spell ssl tcpd tiff truetype
truetype-fonts type1-fonts usb userlocales vorbis xine xml xml2 xpm xv xvid zlib
userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LC_ALL, LDFLAGS, LINGUAS, MAKEOPTS, PORTDIR_OVERLAY





Comment 12


Matthew Hamilton





          2005-10-15 15:37:28 UTC
        

I submitted a bug to update fribidi to 0.15 a month or so ago, and it has since
been placed in portage. Updating to >=0.15 will solve this problem. I've only
tested on amd64, where it would crash for me every time before the update to
fribidi.




Comment 13


Mike Gardiner (RETIRED)






          2005-11-02 02:25:42 UTC
        

This looks fixed to me with Abiword 2.2.11 and either fribidi-0.10.5 or
fribidi-0.10.4.

Please upgrade and reopen if the problem still exists.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

