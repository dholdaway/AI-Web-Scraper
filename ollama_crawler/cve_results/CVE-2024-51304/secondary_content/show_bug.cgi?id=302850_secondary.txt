Title: 302850 – Emerge fails for update world and some others
URL: https://bugs.gentoo.org/show_bug.cgi?id=302850

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 302850
Emerge fails for update world and some others
Last modified: 2010-01-31 06:25:39 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 302850 
      - Emerge fails for update world and some others


Summary:
Emerge fails for update world and some others
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-01-30 08:57 UTC by Aydın Tarık Zengin





      Modified:
    
2010-01-31 06:25 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



serkan









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Aydın Tarık Zengin





          2010-01-30 08:57:02 UTC
        

Emerge update fails for world and some extra packages. Works fine for system and lots for others. I can't say specific packages because I can't see the entire update list. 

Reproducible: Always

Steps to Reproduce:
1. emerge -avu world
2. emerge -avu mozilla-firefox (just an example)
3.

Actual Results:  
# emerge -avu world

These are the packages that would be merged, in order:

Calculating dependencies... done!
Traceback (most recent call last):
  File "/usr/bin/emerge", line 40, in <module>
    retval = _emerge.emerge_main()            
  File "/usr/lib/portage/pym/_emerge/__init__.py", line 15814, in emerge_main
    myopts, myaction, myfiles, spinner)                                      
  File "/usr/lib/portage/pym/_emerge/__init__.py", line 14742, in action_build
    favorites=favorites)                                                      
  File "/usr/lib/portage/pym/_emerge/__init__.py", line 8296, in display      
    useflags=pkg_use, debug=self.edebug)                                      
  File "/usr/lib/portage/pym/portage/dbapi/porttree.py", line 731, in getfetchsizes
    mf = Manifest(pkgdir, self.mysettings["DISTDIR"])                              
  File "/usr/lib/portage/pym/portage/manifest.py", line 111, in __init__           
    self._read()                                                                   
  File "/usr/lib/portage/pym/portage/manifest.py", line 153, in _read              
    self._readManifest(self.getFullname(), myhashdict=self.fhashdict)              
  File "/usr/lib/portage/pym/portage/manifest.py", line 141, in _readManifest      
    self._parseDigests(fd, myhashdict=myhashdict, **kwargs)                        
  File "/usr/lib/portage/pym/portage/manifest.py", line 173, in _parseDigests      
    for myentry in self._parseManifestLines(mylines):                              
  File "/usr/lib/portage/pym/portage/manifest.py", line 163, in _parseManifestLines
    myentry = parser(mysplit)                                                      
  File "/usr/lib/portage/pym/portage/manifest.py", line 54, in parseManifest2      
    mysize = int(mysplit[2])                                                       
ValueError: invalid literal for int() with base 10: 'ChangeLog'

emerge -avu mozilla-firefox

These are the packages that would be merged, in order:

Calculating dependencies... done!
Traceback (most recent call last):
  File "/usr/bin/emerge", line 40, in <module>
    retval = _emerge.emerge_main()
  File "/usr/lib/portage/pym/_emerge/__init__.py", line 15814, in emerge_main
    myopts, myaction, myfiles, spinner)
  File "/usr/lib/portage/pym/_emerge/__init__.py", line 14742, in action_build
    favorites=favorites)
  File "/usr/lib/portage/pym/_emerge/__init__.py", line 8296, in display
    useflags=pkg_use, debug=self.edebug)
  File "/usr/lib/portage/pym/portage/dbapi/porttree.py", line 731, in getfetchsizes
    mf = Manifest(pkgdir, self.mysettings["DISTDIR"])
  File "/usr/lib/portage/pym/portage/manifest.py", line 111, in __init__
    self._read()
  File "/usr/lib/portage/pym/portage/manifest.py", line 153, in _read
    self._readManifest(self.getFullname(), myhashdict=self.fhashdict)
  File "/usr/lib/portage/pym/portage/manifest.py", line 141, in _readManifest
    self._parseDigests(fd, myhashdict=myhashdict, **kwargs)
  File "/usr/lib/portage/pym/portage/manifest.py", line 173, in _parseDigests
    for myentry in self._parseManifestLines(mylines):
  File "/usr/lib/portage/pym/portage/manifest.py", line 163, in _parseManifestLines
    myentry = parser(mysplit)
  File "/usr/lib/portage/pym/portage/manifest.py", line 54, in parseManifest2
    mysize = int(mysplit[2])
ValueError: invalid literal for int() with base 10: 'ChangeLog'

As an example, it works fine for pykde4 and also emerge -avu system

emerge -avu kde-base/pykde4

These are the packages that would be merged, in order:

Calculating dependencies... done!
[ebuild     U ] kde-base/pykde4-4.3.5-r1 [4.3.5] USE="semantic-desktop -akonadi (-aqua) -debug -doc -examples (-kdeenablefinal) (-kdeprefix) -policykit" 0 kB

Total: 1 package (1 upgrade), Size of downloads: 0 kB

Would you like to merge these packages? [Yes/No]

-------------------------

emerge -avu system

These are the packages that would be merged, in order:

Calculating dependencies... done!

Total: 0 packages, Size of downloads: 0 kB

Nothing to merge; would you like to auto-clean packages? [Yes/No]

There is no package to upgrade here but it works fine, tried before.


Expected Results:  
A successful upgrade

emerge --info
Portage 2.1.7.16 (default/linux/x86/10.0, gcc-4.2.4, glibc-2.10.1-r1, 2.6.30-gentoo-r4 i686)
=================================================================                           
System uname: Linux-2.6.30-gentoo-r4-i686-Intel-R-_Core-TM-2_Duo_CPU_T7250_@_2.00GHz-with-gentoo-1.12.13
Timestamp of tree: Thu, 28 Jan 2010 17:15:02 +0000                                                      
distcc 3.1 i686-pc-linux-gnu [enabled]                                                                  
ccache version 2.4 [enabled]                                                                            
app-shells/bash:     4.0_p35                                                                            
dev-java/java-config: 1.3.7-r1, 2.1.10                                                                  
dev-lang/python:     2.4.6, 2.5.4-r3, 2.6.4                                                             
dev-python/pycrypto: 2.1.0_beta1                                                                        
dev-util/ccache:     2.4-r7                                                                             
dev-util/cmake:      2.6.4-r3                                                                           
sys-apps/baselayout: 1.12.13                                                                            
sys-apps/sandbox:    2.2                                                                                
sys-devel/autoconf:  2.13, 2.63-r1                                                                      
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2                                          
sys-devel/binutils:  2.18-r3                                                                            
sys-devel/gcc-config: 1.4.1                                                                             
sys-devel/libtool:   2.2.6b                                                                             
virtual/os-headers:  2.6.27-r2                                                                          
ACCEPT_KEYWORDS="x86"                                                                                   
ACCEPT_LICENSE="* -@EULA"                                                                               
CBUILD="i686-pc-linux-gnu"                                                                              
CFLAGS="-O2 -march=prescott -pipe -fomit-frame-pointer"                                                 
CHOST="i686-pc-linux-gnu"                                                                               
CONFIG_PROTECT="/etc /usr/share/X11/xkb /usr/share/config"                                              
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/env.d/java/ /etc/eselect/postgresql /etc/fonts/fonts.conf /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c /etc/udev/rules.d"                                                                                      
CXXFLAGS="-O2 -march=prescott -pipe -fomit-frame-pointer"                                                                                                   
DISTDIR="/usr/portage/distfiles"                                                                                                                            
FEATURES="assume-digests ccache distcc distlocks fixpackages news parallel-fetch protect-owned sandbox sfperms strict unmerge-logs unmerge-orphans userfetch userpriv"                                                                                                                                                  
GENTOO_MIRRORS="http://gentoo.gg3.net/ ftp://gg3.net/pub/linux/gentoo/ ftp://ftp.ecc.u-tokyo.ac.jp/GENTOO http://gentoo.channelx.biz/ http://ftp.jaist.ac.jp/pub/Linux/Gentoo/ ftp://ftp.jaist.ac.jp/pub/Linux/Gentoo/ http://ftp.iij.ad.jp/pub/linux/gentoo/ ftp://ftp.iij.ad.jp/pub/linux/gentoo/ "                   
LANG="en_US.UTF-8"                                                                                                                                          
LC_ALL="en_US.UTF-8"                                                                                                                                        
LDFLAGS="-Wl,-O1"                                                                                                                                           
LINGUAS="en"                                                                                                                                                
MAKEOPTS="-j6"                                                                                                                                              
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/layman/berkano /usr/local/portage/layman/sunrise /usr/local/portage/layman/allenjb /usr/local/portage/layman/zugaina /usr/local/portage"
SYNC="rsync://rsync.europe.gentoo.org/gentoo-portage"
USE="X aac aalib acl alsa anthy avahi avi bash-completion berkdb bitmap-fonts bzip2 caps cdrom cjk cli cracklib crypt cups cxx dbus directfb divx divx4linux dri dvd dvdr dvdread fbcon ffmpeg flac fortran freetype gdbm gif gimpprint glib gphoto2 gpm gtk hal iconv imlib immqt-bc intel ipod ipv6 jabber jack java jpeg kakasi kde kipi matroska midi mmx mmx2 mmxext mng modules mp3 mpeg mpeg4 msn mudflap mysql ncurses nls nptl nptlonly nsplugin opengl openmp pam pcre pdf perl png pppd python qt qt3 qt3support qt4 quicktime readline reflection samba sdl semantic-desktop session spl sse sse2 sse3 ssl svg sysfs tcpd theora truetype unicode v4l vcd win32codecs x86 xanim xcomposite xorg xulrunner xvid zeroconf zlib" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="evdev keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="en" RUBY_TARGETS="ruby18" USERLAND="GNU" VIDEO_CARDS="intel vesa"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Aydın Tarık Zengin





          2010-01-31 06:25:39 UTC
        

Seems fixed for me. After a couple of days and sync.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

