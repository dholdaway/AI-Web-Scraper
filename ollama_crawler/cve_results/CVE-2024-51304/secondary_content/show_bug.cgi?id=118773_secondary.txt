Title: 118773 – strange behaviour of --usepkg while updating world
URL: https://bugs.gentoo.org/show_bug.cgi?id=118773

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 118773
strange behaviour of --usepkg while updating world
Last modified: 2006-02-10 20:24:35 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 118773 
      - strange behaviour of --usepkg while updating world


Summary:
strange behaviour of --usepkg while updating world
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-01-12 06:02 UTC by parafin





      Modified:
    
2006-02-10 20:24 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


parafin





          2006-01-12 06:02:57 UTC
        

note portage # emerge -vpuDNt world

These are the packages that I would merge, in reverse order:

Calculating world dependencies ...done!
[ebuild  N    ] app-misc/ca-certificates-20050804  0 kB 
[nomerge      ]     sys-libs/pam-0.78-r3  +berkdb -nis -pam_chroot -pam_console -pam_timestamp -pwdb (-selinux) 
[ebuild     U ]      dev-util/pkgconfig-0.20 [0.17.2-r1] -hardened 947 kB 

Total size of downloads: 947 kB
note portage # emerge -vpuDkNt world

These are the packages that I would merge, in reverse order:

Calculating world dependencies ...done!
[nomerge      ] games-misc/fortune-mod-all-1  
[ebuild  N    ]  games-misc/fortune-mod-debilneho-0.1  0 kB 
[nomerge      ] media-gfx/gimp-2.2.8-r1  -aalib (-altivec) -debug -doc +gimpprint -gtkhtml -hardened +jpeg -lcms +mmx +mng +png +python -smp +sse +svg +tiff -wmf 
[nomerge      ]  media-gfx/gimp-print-4.2.7  +cups +foomaticdb +gtk +nls +ppds +readline 
[nomerge      ]   media-gfx/imagemagick-6.2.4.2-r1  +X +cups -doc -fpx +graphviz -jbig +jpeg +lcms +mpeg +perl +png +tiff +truetype -wmf +xml2 
[nomerge      ]    media-gfx/graphviz-1.16-r1  -tcltk 
[ebuild     U ]     dev-util/pkgconfig-0.20 [0.17.2-r1] -hardened 947 kB 

Total size of downloads: 947 kB

Note the difference: -k wants to install debilneho while it must be installed only when LINGUAS=SK (setting LINGUAS doesn't help) and it doesn't want to install app-misc/ca-certificates (the other question why emerge -uD world wants it to without showing dependencions...).

emerge --info :
Portage 2.0.53 (default-linux/x86/2005.1, gcc-3.4.4, glibc-2.3.5-r2, 2.6.14.4 i686)
=================================================================
System uname: 2.6.14.4 i686 Intel(R) Pentium(R) M processor 1500MHz
Gentoo Base System version 1.6.13
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
ccache version 2.3 [enabled]
dev-lang/python:     2.4.2
sys-apps/sandbox:    1.2.12
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1
sys-devel/libtool:   1.5.20
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=pentium-m -fforce-addr -momit-leaf-frame-pointer -fomit-frame-pointer -ftracer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/splash /etc/terminfo /etc/env.d"
CXXFLAGS="-O3 -march=pentium-m -fforce-addr -momit-leaf-frame-pointer -fomit-frame-pointer -ftracer -pipe -fvisibility-inlines-hidden"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig buildpkg ccache distcc distlocks fixpackages sandbox sfperms strict"
GENTOO_MIRRORS="http://server/ftp http://mirror.aiya.ru/pub/gentoo/ ftp://mirror.aiya.ru/pub/gentoo/"
LANG="ru_RU.koi8r"
MAKEOPTS="-j6"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://server/gentoo-portage/"
USE="x86 X acpi adns alsa audiofile avi bash-completion berkdb bzip2 cdparanoia cdr crypt cups divx4linux dri dts dvd encode fbcon flac foomaticdb ftp gdbm gif glut gpm gtk gtk2 iconv imagemagick imap imlib ipv6 javascript jpeg mmap mmx mng motif mp3 mpeg ncurses nls nptl offensive ogg oggvorbis openal opengl pam pcntl pcre perl pic png posix ppds python qt quicktime readline recode ruby sdl session sharedmem slang sockets spell sse ssl svg sysvipc tcpd threads tiff truetype unicode usb vorbis wifi win32codecs xml2 xosd xsl xv xvid zlib userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LC_ALL, LDFLAGS, LINGUAS




Comment 1


Alec Warner (RETIRED)








          2006-01-12 08:38:35 UTC
        

> 
> Note the difference: -k wants to install debilneho while it must be installed
> only when LINGUAS=SK (setting LINGUAS doesn't help) and it doesn't want to
> install app-misc/ca-certificates (the other question why emerge -uD world wants
> it to without showing dependencions...).
> 

ca-certs shows up because PDEPENds are added to the depgraph with no parent to get a correct merge order.  There is no easy fix (a seperate bug already exists).  The other issue being that -k pulls in an extra mod package and not ca-certs, I would imagine that is because the binpkg of the respective environment has those variables/DEPENDs.  The only way to know for sure is to see the output with -d ( --debug ).  However I would imagine that your binpkg of openssl doesn't have the PDEPEND on ca-certs ( was added ~lastweek ) and yuor binpkg of fortune-mod-dev has LINGUAS=sk in it's build-env, which is why that output differs.

If you would like to know more/confirm this behavior you can attach the -k output with --debug on.




Comment 2


parafin





          2006-01-12 10:16:34 UTC
        

OK, i see. Ebuild, which is in binpkg, doesn't change when i'm doing emerge sync. I reemerged fortune-mod-all and openssl and all comes to normal. But what does fixpackages do? Mustn't it fix these bugs?




Comment 3


Zac Medico






          2006-02-10 20:24:35 UTC
        

(In reply to comment #2)
> I reemerged fortune-mod-all and openssl and all comes to normal. But what
> does fixpackages do? Mustn't it fix these bugs?

Binary packages will give you different results depending on the dependency metadata and USE flags that they contain.  fixpackages corrects for global updates and nothing more.  We have a known problem in the global updates (affects fixpackages) that will be addressed (bug 122089). 











Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

