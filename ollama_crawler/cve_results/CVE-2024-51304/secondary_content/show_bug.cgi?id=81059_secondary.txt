Title: 81059 – nVidia Card Gives Garbled Screen
URL: https://bugs.gentoo.org/show_bug.cgi?id=81059

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 81059
nVidia Card Gives Garbled Screen
Last modified: 2005-11-06 21:02:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 81059 
      - nVidia Card Gives Garbled Screen


Summary:
nVidia Card Gives Garbled Screen
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Unspecified

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       major
      


Assignee:

X11 External Driver Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-02-06 18:39 UTC by Christopher Covington





      Modified:
    
2005-11-06 21:02 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



nairb774









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Christopher Covington





          2005-02-06 18:39:21 UTC
        

I recently installed a pci GeForce MX 4000 that seems to be in working order on the hardware end (runs war3 tft under windows just fine). I followed the steps of the gentoo nvidia howto but my gnome background is a garbled windows is shutting down screen and a lot of gtk stuff isn't working. See http://www.raggedmountainrunning.com/~chris/Screenshot.png and http://www.raggedmountainrunning.com/~chris/Screenshot-1.png.

Reproducible: Always
Steps to Reproduce:
1. Boot up
2. After the annoying nvidia logo, log into gnome from gdm


Actual Results:  
My background is garbled and most things don't display/refresh properly.

Expected Results:  
Everything graphical should have looked quite nice, especially everything 3D.
(glxgears runs pretty fast...)

chris@speedy ~ $ glxgears -info
GL_MAX_VIEWPORT_DIMS=4096/4096
GL_RENDERER   = GeForce4 MX 4000/PCI/SSE2
GL_VERSION    = 1.5.2 NVIDIA 66.29
GL_VENDOR     = NVIDIA Corporation
GL_EXTENSIONS = GL_ARB_imaging GL_ARB_multitexture GL_ARB_point_parameters
GL_ARB_point_sprite GL_ARB_shader_objects GL_ARB_shading_language_100
GL_ARB_texture_compression GL_ARB_texture_cube_map GL_ARB_texture_env_add
GL_ARB_texture_env_combine GL_ARB_texture_env_dot3
GL_ARB_texture_mirrored_repeat GL_ARB_texture_rectangle GL_ARB_transpose_matrix
GL_ARB_vertex_buffer_object GL_ARB_vertex_program GL_ARB_vertex_shader
GL_ARB_window_pos GL_S3_s3tc GL_EXT_texture_env_add GL_EXT_abgr GL_EXT_bgra
GL_EXT_blend_color GL_EXT_blend_minmax GL_EXT_blend_subtract
GL_EXT_clip_volume_hint GL_EXT_compiled_vertex_array GL_EXT_Cg_shader
GL_EXT_draw_range_elements GL_EXT_fog_coord GL_EXT_multi_draw_arrays
GL_EXT_packed_pixels GL_EXT_paletted_texture GL_EXT_pixel_buffer_object
GL_EXT_point_parameters GL_EXT_rescale_normal GL_EXT_secondary_color
GL_EXT_separate_specular_color GL_EXT_shared_texture_palette GL_EXT_stencil_wrap
GL_EXT_texture_compression_s3tc GL_EXT_texture_cube_map
GL_EXT_texture_edge_clamp GL_EXT_texture_env_combine GL_EXT_texture_env_dot3
GL_EXT_texture_filter_anisotropic GL_EXT_texture_lod GL_EXT_texture_lod_bias
GL_EXT_texture_object GL_EXT_vertex_array GL_IBM_rasterpos_clip
GL_IBM_texture_mirrored_repeat GL_KTX_buffer_region GL_NV_blend_square
GL_NV_fence GL_NV_fog_distance GL_NV_light_max_exponent
GL_NV_packed_depth_stencil GL_NV_pixel_data_range GL_NV_point_sprite
GL_NV_register_combiners GL_NV_texgen_reflection GL_NV_texture_env_combine4
GL_NV_texture_rectangle GL_NV_vertex_array_range GL_NV_vertex_array_range2
GL_NV_vertex_program GL_NV_vertex_program1_1 GL_SGIS_generate_mipmap
GL_SGIS_multitexture GL_SGIS_texture_lod GL_SUN_slice_accum
4719 frames in 5.0 seconds = 943.800 FPS
5074 frames in 5.0 seconds = 1014.800 FPS
6098 frames in 5.0 seconds = 1219.600 FPS
5893 frames in 5.0 seconds = 1178.600 FPS
6195 frames in 5.0 seconds = 1239.000 FPS
6258 frames in 5.0 seconds = 1251.600 FPS

chris@speedy ~ $ cat /etc/X11/xorg.conf
Section "ServerLayout"
        Identifier     "My Layout"
        Screen      0  "My Screen" 0 0
        InputDevice    "Kensington Mouse" "CorePointer"
        InputDevice    "Kensington Keyboard" "CoreKeyboard"
EndSection

Section "Files"
        RgbPath      "/usr/lib/X11/rgb"
        ModulePath   "/usr/X11R6/lib/modules"
        FontPath     "/usr/share/fonts/misc/"
        FontPath     "/usr/share/fonts/Speedo/"
        FontPath     "/usr/share/fonts/Type1/"
        FontPath     "/usr/share/fonts/CID/"
        FontPath     "/usr/share/fonts/75dpi/"
        FontPath     "/usr/share/fonts/100dpi/"
EndSection

Section "Module"
        Load  "extmod"
        #Load  "dri"
        Load  "dbe"
        Load  "record"
        Load  "xtrap"
        Load  "glx"
        Load  "speedo"
        Load  "type1"
EndSection

Section "InputDevice"
        Identifier  "Kensington Keyboard"
        Driver      "kbd"
        Option      "XkbModel" "pc101"
        Option      "XkbLayout" "us_intl"
EndSection

Section "InputDevice"
        Identifier  "Kensington Mouse"
        Driver      "mouse"
        Option      "Protocol" "ImPS/2"
        Option      "Device" "/dev/psaux"
        Option      "ZAxisMapping" "4 5"
EndSection

Section "Monitor"
        Identifier   "Optiquest Monitor"
        VendorName   "Optiquest"
        ModelName    "Q71"
        HorizSync    30.0 - 70.0
        VertRefresh  50.0 - 120.0
EndSection

Section "Device"
        ### Available Driver options are:-
        ### Values: <i>: integer, <f>: float, <bool>: "True"/"False",
        ### <string>: "String", <freq>: "<f> Hz/kHz/MHz"
        ### [arg]: arg optional
        #Option     "SWcursor"                  # [<bool>]
        #Option     "HWcursor"                  # [<bool>]
        #Option     "NoAccel"                   # [<bool>]
        #Option     "ShowCache"                 # [<bool>]
        #Option     "ShadowFB"                  # [<bool>]
        #Option     "UseFBDev"                  # [<bool>]
        #Option     "Rotate"                    # [<str>]
        #Option     "VideoKey"                  # <i>
        #Option     "FlatPanel"                 # [<bool>]
        #Option     "FPDither"                  # [<bool>]
        #Option     "CrtcNumber"                # <i>
        Identifier  "nVidia GeForce MX 4000"
        VendorName  "nVidia Corporation"
        Driver      "nvidia"
        BusID       "PCI:0:13:0"
        VideoRam    131072
EndSection

Section "Screen"
        Identifier "My Screen"
        Device     "nVidia GeForce MX 4000"
        Monitor    "Optiquest Monitor"
        DefaultDepth    24
        SubSection "Display"
                Depth     1
                Modes     "1152x864" "800x600" "640x480"
                Black     0 0 5
                White     150 255 150
        EndSubSection
        SubSection "Display"
                Depth     16
                Modes     "1152x864" "800x600" "640x480"
        EndSubSection
        SubSection "Display"
                Depth     24
                Modes     "1152x864" "800x600"
        EndSubSection
EndSection

speedy chris # emerge -pv nvidia-kernel nvidia-glx

These are the packages that I would merge, in order:

Calculating dependencies ...done!
[ebuild   R   ] media-video/nvidia-kernel-1.0.6629-r3  0 kB
[ebuild   R   ] media-video/nvidia-glx-1.0.6629-r4  0 kB

speedy chris # emerge info
Portage 2.0.51-r15 (default-linux/x86/2004.0, gcc-3.4.3,
glibc-2.3.4.20041102-r0, 2.6.9-gentoo-r9 i686)
=================================================================
System uname: 2.6.9-gentoo-r9 i686 Intel(R) Celeron(R) CPU 1.70GHz
Gentoo Base System version 1.6.9
Python:              dev-lang/python-2.3.4 [2.3.4 (#1, Jun 13 2004, 20:36:48)]
dev-lang/python:     2.3.4
sys-devel/autoconf:  2.59-r6, 2.13
sys-devel/automake:  1.9.4, 1.8.5-r3, 1.7.9-r1, 1.5, 1.6.3, 1.4_p6
sys-devel/binutils:  2.15.92.0.2-r2
sys-devel/libtool:   1.5.10-r4
virtual/os-headers:  2.4.22
ACCEPT_KEYWORDS="x86 ~x86"
AUTOCLEAN="yes"
CFLAGS="-march=i686 -O3 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config
/usr/kde/3.3/share/config:/usr/kde/3.3/env:/usr/kde/3.3/shutdown
/usr/kde/3/share/config /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref
/usr/share/config /usr/share/texmf/dvipdfm/config/
/usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/
/usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/ /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=i686 -O3 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoaddcvs autoconfig ccache distlocks sandbox sfperms strict
userpriv"
GENTOO_MIRRORS="http://ftp.snt.utwente.nl/pub/os/linux/gentoo
http://www.die.unipd.it/pub/Linux/distributions/gentoo-sources/
http://gentoo.chem.wisc.edu/gentoo/ http://gentoo.math.bme.hu
http://mirror.datapipe.net/gentoo"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.namerica.gentoo.org/gentoo-portage"
USE="X aac aalib aim alsa apm avi bitmap-fonts bonobo cdr crypt cups dba doc
editor encode esd fam flac flash font-server foomaticdb fortran gd gdbm gif
gnome gpm gstreamer gtk gtk2 gtkhtml guile imagemagick imlib ipv6 irc jabber
jack java javascript jikes jpeg junit ldap libclamav libg++ libwww mad mikmod
mng motif mozilla mpeg msn mysql nas ncurses nls nocd oav odbc oggvorbis opengl
oss pam pdflib perl php png ppds prelude python quicktime readline rss samba
scanner slang speex spell ssl svga tcltk tcpd tetex tiff timidity truetype
truetype-fonts type1-fonts videos wmf x86 xml xml2 xmms xprint xv yahoo zlib"
Unset:  ASFLAGS, CBUILD, CTARGET, LANG, LC_ALL, LDFLAGS




Comment 1


Brian Atkinson





          2005-03-02 14:48:03 UTC
        

I have had the same problem as stated above but I have the AGP Riva TNT2 Ultra Card (Yes it is old and it work under windows).  I am using 2.6.10-gentoo-r6 kernel and the latest nvidia drivers (both kernel and glx).  I run KDE and it become compleatly unusable.  Any hints as to what causes this (Gnome vs KDE)?  The Gnome looks better then what I get.  The X server responds to Alt+Ctl+Bsp which is good because I would not be able to shut it down with the mouse.  My layout and config is essentially the same as the description.  Hope a solution comes around.  I did read that not having ACPI compiled into the kernel would help and I am trying that now.




Comment 2


Christopher Covington





          2005-11-06 21:02:38 UTC
        

I reinstalled and everything works. Maybe some version upgrades fixed the
problem. Maybe it was a xorg.conf issue. Maybe it was ACPI. Whatever it was, it
looks like the problem isn't widspread. I'm going to go ahead and mark the bug
worksforme.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

