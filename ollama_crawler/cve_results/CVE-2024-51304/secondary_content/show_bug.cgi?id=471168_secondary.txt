Title: 471168 – dev-python/lxml-3.2.1 USE=-beautifulsoup3 - src_install (python_3.2) hangs at "running install_scripts"
URL: https://bugs.gentoo.org/show_bug.cgi?id=471168

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 471168
dev-python/lxml-3.2.1 USE=-beautifulsoup3 - src_install (python_3.2) hangs at "running install_scripts"
Last modified: 2013-06-16 23:35:26 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 471168 
      - dev-python/lxml-3.2.1 USE=-beautifulsoup3 - src_install (python_3.2) hangs at "running install_scripts"


Summary:
dev-python/lxml-3.2.1 USE=-beautifulsoup3 - src_install (python_3.2) hangs at...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Development

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Python Gentoo Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-05-24 16:31 UTC by Derk W te Bokkel





      Modified:
    
2013-06-16 23:35 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




lxml-build-temp-logs.tar.gz

              (lxml-build-temp-logs.tar.gz,45.44 KB,
                application/x-gzip-compressed-tar)

            
2013-05-24 16:37 UTC,

            Derk W te Bokkel




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Derk W te Bokkel





          2013-05-24 16:31:42 UTC
        

normal compile time by qlop is (or with USE= +beautifulsoup3)

qlop -tH lxml
lxml: 13 minutes, 40 seconds for 6 merges

USE="-beautifulsoup3" emerge ~dev-python/lxml-3.2.1 

qlop -c
 * dev-python/lxml-3.2.1
     started: Fri May 24 09:34:00 2013
     elapsed: 2 hours, 52 minutes, 40 seconds

still running .. as I type

I think an error also exists in the ebuild as beautifulsoup appears required in all previous ebuilds but seems optional now ..

Reproducible: Always




emerge --info lxml
Portage 2.1.12.2 (default/linux/amd64/13.0, gcc-4.7.3, glibc-2.17, 3.9.3-gentoo x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-3.9.3-gentoo-x86_64-Intel-R-_Core-TM-2_Duo_CPU_T5870_@_2.00GHz-with-gentoo-2.2
KiB Mem:     4007916 total,   2057416 free
KiB Swap:    8201176 total,   8200700 free
Timestamp of tree: Fri, 24 May 2013 11:30:01 +0000
ld GNU ld (GNU Binutils) 2.23.1
app-shells/bash:          4.2_p45
dev-java/java-config:     2.2.0
dev-lang/python:          2.7.4, 3.2.4, 3.3.2
dev-util/cmake:           2.8.10.2-r2
dev-util/pkgconfig:       0.28
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.11.8
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.13, 2.69
sys-devel/automake:       1.11.6, 1.12.6, 1.13.2
sys-devel/binutils:       2.23.1
sys-devel/gcc:            4.7.3
sys-devel/gcc-config:     1.8
sys-devel/libtool:        2.4.2
sys-devel/make:           3.82-r4
sys-kernel/linux-headers: 3.9 (virtual/os-headers)
sys-libs/glibc:           2.17
Repositories: gentoo xfce-dev x-portage derk-personal
ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo"
CXXFLAGS="-O2 -pipe"
DISTDIR="/usr/portage/distfiles"
EMERGE_DEFAULT_OPTS="--autounmask --autounmask-write --quiet-build=y"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j4"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/var/lib/layman/xfce-dev /usr/local/portage /home/derk/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="X a52 aac alsa amd64 apng archive avcodec avformat berkdb bzip2 cairo cdda cddb cdr cifs cli cracklib crypt cups cxx dbus dri dvd dvdr encode ffmpeg flac fortran fuse gallium gdbm gnutls gphoto2 gpm gstreamer gtk iconv id3tag ipv6 java jpeg jpeg2k lame lcms libnotify live mad mmx modules mp3 mpeg mudflap multilib ncurses nfs nls nptl ntp ogg opengl openmp openrc opus pam parted pcre pdf pm-utils png postproc ppds qt4 readline samba scanner session sna sqlite sse sse2 ssl startup-notification svg tcpd theora threads tiff truetype twolame udev unicode v4l vdpau vorbis vpx wav webm wma wma-fixed x264 xcb xinerama xorg xvid zlib" ABI_X86="64" ALSA_CARDS="hda-intel" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="kexi words flow plan sheets stage tables krita karbon braindump author" CAMERAS="*" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ubx" INPUT_DEVICES="keyboard mouse synaptics evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer nlpsolver" LINGUAS="en en_GB en_US" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-3" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_2 python3_3" RUBY_TARGETS="ruby18 ruby19" USERLAND="GNU" VIDEO_CARDS="intel" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
USE_PYTHON=" 2.7 3.2 3.3"
Unset:  CPPFLAGS, CTARGET, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

=================================================================
                        Package Settings
=================================================================

dev-python/lxml-3.2.1 was built with the following:
USE="beautifulsoup3 threads -doc -examples" PYTHON_TARGETS="python2_7 python3_2 python3_3 -python2_6 -python3_1"




Comment 1


Derk W te Bokkel





          2013-05-24 16:37:36 UTC
        

Created attachment 349078 [details]
lxml-build-temp-logs.tar.gz

files in the temp directory and the build-info




Comment 2


Derk W te Bokkel





          2013-05-24 16:43:37 UTC
        

note: previous install I added +beautifulsoup3 to packages.use

note also that a downgrade from beautifulsoup:4 to beautifulsoup:python-3 also occurred .. with that change




Comment 3


Arfrever Frehtes Taifersar Arahesis





          2013-05-24 17:09:28 UTC
        

(In reply to comment #0)
> I think an error also exists in the ebuild as beautifulsoup appears required
> in all previous ebuilds but seems optional now

Previous ebuilds were broken. Beautifoul Soup 3 was always optional. Only one very rarely used module of lxml needs Beautiful Soup 3.




Comment 4


Michał Górny









          2013-05-24 17:32:52 UTC
        

Could you try building it again? I think we have some kind of problem with locks, and if the problem only occurs randomly, it's that.




Comment 5


Derk W te Bokkel





          2013-05-24 17:45:20 UTC
        

I've effectively done the -beautifulsoup3 emerge twice so far once fresh off an update .. which stalled.. then added flag .. then it compiled fine .. then once more w/o flag set and it also stalled then I filed the bug ..

But it is running again now ... I'll let you know what the result is ..




Comment 6


Michał Górny









          2013-05-24 17:54:41 UTC
        

(In reply to comment #5)
> I've effectively done the -beautifulsoup3 emerge twice so far once fresh off
> an update .. which stalled.. then added flag .. then it compiled fine ..
> then once more w/o flag set and it also stalled then I filed the bug ..
> 
> But it is running again now ... I'll let you know what the result is ..

I've just committed a patch for the race condition, so please wait a few hours, sync, then try again :).




Comment 7


Derk W te Bokkel





          2013-05-24 18:09:12 UTC
        

prior to your patch: no sync done yet

ran the emerge of lxml 6 times .. with -beautifulsoup3 .. seems to work now ..
quirky 

even did an ....  emerge -av --depclean .... which removed beautifulsoup:python-3
  after the first three runs 

(beautifulsoup:python-2 left installed is used by calibre) 

average installs less than 2 minutes 

Random it is ..




Comment 8


Derk W te Bokkel





          2013-05-25 12:00:46 UTC
        

okay did some sync's and on 3 separate machines several emerge runs of lxml on each w/ -beautifulsoup3 and no issues .. seems fixed .. ?

normal compile time is now averaging about 2 minutes ..









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

