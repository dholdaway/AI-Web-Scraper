Title: 138682 – portage-2.1.1_pre1-r5 pulls in multiple versions
URL: https://bugs.gentoo.org/show_bug.cgi?id=138682

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 138682
portage-2.1.1_pre1-r5 pulls in multiple versions
Last modified: 2006-07-01 10:32:57 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 138682 
      - portage-2.1.1_pre1-r5 pulls in multiple versions


Summary:
portage-2.1.1_pre1-r5 pulls in multiple versions
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-07-01 03:13 UTC by Neil Darlow





      Modified:
    
2006-07-01 10:32 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



rhill









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Output from emerge --search java-config/emerge --unmerge java-config

              (unmerge.out,56.69 KB,
                application/octet-stream)

            
2006-07-01 06:42 UTC,

            Neil Darlow




Details





Output from emerge --debug --pretend --verbose --update --deep world

              (pretend-update-deep-world.out,943.65 KB,
                application/octet-stream)

            
2006-07-01 06:47 UTC,

            Neil Darlow




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Neil Darlow





          2006-07-01 03:13:15 UTC
        

I think there's something wrong here. Two examples will clarify but they may be separate issues:

1) dbus-0.62 has separate useflags "qt3" and "qt4"
   With just qt3 useflag specified for dbus portage wants to emerge qt-4.x

2) sun-jdk-1.4.2.12 has a DEPEND of >=dev-java/java-config-1.1.5
   portage wants to emerge both java-config-1.3.0-r2 and java-config-2.0.26

For both of these cases you can't mask unwanted versions in /etc/portage/package.mask, portage insists that they are required.




Comment 1


Jason Stubbs (RETIRED)






          2006-07-01 04:30:22 UTC
        

Please use the --debug flag with an example case and attach the output. Also please provide `emerge --info` output.




Comment 2


Neil Darlow





          2006-07-01 06:38:45 UTC
        

Portage 2.1.1_pre1-r5 (default-linux/x86/2006.0, gcc-3.4.6, glibc-2.3.6-r4, 2.6.17-gentoo i686)
=================================================================
System uname: 2.6.17-gentoo i686 AMD Athlon(tm) XP 2200+
Gentoo Base System version 1.12.1
ccache version 2.4 [enabled]
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r2
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r2
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-march=athlon-xp -O3 -pipe -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/splash /etc/terminfo"
CXXFLAGS="-march=athlon-xp -O3 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LC_ALL="en_GB.utf8"
LINGUAS="en_GB"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="x86 3dnow X a52 aac acl acpi akode alsa apache2 arts asf audiofile bash-completion berkdb bitmap-fonts blas bluetooth bzip2 cairo caps cddb cdparanoia cdr cli crypt cups curl dbus dga directfb djbfft dri dts dv dvd dvdr dvdread emacs encode esd exif fam fame fbcon ffmpeg fftw flac font-server foomaticdb fortran gd gdbm gif gimpprint ginac gmp gphoto2 gs gtk2 gtkhtml hal iconv idn ieee1394 imagemagick imlib innodb ipv6 isdnlog ithreads jpeg kde lcms ldap libg++ libwww lm_sensors lzo mad mailwrapper mhash mikmod mjpeg mmx mng motif mp3 mpeg musicbrainz mysql ncurses nls nptl nsplugin ogg openexr opengl pam pcre pdf pdflib perl perlsuid pic plotutils png postgres povray ppds pppd python qhull qt qt3 qt4 quicktime readline real reflection ruby samba sasl scanner sdl session shared slp sndfile sox speex spell spl sqlite sse ssl svg tcltk tcpd tetex theora threads tidy tiff truetype truetype-fonts type1-fonts udev unicode usb v4l vcd vorbis wifi win32codecs xine xml xorg xpm xv xvid zeroconf zlib elibc_glibc input_devices_keyboard input_devices_mouse input_devices_evdev kernel_linux linguas_en_GB userland_GNU"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LDFLAGS, PORTAGE_RSYNC_EXTRA_OPTS





Comment 3


Neil Darlow





          2006-07-01 06:42:40 UTC
        

Created attachment 90608 [details]
Output from emerge --search java-config/emerge --unmerge java-config

I had both java-config-1.3.0-r2 and java-config-2.0.26 on my system. emerge --unmerge java-config removed both of them. Is this new/correct behaviour for portage?




Comment 4


Neil Darlow





          2006-07-01 06:47:05 UTC
        

Created attachment 90609 [details]
Output from emerge --debug --pretend --verbose --update --deep world

This is the output from a debug/pretend update of world. As you can see, both versions of java-config are being pulled-in.

Incidentally, an equery --depends =java-config-1.3.0-r2 and equery --depends =java-config-2.0.26 both return an empty result. Is that correct given dev-java/sun-jdk's DEPEND on >=java-config-1.1.5?




Comment 5


Jason Stubbs (RETIRED)






          2006-07-01 08:16:15 UTC
        

(In reply to comment #4)
> Created an attachment (id=90609) [edit]
> Output from emerge --debug --pretend --verbose --update --deep world
> 
> This is the output from a debug/pretend update of world. As you can see, both
> versions of java-config are being pulled-in.

Parent:    ebuild / dev-java/sun-jdk-1.4.2.12 nomerge
Depstring: >=dev-java/java-config-1.1.5 ... =dev-java/java-config-2.0* =dev-java/java-config-1.3* ...

sun-jdk is pulling them both in.

> Incidentally, an equery --depends =java-config-1.3.0-r2 and equery --depends
> =java-config-2.0.26 both return an empty result. Is that correct given
> dev-java/sun-jdk's DEPEND on >=java-config-1.1.5?

I personally don't have a clue about equery. It appears to be either giving you incorrect results or you're not using the correct switches.

With your dbus-0.62 case, is x11-libs/qt listed in /var/lib/portage/world? If so, bringing in qt4 would also be correct behaviour. If not, can you add the --debug output for that case too please?




Comment 6


Ryan Hill (RETIRED)






          2006-07-01 10:14:39 UTC
        

# grep qt /var/lib/portage/world
x11-libs/qt

# grep qt /etc/portage/package.mask
>=x11-libs/qt-4

# emerge -Dtv dbus

Calculating dependencies... done!
[ebuild   R   ] sys-apps/dbus-0.62  USE="X gtk python qt3 -debug -doc -mono -qt4" 0 kB

# sed -i -e 's@>=x11-libs/qt-4@@' /etc/portage/package.mask

# grep qt /etc/portage/package.mask


# emerge -Dtv dbus
Calculating dependencies... done!
[ebuild   R   ] sys-apps/dbus-0.62  USE="X gtk python qt3 -debug -doc -mono -qt4" 0 kB


working fine here.


Portage 2.1.1_pre1-r5 (default-linux/x86/2006.0, gcc-4.1.2-pre20060701/vanilla, glibc-2.4-r3, 2.6.17-ck1 i686)
=================================================================
System uname: 2.6.17-ck1 i686 Genuine Intel(R) CPU           T2300  @ 1.66GHz
Gentoo Base System version 1.12.1
ccache version 2.4 [enabled]
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.4-r2
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r2, 2.17, 2.17.50.0.2
sys-devel/gcc-config: 2.0.0_rc1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r5





Comment 7


Zac Medico






          2006-07-01 10:32:57 UTC
        

(In reply to comment #2)
> python qhull qt qt3 qt4 quicktime readline real reflection ruby samba sasl

They've added the qt4 flag to the profile.  You can put -qt4 in you make.conf USE flags if you don't want it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

