Title: 317599 – [x11 overlay] media-libs/mesa-9999 doesn't compile with gallium USE flags because of udis86
URL: https://bugs.gentoo.org/show_bug.cgi?id=317599

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 317599
[x11 overlay] media-libs/mesa-9999 doesn't compile with gallium USE flags because of udis86
Last modified: 2010-08-26 13:03:34 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 317599 
      - [x11 overlay] media-libs/mesa-9999 doesn't compile with gallium USE flags because of udis86


Summary:
[x11 overlay] media-libs/mesa-9999 doesn't compile with gallium USE flags bec...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo X packagers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2010-04-28 07:41 UTC by Francis Galiegue





      Modified:
    
2010-08-26 13:03 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Patch to x11 overlay: don't require udis86 for mesa when gallium USE flag is set

              (0001-media-libs-mesa-9999-don-t-require-udis86-for-galliu.patch,1.74 KB,
                text/plain)

            
2010-04-28 07:48 UTC,

            Francis Galiegue




Details





The build log showing the failure

              (build.log,496.88 KB,
                text/plain)

            
2010-04-28 07:57 UTC,

            Francis Galiegue




Details





emerge --info output

              (emerge-info.txt,3.56 KB,
                text/plain)

            
2010-04-28 08:04 UTC,

            Francis Galiegue




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Francis Galiegue





          2010-04-28 07:41:24 UTC
        

System: Gentoo amd64 unstable, using the x11 overlay.

Since commit a913175a3eb22d64ba5d222039f2c846a1747cab of x11 overlay (dated Apr 25), mesa-9999 now uses LLVM when building gallium (which I do, since I use the nouveau driver).

Unfortunately, dev-libs/udis86 is currently broken: in the ebuild log, ld complains that "relocations are not possible, please recompile with -fPIC" (approximate message - I don't have the ebuild log handy). As a result, swrastg_dri.so is not generated and the build fails.

I have emerged just this morning (20100428, 8:00am GMT) and see that an update to LLVM occurred, and that it does not require udis86 anymore (new udis86 flag, set to false by default). I remerged llvm, removed udis... But mesa-9999 still explicitly requires udis86 and the ebuild fails the same way.

The solution (while udis86 remains broken) is to remove udis86 as a dependency from mesa-9999 (patch attached), which makes mesa compile again.




Comment 1


Francis Galiegue





          2010-04-28 07:48:22 UTC
        

Created attachment 229479 [details]
Patch to x11 overlay: don't require udis86 for mesa when gallium USE flag is set




Comment 2


Chí-Thanh Christopher Nguyễn






          2010-04-28 07:53:15 UTC
        

I am using it on amd64 without any problems. Please attach logs which detail your build issue.




Comment 3


Francis Galiegue





          2010-04-28 07:57:45 UTC
        

Created attachment 229481 [details]
The build log showing the failure




Comment 4


Francis Galiegue





          2010-04-28 08:04:01 UTC
        

Created attachment 229483 [details]
emerge --info output




Comment 5


Chí-Thanh Christopher Nguyễn






          2010-05-10 13:15:30 UTC
        

Does the situation change if you set EXTRA_ECONF="--with-pic" when building udis86?




Comment 6


Francis Galiegue





          2010-05-23 19:41:01 UTC
        

> Does the situation change if you set EXTRA_ECONF="--with-pic" when building
> udis86?

Yes it does: now mesa builds OK.

This is with a portage tree and x11 overlay synchronized 20 minutes ago.




Comment 7


Chí-Thanh Christopher Nguyễn






          2010-08-26 13:03:34 UTC
        

Resolving as WORKSFORME, as the bug was not reproducible here and a workaround exists.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

