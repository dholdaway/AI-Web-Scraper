Title: 545668 – sys-apps/portage-2.2.18 - rsync over ssh doesn't work for non-gentoo repos
URL: https://bugs.gentoo.org/show_bug.cgi?id=545668

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 545668
sys-apps/portage-2.2.18 - rsync over ssh doesn't work for non-gentoo repos
Last modified: 2016-02-10 23:04:44 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 545668 
      - sys-apps/portage-2.2.18 - rsync over ssh doesn't work for non-gentoo repos


Summary:
sys-apps/portage-2.2.18 - rsync over ssh doesn't work for non-gentoo repos
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2015-04-05 23:20 UTC by Enne Eziarc





      Modified:
    
2016-02-10 23:04 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



nikoli









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Enne Eziarc





          2015-04-05 23:20:16 UTC
        

I'm trying to port an old LAN mirror setup from using Paludis everywhere to Portage's repos.conf. I'm using rsync over ssh because occasionally I'll want to update my laptop from different locations and don't want port 873 open to the world.

Given this section in repos.conf:

[x11]
location = /var/db/repositories/x11
sync-type = rsync
sync-uri = ssh://rsync@lan-server/var/db/repositories/x11

...I get this output from `emerge --sync`:

>>> Starting retry 1 of 3 with ssh://rsync@[fd12:3456:789a::b]/var/db/repositories/x11
receiving incremental file list
rsync: link_stat "/var/db/repositories/x11/metadata/timestamp.chk" failed: No such file or directory (2)

Number of files: 0
Number of created files: 0
Number of deleted files: 0
Number of regular files transferred: 0
Total file size: 0 bytes
Total transferred file size: 0 bytes
Literal data: 0 bytes
Matched data: 0 bytes
File list size: 120
Total bytes sent: 51
Total bytes received: 120

sent 51 bytes  received 120 bytes  342.00 bytes/sec
total size is 0  speedup is 0.00
rsync error: some files/attrs were not transferred (see previous errors) (code 23) at main.c(1637) [Receiver=3.1.1]
rsync: [Receiver] write error: Broken pipe (32)


The same happens for every other repo besides the main portage tree. It seems to want this timestamp.chk file before it'll do anything else.




Comment 1


Nikoli





          2015-04-21 15:09:50 UTC
        

I think it is not portage bug, just add --write-timestamp to your egencache options.




Comment 2


Enne Eziarc





          2016-02-10 23:04:44 UTC
        

Marking resolved; seems pointless to waste effort on making this work when git+ssh:// is available.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

