Title: 130423 – gcc upgrade fails with FEATURES="collision-protect" using >=portage-2.1_pre8
URL: https://bugs.gentoo.org/show_bug.cgi?id=130423

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 130423
gcc upgrade fails with FEATURES="collision-protect" using >=portage-2.1_pre8
Last modified: 2006-06-12 21:33:43 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 130423 
      - gcc upgrade fails with FEATURES="collision-protect" using >=portage-2.1_pre8


Summary:
gcc upgrade fails with FEATURES="collision-protect" using >=portage-2.1_pre8
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Highest
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:









Duplicates (2):
    

134390 135374

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2006-04-18 19:51 UTC by Jakub Moc (RETIRED)





      Modified:
    
2006-06-12 21:33 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



askwar
marcin.lubojanski









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jakub Moc (RETIRED)






          2006-04-18 19:51:44 UTC
        

Hmmmm 'k, guys - sort this out please, it sucks... ktnx. ;) I suspect gcc is not the only slotted thing in portage that will blow...

* checking 562 files for package collisions
existing file /sbin/fix_libtool_files.sh is not owned by this package
existing file /lib/rcscripts/awk/fixlafiles.awk is not owned by this package
* spent 0.168200969696 seconds checking for file collisions
* This package is blocked because it wants to overwrite
* files belonging to other packages (see messages above).
* If you have no clue what this is all about report it 
* as a bug for this package on http://bugs.gentoo.org

# equery b /sbin/fix_libtool_files.sh

[ Searching for file(s) /sbin/fix_libtool_files.sh in *... ]
sys-devel/gcc-3.4.4-r1 (/sbin/fix_libtool_files.sh)
sys-devel/gcc-4.0.3 (/sbin/fix_libtool_files.sh)

# equery b /lib/rcscripts/awk/fixlafiles.awk

[ Searching for file(s) /lib/rcscripts/awk/fixlafiles.awk in *... ]
sys-devel/gcc-3.4.4-r1 (/lib/rcscripts/awk/fixlafiles.awk)
sys-devel/gcc-4.0.3 (/lib/rcscripts/awk/fixlafiles.awk)




Comment 1


Mark Loeser (RETIRED)






          2006-04-18 19:55:16 UTC
        



*** This bug has been marked as a duplicate of 87647 ***




Comment 2


Jakub Moc (RETIRED)






          2006-04-26 10:42:13 UTC
        

Reopening, the fix for Bug 87647 doesn't solve this issue.




Comment 3


SpanKY






          2006-04-26 10:45:43 UTC
        



*** This bug has been marked as a duplicate of 90744 ***




Comment 4


Jakub Moc (RETIRED)






          2006-04-26 11:03:21 UTC
        

Sigh. Have you got bunch of more candidates for duping this bug against?

It fails now and needs to be fixed, whether the tool itself sucks or not. Anyone upgrading gcc to another slot will hit this w/ recent portage, waiting for a bug that isn't even close to a solution after one year is not a viable option.




Comment 5


SpanKY






          2006-04-26 11:17:55 UTC
        

as i told you on irc, we're handling this in another way, so having a bug report open does nothing

so leave it be

*** This bug has been marked as a duplicate of 90744 ***




Comment 6


Jakub Moc (RETIRED)






          2006-05-26 02:52:02 UTC
        

*** Bug 134390 has been marked as a duplicate of this bug. ***




Comment 7


Jakub Moc (RETIRED)






          2006-06-03 04:42:55 UTC
        

*** Bug 135374 has been marked as a duplicate of this bug. ***




Comment 8


Kevin F. Quinn (RETIRED)






          2006-06-05 23:56:51 UTC
        

(In reply to comment #5)
> as i told you on irc, we're handling this in another way, so having a bug
> report open does nothing

Well, the problem still exists over a month later, even though bug #90744 is marked FIXED.  Having a bug open allows people to see that it hasn't yet been fixed, and allows it to appear on default bug searches (thus reducing dups).  Closing it before the problem is actually fixed doesn't help anyone, as far as I can tell.  More significantly there's more to the collisions that just the libtool files stuff:

Collision list from gcc-4.0.3:

/sbin/fix_libtool_files.sh
/lib/rcscripts/awk/fixlafiles.awk
/usr/lib/pkgconfig/libgcj.pc

The first two could be dealt with simply by:
1) installing in postinst (i.e. taking them out of the package database)
2) making them a separate build (gcc-utils perhaps) and DEPENDing on it
since they're bits added by Gentoo.

The last is potentially more serious.  Could perhaps move the pkgconfig directory to:

/usr/lib/${CTARGET}/pkgconfig

in ${D} before merge and have gcc-config/eselect-compiler soft-link from the selected target to /usr/lib/pkgconfig - I haven't a clue what it's used for, but it's part of libjava.





Comment 9


Kevin F. Quinn (RETIRED)






          2006-06-06 01:14:45 UTC
        

(In reply to comment #8)
> Could perhaps move the pkgconfig directory to:
> 
> /usr/lib/${CTARGET}/pkgconfig

maybe not, after finding out what it's for :)

Still, /usr/lib/pkgconfig/libgcj.pc needs to be slotted somehow.  Perhaps moving it to /usr/lib/pkgconfig/libgcj-<gcc version>.pc and softlinking to /usr/lib/pkgconfig/libgcj.pc






Comment 10


SpanKY






          2006-06-08 19:30:36 UTC
        

different issue with .pc files

file a new bug




Comment 11


Kevin F. Quinn (RETIRED)






          2006-06-11 04:53:50 UTC
        

bug #136382 filed for libgcj.pc.

In the meantime, could you explain how you don't get collisions on /sbin/fix_libtool_files.sh and /lib/rcscripts/awk/fixlafiles.awk, since you've marked this bug WORKSFORME?










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

