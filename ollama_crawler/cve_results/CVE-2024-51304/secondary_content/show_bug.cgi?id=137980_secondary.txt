Title: 137980 – baselayout-1.11.15-r3 breaks runlevel links
URL: https://bugs.gentoo.org/show_bug.cgi?id=137980

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 137980
baselayout-1.11.15-r3 breaks runlevel links
Last modified: 2006-07-07 14:52:38 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 137980 
      - baselayout-1.11.15-r3 breaks runlevel links


Summary:
baselayout-1.11.15-r3 breaks runlevel links
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       major
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-06-25 15:34 UTC by Andre Hinrichs





      Modified:
    
2006-07-07 14:52 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge log

              (xxx.log,13.94 KB,
                text/plain)

            
2006-06-25 15:37 UTC,

            Andre Hinrichs




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Andre Hinrichs





          2006-06-25 15:34:47 UTC
        

I've just installed baselayout-1.11.15-r3 which has been marked stable now.
Unfortunately, it breaks the runlevels.

Rebooting resulted into the following message:

 * net.eth0: cannot start until the runlevel boot has completed
 * net.eth1: cannot start until the runlevel boot has completed

Fortunately, the boot continued.

Reemerging showed some 'cycle's: Will add the complete emerge log as attachment.

# rc-update show
 * Broken runlevel entry: /etc/runlevels/boot/keymaps
 * Broken runlevel entry: /etc/runlevels/boot/clock
 * Broken runlevel entry: /etc/runlevels/boot/domainname
 * Broken runlevel entry: /etc/runlevels/boot/localmount
 * Broken runlevel entry: /etc/runlevels/boot/consolefont
 * Broken runlevel entry: /etc/runlevels/boot/modules
 * Broken runlevel entry: /etc/runlevels/boot/hostname
 * Broken runlevel entry: /etc/runlevels/boot/net.lo
 * Broken runlevel entry: /etc/runlevels/boot/urandom
 * Broken runlevel entry: /etc/runlevels/boot/checkroot
 * Broken runlevel entry: /etc/runlevels/boot/rmnologin
 * Broken runlevel entry: /etc/runlevels/boot/checkfs
 * Broken runlevel entry: /etc/runlevels/wlan/local
 * Broken runlevel entry: /etc/runlevels/wlan/netmount
 * Broken runlevel entry: /etc/runlevels/wired/local
 * Broken runlevel entry: /etc/runlevels/wired/netmount
 * Broken runlevel entry: /etc/runlevels/nonetwork/local
 * Broken runlevel entry: /etc/runlevels/nettest/local
 * Broken runlevel entry: /etc/runlevels/offline/local
             apache2 |                                       wired wlan
            bootmisc | boot
             checkfs | boot
           checkroot | boot
               clock | boot
            coldplug | boot
         consolefont | boot
               cupsd |                        offline        wired wlan
                dbus |                                       wired wlan
             distccd |                                       wired wlan
          domainname | boot
                 gpm |      nettest           offline        wired wlan
            hostname | boot
             keymaps | boot
               local |      nettest nonetwork offline        wired wlan
          localmount | boot
             metalog |      nettest           offline        wired wlan
             modules | boot
               mysql |                        offline        wired wlan
            net.eth0 |      nettest                          wired
            net.eth1 |                                             wlan
              net.lo | boot
            netmount |                                       wired wlan
          ntp-client |                                       wired wlan
                ntpd |                                       wired wlan
             portmap |                                       wired wlan
           rmnologin | boot
              rsyncd |                                       wired wlan
                sshd |                                       wired wlan
            tomcat-5 |                                       wired wlan
             urandom | boot
          vixie-cron |                        offline        wired wlan

# emerge --info
Portage 2.1-r1 (default-linux/x86/2006.0, gcc-3.4.6, glibc-2.3.6-r4, 2.6.16.19 i686)
=================================================================
System uname: 2.6.16.19 i686 Intel(R) Pentium(R) M processor 1.86GHz
Gentoo Base System version 1.6.15
distcc 2.18.3 i686-pc-linux-gnu (protocols 1 and 2) (default port 3632) [disabled]
dev-lang/python:     2.4.2
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1-r2
sys-devel/gcc-config: 1.3.13-r2
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="x86"
AUTOCLEAN="yes"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=pentium3 -mfpmath=sse -mmmx -msse -maccumulate-outgoing-args -fomit-frame-pointer -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/grass60/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/X11/xkb /usr/lib/mozilla/defaults/pref /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-O3 -march=pentium3 -mfpmath=sse -mmmx -msse -maccumulate-outgoing-args -fomit-frame-pointer -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://pandemonium.tiscali.de/pub/gentoo/ http://gentoo.intergenia.de http://mirror.switch.ch/ftp/mirror/gentoo/ http://ftp.du.se/pub/os/gentoo"
LANG="de_DE@euro"
LC_ALL="de_DE@euro"
LINGUAS="de en"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage/my /usr/local/portage/sunrise"
SYNC="rsync://rsync.de.gentoo.org/gentoo-portage"
USE="x86 X a52 aac accessibility acl alsa apache2 audiofile avi berkdb bidi big-tables binfilter bitmap-fonts browserplugin bzip2 cairo cdda cdparanoia chroot cli corba crypt cups curl daap dri dts dv dvb dvd dvdread eds emacs emboss encode exif expat fame ffmpeg flac font-server foomaticdb fortran gd gdbm gif gimp glut gmp gnutls gpm gs gstreamer gtk gtk2 hpn idn ieee1394 imagemagick imlib isdnlog java jbig jpeg junit kde kdeenablefinal lcms ldap leim libg++ libwww live lzo mad mailwrapper matroska mikmod mjpeg mmx mng mono motif mozilla moznocompose moznoirc moznomail mp3 mpeg mysql ncurses network nls nptl nsplugin objc odbc ogg openal openexr opengl pam pcmcia pcre pdf pdflib perl png povray ppds pppd profile python qt qt4 quicktime readline real reflection rle rtc samba sasl scanner sdl session slp sndfile speex spell spl sse ssl stream subversion svg svga tcltk tcpd tetex theora threads tidy tiff truetype truetype-fonts type1-fonts udev unicode usb v4l v4l2 vcd vlm vorbis win32codecs wmf wxwindows xanim xml xml2 xorg xosd xscreensaver xv xvid yv12 zlib elibc_glibc kernel_linux linguas_de linguas_en userland_GNU"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, MAKEOPTS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Andre Hinrichs





          2006-06-25 15:37:41 UTC
        

Created attachment 90151 [details]
emerge log




Comment 2


SpanKY






          2006-06-26 19:48:05 UTC
        

what version of udev/coldplug ?




Comment 3


Andre Hinrichs





          2006-06-26 22:29:53 UTC
        

udev-087-r1
coldplug-20040920-r1

After reemerging them and reemerging baselayout the 'cycle' messages are gone.

The runlevel files are linked to non-existing directoriers:
# # ls -la /etc/runlevels/boot/
insgesamt 0
drwxr-xr-x 2 root root 424 25. Jun 23:49 .
drwxr-xr-x 9 root root 224  3. Mai 18:39 ..
lrwxrwxrwx 1 root root  20 25. Jun 23:49 bootmisc -> /etc/init.d/bootmisc
lrwxrwxrwx 1 root root  35 11. Sep 2005  checkfs -> /tmp/stage1root//etc/init.d/checkfs
lrwxrwxrwx 1 root root  37 11. Sep 2005  checkroot -> /tmp/stage1root//etc/init.d/checkroot
lrwxrwxrwx 1 root root  33 11. Sep 2005  clock -> /tmp/stage1root//etc/init.d/clock
lrwxrwxrwx 1 root root  20 15. Nov 2005  coldplug -> /etc/init.d/coldplug
lrwxrwxrwx 1 root root  39 11. Sep 2005  consolefont -> /tmp/stage1root//etc/init.d/consolefont
lrwxrwxrwx 1 root root  38 11. Sep 2005  domainname -> /tmp/stage1root//etc/init.d/domainname
lrwxrwxrwx 1 root root  36 11. Sep 2005  hostname -> /tmp/stage1root//etc/init.d/hostname
lrwxrwxrwx 1 root root  35 11. Sep 2005  keymaps -> /tmp/stage1root//etc/init.d/keymaps
lrwxrwxrwx 1 root root  38 11. Sep 2005  localmount -> /tmp/stage1root//etc/init.d/localmount
lrwxrwxrwx 1 root root  35 11. Sep 2005  modules -> /tmp/stage1root//etc/init.d/modules
lrwxrwxrwx 1 root root  34 11. Sep 2005  net.lo -> /tmp/stage1root//etc/init.d/net.lo
lrwxrwxrwx 1 root root  37 11. Sep 2005  rmnologin -> /tmp/stage1root//etc/init.d/rmnologin
lrwxrwxrwx 1 root root  35 11. Sep 2005  urandom -> /tmp/stage1root//etc/init.d/urandom


Will link them to the correct location manually now.
Since the timestamps are very old I assume the error was initiated when the system was set up.
Question is: Why did these faulty symlinks not produce errors earlier?





Comment 4


SpanKY






          2006-06-26 22:45:19 UTC
        

yes, those broken symlinks are from the initial install ... we've fixed it since, but a lot of systems out there crop up from time to time




Comment 5


reisio





          2006-07-07 13:42:20 UTC
        

I'm getting this, too, along with at least one other person I've run into, but we don't have the odd symlinks in /etc/runlevels, just the '* net.eth0: cannot start until the runlevel boot has completed' stuff.

Explicit fix instructions for we the ignorant? :)




Comment 6


SpanKY






          2006-07-07 14:52:38 UTC
        

that is a different bug unrelated to this one

disable HOLDPLUG/COLDPLUG in /etc/conf.d/rc









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

