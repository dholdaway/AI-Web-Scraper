Title: 109231 – crash of Firefox or thunderbird with Gnome 2.12
URL: https://bugs.gentoo.org/show_bug.cgi?id=109231

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 109231
crash of Firefox or thunderbird with Gnome 2.12
Last modified: 2006-12-18 19:07:18 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 109231 
      - crash of Firefox or thunderbird with Gnome 2.12


Summary:
crash of Firefox or thunderbird with Gnome 2.12
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Mozilla Gentoo Team








URL:







Whiteboard:




Keywords:









Duplicates (2):
    

112008 119578

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2005-10-13 17:08 UTC by Antoine Philippot





      Modified:
    
2006-12-18 19:07 UTC
      (History)
    




          CC List:
        

5 
          users
          
            (show)
          



castan.o
cbidea
henrique.ferreiro
jnerin
pacho









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Antoine Philippot





          2005-10-13 17:08:47 UTC
        

When I start Firefox with Gnome 2.12 I have got this error :
/usr/lib/mozilla-firefox/firefox-bin: symbol lookup error: /usr/lib/mozilla-
firefox/components/libgfx_gtk.so: undefined symbol: pango_x_font_map_for_display
firefox-bin exited with non-zero status (127)

Firefox 1.0.7-r2 and r3 
Pango 1.10.1 
Cairo 1.0.2

Reproducible: Always
Steps to Reproduce:
1.Run Firefox under Gnome 2.12
2.
3.

Actual Results:  
/usr/lib/mozilla-firefox/firefox-bin: symbol lookup error: /usr/lib/mozilla-
firefox/components/libgfx_gtk.so: undefined symbol: pango_x_font_map_for_display
firefox-bin exited with non-zero status (127)




Comment 1


Jakub Moc (RETIRED)






          2005-10-13 20:56:58 UTC
        

NOT a bugzilla product bug.




Comment 2


Gergan Penkov





          2005-10-17 10:59:41 UTC
        

This is normal as the mozilla bug is already a month old and fedora has a patch
about this, which is also a month old, but no one in mozilla decides to push it.
I didn't know that this appears with 1.0.7, but with 1.5betas the only
possibility is to use the fedora patch.




Comment 3


Trooper





          2005-10-20 01:50:21 UTC
        

I get this running firefox under fluxbox also.




Comment 4


Trooper





          2005-10-22 18:49:15 UTC
        

Now with mozilla-thunderbird-1.0.7-r1 also  :(

No running windows found
/usr/lib/mozilla-thunderbird/thunderbird-bin: symbol lookup error:
/usr/lib/mozilla-thunderbird/components/libgfx_gtk.so: undefined symbol:
pango_x_font_map_for_display






Comment 5


Trooper





          2005-10-22 20:00:58 UTC
        

Found a solution, removed moznoxft from my use flags.  




Comment 6


Olivier Castan





          2005-11-03 03:32:46 UTC
        

No crash but firefox not starting here with arch ppc. This is not an x86
specific bug...
$ ldd -r /usr/lib/mozilla-firefox/components/libgfx_gtk.so
        libxpcom.so => /usr/lib/mozilla-firefox/libxpcom.so (0x6fe82000)
        libplds4.so => /usr/lib/mozilla-firefox/libplds4.so (0x6fe5d000)
        libplc4.so => /usr/lib/mozilla-firefox/libplc4.so (0x6fe37000)
        libnspr4.so => /usr/lib/mozilla-firefox/libnspr4.so (0x6fdda000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x6fda6000)
        libdl.so.2 => /lib/libdl.so.2 (0x6fd82000)
        libgkgfx.so => /usr/lib/mozilla-firefox/libgkgfx.so (0x6fd3a000)
        libmozjs.so => /usr/lib/mozilla-firefox/libmozjs.so (0x6fc8c000)
        libXft.so.2 => /usr/lib/libXft.so.2 (0x6fc55000)
        libX11.so.6 => /usr/lib/libX11.so.6 (0x6fb34000)
        libfreetype.so.6 => /usr/lib/libfreetype.so.6 (0x6fa88000)
        libXrender.so.1 => /usr/lib/libXrender.so.1 (0x6fa5c000)
        libfontconfig.so.1 => /usr/lib/libfontconfig.so.1 (0x6f9fd000)
        libpangoxft-1.0.so.0 => /usr/lib/libpangoxft-1.0.so.0 (0x6f9d4000)
        libpangoft2-1.0.so.0 => /usr/lib/libpangoft2-1.0.so.0 (0x6f987000)
        libpango-1.0.so.0 => /usr/lib/libpango-1.0.so.0 (0x6f91c000)
        libgobject-2.0.so.0 => /usr/lib/libgobject-2.0.so.0 (0x6f8aa000)
        libgmodule-2.0.so.0 => /usr/lib/libgmodule-2.0.so.0 (0x6f885000)
        libglib-2.0.so.0 => /usr/lib/libglib-2.0.so.0 (0x6f7b6000)
        libgtk-x11-2.0.so.0 => /usr/lib/libgtk-x11-2.0.so.0 (0x6f394000)
        libgdk-x11-2.0.so.0 => /usr/lib/libgdk-x11-2.0.so.0 (0x6f2c9000)
        libatk-1.0.so.0 => /usr/lib/libatk-1.0.so.0 (0x6f283000)
        libgdk_pixbuf-2.0.so.0 => /usr/lib/libgdk_pixbuf-2.0.so.0 (0x6f247000)
        libpangocairo-1.0.so.0 => /usr/lib/libpangocairo-1.0.so.0 (0x6f21e000)
        libcairo.so.2 => /usr/lib/libcairo.so.2 (0x6f19d000)
        libm.so.6 => /lib/libm.so.6 (0x6f108000)
        libstdc++.so.6 =>
/usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/libstdc++.so.6 (0x6ef97000)
        libgcc_s.so.1 =>
/usr/lib/gcc/powerpc-unknown-linux-gnu/3.4.4/libgcc_s.so.1 (0x6ef65000)
        libc.so.6 => /lib/libc.so.6 (0x6ee16000)
        /lib/ld.so.1 (0x08000000)
        libXext.so.6 => /usr/lib/libXext.so.6 (0x6eddf000)
        libexpat.so.0 => /usr/lib/libexpat.so.0 (0x6ed99000)
        libz.so.1 => /usr/lib/libz.so.1 (0x6ed62000)
        libXrandr.so.2 => /usr/lib/libXrandr.so.2 (0x6ed3c000)
        libXi.so.6 => /usr/lib/libXi.so.6 (0x6ed10000)
        libXinerama.so.1 => /usr/lib/libXinerama.so.1 (0x6eceb000)
        libXcursor.so.1 => /usr/lib/libXcursor.so.1 (0x6ecbe000)
        libXfixes.so.3 => /usr/lib/libXfixes.so.3 (0x6ec96000)
        libpng12.so.0 => /usr/lib/libpng12.so.0 (0x6ec48000)
undefined symbol: pango_x_list_subfonts
(/usr/lib/mozilla-firefox/components/libgfx_gtk.so)
undefined symbol: pango_x_font_subfont_xlfd    
(/usr/lib/mozilla-firefox/components/libgfx_gtk.so)
undefined symbol: pango_x_font_map_for_display 
(/usr/lib/mozilla-firefox/components/libgfx_gtk.so)

Is the fedora patch this one ?
/usr/portage/www-client/mozilla-firefox/files/1.5/firefox-nopangoxft.patch




Comment 7


Olivier Castan





          2005-11-03 08:28:03 UTC
        

Successful build and working firefox adding :
        # patch from fedora to remove the pangoxft things
        epatch ${FILESDIR}/1.5/firefox-nopangoxft.patch
to mozilla-firefox-1.0.7-r3.ebuild




Comment 8


Henrique Ferreiro





          2005-11-13 06:41:08 UTC
        

*** Bug 112008 has been marked as a duplicate of this bug. ***




Comment 9


William Keaney





          2005-11-26 21:35:29 UTC
        

(In reply to comment #7)
> Successful build and working firefox adding :
>         # patch from fedora to remove the pangoxft things
>         epatch ${FILESDIR}/1.5/firefox-nopangoxft.patch
> to mozilla-firefox-1.0.7-r3.ebuild

Tried that with thunderbird, but the thunderbird version of the patch breaks the
ebuild by trying to patch nonexistent files.  I also tried applying the firefox
patch to the thunderbird ebuild; it started compiling the first time I tried,
but I can't reproduce that for some reason.




Comment 10


Jakub Moc (RETIRED)






          2006-01-19 11:07:37 UTC
        

*** Bug 119578 has been marked as a duplicate of this bug. ***




Comment 11


Jorge Nerin





          2006-01-19 11:22:12 UTC
        

Can we up the severity to critical? 

In a newly installed gentoo 2005.1 you can't use mozilla-thundebird-1.0.7 because of this, after installing it you have to launch thunderbird using a LD_PRELOAD hack, moznoxft flag does not help, you can have it set or unset:

LD_PRELOAD=/usr/lib/libpangox-1.0.so thunderbird





Comment 12


Jorge Nerin





          2006-01-23 01:52:19 UTC
        

It seems that the cause of forgetting to link against pangox is the use of gtk+ 2.8 as it says here http://www.rosenauer.org/blog/2005/08/19/gtk-fun/:

[quote]
pangoxft-1.0 and pangox-1.0 will not be linked in the static {application}-bin because they were used to be in MOZ_GTK2_LIBS before which they aren




Comment 13


Jorge Nerin





          2006-01-23 01:52:19 UTC
        

It seems that the cause of forgetting to link against pangox is the use of gtk+ 2.8 as it says here http://www.rosenauer.org/blog/2005/08/19/gtk-fun/:

[quote]
pangoxft-1.0 and pangox-1.0 will not be linked in the static {application}-bin because they were used to be in MOZ_GTK2_LIBS before which they arent now as gtk2.8 is based on cairo.
[/quote]




Comment 14


Jorge Nerin





          2006-02-22 10:39:47 UTC
        

Well, this bug is very old and has bitten a lot of people (at least all the new installations that I know), now you can't use thunderbird-1.0.7 in gentoo 2005.1.

You can hack a way thought, edit /usr/bin/thunderbird so it ends like this:

#!/bin/sh
#
# Stub script to run mozilla-launcher.  We used to use a symlink here
# but OOo brokenness makes it necessary to use a stub instead:
# http://bugs.gentoo.org/show_bug.cgi?id=78890
#
# Hack around undefined symbol in libgfx_gtk
# http://bugs.gentoo.org/show_bug.cgi?id=109231

export LD_PRELOAD=/usr/lib/libpangox-1.0.so
export MOZILLA_LAUNCHER=thunderbird
export MOZILLA_LIBDIR=/usr/lib/mozilla-thunderbird
export MOZ_PLUGIN_PATH=${MOZ_PLUGIN_PATH:-/usr/lib/nsbrowser/plugins}
exec /usr/libexec/mozilla-launcher "$@"


The line which preloads libpangox is your only hope to use thunderbird.




Comment 15


Carlos Bidea





          2006-03-18 19:17:44 UTC
        

Thank you for your explanations!

I had the same problem with both firefox and thunderbird, and they work for me now with the LD_PRELOAD sentence.

To confirm the explanation I did

emerge --oneshot =gtk+-2.6.10-r1; emerge mozilla-firefox; emerge --oneshot gtk+

and, it works now (without the LDPRELOAD). (Till next update ;)





Comment 16


Pacho Ramos






          2006-10-21 03:37:08 UTC
        

Is this bug still valid today, after upgrading all the system?




Comment 17


Christian Marie (RETIRED)






          2006-12-18 19:07:18 UTC
        

Works for Anarchy.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

