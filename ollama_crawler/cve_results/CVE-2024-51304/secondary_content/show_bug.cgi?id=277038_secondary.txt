Title: 277038 – x86 with LV greater than 2T freezes during boot
URL: https://bugs.gentoo.org/show_bug.cgi?id=277038

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 277038
x86 with LV greater than 2T freezes during boot
Last modified: 2009-08-01 05:47:55 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 277038 
      - x86 with LV greater than 2T freezes during boot


Summary:
x86 with LV greater than 2T freezes during boot
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-07-08 14:33 UTC by Rodrigo Severo





      Modified:
    
2009-08-01 05:47 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Rodrigo Severo





          2009-07-08 14:33:22 UTC
        

I have a backup server where I'm trying to install 4 1.5T hard disks and create a few LVs greater than 2T on the resulting VG.

After creating the first LV the x86 server freezes during boot, during or after the "Processing uevents" step.

If I get the same hard disks and connect them in a amd64 machine, it works just fine.

To allow the x86 server to boot with these hard disks connected I had to remove "Device mapper" from the kernel as even using "dd if=/dev/zero of=/dev/sd[bcde]" didn't solve the freezing issue.

LVM claims support for 16T on 32 bits machines. I'm afraid this is a Gentoo specific issue (some init script maybe?)

# emerge --info
Portage 2.1.6.13 (default/linux/x86/2008.0/desktop, gcc-4.3.2, glibc-2.9_p20081201-r2, 2.6.29-gentoo-r5 i686)
=================================================================
System uname: Linux-2.6.29-gentoo-r5-i686-AMD_Sempron-tm-_Processor_2600+-with-glibc2.0
Timestamp of tree: Wed, 08 Jul 2009 09:30:01 +0000
distcc 3.1 i686-pc-linux-gnu [enabled]
ccache version 2.4 [enabled]
app-shells/bash:     3.2_p39
dev-lang/python:     2.5.4-r3
dev-util/ccache:     2.4-r7
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.6-r2
sys-devel/autoconf:  2.63
sys-devel/automake:  1.7.9-r1, 1.10.2
sys-devel/binutils:  2.18-r3
sys-devel/gcc-config: 1.4.1
sys-devel/libtool:   1.5.26
virtual/os-headers:  2.6.27-r2
ACCEPT_KEYWORDS="x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O3 -march=athlon-xp -fomit-frame-pointer"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/gconf /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O3 -march=athlon-xp -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="ccache distcc distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="ftp://ftp.las.ic.unicamp.br/pub/gentoo/  http://open-systems.ufl.edu/mirrors/gentoo http://mirror.fslutd.org/linux/distributions/gentoo/  http://gentoo.osuosl.org/"
LANG="en_US"
LC_ALL="en_US.UTF-8"
LDFLAGS="-Wl,-O1"
MAKEOPTS="-j5"
PKGDIR="/var/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage-fabrica /usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext acpi alsa apache2 bluetooth branding bzip2 cdr cli cracklib crypt cups dbus dri dvd dvdr dvdread eds emboss encode esd evo fam firefox fortran gdbm gmp gpm gstreamer iconv isdnlog jbig jpeg jpeg2k ldap libnotify mad midi mikmod mmx mmxext mp3 mpeg mudflap mysql ncurses nptl nptlonly ogg opengl openmp pam pcre perl png ppds pppd python qt3support quicktime readline reflection sdl session snmp spl sse ssl startup-notification svg sysfs tcpd tiff truetype unicode vorbis win32codecs x86 xml xorg xulrunner xv zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="access auth auth_dbm auth_anon auth_digest alias file-cache echo  charset-lite cache disk-cache mem-cache ext-filter case_filter case-filter-in deflate  mime-magic cern-meta expires headers usertrack unique-id proxy proxy-connect proxy-ftp  proxy-http info include cgi cgid dav dav-fs vhost-alias speling rewrite log_config logio  env setenvif mime status autoindex asis negotiation dir imap actions userdir so" APACHE2_MPMS="prefork" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" USERLAND="GNU" VIDEO_CARDS="fbdev glint i810 intel mach64 mga neomagic nv r128 radeon savage sis tdfx trident vesa vga via vmware voodoo"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LINGUAS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Christian Faulhammer (RETIRED)






          2009-07-08 15:00:04 UTC
        

Don't cc yourself.




Comment 2


Wormo (RETIRED)






          2009-07-16 07:10:11 UTC
        

There's not going to be too many people out there with the right setup to try to reproduce this problem (big disks yet not running in 64-bit mode).

Suggestions in case you are still up for trying to track this down:
* turn on boot message logging (RC_BOOTLOG=yes in /etc/conf.d/rc, also might need to emerge showconsole)
* make udev noisy
  /etc/udev/udev.conf: udev_log="info"
* report back what udev did right before the hang (if you're lucky, it will have made it into your boot log before the hang; if not, you'll have to write it down)




Comment 3


Matthias Schwarzott






          2009-07-27 14:51:31 UTC
        

sys-fs/lvm2 installs some udev rules into /etc/udev/rules.d/64-device-mapper.rules

You could try to remove these (all but the first line).
They basically call dmsetup to get some properties of the devices and add symlinks under /dev/disk/





Comment 4


Rodrigo Severo





          2009-07-27 14:54:56 UTC
        

Sorry for not answering before.

The original server with the problem was substituted because of this issue.

I tried to reproduce the problem in another server but unfortunatelly I couldn't.

If nobody else can reproduce it, I believe it should be closed as "CAN'T REPRODUCE" or something similar.




Comment 5


Wormo (RETIRED)






          2009-08-01 05:47:55 UTC
        

Well, glad it's working for you now at least. Closing until (unless?) it can be reproduced.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

