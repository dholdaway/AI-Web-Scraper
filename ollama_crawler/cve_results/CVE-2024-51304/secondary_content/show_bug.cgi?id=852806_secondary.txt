Title: 852806 – sys-apps/portage-3.0.30-r5: unable to upgrade due to unsolvable qt slot conflicts
URL: https://bugs.gentoo.org/show_bug.cgi?id=852806

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 852806
sys-apps/portage-3.0.30-r5: unable to upgrade due to unsolvable qt slot conflicts
Last modified: 2022-07-11 12:24:32 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 852806 
      - sys-apps/portage-3.0.30-r5: unable to upgrade due to unsolvable qt slot conflicts


Summary:
sys-apps/portage-3.0.30-r5: unable to upgrade due to unsolvable qt slot confl...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Portage Development




Classification:

Unclassified




Component:

Core

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Portage team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2022-06-17 15:42 UTC by Pacho Ramos





      Modified:
    
2022-07-11 12:24 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge output

              (1.txt,64.65 KB,
                text/plain)

            
2022-06-17 15:43 UTC,

            Pacho Ramos




Details





emerge -pev @world --backtrack=0 output

              (2.txt,202.11 KB,
                text/plain)

            
2022-06-17 16:06 UTC,

            Pacho Ramos




Details





emerge -pev @world --backtrack=0 output

              (1.txt,201.75 KB,
                text/plain)

            
2022-06-18 10:51 UTC,

            Pacho Ramos




Details





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Pacho Ramos






          2022-06-17 15:42:56 UTC
        

I am having this issue in multiple systems... I have verified I am not mixing stable and testing qt packages... but I am still unable to upgrade:
(file attached to the bug)

I have tried multiple backtrack values from 30 to 9999, also tried with --autounmask=n... but I am still unable to proceed and neither understand why it tries to pull in both versions :/ 

I also looked in the forums but none of the workarounds worked (I would also prefer to find the real culprit because I think last time this happened to me, I "solved" it by manually emerging the offending packages... but the real problem remained hidden it seems).

Thanks a lot for your help

Portage 3.0.30 (python 3.9.12-final-0, default/linux/amd64/17.1/desktop/gnome/systemd, gcc-11.3.0, glibc-2.34-r13, 5.15.41-gentoo x86_64)
=================================================================
System uname: Linux-5.15.41-gentoo-x86_64-Intel-R-_Core-TM-_i5-6600_CPU_@_3.30GHz-with-glibc2.34
KiB Mem:    24511652 total,   4945680 free
KiB Swap:    8388604 total,   8360956 free
Timestamp of repository gentoo: Fri, 17 Jun 2022 00:45:01 +0000
sh bash 5.1_p16
ld GNU ld (Gentoo 2.37_p1 p2) 2.37
ccache version 4.5.1 [enabled]
app-misc/pax-utils:        1.3.3::gentoo
app-shells/bash:           5.1_p16::gentoo
dev-java/java-config:      2.3.1::gentoo
dev-lang/perl:             5.34.1-r3::gentoo
dev-lang/python:           2.7.18_p15::gentoo, 3.9.12::gentoo, 3.10.4::gentoo
dev-lang/rust-bin:         1.60.0::gentoo
dev-util/ccache:           4.5.1::gentoo
dev-util/cmake:            3.22.4::gentoo
dev-util/meson:            0.61.4-r2::gentoo
sys-apps/baselayout:       2.8::gentoo
sys-apps/openrc:           0.44.10::gentoo
sys-apps/sandbox:          2.29::gentoo
sys-apps/systemd:          250.6::gentoo
sys-devel/autoconf:        2.13-r1::gentoo, 2.71-r1::gentoo
sys-devel/automake:        1.16.5::gentoo
sys-devel/binutils:        2.37_p1-r2::gentoo
sys-devel/binutils-config: 5.4.1::gentoo
sys-devel/gcc:             11.3.0::gentoo
sys-devel/gcc-config:      2.5-r1::gentoo
sys-devel/libtool:         2.4.6-r6::gentoo
sys-devel/llvm:            13.0.1::gentoo, 14.0.4::gentoo
sys-devel/make:            4.3::gentoo
sys-kernel/linux-headers:  5.15-r3::gentoo (virtual/os-headers)
sys-libs/glibc:            2.34-r13::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: webrsync
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000
    sync-webrsync-verify-signature: no

x-portage
    location: /usr/local/portage
    masters: gentoo
    priority: 0

guru
    location: /var/lib/layman/guru
    masters: gentoo
    priority: 50

science
    location: /var/lib/layman/science
    masters: gentoo
    priority: 50

src_prepare-overlay
    location: /var/lib/layman/src_prepare-overlay
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O2 -pipe -march=native -fno-stack-protector"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /opt/cxoffice/etc/cxoffice.conf /usr/share/config /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php8.0/ext-active/ /etc/php/cgi-php8.0/ext-active/ /etc/php/cli-php8.0/ext-active/ /etc/php/fpm-php8.0/ext-active/ /etc/php/phpdbg-php8.0/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-O2 -pipe -march=native -fno-stack-protector"
DISTDIR="/usr/distfiles"
EMERGE_DEFAULT_OPTS="--quiet-build=n --autounmask-write --keep-going --autounmask=y --autounmask-keep-masks"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe -march=native -fno-stack-protector"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs buildpkg-live ccache config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe -march=native -fno-stack-protector"
GENTOO_MIRRORS="ftp://ftp.free.fr/mirrors/ftp.gentoo.org/"
LANG="es_ES.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="es es_ES en en_US fr fr_FR"
MAKEOPTS="-j5"
PKGDIR="/usr/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/var/tmp"
SHELL="/bin/bash"
USE="7z 7zip X a52 aac acl acpi alsa amd64 apache2 applet archive avahi bash-completion bluetooth bluray branding btrfs bzip2 cairo ccache cdda cddb cdr cgi chm chrome chromecast chromium cli colord context crypt cups cvs dbus dell dia djvu dot dri dts dvd dvdr dvi ebook eds emoji enchant encode epspdf equalizer ethernet evince evo excel exif fat ffmpeg firefox flac fortran fuse games gdbm gdk-pixbuf gdm gedit gif gimp git github gitlab gnome gnome-keyring gnome-online-accounts gnome-shell gnumeric google googledrive gphoto2 gpm grammar graphics gromacs gstreamer gtk gtk3 gtkstyle gui heif hfs html http humanities hwaccel ico icons iconv icu inkscape inotify introspection ios ipod irc iso jabber jpeg kate kpathsea latex lcms libass libdrm libglvnd libnotify librtmp libsecret libtirpc libv4l libvisual lm_sensors luatex lyx lz4 lzma lzo mad math matplotlib matroska media mediaplayer metapost mms mng mobi monolithic-build mp3 mp4 mpeg ms mtp multilib music musicbrainz nautilus ncurses network network-cron networkmanager nls nptl ntfs ntp numa offensive ogg opengl openmp openvpn optimized-qmake opus pam pango pdf pdfannotextractor pdfimport php pipelight png policykit postscript ppapi ppds pptx projectm proprietary-codecs pstricks publishers pulseaudio qt5 rar raw rcs rdp readline reiserfs rtf rtmp scanner science sdl seccomp sendto sftp smp sna snmp spell split-usr squashfs ssh ssl startup-notification subtitles svg sysprof systemd t1lib tcpd tex4ht theora thesaurus threads tiff totem tracker truetype udev udf udisks unicode update_drivedb upnp upnp-av upower usb user-session v4l vaapi vala vcd vdpau vimeo visio vlc vnc vorbis vpx wayland webp wifi wma wmf wpg wxwidgets x264 x265 xattr xcb xetex xfs xft xindy xml xmp xmpp xpm xps xv xvid xz youtube zeroconf zlib zotero zstd" ABI_X86="64" ADA_TARGET="gnat_2020" ALSA_CARDS="hda-intel" APACHE2_MODULES="authn_core authz_core socache_shmcb unixd actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt sse sse2 sse3 sse4_1 sse4_2 ssse3" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput wacom" KERNEL="linux" L10N="es es-ES en en-US fr fr-FR" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-4 php8-0" POSTGRES_TARGETS="postgres12 postgres13" PYTHON_SINGLE_TARGET="python3_9" PYTHON_TARGETS="python3_9" RUBY_TARGETS="ruby27" USERLAND="GNU" VIDEO_CARDS="fbdev vesa intel i965" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq proto steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  ADDR2LINE, AR, ARFLAGS, AS, ASFLAGS, CC, CCLD, CONFIG_SHELL, CPP, CPPFLAGS, CTARGET, CXX, CXXFILT, ELFEDIT, EXTRA_ECONF, F77FLAGS, FC, GCOV, GPROF, INSTALL_MASK, LC_ALL, LD, LEX, LFLAGS, LIBTOOL, MAKE, MAKEFLAGS, NM, OBJCOPY, OBJDUMP, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, RANLIB, READELF, RUSTFLAGS, SIZE, STRINGS, STRIP, YACC, YFLAGS




Comment 1


Pacho Ramos






          2022-06-17 15:43:53 UTC
        

Created attachment 785984 [details]
emerge output




Comment 2


Sam James









          2022-06-17 15:59:59 UTC
        

1. Try --autounmask=n
2. Share output of emerge -pev @world --backtrack=0




Comment 3


Pacho Ramos






          2022-06-17 16:06:31 UTC
        

Created attachment 785987 [details]
emerge -pev @world --backtrack=0 output

(In reply to Sam James from comment #2)
> 1. Try --autounmask=n

That I tried before reporting the bug and it was the same :(




Comment 4


Sam James









          2022-06-17 17:23:07 UTC
        

(In reply to Pacho Ramos from comment #3)
> Created attachment 785987 [details]
> emerge -pev @world --backtrack=0 output
> 
> (In reply to Sam James from comment #2)
> > 1. Try --autounmask=n
> 
> That I tried before reporting the bug and it was the same :(

I think it might be related to gnutls. 

```
net-libs/gnutls:0

  (net-libs/gnutls-3.7.6:0/30.30::gentoo, ebuild scheduled for merge) USE="cxx idn nls openssl seccomp tls-heartbeat zlib zstd -brotli -dane -doc -examples -guile -pkcs11 -sslv2 -sslv3 -static-libs -test (-test-full) -tools -valgrind -verify-sig" ABI_X86="32 (64) (-x32)" conflicts with
    net-libs/gnutls:0/30[abi_x86_32(-)] required by (app-emulation/crossover-bin-21.2.0:0/0::gentoo, ebuild scheduled for merge) USE="capi cups gphoto2 gsm gstreamer jpeg lcms mp3 nls openal opencl opengl pcap png scanner ssl v4l vulkan -doc -ldap -osmesa" ABI_X86="(64)" PYTHON_SINGLE_TARGET="python3_9 -python3_10 -python3_8"
                   ^^^^^               
```

New GnuTLS broke ABI but only for C++. I bet crossover-bin doesn't use that. Let me fix that at least.



(You should emerge --deselect all those kernels by the way.)




Comment 5


Larry the Git Cow






          2022-06-17 17:24:56 UTC
        

The bug has been referenced in the following commit(s):

https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=0628614788d1f1065eece02e80d1503d93a24796

commit 0628614788d1f1065eece02e80d1503d93a24796
Author:     Sam James <sam@gentoo.org>
AuthorDate: 2022-06-17 17:24:40 +0000
Commit:     Sam James <sam@gentoo.org>
CommitDate: 2022-06-17 17:24:50 +0000

    app-emulation/crossover-bin: allow newer gnutls
    
    Only C++ ABI was broken and it's niche. Not many consumers of it.
    
    Bug: https://bugs.gentoo.org/852806
    Signed-off-by: Sam James <sam@gentoo.org>

 ...sover-bin-21.1.0-r1.ebuild => crossover-bin-21.1.0-r2.ebuild} | 9 +++++++--
 ...rossover-bin-21.2.0.ebuild => crossover-bin-21.2.0-r1.ebuild} | 7 ++++++-
 2 files changed, 13 insertions(+), 3 deletions(-)




Comment 6


Pacho Ramos






          2022-06-18 10:51:31 UTC
        

Created attachment 786053 [details]
emerge -pev @world --backtrack=0 output

Thanks

But sadly, the problem remains :(




Comment 7


Zac Medico






          2022-06-18 22:56:33 UTC
        

Does it suppress the slot conflict if you use --pretend --ignore-built-slot-operator-deps=y ?




Comment 8


Sam James









          2022-06-18 23:35:00 UTC
        

Also, deselect onlyoffice-bin?




Comment 9


Pacho Ramos






          2022-06-26 17:56:10 UTC
        

(In reply to Sam James from comment #8)
> Also, deselect onlyoffice-bin?

That didn't change anything :(

(In reply to Zac Medico from comment #7)
> Does it suppress the slot conflict if you use --pretend
> --ignore-built-slot-operator-deps=y ?

--ignore-built-slot-operator-deps=y looks to pretend to be able to continue ... should I proceed or keep it "broken" for trying to fix the root cause? 

Thanks




Comment 10


Pacho Ramos






          2022-07-07 10:26:35 UTC
        

Any other suggestion? :/

If not I will try to upgrade with the --ignore-built-slot-operator-deps=y workaround I think




Comment 11


Pacho Ramos






          2022-07-11 12:24:32 UTC
        

It seems some other updated on the ebuilds solved the problem and now I don't need to do anything special :/









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

