Title: 807211 – Compile of sys-devel/llvm-12.0.1 crashes system
URL: https://bugs.gentoo.org/show_bug.cgi?id=807211

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 807211
Compile of sys-devel/llvm-12.0.1 crashes system
Last modified: 2021-08-10 18:54:19 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 807211 
      - Compile of sys-devel/llvm-12.0.1 crashes system


Summary:
Compile of sys-devel/llvm-12.0.1 crashes system
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2021-08-08 20:24 UTC by Ira Moss





      Modified:
    
2021-08-10 18:54 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



jstein









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Ira Moss





          2021-08-08 20:24:52 UTC
        

While in the middle of emerge of sys-devel/llvm-12.0.1 system becomes panics and reboots

Reproducible: Always

Steps to Reproduce:
1. emerge -DuN world --with-bdeps\=y  --color\=y  --quiet -va
2. tail -f /var/log/portage/sys-devel:llvm-12.0.1:20210808-162947.log
3.
Actual Results:  
NOTHING in the logs about the panic (journalctl)
But has happened every time I'm at this stage in the emerge

```[193/2033] /usr/bin/x86_64-pc-linux-gnu-g++ -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -Iutils/TableGen -I/tmp-port/portage/sys-devel/llvm-12.0.1/work/llvm/utils/TableGen -Iinclude -I/tmp
-port/portage/sys-devel/llvm-12.0.1/work/llvm/include  -DNDEBUG -march=native -O2 -pipe -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initi
alizers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wsuggest-override -Wno-comment -fdiagnostics-color -ffunctio
n-sections -fdata-sections -std=c++14 -MD -MT utils/TableGen/CMakeFiles/llvm-tblgen.dir/RegisterBankEmitter.cpp.o -MF utils/TableGen/CMakeFiles/llvm-tblgen.dir/RegisterBankEmitter.cpp.o.d -o utils/TableGen/CMakeFiles/llvm-tblgen
.dir/RegisterBankEmitter.cpp.o -c /tmp-port/portage/sys-devel/llvm-12.0.1/work/llvm/utils/TableGen/RegisterBankEmitter.cpp
```

Expected Results:  
no crash

I've also shutdown almost every process on the system (almost) to see if something else was at issue during compile

systemctl stop apache2.service mysqld.service redis.service gdm.service cups-browsed.service cups.service nfsdcld.service nfs-idmapd.service nfs-mountd.service nfs-server.service avahi-daemon docker



Last line in portage log before crash:

[181/2033] /usr/bin/x86_64-pc-linux-gnu-g++ -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS -Iutils/TableGen -I/tmp-port/portage/sys-devel/llvm-12.0.1/work/llvm/utils/TableGen -Iinclude -I/tmp-port/portage/sys-devel/llvm-12.0.1/work/llvm/include  -DNDEBUG -march=native -O2 -pipe -fPIC -fvisibility-inlines-hidden -Werror=date-time -Wall -Wextra -Wno-unused-parameter -Wwrite-strings -Wcast-qual -Wno-missing-field-initializers -pedantic -Wno-long-long -Wimplicit-fallthrough -Wno-maybe-uninitialized -Wno-class-memaccess -Wno-redundant-move -Wno-noexcept-type -Wdelete-non-virtual-dtor -Wsuggest-override -Wno-comment -fdiagnostics-color -ffunction-sections -fdata-sections -std=c++14 -MD -MT utils/TableGen/CMakeFiles/llvm-tblgen.dir/GICombinerEmitter.cpp.o -MF utils/TableGen/CMakeFiles/llvm-tblgen.dir/GICombinerEmitter.cpp.o.d -o utils/TableGen/CMakeFiles/llvm-tblgen.dir/GICombinerEmitter.cpp.o -c /tmp-port/portage/sys-devel/llvm-12.0.1/work/llvm/utils/TableGen/GICombinerEmitter.cpp




last few lines (in reverse order) on journald

Aug 08 11:27:22 eridani kernel: pci_bus 0000:01: resource 1 [mem 0xf6000000-0xf70fffff]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:01: resource 0 [io  0xe000-0xefff]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 13 [mem 0xe0000000-0xfeafffff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 12 [mem 0x000e4000-0x000e7fff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 11 [mem 0x000e0000-0x000e3fff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 10 [mem 0x000dc000-0x000dffff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 9 [mem 0x000d8000-0x000dbfff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 8 [mem 0x000d4000-0x000d7fff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 7 [mem 0x000d0000-0x000d3fff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 6 [mem 0x000a0000-0x000bffff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 5 [io  0x0d00-0xffff window]
Aug 08 11:27:22 eridani kernel: pci_bus 0000:00: resource 4 [io  0x0000-0x0cf7 window]
Aug 08 11:27:22 eridani kernel: pci 0000:00:1c.7:   bridge window [mem 0xf7600000-0xf76fffff]
Aug 08 11:27:22 eridani kernel: pci 0000:00:1c.7:   bridge window [io  0xb000-0xbfff]
Aug 08 11:27:22 eridani kernel: pci 0000:00:1c.7: PCI bridge to [bus 0b]
Aug 08 11:27:22 eridani kernel: pci 0000:00:1c.6:   bridge window [mem 0xf7700000-0xf77fffff]
Aug 08 11:27:22 eridani kernel: pci 0000:00:1c.6:   bridge window [io  0xc000-0xcfff]
Aug 08 11:27:22 eridani systemd-journald[1453]: Missed 502 kernel messages
Aug 08 11:27:22 eridani systemd-journald[1453]: Runtime Journal (/run/log/journal/f25e1afaace7696314a4d0445743443d) is 8.0M, max 798.8M, 790.8M free.
Aug 08 11:27:22 eridani systemd-journald[1453]: Journal started
-- Boot eb15bbe191324ed5acb2de111becfa44 --
Aug 08 11:25:31 eridani weewxd[1877]: weewx[1877] INFO weewx.manager: Added record 2021-08-08 11:25:00 MDT (1628443500) to daily summary in 'weewx.sdb'
Aug 08 11:25:31 eridani weewxd[1877]: weewx[1877] INFO weewx.manager: Added record 2021-08-08 11:25:00 MDT (1628443500) to database 'weewx.sdb'




emerge --info
Portage 3.0.20 (python 3.9.6-final-0, default/linux/amd64/17.1/desktop/gnome/systemd, gcc-10.3.0, glibc-2.33-r1, 5.10.27-gentoo-x86_64 x86_64)
=================================================================
System uname: Linux-5.10.27-gentoo-x86_64-x86_64-Intel-R-_Core-TM-_i5-2500K_CPU_@_3.30GHz-with-glibc2.33
KiB Mem:    16360204 total,  10688496 free
KiB Swap:          0 total,         0 free
Head commit of repository gentoo: d140a4f2c4e30dee8e7d633e42a47c8f954ca465

sh bash 5.1_p8
ld GNU ld (Gentoo 2.35.2 p1) 2.35.2
app-shells/bash:          5.1_p8::gentoo
dev-java/java-config:     2.3.1::gentoo
dev-lang/perl:            5.34.0::gentoo
dev-lang/python:          3.8.11::gentoo, 3.9.6_p1::gentoo
dev-lang/rust-bin:        1.53.0::gentoo
dev-util/cmake:           3.20.5::gentoo
sys-apps/baselayout:      2.7::gentoo
sys-apps/sandbox:         2.24::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r5::gentoo
sys-devel/automake:       1.16.3-r1::gentoo
sys-devel/binutils:       2.35.2::gentoo
sys-devel/gcc:            10.3.0-r2::gentoo
sys-devel/gcc-config:     2.4::gentoo
sys-devel/libtool:        2.4.6-r6::gentoo
sys-devel/make:           4.3::gentoo
sys-kernel/linux-headers: 5.10::gentoo (virtual/os-headers)
sys-libs/glibc:           2.33-r1::gentoo
Repositories:

gentoo
    location: /home/portage
    sync-type: git
    sync-uri: rsync://rsync.gentoo.org/gentoo-portage
    priority: -1000

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/config /usr/share/easy-rsa /usr/share/gnupg/qualified.txt /usr/share/maven-bin-3.8/conf /var/bind"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php7.3/ext-active/ /etc/php/apache2-php7.4/ext-active/ /etc/php/cgi-php7.3/ext-active/ /etc/php/cgi-php7.4/ext-active/ /etc/php/cli-php7.3/ext-active/ /etc/php/cli-php7.4/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=native -O2 -pipe"
DISTDIR="/media/portage-distfiles"
ENV_UNSET="CARGO_HOME DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN GOPATH PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs clean-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned qa-unresolved-soname-deps sandbox sfperms strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://distfiles.gentoo.org"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en_US en"
MAKEOPTS="-j3 -l2"
PKGDIR="/media/portage-packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/tmp-port"
USE="X a52 aac acl acpi alsa amd64 avahi bash-completion blueray bluetooth bluray branding btrfs bzip2 cairo cdda cdr cli colord crypt cryptsetup cups dbus device-mapper dri dts dv dvb dvd dvdr eds egl emboss encode evo exif fat flac fortran gdbm gif gles gles2 gnome gnome-keyring gnome-online-accounts gpg gpm gstreamer gtk gui hfs iconv icu ieee1394 imagemagick introspection ipv6 jpeg jpeg2k lcms libglvnd libnotify libsecret libtirpc libv4l mad matroska mmx mng mp3 mp4 mpeg mtp multilib nautilus ncurses networkmanager nls nptl ntfs nvenc ogg opengl openmp pam pango pcre pdf png policykit ppds pulseaudio qt5 readline sdl seccomp spell split-usr ssl ssse3 startup-notification svg syslog sysprof systemd tcpd tiff tracker truetype twolame udev udisks unicode upnp upower usb v4l vhosts vorbis wayland wext wifi wxwidgets x264 xattr xcb xml xv xvid yuv4mpeg zeroconf zlib" ABI_X86="64" ADA_TARGET="gnat_2018" ALSA_CARDS="hda-intel" APACHE2_MODULES="actions alias auth_basic auth_digest authn_alias authn_anon authn_core authn_dbm authn_file authz_core authz_dbm authz_groupfile authz_host authz_owner authz_user autoindex cache cgi cgid dav dav_fs dav_lock deflate dir env expires ext_filter file_cache filter headers include info log_config logio mime mime_magic negotiation rewrite setenvif socache_shmcb speling status unique_id unixd userdir usertrack vhost_alias proxy proxy_http log_forensic https remoteip" CALLIGRA_FEATURES="karbon sheets words" CAMERAS="canon pentax p2p2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog aggregation apache battery bind cgroups cpu cpufreq dns email hddtemp mysql network nut openvpn processes protocols python redis rrdcached sensors tail uptime disk match_regex ping" CPU_FLAGS_X86="mmx mmxext sse sse2 sse4_1 sse4_2 ssse3 avx sse3 aes avx" ELIBC="glibc" FFTOOLS="aviocat cws2fws ffescape ffeval ffhash fourcc2pixfmt graph2dot ismindex pktdumper qt-faststart sidxindex trasher" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock greis isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="libinput" KERNEL="linux" L10N="en-GB en en-CA en-US" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LLVM_TARGETS="NVPTX BPF" LUA_SINGLE_TARGET="lua5-1" LUA_TARGETS="lua5-1" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-3" POSTGRES_TARGETS="postgres12 postgres13" PYTHON_SINGLE_TARGET="python3_8" PYTHON_TARGETS="python3_8 python3_9" RUBY_TARGETS="ruby26" SANE_BACKENDS="epson epson2 hp hp3500 hp3900 hp4200 hp5400 hp5590 hpljm1005 hpsj5s hs2p" USERLAND="GNU" VIDEO_CARDS="v4l nvidia" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq proto steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, RUSTFLAGS




Comment 1


Mike Gilbert






          2021-08-09 02:28:34 UTC
        

This sounds like a hardware problem, or some other issue isolated to your system.




Comment 2


Ira Moss





          2021-08-09 02:33:05 UTC
        

Might be... But no kernel panic, and it's ALWAYS the same point in the compile process?

and it doesn't appear to memory related, as I get the reboot if I have tons of processes running, or almost NO processes running.

Ideas on debug then?




Comment 3


Jonas Stein






          2021-08-10 18:54:19 UTC
        

It is sad to read that you have problems with the software. The situation seems to be a bit more complicate and requires some analysis.
We can not help you efficiently via bug tracker. The bug tracker aims rather on specific problems in .ebuilds and less on individual systems. 

I have had very good experience on the gentoo IRC [1] with questions like this. Of course there are also forums and mailing lists [2,3].
I hope you understand, that I will close the bug here therefore and wish you good luck on one of the mentioned channels [4].
Please reopen the ticket in order to provide an indication for an specific error in an ebuild or any gentoo related product.

[1] https://www.gentoo.org/get-involved/irc-channels/
[2] https://forums.gentoo.org/
[3] https://www.gentoo.org/get-involved/mailing-lists/all-lists.html
[4] https://www.gentoo.org/support/









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

