Title: 289940 – dev-libs/soprano-2.3.1: sys-devel/gcc-4.3.4 wrongly tries to include debug/debug.h from /usr/lib/debug when using sys-apps/paludis-0.42.0_alpha
URL: https://bugs.gentoo.org/show_bug.cgi?id=289940

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 289940
dev-libs/soprano-2.3.1: sys-devel/gcc-4.3.4 wrongly tries to include debug/debug.h from /usr/lib/debug when using sys-apps/paludis-0.42.0_alpha
Last modified: 2010-02-11 11:42:18 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 289940 
      - dev-libs/soprano-2.3.1: sys-devel/gcc-4.3.4 wrongly tries to include debug/debug.h from /usr/lib/debug when using sys-apps/paludis-0.42.0_alpha


Summary:
dev-libs/soprano-2.3.1: sys-devel/gcc-4.3.4 wrongly tries to include debug/de...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Unspecified

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-10-21 01:01 UTC by Nicolas Dietrich





      Modified:
    
2010-02-11 11:42 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



quickhelp









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




failed build of soprano

              (failed-build-soprano-2.3.1.log,33.49 KB,
                text/plain)

            
2009-10-21 01:05 UTC,

            Nicolas Dietrich




Details





emerge --info

              (emerge.info.txt,7.43 KB,
                text/plain)

            
2009-12-07 14:28 UTC,

            K. Posern




Details





emerge log

              (dev-libs:soprano-2.3.1-r1:20091207-135854.log,19.71 KB,
                text/plain)

            
2009-12-07 14:28 UTC,

            K. Posern




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Nicolas Dietrich





          2009-10-21 01:01:05 UTC
        

Installing either dev-libs/soprano-2.3.1 or app-misc/strigi-0.7.0 with enabled clucene use flag with sys-apps/paludis-0.42.0_alpha1 fails.

The problem is: gcc tries to include <debug/debug.h> from /usr/lib/debug/debug.h instead of local debug/debug.h from g++ - in my case
/usr/lib/gcc/i686-pc-linux-gnu/4.3.4/include/g++-v4/debug/debug.h

The #include <debug/debug.h> directive is defined in /usr/lib/gcc/i686-pc-linux-gnu/4.3.4/include/g++-v4/bits/stl_algobase.h:76

Moving /usr/lib/debug out of the way, everything builds just fine.

I'm not sure if this is a gcc or a paludis bug (or a missing workaround).

It might be related to bug #140440: scanelf descends into /usr/lib/debug/

Reproducible: Always

Steps to Reproduce:




# paludis --info
paludis 0.42.0_alpha1
Paludis build information:
    Compiler:
        CXX:                   i686-pc-linux-gnu-g++ 4.3.4
        CXXFLAGS:               -O2 -march=pentium-m -pipe -fomit-frame-pointer
        LDFLAGS:               -Wl,-O1
        DATE:                  2009-10-19T18:21:19+0000

    Libraries:
        C++ Library:           GNU libstdc++ 20090804

    Paths:
        DATADIR:               /usr/share
        LIBDIR:                /usr/lib
        LIBEXECDIR:            /usr/libexec
        SYSCONFDIR:            /etc
        PYTHONINSTALLDIR:      
        RUBYINSTALLDIR:        /usr/lib/ruby/site_ruby/1.8/i686-linux

System:
    Linux paste 2.6.31-gentoo-r3 #4 SMP Mon Oct 19 02:16:28 GMT 2009 i686 Genuine Intel(R) CPU L2400 @ 1.66GHz GenuineIntel GNU/Linux

Reduced Privs:
    reduced_uid:               101
    reduced_uid->name:         paludisbuild
    reduced_uid->dir:          /var/tmp/paludis
    reduced_gid:               1000
    reduced_gid->name:         paludisbuild

Environment:
    Format:                    paludis
    Config dir:                /etc/paludis
    World file:                /var/db/pkg/world

Repository installed-virtuals:
    format:                    installed_virtuals
    root:                      /

Repository virtuals:
    format:                    virtuals

Repository gentoo:
    format:                    ebuild
    location:                  /usr/portage
    append_repository_name_to_write_cache: true
    binary_destination:        false
    binary_keywords:           
    binary_uri_prefix:         
    builddir:                  /var/tmp/paludis
    cache:                     /usr/portage/metadata/cache
    distdir:                   /usr/portage/distfiles
    eapi_when_unknown:         0
    eapi_when_unspecified:     0
    eclassdirs:                /usr/portage/eclass
    ignore_deprecated_profiles: false
    layout:                    traditional
    names_cache:               /var/cache/paludis/names
    newsdir:                   /usr/portage/metadata/news
    profile_eapi_when_unspecified: 0
    profiles:                  /usr/portage/profiles/default/linux/x86/10.0
    securitydir:               /usr/portage/metadata/glsa
    setsdir:                   /usr/portage/sets
    sync:                      rsync://rsync.europe.gentoo.org/gentoo-portage/
    sync_options:              
    use_manifest:              use
    write_cache:               /var/empty

    Package information:
        app-admin/eselect-compiler: (none)
        app-shells/bash:       4.0_p28
        dev-java/java-config:  2.1.9-r1
        dev-lang/python:       2.6.2-r1
        dev-python/pycrypto:   (none)
        dev-util/ccache:       (none)
        dev-util/cmake:        2.6.4-r3
        dev-util/confcache:    (none)
        sys-apps/baselayout:   2.0.1
        sys-apps/openrc:       0.5.2-r1
        sys-apps/sandbox:      1.6-r2
        sys-devel/autoconf:    2.63-r1
        sys-devel/automake:    1.10.2 1.9.6-r2
        sys-devel/binutils:    2.18-r3
        sys-devel/gcc-config:  1.4.1
        sys-devel/libtool:     2.2.6a
        virtual/os-headers:    2.6.27-r2 (for sys-kernel/linux-headers::installed)

Repository kde:
    format:                    ebuild
    location:                  /var/paludis/repositories/kde-testing
    append_repository_name_to_write_cache: true
    binary_destination:        false
    binary_keywords:           
    binary_uri_prefix:         
    builddir:                  /var/tmp/paludis
    cache:                     /var/empty
    distdir:                   /usr/portage/distfiles
    eapi_when_unknown:         0
    eapi_when_unspecified:     0
    eclassdirs:                /usr/portage/eclass /var/paludis/repositories/kde-testing/eclass
    ignore_deprecated_profiles: false
    layout:                    traditional
    master_repository:         gentoo
    names_cache:               /var/paludis/repositories/kde-testing/.cache/names
    newsdir:                   /var/paludis/repositories/kde-testing/metadata/news
    profile_eapi_when_unspecified: 0
    profiles:                  /usr/portage/profiles/default/linux/x86/10.0
    securitydir:               /var/paludis/repositories/kde-testing/metadata/glsa
    setsdir:                   /var/paludis/repositories/kde-testing/sets
    sync:                      git://git.overlays.gentoo.org/proj/kde.git
    sync_options:              
    use_manifest:              use
    write_cache:               /var/cache/paludis/metadata




Comment 1


Nicolas Dietrich





          2009-10-21 01:05:08 UTC
        

Created attachment 207769 [details]
failed build of soprano




Comment 2


Peter Alfredsen (RETIRED)






          2009-10-23 12:29:54 UTC
        

Which package owns /usr/lib/debug/debug.h?




Comment 3


Nicolas Dietrich





          2009-10-23 13:06:38 UTC
        

(In reply to comment #2)
> Which package owns /usr/lib/debug/debug.h?

None - there is no /usr/lib/debug/debug.h, only /usr/lib/debug. Oh, I could have mentioned that...

The attached logfile says: (sorry for the bad formatting)

/usr/lib/gcc/i686-pc-linux-gnu/4.3.4/include/g++-v4/bits/stl_algobase.h:76:25: error: /usr/lib/debug/debug.h: Permission denied

And later subsequent errors such as:

/usr/lib/gcc/i686-pc-linux-gnu/4.3.4/include/g++-v4/bits/streambuf_iterator.h: In member function 'std::istreambuf_iterator<_CharT, _Traits>& std::istreambuf_iterator<_CharT, _Traits>::operator++()':
/usr/lib/gcc/i686-pc-linux-gnu/4.3.4/include/g++-v4/bits/streambuf_iterator.h:128: error: '__gnu_debug' has not been declared





Comment 4


Tomáš Chvátal (RETIRED)






          2009-12-01 21:05:07 UTC
        

Please ropen when you try with portage or some sane version of paludis.
I cant reproduce it on any machine, inculding those using splitdebug and other fancy stuff.




Comment 5


K. Posern





          2009-12-07 14:27:03 UTC
        

Same here :( ... with portage.
See attachments:
    emerge.info.txt
    dev-libs:soprano-2.3.1-r1:20091207-135854.log





Comment 6


K. Posern





          2009-12-07 14:28:27 UTC
        

Created attachment 212345 [details]
emerge --info




Comment 7


K. Posern





          2009-12-07 14:28:44 UTC
        

Created attachment 212346 [details]
emerge log




Comment 8


Nicolas Dietrich





          2009-12-08 00:28:17 UTC
        

I am reopening as tormen is able to reproduce the bug with portage.

But: I can't reproduce the bug anymore: dev-libs/soprano-2.3.1-r1 compiles just fine with sys-apps/paludis-0.42.2 and the following configuration:

# paludis --info                                                                                                                                                                                  
paludis 0.42.2
Paludis build information:
    Compiler:
        CXX:                   i686-pc-linux-gnu-g++ 4.3.4
        CXXFLAGS:               -O2 -march=pentium-m -pipe -fomit-frame-pointer
        LDFLAGS:               -Wl,-O1
        DATE:                  2009-11-05T01:55:46+0100

    Libraries:
        C++ Library:           GNU libstdc++ 20090804

    Paths:
        DATADIR:               /usr/share
        LIBDIR:                /usr/lib
        LIBEXECDIR:            /usr/libexec
        SYSCONFDIR:            /etc
        PYTHONINSTALLDIR:      /usr/lib/python2.6/site-packages
        RUBYINSTALLDIR:        /usr/lib/ruby/site_ruby/1.8/i686-linux

System:
    Linux pasta 2.6.32-gentookms #4 SMP Sun Dec 6 11:59:35 CET 2009 i686 Genuine Intel(R) CPU L2400 @ 1.66GHz GenuineIntel GNU/Linux

Reduced Privs:
    reduced_uid:               101
    reduced_uid->name:         paludisbuild
    reduced_uid->dir:          /var/tmp/paludis
    reduced_gid:               1000
    reduced_gid->name:         paludisbuild

Environment:
    Format:                    paludis
    Config dir:                /etc/paludis
    World file:                /var/db/pkg/world

Repository installed-virtuals:
    format:                    installed_virtuals
    root:                      /

Repository virtuals:
    format:                    virtuals

Repository gentoo:
    format:                    ebuild
    location:                  /usr/portage
    append_repository_name_to_write_cache: true
    binary_destination:        false
    binary_keywords:           
    binary_uri_prefix:         
    builddir:                  /var/tmp/paludis
    cache:                     /usr/portage/metadata/cache
    distdir:                   /usr/portage/distfiles
    eapi_when_unknown:         0
    eapi_when_unspecified:     0
    eclassdirs:                /usr/portage/eclass
    ignore_deprecated_profiles: false
    layout:                    traditional
    names_cache:               /var/cache/paludis/names
    newsdir:                   /usr/portage/metadata/news
    profile_eapi_when_unspecified: 0
    profiles:                  /usr/portage/profiles/default/linux/x86/10.0
    securitydir:               /usr/portage/metadata/glsa
    setsdir:                   /usr/portage/sets
    sync:                      rsync://rsync.europe.gentoo.org/gentoo-portage/
    sync_options:              
    use_manifest:              use
    write_cache:               /var/empty

    Package information:
        app-admin/eselect-compiler: (none)
        app-shells/bash:       4.0_p35
        dev-java/java-config:  2.1.9-r1
        dev-lang/python:       2.4.6 2.6.4
        dev-python/pycrypto:   (none)
        dev-util/ccache:       (none)
        dev-util/cmake:        2.8.0
        dev-util/confcache:    (none)
        sys-apps/baselayout:   2.0.1
        sys-apps/openrc:       0.5.3
        sys-apps/sandbox:      1.6-r2
        sys-devel/autoconf:    2.63-r1
        sys-devel/automake:    1.10.2 1.7.9-r1 1.8.5-r3 1.9.6-r2
        sys-devel/binutils:    2.18-r3
        sys-devel/gcc-config:  1.4.1
        sys-devel/libtool:     2.2.6b
        virtual/os-headers:    2.6.27-r2 (for sys-kernel/linux-headers::installed)





Comment 9


Samuli Suominen (RETIRED)






          2009-12-22 10:31:36 UTC
        

The permission for /usr/lib/debug is "drwxr-xr-x" per default umask Portage is using. So it should be readable.




Comment 10


Samuli Suominen (RETIRED)






          2010-02-11 11:42:18 UTC
        

(In reply to comment #9)
> The permission for /usr/lib/debug is "drwxr-xr-x" per default umask Portage is
> using. So it should be readable.
> 

No replies since this, closing as WORKSFORME.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

