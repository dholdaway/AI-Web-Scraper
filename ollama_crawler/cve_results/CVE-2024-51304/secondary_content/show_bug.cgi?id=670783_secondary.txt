Title: 670783 – www-client/netsurf-3.8-r1 fails to build
URL: https://bugs.gentoo.org/show_bug.cgi?id=670783

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 670783
www-client/netsurf-3.8-r1 fails to build
Last modified: 2019-03-31 13:55:59 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 670783 
      - www-client/netsurf-3.8-r1 fails to build


Summary:
www-client/netsurf-3.8-r1 fails to build
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Virgil Dupras (RETIRED)








URL:







Whiteboard:




Keywords:

NeedPatch







Depends on:







Blocks:









 





      Reported:
    
2018-11-09 19:00 UTC by silver_ghost





      Modified:
    
2019-03-31 13:55 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



xmw









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log for www-client/netsurf-3.8-r1.ebuild

              (build.log,458.76 KB,
                text/x-log)

            
2018-11-09 19:00 UTC,

            silver_ghost




Details





build.log for www-client/netsurf-3.8-r2.ebuild

              (build.log,139.35 KB,
                text/x-log)

            
2019-02-06 23:31 UTC,

            silver_ghost




Details





build.log for www-client/netsurf-3.8-r2.ebuild

              (build.log,842.55 KB,
                text/x-log)

            
2019-02-08 21:27 UTC,

            silver_ghost




Details





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


silver_ghost





          2018-11-09 19:00:27 UTC
        

Created attachment 554695 [details]
build.log for www-client/netsurf-3.8-r1.ebuild

Multiple errors related to duktape function calls.




Comment 1


Virgil Dupras (RETIRED)






          2018-11-13 18:19:38 UTC
        

I have troubles reproducing the build failure. netsurfs builds fine with duktape here.

My wild guess is that it might be caused by an old version of nsgenbind you had lying around. Do you still get the failure in the new netsurf-3.8-r2 that I've just pushed (make sure you rebuild nsgenbind too)?




Comment 2


silver_ghost





          2019-02-06 16:23:48 UTC
        

(In reply to Virgil Dupras from comment #1)

> My wild guess is that it might be caused by an old version of nsgenbind you
> had lying around. 
I have dev-libs/nsgenbind-0.3 installed.
> Do you still get the failure in the new netsurf-3.8-r2
> that I've just pushed (make sure you rebuild nsgenbind too)?
Yes, the same behaviour. In RDEPEND it has:
javascript? ( >=dev-libs/nsgenbind-0.3
                !duktape? ( dev-lang/spidermonkey:0= ) )

Am I right that RDEPEND is run dependencies? So shouldn't it be unnecessary at compile time at all?




Comment 3


Virgil Dupras (RETIRED)






          2019-02-06 21:44:41 UTC
        

RDEPEND is also included in DEPEND.

Could you please upload a new build log? Build procedure changed quite a bit between r1 and r2.




Comment 4


silver_ghost





          2019-02-06 23:31:02 UTC
        

Created attachment 564026 [details]
build.log for www-client/netsurf-3.8-r2.ebuild

Multiple errors related to duktape function calls.




Comment 5


Larry the Git Cow






          2019-02-07 13:08:35 UTC
        

The bug has been referenced in the following commit(s):

https://gitweb.gentoo.org/repo/gentoo.git/commit/?id=28d56d2dc6dc0fca4b20917a5a9374ccc3920150

commit 28d56d2dc6dc0fca4b20917a5a9374ccc3920150
Author:     Virgil Dupras <vdupras@gentoo.org>
AuthorDate: 2019-02-07 13:07:03 +0000
Commit:     Virgil Dupras <vdupras@gentoo.org>
CommitDate: 2019-02-07 13:08:02 +0000

    www-client/netsurf: add missing dependency
    
    Bug: https://bugs.gentoo.org/670783
    Signed-off-by: Virgil Dupras <vdupras@gentoo.org>
    Package-Manager: Portage-2.3.51, Repoman-2.3.11

 www-client/netsurf/netsurf-3.8-r2.ebuild | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)




Comment 6


Virgil Dupras (RETIRED)






          2019-02-07 13:11:49 UTC
        

The second error log shows that netsurf-buildsystem is missing (it probably wouldn't hurt to run a little "emerge -uND @world" on your system, your packages must be quite out of date for you to have this problem).

With this new commit I've just pushed, what does the build log look like?




Comment 7


silver_ghost





          2019-02-08 19:52:20 UTC
        

I've got dev-util/netsurf-buildsystem as a dependency for dev-libs/libutf8proc:
$ equery d netsurf-buildsystem 
 * These packages depend on netsurf-buildsystem:
dev-libs/libutf8proc-2.2.0_p1-r1 (dev-util/netsurf-buildsystem)




Comment 8


Virgil Dupras (RETIRED)






          2019-02-08 20:01:17 UTC
        

But then where is your "/usr/share/netsurf-buildsystem/gentoo-helpers.sh" file which is reported as missing in your build log?




Comment 9


silver_ghost





          2019-02-08 21:27:44 UTC
        

Created attachment 564256 [details]
build.log for www-client/netsurf-3.8-r2.ebuild

Now it fails on link stage.




Comment 10


Virgil Dupras (RETIRED)






          2019-02-08 21:42:19 UTC
        

Now? now what? What did you do on your system that made "/usr/share/netsurf-buildsystem/gentoo-helpers.sh" magically appear?

To be honest, I'm not interested in remote-debugging your system, I'll let you do that yourself. If you have a patch that fixes a real and reproducible problem, I'll happily review it.




Comment 11


silver_ghost





          2019-02-08 23:37:52 UTC
        

build.log for www-client/netsurf-3.8-r1.ebuild has line:
>>> Unpacking netsurf-buildsystem-1.7.tar.gz to /var/tmp/portage/www-client/netsurf-3.8-r1/work

(In reply to Virgil Dupras from comment #8)
> But then where is your "/usr/share/netsurf-buildsystem/gentoo-helpers.sh"
> file which is reported as missing in your build log?

I don't know how to recreate it missing now. I've tried to emerge dev-util/netsurf-buildsystem-1.7 now. And it has installed:
-rw-r--r-- 1 root root 286 фев  9 00:45 /usr/share/netsurf-buildsystem/gentoo-helpers.sh

(In reply to Virgil Dupras from comment #10)
> Now? now what? What did you do on your system that made
> "/usr/share/netsurf-buildsystem/gentoo-helpers.sh" magically appear?
I think it've been installed by update from dev-util/netsurf-buildsystem-1.7 to 1.7-r1 if it was missing at all.

> To be honest, I'm not interested in remote-debugging your system, I'll let
> you do that yourself. If you have a patch that fixes a real and reproducible
> problem, I'll happily review it.

OK, I'll try.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

