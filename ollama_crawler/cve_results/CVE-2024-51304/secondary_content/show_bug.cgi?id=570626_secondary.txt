Title: 570626 – app-eselect/eselect-python-20151117-r2 file collision with python symlinks
URL: https://bugs.gentoo.org/show_bug.cgi?id=570626

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 570626
app-eselect/eselect-python-20151117-r2 file collision with python symlinks
Last modified: 2016-02-26 15:40:43 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 570626 
      - app-eselect/eselect-python-20151117-r2 file collision with python symlinks


Summary:
app-eselect/eselect-python-20151117-r2 file collision with python symlinks
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Development

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       minor
      


Assignee:

Python Gentoo Team








URL:







Whiteboard:




Keywords:









Duplicates (1):
    

570850

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2016-01-02 16:41 UTC by MarisN





      Modified:
    
2016-02-26 15:40 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



mmokrejs









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


MarisN





          2016-01-02 16:41:27 UTC
        

* package app-eselect/eselect-python-20151117-r2 NOT merged
 * 
 * Detected file collision(s):
 * 
 *      /usr/bin/python2
 *      /usr/bin/python
 *      /usr/bin/python3
 *      /usr/bin/2to3
 *      /usr/bin/python-config
 *      /usr/bin/pydoc
 *      /usr/bin/idle
/usr/bin/python -> python-wrapper
/usr/bin/python2 -> python2.7
/usr/bin/python3 -> python3.4
etc.

Reproducible: Always

Steps to Reproduce:
1. emerge app-eselect/eselect-python
2.
3.
Actual Results:  
File collision

Expected Results:  
Symlinks are updated after install not before thus causing file collision.

emerge --info app-eselect/eselect-python
Portage 2.2.26 (python 2.7.11-final-0, default/linux/amd64/13.0/desktop, gcc-4.9.3, glibc-2.22-r1, 4.3.0-gentoo x86_64)
=================================================================
                         System Settings
=================================================================
System uname: Linux-4.3.0-gentoo-x86_64-Intel-R-_Core-TM-2_Duo_CPU_P9500_@_2.53GHz-with-gentoo-2.2
KiB Mem:     4040380 total,    713256 free
KiB Swap:    4607996 total,   4477004 free
Timestamp of repository gentoo: Thu, 31 Dec 2015 08:15:01 +0000
sh bash 4.3_p42
ld GNU ld (Gentoo 2.25.1 p1.1) 2.25.1
app-shells/bash:          4.3_p42::gentoo
dev-java/java-config:     2.2.0::gentoo
dev-lang/perl:            5.22.1::gentoo
dev-lang/python:          2.7.11::gentoo, 3.2.5-r6::gentoo, 3.3.5-r2::gentoo, 3.4.3-r2::gentoo
dev-util/cmake:           3.4.1::gentoo
dev-util/pkgconfig:       0.29::gentoo
sys-apps/baselayout:      2.2::gentoo
sys-apps/openrc:          0.19::gentoo
sys-apps/sandbox:         2.9::gentoo
sys-devel/autoconf:       2.13::gentoo, 2.69-r1::gentoo
sys-devel/automake:       1.9.6-r3::gentoo, 1.11.6-r1::gentoo, 1.12.6::gentoo, 1.14.1::gentoo, 1.15-r1::gentoo
sys-devel/binutils:       2.25.1-r1::gentoo
sys-devel/gcc:            4.8.4::gentoo, 4.9.3::gentoo, 5.3.0::gentoo
sys-devel/gcc-config:     1.8::gentoo
sys-devel/libtool:        2.4.6-r1::gentoo
sys-devel/make:           4.1-r1::gentoo
sys-kernel/linux-headers: 4.3::gentoo (virtual/os-headers)
sys-libs/glibc:           2.22-r1::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.europe.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-vcs-ignore: true

Maris_local
    location: /home/maris/soft/portage
    masters: gentoo
    priority: 0

uwl
    location: /var/lib/layman/uwl
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64 ~amd64"
ACCEPT_LICENSE="* -@EULA dlj-1.1 AdobeFlash-10.3 AdobeFlash-11.x googleearth PUEL Oracle-BCLA-JavaSE skype-4.0.0.7-copyright google-chrome"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=native -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/themes/oxygen-gtk/gtk-2.0 /var/lib/hsqldb"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.3/ext-active/ /etc/php/apache2-php5.5/ext-active/ /etc/php/apache2-php5.6/ext-active/ /etc/php/cgi-php5.3/ext-active/ /etc/php/cgi-php5.5/ext-active/ /etc/php/cgi-php5.6/ext-active/ /etc/php/cli-php5.3/ext-active/ /etc/php/cli-php5.5/ext-active/ /etc/php/cli-php5.6/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=native -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs collision-protect config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news preserve-libs protect-owned sandbox sfperms splitdebug strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://ftp.df.lth.se/pub/gentoo/"
LANG="lv_LV"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
USE="X a52 aac acl acpi alsa amd64 berkdb bluetooth branding brother_devices_dcp585cw bzip2 cairo cdda cdr cli clucene consolekit cracklib crypt cups cxx dbus dell dhcpcd dri dts dvd dvdr eap-tls emboss encode exif fam firefox flac fortran gallium gdal gdbm geos gif glamor glib gpm gpu hal iconv icu idn inotify ipv6 jpeg json kde kvm laptop lcms ldap libnotify lzma mad mmx mmxext mng modules mp3 mp4 mpeg multilib multimedia ncurses nls nptl nsplugin offensive ogg opengl openmp opus pam pango pcre pdf pkcs11 png policykit ppds proj python qemu qt3support qt4 qt5 readline sasl sdl seccomp session sip slp spell sqlite sse sse2 sse3 ssl ssse3 startup-notification svg tcpd theora threads tiff truetype udev udisks unicode upower usb utf-8 vdpau vebm vorbis vpx win32codecs wxwidgets x264 xa xattr xcb xcomposite xinerama xml xmp xmpp xorg xv xvid xvmc zlib" ABI_X86="64 32" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" APACHE2_MODULES="alias authz_host autoindex dir env headers mime rewrite vhost_alias log_config auth_basic authn_file authz_user cgi setenvif" APACHE2_MPMS="prefork" CALLIGRA_FEATURES="words tables stage" CAMERAS="ptp2" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="mmx mmxext sse sse2 sse3 sse4_1 ssse3" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf superstar2 timing tsip tripmate tnt ublox ubx" INPUT_DEVICES="synaptics mouse keyboard evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" LINGUAS="lv pl en lv_LV pl_PL en_US" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php5-6" PYTHON_SINGLE_TARGET="python2_7" PYTHON_TARGETS="python2_7 python3_4" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" RUBY_TARGETS="ruby20 ruby21 ruby22" USERLAND="GNU" VIDEO_CARDS="vesa nouveau" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, USE_PYTHON

=================================================================
                        Package Settings
=================================================================

app-eselect/eselect-python-20140125::gentoo was built with the following:
USE="" ABI_X86="64"




Comment 1


Mike Gilbert






          2016-01-04 02:56:40 UTC
        

Unless you have FEATURES="protect", portage will replace the un-owned symlinks, despite the warning message.




Comment 2


Mike Gilbert






          2016-01-04 16:02:17 UTC
        

*** Bug 570850 has been marked as a duplicate of this bug. ***




Comment 3


Greg Kubaryk





          2016-02-06 02:49:24 UTC
        

If the default of FEATURES=protect-owned is unsuitable, then that seems to be a separate bug.  This package still fails to install, and this bug should remain open so long as that remains true.




Comment 4


Mike Gilbert






          2016-02-12 14:05:17 UTC
        

This problem does not occur with a default portage config.




Comment 5


Greg Kubaryk





          2016-02-13 02:27:42 UTC
        

(In reply to Mike Gilbert from comment #4)
> This problem does not occur with a default portage config.

I wouldn't lie to you. :)  At a minimum, it occurs on my x32 (not x86) test VM that uses a default portage config.  Been broken for weeks and repeatable.




Comment 6


Michał Górny









          2016-02-13 06:31:22 UTC
        

(In reply to Greg Kubaryk from comment #5)
> (In reply to Mike Gilbert from comment #4)
> > This problem does not occur with a default portage config.
> 
> I wouldn't lie to you. :)  At a minimum, it occurs on my x32 (not x86) test
> VM that uses a default portage config.  Been broken for weeks and repeatable.

Please paste your build log and 'emerge --info'.




Comment 7


Greg Kubaryk





          2016-02-26 08:10:48 UTC
        

(In reply to Michał Górny from comment #6)
> (In reply to Greg Kubaryk from comment #5)
> > (In reply to Mike Gilbert from comment #4)
> > > This problem does not occur with a default portage config.
> > 
> > I wouldn't lie to you. :)  At a minimum, it occurs on my x32 (not x86) test
> > VM that uses a default portage config.  Been broken for weeks and repeatable.
> 
> Please paste your build log and 'emerge --info'.

On my x32 test VM using a default portage config, the problem wound up being that profiles/arch/amd64/x32/make.defaults adds FEATURES=collision-protect.  I have a snapshot from before understanding the problem, if you'd still like a build.log and emerge --info.  I suspect the reporter of this bug probably does have that feature in their make.conf since their profile does not include FEATURES=collision-protect by default.

Probably worth considering removing that entry from the x32 defaults.  For my purposes, manually setting FEATURES=-collision-protect in make.conf worked well enough in the interim.




Comment 8


Mike Gilbert






          2016-02-26 15:40:43 UTC
        

(In reply to Greg Kubaryk from comment #7)

Ah, that explains it. Unfortunately, there's not much I can do about a weird default setting in an arch profile.

If someone has a solution that will work with collision-protect on, we will consider it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

