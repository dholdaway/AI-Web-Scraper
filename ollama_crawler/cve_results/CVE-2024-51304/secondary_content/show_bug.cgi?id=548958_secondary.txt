Title: 548958 – x11-wm/dwm with media-fonts/terminus-font[-pcf-unicode-only] displays no glyphs
URL: https://bugs.gentoo.org/show_bug.cgi?id=548958

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 548958
x11-wm/dwm with media-fonts/terminus-font[-pcf-unicode-only] displays no glyphs
Last modified: 2017-10-08 11:21:50 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 548958 
      - x11-wm/dwm with media-fonts/terminus-font[-pcf-unicode-only] displays no glyphs


Summary:
x11-wm/dwm with media-fonts/terminus-font[-pcf-unicode-only] displays no glyphs
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Desktop Misc. Team








URL:







Whiteboard:




Keywords:

PATCH







Depends on:







Blocks:









 





      Reported:
    
2015-05-09 06:01 UTC by Cedric Sodhi





      Modified:
    
2017-10-08 11:21 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



jstein
manday
michael.stahn.42









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info dwm terminus-font fontconfig

              (emerge_info.txt,5.23 KB,
                text/plain)

            
2015-05-09 06:02 UTC,

            Cedric Sodhi




Details





/etc/portage/savedconfig/x11-wm/dwm-6.0

              (dwm-6.0,7.56 KB,
                text/plain)

            
2015-05-09 06:03 UTC,

            Cedric Sodhi




Details





Adds ewarn if terminus-font[pcf-unicode-only] is installed and used in config.h

              (dwm-6.0.ebuild.patch,698 bytes,
                patch)

            
2015-06-03 14:44 UTC,

            Cedric Sodhi




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Cedric Sodhi





          2015-05-09 06:01:45 UTC
        

Since a recent update, dwm displays either boxes or nothing instead of glyphs. It might be related to a fontconfig update but I'm not sure.




Comment 1


Cedric Sodhi





          2015-05-09 06:02:13 UTC
        

Created attachment 402872 [details]
emerge --info dwm terminus-font fontconfig




Comment 2


Cedric Sodhi





          2015-05-09 06:03:10 UTC
        

Created attachment 402874 [details]
/etc/portage/savedconfig/x11-wm/dwm-6.0




Comment 3


mike





          2015-05-09 19:52:48 UTC
        

My config is basically the same but I've got no media-fonts/terminus-font installed (although it's referenced in (/etc/portage/savedconfig/x11-wm/dwm-6.0). Everything works so far. Perhaphs uninstalling terminus font and restart X will work?




Comment 4


Cedric Sodhi





          2015-05-10 05:50:15 UTC
        

Yes it does work then. Any explanation? Neither dwm nor terminus have been updated to my knowledge (and even then it would be hard to explain for me).




Comment 5


mike





          2015-05-10 10:16:20 UTC
        

That's hard to say. It rather sounds like an encoding problem but it's unlikely based on dwm. Even with terminus installed everything works fine here. These are my use flags:

 * Found these USE flags for media-fonts/terminus-font-4.39-r1:
 U I
 + + X                : Add support for X11
 - - a-like-o         : Changes view of letter 'a' - a looks like o (see homepage) 
 + + center-tilde     : Place the '~' character vertically centered on the line instead of to the top. 
 - - distinct-l       : ll2 variant with more distinctive l (lowercase L) 
 + + pcf              : Install Portable Compiled Font (PCF) (required for X11) 
 + + pcf-unicode-only : Remove non-unicode PCF fonts that could be problematic. See bug #520222. 
 + + psf              : Install PC Screen Font (PSF) with unicode data (for linux console) 
 - - quote            : Changes view of quotes: symmetric ` and ' instead of asymmetric one (see homepage) 
 - - raw-font-data    : Install RAW font data which should be compatible with most UNIX systems (you don't need this on linux) 
 - - ru-dv            : Changes view of Russian letters 'de' and 've' (see homepage) 
 + + ru-g             : Changes view of Russian letter 'ge' (see homepage) 
 - - ru-i             : Changes view of Russian letter 'i' - not like Latin u, but like "mirrored" N (see homepage) 
 - - ru-k             : Changes view of Russian letter 'k' (see homepage)




Comment 6


Cedric Sodhi





          2015-05-10 12:06:51 UTC
        

Same here (defaults for amd64 nomultilib). Could you post your `eselect fontconfig list`, that's the next best thing I think could be involved.




Comment 7


Cedric Sodhi





          2015-05-10 12:17:20 UTC
        

Oh maybe forget that. From how the font is specified, I don't think fontconfig is involved here but rather some deprecated XLFD? Anyway, I just took the terminus out of the config and now I do have glyphs again (although not terminus)




Comment 8


Ian Delaney (RETIRED)






          2015-05-22 05:20:03 UTC
        

(In reply to Cedric Sodhi from comment #4)
> Yes it does work then. Any explanation? Neither dwm nor terminus have been
> updated to my knowledge (and even then it would be hard to explain for me).

Does this need closing?




Comment 9


mike





          2015-05-22 07:59:50 UTC
        

(In reply to Ian Delaney from comment #8)
> Does this need closing?

It's not clear if the bug is related to dwm but there is a fix (remove terminus font), so it's fixed I suppose.




Comment 10


Ian Delaney (RETIRED)






          2015-05-23 00:34:48 UTC
        

media-fonts/terminus-font is a package in portage. How do you go from
RDEPEND="
        x11-libs/libX11
        xinerama? ( x11-libs/libXinerama )
"
DEPEND="
        ${RDEPEND}
        xinerama? ( x11-proto/xineramaproto )"

to (remove terminus font)?  There is no patchfor the ebuild as a final fix. No this is not ready for closing.




Comment 11


Cedric Sodhi





          2015-05-23 07:12:49 UTC
        

It appears that USE="-pcf-unicode-only" emerge terminus-font solves the problem, too. Without that use flag, terminus works again in dwm and dmenu.




Comment 12


Cedric Sodhi





          2015-05-23 07:17:03 UTC
        

(Conclusion: The bug has been triggered by an update to terminus-font)




Comment 13


mike





          2015-05-23 11:53:57 UTC
        

(In reply to Ian Delaney from comment #10)
> media-fonts/terminus-font is a package in portage. How do you go from
> RDEPEND="
>         x11-libs/libX11
>         xinerama? ( x11-libs/libXinerama )
> "
> DEPEND="
>         ${RDEPEND}
>         xinerama? ( x11-proto/xineramaproto )"
> 
> to (remove terminus font)?  There is no patchfor the ebuild as a final fix.
> No this is not ready for closing.

Changing the installation will cure the symptoms but probably not the root cause. There are likely other window manager having the same issue but I don't use other than dwm in order to check. Perhaps a general warning for media-fonts/terminus-font will be enough?  But devs will decide what to change..




Comment 14


Ian Delaney (RETIRED)






          2015-05-29 07:26:02 UTC
        

(In reply to Cedric Sodhi from comment #11)
> It appears that USE="-pcf-unicode-only" emerge terminus-font solves the
> problem, too. Without that use flag, terminus works again in dwm and dmenu.

suggests or beckons adding ; media-fonts/terminus-font[-pcf-unicode-only] to
RDEPEND="
         x11-libs/libX11
         xinerama? ( x11-libs/libXinerama )"

(In reply to Cedric Sodhi from comment #12)
> (Conclusion: The bug has been triggered by an update to terminus-font)

suggests addition of
        <media-fonts/terminus-font-the-culprit-version

There is a 3rd alternative;


(In reply to mike from comment #13)
>
> Changing the installation will cure the symptoms but probably not the root
> cause. There are likely other window manager having the same issue but I
> don't use other than dwm in order to check. Perhaps a general warning for
> media-fonts/terminus-font will be enough?  But devs will decide what to
> change..

The devs, such as I, as here to help prompt you towards a final form.  For us to decide finally is for you to pass over the role of proxy maintainer and return it to us.




Comment 15


Cedric Sodhi





          2015-05-29 08:04:45 UTC
        

I'm not quite sure I understand the issue, but in my opinion, since the problem only occurs for a certain configuration of dwm (using Terminus), the only proper solution is either "fix" dwm so as to work with the "pfc" font (assuming this is something about the other method being deprecated) OR to simply post a note/postinstall message.

Since portage can't determine (well, shouldn't) whether dwm is configured to use Terminus at all, we shouldn't ever depend on Terminus or any USE-variant thereof.




Comment 16


Ian Delaney (RETIRED)






          2015-06-03 09:41:09 UTC
        

dwm-6.0.ebuild already has a pkg_postinst()   phase with mesgs by einfo. "simply post a note/postinstall message" will be fine. Preapre such a msg, add here and I can commit and close




Comment 17


Cedric Sodhi





          2015-06-03 14:44:10 UTC
        

Created attachment 404520 [details, diff]
Adds ewarn if terminus-font[pcf-unicode-only] is installed and used in config.h




Comment 18


Jeroen Roovers (RETIRED)






          2017-10-08 11:21:50 UTC
        

dwm does not require any font more specifically than "monospace:size=10" so it entirely depends on your system to have the correct font installed. Since media-fonts/terminus-font has an IUSE default of "+pcf-unicode-only", disabling it leaves you entirely on your own to configure your system correctly otherwise. You could perhaps explain on the wiki[1] what information you gathered here, but since x11-wm/dwm also supports savedconfig.eclass, giving proper advice with that wide a variety of possible configurations would be difficult.



[1] https://wiki.gentoo.org/wiki/Dwm









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

