Title: 681162 – =app-emulation/wine-vanilla-4.4 - configure: ld: /usr/lib32/libgnutls.so: undefined reference to `_idn2_punycode_decode@IDN2_0.0.0'
URL: https://bugs.gentoo.org/show_bug.cgi?id=681162

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 681162
=app-emulation/wine-vanilla-4.4 - configure: ld: /usr/lib32/libgnutls.so: undefined reference to `_idn2_punycode_decode@IDN2_0.0.0'
Last modified: 2019-03-21 16:29:53 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 681162 
      - =app-emulation/wine-vanilla-4.4 - configure: ld: /usr/lib32/libgnutls.so: undefined reference to `_idn2_punycode_decode@IDN2_0.0.0'


Summary:
=app-emulation/wine-vanilla-4.4 - configure: ld: /usr/lib32/libgnutls.so: und...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2019-03-21 14:53 UTC by Matthew Schultz





      Modified:
    
2019-03-21 16:29 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




config.log

              (config.log.xz,16.55 KB,
                application/x-xz)

            
2019-03-21 14:53 UTC,

            Matthew Schultz




Details





build.log

              (build.log.xz,5.19 KB,
                application/x-xz)

            
2019-03-21 16:05 UTC,

            Matthew Schultz




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Matthew Schultz





          2019-03-21 14:53:00 UTC
        

wine-vanilla 4.4 is failing to build due to some problem finding the gnutls library despite it being installed: 

emerge -pvO gnutls

These are the packages that would be merged, in order:

[ebuild   R    ] net-libs/gnutls-3.5.19:0/30::gentoo  USE="cxx idn nls openssl seccomp tls-heartbeat zlib -dane -doc -examples -guile -openpgp -pkcs11 -sslv2 -sslv3 -static-libs -test (-test-full) -tools -valgrind" ABI_X86="32 (64) (-x32)" 0 KiB

emerge -pvO wine-vanilla

These are the packages that would be merged, in order:

[ebuild  NS   ~] app-emulation/wine-vanilla-4.4:4.4::gentoo [2.0.4:2.0.4::gentoo, 3.0.3:3.0.3::gentoo, 4.1:4.1::gentoo] USE="X alsa cups fontconfig gecko gsm gstreamer jpeg lcms mono mp3 ncurses nls openal opengl osmesa perl png realtime run-exes samba scanner sdl ssl threads truetype udev udisks v4l xcomposite xinerama xml -capi -custom-cflags -dos -faudio% -gphoto2 -gssapi -kerberos -ldap -netapi -odbc -opencl -oss -pcap -prelink -pulseaudio (-selinux) -test -vkd3d -vulkan" ABI_X86="32 64 (-x32)" 0 KiB

emerge --info
Portage 2.3.62 (python 3.6.5-final-0, default/linux/amd64/17.0/desktop/plasma, gcc-8.2.0, glibc-2.27-r6, 4.20.14-gentoo-r1 x86_64)
=================================================================
System uname: Linux-4.20.14-gentoo-r1-x86_64-Intel-R-_Core-TM-_i7-4700MQ_CPU_@_2.40GHz-with-gentoo-2.6
KiB Mem:    16287124 total,   8898648 free
KiB Swap:          0 total,         0 free
Timestamp of repository gentoo: Thu, 21 Mar 2019 00:45:01 +0000
Head commit of repository gentoo: 2a36d9fa5a5fa9533f49a2ceabb9541c4cc99e4c
sh dash 0.5.9.1-r3
ld GNU ld (Gentoo 2.30 p5) 2.30.0
app-shells/bash:          4.4_p23-r1::gentoo
dev-java/java-config:     2.2.0-r4::gentoo
dev-lang/perl:            5.26.2::gentoo
dev-lang/python:          2.7.15::gentoo, 3.6.5::gentoo
dev-util/cmake:           3.9.6::gentoo
dev-util/pkgconfig:       0.29.2::gentoo
sys-apps/baselayout:      2.6-r1::gentoo
sys-apps/openrc:          0.38.3-r1::gentoo
sys-apps/sandbox:         2.13::gentoo
sys-devel/autoconf:       2.13-r1::gentoo, 2.69-r4::gentoo
sys-devel/automake:       1.11.6-r3::gentoo, 1.13.4-r2::gentoo, 1.16.1-r1::gentoo
sys-devel/binutils:       2.30-r4::gentoo
sys-devel/gcc:            8.2.0-r6::gentoo
sys-devel/gcc-config:     2.0::gentoo
sys-devel/libtool:        2.4.6-r3::gentoo
sys-devel/make:           4.2.1-r4::gentoo
sys-kernel/linux-headers: 4.14-r1::gentoo (virtual/os-headers)
sys-libs/glibc:           2.27-r6::gentoo
Repositories:

gentoo
    location: /usr/portage
    sync-type: rsync
    sync-uri: rsync://rsync.namerica.gentoo.org/gentoo-portage
    priority: -1000
    sync-rsync-extra-opts: 
    sync-rsync-verify-jobs: 1
    sync-rsync-verify-max-age: 24
    sync-rsync-verify-metamanifest: yes

LocalOverlay
    location: /usr/local/portage
    masters: gentoo
    priority: 0

grub2-themes
    location: /var/lib/layman/grub2-themes
    sync-type: laymansync
    sync-uri: https://github.com/gentoo/grub2-themes-overlay.git
    masters: gentoo
    priority: 50

ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=core-avx2 -O2 -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib64/libreoffice/program/sofficerc /usr/share/config /usr/share/gnupg/qualified.txt /usr/share/themes/oxygen-gtk/gtk-2.0"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php7.1/ext-active/ /etc/php/apache2-php7.2/ext-active/ /etc/php/cgi-php7.1/ext-active/ /etc/php/cgi-php7.2/ext-active/ /etc/php/cli-php7.1/ext-active/ /etc/php/cli-php7.2/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=core-avx2 -O2 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
ENV_UNSET="DBUS_SESSION_BUS_ADDRESS DISPLAY GOBIN PERL5LIB PERL5OPT PERLPREFIX PERL_CORE PERL_MB_OPT PERL_MM_OPT XAUTHORITY XDG_CACHE_HOME XDG_CONFIG_HOME XDG_DATA_HOME XDG_RUNTIME_DIR"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-docompress binpkg-dostrip binpkg-logs config-protect-if-modified distlocks ebuild-locks fixlafiles ipc-sandbox merge-sync multilib-strict network-sandbox news parallel-fetch pid-sandbox preserve-libs protect-owned sandbox sfperms sign strict unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS="http://portage.home http://www.gtlib.gatech.edu/pub/gentoo http://gentoo.mirrors.easynews.com/linux/gentoo/ https://mirror.sjc02.svwh.net/gentoo/"
LANG="en_US.utf8"
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
LINGUAS="en ru"
MAKEOPTS="-j6"
PKGDIR="/usr/portage/packages"
PORTAGE_CONFIGROOT="/"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --omit-dir-times --compress --force --whole-file --delete --stats --human-readable --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --exclude=/.git"
PORTAGE_TMPDIR="/tmp"
USE="X a52 aac acl acpi activities adns aes alsa amd64 apache2 audiofile avi avx avx2 bcmath bdf berkdb bluetooth branding bzip2 cairo calendar caps cdda cdr chardet cjk cli consolekit crypt css ctype cups curl curlwrappers cxx dbus declarative device-mapper dga dhcp directfb dri dri3 dts dvb dvd dvdr dvdread egl emboss enca encode exif fbcon ffmpeg flac fma3 fontconfig foomaticdb ftp fts3 gd gdbm geoclue gif git glamor gmp google gpm gsm gstreamer gtk gtk2 gtk3 gzip hal hash hbci hls hotkeys iconv icu ieee1394 imagemagick imap imlib innodb iproute2 ipv6 java javascript jpeg jpeg2k json kde keymap kipi kwallet lcms libcaca libkms libnotify libtirpc lm_sensors logrotate lz4 lzma lzo mad matroska mcal mhash mime mjpeg mms mmx mmxext mng mp3 mp4 mpeg mplayer msession multilib mysql mysqli mythtv ncurses network nls nptl nptlonly nsplugin nss ntp nvidia offensive ofx ogg openal opengl openmp osc osmesa pam pango pcntl pcre pdf pdo pear perl pgo phonon php plasma pm-utils png policykit popcnt posix postproc ppds python qml qt5 quicktime readline real reflection rtc samba sasl scanner sdl seccomp session simplexml soap sockets spell spl sql sqlite sse sse2 sse3 sse4_1 sse4_2 ssl ssse3 startup-notification subversion suhosin svg syslog system-harfbuzz system-icu system-jpeg system-sqlite tcpd theora thumbnail tidy tiff tokenizer transcode truetype tslib udev udisks unicode upower usb utempter v4l v4l2 vaapi vcd vdpau vorbis vpx wddx webp widgets wxwidgets x264 x265 xattr xcb xcomposite xinerama xml xmp xpm xsl xslt xv xvfb xvid xvmc zip zlib" ABI_X86="32 64" ALSA_CARDS="hda-intel" APACHE2_MODULES="access_compat actions alias auth_basic auth_digest authn_anon authn_core authn_dbd authn_dbm authn_file authz_dbm authz_core authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock dbd deflate dir disk_cache env expires ext_filter file_cache filter headers http2 ident imagemap include info log_config logio mem_cache mime mime_magic negotiation proxy proxy_ajp proxy_balancer proxy_connect proxy_http rewrite setenvif so slotmem_shm socache_shmcb speling status unique_id userdir usertrack vhost_alias macro" APACHE2_MPMS="event" CALLIGRA_FEATURES="karbon sheets words" COLLECTD_PLUGINS="df interface irq load memory rrdtool swap syslog" CPU_FLAGS_X86="aes avx avx2 fma3 mmx mmxext popcnt sse sse2 sse3 sse4_1 sse4_2 ssse3 f16c" ELIBC="glibc" GPSD_PROTOCOLS="ashtech aivdm earthmate evermore fv18 garmin garmintxt gpsclock isync itrax mtk3301 nmea ntrip navcom oceanserver oldstyle oncore rtcm104v2 rtcm104v3 sirf skytraq superstar2 timing tsip tripmate tnt ublox ubx" GRUB_PLATFORMS="pc efi-64" INPUT_DEVICES="evdev tslib wacom synaptics" KERNEL="linux" L10N="en ru" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LIBREOFFICE_EXTENSIONS="presenter-console presenter-minimizer" NETBEANS_MODULES="apisupport cnd groovy gsf harness ide identity j2ee java mobility nb php profiler soa visualweb webcommon websvccommon xml" OFFICE_IMPLEMENTATION="libreoffice" PHP_TARGETS="php7-1 php7-2" POSTGRES_TARGETS="postgres9_5 postgres10" PYTHON_SINGLE_TARGET="python3_6" PYTHON_TARGETS="python2_7 python3_6" QEMU_SOFTMMU_TARGETS="i386 x86_64" QEMU_USER_TARGETS="i386 x86_64" RUBY_TARGETS="ruby23 ruby24" USERLAND="GNU" VIDEO_CARDS="intel i965 nvidia modesetting" XTABLES_ADDONS="quota2 psd pknock lscan length2 ipv4options ipset ipp2p iface geoip fuzzy condition tee tarpit sysrq steal rawnat logmark ipmark dhcpmac delude chaos account"
Unset:  CC, CPPFLAGS, CTARGET, CXX, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LC_ALL, PORTAGE_BINHOST, PORTAGE_BUNZIP2_COMMAND, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Matthew Schultz





          2019-03-21 14:53:38 UTC
        

Created attachment 570112 [details]
config.log




Comment 2


Matthew Schultz





          2019-03-21 15:02:13 UTC
        

checking for xmlReadMemory in -lxml2... yes
checking for xmlNewDocPI in -lxml2... yes
checking for xmlSchemaSetParserStructuredErrors in -lxml2... yes
checking for xmlSchemaSetValidStructuredErrors in -lxml2... yes
checking for xmlFirstElementChild in -lxml2... yes
checking for xmlDocProperties... yes
checking for libxslt/pattern.h... yes
checking for libxslt/transform.h... yes
checking for -lxslt... libxslt.so.1
checking dbus/dbus.h usability... yes
checking dbus/dbus.h presence... yes
checking for dbus/dbus.h... yes
checking for -ldbus-1... libdbus-1.so.3
checking gnutls/gnutls.h usability... yes
checking gnutls/gnutls.h presence... yes
checking for gnutls/gnutls.h... yes
checking for -lgnutls... not found
checking for gnutls_cipher_init... no
configure: error: libgnutls development files not found, no schannel support.
This is an error since --with-gnutls was requested.




Comment 3


Matthew Schultz





          2019-03-21 15:02:48 UTC
        

I'd post a build.log but I can't because it's 5.2K even when it's compressed.




Comment 4


Jeroen Roovers (RETIRED)






          2019-03-21 15:56:27 UTC
        

You need to rebuild net-libs/gnutls. The net-libs/gnutls ebuilds already set a proper sub-SLOT dependency on net-dns/libidn2 so somehow you missed the change that should have triggered a @preserved-rebuild message. You also missed the automatic rebuild triggered through a net-dns/libidn2 change:


commit f2463165d5e90bcc3cb5bd93ea4dfe0ad9fea5a3
Author: Thomas Deutschmann <whissi@gentoo.org>
Date:   Mon Jan 7 01:31:52 2019 +0100

    net-libs/gnutls: add subslot operator on net-dns/libidn2 atom

    Package-Manager: Portage-2.3.54, Repoman-2.3.12
    Signed-off-by: Thomas Deutschmann <whissi@gentoo.org>




Comment 5


Jeroen Roovers (RETIRED)






          2019-03-21 15:57:15 UTC
        

(In reply to Matthew Schultz from comment #3)
> I'd post a build.log but I can't because it's 5.2K even when it's compressed.

5.3 kilobytes is under the 1000 kilobyte limit. But it's not important now, the config.log was enough (and need not have been compressed).




Comment 6


Matthew Schultz





          2019-03-21 16:05:23 UTC
        

Created attachment 570116 [details]
build.log




Comment 7


Matthew Schultz





          2019-03-21 16:06:18 UTC
        

(In reply to Jeroen Roovers from comment #5)
> (In reply to Matthew Schultz from comment #3)
> > I'd post a build.log but I can't because it's 5.2K even when it's compressed.
> 
> 5.3 kilobytes is under the 1000 kilobyte limit. But it's not important now,
> the config.log was enough (and need not have been compressed).

Ah ok.  I figured it was a file limit problem I was having but rather it was a file permissions problem.




Comment 8


Matthew Schultz





          2019-03-21 16:29:53 UTC
        

Not sure why it hasn't requested a rebuild:

Thu Mar 21 08:56:56 2019 >>> net-dns/libidn2-2.1.1a
Tue Aug 21 07:52:38 2018 >>> net-libs/gnutls-3.5.19

Reemerging gnutls fixed the problem though.  Thanks.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

