Title: 892531 – dev-ruby/nokogiri-1.14.0 fails tests on ruby30
URL: https://bugs.gentoo.org/show_bug.cgi?id=892531

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 892531
dev-ruby/nokogiri-1.14.0 fails tests on ruby30
Last modified: 2023-03-28 23:39:41 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 892531 
      - dev-ruby/nokogiri-1.14.0 fails tests on ruby30


Summary:
dev-ruby/nokogiri-1.14.0 fails tests on ruby30
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Ruby Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2023-01-29 21:59 UTC by Jonathan Lovelace





      Modified:
    
2023-03-28 23:39 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




dev-ruby:nokogiri-1.14.0:20230128-155952.log

              (dev-ruby:nokogiri-1.14.0:20230128-155952.log,75.62 KB,
                text/plain)

            
2023-01-29 21:59 UTC,

            Jonathan Lovelace




Details





emerge-info.txt

              (emerge-info.txt,11.05 KB,
                text/plain)

            
2023-01-29 22:01 UTC,

            Jonathan Lovelace




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Jonathan Lovelace





          2023-01-29 21:59:50 UTC
        

Created attachment 849423 [details]
dev-ruby:nokogiri-1.14.0:20230128-155952.log

=dev-ruby/nokogiri-1.14.0 fails its test phase on building with USE=ruby_targets_ruby30, as does 1.13.10 on rebuilding with that USE flag switched to enabled. This is after the test suite fully passes for ruby27. The specific test failures are as follows:

Finished in 53.666597s, 45.8945 runs/s, 163.2673 assertions/s.

  1) Failure:
Nokogiri::XML::TestReader#test_namespaced_attributes [/var/tmp/portage/dev-ruby/nokogiri-1.14.0/work/ruby30/nokogiri-1.14.0/test/xml/test_reader.rb:496]:
In stderr.
Expected /Reader#attribute_nodes is deprecated/ to match "".

  2) Failure:
Nokogiri::XML::TestReader#test_reader_node_attributes_keep_a_reference_to_the_reader [/var/tmp/portage/dev-ruby/nokogiri-1.14.0/work/ruby30/nokogiri-1.14.0/test/xml/test_reader.rb:466]:
In stderr.
Expected /Reader#attribute_nodes is deprecated/ to match "".

  3) Failure:
Nokogiri::XML::Node#test_xml_node_new_must_take_document_type [/var/tmp/portage/dev-ruby/nokogiri-1.14.0/work/ruby30/nokogiri-1.14.0/test/xml/test_node.rb:742]:
In stderr.
Expected /deprecated/ to match "".   

2463 runs, 8762 assertions, 3 failures, 0 errors, 30 skips




Comment 1


Jonathan Lovelace





          2023-01-29 22:01:06 UTC
        

Created attachment 849425 [details]
emerge-info.txt




Comment 2


Hans de Graaff







          2023-02-03 16:15:09 UTC
        

I can't reproduce this and the failure doesn't seem to indicate an obvious cause. Does this still happen with nokogiri-1.14.1?




Comment 3


Sam James









          2023-03-28 23:39:41 UTC
        

I can't reproduce this anywhere. nokogiri tends to be quite sensitive to libxml2 and libxslt versions though.

Let us know if you can still hit it.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

