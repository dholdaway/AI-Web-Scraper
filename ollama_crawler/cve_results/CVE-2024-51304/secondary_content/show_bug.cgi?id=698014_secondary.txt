Title: 698014 – x11-libs/gtk+-3.24.8 -  * Failed Running aclocal !
URL: https://bugs.gentoo.org/show_bug.cgi?id=698014

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 698014
x11-libs/gtk+-3.24.8 -  * Failed Running aclocal !
Last modified: 2021-05-01 02:39:03 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 698014 
      - x11-libs/gtk+-3.24.8 -  * Failed Running aclocal !


Summary:
x11-libs/gtk+-3.24.8 -  * Failed Running aclocal !
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Linux Gnome Desktop Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2019-10-18 21:10 UTC by Nikita Zlobin





      Modified:
    
2021-05-01 02:39 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




Emerge info

              (emerge_info,15.68 KB,
                text/plain)

            
2019-10-19 07:13 UTC,

            Nikita Zlobin




Details





Build log

              (build.log,3.10 KB,
                text/x-log)

            
2019-10-19 07:14 UTC,

            Nikita Zlobin




Details





aclocal.out

              (aclocal.out,287 bytes,
                text/plain)

            
2019-10-19 22:04 UTC,

            Nikita Zlobin




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Nikita Zlobin





          2019-10-18 21:10:51 UTC
        

Last fine emerge for gtk+-3.24.8 was in June, that installed portage was 2.3.66-r1. Updated portage to 2.3.69 as least measure to not fall unmaintainable unless I find time for full rebuild/upgrade again. Now it happened, that I need to reemerge gtk+-3.24.8 for some use flags (I feel it will need more rebuilds after upgrading it again). But when doing (emerge -av1 --nodeps =gtk+-3.24.8), I got aclocal error (caused by eautoreconf, so I guess it is from autotools.eclass):

cat /var/calculate/tmp/portage/x11-libs/gtk+-3.24.8/temp/aclocal.out:
***** aclocal *****
***** PWD: /var/calculate/tmp/portage/x11-libs/gtk+-3.24.8/work/gtk+-3.24.8
***** aclocal -I m4

/usr/bin/m4:m4/lt~obsolete.m4:48: ERROR: end of file in string
autom4te-2.69: /usr/bin/m4 failed with exit status: 1
aclocal-1.16: error: echo failed with exit status: 1

It only succeed after I edited gnome2.eclass, replacing eautoreconf with autoreconf. Of course I'm not sure is it still case for gtk+-3.24.10 (will look how it emerges), but at least eautoreconf doesn't look enough fine.

Full output since src_prepare phase to backtrace:

>>> Preparing source in /var/calculate/tmp/portage/x11-libs/gtk+-3.24.8/work/gtk+-3.24.8 ...
 * Applying patches from /var/calculate/tmp/portage/x11-libs/gtk+-3.24.8/work/patches ...
 *   0001-gdkframeclockidle-Don-t-permanently-skew-frame-time.patch ...                                                                                                                        [ ok ]
 *   0002-gdk-wayland-Use-event-window-to-calculate-coordinate.patch ...                                                                                                                       [ ok ]
 *   0003-imcontextwayland-Hopefully-fix-if-expression.patch ...                                                                                                                               [ ok ]
 *   0004-wayland-Avoid-using-uninitialized-memory.patch ...                                                                                                                                   [ ok ]
 *   0005-gdk-wayland-Listen-to-wl_surface-events-on-tablet-cu.patch ...                                                                                                                       [ ok ]
 * Applying gtk+-3.24.8-update-icon-cache.patch ...                                                                                                                                            [ ok ]
 * Applying gtk+-3.22.20-libcloudproviders-automagic.patch ...                                                                                                                                 [ ok ]
 * Disabling deprecation warnings ...                                                                                                                                                          [ ok ]
 * Running eautoreconf in '/var/calculate/tmp/portage/x11-libs/gtk+-3.24.8/work/gtk+-3.24.8' ...
 * Running autopoint --force ...                                                                                                                                                               [ ok ]
 * Running gtkdocize --copy ...                                                                                                                                                                [ ok ]
 * Running libtoolize --install --copy --force --automake ...                                                                                                                                  [ ok ]
 * Running aclocal -I m4 ...                                                                                                                                                                   [ !! ]

 * Failed Running aclocal !
 * 
 * Include in your bugreport the contents of:
 * 
 *   /var/calculate/tmp/portage/x11-libs/gtk+-3.24.8/temp/aclocal.out

 * ERROR: x11-libs/gtk+-3.24.8::gentoo failed (prepare phase):
 *   Failed Running aclocal !
 * 
 * Call stack:
 *     ebuild.sh, line  125:  Called src_prepare
 *   environment, line 4187:  Called gnome2_src_prepare
 *   environment, line 2711:  Called eautoreconf
 *   environment, line 1373:  Called eaclocal
 *   environment, line 1153:  Called autotools_run_tool '--at-m4flags' 'aclocal' '-I' 'm4'
 *   environment, line 1070:  Called die
 * The specific snippet of code:
 *           die "Failed Running $1 !";

Reproducible: Always

Steps to Reproduce:
1. Update portage to recent (2.3.69) as well as portage tree
2. Try to emerge =x11-libs/gtk+-3.24.8 (as said, unsure about 3.24.10)
Actual Results:  
Will fail with above result.


It is clearly mistake in last m4 command due to semicolor, which should be space. Could be unfortunate aclocal version.




Comment 1


Mike Gilbert






          2019-10-19 00:48:50 UTC
        

Please provide emerge --info and attach a full build log.




Comment 2


Jeroen Roovers (RETIRED)






          2019-10-19 06:19:42 UTC
        

(In reply to Nikita Zlobin from comment #0)
>  * Include in your bugreport the contents of:
>  * 
>  *   /var/calculate/tmp/portage/x11-libs/gtk+-3.24.8/temp/aclocal.out

Where is it?

Also, why aren't you filing this bug report with the Calculate Linux people?




Comment 3


Nikita Zlobin





          2019-10-19 07:12:37 UTC
        

> Where is it?
> Also, why aren't you filing this bug report with the Calculate Linux people?

Just another PORTAGE_TMPDIR. Also I watch to ebuild author. For those, from calculate overlays, of course I write only to calculate bugs (or if at least one of clearly involved packages is from them). Also I once tried to ensure to get more recent gentoo upstream, than calc provides via its weekly mirror.
Is it wrong approach?

If default is /var/tmp, then at gentoo it should be /var/tmp/portage/x11-libs/gtk+-3.24.8/temp/aclocal.out (just one word to remove).




Comment 4


Nikita Zlobin





          2019-10-19 07:13:45 UTC
        

Created attachment 593282 [details]
Emerge info




Comment 5


Nikita Zlobin





          2019-10-19 07:14:29 UTC
        

Created attachment 593284 [details]
Build log




Comment 6


Mart Raudsepp






          2019-10-19 20:54:59 UTC
        

As already hinted, need to see that aclocal.out file.




Comment 7


Nikita Zlobin





          2019-10-19 22:04:15 UTC
        

Created attachment 593338 [details]
aclocal.out

Ok... it is so short, that I did not bother attaching it as file, instead pasting to report text.




Comment 8


Mart Raudsepp






          2019-10-20 08:32:31 UTC
        

Didn't realize that. All signs point to a broken libtool installation, and usage of --nodeps doesn't really help probably.
Something wrong with /usr/share/aclocal/lt~obsolete.m4 maybe?









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

