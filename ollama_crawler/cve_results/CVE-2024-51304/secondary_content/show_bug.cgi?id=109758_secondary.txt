Title: 109758 – amd64 upgrade problems (specifically with libm), starting from 2005.1 64-bit Universal install CD
URL: https://bugs.gentoo.org/show_bug.cgi?id=109758

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 109758
amd64 upgrade problems (specifically with libm), starting from 2005.1 64-bit Universal install CD
Last modified: 2005-12-11 08:54:26 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 109758 
      - amd64 upgrade problems (specifically with libm), starting from 2005.1 64-bit Universal install CD


Summary:
amd64 upgrade problems (specifically with libm), starting from 2005.1 64-bit ...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       major
      


Assignee:

AMD64 Project








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2005-10-18 17:10 UTC by Colin Fox





      Modified:
    
2005-12-11 08:54 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



toolchain









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Colin Fox





          2005-10-18 17:10:00 UTC
        

Trying to emerge anything that uses libm, I get:

/lib64/libm.a(s_sin.o): relocation R_X86_64_32S against `a local symbol' can not
be used when making a shared object; recompile with -fPIC


Reproducible: Always
Steps to Reproduce:
1.emerge (anything that uses libm, say "python")
2.
3.

Actual Results:  
/lib64/libm.a(s_sin.o): r elocation R_X86_64_32S against `a local symbol' can
not be used when making a shared object; recompile with -fPIC


Portage 2.0.51.22-r3 (default-linux/amd64/2005.1, gcc-3.4.3-hardened,
glibc-2.3.5-r2, 2.6.13-gentoo-r3 x86_64)
=================================================================
System uname: 2.6.13-gentoo-r3 x86_64 AMD Opteron(tm) Processor 248
Gentoo Base System version 1.6.12
dev-lang/python:     2.3.5
sys-apps/sandbox:    1.2.11
sys-devel/autoconf:  2.13, 2.59-r6
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.5
sys-devel/binutils:  2.15.92.0.2-r10
sys-devel/libtool:   1.5.18-r1
virtual/os-headers:  2.6.11-r2
ACCEPT_KEYWORDS="amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O2 -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/2/share/config /usr/kde/3/share/config
/usr/share/config /var/qmail/control"
CONFIG_PROTECT_MASK="/etc/gconf /etc/terminfo /etc/env.d"
CXXFLAGS="-march=k8 -O2 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks sandbox sfperms strict"
GENTOO_MIRRORS="http://adelie.polymtl.ca/ ftp://gentoo.risq.qc.ca/
ftp://lug.mtu.edu/gentoo"
MAKEOPTS="-j3"
PKGDIR="/usr/portage/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.us.gentoo.org/gentoo-portage"
USE="amd64 X alsa avi berkdb bitmap-fonts crypt cups doc eds emboss encode
foomaticdb fortran gif gnome gpm gstreamer gtk gtk2 imlib ipv6 jpeg lzw lzw-tiff
mp3 mpeg ncurses nls opengl pam pdflib perl pic png postgres python quicktime
readline sdl spell ssl tcpd test tiff truetype-fonts type1-fonts unicode usb
userlocales xml2 xpm xv zlib userland_GNU kernel_linux elibc_glibc"
Unset:  ASFLAGS, CTARGET, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTDIR_OVERLAY




Comment 1


Chris Gianelloni (RETIRED)






          2005-10-19 08:03:36 UTC
        

OK.  When are you getting these errors?

Is this on an emerge of new packages?  Updates on current packages?

Have you updated glibc since the release?

Essentially, if things have changed since the release media, then we need to
move this on to the proper maintainers.




Comment 2


Colin Fox





          2005-10-20 14:47:32 UTC
        

This is when doing an update.

I basically just did this:

1. Installed from the 2005.1 universal 64 bit disk.
2. Did an emerge --sync
3. emerge -U world

That's it. At some point, I noticed that it broke, complaining about libm.

I've reverted the system back to what came from the install disk, and it's
working fine. But I'm concerned that if I do an "emerge -U world" it will break
again. 




Comment 3


Chris Gianelloni (RETIRED)






          2005-10-21 12:03:55 UTC
        

OK.  It works from the installation media.  After the installation, it is giving
errors.  Got it.

Thanks for the clarification.




Comment 4


Colin Fox





          2005-10-21 13:15:01 UTC
        

Hmm. I decided to go ahead and do an update.

Everything is working fine.

So to recap: I did an install from the disk and then an update. Something broke
(looks like in a 64/32 bit compatability layer or something).

I re-copied the /usr/ directory back over from the stage3 tarball, and did an
update again. Now things are working.

I noticed that when I did the update this time, it didn't have glibc in the list
of items to update.

Also, I don't think I changed anything specific to get this to work. But it's
working now.

So there is something fragile somewhere, but I'm not sure where.




Comment 5


Simon Stelling (RETIRED)






          2005-12-11 08:54:26 UTC
        

seems like the problem has been fixed between the first and the second sync. in
any case, if you can't reproduce it anymore, we can't fix it ;)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

