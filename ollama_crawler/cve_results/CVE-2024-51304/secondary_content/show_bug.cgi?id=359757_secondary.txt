Title: 359757 – Building postgresql 8.4.X fails - ebuild is passing "--prefix=/usr/lib/postgresql-8.4" to configure
URL: https://bugs.gentoo.org/show_bug.cgi?id=359757

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 359757
Building postgresql 8.4.X fails - ebuild is passing "--prefix=/usr/lib/postgresql-8.4" to configure
Last modified: 2011-03-30 15:32:30 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 359757 
      - Building postgresql 8.4.X fails - ebuild is passing "--prefix=/usr/lib/postgresql-8.4" to configure


Summary:
Building postgresql 8.4.X fails - ebuild is passing "--prefix=/usr/lib/postgr...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

Prefix Support

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Prefix








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-03-21 13:24 UTC by Asfand Yar Qazi





      Modified:
    
2011-03-30 15:32 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




ebuild configuring

              (ebuild-configuring.txt,15.57 KB,
                text/plain)

            
2011-03-21 13:27 UTC,

            Asfand Yar Qazi




Details





Let postgresql-base-8.4.6 compile

              (postgresql-base-8.4.6_fix_prefixing.patch,1.10 KB,
                patch)

            
2011-03-22 11:48 UTC,

            Asfand Yar Qazi




Details
            | Diff





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Asfand Yar Qazi





          2011-03-21 13:24:51 UTC
        

Hi,

I am trying to build PostgreSQL 8.4 in my Gentoo prefix, and so did a:

emerge -va '<dev-db/postgresql-server-8.5'

I got through everything until it tried to build postgresql 8.4, then failed with:

 * QA Notice: the following files are outside of the prefix:
 * /usr
 * /usr/lib
 * /usr/lib/postgresql-8.4
 * /usr/lib/postgresql-8.4/lib
 * /usr/lib/postgresql-8.4/lib/pgxs
 * /usr/lib/postgresql-8.4/lib/pgxs/src
 * /usr/lib/postgresql-8.4/lib/pgxs/src/makefiles
 * /usr/lib/postgresql-8.4/lib/pgxs/src/makefiles/pgxs.mk
 * /usr/lib/postgresql-8.4/lib/pgxs/src/Makefile.global
 * /usr/lib/postgresql-8.4/lib/pgxs/src/Makefile.port
 * /usr/lib/postgresql-8.4/lib/pgxs/src/Makefile.shlib
 * /usr/lib/postgresql-8.4/lib/pgxs/src/nls-global.mk
 * /usr/lib/postgresql-8.4/lib/pgxs/config
 * /usr/lib/postgresql-8.4/lib/pgxs/config/install-sh
 * /usr/lib/postgresql-8.4/lib/pgxs/config/mkinstalldirs
 * /usr/lib/postgresql-8.4/lib/libpq.so.5
 * /usr/lib/postgresql-8.4/lib/libpgport.a
 * /usr/lib/postgresql-8.4/lib/libpq.so.5.2
 * /usr/lib/postgresql-8.4/lib/libpq.so
 * /usr/lib/postgresql-8.4/lib/libpgtypes.so.3
 * /usr/lib/postgresql-8.4/lib/libpq.a
 * /usr/lib/postgresql-8.4/lib/libpgtypes.so.3.1
 * /usr/lib/postgresql-8.4/lib/libpgtypes.so
 * /usr/lib/postgresql-8.4/lib/libecpg.so.6
 * /usr/lib/postgresql-8.4/lib/libpgtypes.a
 * /usr/lib/postgresql-8.4/lib/libecpg.so.6.1
 * /usr/lib/postgresql-8.4/lib/libecpg.so
 * /usr/lib/postgresql-8.4/lib/libecpg.a
 * /usr/lib/postgresql-8.4/lib/libecpg_compat.so.3.1
 * /usr/lib/postgresql-8.4/lib/libecpg_compat.so.3
 * /usr/lib/postgresql-8.4/lib/libecpg_compat.so
 * /usr/lib/postgresql-8.4/lib/libecpg_compat.a
 * /usr/lib/postgresql-8.4/share
 * /usr/lib/postgresql-8.4/share/locale
 * /usr/lib/postgresql-8.4/share/locale/cs
 * /usr/lib/postgresql-8.4/share/locale/cs/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/cs/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/cs/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/cs/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/de
 * /usr/lib/postgresql-8.4/share/locale/de/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/de/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/de/LC_MESSAGES/ecpglib6-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/de/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/de/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/de/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/de/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/de/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/es
 * /usr/lib/postgresql-8.4/share/locale/es/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/es/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/es/LC_MESSAGES/ecpglib6-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/es/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/es/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/es/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/es/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/es/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/fr
 * /usr/lib/postgresql-8.4/share/locale/fr/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/fr/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/fr/LC_MESSAGES/ecpglib6-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/fr/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/fr/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/fr/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/fr/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/fr/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/it
 * /usr/lib/postgresql-8.4/share/locale/it/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/it/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/it/LC_MESSAGES/ecpglib6-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/it/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/it/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/it/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/it/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/it/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ja
 * /usr/lib/postgresql-8.4/share/locale/ja/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/ja/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ja/LC_MESSAGES/ecpglib6-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ja/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ja/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ja/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ja/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ja/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ko
 * /usr/lib/postgresql-8.4/share/locale/ko/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/ko/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ko/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ko/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ko/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ko/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ko/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/pt_BR
 * /usr/lib/postgresql-8.4/share/locale/pt_BR/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/pt_BR/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/pt_BR/LC_MESSAGES/ecpglib6-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/pt_BR/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/pt_BR/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/pt_BR/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/pt_BR/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/pt_BR/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ru
 * /usr/lib/postgresql-8.4/share/locale/ru/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/ru/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ru/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/sv
 * /usr/lib/postgresql-8.4/share/locale/sv/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/sv/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/sv/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/sv/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/sv/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/sv/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ta
 * /usr/lib/postgresql-8.4/share/locale/ta/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/ta/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ta/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ta/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/tr
 * /usr/lib/postgresql-8.4/share/locale/tr/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/tr/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/tr/LC_MESSAGES/ecpglib6-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/tr/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/tr/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/tr/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/tr/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/tr/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_CN
 * /usr/lib/postgresql-8.4/share/locale/zh_CN/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/zh_CN/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_CN/LC_MESSAGES/ecpglib6-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_CN/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_CN/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_CN/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_CN/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_CN/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_TW
 * /usr/lib/postgresql-8.4/share/locale/zh_TW/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/zh_TW/LC_MESSAGES/libpq5-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_TW/LC_MESSAGES/ecpg-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_TW/LC_MESSAGES/pg_dump-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_TW/LC_MESSAGES/psql-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_TW/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/zh_TW/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ro
 * /usr/lib/postgresql-8.4/share/locale/ro/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/ro/LC_MESSAGES/pgscripts-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/ro/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/share/locale/nb
 * /usr/lib/postgresql-8.4/share/locale/nb/LC_MESSAGES
 * /usr/lib/postgresql-8.4/share/locale/nb/LC_MESSAGES/pg_config-8.4.mo
 * /usr/lib/postgresql-8.4/bin
 * /usr/lib/postgresql-8.4/bin/ecpg
 * /usr/lib/postgresql-8.4/bin/pg_dump
 * /usr/lib/postgresql-8.4/bin/pg_restore
 * /usr/lib/postgresql-8.4/bin/pg_dumpall
 * /usr/lib/postgresql-8.4/bin/psql
 * /usr/lib/postgresql-8.4/bin/createdb
 * /usr/lib/postgresql-8.4/bin/dropdb
 * /usr/lib/postgresql-8.4/bin/createlang
 * /usr/lib/postgresql-8.4/bin/droplang
 * /usr/lib/postgresql-8.4/bin/createuser
 * /usr/lib/postgresql-8.4/bin/dropuser
 * /usr/lib/postgresql-8.4/bin/clusterdb
 * /usr/lib/postgresql-8.4/bin/vacuumdb
 * /usr/lib/postgresql-8.4/bin/reindexdb
 * /usr/lib/postgresql-8.4/bin/pg_config
 * /usr/lib/postgresql-8.4/bin/oid2name
 * /usr/lib/postgresql-8.4/bin/pgbench
 * /usr/lib/postgresql-8.4/bin/vacuumlo



Examining how it invokes ./configure, I can see it passing --prefix=/usr/lib/postgresql-8.4 to it.... obviously this is incorrect.  However, looking through the ebuild, I cannot see how to change this.

By the way, PostgreSQL 9.0 builds just fine.

Thanks, regards,
       Asfand




Comment 1


Asfand Yar Qazi





          2011-03-21 13:27:06 UTC
        

Created attachment 266719 [details]
ebuild configuring




Comment 2


Aaron W. Swenson






          2011-03-22 00:05:49 UTC
        

Give 8.4.7-r1 from the main gentoo-x86 tree a shot.




Comment 3


Fabian Groffen






          2011-03-22 07:51:06 UTC
        

hmmm, is that version supposed to be Prefix Proof(tm)?




Comment 4


Asfand Yar Qazi





          2011-03-22 10:38:21 UTC
        

Correction: this happens while building postgresql-base - it doesn't get as far as postgresql-server.


8.4.6 is the latest version in the 8 series that is in the prefix, hence the bug report.  The next one up is 9.0.2, which I cannot use due to needing to stay close in terms of version numbers to what is used in my organization.

What do I have to put in the ebuild file to make it pass a --prefix of ${EPREFIX}/usr/lib/postgresql-8.4 ?  That should fix the problem.




Comment 5


Fabian Groffen






          2011-03-22 10:40:20 UTC
        

I have to bring in the .7 for -base still.  I hope this afternoon.




Comment 6


Aaron W. Swenson






          2011-03-22 10:44:22 UTC
        

Fabian: I've moved the ebuilds to EAPI3 and have done all the ${D} to ${ED}, ${ROOT} to ${EROOT} conversions.

Should require little more than a copy/paste.

I do have to fix a typo in postgresql-base-9.0.3-r1.ebuild, but that's about it.




Comment 7


Aaron W. Swenson






          2011-03-22 11:22:28 UTC
        

And I fixed the typo, so 9.0.3-r1 should be good now.




Comment 8


Asfand Yar Qazi





          2011-03-22 11:44:45 UTC
        

Well, having dug a bit further, I produced a patch which makes 8.4.6 compile.

Attached.




Comment 9


Asfand Yar Qazi





          2011-03-22 11:48:40 UTC
        

Created attachment 266835 [details, diff]
Let postgresql-base-8.4.6 compile




Comment 10


Fabian Groffen






          2011-03-30 10:55:43 UTC
        

ebuilds are now from gx86, please reevaluate




Comment 11


Asfand Yar Qazi





          2011-03-30 15:32:30 UTC
        

Latest ebuilds work for me - postgresql-base and postgresql-server 8.4.7-r2 are both installed on my x86/debian prefix









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

