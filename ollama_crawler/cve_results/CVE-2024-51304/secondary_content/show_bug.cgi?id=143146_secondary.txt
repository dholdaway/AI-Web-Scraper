Title: 143146 – glibc-2.3.6-r4 fails to install on Alpha
URL: https://bugs.gentoo.org/show_bug.cgi?id=143146

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 143146
glibc-2.3.6-r4 fails to install on Alpha
Last modified: 2007-03-13 06:37:43 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 143146 
      - glibc-2.3.6-r4 fails to install on Alpha


Summary:
glibc-2.3.6-r4 fails to install on Alpha
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] Core system

  (show other bugs)



Hardware:

Alpha
        Linux
      







Importance:
      
Highest
       critical
      


Assignee:

Alpha Porters








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-08-07 17:14 UTC by Lukas Kaminski





      Modified:
    
2007-03-13 06:37 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



toolchain









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




error message

              (error.txt,19.01 KB,
                text/plain)

            
2006-08-07 17:23 UTC,

            Lukas Kaminski




Details





the file symlink.list which is mentioned in the bug-report

              (symlink.list,4.72 KB,
                text/plain)

            
2006-08-08 15:29 UTC,

            Lukas Kaminski




Details





the sln utility (binary ev56?) which is mentioned in the bug-report

              (sln,611.61 KB,
                application/octet-stream)

            
2006-08-08 15:30 UTC,

            Lukas Kaminski




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Lukas Kaminski





          2006-08-07 17:14:51 UTC
        

Portage 2.1-r1 (default-linux/alpha/no-nptl, gcc-4.1.1, glibc-2.3.5-r3, 2.6.16-gentoo-r10 alpha)
=================================================================
System uname: 2.6.16-gentoo-r10 alpha EV56
Gentoo Base System version 1.6.15
app-admin/eselect-compiler: [Not Present]
dev-lang/python:     2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r4
ACCEPT_KEYWORDS="alpha"
AUTOCLEAN="yes"
CBUILD="alpha-unknown-linux-gnu"
CFLAGS="-mieee -pipe -O2 -mtune=ev56 -mcpu=ev56 -fomit-frame-pointer"
CHOST="alpha-unknown-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/lib/mozilla/defaults/pref /usr/share/X11/xkb /usr/share/config /usr/share/texmf/dvipdfm/config/ /usr/share/texmf/dvips/config/ /usr/share/texmf/tex/generic/config/ /usr/share/texmf/tex/platex/config/ /usr/share/texmf/xdvi/"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-mieee -pipe -O2 -mtune=ev56 -mcpu=ev56 -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="http://mirrors.sec.informatik.tu-darmstadt.de/gentoo/"
LINGUAS="de pl"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/overlays/gcj"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="alpha apache2 bash-completion berkdb bitmap-fonts bzip2 caps cli crypt cups dlloader eds emacs encode foomaticdb fortran gif gstreamer gtk2 imlib ipv6 isdnlog javamail jms jmx jpeg jpeg2k kde kdehiddenvisibility kerberos ldap libg++ libwww mad mikmod motif mp3 mpeg ncurses nls odbc ogg opengl oss pam pcre pdflib perl png postgres pppd python qt qt3 quicktime readline reflection samba sasl sdl session skey spell spl ssl tcpd tetex tiff truetype truetype-fonts type1-fonts udev usb vorbis xinerama xml xorg xprint xv zlib elibc_glibc input_devices_keyboard input_devices_mouse input_devices_evdev kernel_linux linguas_de linguas_pl userland_GNU"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, MAKEOPTS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Lukas Kaminski





          2006-08-07 17:23:05 UTC
        

Created attachment 93708 [details]
error message

The file symlink.list contains the full filenames, not only the 2 or 3 first letters.




Comment 2


SpanKY






          2006-08-07 19:44:08 UTC
        

post those two files as an attachment:
/var/tmp/portage/glibc-2.3.6-r4/work/build-default-alpha-unknown-linux-gnu-linuxthreads/elf/sln
/var/tmp/portage/glibc-2.3.6-r4/work/build-default-alpha-unknown-linux-gnu-linuxthreads/elf/symlink.list




Comment 3


Lukas Kaminski





          2006-08-08 15:29:03 UTC
        

Created attachment 93801 [details]
the file symlink.list which is mentioned in the bug-report




Comment 4


Lukas Kaminski





          2006-08-08 15:30:04 UTC
        

Created attachment 93803 [details]
the sln utility (binary ev56?) which is mentioned in the bug-report




Comment 5


SpanKY






          2006-08-08 23:03:53 UTC
        

ok, so the sln binary itself is hosed ...

if you go into the tmp dir and compile sln.c by hand, does the resulting binary work ?




Comment 6


Wolf Giesen (RETIRED)






          2006-08-09 02:06:40 UTC
        

I have something similar:

Invalid link from "ld-2." to ".6.": No such file or directory
Invalid link from "lib" to "-2.": No such file or directory
Invalid link from "libBro" to "enLo": No such file or directory
Invalid link from "libm-2." to ".6.": No such file or directory
Invalid link from "libdl-2." to ".6.": No such file or directory
Invalid link from "lib" to "rypt-2.": No such file or directory
Invalid link from "libpthread-0.10." to "o ": No such file or directory
Invalid link from "lib" to "idn-2.": No such file or directory
Invalid link from "libre" to "olv-2.": No such file or directory
Invalid link from "libn" to "_dn": No such file or directory
Invalid link from "libanl-2." to ".6.": No such file or directory
Invalid link from "libn" to "_file": No such file or directory
Invalid link from "librt-2." to ".6.": No such file or directory
Invalid link from "libthread_db-1.0." to "o ": No such file or directory
Invalid link from "libn" to "_he": No such file or directory
Invalid link from "libn" to "l-2.": No such file or directory
Invalid link from "libn" to "_ni": No such file or directory
Invalid link from "libn" to "_ni": No such file or directory
Invalid link from "libn" to "_": No such file or directory
Invalid link from "libutil-2." to ".6.": No such file or directory
Invalid link from "ld-2." to ".6.": No such file or directory
make[1]: *** [install-symbolic-link] Error 1
make[1]: Leaving directory `/var/tmp/portage/glibc-2.3.6-r4/work/glibc-2.3.6'
make: *** [install] Error 2

!!! ERROR: sys-libs/glibc-2.3.6-r4 failed.


symlink.list:

ld-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/ld-linux.so.2
libc-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libc.so.6.1
libBrokenLocale-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libBrokenLocale.so.1.1
libm-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libm.so.6.1
libdl-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libdl.so.2.1
libcrypt-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libcrypt.so.1.1
libpthread-0.10.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libpthread.so.0
libcidn-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libcidn.so.1
libresolv-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libresolv.so.2.1
libnss_dns-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libnss_dns.so.2
libanl-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libanl.so.1
libnss_files-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libnss_files.so.2
librt-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/librt.so.1
libthread_db-1.0.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libthread_db.so.1
libnss_hesiod-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libnss_hesiod.so.2
libnsl-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libnsl.so.1.1
libnss_nis-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libnss_nis.so.2
libnss_nisplus-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libnss_nisplus.so.2
libnss_compat-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libnss_compat.so.2
libutil-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/libutil.so.1.1
ld-2.3.6.so /var/tmp/portage/glibc-2.3.6-r4/image//lib/ld-linux.so.2





Comment 7


Lukas Kaminski





          2006-08-09 04:49:04 UTC
        

(In reply to comment #5)
> ok, so the sln binary itself is hosed ...
> 
> if you go into the tmp dir and compile sln.c by hand, does the resulting binary
> work ?
> 

Yes, with the handcompiled binary the next step succeeds. The merged glibc works, too. I will make some test, to look if some hidden brokeness is introduced with the new library. (Running KDE and compiling things should do it, isn't it?)

The error also showed up, if i compiled the glibc with gcc-3.4.6. How strange!




Comment 8


Stefaan De Roeck (RETIRED)






          2006-08-15 13:58:17 UTC
        

Same symptoms, but on a stable system with a stable sys-devel/gcc-3.3.2-r7...

Portage 2.1-r2 (default-linux/alpha/2005.0, gcc-3.3.2, glibc-2.3.5-r3, 2.6.14.2 alpha)
=================================================================
System uname: 2.6.14.2 alpha EV56
Gentoo Base System version 1.12.4
ccache version 2.3 [enabled]
app-admin/eselect-compiler: [Not Present]
dev-lang/python:     2.3.5, 2.4.3-r1
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     2.3
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r3
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r4
ACCEPT_KEYWORDS="alpha"
AUTOCLEAN="yes"
CBUILD="alpha-unknown-linux-gnu"
CFLAGS="-mieee -O2 -mcpu=ev56"
CHOST="alpha-unknown-linux-gnu"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CXXFLAGS="-mieee -O2 -mcpu=ev56"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig ccache distlocks metadata-transfer sandbox sfperms strict"
GENTOO_MIRRORS="ftp://ftp.belnet.be/mirror/rsync.gentoo.org/gentoo/"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://ftp.belnet.be/gentoo-portage"
USE="alpha arts berkdb bitmap-fonts bzip2 cli crypt cups dlloader dri eds encode font-server foomaticdb fortran gdbm gif gnome gpm gstreamer gtk gtk2 imlib ipv6 isdnlog jpeg kde libg++ libwww mad mikmod motif mp3 mpeg ncurses nls ogg oggvorbis opengl oss pam pcre pdflib perl png pppd python qt3 quicktime readline reflection sdl session spell spl ssl tcpd truetype truetype-fonts type1-fonts vorbis xml2 xmms xorg xv zlib elibc_glibc input_devices_keyboard input_devices_mouse input_devices_evdev kernel_linux userland_GNU"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, MAKEOPTS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 9


Fernando J. Pereda (RETIRED)






          2006-08-25 02:46:47 UTC
        

I could also reproduce this one on gendcc02:

--- 8< ---
Portage 2.1 (default-linux/alpha/2005.0, gcc-3.4.6/vanilla, glibc-2.3.5-r3, 2.6.14.2 alpha)
=================================================================
System uname: 2.6.14.2 alpha EV56
Gentoo Base System version 1.6.14
distcc 2.18.3 alpha-unknown-linux-gnu (protocols 1 and 2) (default port 3632) [enabled]
app-admin/eselect-compiler: 2.0.0_rc1-r5
dev-lang/python:     2.3.5, 2.4.2
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  0.4.2-r1
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r1
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 2.0.0_rc1
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.11-r4
ACCEPT_KEYWORDS="alpha"
AUTOCLEAN="yes"
CBUILD="alpha-unknown-linux-gnu"
CFLAGS="-mieee -O2 -mcpu=ev56 -pipe -msmall-data -msmall-text -frename-registers"
CHOST="alpha-unknown-linux-gnu"
CONFIG_PROTECT="/etc /usr/lib/X11/xkb /usr/lib/fax /var/spool/fax/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/terminfo"
CXXFLAGS="-mieee -O2 -mcpu=ev56 -pipe -msmall-data -msmall-text -frename-registers"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig confcache distcc distlocks metadata-transfer sandbox sfperms"
GENTOO_MIRRORS="ftp://ftp.ussg.iu.edu/pub/linux/gentoo/ ftp://gentoo.mirrors.pair.com"
MAKEOPTS="-j15"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='
/packages'"                                                                                         PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="alpha X berkdb bitmap-fonts cli crypt cups dlloader dri eds encode font-server foomaticdb fortran gdbm gif gnome gpm gstreamer gtk gtk2 imlib ipv6 isdnlog jpeg libg++ libwww mad mikmod motif mp3 mpeg ncurses nls ogg oggvorbis opengl oss pam pcre pdflib perl png pppd python qt3 quicktime readline reflection sdl session spell spl ssl tcpd truetype truetype-fonts type1-fonts vorbis xml2 xmms xor
g xv zlib elibc_glibc input_devices_keyboard input_devices_mouse input_devices_evdev kernel_linux userland_GNU"                                                                                         Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, LDFLAGS, LINGUAS, PORTAGE_RSYNC_EX
TRA_OPTS, PORTDIR_OVERLAY
--- 8< ---

and

--- 8< ---
[ebuild     U ] sys-libs/glibc-2.3.6-r4 [2.3.5-r3] USE="nls -build -erandom -glibc-compat20 -glibc-omitfp -nptl -nptlonly -profile" 0 kB
--- 8< ---

@toolchain: I can get you access to this machine if you need it.

- ferdy





Comment 10


Fernando J. Pereda (RETIRED)






          2006-08-25 04:36:59 UTC
        

Ok, so with a newer profile (2006.0) and USE="nptl nptlonly" glibc installs flawlessly.

I'm trying now with USE="nptl -nptlonly"

Those people using 2.4/ and no-nptl/ profiles will have to wait for a proper fix.

- ferdy




Comment 11


Fernando J. Pereda (RETIRED)






          2006-08-25 07:52:18 UTC
        

@toolchain:

USE="nptl -nptlonly" fails.
USE="-nptl -nptlonly" fails.
USE="nptl nptlonly" works.

- ferdy




Comment 12


Wolf Giesen (RETIRED)






          2006-09-08 02:53:35 UTC
        

Confirmed. Builds with "nptl nptlonly".





Comment 13


SpanKY






          2006-09-17 02:58:13 UTC
        

isspace('2') is returning true ... that's why it's breaking ...




Comment 14


SpanKY






          2006-09-17 03:33:13 UTC
        

looks like the ctype table is corrupted and/or not initialized properly when using linuxthreads statically ...

#include <ctype.h>
int main(int argc, char **argv)
{
    printf("%X\n", (*__ctype_b_loc ())['2']);
}

when run here, we are getting back 0x7900 instead of 0xD808 ... the isspace mask is 0x2000 which is why isspace('2') is returning true ...




Comment 15


SpanKY






          2007-03-13 06:37:43 UTC
        

these versions of glibc are no longer supported ... if glibc-2.5 shows issues, open a new bug report









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

