Title: 207076 – media-video/kaffeine-0.8.6: fails to merge on install phase
URL: https://bugs.gentoo.org/show_bug.cgi?id=207076

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 207076
media-video/kaffeine-0.8.6: fails to merge on install phase
Last modified: 2009-06-09 12:12:19 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 207076 
      - media-video/kaffeine-0.8.6: fails to merge on install phase


Summary:
media-video/kaffeine-0.8.6: fails to merge on install phase
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo KDE team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-01-22 20:46 UTC by Dmitrij D. Czarkoff





      Modified:
    
2009-06-09 12:12 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



arttuv69
bughunter
media-video









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Dmitrij D. Czarkoff





          2008-01-22 20:46:41 UTC
        

[ebuild     U ] media-video/kaffeine-0.8.6 [0.8.5-r2] USE="arts encode vorbis -debug -dvb -gstreamer -kdehiddenvisibility -xcb -xinerama" 0 kB

Fails with "mv: cannot stat `/home/portage/portage/media-video/kaffeine-0.8.6/image//usr/share/locale/*/LC_MESSAGES/kaffeine-0.8.6.mo': No such file or directory" error message.

My emerge --info:
Portage 2.1.4 (default-linux/amd64/2007.0/no-multilib, gcc-4.2.2, glibc-2.7-r1, 2.6.23-gentoo-r5 x86_64)
=================================================================
System uname: 2.6.23-gentoo-r5 x86_64 AMD Turion(tm) 64 Mobile Technology MT-28
Timestamp of tree: Tue, 22 Jan 2008 18:00:01 +0000
app-shells/bash:     3.2_p33
dev-lang/python:     2.5.1-r5
sys-apps/baselayout: 1.12.11.1
sys-apps/sandbox:    1.2.18.1-r2
sys-devel/autoconf:  2.13, 2.61-r1
sys-devel/automake:  1.5, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.1
sys-devel/binutils:  2.18-r1
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   1.5.24
virtual/os-headers:  2.6.23-r3
ACCEPT_KEYWORDS="amd64 ~amd64"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-O3 -march=k8 -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/revdep-rebuild /etc/terminfo /etc/texmf/web2c /etc/udev/rules.d"
CXXFLAGS="-O3 -march=k8 -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks metadata-transfer parallel-fetch sfperms unmerge-orphans userfetch userpriv"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LANG="en_US.utf8"
LC_ALL="en_US.utf8"
LINGUAS="ru"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages --filter=H_**/files/digest-*"
PORTAGE_TMPDIR="/home/portage"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="3dnow 3dnowext X a52 aac aalib acpi alsa amazon amd64 apm arts artswrappersuid artworkextra async atm automount bash-completion bashlogger berkdb bluetooth branding bzip2 cddb cdio cdparanoia cdr chm crypt cups curl cxx dbus deprecated devhelp device-mapper dhcp djvu doc dri dts dvd dvdr dvdread dvi eap-tls editor enca encode examples exif expat extensions fam ffmpeg flac fontconfig gif glep glitz gmp gnutls gpm gs hal ical iconv idle imlib inherit-graph ithreads jingle jpeg jpeg2k kde keyring laptop lcms ldap libnotify libsamplerate libsexy lm_sensors lyrics mad mailwrapper math md5sum midi mikmod mmx mmxext mng mp3 mp4 mpeg mudflap musepack musicbrainz ncurses networking nls nptl nsplugin nss offensive ogg ole opengl openmp pam pcmcia pcre pdf physfs pic plugins png ppds python qt3 quicktime rar rdesktop readline regex rle samba scanner sdl sensord slp sms sndfile sourceview speex spell sqlite srv sse sse2 ssl svg symlink t1lib taglib tagwriting tetex theora threads threadsafe tidy tiff toolbar tools trayicon truetype unicode usb utempter utils vim-pager vim-syntax vim-with-x visualization vnc vorbis wifi winbind wmf wordperfect x264 xattr xforms xhtml xine xml xorg xpm xprint xv xvid zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1x         ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3       trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="*" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse synaptics" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="ru" USERLAND="GNU" VIDEO_CARDS="radeon"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LDFLAGS, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS

Reproducible: Always




Comment 1


Jakub Moc (RETIRED)






          2008-01-22 20:55:47 UTC
        

You need to post some errors...




Comment 2


Dmitrij D. Czarkoff





          2008-01-23 09:27:38 UTC
        

Actually I have that system deleted now, but I do remember that it was complaining missing kaffeine-0.8.6.mo in usr/share/locale inside image directory.




Comment 3


Dmitrij D. Czarkoff





          2008-01-23 09:29:17 UTC
        

Sorry, the exact error message is given in my report. No other errors were encountered.




Comment 4


Wulf Krueger (RETIRED)






          2008-01-23 19:19:27 UTC
        

I can't reproduce that problem using your USE flags and language settings (LINGUAS=ru). If it happens again, please re-open this bug with more information.




Comment 5


Dmitrij D. Czarkoff





          2008-01-23 19:45:19 UTC
        

It actually heppened every of three times I tried. Other packages compiled without problems.
What additional information do You need?




Comment 6


Arttu Valo





          2009-06-07 12:52:21 UTC
        

It's probably using a wrong path somewhere in the install as I can get the same:

mv: cannot stat `/var/tmp/portage/media-video/kaffeine-0.8.6/image//usr/share/locale/*/LC_MESSAGES/kaffeine-0.8.6.mo': No such file or directory

Although when looking for them, the files actually might seem to be installed under here:

/var/tmp/portage/media-video/kaffeine-0.8.6/image/usr/kde/3.5/share/locale/*/LC_MESSAGES/kaffeine-0.8.6.mo





Comment 7


Jan Kohnert





          2009-06-09 12:01:19 UTC
        

I can confirm the bug. The ebuild seems to be broken by the fix for #199909.

configure looks that way:
./configure --prefix=/usr --build=x86_64-pc-linux-gnu --host=x86_64-pc-linux-gnu --mandir=/usr/share/man --infodir=/usr/share/info --datadir=/usr/share --sysconfdir=/etc --localstatedir=/var/lib --libdir=/usr/kde/3.5/lib64 --without-xinerama --with-dvb --with-gstreamer --with-oggvorbis --with-xcb --with-lame --with-x --enable-mitshm --without-xinerama --with-qt-dir=/usr/qt/3 --enable-mt --with-qt-libraries=/usr/qt/3/lib64 --disable-dependency-tracking --disable-debug --without-debug --without-arts --prefix=/usr/kde/3.5 --mandir=/usr/kde/3.5/share/man --infodir=/usr/kde/3.5/share/info --datadir=/usr/kde/3.5/share --sysconfdir=/usr/kde/3.5/etc --enable-libsuffix=64

As you can see, the language files will be installed in /usr/kde/3.5/share/$FOO due to configure options, which probably come from kde_src_compile.

OTOH, the ebuild tries to fix the language files with the following snippet:
	# fix localization, bug #199909
	for mofile in "${D}"/usr/share/locale/*/LC_MESSAGES/${P}.mo ; do
		mv -f ${mofile} ${mofile/${P}.mo/${PN}.mo} \
			|| die "fixing mo files failed"
	done

This will not work. BTW, I just discovered, that my installed kaffeine resides in /usr/bin, so the previous prefix has to /usr, not /usr/kde/3.5. I changed from 3.5.9 to 3.5.10 and by that upgrade from the monolitic kde packages to the split ebuilds, since the in no monolitic kde-3.6.10 in portage anymore. Something must have changed the installation path...




Comment 8


Theo Chatzimichos (RETIRED)








          2009-06-09 12:12:19 UTC
        

please upgrade to 0.8.8 it is going to be stabilized really soon. thanks









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

