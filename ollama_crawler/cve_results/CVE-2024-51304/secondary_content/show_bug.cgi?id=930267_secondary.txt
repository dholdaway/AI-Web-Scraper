Title: 930267 – dev-libs/openssl-3.0.13-r2 build failure due to unrecognized token
URL: https://bugs.gentoo.org/show_bug.cgi?id=930267

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 930267
dev-libs/openssl-3.0.13-r2 build failure due to unrecognized token
Last modified: 2024-04-20 09:37:12 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 930267 
      - dev-libs/openssl-3.0.13-r2 build failure due to unrecognized token


Summary:
dev-libs/openssl-3.0.13-r2 build failure due to unrecognized token
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo's Team for Core System packages








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2024-04-20 00:18 UTC by Scott Furry





      Modified:
    
2024-04-20 09:37 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



scott.wl.furry









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge_info.txt,6.07 KB,
                text/plain)

            
2024-04-20 00:21 UTC,

            Scott Furry




Details





emerge -pqv

              (emerge_build.txt,187 bytes,
                text/plain)

            
2024-04-20 00:22 UTC,

            Scott Furry




Details





emerge build log file

              (emerge_build_log.txt,67.59 KB,
                text/plain)

            
2024-04-20 00:22 UTC,

            Scott Furry




Details





evp.h

              (openssl_include_evp.h,101.31 KB,
                text/x-chdr)

            
2024-04-20 03:27 UTC,

            Scott Furry




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Scott Furry





          2024-04-20 00:18:32 UTC
        

Compile fails siting errors in [src]/include/openssl/evp.h:1590. Message reports expected ')' before '^' token.

Reproducible: Always

Actual Results:  
Error Msg:
---
gcc  -I. -Iinclude -Iproviders/common/include -Iproviders/implementations/include -I../openssl-3.0.13 -I../openssl-3.0.13/include -I../openssl-3.0.13/providers/common/include -I../openssl-3.0.13/providers/implementations/include  -DAES_ASM -DBSAES_ASM -DCMLL_ASM -DECP_NISTZ256_ASM -DGHASH_ASM -DKECCAK1600_ASM -DMD5_ASM -DOPENSSL_BN_ASM_GF2m -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_CPUID_OBJ -DOPENSSL_IA32_SSE2 -DPOLY1305_ASM -DRC4_ASM -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DVPAES_ASM -DWHIRLPOOL_ASM -DX25519_ASM -fPIC -pthread -m64 -Wa,--noexecstack -march=bdver1 -O2 -pipe -fno-strict-aliasing -Wa,--noexecstack -DOPENSSL_USE_NODELETE -DL_ENDIAN -DOPENSSL_PIC -DOPENSSLDIR="\"/etc/ssl\"" -DENGINESDIR="\"/usr/lib64/engines-3\"" -DMODULESDIR="\"/usr/lib64/ossl-modules\"" -DOPENSSL_BUILDING_OPENSSL -DNDEBUG  -MMD -MF crypto/asn1/libcrypto-lib-f_int.d.tmp -MT crypto/asn1/libcrypto-lib-f_int.o -c -o crypto/asn1/libcrypto-lib-f_int.o ../openssl-3.0.13/crypto/asn1/f_int.c
In file included from ../openssl-3.0.13/crypto/asn1/d2i_pu.c:19:
../openssl-3.0.13/include/openssl/evp.h:1590:41: error: expected ')' before '^' token
 1590 |                               int (*pkey_size) (const EVP_PKEY *pk),
      |                                         ^
      |                                         )
../openssl-3.0.13/include/openssl/evp.h:1591:31: error: expected ';', ',' or ')' before 'int'
 1591 |                               int (*pkey_bits) (const EVP_PKEY *pk));
      |                               ^~~
gcc  -I. -Iinclude -Iproviders/common/include -Iproviders/implementations/include -I../openssl-3.0.13 -I../openssl-3.0.13/include -I../openssl-3.0.13/providers/common/include -I../openssl-3.0.13/providers/implementations/include  -DAES_ASM -DBSAES_ASM -DCMLL_ASM -DECP_NISTZ256_ASM -DGHASH_ASM -DKECCAK1600_ASM -DMD5_ASM -DOPENSSL_BN_ASM_GF2m -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_CPUID_OBJ -DOPENSSL_IA32_SSE2 -DPOLY1305_ASM -DRC4_ASM -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DVPAES_ASM -DWHIRLPOOL_ASM -DX25519_ASM -fPIC -pthread -m64 -Wa,--noexecstack -march=bdver1 -O2 -pipe -fno-strict-aliasing -Wa,--noexecstack -DOPENSSL_USE_NODELETE -DL_ENDIAN -DOPENSSL_PIC -DOPENSSLDIR="\"/etc/ssl\"" -DENGINESDIR="\"/usr/lib64/engines-3\"" -DMODULESDIR="\"/usr/lib64/ossl-modules\"" -DOPENSSL_BUILDING_OPENSSL -DNDEBUG  -MMD -MF crypto/asn1/libcrypto-lib-f_string.d.tmp -MT crypto/asn1/libcrypto-lib-f_string.o -c -o crypto/asn1/libcrypto-lib-f_string.o ../openssl-3.0.13/crypto/asn1/f_string.c
make[1]: *** [Makefile:9575: crypto/asn1/libcrypto-lib-d2i_pu.o] Error 1
---




Comment 1


Scott Furry





          2024-04-20 00:21:55 UTC
        

Created attachment 891147 [details]
emerge --info

emerge --info '=dev-libs/openssl-3.0.13-r2::gentoo'




Comment 2


Scott Furry





          2024-04-20 00:22:29 UTC
        

Created attachment 891148 [details]
emerge -pqv

emerge -pqv '=dev-libs/openssl-3.0.13-r2::gentoo'




Comment 3


Scott Furry





          2024-04-20 00:22:58 UTC
        

Created attachment 891149 [details]
emerge build log file




Comment 4


Sam James









          2024-04-20 03:13:38 UTC
        

Can you upload /var/tmp/portage/dev-libs/openssl-3.0.13/work/openssl-3.0.13/include/openssl/evp.h please?




Comment 5


Sam James









          2024-04-20 03:13:58 UTC
        

(In reply to Sam James from comment #4)
> Can you upload
> /var/tmp/portage/dev-libs/openssl-3.0.13/work/openssl-3.0.13/include/openssl/
> evp.h please?

uh 3.0.13-r2/work/blah




Comment 6


Scott Furry





          2024-04-20 03:27:23 UTC
        

Created attachment 891150 [details]
evp.h

Requested Upload:
/var/tmp/portage/dev-libs/openssl-3.0.13-r2/work/openssl-3.0.13/include/openssl/evp.h




Comment 7


Sam James









          2024-04-20 04:54:07 UTC
        

I can't yet reproduce it. Is it really reproducible for you on every run?

Your /var/tmp/portage/dev-libs/openssl-3.0.13-r2/work/openssl-3.0.13/include/openssl/evp.h is also the same as mine.

Could you go into the workdir (/var/tmp/portage/dev-libs/openssl-3.0.13-r2/work/openssl-3.0.13-abi_x86_64.amd64) and run the failing GCC command manually?

If it still fails, please run it again with `-save-temps` appended and upload f_int.i.




Comment 8


Scott Furry





          2024-04-20 08:46:06 UTC
        

(In reply to Sam James from comment #7)
> I can't yet reproduce it. Is it really reproducible for you on every run?

Seems a clean fresh run did not reproduce the error. There was no real appreciable changes to system between runs.

If the crypto source file `d2i_pu.c` causes grief in future, this issue may need to be revisited.

For now, let's call this a "gremlin bug". It appeared and then disappeared.
Apologies for the noise.




Comment 9


Sam James









          2024-04-20 09:37:12 UTC
        

Thanks. I'd consider doing a memtest, fwiw.

Feel free to come back if it returns.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

