Title: 449886 – cross-avr/gcc-4.7.2 - configure: x86_64-pc-linux-gnu-ld-4.6.3: __gmpfr_cache_const_pi: TLS definition in  /usr//lib64/libmpfr.so section .tdata mismatches non-TLS definition in /usr/lib64/libmpfr.so.1 section .data
URL: https://bugs.gentoo.org/show_bug.cgi?id=449886

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 449886
cross-avr/gcc-4.7.2 - configure: x86_64-pc-linux-gnu-ld-4.6.3: __gmpfr_cache_const_pi: TLS definition in  /usr//lib64/libmpfr.so section .tdata mismatches non-TLS definition in /usr/lib64/libmpfr.so.1 section .data
Last modified: 2013-01-03 05:05:04 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 449886 
      - cross-avr/gcc-4.7.2 - configure: x86_64-pc-linux-gnu-ld-4.6.3: __gmpfr_cache_const_pi: TLS definition in  /usr//lib64/libmpfr.so section .tdata mismatches non-TLS definition in /usr/lib64/libmpfr.so.1 section .data


Summary:
cross-avr/gcc-4.7.2 - configure: x86_64-pc-linux-gnu-ld-4.6.3: __gmpfr_cache_...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

AMD64
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo Toolchain Maintainers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2013-01-03 00:41 UTC by David Relson





      Modified:
    
2013-01-03 05:05 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    




emerge --info

              (emerge-info.txt,5.66 KB,
                text/plain)

            
2013-01-03 00:43 UTC,

            David Relson




Details





cross-avr-info.log

              (cross-avr-info.log,15.50 KB,
                text/plain)

            
2013-01-03 00:44 UTC,

            David Relson




Details





cross-avr-gcc-stage1.log.xz

              (cross-avr-gcc-stage1.log.xz,2.92 KB,
                application/x-xz)

            
2013-01-03 00:44 UTC,

            David Relson




Details





gcc-config.logs.tar.xz

              (gcc-config.logs.tar.xz,5.64 KB,
                application/x-xz-compressed-tar)

            
2013-01-03 00:45 UTC,

            David Relson




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


David Relson





          2013-01-03 00:41:13 UTC
        

Configure fails when building gcc-4.7.2 for avr:

configure: error: Building GCC requires GMP 4.2+, MPFR 2.3.1+ and MPC 0.8.0+.

Reproducible: Always

Steps to Reproduce:
1.run command "crossdev -t avr"
2.
3.




Comment 1


David Relson





          2013-01-03 00:43:40 UTC
        

Created attachment 334100 [details]
emerge --info




Comment 2


David Relson





          2013-01-03 00:44:14 UTC
        

Created attachment 334102 [details]
cross-avr-info.log




Comment 3


David Relson





          2013-01-03 00:44:39 UTC
        

Created attachment 334104 [details]
cross-avr-gcc-stage1.log.xz




Comment 4


David Relson





          2013-01-03 00:45:07 UTC
        

Created attachment 334106 [details]
gcc-config.logs.tar.xz




Comment 5


Jeroen Roovers (RETIRED)






          2013-01-03 00:56:18 UTC
        

/usr/lib/gcc/x86_64-pc-linux-gnu/4.6.3/../../../../x86_64-pc-linux-gnu/bin/ld: __gmpfr_cache_const_pi: TLS definition in /usr/lib/gcc/x86_64-pc-linux-gnu/4.6.3/../../../../lib64/libmpfr.so section .tdata mismatches non-TLS definition in /usr/lib64/libmpfr.so.1 section .data




Comment 6


David Relson





          2013-01-03 04:34:40 UTC
        

Interesting!

/usr/lib64 contains (from a newly re-emerged mpfr):

     16 Jan  2 23:11 libmpfr.so -> libmpfr.so.4.1.1
 323648 Jan  2 23:11 libmpfr.so.1
     16 Jan  2 23:11 libmpfr.so.4 -> libmpfr.so.4.1.1
 381032 Jan  2 23:10 libmpfr.so.4.1.1

All of the ebuilds for mpfr contain:

   pkg_preinst() {
	preserve_old_lib /usr/$(get_libdir)/libmpfr.so.1
   }

   pkg_postinst() {
	preserve_old_lib_notify /usr/$(get_libdir)/libmpfr.so.1
   }

Evidently gcc requires libmpfr.so.4 and won't build with libmpfr.so.1.

How does one satisfy configure???

Thank you.




Comment 7


David Relson





          2013-01-03 04:52:02 UTC
        

Noticing that libmpc had a much older date than libmpfr, I emerged both libmpc and libmpfr.  With the new libraries, gcc-4.7.2 builds successfully.

It seems that building this cross compiler is more difficult than it ought to be.  Unfortunately I can't offer any suggestions on simplifying the process :-<




Comment 8


SpanKY






          2013-01-03 05:05:04 UTC
        

run revdep-rebuild and rebuild everything that is linked against the old mpfr









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

