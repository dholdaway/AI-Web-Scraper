Title: 530274 – app-text/fbreader-0.99.4-r2 compiles empty libzlui with ccache enabled - /usr/bin/fbreader: error while loading shared libraries: /usr/lib64/libzlui.so.0.99: file too short
URL: https://bugs.gentoo.org/show_bug.cgi?id=530274

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 530274
app-text/fbreader-0.99.4-r2 compiles empty libzlui with ccache enabled - /usr/bin/fbreader: error while loading shared libraries: /usr/lib64/libzlui.so.0.99: file too short
Last modified: 2019-08-17 23:59:24 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 530274 
      - app-text/fbreader-0.99.4-r2 compiles empty libzlui with ccache enabled - /usr/bin/fbreader: error while loading shared libraries: /usr/lib64/libzlui.so.0.99: file too short


Summary:
app-text/fbreader-0.99.4-r2 compiles empty libzlui with ccache enabled - /usr...
        









Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

Andrey Grozin








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2014-11-24 03:32 UTC by rpansky





      Modified:
    
2019-08-17 23:59 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



slyfox









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




build.log for fbreader-0.99.4-r2 with ccache enabled

              (ccache-build.log,140.37 KB,
                text/plain)

            
2014-11-24 03:32 UTC,

            rpansky




Details





build.log for fbreader-0.99.4-r2 with ccache disabled

              (noccache-build.log,139.93 KB,
                text/plain)

            
2014-11-24 03:33 UTC,

            rpansky




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


rpansky





          2014-11-24 03:32:46 UTC
        

Created attachment 390172 [details]
build.log for fbreader-0.99.4-r2 with ccache enabled

If app-text/fbreader is built with ccache enabled, the library libzlui.so appears to be an empty file. At the end of the build portage discovers the fact but terminates normally:

/sbin/ldconfig: File /usr/lib64/libzlui.so is empty, not checked.
/sbin/ldconfig: File /usr/lib64/libzlui.so.0.99.4 is empty, not checked.
/sbin/ldconfig: File /usr/lib64/libzlui.so.0.99 is empty, not checked.

Surely, the main executable does not work:

/usr/bin/fbreader: error while loading shared libraries: /usr/lib64/libzlui.so.0.99: file too short

With ccache disabled, everything is fine.

Logs for both ccache-enabled and disabled builds are attached (ccache has been cleared before ccache-enabled build).

emerge --info (ccache is enabled globally):

Portage 2.2.8-r2 (default/linux/amd64/13.0/desktop, gcc-4.8.3, glibc-2.19-r1, 3.16.5-gentoo x86_64)
=================================================================
System uname: Linux-3.16.5-gentoo-x86_64-AMD_Phenom-tm-_II_X4_940_Processor-with-gentoo-2.2
KiB Mem:     8170840 total,   3315868 free
KiB Swap:    1572860 total,   1572860 free
Timestamp of tree: Sun, 23 Nov 2014 00:45:01 +0000
ld GNU ld (Gentoo 2.24 p1.4) 2.24
distcc 3.1 x86_64-pc-linux-gnu [disabled]
ccache version 3.1.9 [enabled]
app-shells/bash:          4.2_p53
dev-java/java-config:     2.2.0
dev-lang/perl:            5.18.2-r2
dev-lang/python:          2.7.7, 3.3.5-r1, 3.4.1
dev-util/ccache:          3.1.9-r3
dev-util/cmake:           2.8.12.2-r1
dev-util/pkgconfig:       0.28-r1
sys-apps/baselayout:      2.2
sys-apps/openrc:          0.12.4
sys-apps/sandbox:         2.6-r1
sys-devel/autoconf:       2.13::<unknown repository>, 2.69
sys-devel/automake:       1.11.6-r1, 1.12.6, 1.13.4
sys-devel/binutils:       2.24-r3
sys-devel/gcc:            4.8.3
sys-devel/gcc-config:     1.7.3
sys-devel/libtool:        2.4.2-r1
sys-devel/make:           4.0-r1
sys-kernel/linux-headers: 3.16 (virtual/os-headers)
sys-libs/glibc:           2.19-r1
Repositories: gentoo local_auto local
ACCEPT_KEYWORDS="amd64"
ACCEPT_LICENSE="*"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=amdfam10 -O2 -mcx16 -msahf -m3dnow -mmmx -msse4a -fomit-frame-pointer -fstack-protector -pipe"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/share/gnupg/qualified.txt"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/dconf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5.5/ext-active/ /etc/php/cgi-php5.5/ext-active/ /etc/php/cli-php5.5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/texmf/language.dat.d /etc/texmf/language.def.d /etc/texmf/updmap.d /etc/texmf/web2c"
CXXFLAGS="-march=amdfam10 -O2 -mcx16 -msahf -m3dnow -mmmx -msse4a -fomit-frame-pointer -fstack-protector -pipe"
DISTDIR="/usr/portage/distfiles"
FCFLAGS="-O2 -pipe"
FEATURES="assume-digests binpkg-logs ccache compressdebug config-protect-if-modified distlocks ebuild-locks fixlafiles merge-sync news parallel-fetch preserve-libs protect-owned sandbox sfperms splitdebug strict suidctl unknown-features-warn unmerge-logs unmerge-orphans userfetch userpriv usersandbox usersync webrsync-gpg xattr"
FFLAGS="-O2 -pipe"
GENTOO_MIRRORS=""
LANG="en_US.UTF-8"
LC_ALL=""
LDFLAGS="-Wl,-O1 -Wl,--as-needed"
MAKEOPTS="-j5"




Comment 1


rpansky





          2014-11-24 03:33:58 UTC
        

Created attachment 390174 [details]
build.log for fbreader-0.99.4-r2 with ccache disabled




Comment 2


Sergei Trofimovich (RETIRED)






          2019-08-17 23:37:57 UTC
        

Does it still happen? I wonder if it's a parallel build issue exposed by ccache.




Comment 3


Sergei Trofimovich (RETIRED)






          2019-08-17 23:59:24 UTC
        

Worked locally without any problems.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

