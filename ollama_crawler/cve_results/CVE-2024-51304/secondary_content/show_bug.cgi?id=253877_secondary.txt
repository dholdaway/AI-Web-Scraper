Title: 253877 – services not loading after emerge -e world openrc
URL: https://bugs.gentoo.org/show_bug.cgi?id=253877

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 253877
services not loading after emerge -e world openrc
Last modified: 2009-01-05 18:42:15 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 253877 
      - services not loading after emerge -e world openrc


Summary:
services not loading after emerge -e world openrc
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

[OLD] baselayout

  (show other bugs)



Hardware:

x86
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Gentoo Linux bug wranglers








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2009-01-05 17:04 UTC by Joshua S





      Modified:
    
2009-01-05 18:42 UTC
      (History)
    




          CC List:
        

0 
          users
        








See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Joshua S





          2009-01-05 17:04:36 UTC
        

Basically I just need pointed in the right direction. After an world upgrade I've been moved to openRC which is not reading from /etc/conf.d config files. I've imported RC_USE_CONFIG_PROFILE to /etc/rc.conf. I cannot find an docs that tell me if there is something else that I am missing. This causes net.eth0 to not load. Someone please help me, I am lost and need to get this server back online.  I followed the guide at http://www.gentoo.org/doc/en/openrc-migration.xml but am still missing something.

Reproducible: Always

Steps to Reproduce:
1. emerge -e world
2. follow migrate to openrc howto
3. reboot

Actual Results:  
most services dont load due to not reading from /etc/conf.d config files.

Expected Results:  
openrc reads from /etc/conf.d config files to properly boot services.

Portage 2.1.6.4 (default/linux/x86/2008.0, gcc-4.1.2, glibc-2.9_p20081201-r1, 2.6.18 i686)
=================================================================
System uname: Linux-2.6.18-i686-Intel-R-_Celeron-R-_CPU_2.40GHz-with-glibc2.0
Timestamp of tree: Mon, 05 Jan 2009 01:35:01 +0000
app-shells/bash:     3.2_p48
dev-lang/python:     2.4.4-r14, 2.5.2-r8
dev-python/pycrypto: 2.0.1-r6
sys-apps/baselayout: 2.0.0
sys-apps/openrc:     0.4.1-r1
sys-apps/sandbox:    1.3.2
sys-devel/autoconf:  2.13, 2.63
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10.2
sys-devel/binutils:  2.19
sys-devel/gcc-config: 1.4.0-r4
sys-devel/libtool:   2.2.6a
virtual/os-headers:  2.6.28-r1
ACCEPT_KEYWORDS="x86 ~x86"
CBUILD="i686-pc-linux-gnu"
CFLAGS="-O2 -march=i686 -pipe"
CHOST="i686-pc-linux-gnu"
CONFIG_PROTECT="/etc /var/bind"
CONFIG_PROTECT_MASK="/etc/ca-certificates.conf /etc/env.d /etc/fonts/fonts.conf /etc/gconf /etc/gentoo-release /etc/php/apache2-php5/ext-active/ /etc/php/cgi-php5/ext-active/ /etc/php/cli-php5/ext-active/ /etc/revdep-rebuild /etc/sandbox.d /etc/terminfo /etc/udev/rules.d"
CXXFLAGS="-O2 -march=i686 -pipe"
DISTDIR="/usr/portage/distfiles"
FEATURES="distlocks fixpackages parallel-fetch protect-owned sandbox sfperms strict unmerge-orphans userfetch"
GENTOO_MIRRORS="http://distfiles.gentoo.org http://distro.ibiblio.org/pub/linux/distributions/gentoo"
LDFLAGS="-Wl,-O1"
LINGUAS="us_en"
MAKEOPTS="-j2"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="acl apache2 authdaemond bzip2 cgi cli cracklib crypt curl curlwrappers dri encode exif fontconfig fortran ftp gd gdbm gif gpm iconv imap isdnlog jpeg mhash midi milter ming mpeg mudflap mysql ncurses nls nptl nptlonly openmp pam pcre perl php png pppd python readline reflection sasl session simplexml snmp soap sockets spell spl ssl svg sysfs tcpd tidy truetype unicode v4l vhosts x86 xml xmlreader xmlrpc xmlwriter xorg xsl xvid zip zlib" ALSA_CARDS="ali5451 als4000 atiixp atiixp-modem bt87x ca0106 cmipci emu10k1 emu10k1x ens1370 ens1371 es1938 es1968 fm801 hda-intel intel8x0 intel8x0m maestro3 trident usb-audio via82xx via82xx-modem ymfpci" ALSA_PCM_PLUGINS="adpcm alaw asym copy dmix dshare dsnoop empty extplug file hooks iec958 ioplug ladspa lfloat linear meter mmap_emul mulaw multi null plug rate route share shm softvol" APACHE2_MODULES="actions alias auth_basic authn_alias authn_anon authn_dbm authn_default authn_file authz_dbm authz_default authz_groupfile authz_host authz_owner authz_user autoindex cache dav dav_fs dav_lock deflate dir disk_cache env expires ext_filter file_cache filter headers include info log_config logio mem_cache mime mime_magic negotiation rewrite setenvif speling status unique_id userdir usertrack vhost_alias" ELIBC="glibc" INPUT_DEVICES="keyboard mouse evdev" KERNEL="linux" LCD_DEVICES="bayrad cfontz cfontz633 glk hd44780 lb216 lcdm001 mtxorb ncurses text" LINGUAS="us_en" USERLAND="GNU" VIDEO_CARDS="fbdev glint i810 intel mach64 mga neomagic nv r128 radeon savage sis tdfx trident vesa vga via vmware voodoo"
Unset:  CPPFLAGS, CTARGET, EMERGE_DEFAULT_OPTS, FFLAGS, INSTALL_MASK, LANG, LC_ALL, PORTAGE_COMPRESS, PORTAGE_COMPRESS_FLAGS, PORTAGE_RSYNC_EXTRA_OPTS, PORTDIR_OVERLAY




Comment 1


Joshua S





          2009-01-05 18:16:31 UTC
        

I edited /etc/init.d/runscript.sh line:
_conf_d=${RC_SERVICE%/*}/../conf.d

to:
_conf_d=/etc/conf.d

and corrected the issue.

I'm not sure where or what the patch would actually look like so I'll leave it to you guys to decide on.





Comment 2


Joshua S





          2009-01-05 18:27:56 UTC
        

Correction: I edited /lib/rc/sh/runscript.sh as the symlink was mine in an attempt to correct the issue earlier.

So, the problem exists because RC_SERVICE is run from /lib/rc/sh, therefore shouldn't /lib/rc/conf be symlinked to /etc/conf.d in order to fully correct this? Or something like this which would allow baselayout-1 and baselayout-2 with openrc to operate correctly.






Comment 3


Joshua S





          2009-01-05 18:42:15 UTC
        

Actually, after looking further the proper fix is 

# cd /etc/rc.d
# ln -s /etc/conf.d conf.d

This fixes the issue if you are using baselayout-2 and openrc.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

