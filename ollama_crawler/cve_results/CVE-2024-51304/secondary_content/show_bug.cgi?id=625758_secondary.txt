Title: 625758 – sys-kernel/ck-sources-4.11.11 fails to build
URL: https://bugs.gentoo.org/show_bug.cgi?id=625758

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 625758
sys-kernel/ck-sources-4.11.11 fails to build
Last modified: 2017-08-07 10:26:03 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 625758 
      - sys-kernel/ck-sources-4.11.11 fails to build


Summary:
sys-kernel/ck-sources-4.11.11 fails to build
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
Normal
       normal
      


Assignee:

kuzetsa CatSwarm (kuza for short)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2017-07-20 19:14 UTC by Sergey Ilinykh





      Modified:
    
2017-08-07 10:26 UTC
      (History)
    




          CC List:
        

3 
          users
          
            (show)
          



gokturk
jstein
proxy-maint









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Sergey Ilinykh





          2017-07-20 19:14:54 UTC
        

Relevant part of genkernel.log

 CC [M]  drivers/gpu/drm/i915/intel_guc_loader.o
  CC [M]  drivers/virtio/virtio_pci_modern.o
  CC [M]  drivers/gpu/drm/radeon/rs780_dpm.o
  CC [M]  drivers/net/phy/bcm-phy-lib.o
  CC [M]  drivers/usb/storage/scsiglue.o
  CC [M]  drivers/net/ppp/ppp_async.o
  CC [M]  drivers/usb/serial/ipw.o
In file included from ./include/linux/linkage.h:4:0,
                 from ./include/linux/kernel.h:6,
                 from ./include/linux/delay.h:21,
                 from drivers/virtio/virtio_pci_modern.c:20:
drivers/virtio/virtio_pci_modern.c: В функции «check_offsets»:
drivers/virtio/virtio_pci_modern.c:542:24: ошибка: invalid use of undefined type «struct virtio_pci_common_cff»
        offsetof(struct virtio_pci_common_cff, queue_select));
                        ^
./include/linux/compiler.h:509:19: замечание: in definition of macro «__compiletime_assert»
   bool __cond = !(condition);    \
                   ^~~~~~~~~
./include/linux/compiler.h:529:2: замечание: in expansion of macro «_compiletime_assert»
  _compiletime_assert(condition, msg, __compiletime_assert_, __LINE__)
  ^~~~~~~~~~~~~~~~~~~
./include/linux/bug.h:54:37: замечание: in expansion of macro «compiletime_assert»
 #define BUILD_BUG_ON_MSG(cond, msg) compiletime_assert(!(cond), msg)
                                     ^~~~~~~~~~~~~~~~~~
./include/linux/bug.h:78:2: замечание: in expansion of macro «BUILD_BUG_ON_MSG»
  BUILD_BUG_ON_MSG(condition, "BUILD_BUG_ON failed: " #condition)
  ^~~~~~~~~~~~~~~~
drivers/virtio/virtio_pci_modern.c:541:2: замечание: in expansion of macro «BUILD_BUG_ON»
  BUILD_BUG_ON(VIRTIO_PCI_COMMON_Q_SELECT !=
  ^~~~~~~~~~~~
./include/linux/stddef.h:16:32: замечание: in expansion of macro «__compiler_offsetof»
 #define offsetof(TYPE, MEMBER) __compiler_offsetof(TYPE, MEMBER)
                                ^~~~~~~~~~~~~~~~~~~
drivers/virtio/virtio_pci_modern.c:542:8: замечание: in expansion of macro «offsetof»
        offsetof(struct virtio_pci_common_cff, queue_select));
        ^~~~~~~~
make[2]: *** [scripts/Makefile.build:294: drivers/virtio/virtio_pci_modern.o] Ошибка 1
make[1]: *** [scripts/Makefile.build:553: drivers/virtio] Ошибка 2
make[1]: *** Ожидание завершения заданий…
  CC [M]  drivers/net/ethernet/brocade/bna/bnad.o
  CC [M]  drivers/scsi/aacraid/commctrl.o
  CC [M]  drivers/gpu/drm/radeon/rv6xx_dpm.o
  CC [M]  drivers/gpu/drm/i915/intel_huc.o
  CC [M]  drivers/net/ppp/ppp_deflate.o
  CC [M]  drivers/usb/serial/ir-usb.o
  CC [M]  drivers/net/phy/broadcom.o


I don't know where struct virtio_pci_common_cff comes from but here is a mistype. it should be virtio_pci_common_cfg. After the fix compilation went fine.

Reproducible: Always




Comment 1


kuzetsa CatSwarm (kuza for short)





          2017-07-26 02:35:01 UTC
        

Can you please upload /usr/src/linux/.config for this kernel? I'd like to do some testing to see if I can reproduce.

Also, sys-kernel/ck-sources-4.11.12 is out now, so please see if you can reproduce the issue is fixed with the new release.




Comment 2


kuzetsa CatSwarm (kuza for short)





          2017-07-26 02:49:35 UTC
        

I'm looking at the source from sys-kernel/ck-sources-4.11.12 (unpacked / emerged today) and I can't find the referenced typo at or around line #524

Please try to reproduce this issue on sys-kernel/ck-sources-4.11.12 I suspect there may have been disk corruption on your system if you're there was a typo of:

virtio_pci_common_cff

^ This particular spelling doesn't exist at all for me in the file:

/usr/src/linux/drivers/virtio/virtio_pci_modern.c




Comment 3


kuzetsa CatSwarm (kuza for short)





          2017-08-01 07:18:38 UTC
        

https://wiki.gentoo.org/wiki/Bugzilla/Guide#Set_locale_to_C_or_English

^ when you rebuild / try to reproduce the issue if you're going to post logs, please do this, except you'll need to use it for the make / build commands (rather than emerge itself)

If the bug can be reproduced, it's usual policy for the logs to be in english.




Comment 4


Sergey Ilinykh





          2017-08-02 12:00:06 UTC
        

Hi, kuzetsa!

sorry for a long response. I'll check once again this evening. If no problem with 4.11.12 then let's just close the bug.

If you can ping me in 17.00-18.00 utc today.




Comment 5


Sergey Ilinykh





          2017-08-02 12:01:37 UTC
        

oh I accidently closed it. I'll reopen if anything wrong :-)









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

