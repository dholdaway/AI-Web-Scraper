Title: 197395 – dev-texlive/texlive-latex-2007 does not finish due to ushyphen.tex
URL: https://bugs.gentoo.org/show_bug.cgi?id=197395

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 197395
dev-texlive/texlive-latex-2007 does not finish due to ushyphen.tex
Last modified: 2007-11-11 22:25:11 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 197395 
      - dev-texlive/texlive-latex-2007 does not finish due to ushyphen.tex


Summary:
dev-texlive/texlive-latex-2007 does not finish due to ushyphen.tex
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

TeX project








URL:







Whiteboard:




Keywords:









Duplicates (2):
    

197401 197402

      (view as bug list)
    


Depends on:







Blocks:









 





      Reported:
    
2007-10-29 10:41 UTC by konsti





      Modified:
    
2007-11-11 22:25 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



ralf









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




the language.dat file itself

              (language.dat,2.05 KB,
                text/plain)

            
2007-10-29 12:28 UTC,

            konsti




Details





the language.us file

              (language.us,2.01 KB,
                text/plain)

            
2007-10-29 12:29 UTC,

            konsti




Details





full build log

              (build.log,8.18 KB,
                text/plain)

            
2007-10-29 14:34 UTC,

            konsti




Details





texmf.cnf

              (texmf.cnf,26.49 KB,
                text/plain)

            
2007-10-29 14:54 UTC,

            konsti




Details





View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


konsti





          2007-10-29 10:41:52 UTC
        

I am switching to texlife and texlife-latex breaks:

(/var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf-dist/tex/generic/ba
bel/hyphen.cfg
! I can't find file `ushyphen.tex'.
<to be read again>
                   \relax
l.357   \repeat

Please type another input file name:
! Emergency stop.
<to be read again>
                   \relax
l.357   \repeat

No pages of output.
Transcript written on latex.log.
Error: `pdftex -ini  -jobname=latex -progname=latex -translate-file=cp227.tcx *latex.ini' failed

###############################################################################
fmtutil: Error! Not all formats have been built successfully.
Visit the log files in directory
  /var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf-var/web2c
for details.
###############################################################################

This is a summary of all `failed' messages and warnings:
`pdftex -ini  -jobname=latex -progname=latex -translate-file=cp227.tcx *latex.ini' failed
 ^[[31;01m*^[[0m
 ^[[31;01m*^[[0m ERROR: dev-texlive/texlive-latex-2007 failed.
 ^[[31;01m*^[[0m Call stack:
 ^[[31;01m*^[[0m               ebuild.sh, line 1695:  Called dyn_compile
 ^[[31;01m*^[[0m               ebuild.sh, line 1033:  Called qa_call 'src_compile'
 ^[[31;01m*^[[0m               ebuild.sh, line   44:  Called src_compile
 ^[[31;01m*^[[0m               ebuild.sh, line 1377:  Called texlive-module_src_compile
 ^[[31;01m*^[[0m   texlive-module.eclass, line   53:  Called die
 ^[[31;01m*^[[0m The specific snippet of code:
 ^[[31;01m*^[[0m                        TEXMFHOME="${S}/texmf:${S}/texmf-dist"\
 ^[[31;01m*^[[0m                                fmtutil --cnffile "${i}" --fmtdir "${S}/texmf-var/web2c" --all\
 ^[[31;01m*^[[0m                                || die "failed to build format ${i}"
 ^[[31;01m*^[[0m  The die message:
 ^[[31;01m*^[[0m   failed to build format texmf/fmtutil/format.latex.cnf
 ^[[31;01m*^[[0m
 ^[[31;01m*^[[0m If you need support, post the topmost build error, and the call stack if relevant.
 ^[[31;01m*^[[0m A complete build log is located at '/var/tmp/portage/dev-texlive/texlive-latex-2007/temp/build.log'.
 ^[[31;01m*^[[0m


Currently I am trying to figure this out and where to get this file :-)




Comment 1


Jakub Moc (RETIRED)






          2007-10-29 11:32:32 UTC
        

*** Bug 197401 has been marked as a duplicate of this bug. ***




Comment 2


Alexis Ballier






          2007-10-29 11:43:32 UTC
        

what output do you get with: 
kpsewhich language.dat

and:

kpsewhich language.us




Comment 3


konsti





          2007-10-29 12:13:23 UTC
        

 # kpsewhich language.dat
/usr/share/texmf/tex/generic/config/language.dat
 # kpsewhich language.us
/usr/share/texmf/tex/generic/config/language.us




Comment 4


Alexis Ballier






          2007-10-29 12:16:35 UTC
        

could you please attach those two files ? (I should have asked that earlier)




Comment 5


konsti





          2007-10-29 12:28:22 UTC
        

Created attachment 134629 [details]
the language.dat file itself




Comment 6


konsti





          2007-10-29 12:29:14 UTC
        

Created attachment 134631 [details]
the language.us file




Comment 7


Alexis Ballier






          2007-10-29 12:46:30 UTC
        

do you have a latex.log file somewhere ?
it should be in /var/tmp/portage/dev-texlive/texlive-latex-2007/work/ or /var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf-var/web2c/pdftex/

if yes, could you please attach it ?
I don't understand why it tries to load ushyphen.tex, which is not present, and your language.dat file does not mention it.

By the way, have you updated/changed the config files in /etc/texmf/texmf.d ? could you post a list of the files present in that directory ?




Comment 8


konsti





          2007-10-29 12:58:13 UTC
        

Sadly no, no latex.log file:

 # pwd
/var/tmp/portage/dev-texlive/texlive-latex-2007
 # find .|grep log
./temp/logging
./temp/build.log
./temp/eclass-debug.log
./work/texmf-dist/source/latex/base/ltlogos.dtx

I have not modified stuff below /etc/texmf. I removed that directory (and a couple of texmv ones below /var/), unmerged tetex-3 and started to emerge texlive. 

 # cd /etc/texmf/texmf.d
 # ls -la
total 32
drwxr-xr-x  2 root root   113 2007-10-29 11:17 .
drwxr-xr-x 10 root root   130 2007-10-29 13:54 ..
-rw-r--r--  1 root root  2276 2007-10-29 11:17 00header.cnf
-rw-r--r--  1 root root  4642 2007-10-29 11:17 05searchpaths.cnf
-rw-r--r--  1 root root 10421 2007-10-29 11:17 10standardpaths.cnf
-rw-r--r--  1 root root  2427 2007-10-29 11:17 15options.cnf
-rw-r--r--  1 root root  2824 2007-10-29 11:17 20sizes.cnf






Comment 9


Jakub Moc (RETIRED)






          2007-10-29 13:02:28 UTC
        

*** Bug 197402 has been marked as a duplicate of this bug. ***




Comment 10


Alexis Ballier






          2007-10-29 13:03:20 UTC
        

hmm it seems you have not updated to texlive-core-2007-r3; could you try syncing and installing it ? default config files have changed a bit, perhaps that could solve the problem




Comment 11


konsti





          2007-10-29 13:45:44 UTC
        

Indeed a sync revealed core-r3 and I updated to this, but the error on texlive-latex ist the same as before.




Comment 12


Alexis Ballier






          2007-10-29 14:11:11 UTC
        

could you please attach the full build log then (that should be more or less the same as latex.log), and your texmf.cnf file in /etc/texmf/web2c




Comment 13


konsti





          2007-10-29 14:34:53 UTC
        

Created attachment 134641 [details]
full build log




Comment 14


konsti





          2007-10-29 14:54:51 UTC
        

Created attachment 134642 [details]
texmf.cnf




Comment 15


Alexis Ballier






          2007-10-29 15:01:23 UTC
        

hmm could you try this little trick while emerging texlive-latex:
- ctrl Z after src_unpack (and before it tries to build the latex format)
- try removing /var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf-dist/source/generic/babel/language.dat
- type fg

that's the only reference to ushyphen.tex I can find, and this file should not be used... your texmf.cnf file is perfectly sane, and it seems it try to use the wrong language.dat definitions file.




Comment 16


konsti





          2007-10-29 15:17:45 UTC
        

I did "ebuild EBUILD unpack" and investigated from there:
First I moved /var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf-dist/source/generic/babel/language.dat
out of the way, which was _NOT_ sufficient, same error.
I found another reference in work/texmf-dist/doc/generic/babel/language.dat (same file though, no diff output) and this yielded into succesful compile stage.
The install target runs fine and the final qmerge stage also.






Comment 17


Alexis Ballier






          2007-10-29 17:40:22 UTC
        

when you have a failed build (so that the temp dir created by portage is still here), could you give me the output of :
 TEXMFHOME="/var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf:/var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf-dist" kpsewhich language.dat


I don't understand why the language.dat in the source dir gets in the way, and I've never seen that problem before :/




Comment 18


R Stephan





          2007-10-30 11:25:44 UTC
        

I have the same problem and the output to your kpsewhich command is

/usr/share/texmf/tex/generic/config/language.dat




Comment 19


R Stephan





          2007-10-30 11:46:51 UTC
        

(In reply to comment #18)
> I have the same problem and the output to your kpsewhich command is
> 
> /usr/share/texmf/tex/generic/config/language.dat

Ah no, sorry, I just see my problem is different. Building texlive-latex-2007 fails, after deleting the above file, with the output

Building format texmf/fmtutil/format.latex.cnf
fmtutil: format directory /var/tmp/.../work/texmf-var/web2c does not exist

and that was it also before I deleted the language.dat above




Comment 20


Alexis Ballier






          2007-10-30 12:21:20 UTC
        

(In reply to comment #19)
> (In reply to comment #18)
> > I have the same problem and the output to your kpsewhich command is
> > 
> > /usr/share/texmf/tex/generic/config/language.dat
> 
> Ah no, sorry, I just see my problem is different. Building texlive-latex-2007
> fails, after deleting the above file, with the output
> 
> Building format texmf/fmtutil/format.latex.cnf
> fmtutil: format directory /var/tmp/.../work/texmf-var/web2c does not exist
> 


could you please open a new bug for this ? I've seen that bug happening, but it automagically resolved... perhaps we could track the cause




Comment 21


R Stephan





          2007-10-30 15:43:06 UTC
        

(In reply to comment #20)
> > fmtutil: format directory /var/tmp/.../work/texmf-var/web2c does not exist
> 
> could you please open a new bug for this ? I've seen that bug happening, but it
> automagically resolved... perhaps we could track the cause

Okay. Please see 197528.





Comment 22


Alexis Ballier






          2007-11-06 23:30:17 UTC
        

(In reply to comment #17)
> when you have a failed build (so that the temp dir created by portage is still
> here), could you give me the output of :
> 
> TEXMFHOME="/var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf:/var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf-dist"
> kpsewhich language.dat
> 


ping ?






Comment 23


konsti





          2007-11-07 09:09:12 UTC
        

Does this refer to me I should put the output here? I mus have forgot by accident, WAM.




Comment 24


konsti





          2007-11-07 09:20:29 UTC
        

I actually realize that my real solution of this problem did not made it into here, may be my browser ate it or whatsoever, I am very sorry.
What I realized was, that I have environment variables set to include rechnung.sty. My root did have the same ~/.zshrc so he borrowed this environment:

MYTEX=${HOME}/tex/rechnung310:
TEXINPUTS='.//:$TEXMF//':${MYTEX}//:
MFINPUTS='.//:$TEXMF//':${MYTEX}//:
TFMFONTS='.//:$TEXMF/fonts//':/var/texfonts//:${MYTEX}//:
export TEXINPUTS
export MFINPUTS
export TFMFONTS

Konsti has a ~/tex, root not. With this environment the build breaks, the output to your command is:
# TEXMFHOME="/var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf:/var/tmp/portage/dev-texlive/texlive-latex-2007/work/texmf-dist"
# kpsewhich language.dat /usr/share/texmf/tex/generic/config/language.dat

If I don't set these variables the build runs fine.

So the question is, if root must not set such stuff or the ebuild should take care of this. Really, I expected this message being in here and did not check carefully :-/





Comment 25


Alexis Ballier






          2007-11-11 22:25:11 UTC
        

(In reply to comment #24)
> So the question is, if root must not set such stuff or the ebuild should take
> care of this. Really, I expected this message being in here and did not check
> carefully :-/

thanks for the explanation. Indeed it breaks also here with that environment.
I'd say root must not have this variable in the env. There are too many ways to break it like that: set a wrong TEXINPUTS like you did, but it'll also break with TEXINPUTS_latex set to the same values, etc.

As far as I understand it, setting $TEXMF in TEXINPUTS tells it it can include anything from the texmf tree, while there are per program values set in texmf.cnf, so such a setting is probably wrong and will break not only with portage.










Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

