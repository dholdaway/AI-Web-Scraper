Title: 152414 – app-emulation/xen-tools-3.0.2-r4 fails to compile
URL: https://bugs.gentoo.org/show_bug.cgi?id=152414

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 152414
app-emulation/xen-tools-3.0.2-r4 fails to compile
Last modified: 2006-11-01 14:13:54 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 152414 
      - app-emulation/xen-tools-3.0.2-r4 fails to compile


Summary:
app-emulation/xen-tools-3.0.2-r4 fails to compile
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

Current packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Andrew Ross (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2006-10-22 12:52 UTC by Sander Sweers





      Modified:
    
2006-11-01 14:13 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



xen









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Sander Sweers





          2006-10-22 12:52:16 UTC
        

I looked at the ebuild and saw some filtering on the -nopie and -fno-stack-protector flags but it still seams to fail.

------
make[2]: Entering directory `/var/tmp/portage/app-emulation/xen-tools-3.0.2-r4/work/xen-3.0.2/tools/firmware/hvmloader'
./mkhex rombios ../rombios/BIOS-bochs-latest > roms.h
./mkhex vgabios_stdvga ../vgabios/VGABIOS-lgpl-latest.bin >> roms.h
./mkhex vgabios_cirrusvga ../vgabios/VGABIOS-lgpl-latest.cirrus.bin >> roms.h
./mkhex vmxassist ../vmxassist/vmxassist.bin >> roms.h
./mkhex acpi ../acpi/acpi.bin >> roms.h
gcc -nopie -fno-stack-protector -g -m32 -march=i686 -Wall -Wstrict-prototypes -Wdeclaration-after-statement     -DDEBUG -I. -I../../../tools/libxc -fno-builtin -O2 -msoft-float -c hvmloader.c acpi_madt.c
gcc: unrecognized option '-nopie'
/var/tmp/portage/app-emulation/xen-tools-3.0.2-r4/temp/cczvS57c.s: Assembler messages:
/var/tmp/portage/app-emulation/xen-tools-3.0.2-r4/temp/cczvS57c.s:38810: Error: can't resolve `.bss' {.bss section} - `.Ltext0' {.text section}
/var/tmp/portage/app-emulation/xen-tools-3.0.2-r4/temp/cczvS57c.s:38811: Error: 
[more of the same]

emerge --info
Portage 2.1.2_pre3-r6 (default-linux/amd64/2006.1, gcc-4.1.1, glibc-2.5-r0, 2.6.17-gentoo-r9 x86_64)
=================================================================
System uname: 2.6.17-gentoo-r9 x86_64 AMD Athlon(tm) 64 Processor 3200+
Gentoo Base System version 1.12.5
Last Sync: Sun, 22 Oct 2006 19:00:01 +0000
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: 1.3.7, 2.0.30
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.18.1
sys-devel/autoconf:  2.13, 2.60
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2, 1.10
sys-devel/binutils:  2.17
sys-devel/gcc-config: 1.3.14
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="amd64 ~amd64"
AUTOCLEAN="yes"
CBUILD="x86_64-pc-linux-gnu"
CFLAGS="-march=k8 -O -pipe -fomit-frame-pointer"
CHOST="x86_64-pc-linux-gnu"
CONFIG_PROTECT="/etc /usr/kde/3.5/env /usr/kde/3.5/share/config /usr/kde/3.5/shutdown /usr/share/X11/xkb /usr/share/config"
CONFIG_PROTECT_MASK="/etc/env.d /etc/env.d/java/ /etc/gconf /etc/java-config/vms/ /etc/terminfo /etc/texmf/web2c"
CXXFLAGS="-march=k8 -O -pipe -fomit-frame-pointer"
DISTDIR="/usr/portage/distfiles"
FEATURES="autoconfig distlocks metadata-transfer nostrip parallel-fetch sandbox sfperms strict userfetch userpriv usersandbox"
GENTOO_MIRRORS="ftp://ftp.snt.utwente.nl/pub/os/linux/gentoo"
LDFLAGS="-Wl,-O1 -Wl,-s -Wl,--as-needed"
LINGUAS="en_GB nl uk"
PKGDIR="/usr/portage/packages"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude=/distfiles --exclude=/local --exclude=/packages"
PORTAGE_TMPDIR="/var/tmp"
PORTDIR="/usr/portage"
PORTDIR_OVERLAY="/usr/local/overlays/xulrunner /usr/local/overlays/mine"
SYNC="rsync://rsync.gentoo.org/gentoo-portage"
USE="amd64 X a52 aac acpi alsa apache2 apm avi bash-completion beagle berkdb bitmap-fonts bzip2 cairo cdr cli cracklib crypt cups dbus debug dlloader dri dvd dvdr dvdread elibc_glibc esd exif flac fortran gdbm glibc-omitfp glitz gnome gpm gstreamer gtk gtk2 hal input_devices_evdev input_devices_keyboard input_devices_mouse isdnlog java jpeg kernel_linux libcaca libg++ linguas_en_GB linguas_nl linguas_uk logrotate mad mono mozilla mp3 ncurses network nls nptl nptlonly nsplugin offensive ogg oggvorbis opengl oss pam pcre pdf perl png ppds pppd python readline reflection sdl seamonkey session speex spell spl ssl svg tcpd theora threads tiff tk truetype truetype-fonts type1-fonts udev unicode userland_GNU v4l v4l2 video_cards_radeon vorbis xorg xprint xvid zlib"
Unset:  CTARGET, EMERGE_DEFAULT_OPTS, INSTALL_MASK, LANG, LC_ALL, MAKEOPTS, PORTAGE_RSYNC_EXTRA_OPTS




Comment 1


Andrew Ross (RETIRED)






          2006-10-23 00:48:58 UTC
        

Please run " ebuild /usr/portage/app-emulation/xen-tools/xen-tools-3.0.2-r4.ebuild unpack", then attach the following file to this bug:

/var/tmp/portage/xen-tools-3.0.2-r4/work/xen-3.0.2/tools/firmware/hvmloader/Makefile




Comment 2


Sander Sweers





          2006-10-23 01:38:35 UTC
        

I am not at home right now but I can confirm it still has the -nopie and -fno-stack.. flags (checked it yesterday before i posted this bug). I will attach it when i get home tonight.




Comment 3


Andrew Ross (RETIRED)






          2006-10-26 21:15:14 UTC
        

I can't reproduce this here, but my only 2006.1 system is x86, rather than ~amd64.

For -nopie to appear in /var/tmp/portage/xen-tools-3.0.2-r4/work/xen-3.0.2/tools/firmware/hvmloader/Makefile it must have passed test-flag-CC from flag-o-matic.eclass, but a bug with test-flag-CC and gcc 4.1.1 would have shown up on my system as well as yours.

The only other option I can think of is that you're accidentally using an old -r4 ebuild from my overlay. Can you please run "emerge --sync && rm -rf /var/tmp/portage/xen-tools-3.0.2-r4 && ebuild
/usr/portage/app-emulation/xen-tools/xen-tools-3.0.2-r4.ebuild compile" to confirm/disprove this theory.

By the way, please don't forget that Gentoo doesn't support user-specified LDFLAGS, so be sure to unset those and re-test.

Gentoo Base System version 1.12.5
Portage 2.1.1 (default-linux/x86/2006.1, gcc-4.1.1, glibc-2.4-r3, 2.6.15-gentoo-r5 i686)
=================================================================
System uname: 2.6.15-gentoo-r5 i686 Pentium II (Klamath)
Last Sync: Thu, 26 Oct 2006 09:20:01 +0000
app-admin/eselect-compiler: [Not Present]
dev-java/java-config: [Not Present]
dev-lang/python:     2.4.3-r4
dev-python/pycrypto: 2.0.1-r5
dev-util/ccache:     [Not Present]
dev-util/confcache:  [Not Present]
sys-apps/sandbox:    1.2.17
sys-devel/autoconf:  2.13, 2.59-r7
sys-devel/automake:  1.4_p6, 1.5, 1.6.3, 1.7.9-r1, 1.8.5-r3, 1.9.6-r2
sys-devel/binutils:  2.16.1-r3
sys-devel/gcc-config: 1.3.13-r4
sys-devel/libtool:   1.5.22
virtual/os-headers:  2.6.17-r1
ACCEPT_KEYWORDS="x86"
ACCEPT_LICENSE=""
ARCH="x86"
AUTOCLEAN="yes"
BOOT_IMAGE="gentoo"
CBUILD="i686-pc-linux-gnu"
CDBOOT="1"
CFLAGS="-mno-tls-direct-seg-refs -O2 -pipe"
CHOST="i686-pc-linux-gnu"
CLEAN_DELAY="5"
CONFIG_PROTECT="/etc"
CONFIG_PROTECT_MASK="/etc/env.d /etc/gconf /etc/revdep-rebuild /etc/terminfo"
CONSOLE="/dev/tty1"
CROSSCOMPILE_OPTS=""
CVS_RSH="ssh"
CXXFLAGS="-O2 -mcpu=i686 -pipe"
DISTDIR="/usr/portage/distfiles"
DVB_CARDS=""
EDITOR="/bin/nano"
ELIBC="glibc"
EMERGE_DEFAULT_OPTS="--ask --verbose"
EMERGE_WARNING_DELAY="10"
FCDSL_CARDS=""
FEATURES="autoconfig distlocks metadata-transfer parallel-fetch sandbox sfperms strict userfetch userpriv usersandbox"
FETCHCOMMAND="/usr/bin/wget -t 5 -T 60 --passive-ftp -P ${DISTDIR} ${URI}"
FOO2ZJS_DEVICES=""
FRITZCAPI_CARDS=""
GCC_SPECS=""
GENTOO_MIRRORS="http://mirror.internode.on.net/pub/gentoo http://distfiles.gentoo.org http://www.ibiblio.org/pub/Linux/distributions/gentoo"
GUILE_LOAD_PATH="/usr/share/guile/1.6"
G_BROKEN_FILENAMES="1"
HOME="/"
INFOPATH="/usr/share/info:/usr/share/binutils-data/i686-pc-linux-gnu/2.16.1/info::/usr/share/gcc-data/i686-pc-linux-gnu/4.1.1/info"
INIT_VERSION="sysvinit-2.86"
INPUT_DEVICES="keyboard mouse evdev"
KERNEL="linux"
LESS="-R -M --shift 5"
LESSOPEN="|lesspipe.sh %s"
LINGUAS=""
LIRC_DEVICES=""
MANPATH="/usr/local/share/man:/usr/share/man:/usr/share/binutils-data/i686-pc-linux-gnu/2.16.1/man::/usr/share/gcc-data/i686-pc-linux-gnu/4.1.1/man"
MISDN_CARDS=""
OLDPWD="/"
PAGER="/usr/bin/less"
PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/bin:/usr/i686-pc-linux-gnu/gcc-bin/4.1.1:/usr/i686-pc-linux-gnu/gcc-bin/4.1.1"
PKGDIR="/usr/portage/packages"
PORTAGE_ARCHLIST="ppc s390 amd64 x86 ppc64 x86-fbsd m68k arm sparc sh mips ia64 alpha ppc-macos hppa sparc-fbsd"
PORTAGE_BINHOST_CHUNKSIZE="3000"
PORTAGE_BIN_PATH="/usr/lib/portage/bin"
PORTAGE_CALLER="emerge"
PORTAGE_CONFIGROOT="/"
PORTAGE_DEBUG="0"
PORTAGE_DEPCACHEDIR="/var/cache/edb/dep"
PORTAGE_ELOG_CLASSES="warn error log"
PORTAGE_ELOG_MAILFROM="portage"
PORTAGE_ELOG_MAILSUBJECT="[portage] ebuild log for ${PACKAGE} on ${HOST}"
PORTAGE_ELOG_MAILURI="root"
PORTAGE_GID="250"
PORTAGE_INST_GID="0"
PORTAGE_INST_UID="0"
PORTAGE_PYM_PATH="/usr/lib/portage/pym"
PORTAGE_RSYNC_OPTS="--recursive --links --safe-links --perms --times --compress --force --whole-file --delete --delete-after --stats --timeout=180 --exclude='/distfiles' --exclude='/local' --exclude='/packages'"
PORTAGE_RSYNC_RETRIES="3"
PORTAGE_TMPDIR="/var/tmp"
PORTAGE_WORKDIR_MODE="0700"
PORTDIR="/usr/portage"
PRELINK_PATH=""
PRELINK_PATH_MASK=""
PREVLEVEL="N"
PWD="/usr/portage/app-emulation/xen-tools"
PYTHONPATH="/usr/lib/portage/pym"
RESUMECOMMAND="/usr/bin/wget -c -t 5 -T 60 --passive-ftp -P ${DISTDIR} ${URI}"
ROOT="/"
ROOTPATH="/opt/bin:/usr/i686-pc-linux-gnu/gcc-bin/4.1.1:/usr/i686-pc-linux-gnu/gcc-bin/4.1.1"
RPMDIR="/usr/portage/rpm"
RUNLEVEL="3"
SHLVL="2"
STAGE1_USE="nptl nptlonly unicode"
SYNC="rsync://rsync.au.gentoo.org/gentoo-portage"
TERM="linux"
USE="x86 bash-completion berkdb bitmap-fonts bzip2 cli cracklib crypt cups dlloader dri elibc_glibc fortran gdbm gpm input_devices_evdev input_devices_keyboard input_devices_mouse ipv6 isdnlog kernel_linux libg++ ncurses nls nptl nptlonly pam pcre perl ppds pppd python readline reflection session spl ssl tcpd truetype-fonts type1-fonts udev unicode urandom userland_GNU video_cards_apm video_cards_ark video_cards_ati video_cards_chips video_cards_cirrus video_cards_cyrix video_cards_dummy video_cards_fbdev video_cards_glint video_cards_i128 video_cards_i740 video_cards_i810 video_cards_imstt video_cards_mga video_cards_neomagic video_cards_nsc video_cards_nv video_cards_rendition video_cards_s3 video_cards_s3virge video_cards_savage video_cards_siliconmotion video_cards_sis video_cards_sisusb video_cards_tdfx video_cards_tga video_cards_trident video_cards_tseng video_cards_v4l video_cards_vesa video_cards_vga video_cards_via video_cards_vmware video_cards_voodoo xorg zlib"
USERLAND="GNU"
USE_EXPAND="CROSSCOMPILE_OPTS DVB_CARDS ELIBC FCDSL_CARDS FOO2ZJS_DEVICES FRITZCAPI_CARDS INPUT_DEVICES KERNEL LINGUAS LIRC_DEVICES MISDN_CARDS USERLAND VIDEO_CARDS"
USE_EXPAND_HIDDEN="CROSSCOMPILE_OPTS ELIBC KERNEL USERLAND"
USE_ORDER="env:pkg:conf:defaults"
VIDEO_CARDS="apm ark ati chips cirrus cyrix dummy fbdev glint i128 i740 i810 imstt mga neomagic nsc nv rendition s3 s3virge savage siliconmotion sis sisusb tdfx tga trident tseng v4l vesa vga via vmware voodoo"
XARGS="xargs -r"
_="/usr/bin/emerge"
initrd="gentoo.igz"
loop="/image.squashfs"
looptype="squashfs"
splash="silent,theme:livecd-2006.0"
vga="791"





Comment 4


Sander Sweers





          2006-11-01 14:13:54 UTC
        

Sorry it took so long to respond but the system with the error does not exist anymore. I am resolving it with WORKSFORME for now untill I have a working system again. When it reapears again reopen and attach the Makefile.

Greets
Sander









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

