Title: 363583 – [patch] dev-lang/perl-5.12.3 fails to compile on Gentoo/FBSD (AMD64)
URL: https://bugs.gentoo.org/show_bug.cgi?id=363583

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 363583
[patch] dev-lang/perl-5.12.3 fails to compile on Gentoo/FBSD (AMD64)
Last modified: 2012-04-21 16:34:13 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 363583 
      - [patch] dev-lang/perl-5.12.3 fails to compile on Gentoo/FBSD (AMD64)


Summary:
[patch] dev-lang/perl-5.12.3 fails to compile on Gentoo/FBSD (AMD64)
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo/Alt




Classification:

Unclassified




Component:

FreeBSD

  (show other bugs)



Hardware:

AMD64
        FreeBSD
      







Importance:
      
Normal
       normal
      


Assignee:

Gentoo/BSD Team








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2011-04-14 12:15 UTC by Yuta SATOH





      Modified:
    
2012-04-21 16:34 UTC
      (History)
    




          CC List:
        

2 
          users
          
            (show)
          



prefix
ryao









See Also:






Package list:







Runtime testing required:

---























      Attachments
    




patch for gdbm-1.8.3-r4.ebuild

              (gdbm-1.8.3-r4.ebuild.patch,352 bytes,
                patch)

            
2011-04-14 12:20 UTC,

            Yuta SATOH




Details
            | Diff





Show
              Obsolete (1)
            View All

Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


Yuta SATOH





          2011-04-14 12:15:11 UTC
        

The following message is displayed and fails to compile on Gentoo/FBSD (AMD64).

        Making GDBM_File (all)

Running Makefile.PL in ext/GDBM_File
../../miniperl Makefile.PL INSTALLDIRS=perl INSTALLMAN1DIR=none INSTALLMAN3DIR=none PERL_CORE=1 LIBPERL_A=libperl.so.5.12.3 LINKTYPE=dynamic
Writing Makefile for GDBM_File
gmake[1]: Entering directory `/var/tmp/portage/dev-lang/perl-5.12.3/work/perl-5.12.3/ext/GDBM_File'
gmake[1]: Leaving directory `/var/tmp/portage/dev-lang/perl-5.12.3/work/perl-5.12.3/ext/GDBM_File'
Making all in ext/GDBM_File
 gmake all PERL_CORE=1 LIBPERL_A=libperl.so.5.12.3 LINKTYPE=dynamic
gmake[1]: Entering directory `/var/tmp/portage/dev-lang/perl-5.12.3/work/perl-5.12.3/ext/GDBM_File'
cp GDBM_File.pm ../../lib/GDBM_File.pm
../../miniperl "-I../../lib" "-I../../lib" ../../lib/ExtUtils/xsubpp -noprototypes -typemap ../../lib/ExtUtils/typemap -typemap typemap  GDBM_File.xs > GDBM_File.xsc && mv GDBM_File.xsc GDBM_File.c
x86_64-gentoo-freebsd8.0-gcc -c   -DHAS_FPSETMASK -DHAS_FLOATINGPOINT_H -fno-strict-aliasing -pipe -O2 -pipe   -DVERSION=\"1.10\" -DXS_VERSION=\"1.1\" -DPIC -fPIC "-I../.."   GDBM_File.c
Running Mkbootstrap for GDBM_File ()
chmod 644 GDBM_File.bs
rm -f ../../lib/auto/GDBM_File/GDBM_File.so
LD_RUN_PATH="/usr/lib" x86_64-gentoo-freebsd8.0-gcc  -shared  -L/usr/local/lib  GDBM_File.o  -o ../../lib/auto/GDBM_File/GDBM_File.so   \
   -lgdbm       \

/usr/lib/gcc/x86_64-gentoo-freebsd8.0/4.5.2/../../../../x86_64-gentoo-freebsd8.0/bin/ld: /usr/lib/gcc/x86_64-gentoo-freebsd8.0/4.5.2/../../../libgdbm.a(gdbmfetch.o): relocation R_X86_64_32 against `.rodata.str1.1' can not be used when making a shared object; recompile with -fPIC
/usr/lib/gcc/x86_64-gentoo-freebsd8.0/4.5.2/../../../libgdbm.a: could not read symbols: Bad value
collect2: ld returned 1 exit status
gmake[1]: *** [../../lib/auto/GDBM_File/GDBM_File.so] Error 1
gmake[1]: Leaving directory `/var/tmp/portage/dev-lang/perl-5.12.3/work/perl-5.12.3/ext/GDBM_File'
Unsuccessful make(ext/GDBM_File): code=512 at make_ext.pl line 449.
gmake: *** [lib/auto/GDBM_File/GDBM_File.so] Error 25
emake failed


Reproducible: Always

Steps to Reproduce:
1. emerge perl
2.
3.




Comment 1


Yuta SATOH





          2011-04-14 12:20:14 UTC
        

Created attachment 269939 [details, diff]
patch for gdbm-1.8.3-r4.ebuild




Comment 2


Fabian Groffen






          2011-05-03 11:00:06 UTC
        

problem confirmed on vanilla FreeBSD 8.2 with Gentoo Prefix




Comment 3


Alexis Ballier






          2011-07-06 19:11:06 UTC
        

Comment on attachment 269939 [details, diff]
patch for gdbm-1.8.3-r4.ebuild

no, this isnt the right approach: libgdbm.a should _not_ be PIC; libgdbm.so* should be and that's what gcc should find. Why dont you have libgdbm.so ?




Comment 4


Fabian Groffen






          2011-07-06 19:27:45 UTC
        

probably because libgdbm.a is in /usr/lib here




Comment 5


Alexis Ballier






          2011-07-06 19:40:55 UTC
        

(In reply to comment #4)
> probably because libgdbm.a is in /usr/lib here

and the .so isnt ?




Comment 6


Yuta SATOH





          2012-04-21 15:22:59 UTC
        

This problem no longer occurs on amd64-fbsd (9.0/8.2 both, 20120415 snapshot).
How is on prefix ?




Comment 7


Alexis Ballier






          2012-04-21 16:34:13 UTC
        

(In reply to comment #6)
> This problem no longer occurs on amd64-fbsd (9.0/8.2 both, 20120415
> snapshot).
> How is on prefix ?

this was probably due to a bad installation of libgdbm, either missing .so or usr ldscript.









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

