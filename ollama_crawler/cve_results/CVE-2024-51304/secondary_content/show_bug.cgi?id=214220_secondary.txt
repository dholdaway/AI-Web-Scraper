Title: 214220 – net-fs/openafs-1.4.6_p20080222 error in openafs-client initscript
URL: https://bugs.gentoo.org/show_bug.cgi?id=214220

Go to: 
		Gentoo Home
Documentation
Forums
Lists
Bugs
Planet
Store
Wiki
Get Gentoo!





Gentoo's Bugzilla – Bug 214220
net-fs/openafs-1.4.6_p20080222 error in openafs-client initscript
Last modified: 2009-10-24 21:40:08 UTC node [vulture]


Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]













Bug 214220 
      - net-fs/openafs-1.4.6_p20080222 error in openafs-client initscript


Summary:
net-fs/openafs-1.4.6_p20080222 error in openafs-client initscript
    








Status:
    

RESOLVED
          WORKSFORME
      






Alias:


        None
    





Product:

Gentoo Linux




Classification:

Unclassified




Component:

New packages

  (show other bugs)



Hardware:

All
        Linux
      







Importance:
      
High
       normal
      


Assignee:

Stefaan De Roeck (RETIRED)








URL:







Whiteboard:




Keywords:








Depends on:







Blocks:









 





      Reported:
    
2008-03-22 04:29 UTC by ecks





      Modified:
    
2009-10-24 21:40 UTC
      (History)
    




          CC List:
        

1 
          user
          
            (show)
          



net-fs









See Also:






Package list:







Runtime testing required:

---























      Attachments
    



Add an attachment
        (proposed patch, testcase, etc.)
    








Note
              You need to
              log in
              before you can comment on or make changes to this bug.
            

















Description


ecks





          2008-03-22 04:29:41 UTC
        

There is a small error in /etc/init.d/openafs-client. The error is on line 14, the if statement. It checks if $OPTIONS equals the "AUTOMATIC" string, however the default setup in /etc/conf.d/openafs-client has the OPTIONS equal to "AUTOMATIC -nosettime -memcache -verbose" which is wrong. What I think was meant here is if $OPTIONS contains the string AUTOMATIC. I fixed it by changing line 14 to:
if [[ -z "$OPTIONS" || "${OPTIONS%% *}" == "AUTOMATIC" ]]; then
which does work.

Reproducible: Always

Steps to Reproduce:
1.emerge openafs
2.try to start openafs-client by issuing "/etc/init.d/openafs-client start"

Actual Results:  
I get red exclamation points that the process has not started, and there is no way to start the application.

Expected Results:  
The software should have started "afsd" the openafs client.

No other information is necessary since this is a scripting issue.




Comment 1


Stefaan De Roeck (RETIRED)






          2008-03-25 11:09:32 UTC
        

If I look at my own clean install, the default setup in /etc/conf.d/openafs-client has OPTIONS set to "AUTOMATIC"...  Are you sure you have a clean install?




Comment 2


ecks





          2008-03-25 13:39:19 UTC
        

(In reply to comment #1)
> If I look at my own clean install, the default setup in
> /etc/conf.d/openafs-client has OPTIONS set to "AUTOMATIC"...  Are you sure you
> have a clean install?
> 
I believe that is because you have net-fs/openafs-1.4.6 installed. The current unmasked version is net-fs/openafs-1.4.6_p20080222, which is the one that I installed. Please try to upgrade and see if you find the same error.





Comment 3


Stefaan De Roeck (RETIRED)






          2008-03-25 13:54:34 UTC
        

Since all openafs-1.4.x version currently in the tree are supposed to install identical /etc/conf.d/openafs-client files, I would urge you to check again.  Most likely this change was made locally on your system.  




Comment 4


ecks





          2008-03-25 16:53:57 UTC
        

Would u mean that I edited /etc/conf.d/openafs-client manually? I specifically remember that I had to install openafs on another client machine, and I still got the same /etc/conf.d/openafs-client file. Regardless, should the script not look whether only the first word is AUTOMATIC, not whether the whole variable equals AUTOMATIC. I didnt change the script, but if someone else changed it, because it is a user-definable variable, they should be able to append to the $OPTIONS variable and it should still recognize the AUTOMATIC keyword. Im positive that I didnt manually change the variables. Not only that, I installed openafs on a clean genkernel system, there wasnt much installed.




Comment 5


Martin Mokrejš





          2008-07-11 23:51:42 UTC
        

I have just newly installed 1.4.6_p20080222 on a new system and I have:

OPTIONS="AUTOMATIC"






Comment 6


Stefaan De Roeck (RETIRED)






          2009-10-24 21:40:08 UTC
        

The "AUTOMATIC" option was never supposed to be combined with extra user options. Either you have your options chosen automatically, or you specify them all. Supporting the combination seems more like trouble to me than like a useful feature. Sorry. 









Format For Printing
 - XML
 - Clone This Bug
 - Clone In The Same 
                        Product
 - Top of page 







Home
| New–[Ex]
| Browse
| Search
| Privacy Policy

| 





[?]
| Reports

| 
Requests

| 
Help


| 
New Account


| 
Log In





[x]



| 
Forgot Password

Login:




[x]

