Title: CBL Mariner 2.0 Security Update: httpd (CVE-2024-24795) - vulnerability database | Vulners.com
URL: https://vulners.com/nessus/MARINER_CVE-2024-24795.NASL

Lucene searchBasic searchLucene searchSearch by productSubscribeKStart 30-day trialDatabaseVendorsProductsYearsCVSSScannerAgent ScanningAPI ScanningManual AuditPerimeter ScannerScanningProjectsEmailWebhookPluginsResourcesDocumentsBlogGlossaryFAQPricingContactsAbout UsPartnersBranding GuidelineSIGN INThis script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.MARINER_CVE-2024-24795.NASLHistoryAug 16, 2024 - 12:00 a.m.Vulners/Nessus/CBL Mariner 2.0 Security Update: httpd (CVE-2024-24795)CBL Mariner 2.0 Security Update: httpd (CVE-2024-24795)2024-08-1600:00:00This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.www.tenable.com7cbl mariner 2.0httpdcve-2024-24795vulnerabilityhttp response splittingapache http serverupgradenessusself-reported versionAI Score6.8ConfidenceLowEPSS0Percentile9.6%JSONThe version of httpd installed on the remote CBL Mariner 2.0 host is prior to tested version. It is, therefore, affected by a vulnerability as referenced in the CVE-2024-24795 advisory.

HTTP Response splitting in multiple modules in Apache HTTP Server allows an attacker that can inject     malicious response headers into backend applications to cause an HTTP desynchronization attack. Users are     recommended to upgrade to version 2.4.59, which fixes this issue. (CVE-2024-24795)

Note that Nessus has not tested for this issue but has instead relied only on the applicationâ€™s self-reported version number.
#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(205665);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2024/08/16");

  script_cve_id("CVE-2024-24795");

  script_name(english:"CBL Mariner 2.0 Security Update: httpd (CVE-2024-24795)");

  script_set_attribute(attribute:"synopsis", value:
"The remote CBL Mariner host is missing one or more security updates.");
  script_set_attribute(attribute:"description", value:
"The version of httpd installed on the remote CBL Mariner 2.0 host is prior to tested version. It is, therefore, affected
by a vulnerability as referenced in the CVE-2024-24795 advisory.

  - HTTP Response splitting in multiple modules in Apache HTTP Server allows an attacker that can inject
    malicious response headers into backend applications to cause an HTTP desynchronization attack. Users are
    recommended to upgrade to version 2.4.59, which fixes this issue. (CVE-2024-24795)

Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version
number.");
  script_set_attribute(attribute:"see_also", value:"https://nvd.nist.gov/vuln/detail/CVE-2024-24795");
  script_set_attribute(attribute:"solution", value:
"Update the affected packages.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2024-24795");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2024/04/04");
  script_set_attribute(attribute:"patch_publication_date", value:"2024/08/13");
  script_set_attribute(attribute:"plugin_publication_date", value:"2024/08/16");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:httpd");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:httpd-debuginfo");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:httpd-devel");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:httpd-docs");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:httpd-tools");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:mod_ldap");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:mod_proxy_html");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:mod_session");
  script_set_attribute(attribute:"cpe", value:"p-cpe:/a:microsoft:cbl-mariner:mod_ssl");
  script_set_attribute(attribute:"cpe", value:"x-cpe:/o:microsoft:cbl-mariner");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"MarinerOS Local Security Checks");

  script_copyright(english:"This script is Copyright (C) 2024 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("ssh_get_info.nasl");
  script_require_keys("Host/local_checks_enabled", "Host/CBLMariner/release", "Host/CBLMariner/rpm-list", "Host/cpu");

  exit(0);
}
include('rpm.inc');

if (!get_kb_item('Host/local_checks_enabled')) audit(AUDIT_LOCAL_CHECKS_NOT_ENABLED);
var release = get_kb_item('Host/CBLMariner/release');
if (isnull(release) || 'CBL-Mariner' >!< release) audit(AUDIT_OS_NOT, 'CBL-Mariner');
var os_ver = pregmatch(pattern: "CBL-Mariner ([0-9]+(\.[0-9]+)?)", string:release);
if (isnull(os_ver)) audit(AUDIT_UNKNOWN_APP_VER, 'CBL-Mariner');
os_ver = os_ver[1];
if (! preg(pattern:"^2([^0-9]|$)", string:os_ver)) audit(AUDIT_OS_NOT, 'CBL-Mariner 2.0', 'CBL-Mariner ' + os_ver);

if (!get_kb_item('Host/CBLMariner/rpm-list')) audit(AUDIT_PACKAGE_LIST_MISSING);

var cpu = get_kb_item('Host/cpu');
if (isnull(cpu)) audit(AUDIT_UNKNOWN_ARCH);
if ('x86_64' >!< cpu && cpu !~ "^i[3-6]86$" && 'aarch64' >!< cpu)
  audit(AUDIT_LOCAL_CHECKS_NOT_IMPLEMENTED, 'CBL-Mariner', cpu);

var pkgs = [
    {'reference':'httpd-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-debuginfo-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-debuginfo-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-devel-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-devel-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-docs-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-docs-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-tools-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'httpd-tools-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'mod_ldap-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'mod_ldap-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'mod_proxy_html-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'mod_proxy_html-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'mod_session-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'mod_session-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'mod_ssl-2.4.59-1.cm2', 'cpu':'x86_64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE},
    {'reference':'mod_ssl-2.4.59-1.cm2', 'cpu':'aarch64', 'release':'2.0', 'rpm_spec_vers_cmp':TRUE}
];

var flag = 0;
foreach var package_array ( pkgs ) {
  var reference = NULL;
  var _release = NULL;
  var sp = NULL;
  var _cpu = NULL;
  var el_string = NULL;
  var rpm_spec_vers_cmp = NULL;
  var epoch = NULL;
  var allowmaj = NULL;
  var exists_check = NULL;
  if (!empty_or_null(package_array['reference'])) reference = package_array['reference'];
  if (!empty_or_null(package_array['release'])) _release = 'CBLMariner-' + package_array['release'];
  if (!empty_or_null(package_array['sp'])) sp = package_array['sp'];
  if (!empty_or_null(package_array['cpu'])) _cpu = package_array['cpu'];
  if (!empty_or_null(package_array['el_string'])) el_string = package_array['el_string'];
  if (!empty_or_null(package_array['rpm_spec_vers_cmp'])) rpm_spec_vers_cmp = package_array['rpm_spec_vers_cmp'];
  if (!empty_or_null(package_array['epoch'])) epoch = package_array['epoch'];
  if (!empty_or_null(package_array['allowmaj'])) allowmaj = package_array['allowmaj'];
  if (!empty_or_null(package_array['exists_check'])) exists_check = package_array['exists_check'];
  if (reference && _release && (!exists_check || rpm_exists(release:_release, rpm:exists_check))) {
    if (rpm_check(release:_release, sp:sp, cpu:_cpu, reference:reference, epoch:epoch, el_string:el_string, rpm_spec_vers_cmp:rpm_spec_vers_cmp, allowmaj:allowmaj)) flag++;
  }
}

if (flag)
{
  security_report_v4(
      port       : 0,
      severity   : SECURITY_WARNING,
      extra      : rpm_report_get()
  );
  exit(0);
}
else
{
  var tested = pkg_tests_get();
  if (tested) audit(AUDIT_PACKAGE_NOT_AFFECTED, tested);
  else audit(AUDIT_PACKAGE_NOT_INSTALLED, 'httpd / httpd-debuginfo / httpd-devel / httpd-docs / httpd-tools / etc');
}
Referencescve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-24795nvd.nist.gov/vuln/detail/CVE-2024-24795Relatednvd 1nessus 42ubuntucve 1cbl_mariner 2redhatcve 1osv 9alpinelinux 1cve 1debian 3debiancve 1f5 1veracode 1cvelist 1vulnrichment 1ibm 10fedora 3openvas 35redos 1amazon 1slackware 1ubuntu 3mageia 1kaspersky 1freebsd 1gentoo 1apple 1oracle 1nvdnvdCVE-2024-247952024-04-04 20:15:08nessusnessus42F5 Networks BIG-IP : Apache httpd vulnerability (K000139447)2024-05-08 00:00:00Debian dla-3819 : fossil - security update2024-05-25 00:00:00Amazon Linux 2 : httpd (ALAS-2024-2532)2024-04-30 00:00:00ubuntucveubuntucveCVE-2024-247952024-04-04 00:00:00cbl_marinercbl_marinerCVE-2024-24795 affecting package httpd for versions less than 2.4.59-12024-05-06 17:48:02CVE-2024-24795 affecting package httpd for versions less than 2.4.61-12024-08-14 20:43:58redhatcveredhatcveCVE-2024-247952024-04-04 19:32:34osvosv9BIT-apache-2024-247952024-04-06 18:17:14CVE-2024-247952024-04-04 20:15:08fossil - security update2024-05-25 00:00:00alpinelinuxalpinelinuxCVE-2024-247952024-04-04 20:15:08cvecveCVE-2024-247952024-04-04 20:15:08debiandebian[SECURITY] [DLA 3819-1] fossil security update2024-05-25 11:33:10[SECURITY] [DLA 3818-1] apache2 security update2024-05-25 11:06:45[SECURITY] [DSA 5662-1] apache2 security update2024-04-16 18:32:07debiancvedebiancveCVE-2024-247952024-04-04 20:15:08f5f5K000139447 : Apache httpd vulnerability CVE-2024-247952024-05-08 00:00:00veracodeveracodeHTTP Response Splitting2024-04-10 21:30:32cvelistcvelistCVE-2024-24795 Apache HTTP Server: HTTP Response Splitting in multiple modules2024-04-04 19:20:48vulnrichmentvulnrichmentCVE-2024-24795 Apache HTTP Server: HTTP Response Splitting in multiple modules2024-04-04 19:20:48ibmibm10Security Bulletin: Multiple security vulnerabilities have been identified in IBM HTTP Server shipped with IBM DevOps Code ClearCase  [CVE-2024-24795, CVE-2023-38709]2024-06-25 12:04:01Security Bulletin: IBM HTTP Server is vulnerable to HTTP response splitting due to the included Apache HTTP Server (CVE-2024-24795, CVE-2023-38709)2024-09-05 18:20:04Security Bulletin: A security vulnerability has been identified in IBM HTTP Server, which is used by IBM WebSphere Application Server in IBM Rational ClearQuest (CVE-2024-24795, CVE-2023-38709)2024-04-22 11:02:48fedorafedora[SECURITY] Fedora 38 Update: httpd-2.4.59-2.fc382024-05-04 02:19:58[SECURITY] Fedora 39 Update: httpd-2.4.59-2.fc392024-05-03 01:33:21[SECURITY] Fedora 40 Update: httpd-2.4.59-2.fc402024-04-19 21:45:00openvasopenvas35Fedora: Security Advisory (FEDORA-2024-937be154d8)2024-05-27 00:00:00Fedora: Security Advisory for httpd (FEDORA-2024-c2f6576348)2024-05-27 00:00:00Fedora: Security Advisory (FEDORA-2024-d0dccd6b96)2024-05-27 00:00:00redosredosROS-20240726-052024-07-26 00:00:00amazonamazonMedium: httpd2024-04-24 22:15:00slackwareslackware[slackware-security]  httpd2024-04-04 19:16:44ubuntuubuntuApache HTTP Server vulnerabilities2024-04-17 00:00:00Apache HTTP Server vulnerabilities2024-04-29 00:00:00Apache HTTP Server vulnerabilities2024-04-11 00:00:00mageiamageiaUpdated apache packages fix security vulnerabilities
2024-04-10 07:03:52kasperskykasperskyKLA65470 Multiple vulnerabilities in Apache HTTP Server2024-04-04 00:00:00freebsdfreebsdApache httpd -- multiple vulnerabilities2024-04-04 00:00:00gentoogentooApache HTTPD: Multiple Vulnerabilities2024-09-28 00:00:00appleappleAbout the security content of macOS Sonoma 14.62024-07-29 00:00:00oracleoracleOracle Critical Patch Update Advisory - July 20242024-07-16 00:00:00SolutionsVulnerabilities intelligencePerimeter control toolLinux scannerWindows scannerDevelopers SDKSecurity Intelligence feedsDatabaseVulnerabilitiesExploitsSecurity NewsBugBountyWild ExploitedTop VulnerabilitiesCVE FeedResourcesStatics & SourcesPluginsAPI docsFAQBlogGlossaryCompanyAboutContactsPricingEULAPrivacy PolicySubmission PolicyOpenSource@2024 Vulners IncAI Score6.8ConfidenceLowEPSS0Percentile9.6%JSONRelated for MARINER_CVE-2024-24795.NASLnvd1nessus42ubuntucve1cbl_mariner2redhatcve1osv9alpinelinux1cve1debian3debiancve1f51veracode1cvelist1vulnrichment1ibm10fedora3openvas35redos1amazon1slackware1ubuntu3mageia1kaspersky1freebsd1gentoo1apple1oracle1

